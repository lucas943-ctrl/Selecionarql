{
    "[003sql001prd].[db_app]": {
        "address": "[003sql001prd].[db_app]",
        "server": "003sql001prd",
        "database": "db_app",
        "schema": "",
        "name": "",
        "type": "Database",
        "start": 17,
        "end": 2559,
        "code": "/****** Object:  Database [db_app]    Script Date: 2024-11-03 12:50:33 ******/\nCREATE DATABASE [db_app]\n CONTAINMENT = NONE\n ON  PRIMARY \n( NAME = N'db_app', FILENAME = N'C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\DATA\\db_app.mdf' , SIZE = 8192KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )\n LOG ON \n( NAME = N'db_app_log', FILENAME = N'C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\DATA\\db_app_log.ldf' , SIZE = 8192KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )\n WITH CATALOG_COLLATION = DATABASE_DEFAULT, LEDGER = OFF\nGO\nALTER DATABASE [db_app] SET COMPATIBILITY_LEVEL = 160\nGO\nIF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))\nbegin\nEXEC [db_app].[dbo].[sp_fulltext_database] @action = 'enable'\nend\nGO\nALTER DATABASE [db_app] SET ANSI_NULL_DEFAULT OFF \nGO\nALTER DATABASE [db_app] SET ANSI_NULLS OFF \nGO\nALTER DATABASE [db_app] SET ANSI_PADDING OFF \nGO\nALTER DATABASE [db_app] SET ANSI_WARNINGS OFF \nGO\nALTER DATABASE [db_app] SET ARITHABORT OFF \nGO\nALTER DATABASE [db_app] SET AUTO_CLOSE OFF \nGO\nALTER DATABASE [db_app] SET AUTO_SHRINK OFF \nGO\nALTER DATABASE [db_app] SET AUTO_UPDATE_STATISTICS ON \nGO\nALTER DATABASE [db_app] SET CURSOR_CLOSE_ON_COMMIT OFF \nGO\nALTER DATABASE [db_app] SET CURSOR_DEFAULT  GLOBAL \nGO\nALTER DATABASE [db_app] SET CONCAT_NULL_YIELDS_NULL OFF \nGO\nALTER DATABASE [db_app] SET NUMERIC_ROUNDABORT OFF \nGO\nALTER DATABASE [db_app] SET QUOTED_IDENTIFIER OFF \nGO\nALTER DATABASE [db_app] SET RECURSIVE_TRIGGERS OFF \nGO\nALTER DATABASE [db_app] SET  ENABLE_BROKER \nGO\nALTER DATABASE [db_app] SET AUTO_UPDATE_STATISTICS_ASYNC OFF \nGO\nALTER DATABASE [db_app] SET DATE_CORRELATION_OPTIMIZATION OFF \nGO\nALTER DATABASE [db_app] SET TRUSTWORTHY OFF \nGO\nALTER DATABASE [db_app] SET ALLOW_SNAPSHOT_ISOLATION OFF \nGO\nALTER DATABASE [db_app] SET PARAMETERIZATION SIMPLE \nGO\nALTER DATABASE [db_app] SET READ_COMMITTED_SNAPSHOT ON \nGO\nALTER DATABASE [db_app] SET HONOR_BROKER_PRIORITY OFF \nGO\nALTER DATABASE [db_app] SET RECOVERY SIMPLE \nGO\nALTER DATABASE [db_app] SET  MULTI_USER \nGO\nALTER DATABASE [db_app] SET PAGE_VERIFY CHECKSUM  \nGO\nALTER DATABASE [db_app] SET DB_CHAINING OFF \nGO\nALTER DATABASE [db_app] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) \nGO\nALTER DATABASE [db_app] SET TARGET_RECOVERY_TIME = 60 SECONDS \nGO\nALTER DATABASE [db_app] SET DELAYED_DURABILITY = DISABLED \nGO\nALTER DATABASE [db_app] SET ACCELERATED_DATABASE_RECOVERY = OFF  \nGO\nEXEC sys.sp_db_vardecimal_storage_format N'db_app', N'ON'\nGO\nALTER DATABASE [db_app] SET QUERY_STORE = OFF\nGO\nUSE [db_app]\nGO\n",
        "build_order": 0,
        "depends_on": {
            "": [
                "",
                ""
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ]
        }
    },
    "[003sql001prd].[db_app].[dbo].[d_app_log]": {
        "address": "[003sql001prd].[db_app].[dbo].[d_app_log]",
        "server": "003sql001prd",
        "database": "db_app",
        "schema": "dbo",
        "name": "d_app_log",
        "type": "Table",
        "start": 2559,
        "end": 3154,
        "code": "/****** Object:  Table [dbo].[d_app_log]    Script Date: 2024-11-03 12:50:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_app_log](\n\t[app_log_id] [varchar](36) NOT NULL,\n\t[datahora] [datetimeoffset](7) NOT NULL,\n\t[level] [varchar](5) NOT NULL,\n\t[mensagem] [varchar](max) NOT NULL,\n CONSTRAINT [d_app_log_PK] PRIMARY KEY CLUSTERED \n(\n\t[app_log_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 1,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[d_app_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_app_log]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[d_app_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_app_log]"
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "DELETE",
                "DELETE FROM d_app_log"
            ]
        }
    },
    "[003sql001prd].[db_app].[dbo].[d_att_configs]": {
        "address": "[003sql001prd].[db_app].[dbo].[d_att_configs]",
        "server": "003sql001prd",
        "database": "db_app",
        "schema": "dbo",
        "name": "d_att_configs",
        "type": "Table",
        "start": 3154,
        "end": 3745,
        "code": "/****** Object:  Table [dbo].[d_att_configs]    Script Date: 2024-11-03 12:50:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_att_configs](\n\t[att_config_id] [varchar](64) NOT NULL,\n\t[frequencia] [int] NOT NULL,\n\t[ultima_att] [datetimeoffset](7) NOT NULL,\n\t[estado_att] [varchar](10) NOT NULL,\n CONSTRAINT [d_att_configs_PK] PRIMARY KEY CLUSTERED \n(\n\t[att_config_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n",
        "build_order": 2,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[d_att_configs]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_att_configs]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[d_att_configs]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_att_configs]"
            ],
            "[003sql001prd].[db_app].[dbo].[s_att_config]": [
                "UNKNOWN",
                "d_att_configs"
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "UPDATE",
                "UPDATE d_att_configs"
            ]
        }
    },
    "[003sql001prd].[db_app].[dbo].[d_version]": {
        "address": "[003sql001prd].[db_app].[dbo].[d_version]",
        "server": "003sql001prd",
        "database": "db_app",
        "schema": "dbo",
        "name": "d_version",
        "type": "Table",
        "start": 3745,
        "end": 3955,
        "code": "/****** Object:  Table [dbo].[d_version]    Script Date: 2024-11-03 12:50:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_version](\n\t[version] [int] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 3,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[d_version]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_version]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[d_version]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_version]"
            ]
        }
    },
    "[003sql001prd].[db_app].[dbo].[dim_mapa]": {
        "address": "[003sql001prd].[db_app].[dbo].[dim_mapa]",
        "server": "003sql001prd",
        "database": "db_app",
        "schema": "dbo",
        "name": "dim_mapa",
        "type": "Table",
        "start": 3955,
        "end": 4266,
        "code": "/****** Object:  Table [dbo].[dim_mapa]    Script Date: 2024-11-03 12:50:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mapa](\n\t[DB] [varchar](18) NOT NULL,\n\t[Classe] [varchar](15) NOT NULL,\n\t[Estado] [varchar](99) NOT NULL,\n\t[Nome] [varchar](43) NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 4,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[dim_mapa]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mapa]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[dim_mapa]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mapa]"
            ]
        }
    },
    "[003sql001prd].[db_app].[dbo].[s_att_config]": {
        "address": "[003sql001prd].[db_app].[dbo].[s_att_config]",
        "server": "003sql001prd",
        "database": "db_app",
        "schema": "dbo",
        "name": "s_att_config",
        "type": "StoredProcedure",
        "start": 4266,
        "end": 5080,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_config]    Script Date: 2024-11-03 12:50:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_config] @att_config_id [VARCHAR](64), @datahora [DATETIME], @estado [VARCHAR](10)\nAS\n    MERGE d_att_configs AS destino\n    USING (\n        SELECT\n             [att_config_id]    = @att_config_id\n            ,[ultima_att]       = @datahora\n            ,[estado_att]       = @estado\n    ) AS fonte\n    ON destino.[att_config_id] = fonte.[att_config_id]\n    WHEN MATCHED AND (\n            destino.[ultima_att] <> fonte.[ultima_att]\n        OR  destino.[estado_att] <> fonte.[estado_att]\n    )\n    THEN\n        UPDATE SET\n             destino.[ultima_att] = fonte.[ultima_att]\n            ,destino.[estado_att] = fonte.[estado_att]\n;\n\nGO\n",
        "build_order": 5,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[d_att_configs]": [
                "UNKNOWN",
                "d_att_configs"
            ],
            "[003sql001prd].[db_app].[dbo].[s_att_config]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_config]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[s_att_config]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_config]"
            ]
        }
    },
    "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": {
        "address": "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]",
        "server": "003sql001prd",
        "database": "db_app",
        "schema": "dbo",
        "name": "sp_sys_faxina",
        "type": "StoredProcedure",
        "start": 5080,
        "end": 5703,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_faxina]    Script Date: 2024-11-03 12:50:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE PROCEDURE [dbo].[sp_sys_faxina] AS\n\tALTER DATABASE db_app SET RECOVERY SIMPLE;\n\tDELETE FROM d_app_log\n\tDBCC SHRINKDATABASE(N'db_app');\n\tDBCC SHRINKFILE (N'db_app', 0);\n\tDBCC SHRINKFILE (N'db_app', 0);\n\tDBCC FREESYSTEMCACHE ('db_app');\n\tDBCC FREESYSTEMCACHE ('tempdb');\n\tDBCC FREESYSTEMCACHE ('master');\n\tDBCC FREESYSTEMCACHE ('model');\n\tDBCC FREESYSTEMCACHE ('msdb');\n\tDBCC FREEPROCCACHE;\n\tDBCC FREESESSIONCACHE;\n    UPDATE d_att_configs set estado_att = 'DONE'\n\n\n\nGO\n",
        "build_order": 6,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[d_app_log]": [
                "DELETE",
                "DELETE FROM d_app_log"
            ],
            "[003sql001prd].[db_app].[dbo].[d_att_configs]": [
                "UPDATE",
                "UPDATE d_att_configs"
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_app].[dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1]": {
        "address": "[003sql001prd].[db_prod_d-1]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "",
        "name": "",
        "type": "Database",
        "start": 17,
        "end": 2764,
        "code": "/****** Object:  Database [db_prod_d-1]    Script Date: 2024-11-03 12:59:54 ******/\nCREATE DATABASE [db_prod_d-1]\n CONTAINMENT = NONE\n ON  PRIMARY \n( NAME = N'db_prod_d-1', FILENAME = N'C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\DATA\\db_prod_d-1.mdf' , SIZE = 8192KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )\n LOG ON \n( NAME = N'db_prod_d-1_log', FILENAME = N'C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\DATA\\db_prod_d-1_log.ldf' , SIZE = 8192KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )\n WITH CATALOG_COLLATION = DATABASE_DEFAULT, LEDGER = OFF\nGO\nALTER DATABASE [db_prod_d-1] SET COMPATIBILITY_LEVEL = 160\nGO\nIF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))\nbegin\nEXEC [db_prod_d-1].[dbo].[sp_fulltext_database] @action = 'enable'\nend\nGO\nALTER DATABASE [db_prod_d-1] SET ANSI_NULL_DEFAULT OFF \nGO\nALTER DATABASE [db_prod_d-1] SET ANSI_NULLS OFF \nGO\nALTER DATABASE [db_prod_d-1] SET ANSI_PADDING OFF \nGO\nALTER DATABASE [db_prod_d-1] SET ANSI_WARNINGS OFF \nGO\nALTER DATABASE [db_prod_d-1] SET ARITHABORT OFF \nGO\nALTER DATABASE [db_prod_d-1] SET AUTO_CLOSE OFF \nGO\nALTER DATABASE [db_prod_d-1] SET AUTO_SHRINK OFF \nGO\nALTER DATABASE [db_prod_d-1] SET AUTO_UPDATE_STATISTICS ON \nGO\nALTER DATABASE [db_prod_d-1] SET CURSOR_CLOSE_ON_COMMIT OFF \nGO\nALTER DATABASE [db_prod_d-1] SET CURSOR_DEFAULT  GLOBAL \nGO\nALTER DATABASE [db_prod_d-1] SET CONCAT_NULL_YIELDS_NULL OFF \nGO\nALTER DATABASE [db_prod_d-1] SET NUMERIC_ROUNDABORT OFF \nGO\nALTER DATABASE [db_prod_d-1] SET QUOTED_IDENTIFIER OFF \nGO\nALTER DATABASE [db_prod_d-1] SET RECURSIVE_TRIGGERS OFF \nGO\nALTER DATABASE [db_prod_d-1] SET  ENABLE_BROKER \nGO\nALTER DATABASE [db_prod_d-1] SET AUTO_UPDATE_STATISTICS_ASYNC OFF \nGO\nALTER DATABASE [db_prod_d-1] SET DATE_CORRELATION_OPTIMIZATION OFF \nGO\nALTER DATABASE [db_prod_d-1] SET TRUSTWORTHY OFF \nGO\nALTER DATABASE [db_prod_d-1] SET ALLOW_SNAPSHOT_ISOLATION OFF \nGO\nALTER DATABASE [db_prod_d-1] SET PARAMETERIZATION SIMPLE \nGO\nALTER DATABASE [db_prod_d-1] SET READ_COMMITTED_SNAPSHOT ON \nGO\nALTER DATABASE [db_prod_d-1] SET HONOR_BROKER_PRIORITY OFF \nGO\nALTER DATABASE [db_prod_d-1] SET RECOVERY SIMPLE \nGO\nALTER DATABASE [db_prod_d-1] SET  MULTI_USER \nGO\nALTER DATABASE [db_prod_d-1] SET PAGE_VERIFY CHECKSUM  \nGO\nALTER DATABASE [db_prod_d-1] SET DB_CHAINING OFF \nGO\nALTER DATABASE [db_prod_d-1] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) \nGO\nALTER DATABASE [db_prod_d-1] SET TARGET_RECOVERY_TIME = 60 SECONDS \nGO\nALTER DATABASE [db_prod_d-1] SET DELAYED_DURABILITY = DISABLED \nGO\nALTER DATABASE [db_prod_d-1] SET ACCELERATED_DATABASE_RECOVERY = OFF  \nGO\nEXEC sys.sp_db_vardecimal_storage_format N'db_prod_d-1', N'ON'\nGO\nALTER DATABASE [db_prod_d-1] SET QUERY_STORE = OFF\nGO\nUSE [db_prod_d-1]\nGO\n",
        "build_order": 7,
        "depends_on": {
            "": [
                "",
                ""
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "r_tribo_30min",
        "type": "Table",
        "start": 2764,
        "end": 13810,
        "code": "/****** Object:  Table [dbo].[r_tribo_30min]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_tribo_30min](\n\t[DataHora] [datetime2](3) NOT NULL,\n\t[Intervalo] [time](3) NULL,\n\t[Data] [date] NULL,\n\t[Ciclo (Primeiro Dia)] [date] NULL,\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Feriado (Nome)] [varchar](50) NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Forecast HC Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast HC Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast PA Liquida (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Volume] [decimal](18, 4) NULL,\n\t[Forecast Log] [decimal](18, 4) NULL,\n\t[Forecast Log Produtivo] [decimal](18, 4) NULL,\n\t[Forecast NS] [decimal](18, 4) NULL,\n\t[Forecast TMT] [decimal](18, 4) NULL,\n\t[Forecast TMA] [decimal](18, 4) NULL,\n\t[Forecast SLA] [decimal](18, 4) NULL,\n\t[Forecast Abandono] [decimal](18, 4) NULL,\n\t[Forecast NPS] [decimal](18, 4) NULL,\n\t[Forecast Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Forecast Rechamada] [decimal](18, 4) NULL,\n\t[Forecast Short Call] [decimal](18, 4) NULL,\n\t[Forecast Instabilidade] [decimal](18, 4) NULL,\n\t[Forecast Phishing] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMT] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia SLA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia NS] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Abandono] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Log] [decimal](18, 4) NOT NULL,\n\t[Log 102%] [decimal](18, 4) NULL,\n\t[Log Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log Produtivo] [decimal](18, 4) NOT NULL,\n\t[Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Log Produtivo Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log HE] [decimal](18, 4) NOT NULL,\n\t[Log descartado (>2HE)] [decimal](18, 4) NOT NULL,\n\t[Log Improdutivo] [decimal](18, 4) NOT NULL,\n\t[Tempo Livre] [decimal](18, 4) NOT NULL,\n\t[Pausa Particular (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Break (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa 10 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Outbound (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Intervalo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Login (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa BackOffice (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Descanso (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Backoffice (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Em Fila (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[SLA TPR] [int] NULL,\n\t[SLA TES] [int] NULL,\n\t[SLA TTR] [int] NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [int] NOT NULL,\n\t[Inbound - TMA] [int] NOT NULL,\n\t[Inbound - TME] [int] NOT NULL,\n\t[Inbound - TMO] [int] NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [int] NOT NULL,\n\t[Outbound - TMA] [int] NOT NULL,\n\t[Outbound - TME] [int] NOT NULL,\n\t[Outbound - TMO] [int] NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[Genesys Provis\u00f3rio - Oferta] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - Resposta] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - Em Espera] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - Transferir] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - Abandono] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - % Resposta] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - % NS] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - % Alvos do NS] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - VMA] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - TPC] [decimal](18, 4) NOT NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Teve Evento de Forecast?] [tinyint] NOT NULL,\n\t[Desvio Ponto-Log] [bigint] NULL,\n\t[Fonte de Log] [varchar](10) NULL,\n\t[Tempo Total (Intelix)] [bigint] NOT NULL,\n\t[Tempo Total (EPBX)] [bigint] NOT NULL,\n\t[Tempo Total (Genesys)] [bigint] NOT NULL,\n\t[Tempo Total (Secullum)] [bigint] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 8,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_30min]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_30min]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_30min]": [
                "UNKNOWN",
                "r_tribo_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "r_tribo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_tribo_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_tribo_30min]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_30min]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_30min]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "vw_faturamento_30min",
        "type": "View",
        "start": 13810,
        "end": 18248,
        "code": "/****** Object:  View [dbo].[vw_faturamento_30min]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   VIEW [dbo].[vw_faturamento_30min] AS\n    SELECT\n         [DataHora]\n        ,[Data]\n        ,[Intervalo]\n\t\t,[M\u00eas (Primeiro Dia)]\n\t\t,[Cliente]\n\t\t,[Projeto]\n\t\t,[Tribo]\n\n        ,[PAs Contratadas]                      = ISNULL([Forecast HC Taxa 1],0)+ISNULL([Forecast HC Taxa 2],0)\n        --,[Valor da PA]\n        --,[Faturamento Antes das Penalidades]\n        --,[Faturamento Ap\u00f3s Penalidades]\n\n        ,[Volume Entrante]                      = CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END\n        ,[Volume Tratado]       \t\t\t\t= CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Atendidas] + [Outbound - Chamadas Atendidas]) ELSE [Tratados] END\n        ,[Forecast Volume]\n\n\t\t,[Log]                                  = DATEADD(s,[Log],0)\n        ,[Log 102%]                             = DATEADD(s,[Log 102%],0)\n        ,[Forecast Log]                         = DATEADD(s,[Forecast Log],0)\n        ,[Ader\u00eancia Log]\n        ,[Ader\u00eancia Log 102%]\n\n\t\t,[Log Produtivo]                        = DATEADD(s,[Log Produtivo],0)\n        ,[Log Produtivo 102%]                   = DATEADD(s,[Log Produtivo 102%],0)\n        ,[Forecast Log Produtivo]               = DATEADD(s,[Forecast Log Produtivo],0)\n        ,[Ader\u00eancia Log Produtivo]\n        ,[Ader\u00eancia Log Produtivo 102%]\n\n\t\t,[NS]                                   = COALESCE([Inbound - % Nivel de Servi\u00e7o],[Outbound - % Nivel de Servi\u00e7o])\n        ,[Forecast NS]\n        ,[Ader\u00eancia NS]\n        --,[Penalidade NS]\n        ,[Causa Raiz Interna NS]                =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF(CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END > [Forecast Volume], CONCAT('Aumento de volume ', IIF(COALESCE([Inbound - TMA], [Outbound - TMA]) <= [Forecast TMA], 'com impacto operacional', 'sem impacto operacional'), ' (TMA); '), '')\n                                                    ))\n        ,[Causa Raiz Cliente NS]                =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF([Ader\u00eancia Log Produtivo] < 1, 'HC liquido logado abaixo do previsto','')\n                                                    ))\n\n\t\t,[TMT]\n        ,[Forecast TMT]\n        ,[Ader\u00eancia TMT]\n        --,[Penalidade TMT]\n\n\t\t,[TMA]                                  = COALESCE([Inbound - TMA],[Outbound - TMA])\n        ,[Forecast TMA]\n        ,[Ader\u00eancia TMA]\n        --,[Penalidade TMA]\n\n        ,[SLA TPR]\n        ,[Forecast SLA]\n        ,[Ader\u00eancia SLA]\n        --,[Penalidade SLA]\n\n\t\t,[Abandono]                             = COALESCE([Inbound - % Abandono],[Outbound - % Abandono])\n        ,[Forecast Abandono]\n        ,[Ader\u00eancia Abandono]\n        --,[Penalidade Abandono]\n        ,[Causa Raiz Interna Abandono]          =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF(CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END > [Forecast Volume], CONCAT('Aumento de volume ', IIF(COALESCE([Inbound - TMA], [Outbound - TMA]) <= [Forecast TMA], 'com impacto operacional', 'sem impacto operacional'), ' (TMA); '), '')\n                                                    ))\n        ,[Causa Raiz Cliente Abandono]          =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF([Ader\u00eancia Log Produtivo] < 1, 'HC liquido logado abaixo do previsto','')\n                                                    ))\n\n        --,[NPS]\n        --,[Forecast NPS]\n        --,[Ader\u00eancia NPS]\n        --,[Penalidade NPS]\n\n\t\t,[Casos N\u00e3o resolvidos]                 = [N\u00e3o Resolvidos]/NULLIF([Tratados],0)\n        ,[Forecast Casos N\u00e3o Resolvidos]\n        ,[Ader\u00eancia Casos N\u00e3o Resolvidos]\n        --,[Penalidade Casos N\u00e3o Resolvidos]\n\n    FROM r_tribo_30min\n    --WHERE ISNULL([Forecast HC Taxa 1],0)+ISNULL([Forecast HC Taxa 2],0) > 0\n    WHERE [Cliente] = 'Serasa'\n\nGO\n",
        "build_order": 9,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]": [
                "UNKNOWN",
                "r_tribo_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_30min]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_faturamento_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]": [
                "UNKNOWN",
                "r_tribo_30min"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_30min]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_faturamento_30min]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "r_tribo_dia",
        "type": "Table",
        "start": 18248,
        "end": 28399,
        "code": "/****** Object:  Table [dbo].[r_tribo_dia]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_tribo_dia](\n\t[Data] [date] NULL,\n\t[Ciclo (Primeiro Dia)] [date] NULL,\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Feriado (Nome)] [varchar](50) NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Forecast HC Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast HC Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast PA Liquida (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Volume] [decimal](18, 4) NULL,\n\t[Forecast Log] [decimal](18, 4) NULL,\n\t[Forecast Log Produtivo] [decimal](18, 4) NULL,\n\t[Forecast NS] [decimal](18, 4) NULL,\n\t[Forecast TMT] [decimal](18, 4) NULL,\n\t[Forecast TMA] [decimal](18, 4) NULL,\n\t[Forecast SLA] [decimal](18, 4) NULL,\n\t[Forecast Abandono] [decimal](18, 4) NULL,\n\t[Forecast NPS] [decimal](18, 4) NULL,\n\t[Forecast Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Forecast Rechamada] [decimal](18, 4) NULL,\n\t[Forecast Short Call] [decimal](18, 4) NULL,\n\t[Forecast Instabilidade] [decimal](18, 4) NULL,\n\t[Forecast Phishing] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMT] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia SLA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia NS] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Abandono] [decimal](18, 4) NULL,\n\t[Ader\u00eancia NPS] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Log] [decimal](18, 4) NOT NULL,\n\t[Log 102%] [decimal](18, 4) NULL,\n\t[Log Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log Produtivo] [decimal](18, 4) NOT NULL,\n\t[Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Log Produtivo Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log HE] [decimal](18, 4) NOT NULL,\n\t[Log descartado (>2HE)] [decimal](18, 4) NOT NULL,\n\t[Log Improdutivo] [decimal](18, 4) NOT NULL,\n\t[Tempo Livre] [decimal](18, 4) NOT NULL,\n\t[Pausa Particular (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Break (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa 10 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Outbound (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Intervalo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Login (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa BackOffice (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Descanso (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Backoffice (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Em Fila (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[SLA TPR] [int] NULL,\n\t[SLA TES] [int] NULL,\n\t[SLA TTR] [int] NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [int] NOT NULL,\n\t[Inbound - TMA] [int] NOT NULL,\n\t[Inbound - TME] [int] NOT NULL,\n\t[Inbound - TMO] [int] NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [int] NOT NULL,\n\t[Outbound - TMA] [int] NOT NULL,\n\t[Outbound - TME] [int] NOT NULL,\n\t[Outbound - TMO] [int] NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[NPS] [int] NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Teve Evento de Forecast?] [tinyint] NOT NULL,\n\t[Desvio Ponto-Log] [bigint] NULL,\n\t[Fonte de Log] [varchar](10) NULL,\n\t[Tempo Total (Intelix)] [bigint] NOT NULL,\n\t[Tempo Total (EPBX)] [bigint] NOT NULL,\n\t[Tempo Total (Genesys)] [bigint] NOT NULL,\n\t[Tempo Total (Secullum)] [bigint] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 10,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_dia]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_dia]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_dia]": [
                "UNKNOWN",
                "r_tribo_dia"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "r_tribo_dia"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_tribo_dia"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_tribo_dia]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_dia]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_dia]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "vw_faturamento_dia",
        "type": "View",
        "start": 28399,
        "end": 32784,
        "code": "/****** Object:  View [dbo].[vw_faturamento_dia]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   VIEW [dbo].[vw_faturamento_dia] AS\n    SELECT\n\t\t [Data]\n\t\t,[M\u00eas (Primeiro Dia)]\n\t\t,[Cliente]\n\t\t,[Projeto]\n\t\t,[Tribo]\n\n        ,[PAs Contratadas]                      = ISNULL([Forecast HC Taxa 1],0)+ISNULL([Forecast HC Taxa 2],0)\n        --,[Valor da PA]\n        --,[Faturamento Antes das Penalidades]\n        --,[Faturamento Ap\u00f3s Penalidades]\n\n        ,[Volume Entrante]                      = CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END\n        ,[Volume Tratado]       \t\t\t\t= CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Atendidas] + [Outbound - Chamadas Atendidas]) ELSE [Tratados] END\n        ,[Forecast Volume]\n\n\t\t,[Log]                                  = DATEADD(s,[Log],0)\n        ,[Log 102%]                             = DATEADD(s,[Log 102%],0)\n        ,[Forecast Log]                         = DATEADD(s,[Forecast Log],0)\n        ,[Ader\u00eancia Log]\n        ,[Ader\u00eancia Log 102%]\n\n\t\t,[Log Produtivo]                        = DATEADD(s,[Log Produtivo],0)\n        ,[Log Produtivo 102%]                   = DATEADD(s,[Log Produtivo 102%],0)\n        ,[Forecast Log Produtivo]               = DATEADD(s,[Forecast Log Produtivo],0)\n        ,[Ader\u00eancia Log Produtivo]\n        ,[Ader\u00eancia Log Produtivo 102%]\n\n\t\t,[NS]                                   = COALESCE([Inbound - % Nivel de Servi\u00e7o],[Outbound - % Nivel de Servi\u00e7o])\n        ,[Forecast NS]\n        ,[Ader\u00eancia NS]\n        --,[Penalidade NS]\n        ,[Causa Raiz Interna NS]                =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF(CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END > [Forecast Volume], CONCAT('Aumento de volume ', IIF(COALESCE([Inbound - TMA], [Outbound - TMA]) <= [Forecast TMA], 'com impacto operacional', 'sem impacto operacional'), ' (TMA); '), '')\n                                                    ))\n        ,[Causa Raiz Cliente NS]                =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF([Ader\u00eancia Log Produtivo] < 1, 'HC liquido logado abaixo do previsto','')\n                                                    ))\n\n\t\t,[TMT]\n        ,[Forecast TMT]\n        ,[Ader\u00eancia TMT]\n        --,[Penalidade TMT]\n\n\t\t,[TMA]                                  = COALESCE([Inbound - TMA],[Outbound - TMA])\n        ,[Forecast TMA]\n        ,[Ader\u00eancia TMA]\n        --,[Penalidade TMA]\n\n        ,[SLA TPR]\n        ,[Forecast SLA]\n        ,[Ader\u00eancia SLA]\n        --,[Penalidade SLA]\n\n\t\t,[Abandono]                             = COALESCE([Inbound - % Abandono],[Outbound - % Abandono])\n        ,[Forecast Abandono]\n        ,[Ader\u00eancia Abandono]\n        --,[Penalidade Abandono]\n        ,[Causa Raiz Interna Abandono]          =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF(CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END > [Forecast Volume], CONCAT('Aumento de volume ', IIF(COALESCE([Inbound - TMA], [Outbound - TMA]) <= [Forecast TMA], 'com impacto operacional', 'sem impacto operacional'), ' (TMA); '), '')\n                                                    ))\n        ,[Causa Raiz Cliente Abandono]          =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF([Ader\u00eancia Log Produtivo] < 1, 'HC liquido logado abaixo do previsto','')\n                                                    ))\n\n        --,[NPS]\n        --,[Forecast NPS]\n        --,[Ader\u00eancia NPS]\n        --,[Penalidade NPS]\n\n\t\t,[Casos N\u00e3o resolvidos]                 = [N\u00e3o Resolvidos]/NULLIF([Tratados],0)\n        ,[Forecast Casos N\u00e3o Resolvidos]\n        ,[Ader\u00eancia Casos N\u00e3o Resolvidos]\n        --,[Penalidade Casos N\u00e3o Resolvidos]\n\n    FROM r_tribo_dia\n    --WHERE ISNULL([Forecast HC Taxa 1],0)+ISNULL([Forecast HC Taxa 2],0) > 0\n    WHERE [Cliente] = 'Serasa'\n\nGO\n",
        "build_order": 11,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "r_tribo_dia"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_dia]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_faturamento_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "r_tribo_dia"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_dia]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_faturamento_dia]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_m\u00eas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_m\u00eas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "r_tribo_m\u00eas",
        "type": "Table",
        "start": 32784,
        "end": 43456,
        "code": "/****** Object:  Table [dbo].[r_tribo_m\u00eas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_tribo_m\u00eas](\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Forecast HC Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast HC Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast PA Liquida (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Volume] [decimal](18, 4) NULL,\n\t[Forecast Volume M\u00eas - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Log] [decimal](18, 4) NULL,\n\t[Forecast Log Produtivo] [decimal](18, 4) NULL,\n\t[Forecast NS] [decimal](18, 4) NULL,\n\t[Forecast NS M\u00eas - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast TMT] [decimal](18, 4) NULL,\n\t[Forecast TMA] [decimal](18, 4) NULL,\n\t[Forecast SLA] [decimal](18, 4) NULL,\n\t[Forecast Abandono] [decimal](18, 4) NULL,\n\t[Forecast NPS] [decimal](18, 4) NULL,\n\t[Forecast Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Forecast Rechamada] [decimal](18, 4) NULL,\n\t[Forecast Short Call] [decimal](18, 4) NULL,\n\t[Forecast Instabilidade] [decimal](18, 4) NULL,\n\t[Forecast Phishing] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMT] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia SLA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia NS] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Abandono] [decimal](18, 4) NULL,\n\t[Ader\u00eancia NPS] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Penalidade TMT] [decimal](18, 4) NULL,\n\t[Penalidade TMA] [decimal](18, 4) NULL,\n\t[Penalidade SLA] [decimal](18, 4) NULL,\n\t[Penalidade NS] [decimal](18, 4) NULL,\n\t[Penalidade Abandono] [decimal](18, 4) NULL,\n\t[Penalidade NPS] [decimal](18, 4) NULL,\n\t[Penalidade Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[PAs Contratadas] [decimal](18, 4) NULL,\n\t[Valor da PA] [decimal](18, 4) NULL,\n\t[Faturamento Antes das Penalidades] [decimal](18, 4) NULL,\n\t[Faturamento Ap\u00f3s Penalidades] [decimal](18, 4) NULL,\n\t[Log] [decimal](18, 4) NOT NULL,\n\t[Log 102%] [decimal](18, 4) NULL,\n\t[Log Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log Produtivo] [decimal](18, 4) NOT NULL,\n\t[Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Log Produtivo Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log HE] [decimal](18, 4) NOT NULL,\n\t[Log descartado (>2HE)] [decimal](18, 4) NOT NULL,\n\t[Log Improdutivo] [decimal](18, 4) NOT NULL,\n\t[Tempo Livre] [decimal](18, 4) NOT NULL,\n\t[Pausa Particular (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Break (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa 10 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Outbound (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Intervalo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Login (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa BackOffice (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Descanso (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Backoffice (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Em Fila (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[SLA TPR] [int] NULL,\n\t[SLA TES] [int] NULL,\n\t[SLA TTR] [int] NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [int] NOT NULL,\n\t[Inbound - TMA] [int] NOT NULL,\n\t[Inbound - TME] [int] NOT NULL,\n\t[Inbound - TMO] [int] NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [int] NOT NULL,\n\t[Outbound - TMA] [int] NOT NULL,\n\t[Outbound - TME] [int] NOT NULL,\n\t[Outbound - TMO] [int] NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[NPS] [int] NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Teve Evento de Forecast?] [tinyint] NOT NULL,\n\t[Desvio Ponto-Log] [bigint] NULL,\n\t[Fonte de Log] [varchar](10) NULL,\n\t[Tempo Total (Intelix)] [bigint] NOT NULL,\n\t[Tempo Total (EPBX)] [bigint] NOT NULL,\n\t[Tempo Total (Genesys)] [bigint] NOT NULL,\n\t[Tempo Total (Secullum)] [bigint] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 12,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_m\u00eas]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_m\u00eas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_m\u00eas]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_m\u00eas]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_m\u00eas]": [
                "UNKNOWN",
                "r_tribo_m\u00eas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UPDATE",
                "UPDATE r_tribo_m\u00eas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UPDATE",
                "UPDATE r_tribo_m\u00eas"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_m\u00eas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_m\u00eas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "vw_faturamento_m\u00eas",
        "type": "View",
        "start": 43456,
        "end": 48389,
        "code": "/****** Object:  View [dbo].[vw_faturamento_m\u00eas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   VIEW [dbo].[vw_faturamento_m\u00eas] AS\n    SELECT\n\t\t [M\u00eas (Primeiro Dia)]\n\t\t,[Cliente]\n\t\t,[Projeto]\n\t\t,[Tribo]\n\n        ,[PAs Contratadas]\n        ,[Valor da PA]\n        ,[Faturamento Antes das Penalidades]\n\t\t,[Total de Penalidades] = ISNULL([Penalidade NS] * [Faturamento Antes das Penalidades], 0)\n\t\t\t\t\t\t\t\t+ ISNULL([Penalidade TMT] * [Faturamento Antes das Penalidades], 0)\n\t\t\t\t\t\t\t\t+ ISNULL([Penalidade TMA] * [Faturamento Antes das Penalidades], 0)\n\t\t\t\t\t\t\t\t+ ISNULL([Penalidade SLA] * [Faturamento Antes das Penalidades], 0)\n\t\t\t\t\t\t\t\t+ ISNULL([Penalidade Abandono] * [Faturamento Antes das Penalidades], 0)\n\t\t\t\t\t\t\t\t+ ISNULL([Penalidade NPS] * [Faturamento Antes das Penalidades], 0)\n\t\t\t\t\t\t\t\t+ ISNULL([Penalidade Casos N\u00e3o Resolvidos] * [Faturamento Antes das Penalidades], 0)\n        ,[Faturamento Ap\u00f3s Penalidades]\n\n        ,[Volume Entrante]                      = CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END\n        ,[Volume Tratado]       \t\t\t\t= CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Atendidas] + [Outbound - Chamadas Atendidas]) ELSE [Tratados] END\n        ,[Forecast Volume]\n\n\t\t,[Log]                                  = DATEADD(s,[Log],0)\n        ,[Log 102%]                             = DATEADD(s,[Log 102%],0)\n        ,[Forecast Log]                         = DATEADD(s,[Forecast Log],0)\n        ,[Ader\u00eancia Log]\n        ,[Ader\u00eancia Log 102%]\n\n\t\t,[Log Produtivo]                        = DATEADD(s,[Log Produtivo],0)\n        ,[Log Produtivo 102%]                   = DATEADD(s,[Log Produtivo 102%],0)\n        ,[Forecast Log Produtivo]               = DATEADD(s,[Forecast Log Produtivo],0)\n        ,[Ader\u00eancia Log Produtivo]\n        ,[Ader\u00eancia Log Produtivo 102%]\n\n\t\t,[NS]                                   = COALESCE([Inbound - % Nivel de Servi\u00e7o],[Outbound - % Nivel de Servi\u00e7o])\n        ,[Forecast NS]\n        ,[Ader\u00eancia NS]\n        ,[Penalidade NS]\n        ,[Causa Raiz Interna NS]                =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF(CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END > [Forecast Volume], CONCAT('Aumento de volume ', IIF(COALESCE([Inbound - TMA], [Outbound - TMA]) <= [Forecast TMA], 'com impacto operacional', 'sem impacto operacional'), ' (TMA); '), '')\n                                                    ))\n        ,[Causa Raiz Cliente NS]                =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF([Ader\u00eancia Log Produtivo] < 1, 'HC liquido logado abaixo do previsto','')\n                                                    ))\n\n\t\t,[TMT]\n        ,[Forecast TMT]\n        ,[Ader\u00eancia TMT]\n        ,[Penalidade TMT]\n\n\t\t,[TMA]                                  = COALESCE([Inbound - TMA],[Outbound - TMA])\n        ,[Forecast TMA]\n        ,[Ader\u00eancia TMA]\n        ,[Penalidade TMA]\n\n        ,[SLA TPR]\n        ,[Forecast SLA]\n        ,[Ader\u00eancia SLA]\n        ,[Penalidade SLA]\n\n\t\t,[Abandono]                             = COALESCE([Inbound - % Abandono],[Outbound - % Abandono])\n        ,[Forecast Abandono]\n        ,[Ader\u00eancia Abandono]\n        ,[Penalidade Abandono]\n        ,[Causa Raiz Interna Abandono]          =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF(CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END > [Forecast Volume], CONCAT('Aumento de volume ', IIF(COALESCE([Inbound - TMA], [Outbound - TMA]) <= [Forecast TMA], 'com impacto operacional', 'sem impacto operacional'), ' (TMA); '), '')\n                                                    ))\n        ,[Causa Raiz Cliente Abandono]          =   IIF([Ader\u00eancia NS] >= 1, '', CONCAT(''\n                                                        ,IIF([Ader\u00eancia Log Produtivo] < 1, 'HC liquido logado abaixo do previsto','')\n                                                    ))\n\n        ,[NPS]\n        ,[Forecast NPS]\n        ,[Ader\u00eancia NPS]\n        ,[Penalidade NPS]\n\n\t\t,[Casos N\u00e3o resolvidos]                 = [N\u00e3o Resolvidos]/NULLIF([Tratados],0)\n        ,[Forecast Casos N\u00e3o Resolvidos]\n        ,[Ader\u00eancia Casos N\u00e3o Resolvidos]\n        ,[Penalidade Casos N\u00e3o Resolvidos]\n\n    FROM r_tribo_m\u00eas\n    WHERE [Cliente] = 'Serasa'\n    AND CASE WHEN [Projeto] IN ('Voz', 'Premium', 'SAC', 'Cadastro Positivo') THEN ([Inbound - Chamadas Iniciadas] + [Outbound - Chamadas Iniciadas]) ELSE [Criados]  END  > 0\n\nGO\n",
        "build_order": 13,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_m\u00eas]": [
                "UNKNOWN",
                "r_tribo_m\u00eas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_m\u00eas]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_faturamento_m\u00eas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_m\u00eas]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_faturamento_m\u00eas]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod1]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod1]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_2clix_analiticosAvaliacoes_cod1",
        "type": "View",
        "start": 48389,
        "end": 48690,
        "code": "/****** Object:  View [dbo].[d_2clix_analiticosAvaliacoes_cod1]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_2clix_analiticosAvaliacoes_cod1] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]\n\n\n\nGO\n",
        "build_order": 14,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_analiticosAvaliacoes_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_analiticosAvaliacoes_cod1]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod3]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod3]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_2clix_analiticosAvaliacoes_cod3",
        "type": "View",
        "start": 48690,
        "end": 48989,
        "code": "/****** Object:  View [dbo].[d_2clix_analiticosAvaliacoes_cod3]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_2clix_analiticosAvaliacoes_cod3] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_analiticosAvaliacoes_cod3\n\n\n\nGO\n",
        "build_order": 15,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_analiticosAvaliacoes_cod3]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_analiticosAvaliacoes_cod3"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_analiticosAvaliacoes_cod3]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_extracaoBaseResumida_cod1]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_extracaoBaseResumida_cod1]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_2clix_extracaoBaseResumida_cod1",
        "type": "View",
        "start": 48989,
        "end": 49288,
        "code": "/****** Object:  View [dbo].[d_2clix_extracaoBaseResumida_cod1]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_2clix_extracaoBaseResumida_cod1] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_extracaoBaseResumida_cod1\n\n\n\nGO\n",
        "build_order": 16,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_extracaoBaseResumida_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_extracaoBaseResumida_cod1"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_extracaoBaseResumida_cod1]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_ExtracaoUsuariosCampanha]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_ExtracaoUsuariosCampanha]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_2clix_ExtracaoUsuariosCampanha",
        "type": "View",
        "start": 49288,
        "end": 49584,
        "code": "/****** Object:  View [dbo].[d_2clix_ExtracaoUsuariosCampanha]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_2clix_ExtracaoUsuariosCampanha] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_ExtracaoUsuariosCampanha\n\n\n\nGO\n",
        "build_order": 17,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_ExtracaoUsuariosCampanha]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_ExtracaoUsuariosCampanha"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_ExtracaoUsuariosCampanha]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_2clix_treinamentos",
        "type": "View",
        "start": 49584,
        "end": 49844,
        "code": "/****** Object:  View [dbo].[d_2clix_treinamentos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_2clix_treinamentos] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_treinamentos\n\n\n\nGO\n",
        "build_order": 18,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_treinamentos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_treinamentos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_treinamentos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos_demandas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos_demandas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_2clix_treinamentos_demandas",
        "type": "View",
        "start": 49844,
        "end": 50131,
        "code": "/****** Object:  View [dbo].[d_2clix_treinamentos_demandas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_2clix_treinamentos_demandas] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_treinamentos_demandas\n\n\n\nGO\n",
        "build_order": 19,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos_demandas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_treinamentos_demandas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos_demandas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_treinamentos_demandas"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos_demandas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_treinamentos_demandas]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_usuarioReuniao]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_usuarioReuniao]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_2clix_usuarioReuniao",
        "type": "View",
        "start": 50131,
        "end": 50397,
        "code": "/****** Object:  View [dbo].[d_2clix_usuarioReuniao]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_2clix_usuarioReuniao] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_usuarioReuniao\n\n\n\nGO\n",
        "build_order": 20,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_usuarioReuniao]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_usuarioReuniao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_usuarioReuniao]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_usuarioReuniao"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_usuarioReuniao]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_2clix_usuarioReuniao]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_calendario",
        "type": "View",
        "start": 50397,
        "end": 50633,
        "code": "/****** Object:  View [dbo].[d_calendario]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_calendario] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_calendario\n\n\n\nGO\n",
        "build_order": 21,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_calendario]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_calendario"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_calendario]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_Calendarioneitor]": [
                "INSERT",
                "INSERT INTO d_calendario"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario_30min]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario_30min]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_calendario_30min",
        "type": "View",
        "start": 50633,
        "end": 50887,
        "code": "/****** Object:  View [dbo].[d_calendario_30min]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_calendario_30min] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_calendario_30min\n\n\n\nGO\n",
        "build_order": 22,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario_30min]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_calendario_30min]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_calendario_30min"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario_30min]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_calendario_30min]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_epbx]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_epbx]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_chamadas_epbx",
        "type": "View",
        "start": 50887,
        "end": 51132,
        "code": "/****** Object:  View [dbo].[d_chamadas_epbx]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_chamadas_epbx] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_chamadas_epbx\n\n\n\nGO\n",
        "build_order": 23,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_epbx]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_chamadas_epbx]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_epbx]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_chamadas_epbx"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_epbx]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_chamadas_epbx]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_genesys]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_genesys]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_chamadas_genesys",
        "type": "View",
        "start": 51132,
        "end": 51386,
        "code": "/****** Object:  View [dbo].[d_chamadas_genesys]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_chamadas_genesys] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_chamadas_genesys\n\n\n\nGO\n",
        "build_order": 24,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_genesys]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_chamadas_genesys]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_chamadas_genesys"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_genesys]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_chamadas_genesys]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_intelix]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_intelix]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_chamadas_intelix",
        "type": "View",
        "start": 51386,
        "end": 51640,
        "code": "/****** Object:  View [dbo].[d_chamadas_intelix]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_chamadas_intelix] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_chamadas_intelix\n\n\n\nGO\n",
        "build_order": 25,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_intelix]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_chamadas_intelix]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_chamadas_intelix"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_intelix]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_chamadas_intelix]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_enps]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_enps]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_enps",
        "type": "View",
        "start": 51640,
        "end": 51858,
        "code": "/****** Object:  View [dbo].[d_enps]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_enps] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_enps\n\n\n\nGO\n",
        "build_order": 26,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_enps]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_enps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_enps]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_enps"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_enps]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_enps]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_feriados_nacionais]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_feriados_nacionais]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_feriados_nacionais",
        "type": "View",
        "start": 51858,
        "end": 52118,
        "code": "/****** Object:  View [dbo].[d_feriados_nacionais]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_feriados_nacionais] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_feriados_nacionais\n\n\n\nGO\n",
        "build_order": 27,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_feriados_nacionais]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_feriados_nacionais]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_feriados_nacionais]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_feriados_nacionais"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_feriados_nacionais]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_feriados_nacionais]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_30min]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_30min]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_forecast_30min",
        "type": "View",
        "start": 52118,
        "end": 52366,
        "code": "/****** Object:  View [dbo].[d_forecast_30min]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_forecast_30min] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_forecast_30min\n\n\n\nGO\n",
        "build_order": 28,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_30min]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_forecast_30min]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_forecast_30min"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_30min]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_forecast_30min]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_metas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_metas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_forecast_metas",
        "type": "View",
        "start": 52366,
        "end": 52614,
        "code": "/****** Object:  View [dbo].[d_forecast_metas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_forecast_metas] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_forecast_metas\n\n\n\nGO\n",
        "build_order": 29,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_metas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_forecast_metas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_forecast_metas"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_metas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_forecast_metas]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_penalidades]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_penalidades]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_forecast_penalidades",
        "type": "View",
        "start": 52614,
        "end": 52880,
        "code": "/****** Object:  View [dbo].[d_forecast_penalidades]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_forecast_penalidades] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_forecast_penalidades\n\n\n\nGO\n",
        "build_order": 30,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_penalidades]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_forecast_penalidades]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_penalidades]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_forecast_penalidades"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_penalidades]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_forecast_penalidades]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_log_ajustes]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_log_ajustes]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_log_ajustes",
        "type": "View",
        "start": 52880,
        "end": 53119,
        "code": "/****** Object:  View [dbo].[d_log_ajustes]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_log_ajustes] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_log_ajustes\n\n\n\nGO\n",
        "build_order": 31,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_ajustes]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_ajustes]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_ajustes]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_ajustes"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_ajustes]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_ajustes]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_log_epbx]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_log_epbx]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_log_epbx",
        "type": "View",
        "start": 53119,
        "end": 53349,
        "code": "/****** Object:  View [dbo].[d_log_epbx]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_log_epbx] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_log_epbx\n\n\n\nGO\n",
        "build_order": 32,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_epbx]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_epbx]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_epbx]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_epbx"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_epbx]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_epbx]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_log_genesys]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_log_genesys]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_log_genesys",
        "type": "View",
        "start": 53349,
        "end": 53588,
        "code": "/****** Object:  View [dbo].[d_log_genesys]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_log_genesys] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_log_genesys\n\n\n\nGO\n",
        "build_order": 33,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_genesys]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_genesys]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_genesys]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_genesys"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_genesys]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_genesys]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_log_intelix]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_log_intelix]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_log_intelix",
        "type": "View",
        "start": 53588,
        "end": 53827,
        "code": "/****** Object:  View [dbo].[d_log_intelix]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_log_intelix] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_log_intelix\n\n\n\nGO\n",
        "build_order": 34,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_intelix]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_intelix]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_intelix]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_intelix"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_intelix]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_intelix]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horaextra]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horaextra]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_log_secullum_horaextra",
        "type": "View",
        "start": 53827,
        "end": 54099,
        "code": "/****** Object:  View [dbo].[d_log_secullum_horaextra]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_log_secullum_horaextra] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_log_secullum_horaextra\n\n\n\nGO\n",
        "build_order": 35,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horaextra]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_secullum_horaextra]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horaextra]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_secullum_horaextra"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horaextra]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_secullum_horaextra]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horarios]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horarios]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_log_secullum_horarios",
        "type": "View",
        "start": 54099,
        "end": 54368,
        "code": "/****** Object:  View [dbo].[d_log_secullum_horarios]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_log_secullum_horarios] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_log_secullum_horarios\n\n\n\nGO\n",
        "build_order": 36,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_secullum_horarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_secullum_horarios"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_log_secullum_horarios]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_contas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_contas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_contas",
        "type": "View",
        "start": 54368,
        "end": 54610,
        "code": "/****** Object:  View [dbo].[d_mendi_contas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_contas] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_contas\n\n\n\nGO\n",
        "build_order": 37,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_contas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_contas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_contas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_contas"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_contas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_contas]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_creditos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_creditos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_creditos",
        "type": "View",
        "start": 54610,
        "end": 54858,
        "code": "/****** Object:  View [dbo].[d_mendi_creditos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_creditos] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_creditos\n\n\n\nGO\n",
        "build_order": 38,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_creditos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_creditos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_creditos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_creditos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_creditos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_creditos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_faltas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_faltas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_faltas",
        "type": "View",
        "start": 54858,
        "end": 55100,
        "code": "/****** Object:  View [dbo].[d_mendi_faltas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_faltas] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_faltas\n\n\n\nGO\n",
        "build_order": 39,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_faltas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_faltas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_faltas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_faltas"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_faltas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_faltas]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_forms]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_forms]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_forms",
        "type": "View",
        "start": 55100,
        "end": 55339,
        "code": "/****** Object:  View [dbo].[d_mendi_forms]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_forms] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_forms\n\n\n\nGO\n",
        "build_order": 40,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_forms]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_forms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_forms]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_forms"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_forms]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_forms]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_oneaone]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_oneaone]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_oneaone",
        "type": "View",
        "start": 55339,
        "end": 55584,
        "code": "/****** Object:  View [dbo].[d_mendi_oneaone]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_oneaone] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_oneaone\n\n\n\nGO\n",
        "build_order": 41,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_oneaone]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_oneaone]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_oneaone]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_oneaone"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_oneaone]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_oneaone]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod12]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod12]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod12",
        "type": "View",
        "start": 55584,
        "end": 55859,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod12]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod12] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod12\n\n\n\nGO\n",
        "build_order": 42,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod12]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod12]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod12]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod12"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod12]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod12]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod15]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod15]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod15",
        "type": "View",
        "start": 55859,
        "end": 56134,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod15]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod15] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod15\n\n\n\nGO\n",
        "build_order": 43,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod15]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod15]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod15]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod15"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod15]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod15]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod301]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod301]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod301",
        "type": "View",
        "start": 56134,
        "end": 56412,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod301]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod301] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod301\n\n\n\nGO\n",
        "build_order": 44,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod301]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod301]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod301]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod301"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod301]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod301]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod304]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod304]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod304",
        "type": "View",
        "start": 56412,
        "end": 56690,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod304]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod304] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod304\n\n\n\nGO\n",
        "build_order": 45,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod304]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod304]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod304]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod304"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod304]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod304]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod61]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod61]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod61",
        "type": "View",
        "start": 56690,
        "end": 56965,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod61]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod61] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod61\n\n\n\nGO\n",
        "build_order": 46,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod61]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod61]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod61]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod61"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod61]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod61]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod613]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod613]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod613",
        "type": "View",
        "start": 56965,
        "end": 57243,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod613]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod613] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod613\n\n\n\nGO\n",
        "build_order": 47,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod613]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod613]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod613]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod613"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod613]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod613]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod62]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod62]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod62",
        "type": "View",
        "start": 57243,
        "end": 57518,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod62]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod62] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod62\n\n\n\nGO\n",
        "build_order": 48,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod62]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod62]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod62]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod62"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod62]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod62]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod7]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod7]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod7",
        "type": "View",
        "start": 57518,
        "end": 57790,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod7]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod7] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod7\n\n\n\nGO\n",
        "build_order": 49,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod7]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod7]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod7"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod7]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod7]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod78]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod78]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod78",
        "type": "View",
        "start": 57790,
        "end": 58065,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod78]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod78] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod78\n\n\n\nGO\n",
        "build_order": 50,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod78]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod78]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod78]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod78"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod78]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod78]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod79]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod79]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod79",
        "type": "View",
        "start": 58065,
        "end": 58340,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod79]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod79] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod79\n\n\n\nGO\n",
        "build_order": 51,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod79]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod79]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod79]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod79"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod79]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod79]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod8]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod8]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod8",
        "type": "View",
        "start": 58340,
        "end": 58612,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod8]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod8] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod8\n\n\n\nGO\n",
        "build_order": 52,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod8]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod8]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod8]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod8"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod8]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod8]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod807]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod807]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mendi_saudevianet_cod807",
        "type": "View",
        "start": 58612,
        "end": 58890,
        "code": "/****** Object:  View [dbo].[d_mendi_saudevianet_cod807]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mendi_saudevianet_cod807] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod807\n\n\n\nGO\n",
        "build_order": 53,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod807]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod807]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod807]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod807"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod807]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mendi_saudevianet_cod807]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_cadastros]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_cadastros]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mop_cadastros",
        "type": "View",
        "start": 58890,
        "end": 59135,
        "code": "/****** Object:  View [dbo].[d_mop_cadastros]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mop_cadastros] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mop_cadastros\n\n\n\nGO\n",
        "build_order": 54,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_cadastros]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mop_cadastros]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_cadastros]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mop_cadastros"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_cadastros]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mop_cadastros]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_contatos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_contatos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mop_contatos",
        "type": "View",
        "start": 59135,
        "end": 59377,
        "code": "/****** Object:  View [dbo].[d_mop_contatos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mop_contatos] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mop_contatos\n\n\n\nGO\n",
        "build_order": 55,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_contatos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mop_contatos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_contatos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mop_contatos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_contatos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mop_contatos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_eventos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mop_eventos",
        "type": "View",
        "start": 59377,
        "end": 59616,
        "code": "/****** Object:  View [dbo].[d_mop_eventos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mop_eventos] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mop_eventos\n\n\n\nGO\n",
        "build_order": 56,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_eventos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mop_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mop_eventos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_eventos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mop_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_sinalizacoes]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_sinalizacoes]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_mop_sinalizacoes",
        "type": "View",
        "start": 59616,
        "end": 59870,
        "code": "/****** Object:  View [dbo].[d_mop_sinalizacoes]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_mop_sinalizacoes] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_mop_sinalizacoes\n\n\n\nGO\n",
        "build_order": 57,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_sinalizacoes]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mop_sinalizacoes]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_sinalizacoes]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mop_sinalizacoes"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_sinalizacoes]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_mop_sinalizacoes]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_municipios]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_municipios]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_municipios",
        "type": "View",
        "start": 59870,
        "end": 60106,
        "code": "/****** Object:  View [dbo].[d_municipios]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_municipios] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_municipios\n\n\n\nGO\n",
        "build_order": 58,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_municipios]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_municipios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_municipios]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_municipios"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_municipios]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_municipios]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_nps]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_nps]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_nps",
        "type": "View",
        "start": 60106,
        "end": 60320,
        "code": "/****** Object:  View [dbo].[d_nps]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_nps] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].tb_nps\n\n\n\nGO\n",
        "build_order": 59,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_nps]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_nps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[tb_nps]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].tb_nps"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_nps]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_nps]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_prognostico]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_prognostico]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_prognostico",
        "type": "View",
        "start": 60320,
        "end": 60559,
        "code": "/****** Object:  View [dbo].[d_prognostico]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_prognostico] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_prognostico\n\n\n\nGO\n",
        "build_order": 60,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_prognostico]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_prognostico]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_prognostico"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_prognostico]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_prognostico]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_afastamentos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_afastamentos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_secullum_afastamentos",
        "type": "View",
        "start": 60559,
        "end": 60828,
        "code": "/****** Object:  View [dbo].[d_secullum_afastamentos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_secullum_afastamentos] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_secullum_afastamentos\n\n\n\nGO\n",
        "build_order": 61,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_afastamentos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_secullum_afastamentos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_afastamentos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_secullum_afastamentos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_afastamentos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_secullum_afastamentos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_batidas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_batidas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_secullum_batidas",
        "type": "View",
        "start": 60828,
        "end": 61082,
        "code": "/****** Object:  View [dbo].[d_secullum_batidas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_secullum_batidas] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_secullum_batidas\n\n\n\nGO\n",
        "build_order": 62,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_batidas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_secullum_batidas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_secullum_batidas"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_batidas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_secullum_batidas]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_funcionarios]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_funcionarios]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_secullum_funcionarios",
        "type": "View",
        "start": 61082,
        "end": 61351,
        "code": "/****** Object:  View [dbo].[d_secullum_funcionarios]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_secullum_funcionarios] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_secullum_funcionarios\n\n\n\nGO\n",
        "build_order": 63,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_funcionarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_secullum_funcionarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_secullum_funcionarios"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_funcionarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_secullum_funcionarios]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_criados]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_criados]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_teste_criados",
        "type": "View",
        "start": 61351,
        "end": 61596,
        "code": "/****** Object:  View [dbo].[d_teste_criados]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_teste_criados] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_teste_criados\n\n\n\nGO\n",
        "build_order": 64,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_criados]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_teste_criados]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_criados]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_criados"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_criados]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_teste_criados]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_resolvidos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_resolvidos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_teste_resolvidos",
        "type": "View",
        "start": 61596,
        "end": 61850,
        "code": "/****** Object:  View [dbo].[d_teste_resolvidos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_teste_resolvidos] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_teste_resolvidos\n\n\n\nGO\n",
        "build_order": 65,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_resolvidos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_teste_resolvidos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_resolvidos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_resolvidos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_resolvidos]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_teste_resolvidos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_sla]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_sla]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_teste_sla",
        "type": "View",
        "start": 61850,
        "end": 62083,
        "code": "/****** Object:  View [dbo].[d_teste_sla]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_teste_sla] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_teste_sla\n\n\n\nGO\n",
        "build_order": 66,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_sla]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_teste_sla]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_sla]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_sla"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_sla]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_teste_sla]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein30d]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein30d]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_tickets_rein30d",
        "type": "View",
        "start": 62083,
        "end": 62340,
        "code": "/****** Object:  View [dbo].[d_tickets_rein30d]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_tickets_rein30d] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tickets_rein30d\n\n\n\nGO\n",
        "build_order": 67,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein30d]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_rein30d]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein30d]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tickets_rein30d"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein30d]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_rein30d]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein48h]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein48h]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_tickets_rein48h",
        "type": "View",
        "start": 62340,
        "end": 62597,
        "code": "/****** Object:  View [dbo].[d_tickets_rein48h]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_tickets_rein48h] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tickets_rein48h\n\n\n\nGO\n",
        "build_order": 68,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein48h]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_rein48h]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein48h]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tickets_rein48h"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein48h]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_rein48h]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_replicas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_replicas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_tickets_replicas",
        "type": "View",
        "start": 62597,
        "end": 62851,
        "code": "/****** Object:  View [dbo].[d_tickets_replicas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_tickets_replicas] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_tickets_replicas\n\n\n\nGO\n",
        "build_order": 69,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_replicas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_replicas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_replicas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_tickets_replicas"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_replicas]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_replicas]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tags]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tags]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_tickets_tags",
        "type": "View",
        "start": 62851,
        "end": 63093,
        "code": "/****** Object:  View [dbo].[d_tickets_tags]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_tickets_tags] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_tickets_tags\n\n\n\nGO\n",
        "build_order": 70,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tags]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_tags]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_tags]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_tickets_tags"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tags]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_tags]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tmt]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tmt]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_tickets_tmt",
        "type": "View",
        "start": 63093,
        "end": 63330,
        "code": "/****** Object:  View [dbo].[d_tickets_tmt]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_tickets_tmt] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tmt\n\n\n\nGO\n",
        "build_order": 71,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tmt]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_tmt]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tmt]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tmt"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tmt]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_tmt]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tratados]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tratados]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_tickets_tratados",
        "type": "View",
        "start": 63330,
        "end": 63582,
        "code": "/****** Object:  View [dbo].[d_tickets_tratados]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_tickets_tratados] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tratados\n\n\n\nGO\n",
        "build_order": 72,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tratados]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_tratados]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tratados]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tratados"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tratados]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_tickets_tratados]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_unico_funcionarios]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_unico_funcionarios]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_unico_funcionarios",
        "type": "View",
        "start": 63582,
        "end": 63842,
        "code": "/****** Object:  View [dbo].[d_unico_funcionarios]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_unico_funcionarios] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_unico_funcionarios\n\n\n\nGO\n",
        "build_order": 73,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_unico_funcionarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_unico_funcionarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_unico_funcionarios]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_unico_funcionarios"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_unico_funcionarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_unico_funcionarios]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_you_forms]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_you_forms]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_you_forms",
        "type": "View",
        "start": 63842,
        "end": 64075,
        "code": "/****** Object:  View [dbo].[d_you_forms]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_you_forms] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_you_forms\n\n\n\nGO\n",
        "build_order": 74,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_you_forms]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_you_forms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_forms]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_you_forms"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_you_forms]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_you_forms]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_you_gendo]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_you_gendo]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_you_gendo",
        "type": "View",
        "start": 64075,
        "end": 64308,
        "code": "/****** Object:  View [dbo].[d_you_gendo]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[d_you_gendo] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].dim_you_gendo\n\n\n\nGO\n",
        "build_order": 75,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_you_gendo]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_you_gendo]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_you_gendo"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_you_gendo]": [
                "CREATE",
                "CREATE VIEW [dbo].[d_you_gendo]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod1]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_2clix_analiticosAvaliacoes_cod1",
        "type": "View",
        "start": 64308,
        "end": 64605,
        "code": "/****** Object:  View [dbo].[f_2clix_analiticosAvaliacoes_cod1]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_2clix_analiticosAvaliacoes_cod1] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod1\n\n\n\nGO\n",
        "build_order": 76,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod1"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod1]": [
                "UNKNOWN",
                "f_2clix_analiticosAvaliacoes_cod1"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod3]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_2clix_analiticosAvaliacoes_cod3",
        "type": "View",
        "start": 64605,
        "end": 64902,
        "code": "/****** Object:  View [dbo].[f_2clix_analiticosAvaliacoes_cod3]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_2clix_analiticosAvaliacoes_cod3] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod3\n\n\n\nGO\n",
        "build_order": 77,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod3"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod3]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod3]": [
                "UNKNOWN",
                "f_2clix_analiticosAvaliacoes_cod3"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_extracaoBaseResumida_cod1]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_extracaoBaseResumida_cod1]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_2clix_extracaoBaseResumida_cod1",
        "type": "View",
        "start": 64902,
        "end": 65199,
        "code": "/****** Object:  View [dbo].[f_2clix_extracaoBaseResumida_cod1]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_2clix_extracaoBaseResumida_cod1] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_2clix_extracaoBaseResumida_cod1\n\n\n\nGO\n",
        "build_order": 78,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_extracaoBaseResumida_cod1"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_extracaoBaseResumida_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * INTO f_2clix_extracaoBaseResumida_cod1"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_ExtracaoUsuariosCampanha]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_2clix_ExtracaoUsuariosCampanha",
        "type": "View",
        "start": 65199,
        "end": 65493,
        "code": "/****** Object:  View [dbo].[f_2clix_ExtracaoUsuariosCampanha]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_2clix_ExtracaoUsuariosCampanha] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_2clix_ExtracaoUsuariosCampanha\n\n\n\nGO\n",
        "build_order": 79,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_ExtracaoUsuariosCampanha"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_ExtracaoUsuariosCampanha]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * INTO f_2clix_ExtracaoUsuariosCampanha"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_chamadas",
        "type": "View",
        "start": 65493,
        "end": 65721,
        "code": "/****** Object:  View [dbo].[f_chamadas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_chamadas] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_chamadas\n\n\n\nGO\n",
        "build_order": 80,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_chamadas"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_chamadas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_chamadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "SELECT",
                "SELECT * FROM [f_chamadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_chamadas"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_enps]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_enps]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_enps",
        "type": "View",
        "start": 65721,
        "end": 65937,
        "code": "/****** Object:  View [dbo].[f_enps]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_enps] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_enps\n\n\n\nGO\n",
        "build_order": 81,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_enps]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_enps]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_enps"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_enps]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_enps]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_enps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_enps]": [
                "SELECT",
                "SELECT * INTO f_enps"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_log]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_log",
        "type": "View",
        "start": 65937,
        "end": 66150,
        "code": "/****** Object:  View [dbo].[f_log]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_log] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_log\n\n\n\nGO\n",
        "build_order": 82,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_log"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_log"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_log"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "ALTER",
                "ALTER TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado_semTrava]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_log]": [
                "SELECT",
                "SELECT * FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "SELECT",
                "SELECT [Retorno]=CONCAT('f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": [
                "SELECT",
                "SELECT SUM(sub.[Dura\u00e7\u00e3o]) - (c.[Jornada (Log)]+7200000) FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_log"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_mendi_oneaone]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_mendi_oneaone]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_mendi_oneaone",
        "type": "View",
        "start": 66150,
        "end": 66393,
        "code": "/****** Object:  View [dbo].[f_mendi_oneaone]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_mendi_oneaone] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_mendi_oneaone\n\n\n\nGO\n",
        "build_order": 83,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mendi_oneaone]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mendi_oneaone]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mendi_oneaone"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mendi_oneaone]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mendi_oneaone]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mendi_oneaone]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mendi_oneaone]": [
                "SELECT",
                "SELECT * INTO f_mendi_oneaone"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_mop_eventos",
        "type": "View",
        "start": 66393,
        "end": 66630,
        "code": "/****** Object:  View [dbo].[f_mop_eventos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_mop_eventos] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_mop_eventos\n\n\n\nGO\n",
        "build_order": 84,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_eventos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mopeventos_dma_complete]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_turnover]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o], [Data da Proxima Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Intelix], [ID EPBX], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [DMA Inicial], [\u00daltima DMA Migra\u00e7\u00e3o], [\u00daltima DMA Geral], [Tipo da \u00daltima DMA], [Instrutor Inicial], [Instrutor \u00daltima Migra\u00e7\u00e3o], [Instrutor \u00daltima DMA], [Cliente], [Projeto], [Cargo], [Tribo], [Supervis\u00e3o], [Escala], [Jornada], [Taxa] FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_mop_eventos"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_mop_historico",
        "type": "View",
        "start": 66630,
        "end": 66873,
        "code": "/****** Object:  View [dbo].[f_mop_historico]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_mop_historico] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_mop_historico\n\n\n\nGO\n",
        "build_order": 85,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_historico"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_historico]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_h_detalhadas]": [
                "SELECT",
                "SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_metas]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado_semTrava]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": [
                "SELECT",
                "SELECT * FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_quadro_funcionarios_dia]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_turnover]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Selecionar] as ID_selecionar, nome, tribo, [Sub Tribo] as subtribo, [Supervis\u00e3o] as supervisao, status FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "SELECT",
                "SELECT * FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_mop_historico"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_mop_vigente",
        "type": "View",
        "start": 66873,
        "end": 67110,
        "code": "/****** Object:  View [dbo].[f_mop_vigente]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_mop_vigente] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_mop_vigente\n\n\n\nGO\n",
        "build_order": 86,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_vigente"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_vigente]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod3]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": [
                "SELECT",
                "SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "SELECT",
                "SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "SELECT",
                "SELECT data_to = CAST([Data da Atualiza\u00e7\u00e3o] AS DATE), data_ev, [ID Intelix], [ID Selecionar], diff = DATEDIFF(DAY, [Data da Atualiza\u00e7\u00e3o], data_ev), [Motivo do Desligamento (Turnover)]  FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_mop_vigente"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_nps]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_nps]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_nps",
        "type": "View",
        "start": 67110,
        "end": 67326,
        "code": "/****** Object:  View [dbo].[f_nps]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_nps] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_nps_V2\n\n\n\nGO\n",
        "build_order": 87,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_nps]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_nps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_nps_V2"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_nps]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_nps]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "f_tickets",
        "type": "View",
        "start": 67326,
        "end": 67551,
        "code": "/****** Object:  View [dbo].[f_tickets]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[f_tickets] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].f_tickets\n\n\n\nGO\n",
        "build_order": 88,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_tickets"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_tickets"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_tickets]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_tickets_tags]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT subtribo_serasa=[tribo], CAST(Resolu\u00e7\u00e3o AS DATE) as data, COUNT([Resolvido?]) as tratados FROM f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": [
                "SELECT",
                "SELECT * FROM f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_tickets"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_contatos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_contatos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "h_d_mop_contatos",
        "type": "View",
        "start": 67551,
        "end": 67802,
        "code": "/****** Object:  View [dbo].[h_d_mop_contatos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[h_d_mop_contatos] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].hist_dim_mop_contatos\n\n\n\nGO\n",
        "build_order": 89,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_contatos]": [
                "CREATE",
                "CREATE VIEW [dbo].[h_d_mop_contatos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_contatos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].hist_dim_mop_contatos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_contatos]": [
                "CREATE",
                "CREATE VIEW [dbo].[h_d_mop_contatos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_eventos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "h_d_mop_eventos",
        "type": "View",
        "start": 67802,
        "end": 68050,
        "code": "/****** Object:  View [dbo].[h_d_mop_eventos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[h_d_mop_eventos] AS\n\tSELECT * FROM [db_Serasa_producao].[dbo].hist_dim_mop_eventos\n\n\n\nGO\n",
        "build_order": 90,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_eventos]": [
                "CREATE",
                "CREATE VIEW [dbo].[h_d_mop_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_eventos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].hist_dim_mop_eventos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_eventos]": [
                "CREATE",
                "CREATE VIEW [dbo].[h_d_mop_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_genesys_eventos",
        "type": "Table",
        "start": 68050,
        "end": 68719,
        "code": "/****** Object:  Table [dbo].[d_genesys_eventos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_genesys_eventos](\n\t[genesys_usuario_id] [varchar](100) NOT NULL,\n\t[genesys_pausa_id] [varchar](100) NOT NULL,\n\t[datahora_inicio] [datetime] NOT NULL,\n\t[datahora_fim] [datetime] NULL,\n CONSTRAINT [d_genesys_eventos_PK] PRIMARY KEY CLUSTERED \n(\n\t[datahora_inicio] ASC,\n\t[genesys_usuario_id] ASC,\n\t[genesys_pausa_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n",
        "build_order": 91,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[d_genesys_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_genesys_pausas",
        "type": "Table",
        "start": 68719,
        "end": 69340,
        "code": "/****** Object:  Table [dbo].[d_genesys_pausas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_genesys_pausas](\n\t[genesys_pausa_id] [varchar](100) NOT NULL,\n\t[tipo] [varchar](max) NOT NULL,\n\t[presenca] [varchar](max) NOT NULL,\n\t[nome] [varchar](max) NOT NULL,\n CONSTRAINT [d_genesys_pausas_PK] PRIMARY KEY CLUSTERED \n(\n\t[genesys_pausa_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 92,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_pausas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "UNKNOWN",
                "[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_genesys_usuarios",
        "type": "Table",
        "start": 69340,
        "end": 70039,
        "code": "/****** Object:  Table [dbo].[d_genesys_usuarios]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_genesys_usuarios](\n\t[genesys_usuario_id] [varchar](100) NOT NULL,\n\t[nome] [varchar](max) NOT NULL,\n\t[email] [varchar](max) NOT NULL,\n\t[divisao] [varchar](max) NOT NULL,\n\t[departamento] [varchar](max) NULL,\n\t[titulo] [varchar](max) NULL,\n CONSTRAINT [d_genesys_usuarios_PK] PRIMARY KEY CLUSTERED \n(\n\t[genesys_usuario_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 93,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "UNKNOWN",
                "[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_intelix_eventos",
        "type": "Table",
        "start": 70039,
        "end": 70796,
        "code": "/****** Object:  Table [dbo].[d_intelix_eventos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_intelix_eventos](\n\t[intelix_usuario_id] [int] NOT NULL,\n\t[evento] [varchar](100) NOT NULL,\n\t[nome_pausa] [varchar](100) NOT NULL,\n\t[datahora_inicio] [datetime] NOT NULL,\n\t[datahora_fim] [datetime] NULL,\n\t[complemento] [varchar](max) NULL,\n CONSTRAINT [d_intelix_eventos_PK] PRIMARY KEY CLUSTERED \n(\n\t[datahora_inicio] ASC,\n\t[intelix_usuario_id] ASC,\n\t[evento] ASC,\n\t[nome_pausa] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 94,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[d_intelix_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "d_intelix_usuarios",
        "type": "Table",
        "start": 70796,
        "end": 71348,
        "code": "/****** Object:  Table [dbo].[d_intelix_usuarios]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_intelix_usuarios](\n\t[intelix_usuario_id] [int] NOT NULL,\n\t[nome] [varchar](max) NOT NULL,\n CONSTRAINT [d_intelix_usuarios_PK] PRIMARY KEY CLUSTERED \n(\n\t[intelix_usuario_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 95,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "UNKNOWN",
                "[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "r_individuo_30min",
        "type": "Table",
        "start": 71348,
        "end": 81317,
        "code": "/****** Object:  Table [dbo].[r_individuo_30min]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_individuo_30min](\n\t[DataHora] [datetime2](3) NOT NULL,\n\t[Intervalo] [time](3) NULL,\n\t[Data] [date] NULL,\n\t[Ciclo (Primeiro Dia)] [date] NULL,\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Feriado (Nome)] [varchar](50) NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[DataHora da Atualiza\u00e7\u00e3o do MOP] [datetime2](0) NULL,\n\t[ID Selecionar] [varchar](30) NULL,\n\t[Nome] [varchar](100) NULL,\n\t[Status] [varchar](25) NULL,\n\t[Situa\u00e7\u00e3o] [varchar](25) NULL,\n\t[Condi\u00e7\u00e3o] [varchar](25) NULL,\n\t[DMA Inicial] [int] NULL,\n\t[\u00daltima DMA Migra\u00e7\u00e3o] [int] NULL,\n\t[\u00daltima DMA Geral] [int] NULL,\n\t[Tipo da \u00daltima DMA] [varchar](50) NULL,\n\t[Instrutor Inicial] [varchar](100) NULL,\n\t[Instrutor \u00daltima Migra\u00e7\u00e3o] [varchar](100) NULL,\n\t[Instrutor \u00daltima DMA] [varchar](100) NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Cargo] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Supervis\u00e3o] [varchar](100) NULL,\n\t[Turno] [varchar](10) NULL,\n\t[Escala (Ponto)] [varchar](15) NULL,\n\t[Jornada (Ponto)] [int] NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Escala (MOP)] [varchar](15) NULL,\n\t[Jornada (Log)] [int] NOT NULL,\n\t[Tipo de Jornada] [varchar](25) NULL,\n\t[Login] [time](3) NULL,\n\t[Logout] [time](3) NULL,\n\t[Log descartado (>2HE)] [decimal](18, 4) NOT NULL,\n\t[Log HE] [decimal](18, 4) NOT NULL,\n\t[Log] [decimal](18, 4) NOT NULL,\n\t[Log Produtivo] [decimal](18, 4) NOT NULL,\n\t[Log Improdutivo] [decimal](18, 4) NOT NULL,\n\t[Tempo Livre] [decimal](18, 4) NOT NULL,\n\t[Pausa Particular (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Break (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa 10 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Outbound (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Intervalo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Login (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa BackOffice (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Descanso (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Backoffice (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Em Fila (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [decimal](18, 4) NOT NULL,\n\t[Inbound - TMA] [decimal](18, 4) NOT NULL,\n\t[Inbound - TME] [decimal](18, 4) NOT NULL,\n\t[Inbound - TMO] [decimal](18, 4) NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [decimal](18, 4) NOT NULL,\n\t[Outbound - TMA] [decimal](18, 4) NOT NULL,\n\t[Outbound - TME] [decimal](18, 4) NOT NULL,\n\t[Outbound - TMO] [decimal](18, 4) NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[NPS] [int] NULL,\n\t[\u00c9 A Tribo do MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Email Supervis\u00e3o] [varchar](100) NULL,\n\t[Login (Ponto)] [time](3) NULL,\n\t[Logout (Ponto)] [time](3) NULL,\n\t[Tipo de Jornada (Ponto)] [varchar](25) NULL,\n\t[Tempo de Casa (Dias)] [int] NULL,\n\t[Faixa Tempo de Casa] [varchar](15) NULL,\n\t[Idade] [int] NULL,\n\t[Faixa de Idade] [varchar](16) NULL,\n\t[Desvio Ponto-Log] [int] NULL,\n\t[Fonte de Log] [varchar](10) NULL,\n\t[Tempo Total (Intelix)] [bigint] NOT NULL,\n\t[Tempo Total (EPBX)] [bigint] NOT NULL,\n\t[Tempo Total (Genesys)] [bigint] NOT NULL,\n\t[Tempo Total (Secullum)] [bigint] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 96,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_30min]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "r_individuo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_individuo_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT * INTO r_individuo_30m_mili FROM r_individuo_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "r_individuo_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON [r_individuo_30min]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "r_individuo_dia",
        "type": "Table",
        "start": 81317,
        "end": 90204,
        "code": "/****** Object:  Table [dbo].[r_individuo_dia]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_individuo_dia](\n\t[Data] [date] NULL,\n\t[Ciclo (Primeiro Dia)] [date] NULL,\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Feriado (Nome)] [varchar](50) NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[DataHora da Atualiza\u00e7\u00e3o do MOP] [datetime2](0) NULL,\n\t[ID Selecionar] [varchar](30) NULL,\n\t[Nome] [varchar](100) NULL,\n\t[Status] [varchar](25) NULL,\n\t[Situa\u00e7\u00e3o] [varchar](25) NULL,\n\t[Condi\u00e7\u00e3o] [varchar](25) NULL,\n\t[DMA Inicial] [int] NULL,\n\t[\u00daltima DMA Migra\u00e7\u00e3o] [int] NULL,\n\t[\u00daltima DMA Geral] [int] NULL,\n\t[Tipo da \u00daltima DMA] [varchar](50) NULL,\n\t[Instrutor Inicial] [varchar](100) NULL,\n\t[Instrutor \u00daltima Migra\u00e7\u00e3o] [varchar](100) NULL,\n\t[Instrutor \u00daltima DMA] [varchar](100) NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Cargo] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Supervis\u00e3o] [varchar](100) NULL,\n\t[Turno] [varchar](10) NULL,\n\t[Escala (Ponto)] [varchar](15) NULL,\n\t[Jornada (Ponto)] [int] NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Escala (MOP)] [varchar](15) NULL,\n\t[Jornada (Log)] [int] NOT NULL,\n\t[Tipo de Jornada] [varchar](25) NULL,\n\t[Login] [time](0) NULL,\n\t[Logout] [time](0) NULL,\n\t[Log descartado (>2HE)] [int] NOT NULL,\n\t[Log HE] [int] NOT NULL,\n\t[Log] [int] NOT NULL,\n\t[Log Produtivo] [int] NOT NULL,\n\t[Log Improdutivo] [int] NOT NULL,\n\t[Tempo Livre] [int] NOT NULL,\n\t[Pausa Particular (Intelix)] [int] NOT NULL,\n\t[Pausa Break (Intelix)] [int] NOT NULL,\n\t[Pausa 10 (Intelix)] [int] NOT NULL,\n\t[Pausa Outbound (Intelix)] [int] NOT NULL,\n\t[Pausa Lanche (Intelix)] [int] NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [int] NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [int] NOT NULL,\n\t[Pausa Feedback (Intelix)] [int] NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [int] NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [int] NOT NULL,\n\t[Pausa Treinamento (Intelix)] [int] NOT NULL,\n\t[Pausa Banheiro (Intelix)] [int] NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [int] NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [int] NOT NULL,\n\t[Pausa NR17 (Intelix)] [int] NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [int] NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [int] NOT NULL,\n\t[Pausa Tratativa (EPBX)] [int] NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [int] NOT NULL,\n\t[Pausa Banheiro (EPBX)] [int] NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [int] NOT NULL,\n\t[Pausa Intervalo (EPBX)] [int] NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [int] NOT NULL,\n\t[Pausa Treinamento (EPBX)] [int] NOT NULL,\n\t[Pausa Feedback (EPBX)] [int] NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [int] NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [int] NOT NULL,\n\t[Pausa Login (EPBX)] [int] NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [int] NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [int] NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [int] NOT NULL,\n\t[Pausa NR17 (EPBX)] [int] NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [int] NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [int] NOT NULL,\n\t[Pausa Lanche (EPBX)] [int] NOT NULL,\n\t[Pausa BackOffice (EPBX)] [int] NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [int] NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [int] NOT NULL,\n\t[Pausa Banheiro (Genesys)] [int] NOT NULL,\n\t[Pausa Descanso (Genesys)] [int] NOT NULL,\n\t[Pausa Feedback (Genesys)] [int] NOT NULL,\n\t[Pausa Backoffice (Genesys)] [int] NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [int] NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [int] NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [int] NOT NULL,\n\t[Pausa Em Fila (Genesys)] [int] NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [int] NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [int] NOT NULL,\n\t[Pausa Tratativa (Genesys)] [int] NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [int] NOT NULL,\n\t[Pausa Treinamento (Genesys)] [int] NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [int] NOT NULL,\n\t[Inbound - TMA] [int] NOT NULL,\n\t[Inbound - TME] [int] NOT NULL,\n\t[Inbound - TMO] [int] NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [int] NOT NULL,\n\t[Outbound - TMA] [int] NOT NULL,\n\t[Outbound - TME] [int] NOT NULL,\n\t[Outbound - TMO] [int] NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[NPS] [int] NULL,\n\t[\u00c9 A Tribo do MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Email Supervis\u00e3o] [varchar](100) NULL,\n\t[Login (Ponto)] [time](3) NULL,\n\t[Logout (Ponto)] [time](3) NULL,\n\t[Tipo de Jornada (Ponto)] [varchar](25) NULL,\n\t[Tempo de Casa (Dias)] [int] NULL,\n\t[Faixa Tempo de Casa] [varchar](15) NULL,\n\t[Idade] [int] NULL,\n\t[Faixa de Idade] [varchar](16) NULL,\n\t[Desvio Ponto-Log] [int] NULL,\n\t[Fonte de Log] [varchar](10) NULL,\n\t[Tempo Total (Intelix)] [bigint] NOT NULL,\n\t[Tempo Total (EPBX)] [bigint] NOT NULL,\n\t[Tempo Total (Genesys)] [bigint] NOT NULL,\n\t[Tempo Total (Secullum)] [bigint] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 97,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_dia]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "r_individuo_dia"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_individuo_dia"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "SELECT",
                "SELECT * FROM [r_individuo_dia]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON [r_individuo_dia]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "r_individuo_m\u00eas",
        "type": "Table",
        "start": 90204,
        "end": 99601,
        "code": "/****** Object:  Table [dbo].[r_individuo_m\u00eas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_individuo_m\u00eas](\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[DataHora da Atualiza\u00e7\u00e3o do MOP] [datetime2](0) NULL,\n\t[ID Selecionar] [varchar](30) NULL,\n\t[Nome] [varchar](100) NULL,\n\t[Status] [varchar](25) NULL,\n\t[Situa\u00e7\u00e3o] [varchar](25) NULL,\n\t[Condi\u00e7\u00e3o] [varchar](25) NULL,\n\t[DMA Inicial] [int] NULL,\n\t[\u00daltima DMA Migra\u00e7\u00e3o] [int] NULL,\n\t[\u00daltima DMA Geral] [int] NULL,\n\t[Tipo da \u00daltima DMA] [varchar](50) NULL,\n\t[Instrutor Inicial] [varchar](100) NULL,\n\t[Instrutor \u00daltima Migra\u00e7\u00e3o] [varchar](100) NULL,\n\t[Instrutor \u00daltima DMA] [varchar](100) NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Cargo] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Supervis\u00e3o] [varchar](100) NULL,\n\t[Turno] [varchar](10) NULL,\n\t[Escala (Ponto)] [varchar](15) NULL,\n\t[Jornada (Ponto)] [int] NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Escala (MOP)] [varchar](15) NULL,\n\t[Jornada (Log)] [int] NOT NULL,\n\t[Log descartado (>2HE)] [int] NOT NULL,\n\t[Log HE] [int] NOT NULL,\n\t[Log] [int] NOT NULL,\n\t[Log Produtivo] [int] NOT NULL,\n\t[Log Improdutivo] [int] NOT NULL,\n\t[Tempo Livre] [int] NOT NULL,\n\t[Pausa Particular (Intelix)] [int] NOT NULL,\n\t[Pausa Break (Intelix)] [int] NOT NULL,\n\t[Pausa 10 (Intelix)] [int] NOT NULL,\n\t[Pausa Outbound (Intelix)] [int] NOT NULL,\n\t[Pausa Lanche (Intelix)] [int] NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [int] NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [int] NOT NULL,\n\t[Pausa Feedback (Intelix)] [int] NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [int] NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [int] NOT NULL,\n\t[Pausa Treinamento (Intelix)] [int] NOT NULL,\n\t[Pausa Banheiro (Intelix)] [int] NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [int] NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [int] NOT NULL,\n\t[Pausa NR17 (Intelix)] [int] NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [int] NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [int] NOT NULL,\n\t[Pausa Tratativa (EPBX)] [int] NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [int] NOT NULL,\n\t[Pausa Banheiro (EPBX)] [int] NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [int] NOT NULL,\n\t[Pausa Intervalo (EPBX)] [int] NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [int] NOT NULL,\n\t[Pausa Treinamento (EPBX)] [int] NOT NULL,\n\t[Pausa Feedback (EPBX)] [int] NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [int] NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [int] NOT NULL,\n\t[Pausa Login (EPBX)] [int] NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [int] NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [int] NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [int] NOT NULL,\n\t[Pausa NR17 (EPBX)] [int] NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [int] NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [int] NOT NULL,\n\t[Pausa Lanche (EPBX)] [int] NOT NULL,\n\t[Pausa BackOffice (EPBX)] [int] NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [int] NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [int] NOT NULL,\n\t[Pausa Banheiro (Genesys)] [int] NOT NULL,\n\t[Pausa Descanso (Genesys)] [int] NOT NULL,\n\t[Pausa Feedback (Genesys)] [int] NOT NULL,\n\t[Pausa Backoffice (Genesys)] [int] NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [int] NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [int] NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [int] NOT NULL,\n\t[Pausa Em Fila (Genesys)] [int] NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [int] NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [int] NOT NULL,\n\t[Pausa Tratativa (Genesys)] [int] NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [int] NOT NULL,\n\t[Pausa Treinamento (Genesys)] [int] NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [int] NOT NULL,\n\t[Inbound - TMA] [int] NOT NULL,\n\t[Inbound - TME] [int] NOT NULL,\n\t[Inbound - TMO] [int] NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [int] NOT NULL,\n\t[Outbound - TMA] [int] NOT NULL,\n\t[Outbound - TME] [int] NOT NULL,\n\t[Outbound - TMO] [int] NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[NPS] [int] NULL,\n\t[\u00c9 A Tribo do MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Email Supervis\u00e3o] [varchar](100) NULL,\n\t[Tempo de Casa (Dias)] [int] NULL,\n\t[Faixa Tempo de Casa] [varchar](15) NULL,\n\t[Idade] [int] NULL,\n\t[Faixa de Idade] [varchar](16) NULL,\n\t[Desvio Ponto-Log] [int] NULL,\n\t[Fonte de Log] [varchar](10) NULL,\n\t[Tempo Total (Intelix)] [bigint] NOT NULL,\n\t[Tempo Total (EPBX)] [bigint] NOT NULL,\n\t[Tempo Total (Genesys)] [bigint] NOT NULL,\n\t[Tempo Total (Secullum)] [bigint] NOT NULL\n) ON [PRIMARY]\nGO\nALTER TABLE [dbo].[d_genesys_eventos]  WITH CHECK ADD  CONSTRAINT [d_genesys_eventos_FK01] FOREIGN KEY([genesys_usuario_id])\nREFERENCES [dbo].[d_genesys_usuarios] ([genesys_usuario_id])\nGO\nALTER TABLE [dbo].[d_genesys_eventos] CHECK CONSTRAINT [d_genesys_eventos_FK01]\nGO\nALTER TABLE [dbo].[d_genesys_eventos]  WITH CHECK ADD  CONSTRAINT [d_genesys_eventos_FK02] FOREIGN KEY([genesys_pausa_id])\nREFERENCES [dbo].[d_genesys_pausas] ([genesys_pausa_id])\nGO\nALTER TABLE [dbo].[d_genesys_eventos] CHECK CONSTRAINT [d_genesys_eventos_FK02]\nGO\nALTER TABLE [dbo].[d_intelix_eventos]  WITH CHECK ADD  CONSTRAINT [d_intelix_eventos_FK01] FOREIGN KEY([intelix_usuario_id])\nREFERENCES [dbo].[d_intelix_usuarios] ([intelix_usuario_id])\nGO\nALTER TABLE [dbo].[d_intelix_eventos] CHECK CONSTRAINT [d_intelix_eventos_FK01]\nGO\n",
        "build_order": 98,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_m\u00eas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "[d_intelix_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_m\u00eas]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_individuo_m\u00eas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_individuo_m\u00eas"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "s_att_genesys_eventos",
        "type": "StoredProcedure",
        "start": 99601,
        "end": 101194,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_genesys_eventos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_genesys_eventos] @genesys_usuario_id [VARCHAR](100), @genesys_pausa_id [VARCHAR](100), @datahora_inicio [DATETIMEOFFSET], @datahora_fim  [DATETIMEOFFSET] AS\n    MERGE d_genesys_eventos AS destino\n    USING (\n        SELECT\n             [genesys_usuario_id]   = @genesys_usuario_id\n            ,[genesys_pausa_id]     = @genesys_pausa_id\n            ,[datahora_inicio]      = CONVERT([DATETIME], @datahora_inicio AT TIME ZONE 'UTC' AT TIME ZONE 'Central Brazilian Standard Time')\n            ,[datahora_fim]         = IIF(@datahora_fim = CAST('1900-01-01 00:00:00' AS [DATETIMEOFFSET]), NULL, CONVERT([DATETIME], @datahora_fim AT TIME ZONE 'UTC' AT TIME ZONE 'Central Brazilian Standard Time'))\n    ) AS fonte\n    ON  destino.[genesys_usuario_id]    = fonte.[genesys_usuario_id]\n    AND destino.[genesys_pausa_id]      = fonte.[genesys_pausa_id]\n    AND destino.[datahora_inicio]       = fonte.[datahora_inicio]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([genesys_usuario_id], [genesys_pausa_id], [datahora_inicio], [datahora_fim])\n        VALUES(fonte.[genesys_usuario_id], fonte.[genesys_pausa_id], fonte.[datahora_inicio], fonte.[datahora_fim])\n    WHEN MATCHED AND (\n            COALESCE(destino.[datahora_fim], '1900-01-01 00:00:00')  <> COALESCE(fonte.[datahora_fim], '1900-01-01 00:00:00')\n    )\n    THEN\n        UPDATE SET\n            destino.[datahora_fim]      = fonte.[datahora_fim]\n    ;\n\nGO\n",
        "build_order": 99,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "s_att_genesys_pausas",
        "type": "StoredProcedure",
        "start": 101194,
        "end": 102372,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_genesys_pausas]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_genesys_pausas] @genesys_pausa_id [VARCHAR](100), @tipo [VARCHAR](MAX), @presenca [VARCHAR](MAX), @nome [VARCHAR](MAX) AS\n    MERGE d_genesys_pausas AS destino\n    USING (\n        SELECT\n             [genesys_pausa_id]   = @genesys_pausa_id\n            ,[tipo]               = @tipo\n            ,[presenca]           = @presenca\n            ,[nome]               = @nome\n    ) AS fonte\n    ON  destino.[genesys_pausa_id] = fonte.[genesys_pausa_id]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([genesys_pausa_id], [tipo], [presenca], [nome])\n        VALUES(fonte.[genesys_pausa_id], fonte.[tipo], fonte.[presenca], fonte.[nome])\n    WHEN MATCHED AND (\n            destino.[tipo]      <> fonte.[tipo]\n        OR  destino.[presenca]  <> fonte.[presenca]\n        OR  destino.[nome]      <> fonte.[nome]\n    )\n    THEN\n        UPDATE SET\n             destino.[tipo]      = fonte.[tipo]\n            ,destino.[presenca]  = fonte.[presenca]\n            ,destino.[nome]      = fonte.[nome]\n    ;\n\nGO\n",
        "build_order": 100,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "s_att_genesys_usuarios",
        "type": "StoredProcedure",
        "start": 102372,
        "end": 104124,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_genesys_usuarios]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_genesys_usuarios] @genesys_usuario_id [VARCHAR](100), @nome [VARCHAR](MAX), @email [VARCHAR](MAX), @divisao [VARCHAR](MAX), @departamento [VARCHAR](MAX), @titulo [VARCHAR](MAX) AS\n    MERGE d_genesys_usuarios AS destino\n    USING (\n        SELECT\n             [genesys_usuario_id]   = @genesys_usuario_id\n            ,[nome]                 = @nome\n            ,[email]                = @email\n            ,[divisao]              = @divisao\n            ,[departamento]         = @departamento\n            ,[titulo]               = @titulo\n    ) AS fonte\n    ON  destino.[genesys_usuario_id] = fonte.[genesys_usuario_id]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([genesys_usuario_id], [nome], [email], [divisao], [departamento], [titulo])\n        VALUES(fonte.[genesys_usuario_id], fonte.[nome], fonte.[email], fonte.[divisao], fonte.[departamento], fonte.[titulo])\n    WHEN MATCHED AND (\n            destino.[nome]                   <> fonte.[nome]\n        OR  destino.[email]                  <> fonte.[email]\n        OR  destino.[divisao]                <> fonte.[divisao]\n        OR  COALESCE(destino.[departamento], '-') <> COALESCE(fonte.[departamento], '-')\n        OR  COALESCE(destino.[titulo], '-')       <> COALESCE(fonte.[titulo], '-')\n    )\n    THEN\n        UPDATE SET\n             destino.[nome]         = fonte.[nome]\n            ,destino.[email]        = fonte.[email]\n            ,destino.[divisao]      = fonte.[divisao]\n            ,destino.[departamento] = fonte.[departamento]\n            ,destino.[titulo]       = fonte.[titulo]\n    ;\n\nGO\n",
        "build_order": 101,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "s_att_intelix_eventos",
        "type": "StoredProcedure",
        "start": 104124,
        "end": 105884,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_intelix_eventos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_intelix_eventos] @intelix_usuario_id [INT], @datahora_inicio [DATETIME], @datahora_fim [DATETIME], @nome_pausa[VARCHAR](MAX), @evento[VARCHAR](MAX), @complemento[VARCHAR](MAX) AS\n    MERGE d_intelix_eventos AS destino\n    USING (\n        SELECT\n             [intelix_usuario_id]   = @intelix_usuario_id\n            ,[evento]               = @evento\n            ,[nome_pausa]           = @nome_pausa\n            ,[datahora_inicio]      = @datahora_inicio\n            ,[datahora_fim]         = IIF(@datahora_fim = CAST('1900-01-01 00:00:00' AS [DATETIME]), NULL, @datahora_fim)\n            ,[complemento]          = @complemento\n    ) AS fonte\n    ON  destino.[intelix_usuario_id] = fonte.[intelix_usuario_id]\n    AND destino.[evento]             = fonte.[evento]\n    AND destino.[nome_pausa]         = fonte.[nome_pausa]\n    AND destino.[datahora_inicio]    = fonte.[datahora_inicio]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([intelix_usuario_id], [evento], [nome_pausa], [datahora_inicio], [datahora_fim], [complemento])\n        VALUES(fonte.[intelix_usuario_id], fonte.[evento], fonte.[nome_pausa], fonte.[datahora_inicio], fonte.[datahora_fim], fonte.[complemento])\n    WHEN MATCHED AND (\n            COALESCE(destino.[datahora_fim], '1900-01-01 00:00:00')  <> COALESCE(fonte.[datahora_fim], '1900-01-01 00:00:00')\n        OR  COALESCE(destino.[complemento], '-')   <> COALESCE(fonte.[complemento], '-')\n    )\n    THEN\n        UPDATE SET\n             destino.[datahora_fim]  = fonte.[datahora_fim]\n            ,destino.[complemento]   = fonte.[complemento]\n    ;\n\nGO\n",
        "build_order": 102,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "s_att_intelix_usuarios",
        "type": "StoredProcedure",
        "start": 105884,
        "end": 106645,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_intelix_usuarios]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_intelix_usuarios] @intelix_usuario_id [INT], @nome [VARCHAR](MAX) AS\n    MERGE d_intelix_usuarios AS destino\n    USING (\n        SELECT\n             [intelix_usuario_id] = @intelix_usuario_id\n            ,[nome] = @nome\n    ) AS fonte\n    ON destino.[intelix_usuario_id] = fonte.[intelix_usuario_id]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([intelix_usuario_id], [nome])\n        VALUES(fonte.[intelix_usuario_id], fonte.[nome])\n    WHEN MATCHED\n        AND destino.[nome] <> fonte.[nome]\n    THEN\n        UPDATE SET\n            destino.[nome] = fonte.[nome]\n    ;\n\nGO\n",
        "build_order": 103,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "s_att_log",
        "type": "StoredProcedure",
        "start": 106645,
        "end": 112701,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_log]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_log] @fonte [VARCHAR](50) = NULL AS\n    DECLARE @null_logoff DATETIME = GETDATE()\n\n\tIF @fonte IS NULL OR @fonte='INTELIX' BEGIN\n\t\tPRINT 'INTELIX';\n\t\tWITH destino AS (\n\t\t\tSELECT * FROM [f_log]\n\t\t\tWHERE\t[Fonte]\t = 'INTELIX'\n\t\t)\n\t\tMERGE INTO destino USING (\n\t\t\tSELECT\n\t\t\t\t [Fonte]\t\t\t= 'INTELIX'\n\t\t\t\t,[ID Selecionar]\t= MAX([ID Selecionar])\n\t\t\t\t,[ID Intelix]\t\t= [intelix_usuario_id]\n\t\t\t\t,[ID Genesys]\t\t= NULL\n\t\t\t\t,[Evento]\t\t\t= [evento]\n\t\t\t\t,[In\u00edcio]\t\t\t= [datahora_inicio]\n\t\t\t\t,[Fim]\t\t\t\t= MAX([datahora_fim])\n\t\t\t\t,[Dura\u00e7\u00e3o]\t\t\t= DATEDIFF_BIG(s, [datahora_inicio], MAX([datahora_fim]))\n\t\t\tFROM (\n\t\t\t\tSELECT\n\t\t\t\t\t [intelix_usuario_id]\n\t\t\t\t\t,[evento] = IIF([evento] = 'Pausa', CONCAT('Pausa (',[nome_pausa],')'), [evento])\n\t\t\t\t\t,[datahora_inicio]\n\t\t\t\t\t,[datahora_fim] = CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END\n\t\t\t\tFROM d_intelix_eventos\n\t\t\t\tWHERE evento <> 'Login'\n\t\t\t\tUNION ALL\n\t\t\t\tSELECT [intelix_usuario_id] = p.[intelix_usuario_id]\n\t\t\t\t\t  ,[evento]\t= 'Login'\n\t\t\t\t\t  ,[inicio]\t= CASE WHEN LAG(p.[datahora_inicio]) OVER (PARTITION BY loginid ORDER BY p.rowid) IS NULL THEN l.[datahora_inicio] ELSE p.[datahora_fim] END\n\t\t\t\t\t  ,[fim]\t= CASE WHEN LEAD(p.[datahora_inicio]) OVER (PARTITION BY loginid ORDER BY p.rowid) IS NULL\n\t\t\t\t\t\t\t\t\t\tTHEN MAX(p.[datahora_fim]) OVER (PARTITION BY loginid)\n\t\t\t\t\t\t\t\t\t\tELSE LEAD(p.[datahora_inicio]) OVER (PARTITION BY loginid ORDER BY p.rowid) END\n\t\t\t\tFROM (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t [intelix_usuario_id]\n\t\t\t\t\t\t,[evento] = IIF([evento] = 'Pausa', CONCAT('Pausa (',[nome_pausa],')'), [evento])\n\t\t\t\t\t\t,[datahora_inicio]\n\t\t\t\t\t\t,[datahora_fim]   = CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END\n\t\t\t\t\t\t,[rowid] = ROW_NUMBER() OVER (ORDER BY [intelix_usuario_id], [datahora_inicio], CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END DESC)\n\t\t\t\t\tFROM d_intelix_eventos\n\t\t\t\t) p\n\t\t\t\tRIGHT JOIN (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t [intelix_usuario_id]\n\t\t\t\t\t\t,[datahora_inicio]\n\t\t\t\t\t\t,[datahora_fim] = CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END\n\t\t\t\t\t\t,[loginid] =  ROW_NUMBER() OVER (ORDER BY [intelix_usuario_id], [datahora_inicio], CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END)\n\t\t\t\t\tFROM d_intelix_eventos\n\t\t\t\t\tWHERE\tevento = 'Login'\n\t\t\t\t) l\n\t\t\t\tON p.[intelix_usuario_id] = l.[intelix_usuario_id]\n\t\t\t\tAND p.[datahora_inicio] >= l.[datahora_inicio]\n\t\t\t\tAND (p.[datahora_fim] <= l.[datahora_fim]\n\t\t\t\t\tOR (l.[datahora_fim] IS NULL\n\t\t\t\t\t\tAND CAST(p.[datahora_inicio] as date) = CAST(l.[datahora_inicio] as date)))\n\t\t\t) _\n\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].f_mop_historico\n\t\t\tON\t[intelix_usuario_id] = [ID Intelix]\n\t\t\tAND\t[Data da Atualiza\u00e7\u00e3o] = CAST([datahora_inicio] AS date)\n\t\t\tWHERE DATEDIFF_BIG(s, [datahora_inicio], [datahora_fim]) <> 0\n            GROUP BY [intelix_usuario_id],[Evento],[datahora_inicio]\n\t\t) AS fonte\n\t\tON  destino.[Fonte]\t\t\t=\tfonte.[Fonte]\n\t\tAND destino.[ID Intelix]\t=\tfonte.[ID Intelix]\n\t\tAND destino.[ID Genesys]\tIS\tNULL\n\t\tAND destino.[Evento]\t\t=\tfonte.[Evento]\n\t\tAND destino.[In\u00edcio]\t\t=\tfonte.[In\u00edcio]\n\n\t\tWHEN NOT MATCHED BY TARGET\n\t\tTHEN\n\t\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID Genesys], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o])\n\t\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID Genesys], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o])\n\n\t\tWHEN MATCHED AND(\n\t\t\t\tCOALESCE(destino.[ID Selecionar], '-')\t<>\tCOALESCE(fonte.[ID Selecionar], '-')\n\t\t\tOR\tCOALESCE(destino.[Fim], '1900-01-01')\t<>\tCOALESCE(fonte.[Fim], '1900-01-01')\n\t\t)\n\t\tTHEN UPDATE SET\n\t\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t\t,destino.[Fim]\t\t\t\t=\tfonte.[Fim]\n\t\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n\t\t;\n\t\t--OUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\tEND\n\n\tIF @fonte IS NULL OR @fonte='GENESYS' BEGIN\n\t\tPRINT 'GENESYS';\n\t\tWITH destino AS (\n\t\t\tSELECT * FROM [f_log]\n\t\t\tWHERE\t[Fonte]\t = 'GENESYS'\n\t\t)\n\t\tMERGE INTO destino USING (\n\t\t\tSELECT DISTINCT\n\t\t\t\t [Fonte]\t\t\t=\t'GENESYS'\n\t\t\t\t,[ID Selecionar]\t=\tm.[ID Selecionar]\n\t\t\t\t,[ID Intelix]\t\t=\tNULL\n\t\t\t\t,[ID Genesys]\t\t=\te.[genesys_usuario_id]\n\t\t\t\t,[Evento]\t\t\t=\tp.[nome]\n\t\t\t\t,[In\u00edcio]\t\t\t=\te.[datahora_inicio]\n\t\t\t\t,[Fim]\t\t\t\t=\tIIF(e.[datahora_fim] IS NULL, @null_logoff, e.[datahora_fim])\n\t\t\t\t,[Dura\u00e7\u00e3o]\t\t\t=\tDATEDIFF_BIG(ms, e.[datahora_inicio], IIF(e.[datahora_fim] IS NULL, @null_logoff, e.[datahora_fim])) / 1000.0\n\t\t\tFROM d_genesys_eventos e\n\t\t\tLEFT JOIN d_genesys_usuarios u\n\t\t\t\tON e.[genesys_usuario_id] = u.[genesys_usuario_id]\n\t\t\tLEFT JOIN d_genesys_pausas p\n\t\t\t\tON e.[genesys_pausa_id] = p.[genesys_pausa_id]\n\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].f_mop_historico m\n\t\t\t\tON e.[genesys_usuario_id] = m.[ID Genesys]\n\t\t\t\tAND CAST(e.[datahora_inicio] AS date) = m.[Data da Atualiza\u00e7\u00e3o]\n\t\t\tWHERE p.[nome] <> 'Offline'\n\n\n\t\t) AS fonte\n\t\tON  destino.[Fonte]\t\t\t=\tfonte.[Fonte]\n\t\tAND destino.[ID Intelix]\tIS\tNULL\n\t\tAND destino.[ID Genesys]\t=\tfonte.[ID Genesys]\n\t\tAND destino.[Evento]\t\t=\tfonte.[Evento]\n\t\tAND destino.[In\u00edcio]\t\t=\tfonte.[In\u00edcio]\n\n\t\tWHEN NOT MATCHED BY TARGET\n\t\tTHEN\n\t\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID Genesys], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o])\n\t\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID Genesys], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o])\n\n\t\tWHEN MATCHED AND(\n\t\t\t\tCOALESCE(destino.[ID Selecionar], '-')\t<>\tCOALESCE(fonte.[ID Selecionar], '-')\n\t\t\tOR\tCOALESCE(destino.[Fim], '1900-01-01')\t<>\tCOALESCE(fonte.[Fim], '1900-01-01')\n\t\t)\n\t\tTHEN UPDATE SET\n\t\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t\t,destino.[Fim]\t\t\t\t=\tfonte.[Fim]\n\t\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n\t\t;\n\t\t--OUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\tEND\n\nGO\n",
        "build_order": 104,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "s_att_resumos",
        "type": "StoredProcedure",
        "start": 112701,
        "end": 629330,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_resumos]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE    PROCEDURE [dbo].[s_att_resumos] @datahora_inicio DATETIME = NULL,  @datahora_fim DATETIME = NULL, @metrica VARCHAR(50) = NULL \nAS\n\tSET @datahora_inicio = IIF(@datahora_inicio >= CAST(GETDATE() AS DATE), DATEADD(DAY, -1, CAST(GETDATE() AS DATE)), @datahora_inicio)\n\tSET @datahora_fim = IIF(@datahora_fim >= CAST(GETDATE() AS DATE), DATEADD(SECOND, -1, CAST(CAST(GETDATE() AS DATE) AS DATETIME)), @datahora_fim)\n    \n\tDECLARE @t_inicio datetime = GETDATE();\n    DECLARE @t_inicio_etapa datetime;\n    DECLARE @msg VARCHAR(MAX);\n\n    IF 1=1 BEGIN; PRINT '--- Prep';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_prep;\n\n    \tDROP TABLE IF EXISTS [#chaves];\n    \tSELECT * INTO [#chaves]\n    \tFROM (\n    \t\t\tSELECT\n    \t\t\t\t [DataHora]\t\t\t\t\t\t\t\t\t            =\tc.[DataHora]\n    \t\t\t\t,[Proxima_DataHora]\t\t\t\t\t\t\t            =\tDATEADD(MINUTE, 30, c.[DataHora])\n    \t\t\t\t,[Intervalo]\t\t\t\t\t\t\t\t            =\tCAST(c.[DataHora] as time(0))\n    \t\t\t\t,[Data]\t\t\t\t\t\t\t\t\t\t            =\tc.[Data]\n    \t\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t            =\tc.[Semana_Mes_For\u00e7ada_PrimeiroDia]\n    \t\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t\t\t            =\tc.[M\u00eas_PrimeroDia]\n    \t\t\t\t,[Feriado (Nome)]\t\t\t\t\t\t\t\t\t    =\tc.[Feriado_Nome]\n\n       \t            ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   sec_flags.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t            ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   sec_flags.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t            ,[Secullum - Servi\u00e7o Militar]                                       =   sec_flags.[Secullum - Servi\u00e7o Militar]\n                    ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   sec_flags.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t            ,[Secullum - Licen\u00e7a Paternidade]                                   =   sec_flags.[Secullum - Licen\u00e7a Paternidade]\n       \t            ,[Secullum - Licen\u00e7a Maternidade]                                   =   sec_flags.[Secullum - Licen\u00e7a Maternidade]\n       \t            ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   sec_flags.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t            ,[Secullum - Licen\u00e7a Casamento]                                     =   sec_flags.[Secullum - Licen\u00e7a Casamento]\n                    ,[Secullum - INSS - Afastamento]                                    =   sec_flags.[Secullum - INSS - Afastamento]\n                    ,[Secullum - Folga]                                                 =   sec_flags.[Secullum - Folga]\n                    ,[Secullum - F\u00e9rias]                                                =   sec_flags.[Secullum - F\u00e9rias]\n       \t            ,[Secullum - Feriado]                                               =   sec_flags.[Secullum - Feriado]\n       \t            ,[Secullum - Falta Justificada]                                     =   sec_flags.[Secullum - Falta Justificada]\n       \t            ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   sec_flags.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                    ,[Secullum - Falta Injustificada]                                   =   sec_flags.[Secullum - Falta Injustificada]\n       \t            ,[Secullum - Prova de Vestibular / ENEM]                            =   sec_flags.[Secullum - Prova de Vestibular / ENEM]\n       \t            ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   sec_flags.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                    ,[Secullum - Desligue]                                              =   sec_flags.[Secullum - Desligue]\n       \t            ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   sec_flags.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t            ,[Secullum - Compensando Horas]                                     =   sec_flags.[Secullum - Compensando Horas]\n       \t            ,[Secullum - Atestado]                                              =   sec_flags.[Secullum - Atestado]\n                    ,[Secullum - Abono]                                                 =   sec_flags.[Secullum - Abono]\n       \t            ,[Secullum - Abono Lactante]                                        =   sec_flags.[Secullum - Abono Lactante]\n       \t            ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   sec_flags.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t            ,[Faltas Justificadas]                                              =   sec_flags.[Faltas Justificadas]\n       \t            ,[Faltas Injustificadas]                                            =   sec_flags.[Faltas Injustificadas]\n\n\n    \t\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t\t\t            =\tmop.[Data da Atualiza\u00e7\u00e3o]\n    \t\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t            =\tmop.[ID Selecionar]\n    \t\t\t\t,[Nome]\t\t\t\t\t\t\t\t\t\t            =\tmop.[Nome]\n    \t\t\t\t,[Status]\t\t\t\t\t\t\t\t\t            =\tmop.[Status]\n    \t\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t            =\tmop.[Situa\u00e7\u00e3o]\n    \t\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t            =\tmop.[Condi\u00e7\u00e3o]\n\n    \t\t\t\t,[DMA Inicial]\t\t\t\t\t\t\t\t            =\tmop.[DMA Inicial]\n    \t\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t\t\t            =\tmop.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t\t\t            =\tmop.[\u00daltima DMA Geral]\n    \t\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t\t\t            =\tmop.[Tipo da \u00daltima DMA]\n    \t\t\t\t,[Instrutor Inicial]\t\t\t\t\t\t            =\tmop.[Instrutor Inicial]\n    \t\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t\t\t            =\tmop.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t\t\t            =\tmop.[Instrutor \u00daltima DMA]\n\n    \t\t\t\t,[Teve Evento de MOP?]\t\t\t\t\t\t            =\t1\n    \t\t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t\t\t            =\t1\n    \t\t\t\t,[Tribo Completa]\t\t\t\t\t\t\t            =\t[Tribo Completa]\n    \t\t\t\t,[Cargo]\t\t\t\t\t\t\t\t\t            =\tmop.[Cargo]\n    \t\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t\t\t            =\tmop.[Supervis\u00e3o]\n    \t\t\t\t,[Email Supervis\u00e3o]\t\t\t\t\t\t\t\t\t\t=\tmop.[Email Supervis\u00e3o]\n\t\t\t\t\t,[Tempo de Casa (Dias)]\t\t\t\t\t\t\t\t\t=\tmop.[Tempo de Casa (Dias)]\n\t\t\t\t\t,[Faixa Tempo de Casa]\t\t\t\t\t\t\t\t\t=\tmop.[Faixa Tempo de Casa]\n\t\t\t\t\t,[Idade]\t\t\t\t\t\t\t\t\t\t\t\t=\tmop.[Idade]\n\t\t\t\t\t,[Faixa de Idade]\t\t\t\t\t\t\t\t\t\t=\tmop.[Faixa de Idade]\n    \t\t\t\t,[Turno]\t\t\t\t\t\t\t\t\t            =\tCASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN DATEDIFF(s, '00:00:00', mop.[Jornada]) > 22800 THEN 'Integral'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN CAST(LEFT(mop.[Escala],5) AS TIME) <  CAST('12:00' AS TIME) THEN 'Manh\u00e3'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN CAST(LEFT(mop.[Escala],5) AS TIME) >= CAST('12:00' AS TIME) THEN 'Tarde'\n\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN sec_horarios.[Jornada] > 22800 THEN 'Integral'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN CAST(LEFT(sec_horarios.[Escala (Ponto)],5) AS TIME) <  CAST('12:00' AS TIME) THEN 'Manh\u00e3'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN CAST(LEFT(sec_horarios.[Escala (Ponto)],5) AS TIME) >= CAST('12:00' AS TIME) THEN 'Tarde'\n\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tELSE NULL\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \tEND\n\n    \t\t\t\t,[Escala (Ponto)]\t\t\t\t\t\t\t            =\tsec_horarios.[Escala (Ponto)]\n    \t\t\t\t,[Jornada (Ponto)]\t\t\t\t\t\t\t            =\tISNULL(sec_horarios.[Jornada],0)\n    \t\t\t\t,[Escala (MOP)]\t\t\t\t\t\t\t\t            =\tmop.[Escala]\n    \t\t\t\t,[Jornada (Log)]\t\t\t\t\t\t\t            =\tISNULL(ABS(CASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN [Feriado_Nome]                                     IS NOT NULL          THEN 0\n                                                                                    WHEN [Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] \t= 1         THEN 0\n                                                                                    --WHEN [Secullum - Suspens\u00e3o por advert\u00eancia]\t            = 1         THEN 0\n                                                                                    WHEN [Secullum - INSS - Afastamento]\t                = 1         THEN 0\n                                                                                    WHEN [Secullum - Folga]\t                                = 1         THEN 0\n                                                                                    WHEN [Secullum - F\u00e9rias]\t                            = 1         THEN 0\n                                                                                    WHEN [Secullum - Feriado]\t                            = 1         THEN 0\n                                                                                    WHEN [Secullum - Desligue]\t                            = 1         THEN 0\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN mop.[Status]                                       <> 'Ativo'\tTHEN 0\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN sec_horarios.[Jornada]                             = 0\t\t\tTHEN 0\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t--WHEN sec_horarios.[Jornada]                           IS NULL\t    THEN -- <- Quando ID_Secullum n\u00e3o for preenchida no MOP\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t--    CASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t    \tWHEN mop.[Taxa] = 1 THEN CASE DATEPART(WEEKDAY, c.[Data]) WHEN 1 THEN 0  WHEN 7 THEN 0 ELSE DATEDIFF(s, 0, mop.[Jornada]) END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t    \tWHEN mop.[Taxa] = 2 THEN CASE DATEPART(WEEKDAY, c.[Data]) WHEN 1 THEN 0 ELSE DATEDIFF(s, 0, mop.[Jornada]) END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t--    END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tELSE DATEDIFF(s, 0, mop.[Jornada])\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \tEND), 0)\n\t\t\t\t\t,[Fonte de Log]\t\t\t\t\t\t\t\t\t\t\t=\tmop.[Fonte de Log]\n\n    \t\t\tFROM [db_serasa_producao].[dbo].dim_calendario_30min c\n    \t\t\tLEFT JOIN ( SELECT [Data da Atualiza\u00e7\u00e3o], [Data da Proxima Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Intelix], [ID EPBX],[ID Secullum], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [DMA Inicial], [\u00daltima DMA Migra\u00e7\u00e3o], [\u00daltima DMA Geral], [Tipo da \u00daltima DMA], [Instrutor Inicial], [Instrutor \u00daltima Migra\u00e7\u00e3o], [Instrutor \u00daltima DMA], [Cargo], [Supervis\u00e3o], [Email Supervis\u00e3o], [Escala], [Jornada], [Taxa], [Tribo Completa] = CONCAT([Cliente], '__', [Projeto], '__', [Tribo]), [Tempo de Casa (Dias)], [Faixa Tempo de Casa], [Idade], [Faixa de Idade], [Fonte de Log]\n    \t\t\t\t\t\tFROM [db_serasa_producao].[dbo].f_mop_eventos\n    \t\t\t\t\t\tWHERE [Data da Atualiza\u00e7\u00e3o] <= @datahora_fim\n    \t\t\t\t\t\tAND ([Data da Proxima Atualiza\u00e7\u00e3o] >= @datahora_inicio OR [Data da Proxima Atualiza\u00e7\u00e3o] IS NULL)\n    \t\t\t\t\t\tUNION ALL SELECT CAST('01/01/1900' AS datetime2(0)), CAST('01/01/2070' AS datetime2(0)), null, null, null, null, 'Colaborador n\u00e3o encontrado', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, '____', null, null, null, null, null\n    \t\t\t) as mop\n    \t\t\tON  c.[Data] >= mop.[Data da Atualiza\u00e7\u00e3o]\n    \t\t\tAND c.[Data] <  CASE  WHEN mop.[Data da Proxima Atualiza\u00e7\u00e3o] IS NULL AND [status] = 'Turnover' THEN DATEADD(DAY, 1, mop.[Data da Atualiza\u00e7\u00e3o])\n    \t\t\t\t\t\t\t\t\tWHEN mop.[Data da Proxima Atualiza\u00e7\u00e3o] IS NULL THEN DATEADD(DAY, 1, (SELECT MAX([Data]) FROM [db_serasa_producao].[dbo].dim_calendario_30min))\n    \t\t\t\t\t\t\t\t\tELSE mop.[Data da Proxima Atualiza\u00e7\u00e3o] END\n\n\n    \t\t\tLEFT JOIN (\n    \t\t\t\tSELECT DISTINCT\n    \t\t\t\t\t [ID Secullum]\t\t\t                                = id_funcionario\n    \t\t\t\t\t,[Data]\t\t\t\t\t                                = CAST(inicio AS DATE)\n\n       \t                ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                 = IIF([Obs] IN ('SuspCTT'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Suspens\u00e3o por advert\u00eancia]                            = IIF([Obs] IN ('SuspAdv', 'Sus/Adv'\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Servi\u00e7o Militar]                                      = IIF([Obs] IN ('ServMil'\t\t\t\t\t\t      ), 1, 0)\n                        ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]     = IIF([Obs] IN ('MFM'\t\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Licen\u00e7a Paternidade]                                  = IIF([Obs] IN ('LicPate'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Licen\u00e7a Maternidade]                                  = IIF([Obs] IN ('LicMate','MATER'\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                        = IIF([Obs] IN ('LicLuto'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Licen\u00e7a Casamento]                                    = IIF([Obs] IN ('LicCasa', 'LicGala'\t\t\t\t\t  ), 1, 0)\n                        ,[Secullum - INSS - Afastamento]                                   = IIF([Obs] IN ('INSS'\t\t\t\t\t\t\t\t  ), 1, 0)\n                        ,[Secullum - Folga]                                                = IIF([Obs] IN ('Folga', 'DayOff'\t\t\t\t\t  ), 1, 0)\n                        ,[Secullum - F\u00e9rias]                                               = IIF([Obs] IN ('F\u00c9RIAS','Ferias'\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Feriado]                                              = IIF([Obs] IN ('Feriado'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Falta Justificada]                                    = IIF([Obs] IN ('FaltaJu', 'FaltaJ', 'Falta J'         ), 1, 0)\n       \t                ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]   = IIF([Obs] IN ('FaltaAb'\t\t\t\t\t\t      ), 1, 0)\n                        ,[Secullum - Falta Injustificada]                                  = IIF([Obs] IN ('Falta', 'DecSAbo'\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Prova de Vestibular / ENEM]                           = IIF([Obs] IN ('ENEMVes'\t\t\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                     = IIF([Obs] IN ('DoaSang'\t\t\t\t\t          ), 1, 0)\n                        ,[Secullum - Desligue]                                             = IIF([Obs] IN ('Deslig', 'Deslig.'\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                  = IIF([Obs] IN ('ConvJud'\t\t\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Compensando Horas]                                    = IIF([Obs] IN ('ComHora'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Atestado]                                             = IIF([Obs] IN ('Atest', 'Atestad', 'Declara'\t\t  ), 1, 0)\n                        ,[Secullum - Abono]                                                = IIF([Obs] IN ('Abono'\t\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Abono Lactante]                                       = IIF([Obs] IN ('AboLact'\t\t\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]        = IIF([Obs] IN ('AboElei'\t\t\t\t\t\t      ), 1, 0)\n       \t                ,[Faltas Justificadas]                                             = IIF([Obs] IN ('Declara','SuspCTT','ServMil','MFM','LicPate','LicMate', 'LicGala','Ferias', 'MATER','LicLuto', 'FaltaJ', 'Falta J','LicCasa','INSS','Folga', 'DayOff','F\u00c9RIAS','Feriado','FaltaJu','ENEMVes','DoaSang','Deslig','Deslig.','ConvJud','ComHora','Atest','Atestad','Abono','AboLact','AboElei'), 1, 0)\n       \t                ,[Faltas Injustificadas]                                           = IIF([Obs] IN ('DecSAbo','FaltaAb','Falta','SuspAdv','Sus/Adv'), 1, 0)\n\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].dim_secullum_batidas\n    \t\t\t\tWHERE [Obs] IS NOT NULL\n    \t\t\t) as sec_flags\n    \t\t\tON\tmop.[ID Secullum] = sec_flags.[ID Secullum]\n    \t\t\tAND c.[Data] = sec_flags.[Data]\n\n    \t\t\tLEFT JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Secullum]\t\t= ID_funcionario\n    \t\t\t\t\t,[DiaSemana]\t\t= (DATEPART(dw, [DiaSemana]) + @@DATEFIRST + 6 - 0) % 7 + 1\n    \t\t\t\t\t,[Jornada]\t\t\t= ISNULL(DATEDIFF(s, Entrada1, Saida1), 0) + ISNULL(DATEDIFF(s, Entrada2, Saida2),0)\n    \t\t\t\t\t,[Escala (Ponto)]\t= CONCAT(LEFT(COALESCE([Entrada1], [Entrada2]),5), ' - ',LEFT(COALESCE([Saida2], [Saida1]),5))\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].dim_secullum_funcionarios\n    \t\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].dim_log_secullum_horarios\n    \t\t\t\tON id_horario = horarioid\n    \t\t\t) as sec_horarios\n    \t\t\tON mop.[ID Secullum] = sec_horarios.[ID Secullum]\n    \t\t\tAND DATEPART(dw, c.[Data]) = sec_horarios.[DiaSemana]\n\n    \t\tWHERE c.[Data] <= @datahora_fim\n    \t\tAND c.[Data] >= @datahora_inicio\n\n    \t) _\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_prep;\n        END\n    IF 1=1 AND (@metrica IS NULL OR @metrica='tickets')\n        BEGIN; PRINT '--- tickets';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_tickets;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT\n    \t\t\t [DataHora]\t\t\t\t\t\t\t=\tc.[DataHora]\n    \t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n    \t\t\t,[Tribo Completa]\t\t\t\t\t=\tCONCAT('Serasa', '__',IIF(t.[Tribo] = '0800 Premium', 'Voz', 'Digital'), '__', t.[Tribo])\n    \t\t\t,[Criados]\t\t\t\t\t\t\t=\tt.[Criados]\n    \t\t\t,[Tratados]\t\t\t\t\t\t\t=\tt.[Tratados]\n    \t\t\t,[Tempo Total de Tratativa]\t\t\t=\tt.[Tempo Total de Tratativa]\n    \t\t\t,[TMT]\t\t\t\t\t\t\t\t=\tt.[TMT]\n    \t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t=\tt.[N\u00e3o Resolvidos]\n    \t\t\t,[Replicas]\t\t\t\t\t\t\t=\tt.[Replicas]\n    \t\t\t,[Reincidentes 48h]\t\t\t\t\t=\tt.[Reincidentes 48h]\n    \t\t\t,[Reincidentes 30d]\t\t\t\t\t=\tt.[Reincidentes 30d]\n    \t\tFROM [#chaves] c\n    \t\tRIGHT JOIN (\n    \t\t\tSELECT\n    \t\t\t\t [ID Selecionar]\t\t\t= tt.[ID Selecionar]\n    \t\t\t\t,[Tribo]\t\t\t\t\t= COALESCE(tt.[Tribo], tc.[Tribo])\n    \t\t\t\t,[DataHora]\t\t\t\t\t= COALESCE(tt.[DataHora], tc.[DataHora])\n    \t\t\t\t,[Criados]\t\t\t\t\t= ISNULL(tc.[Criados], 0)\n    \t\t\t\t,[Tratados]\t\t\t\t\t= ISNULL(tt.[Tratados], 0)\n    \t\t\t\t,[Tempo Total de Tratativa]\t= ISNULL(tt.[Tempo Total de Tratativa], 0)\n    \t\t\t\t,[TMT]\t\t\t\t\t\t= ISNULL(tt.[TMT], 0)\n    \t\t\t\t,[N\u00e3o Resolvidos]\t\t\t= ISNULL(tt.[N\u00e3o Resolvidos], 0)\n    \t\t\t\t,[Replicas]\t\t\t\t\t= ISNULL(tt.[Replicas], 0)\n    \t\t\t\t,[Reincidentes 48h]\t\t\t= ISNULL(tt.[Reincidentes 48h], 0)\n    \t\t\t\t,[Reincidentes 30d]\t\t\t= ISNULL(tt.[Reincidentes 30d], 0)\n    \t\t\tFROM (\n    \t\t\t\t\tSELECT\n    \t\t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t\t,[Tribo]\n    \t\t\t\t\t\t,[DataHora]\t\t\t\t\t= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Resolu\u00e7\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t\t\t\t,[Tratados]\t\t\t\t\t= COUNT(*)\n    \t\t\t\t\t\t,[Tempo Total de Tratativa]\t= SUM(TMT)\n    \t\t\t\t\t\t,[TMT]\t\t\t\t\t\t= SUM(TMT)/COUNT(*)\n    \t\t\t\t\t\t,[N\u00e3o Resolvidos]\t\t\t= SUM(CASE [Resolvido?] WHEN 0 THEN 1 ELSE 0 END)\n    \t\t\t\t\t\t,[Replicas]\t\t\t\t\t= SUM(R\u00e9plicas)\n    \t\t\t\t\t\t,[Reincidentes 48h]\t\t\t= SUM(CAST([Reincidente 48h?] AS INT))\n    \t\t\t\t\t\t,[Reincidentes 30d]\t\t\t= SUM(CAST([Reincidente 30d?] AS INT))\n    \t\t\t\t\tFROM [db_Serasa_producao].[dbo].f_tickets\n    \t\t\t\t\tWHERE  [Resolu\u00e7\u00e3o] >= @datahora_inicio AND [Resolu\u00e7\u00e3o] <= @datahora_fim\n    \t\t\t\t\tGROUP BY [ID Selecionar], [Tribo], DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Resolu\u00e7\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t) tt\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [Tribo]\n    \t\t\t\t\t,[DataHora]\t\t\t= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Cria\u00e7\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t\t\t,[Criados]\t\t\t= COUNT(*)\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_tickets\n    \t\t\t\tWHERE [Cria\u00e7\u00e3o] >= @datahora_inicio AND [Cria\u00e7\u00e3o] <= @datahora_fim\n    \t\t\t\tGROUP BY [Tribo], DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Cria\u00e7\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t) tc\n    \t\t\tON COALESCE(tt.[ID Selecionar], '-') = '-' AND tt.[Tribo] = tc.[Tribo] AND tt.[DataHora] = tc.[DataHora]\n    \t\t) t\n    \t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(t.[ID Selecionar], '-')\n    \t\tAND c.[DataHora] = t.[DataHora]\n    \t\tWHERE c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim\n    \t) AS fonte\n    \tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n    \t\t\t [Teve Evento de Tickets?]\n    \t\t\t,[DataHora]\n    \t\t\t,[ID Selecionar]\n    \t\t\t,[Tribo Completa]\n    \t\t\t,[Criados]\n    \t\t\t,[Tratados]\n    \t\t\t,[Tempo Total de Tratativa]\n    \t\t\t,[TMT]\n    \t\t\t,[N\u00e3o Resolvidos]\n    \t\t\t,[Replicas]\n    \t\t\t,[Reincidentes 48h]\n    \t\t\t,[Reincidentes 30d]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n    \t\t\t1\n    \t\t\t,fonte.[DataHora]\n    \t\t\t,fonte.[ID Selecionar]\n    \t\t\t,fonte.[Tribo Completa]\n    \t\t\t,fonte.[Criados]\n    \t\t\t,fonte.[Tratados]\n    \t\t\t,fonte.[Tempo Total de Tratativa]\n    \t\t\t,fonte.[TMT]\n    \t\t\t,fonte.[N\u00e3o Resolvidos]\n    \t\t\t,fonte.[Replicas]\n    \t\t\t,fonte.[Reincidentes 48h]\n    \t\t\t,fonte.[Reincidentes 30d]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Teve Evento de Tickets?]\t=\t1\n    \t\t\t,destino.[Criados]\t\t\t\t\t=\tfonte.[Criados]\n    \t\t\t,destino.[Tratados]\t\t\t\t\t=\tfonte.[Tratados]\n    \t\t\t,destino.[Tempo Total de Tratativa]\t=\tfonte.[Tempo Total de Tratativa]\n    \t\t\t,destino.[TMT]\t\t\t\t\t\t=\tfonte.[TMT]\n    \t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t=\tfonte.[N\u00e3o Resolvidos]\n    \t\t\t,destino.[Replicas]\t\t\t\t\t=\tfonte.[Replicas]\n    \t\t\t,destino.[Reincidentes 48h]\t\t\t=\tfonte.[Reincidentes 48h]\n    \t\t\t,destino.[Reincidentes 30d]\t\t\t=\tfonte.[Reincidentes 30d]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Teve Evento de Tickets?]\t=\t0\n    \t\t\t,destino.[Criados]\t\t\t\t\t=\t0\n    \t\t\t,destino.[Tratados]\t\t\t\t\t=\t0\n    \t\t\t,destino.[Tempo Total de Tratativa]\t=\t0\n    \t\t\t,destino.[TMT]\t\t\t\t\t\t=\t0\n    \t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t=\t0\n    \t\t\t,destino.[Replicas]\t\t\t\t\t=\t0\n    \t\t\t,destino.[Reincidentes 48h]\t\t\t=\t0\n    \t\t\t,destino.[Reincidentes 30d]\t\t\t=\t0\n    \t;\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_tickets;\n        END\n    IF 1=1 AND (@metrica IS NULL OR @metrica='chamadas')\n        BEGIN; PRINT '--- chamadas';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_chamadas;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT\n    \t\t\t*\n    \t\t\t,[Inbound - TMC]\t\t\t\t\t=\tISNULL([Inbound - Tempo Em Chamada (Independente do Intervalo)] / NULLIF([Inbound - Chamadas Finalizadas], 0), 0)\n    \t\t\t,[Inbound - TMA]\t\t\t\t\t=\tISNULL([Inbound - Tempo Em Atendimento (Independente do Intervalo)] / NULLIF([Inbound - Chamadas Atendidas Finalizadas], 0), 0)\n    \t\t\t,[Inbound - TME]\t\t\t\t\t=\tISNULL([Inbound - Tempo Em Espera (Independente do Intervalo)] / NULLIF([Inbound - Chamadas Finalizadas], 0), 0)\n    \t\t\t,[Inbound - TMO]\t\t\t\t\t=\tISNULL(([Inbound - Tempo Em Atendimento (Independente do Intervalo)] + [Inbound - Tempo Em Encerramento (Independente do Intervalo)]) / NULLIF([Inbound - Chamadas Atendidas Finalizadas], 0), 0)\n    \t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t=\tISNULL([Inbound - Chamadas Atendidas Em At\u00e9 20s] / CAST(NULLIF([Inbound - Chamadas Iniciadas], 0) AS [decimal](18,4)), 0)\n    \t\t\t,[Inbound - Chamadas Abandonadas]\t=\t[Inbound - Chamadas Iniciadas] - [Inbound - Chamadas Atendidas]\n    \t\t\t,[Inbound - % Abandono]\t\t\t\t=\tISNULL(([Inbound - Chamadas Iniciadas] - [Inbound - Chamadas Atendidas]) / CAST(NULLIF([Inbound - Chamadas Iniciadas], 0) AS [decimal](18,4)), 0)\n\n    \t\t\t,[Outbound - TMC]\t\t\t\t\t=\tISNULL([Outbound - Tempo Em Chamada (Independente do Intervalo)] / NULLIF([Outbound - Chamadas Finalizadas], 0), 0)\n    \t\t\t,[Outbound - TMA]\t\t\t\t\t=\tISNULL([Outbound - Tempo Em Atendimento (Independente do Intervalo)] / NULLIF([Outbound - Chamadas Atendidas Finalizadas], 0), 0)\n    \t\t\t,[Outbound - TME]\t\t\t\t\t=\tISNULL([Outbound - Tempo Em Espera (Independente do Intervalo)] / NULLIF([Outbound - Chamadas Finalizadas], 0), 0)\n    \t\t\t,[Outbound - TMO]\t\t\t\t\t=\tISNULL(([Outbound - Tempo Em Atendimento (Independente do Intervalo)] + [Outbound - Tempo Em Encerramento (Independente do Intervalo)]) / NULLIF([Outbound - Chamadas Atendidas Finalizadas], 0), 0)\n    \t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t=\tISNULL([Outbound - Chamadas Atendidas Em At\u00e9 20s] / CAST(NULLIF([Outbound - Chamadas Iniciadas], 0) AS [decimal](18,4)), 0)\n    \t\t\t,[Outbound - Chamadas Abandonadas]\t=\t[Outbound - Chamadas Iniciadas] - [Outbound - Chamadas Atendidas]\n    \t\t\t,[Outbound - % Abandono]\t\t\t=\tISNULL(([Outbound - Chamadas Iniciadas] - [Outbound - Chamadas Atendidas]) / CAST(NULLIF([Outbound - Chamadas Iniciadas], 0) AS [decimal](18,4)), 0)\n\n    \t\tFROM (\n\n    \t\t\tSELECT\n    \t\t\t\t [DataHora]\t\t\t\t\t\t\t\t\t\t\t\t        =\tc.[DataHora]\n    \t\t\t    ,[Tribo Completa]\t\t\t\t\t                            =\tCOALESCE(\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\tCASE COALESCE(ct.[Grupo],ce.[Grupo],ca.[Grupo],co.[Grupo],ctrans.[Grupo])\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_PREMIUM'\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'Atendimento_SELECIONAR_Premium'\tTHEN 'Serasa__Voz__0800 Premium'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_CADASTRO_POSITIVO'\t\t\t\tTHEN 'Serasa__Voz__Cadastro Positivo'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_SAC'\t\t\t\t\t\t\tTHEN 'Serasa__Voz__SAC'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'Atendimento_SELECIONAR_SAC'\t\tTHEN 'Serasa__Voz__SAC'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t,c.[Tribo Completa])\n    \t\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t\t\t\t        =\tc.[ID Selecionar]\n\n    \t\t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] = 'Atendida' AND ct.[Dura\u00e7\u00e3o Espera] <= 20000, CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] IS NOT NULL, 1, 0))\n    \t\t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', [Transferida?], 0)), 0)\n\n    \t\t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] ELSE 0 END, 0)), 0)/1000.0\n\n    \t\t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Atendimento])\tWHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN DATEDIFF(ms, [In\u00edcio_Atendimento], [Proxima_DataHora]) WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Atendimento] < [Fim_Atendimento], DATEDIFF(ms, [In\u00edcio_Atendimento], [Fim_Atendimento]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM(IIF(ce.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio_Espera] IS NULL OR [Fim_Espera] IS NULL\tTHEN 0 WHEN [Fim_Espera] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Espera] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Espera] <= [DataHora] AND [Fim_Espera] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Espera])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Espera], [Proxima_DataHora])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Espera] < [Fim_Espera], DATEDIFF(ms, [In\u00edcio_Espera], [Fim_Espera]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM(IIF(co.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio_Encerramento] IS NULL OR [Fim_Encerramento] IS NULL\tTHEN 0 WHEN [Fim_Encerramento] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Encerramento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Encerramento] <= [DataHora] AND [Fim_Encerramento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Encerramento])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Encerramento], [Proxima_DataHora])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Encerramento] < [Fim_Encerramento], DATEDIFF(ms, [In\u00edcio_Encerramento], [Fim_Encerramento]), 0) ELSE 1800000 END, 0))/1000.0\n\n    \t\t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', 1, 0))\n    \t\t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\n\n    \t\t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] = 'Atendida' AND ct.[Dura\u00e7\u00e3o Espera] <= 20, CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] IS NOT NULL, 1, 0))\n    \t\t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', [Transferida?], 0)), 0)\n\n    \t\t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] ELSE 0 END, 0)), 0)/1000.0\n\n    \t\t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Atendimento])\tWHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN DATEDIFF(ms, [In\u00edcio_Atendimento], [Proxima_DataHora]) WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Atendimento] < [Fim_Atendimento], DATEDIFF(ms, [In\u00edcio_Atendimento], [Fim_Atendimento]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM(IIF(ce.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio_Espera] IS NULL OR [Fim_Espera] IS NULL\tTHEN 0 WHEN [Fim_Espera] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Espera] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Espera] <= [DataHora] AND [Fim_Espera] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Espera])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Espera], [Proxima_DataHora])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Espera] < [Fim_Espera], DATEDIFF(ms, [In\u00edcio_Espera], [Fim_Espera]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM(IIF(co.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio_Encerramento] IS NULL OR [Fim_Encerramento] IS NULL\tTHEN 0 WHEN [Fim_Encerramento] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Encerramento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Encerramento] <= [DataHora] AND [Fim_Encerramento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Encerramento])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Encerramento], [Proxima_DataHora])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Encerramento] < [Fim_Encerramento], DATEDIFF(ms, [In\u00edcio_Encerramento], [Fim_Encerramento]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', 1, 0))\n    \t\t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\n\n    \t\t\tFROM (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n    \t\t\t\t\t,[In\u00edcio]\t\t\t\t=\t[DataHora]\n    \t\t\t\t\t,[Fim]\t\t\t\t\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Total] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Total]\t\t=\tCAST([Dura\u00e7\u00e3o Total] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t=\tCAST([Dura\u00e7\u00e3o Espera] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t=\tIIF([Status] = 'Atendida', CAST([Dura\u00e7\u00e3o Atendimento] AS [decimal](18,4)) * 1000, 0) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t=\tCAST([Dura\u00e7\u00e3o Encerramento] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim --AND [Dura\u00e7\u00e3o Total] > 0 <-Economiza recursos mas acaba ignorando as abandonadas/n\u00e3o atendidas\n\n    \t\t\t) ct\n\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n    \t\t\t\t\t,[In\u00edcio_Espera]\t\t=\t[DataHora]\n    \t\t\t\t\t,[Fim_Espera]\t\t\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Espera] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t=\tCAST([Dura\u00e7\u00e3o Espera] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Dura\u00e7\u00e3o Espera] > 0\n    \t\t\t) ce\n    \t\t\tON 1=0\n\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n    \t\t\t\t\t,[In\u00edcio_Atendimento]\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Espera] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Fim_Atendimento]\t\t=\tDATEADD(ms, ([Dura\u00e7\u00e3o Espera]+[Dura\u00e7\u00e3o Atendimento]) * 1000, [DataHora])  -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t=\tCAST([Dura\u00e7\u00e3o Atendimento] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Dura\u00e7\u00e3o Atendimento] > 0\n    \t\t\t) ca\n    \t\t\tON 1=0\n\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n    \t\t\t\t\t,[In\u00edcio_Encerramento]\t=\tDATEADD(ms, ([Dura\u00e7\u00e3o Espera]+[Dura\u00e7\u00e3o Atendimento]) *1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Fim_Encerramento]\t\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Total] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t=\tCAST([Dura\u00e7\u00e3o Encerramento] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Dura\u00e7\u00e3o Encerramento] > 0\n    \t\t\t) co\n    \t\t\tON 1=0\n\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\t\t=\tCOALESCE(mop.[ID Selecionar], ch.[ID Genesys])\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[In\u00edcio_Transferencia]\t=\tch.[DataHora]\n    \t\t\t\t\t,[Fim_Transferencia]\t=\tch.[DataHora]\n    \t\t\t\t\t,[Transferida?]\t\t\t=\t1\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas ch\n    \t\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].f_mop_historico mop\n    \t\t\t\tON CAST(ch.[DataHora] AS DATE)= mop.[Data da Atualiza\u00e7\u00e3o]\n    \t\t\t\tAND ch.[ID Genesys] = mop.[ID Genesys]\n    \t\t\t\tWHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Transferida Por] IS NOT NULL\n    \t\t\t) ctrans\n    \t\t\tON 1=0\n\n    \t\t\tLEFT JOIN [#chaves] c\n    \t\t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(ct.[ID Selecionar],  COALESCE(ce.[ID Selecionar], COALESCE(ca.[ID Selecionar],  COALESCE(co.[ID Selecionar], '-'))))\n    \t\t\tAND (\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio]) / 30.0) * 30, 0)\t\t\t\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim]) / 30.0) * 30, 0))\n    \t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Espera]) / 30.0) * 30, 0)\t\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Espera]) / 30.0) * 30, 0))\n    \t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Atendimento]) / 30.0) * 30, 0)\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Atendimento]) / 30.0) * 30, 0))\n    \t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Encerramento]) / 30.0) * 30, 0)\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Encerramento]) / 30.0) * 30, 0))\n    \t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Transferencia]) / 30.0) * 30, 0)\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Transferencia]) / 30.0) * 30, 0))\n    \t\t\t\t )\n    \t\t\tWHERE  c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim\n    \t\t\tGROUP BY c.[DataHora], c.[ID Selecionar],COALESCE(CASE COALESCE(ct.[Grupo],ce.[Grupo],ca.[Grupo],co.[Grupo],ctrans.[Grupo])\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_PREMIUM'\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'Atendimento_SELECIONAR_Premium'\tTHEN 'Serasa__Voz__0800 Premium'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_CADASTRO_POSITIVO'\t\t\t\tTHEN 'Serasa__Voz__Cadastro Positivo'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_SAC'\t\t\t\t\t\t\tTHEN 'Serasa__Voz__SAC'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'Atendimento_SELECIONAR_SAC'\t\tTHEN 'Serasa__Voz__SAC'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t    END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t    ,c.[Tribo Completa])\n    \t\t) _\n    \t) AS fonte\n    \tON  fonte.[DataHora] = destino.[DataHora]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT (\n    \t\t [Teve Evento de Chamadas?]\n    \t\t,[DataHora]\n    \t\t,[Tribo Completa]\n    \t\t,[ID Selecionar]\n\n    \t\t,[Inbound - Chamadas Iniciadas]\n    \t\t,[Inbound - Chamadas Atendidas]\n    \t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,[Inbound - Chamadas Em Andamento]\n    \t\t,[Inbound - Chamadas Finalizadas]\n    \t\t,[Inbound - Chamadas Atendidas Finalizadas]\n    \t\t,[Inbound - Chamadas Transferidas]\n    \t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,[Inbound - Atendimentos Iniciados]\n    \t\t,[Inbound - Atendimentos Em Andamento]\n    \t\t,[Inbound - Atendimentos Finalizados]\n    \t\t,[Inbound - TMC]\n    \t\t,[Inbound - TMA]\n    \t\t,[Inbound - TME]\n    \t\t,[Inbound - TMO]\n    \t\t,[Inbound - % Nivel de Servi\u00e7o]\n    \t\t,[Inbound - Chamadas Abandonadas]\n    \t\t,[Inbound - % Abandono]\n\n    \t\t,[Outbound - Chamadas Iniciadas]\n    \t\t,[Outbound - Chamadas Atendidas]\n    \t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,[Outbound - Chamadas Em Andamento]\n    \t\t,[Outbound - Chamadas Finalizadas]\n    \t\t,[Outbound - Chamadas Atendidas Finalizadas]\n    \t\t,[Outbound - Chamadas Transferidas]\n    \t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,[Outbound - Atendimentos Iniciados]\n    \t\t,[Outbound - Atendimentos Em Andamento]\n    \t\t,[Outbound - Atendimentos Finalizados]\n    \t\t,[Outbound - TMC]\n    \t\t,[Outbound - TMA]\n    \t\t,[Outbound - TME]\n    \t\t,[Outbound - TMO]\n    \t\t,[Outbound - % Nivel de Servi\u00e7o]\n    \t\t,[Outbound - Chamadas Abandonadas]\n    \t\t,[Outbound - % Abandono]\n    \t\t)\n    \t\tVALUES (\n    \t\t 1\n    \t\t,fonte.[DataHora]\n    \t\t,fonte.[Tribo Completa]\n    \t\t,fonte.[ID Selecionar]\n\n    \t\t,fonte.[Inbound - Chamadas Iniciadas]\n    \t\t,fonte.[Inbound - Chamadas Atendidas]\n    \t\t,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,fonte.[Inbound - Chamadas Em Andamento]\n    \t\t,fonte.[Inbound - Chamadas Finalizadas]\n    \t\t,fonte.[Inbound - Chamadas Atendidas Finalizadas]\n    \t\t,fonte.[Inbound - Chamadas Transferidas]\n    \t\t,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,fonte.[Inbound - Atendimentos Iniciados]\n    \t\t,fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t,fonte.[Inbound - Atendimentos Finalizados]\n    \t\t,fonte.[Inbound - TMC]\n    \t\t,fonte.[Inbound - TMA]\n    \t\t,fonte.[Inbound - TME]\n    \t\t,fonte.[Inbound - TMO]\n    \t\t,fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t,fonte.[Inbound - Chamadas Abandonadas]\n    \t\t,fonte.[Inbound - % Abandono]\n\n    \t\t,fonte.[Outbound - Chamadas Iniciadas]\n    \t\t,fonte.[Outbound - Chamadas Atendidas]\n    \t\t,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,fonte.[Outbound - Chamadas Em Andamento]\n    \t\t,fonte.[Outbound - Chamadas Finalizadas]\n    \t\t,fonte.[Outbound - Chamadas Atendidas Finalizadas]\n    \t\t,fonte.[Outbound - Chamadas Transferidas]\n    \t\t,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,fonte.[Outbound - Atendimentos Iniciados]\n    \t\t,fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t,fonte.[Outbound - Atendimentos Finalizados]\n    \t\t,fonte.[Outbound - TMC]\n    \t\t,fonte.[Outbound - TMA]\n    \t\t,fonte.[Outbound - TME]\n    \t\t,fonte.[Outbound - TMO]\n    \t\t,fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t,fonte.[Outbound - Chamadas Abandonadas]\n    \t\t,fonte.[Outbound - % Abandono]\n    \t\t)\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Teve Evento de Chamadas?]\t\t\t\t\t\t\t\t= 1\n    \t\t\t,destino.[DataHora]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[DataHora]\n    \t\t\t,destino.[Tribo Completa]\t\t\t\t\t\t\t\t\t\t= fonte.[Tribo Completa]\n    \t\t\t,destino.[ID Selecionar]\t\t\t\t\t\t\t\t\t\t= fonte.[ID Selecionar]\n\n    \t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Finalizadas]\n    \t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Transferidas]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMC]\n    \t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMA]\n    \t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TME]\n    \t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMO]\n    \t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Abandono]\n\n    \t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Finalizadas]\n    \t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Transferidas]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMC]\n    \t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMA]\n    \t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TME]\n    \t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMO]\n    \t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - % Abandono]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Teve Evento de Chamadas?]\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n    \t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= 0\n\n    \t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n    \t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= 0\n    \t;\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_chamadas;\n        END\n    IF 1=1 AND (@metrica IS NULL OR @metrica='nps')\n        BEGIN; PRINT '--- nps';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_nps;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT *\n    \t\t\t,[NPS] = CAST((CAST(([Promotoras]-[Detratoras]) AS decimal(18,4))/CAST(NULLIF([Avalia\u00e7\u00f5es de NPS], 0) AS decimal(16,4)))*100 AS INT)\n    \t\tFROM (\n    \t\t\tSELECT\n    \t\t\t\t [DataHora]\t\t\t\t= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [DataHora da Opini\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t\t,[ID Selecionar]\t\t= c.[ID Selecionar]\n    \t\t\t\t,[Tribo Completa]\t    = ISNULL([Tribo Completa Padronizada], '____')\n    \t\t\t\t,[Avalia\u00e7\u00f5es de NPS]\t= COUNT(*)\n    \t\t\t\t,[Promotoras]\t\t\t= ISNULL(SUM(IIF([Classifica\u00e7\u00e3o] = 'Promotores', 1,0)),0)\n    \t\t\t\t,[Neutras]\t\t\t\t= ISNULL(SUM(IIF([Classifica\u00e7\u00e3o] = 'Neutros', 1,0)),0)\n    \t\t\t\t,[Detratoras]\t\t\t= ISNULL(SUM(IIF([Classifica\u00e7\u00e3o] = 'Detratores', 1,0)),0)\n    \t\t\tFROM [db_Serasa_producao].[dbo].f_nps_v2 n\n    \t\t\tLEFT JOIN [#chaves] c\n    \t\t\tON c.[ID Selecionar] = n.[ID Selecionar]\n    \t\t\tAND c.[DataHora] = DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [DataHora da Opini\u00e3o]) / 30.0) * 30, 0)\n    \t\t\tWHERE n.[DataHora da Opini\u00e3o] >= @datahora_inicio AND n.[DataHora da Opini\u00e3o] <= @datahora_fim\n    \t\t\tGROUP BY DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [DataHora da Opini\u00e3o]) / 30.0) * 30, 0), [Tribo Completa Padronizada], c.[ID Selecionar]\n    \t\t) _\n    \t) AS fonte\n    \tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT (\n    \t\t\t\t [Teve Evento de NPS?]\n    \t\t\t\t,[DataHora]\n    \t\t\t\t,[ID Selecionar]\n    \t\t\t\t,[Tribo Completa]\n    \t\t\t\t,[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t\t,[Promotoras]\n    \t\t\t\t,[Neutras]\n    \t\t\t\t,[Detratoras]\n    \t\t\t\t,[NPS]\n    \t\t)\n    \t\tVALUES (\n    \t\t\t\t 1\n    \t\t\t\t,fonte.[DataHora]\n    \t\t\t\t,fonte.[ID Selecionar]\n    \t\t\t\t,fonte.[Tribo Completa]\n    \t\t\t\t,fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t\t,fonte.[Promotoras]\n    \t\t\t\t,fonte.[Neutras]\n    \t\t\t\t,fonte.[Detratoras]\n    \t\t\t\t,fonte.[NPS]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t\t destino.[Teve Evento de NPS?]\t= 1\n    \t\t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t= fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t\t,destino.[Promotoras]\t\t\t= fonte.[Promotoras]\n    \t\t\t\t,destino.[Neutras]\t\t\t\t= fonte.[Neutras]\n    \t\t\t\t,destino.[Detratoras]\t\t\t= fonte.[Detratoras]\n    \t\t\t\t,destino.[NPS]\t\t\t\t\t= fonte.[NPS]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tUPDATE SET\n    \t\t\t\t destino.[Teve Evento de NPS?]\t= 0\n    \t\t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t= 0\n    \t\t\t\t,destino.[Promotoras]\t\t\t= 0\n    \t\t\t\t,destino.[Neutras]\t\t\t\t= 0\n    \t\t\t\t,destino.[Detratoras]\t\t\t= 0\n    \t\t\t\t,destino.[NPS]\t\t\t\t\t= NULL\n    \t;\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_nps;\n        END\n    IF 1=1 AND (@metrica IS NULL OR @metrica='log')\n        BEGIN; PRINT '--- log';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_log;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \t\tMERGE INTO destino USING\n    \t\t(\n    \t\t\tSELECT\n    \t\t\t\t [DataHora]\t\t\t\t\t\t\t=\t[DataHora]\n    \t\t\t\t,[ID Selecionar]\t\t\t\t\t=\t[ID Selecionar]\n    \t\t\t\t,[Tribo Completa]\t\t\t\t\t=\tISNULL([Tribo Completa], '____')\n\n\t\t\t\t\t,[Tempo Total (Intelix)]\t\t\t=\tISNULL([TempoTotal_Intelix]/1000.0, 0)\n\t\t\t\t\t,[Tempo Total (EPBX)]\t\t\t\t=\tISNULL([TempoTotal_EPBX]/1000.0, 0)\n\t\t\t\t\t,[Tempo Total (Genesys)]\t\t\t=\tISNULL([TempoTotal_Genesys]/1000.0, 0)\n\t\t\t\t\t,[Tempo Total (Secullum)]\t\t\t=\tISNULL([TempoTotal_Secullum]/1000.0, 0)\n\n    \t\t\t\t,[Login (Ponto)]\t\t\t\t\t=   CAST(IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto]) AS time(3))\n    \t\t\t\t,[Logout (Ponto)]\t\t\t\t\t=   CAST(IIF([Logout_ponto] > [Proxima_DataHora] , [Proxima_DataHora], [Logout_ponto]) AS time(3))\n    \t\t\t\t,[Trabalhado (Ponto)]\t\t\t\t=   ISNULL([Trabalhado (Ponto)], 0)/1000.0\n    \t\t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=   ISNULL([Em Pausa (Ponto)], 0)/1000.0\n\t\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t=\t(ISNULL([Trabalhado (Ponto)], 0) -\tIIF([Fonte de Log] = 'SECULLUM', ISNULL([Trabalhado (Ponto)], 0),ISNULL([Log], 0)))/1000.0\n    \t\t\t\t,[Login]\t\t\t\t\t\t\t=\tIIF([Fonte de Log] = 'SECULLUM'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto]) AS time(3))\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Login] < [DataHora] , [DataHora], [Login]) AS time(3))\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t,[Logout]\t\t\t\t\t\t\t=\tIIF([Fonte de Log] = 'SECULLUM'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Logout_ponto] > [Proxima_DataHora] , [Proxima_DataHora], [Logout_ponto]) AS time(3))\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Logout] > [Proxima_DataHora] , [Proxima_DataHora], [Logout]) AS time(3))\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t,[Log descartado (>2HE)]\t\t\t=\tIIF([Fonte de Log] = 'SECULLUM'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado_ponto] > [Limite_HE_ponto]\tTHEN CASE WHEN [Log_Acumulado_ponto] - [Limite_HE_ponto] < 1800000\tTHEN\t [Log_Acumulado_ponto] - [Limite_HE_ponto]\tELSE [Trabalhado (Ponto)]\tEND\tELSE 0\tEND/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado] > [Limite_HE]\tTHEN CASE WHEN [Log_Acumulado] - [Limite_HE] < 1800000\tTHEN\t [Log_Acumulado] - [Limite_HE]\tELSE [Log]\tEND\tELSE 0\tEND/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t,[Log HE]\t\t\t\t\t\t\t\t=\tIIF([Fonte de Log] = 'SECULLUM'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado_ponto] > [Limite_HE_ponto]  THEN CASE WHEN [Log_Acumulado_ponto] - [Limite_HE_ponto] < 1800000 THEN\t [Trabalhado (Ponto)]\t\t\t\t\tELSE 0\t\tEND ELSE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   CASE WHEN [Log_Acumulado_ponto] > [Inicio_HE_ponto]\tTHEN CASE WHEN [Log_Acumulado_ponto] - [Inicio_HE_ponto] < 1800000 THEN\t([Log_Acumulado_ponto] - [Inicio_HE_ponto]) ELSE [Trabalhado (Ponto)]\tEND\tELSE 0\tEND\tEND/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado] > [Limite_HE]  THEN CASE WHEN [Log_Acumulado] - [Limite_HE] < 1800000 THEN\t [Log]\t\t\t\t\tELSE 0\t\tEND ELSE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   CASE WHEN [Log_Acumulado] > [Inicio_HE]\tTHEN CASE WHEN [Log_Acumulado] - [Inicio_HE] < 1800000 THEN\t([Log_Acumulado] - [Inicio_HE]) ELSE [log]\tEND\tELSE 0\tEND\tEND/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t    )\n    \t\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tIIF([Fonte de Log] = 'SECULLUM'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Trabalhado (Ponto)]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Log]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t,[Log Produtivo]\t\t\t\t\t=\tIIF([Fonte de Log] = 'SECULLUM'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Trabalhado (Ponto)]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,\n    \t\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Tempo Livre], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Sistema Externo], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Outbound], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tempo Livre], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Sistema (Externo)], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Discagem Manual], 0)\n\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Em Ligacao], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Transfer\u00eancia], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tratativa], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_WhatsApp], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Backoffice], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Discagem Manual], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Discagem Retorno], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Em Fila], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Sistema Externo], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Tratativa], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Whatsapp], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n    \t\t\t\t,[Log Improdutivo]\t\t\t\t\t=\tIIF([Fonte de Log] = 'SECULLUM'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t,0\n    \t\t\t\t\t\t\t\t\t\t\t\t\t,\n    \t\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Pausa Particular], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Break], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa 10], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Lanche], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa R\u00e1pida], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Almo\u00e7o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Feedback], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Treinamento], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Banheiro], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Sistema Interno], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Reuni\u00e3o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Ambulat\u00f3rio], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa NR17], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Almo\u00e7o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Ambulat\u00f3rio], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Banheiro], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Feedback], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Intervalo], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_P\u00f3s Atendimento], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Reuni\u00e3o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Sistema (interno)], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Treinamento], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_BackOffice], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Login], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_N\u00e3o Disponivel], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Almo\u00e7o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Ambulat\u00f3rio], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Banheiro], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Descanso], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Feedback], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Dispon\u00edvel], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Sistema Interno], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Treinamento], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n\n    \t\t\t\t,[Tempo Livre]\t\t\t\t\t\t=\n    \t\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Tempo Livre]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tempo Livre]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n    \t\t\t\t,[Pausa Particular (Intelix)]\t\t=\tISNULL([Intelix_Pausa Particular]/1000.0, 0)\n    \t\t\t\t,[Pausa Break (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Break]/1000.0, 0)\n    \t\t\t\t,[Pausa 10 (Intelix)] \t\t\t\t=\tISNULL([Intelix_Pausa 10]/1000.0, 0)\n    \t\t\t\t,[Pausa Outbound (Intelix)] \t\t=\tISNULL([Intelix_Pausa Outbound]/1000.0, 0)\n    \t\t\t\t,[Pausa Lanche (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Lanche]/1000.0, 0)\n    \t\t\t\t,[Pausa R\u00e1pida (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa R\u00e1pida]/1000.0, 0)\n    \t\t\t\t,[Pausa Almo\u00e7o (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Almo\u00e7o]/1000.0, 0)\n    \t\t\t\t,[Pausa Feedback (Intelix)] \t\t=\tISNULL([Intelix_Pausa Feedback]/1000.0, 0)\n    \t\t\t\t,[Pausa Sistema Interno (Intelix)] \t=\tISNULL([Intelix_Pausa Sistema Interno]/1000.0, 0)\n    \t\t\t\t,[Pausa Sistema Externo (Intelix)] \t=\tISNULL([Intelix_Pausa Sistema Externo]/1000.0, 0)\n    \t\t\t\t,[Pausa Treinamento (Intelix)] \t\t=\tISNULL([Intelix_Pausa Treinamento]/1000.0, 0)\n    \t\t\t\t,[Pausa Banheiro (Intelix)] \t\t=\tISNULL([Intelix_Pausa Banheiro]/1000.0, 0)\n    \t\t\t\t,[Pausa Reuni\u00e3o (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Reuni\u00e3o]/1000.0, 0)\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)] \t\t=\tISNULL([Intelix_Pausa Ambulat\u00f3rio]/1000.0, 0)\n    \t\t\t\t,[Pausa NR17 (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa NR17]/1000.0, 0)\n\n    \t\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tISNULL([EPBX_Em Ligacao]/1000.0, 0)\n    \t\t\t\t,[Pausa Almo\u00e7o (EPBX)] \t\t\t\t=\tISNULL([EPBX_Almo\u00e7o]/1000.0, 0)\n    \t\t\t\t,[Pausa Tratativa (EPBX)] \t\t\t=\tISNULL([EPBX_Tratativa]/1000.0, 0)\n    \t\t\t\t,[Pausa Discagem Manual (EPBX)] \t=\tISNULL([EPBX_Discagem Manual]/1000.0, 0)\n    \t\t\t\t,[Pausa Banheiro (EPBX)] \t\t\t=\tISNULL([EPBX_Banheiro]/1000.0, 0)\n    \t\t\t\t,[Pausa WhatsApp (EPBX)] \t\t\t=\tISNULL([EPBX_WhatsApp]/1000.0, 0)\n    \t\t\t\t,[Pausa Intervalo (EPBX)] \t\t\t=\tISNULL([EPBX_Intervalo]/1000.0, 0)\n    \t\t\t\t,[Pausa Discagem Retorno (EPBX)] \t=\tISNULL([EPBX_Discagem Retorno]/1000.0, 0)\n    \t\t\t\t,[Pausa Treinamento (EPBX)] \t\t=\tISNULL([EPBX_Treinamento]/1000.0, 0)\n    \t\t\t\t,[Pausa Feedback (EPBX)] \t\t\t=\tISNULL([EPBX_Feedback]/1000.0, 0)\n    \t\t\t\t,[Pausa Transfer\u00eancia (EPBX)] \t\t=\tISNULL([EPBX_Transfer\u00eancia]/1000.0, 0)\n    \t\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)] \t\t=\tISNULL([EPBX_N\u00e3o Disponivel]/1000.0, 0)\n    \t\t\t\t,[Pausa Login (EPBX)] \t\t\t\t=\tISNULL([EPBX_Login]/1000.0, 0)\n    \t\t\t\t,[Pausa Reuni\u00e3o (EPBX)] \t\t\t=\tISNULL([EPBX_Reuni\u00e3o]/1000.0, 0)\n    \t\t\t\t,[Pausa Sistema Interno (EPBX)] \t=\tISNULL([EPBX_Sistema (interno)]/1000.0, 0)\n    \t\t\t\t,[Pausa Sistema Externo (EPBX)] \t=\tISNULL([EPBX_Sistema (Externo)]/1000.0, 0)\n    \t\t\t\t,[Pausa NR17 (EPBX)] \t\t\t\t=\tISNULL([EPBX_NR17]/1000.0, 0)\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)] \t\t=\tISNULL([EPBX_Ambulat\u00f3rio]/1000.0, 0)\n    \t\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)] \t=\tISNULL([EPBX_P\u00f3s Atendimento]/1000.0, 0)\n    \t\t\t\t,[Pausa Lanche (EPBX)] \t\t\t\t=\tISNULL([EPBX_Lanche]/1000.0, 0)\n    \t\t\t\t,[Pausa BackOffice (EPBX)] \t\t\t=\tISNULL([EPBX_BackOffice]/1000.0, 0)\n\n    \t\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tISNULL([Genesys_Almo\u00e7o]/1000.0, 0)\t\t\t\t-- Improd\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tISNULL([Genesys_Ambulat\u00f3rio]/1000.0, 0)\t\t\t-- Improd\n    \t\t\t\t,[Pausa Banheiro (Genesys)]\t\t\t=\tISNULL([Genesys_Banheiro]/1000.0, 0)\t\t\t-- Improd\n    \t\t\t\t,[Pausa Descanso (Genesys)]\t\t\t=\tISNULL([Genesys_Descanso]/1000.0, 0)\t\t\t-- Improd\n    \t\t\t\t,[Pausa Feedback (Genesys)]\t\t\t=\tISNULL([Genesys_Feedback]/1000.0, 0)\t\t\t-- Improd\n    \t\t\t\t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tISNULL([Genesys_Dispon\u00edvel]/1000.0, 0)\t\t\t-- Improd\n\n    \t\t\t\t,[Pausa Backoffice (Genesys)]\t\t=\tISNULL([Genesys_Backoffice]/1000.0, 0)\t\t\t-- Prod\n    \t\t\t\t,[Pausa Discagem Manual (Genesys)]\t=\tISNULL([Genesys_Discagem Manual]/1000.0, 0)\t\t-- Prod\n    \t\t\t\t,[Pausa Discagem Retorno (Genesys)]\t=\tISNULL([Genesys_Discagem Retorno]/1000.0, 0)\t-- Prod\n    \t\t\t\t,[Pausa Em Fila (Genesys)]\t\t\t=\tISNULL([Genesys_Em Fila]/1000.0, 0)\t\t\t\t-- Prod\n    \t\t\t\t,[Pausa Sistema Externo (Genesys)]\t=\tISNULL([Genesys_Sistema Externo]/1000.0, 0)\t\t-- Prod\n    \t\t\t\t,[Pausa Sistema Interno (Genesys)]\t=\tISNULL([Genesys_Sistema Interno]/1000.0, 0)\t\t-- Improd\n    \t\t\t\t,[Pausa Tratativa (Genesys)]\t\t=\tISNULL([Genesys_Tratativa]/1000.0, 0)\t\t\t-- Prod\n    \t\t\t\t,[Pausa Whatsapp (Genesys)]\t\t\t=\tISNULL([Genesys_Whatsapp]/1000.0, 0)\t\t\t-- Prod\n    \t\t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tISNULL([Genesys_Treinamento]/1000.0, 0)\t\t\t-- Improd\n\n    \t\t\tFROM (\n    \t\t\t\tSELECT *\n    \t\t\t\t\t,[Log_Acumulado]=\tSUM([Log]) OVER (PARTITION BY [ID Selecionar], [Data] ORDER BY [DataHora])\n    \t\t\t\t\t,[Inicio_HE]\t=\t[Jornada (Log)]\n    \t\t\t\t\t,[Limite_HE]\t=\t[Jornada (Log)]+7200000\n\n    \t\t\t\t\t,[Log_Acumulado_ponto]\t=\tSUM([Trabalhado (Ponto)]) OVER (PARTITION BY [ID Selecionar], [Data] ORDER BY [DataHora])\n    \t\t\t\t\t,[Inicio_HE_ponto]\t\t=\t[Jornada (Ponto)]\n    \t\t\t\t\t,[Limite_HE_ponto]\t\t=\t[Jornada (Ponto)]+7200000\n    \t\t\t\tFROM (\n    \t\t\t\t\tSELECT\n    \t\t\t\t\t\t [DataHora]\t\t\t\t\t\t\t=\t[DataHora]\n    \t\t\t\t\t\t,[Proxima_DataHora]\t\t\t\t\t=\t[Proxima_DataHora]\n    \t\t\t\t\t\t,[Data]\t\t\t\t\t\t\t\t=\t[Data]\n    \t\t\t\t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n    \t\t\t\t\t\t,[Tribo Completa]\t\t\t\t\t=\tISNULL([Tribo Completa], '____')\n    \t\t\t\t\t\t,[Fonte de Log]\t\t\t\t\t\t=\tISNULL([Fonte de Log], '____')\n\n    \t\t\t\t\t\t---\\/ponto\\/\n    \t\t\t\t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tMAX([Jornada (Ponto)])*1000\n    \t\t\t\t\t\t,[Login_ponto]\t\t\t\t\t\t=\tMIN(MIN(IIF(Fonte =  'SECULLUM',[In\u00edcio], NULL))) OVER (PARTITION BY c.[ID Selecionar], [Data])\n    \t\t\t\t\t\t,[Logout_ponto]\t\t\t\t\t\t=\tMAX(MAX(IIF(Fonte =  'SECULLUM',[Fim], NULL)))\t OVER (PARTITION BY c.[ID Selecionar], [Data])\n\n    \t\t\t\t\t\t,[Trabalhado (Ponto)]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'SECULLUM' AND Evento = ('Trabalhado') THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'SECULLUM' AND Evento = ('Em Pausa'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t---/\\ponto/\\\n\n    \t\t\t\t\t\t,[Jornada (Log)]\t\t\t\t\t=\tMAX([Jornada (Log)])*1000\n    \t\t\t\t\t\t,[Login]\t\t\t\t\t\t\t=\tMIN(MIN(IIF(Fonte = [Fonte de Log], [In\u00edcio], NULL)))\tOVER (PARTITION BY c.[ID Selecionar], [Data])\n    \t\t\t\t\t\t,[Logout]\t\t\t\t\t\t\t=\tMAX(MAX(IIF(Fonte = [Fonte de Log], [Fim], NULL)))\t\tOVER (PARTITION BY c.[ID Selecionar], [Data])\n\n    \t\t\t\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = [Fonte de Log]\tTHEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[TempoTotal_Intelix]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX'\t\tTHEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t\t,[TempoTotal_EPBX]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\t\t\tTHEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t\t,[TempoTotal_Genesys]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS'\t\tTHEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t\t,[TempoTotal_Secullum]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'SECULLUM'\t\tTHEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t\n    \t\t\t\t\t\t,[Intelix_Tempo Livre]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Login'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Particular]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Particular (Break))'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Break]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Break)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa 10]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Pausa 10)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Outbound]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Outbound)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Lanche]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Lanche)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa R\u00e1pida]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Pausa Rapida)'\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Almo\u00e7o]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Almoco)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Feedback]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Feedback)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Sistema Externo]\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Sistema (Externo))'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Treinamento]\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Treinamento)'\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Banheiro]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Banheiro)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Sistema Interno]\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Sistema (Interno))'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Reuni\u00e3o]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Reuniao)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Ambulat\u00f3rio]\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Ambulatorio)'\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa NR17]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (NR 17)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\n    \t\t\t\t\t\t,[EPBX_Tempo Livre]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Livre'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Em Ligacao]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Em Ligacao'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Almo\u00e7o]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Almo\u00e7o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Tratativa]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Tratativa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Discagem Manual]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Discagem Manual'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Banheiro]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Banheiro'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_WhatsApp]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('WhatsApp'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Intervalo]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Intervalo'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Discagem Retorno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Discagem Retorno'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Treinamento]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Treinamento'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Feedback]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Feedback'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Transfer\u00eancia]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Transfer\u00eancia'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Sistema (Externo)]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Sistema (Externo)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_N\u00e3o Disponivel]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('N\u00e3o Disponivel'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Login]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Login'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Reuni\u00e3o]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Reuni\u00e3o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Sistema (interno)]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Sistema (interno)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_NR17]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('NR17'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Ambulat\u00f3rio]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Ambulat\u00f3rio'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_P\u00f3s Atendimento]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('P\u00f3s Atendimento'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Lanche]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Lanche'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_BackOffice]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('BackOffice'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\n    \t\t\t\t\t\t,[Genesys_Almo\u00e7o]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Almo\u00e7o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Ambulat\u00f3rio]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Ambulat\u00f3rio'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Backoffice]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Backoffice'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Banheiro]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Banheiro'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Descanso]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Descanso'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Discagem Manual]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Discagem Manual'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Discagem Retorno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Discagem Retorno'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Dispon\u00edvel]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Dispon\u00edvel'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Em Fila]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Em Fila'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Feedback]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Feedback'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Sistema Externo]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Sistema Externo'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Sistema Interno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Sistema Interno'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Tratativa]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Tratativa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Whatsapp]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Whatsapp'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Treinamento]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Treinamento'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\n\n    \t\t\t\t\tFROM [db_Serasa_producao].[dbo].f_log l\n    \t\t\t\t\tRIGHT JOIN [#chaves] c\n    \t\t\t\t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(l.[ID Selecionar], '-')\n    \t\t\t\t\tAND\tc.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio]) / 30.0) * 30, 0)\n    \t\t\t\t\tAND\tc.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim]) / 30.0) * 30, 0)\n\n    \t\t\t\t\tWHERE c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim\n    \t\t\t\t\tAND\t  In\u00edcio >= @datahora_inicio AND Fim <= @datahora_fim\n    \t\t\t\t\tAND c.[\u00c9 A Tribo do MOP?] = 1\n    \t\t\t\t\tGROUP BY [DataHora], [Proxima_DataHora], c.[ID Selecionar], [Data],\t[Tribo Completa], [Fonte de Log]\n    \t\t\t\t) c\n    \t\t\t) c\n\n\n    \t\t) AS fonte\n\n    \t\tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n    \t\tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \t\tAND fonte.[Tribo Completa]\t=\tdestino.[Tribo Completa]\n\n    \t\tWHEN NOT MATCHED BY TARGET THEN\n    \t\t\tINSERT (\n    \t\t\t\t [Teve Evento de Log?]\n    \t\t\t\t,[DataHora]\n    \t\t\t\t,[ID Selecionar]\n    \t\t\t\t,[Tribo Completa]\n\t\t\t\t\t,[Login (Ponto)]\n\t\t\t\t\t,[Logout (Ponto)]\n    \t\t\t\t,[Trabalhado (Ponto)]\n    \t\t\t\t,[Em Pausa (Ponto)]\n\t\t\t\t\t,[Desvio Ponto-Log]\n    \t\t\t\t,[Login]\n    \t\t\t\t,[Logout]\n    \t\t\t\t,[Log descartado (>2HE)]\n    \t\t\t\t,[Log HE]\n    \t\t\t\t,[Log]\n    \t\t\t\t,[Log Produtivo]\n    \t\t\t\t,[Log Improdutivo]\n\t\t\t\t\t,[Tempo Total (Intelix)]\n\t\t\t\t\t,[Tempo Total (EPBX)]\n\t\t\t\t\t,[Tempo Total (Genesys)]\n\t\t\t\t\t,[Tempo Total (Secullum)]\n    \t\t\t\t,[Tempo Livre]\n    \t\t\t\t,[Pausa Particular (Intelix)]\n    \t\t\t\t,[Pausa Break (Intelix)]\n    \t\t\t\t,[Pausa 10 (Intelix)]\n    \t\t\t\t,[Pausa Outbound (Intelix)]\n    \t\t\t\t,[Pausa Lanche (Intelix)]\n    \t\t\t\t,[Pausa R\u00e1pida (Intelix)]\n    \t\t\t\t,[Pausa Almo\u00e7o (Intelix)]\n    \t\t\t\t,[Pausa Feedback (Intelix)]\n    \t\t\t\t,[Pausa Sistema Interno (Intelix)]\n    \t\t\t\t,[Pausa Sistema Externo (Intelix)]\n    \t\t\t\t,[Pausa Treinamento (Intelix)]\n    \t\t\t\t,[Pausa Banheiro (Intelix)]\n    \t\t\t\t,[Pausa Reuni\u00e3o (Intelix)]\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t\t\t,[Pausa NR17 (Intelix)]\n    \t\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t\t\t,[Pausa Almo\u00e7o (EPBX)]\n    \t\t\t\t,[Pausa Tratativa (EPBX)]\n    \t\t\t\t,[Pausa Discagem Manual (EPBX)]\n    \t\t\t\t,[Pausa Banheiro (EPBX)]\n    \t\t\t\t,[Pausa WhatsApp (EPBX)]\n    \t\t\t\t,[Pausa Intervalo (EPBX)]\n    \t\t\t\t,[Pausa Discagem Retorno (EPBX)]\n    \t\t\t\t,[Pausa Treinamento (EPBX)]\n    \t\t\t\t,[Pausa Feedback (EPBX)]\n    \t\t\t\t,[Pausa Transfer\u00eancia (EPBX)]\n    \t\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t\t\t,[Pausa Login (EPBX)]\n    \t\t\t\t,[Pausa Reuni\u00e3o (EPBX)]\n    \t\t\t\t,[Pausa Sistema Interno (EPBX)]\n    \t\t\t\t,[Pausa Sistema Externo (EPBX)]\n    \t\t\t\t,[Pausa NR17 (EPBX)]\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t\t\t,[Pausa Lanche (EPBX)]\n    \t\t\t\t,[Pausa BackOffice (EPBX)]\n    \t\t\t\t,[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t\t,[Pausa Banheiro (Genesys)]\n    \t\t\t\t,[Pausa Descanso (Genesys)]\n    \t\t\t\t,[Pausa Feedback (Genesys)]\n    \t\t\t\t,[Pausa Backoffice (Genesys)]\n    \t\t\t\t,[Pausa Discagem Manual (Genesys)]\n    \t\t\t\t,[Pausa Discagem Retorno (Genesys)]\n    \t\t\t\t,[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t\t,[Pausa Em Fila (Genesys)]\n    \t\t\t\t,[Pausa Sistema Externo (Genesys)]\n    \t\t\t\t,[Pausa Sistema Interno (Genesys)]\n    \t\t\t\t,[Pausa Tratativa (Genesys)]\n    \t\t\t\t,[Pausa Whatsapp (Genesys)]\n    \t\t\t\t,[Pausa Treinamento (Genesys)]\n    \t\t\t\t)\n    \t\t\tVALUES (\n    \t\t\t\t 1\n    \t\t\t\t,fonte.[DataHora]\n    \t\t\t\t,fonte.[ID Selecionar]\n    \t\t\t\t,fonte.[Tribo Completa]\n\t\t\t\t\t,fonte.[Login (Ponto)]\n\t\t\t\t\t,fonte.[Logout (Ponto)]\n    \t\t\t\t,fonte.[Trabalhado (Ponto)]\n    \t\t\t\t,fonte.[Em Pausa (Ponto)]\n\t\t\t\t\t,fonte.[Desvio Ponto-Log]\n    \t\t\t\t,fonte.[Login]\n    \t\t\t\t,fonte.[Logout]\n    \t\t\t\t,fonte.[Log descartado (>2HE)]\n    \t\t\t\t,fonte.[Log HE]\n    \t\t\t\t,fonte.[Log]\n    \t\t\t\t,fonte.[Log Produtivo]\n    \t\t\t\t,fonte.[Log Improdutivo]\n\t\t\t\t\t,fonte.[Tempo Total (Intelix)]\n\t\t\t\t\t,fonte.[Tempo Total (EPBX)]\n\t\t\t\t\t,fonte.[Tempo Total (Genesys)]\n\t\t\t\t\t,fonte.[Tempo Total (Secullum)]\n    \t\t\t\t,fonte.[Tempo Livre]\n    \t\t\t\t,fonte.[Pausa Particular (Intelix)]\n    \t\t\t\t,fonte.[Pausa Break (Intelix)]\n    \t\t\t\t,fonte.[Pausa 10 (Intelix)]\n    \t\t\t\t,fonte.[Pausa Outbound (Intelix)]\n    \t\t\t\t,fonte.[Pausa Lanche (Intelix)]\n    \t\t\t\t,fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t\t\t,fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t\t\t,fonte.[Pausa Feedback (Intelix)]\n    \t\t\t\t,fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t\t\t,fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t\t\t,fonte.[Pausa Treinamento (Intelix)]\n    \t\t\t\t,fonte.[Pausa Banheiro (Intelix)]\n    \t\t\t\t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t\t\t,fonte.[Pausa NR17 (Intelix)]\n    \t\t\t\t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t\t\t,fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t\t\t,fonte.[Pausa Tratativa (EPBX)]\n    \t\t\t\t,fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t\t\t,fonte.[Pausa Banheiro (EPBX)]\n    \t\t\t\t,fonte.[Pausa WhatsApp (EPBX)]\n    \t\t\t\t,fonte.[Pausa Intervalo (EPBX)]\n    \t\t\t\t,fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t\t\t,fonte.[Pausa Treinamento (EPBX)]\n    \t\t\t\t,fonte.[Pausa Feedback (EPBX)]\n    \t\t\t\t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t\t\t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t\t\t,fonte.[Pausa Login (EPBX)]\n    \t\t\t\t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t\t\t,fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t\t\t,fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t\t\t,fonte.[Pausa NR17 (EPBX)]\n    \t\t\t\t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t\t\t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t\t\t,fonte.[Pausa Lanche (EPBX)]\n    \t\t\t\t,fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t\t,fonte.[Pausa Banheiro (Genesys)]\n    \t\t\t\t,fonte.[Pausa Descanso (Genesys)]\n    \t\t\t\t,fonte.[Pausa Feedback (Genesys)]\n    \t\t\t\t,fonte.[Pausa Backoffice (Genesys)]\n    \t\t\t\t,fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t\t\t,fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t\t\t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t\t,fonte.[Pausa Em Fila (Genesys)]\n    \t\t\t\t,fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t\t\t,fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t\t\t,fonte.[Pausa Tratativa (Genesys)]\n    \t\t\t\t,fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t\t,fonte.[Pausa Treinamento (Genesys)]\n    \t\t\t\t)\n    \t\tWHEN MATCHED THEN\n    \t\t\tUPDATE SET\n    \t\t\t\t destino.[Teve Evento de Log?]\t\t\t\t=\t1\n    \t\t\t\t,destino.[DataHora]\t\t\t\t\t\t\t=\tfonte.[DataHora]\n    \t\t\t\t,destino.[ID Selecionar]\t\t\t\t\t=\tfonte.[ID Selecionar]\n    \t\t\t\t,destino.[Tribo Completa]\t\t\t\t\t=\tfonte.[Tribo Completa]\n\t\t\t\t\t,destino.[Login (Ponto)]\t\t\t\t\t=\tfonte.[Login (Ponto)]\n\t\t\t\t\t,destino.[Logout (Ponto)]\t\t\t\t\t=\tfonte.[Logout (Ponto)]\n    \t\t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t=\tfonte.[Trabalhado (Ponto)]\n    \t\t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t=\tfonte.[Em Pausa (Ponto)]\n\t\t\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t=\tfonte.[Desvio Ponto-Log]\n    \t\t\t\t,destino.[Login]\t\t\t\t\t\t\t=\tfonte.[Login]\n    \t\t\t\t,destino.[Logout]\t\t\t\t\t\t\t=\tfonte.[Logout]\n    \t\t\t\t,destino.[Log descartado (>2HE)]\t\t\t=\tfonte.[Log descartado (>2HE)]\n    \t\t\t\t,destino.[Log HE]\t\t\t\t\t\t\t=\tfonte.[Log HE]\n    \t\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t=\tfonte.[Log]\n    \t\t\t\t,destino.[Log Produtivo]\t\t\t\t\t=\tfonte.[Log Produtivo]\n    \t\t\t\t,destino.[Log Improdutivo]\t\t\t\t\t=\tfonte.[Log Improdutivo]\n\t\t\t\t\t,destino.[Tempo Total (Intelix)]\t\t\t=\tfonte.[Tempo Total (Intelix)]\n\t\t\t\t\t,destino.[Tempo Total (EPBX)]\t\t\t\t=\tfonte.[Tempo Total (EPBX)]\n\t\t\t\t\t,destino.[Tempo Total (Genesys)]\t\t\t=\tfonte.[Tempo Total (Genesys)]\n\t\t\t\t\t,destino.[Tempo Total (Secullum)]\t\t\t=\tfonte.[Tempo Total (Secullum)]\n    \t\t\t\t,destino.[Tempo Livre]\t\t\t\t\t\t=\tfonte.[Tempo Livre]\n    \t\t\t\t,destino.[Pausa Particular (Intelix)]\t\t=\tfonte.[Pausa Particular (Intelix)]\n    \t\t\t\t,destino.[Pausa Break (Intelix)]\t\t\t=\tfonte.[Pausa Break (Intelix)]\n    \t\t\t\t,destino.[Pausa 10 (Intelix)]\t\t\t\t=\tfonte.[Pausa 10 (Intelix)]\n    \t\t\t\t,destino.[Pausa Outbound (Intelix)]\t\t\t=\tfonte.[Pausa Outbound (Intelix)]\n    \t\t\t\t,destino.[Pausa Lanche (Intelix)]\t\t\t=\tfonte.[Pausa Lanche (Intelix)]\n    \t\t\t\t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\tfonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tfonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t\t\t,destino.[Pausa Feedback (Intelix)]\t\t\t=\tfonte.[Pausa Feedback (Intelix)]\n    \t\t\t\t,destino.[Pausa Sistema Interno (Intelix)]\t=\tfonte.[Pausa Sistema Interno (Intelix)]\n    \t\t\t\t,destino.[Pausa Sistema Externo (Intelix)]\t=\tfonte.[Pausa Sistema Externo (Intelix)]\n    \t\t\t\t,destino.[Pausa Treinamento (Intelix)]\t\t=\tfonte.[Pausa Treinamento (Intelix)]\n    \t\t\t\t,destino.[Pausa Banheiro (Intelix)]\t\t\t=\tfonte.[Pausa Banheiro (Intelix)]\n    \t\t\t\t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tfonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tfonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t\t\t,destino.[Pausa NR17 (Intelix)]\t\t\t\t=\tfonte.[Pausa NR17 (Intelix)]\n    \t\t\t\t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tfonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tfonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t\t\t,destino.[Pausa Tratativa (EPBX)]\t\t\t=\tfonte.[Pausa Tratativa (EPBX)]\n    \t\t\t\t,destino.[Pausa Discagem Manual (EPBX)]\t\t=\tfonte.[Pausa Discagem Manual (EPBX)]\n    \t\t\t\t,destino.[Pausa Banheiro (EPBX)]\t\t\t=\tfonte.[Pausa Banheiro (EPBX)]\n    \t\t\t\t,destino.[Pausa WhatsApp (EPBX)]\t\t\t=\tfonte.[Pausa WhatsApp (EPBX)]\n    \t\t\t\t,destino.[Pausa Intervalo (EPBX)]\t\t\t=\tfonte.[Pausa Intervalo (EPBX)]\n    \t\t\t\t,destino.[Pausa Discagem Retorno (EPBX)]\t=\tfonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t\t\t,destino.[Pausa Treinamento (EPBX)]\t\t\t=\tfonte.[Pausa Treinamento (EPBX)]\n    \t\t\t\t,destino.[Pausa Feedback (EPBX)]\t\t\t=\tfonte.[Pausa Feedback (EPBX)]\n    \t\t\t\t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\tfonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t\t\t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tfonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t\t\t,destino.[Pausa Login (EPBX)]\t\t\t\t=\tfonte.[Pausa Login (EPBX)]\n    \t\t\t\t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tfonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t\t\t,destino.[Pausa Sistema Interno (EPBX)]\t\t=\tfonte.[Pausa Sistema Interno (EPBX)]\n    \t\t\t\t,destino.[Pausa Sistema Externo (EPBX)]\t\t=\tfonte.[Pausa Sistema Externo (EPBX)]\n    \t\t\t\t,destino.[Pausa NR17 (EPBX)]\t\t\t\t=\tfonte.[Pausa NR17 (EPBX)]\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tfonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t\t\t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tfonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t\t\t,destino.[Pausa Lanche (EPBX)]\t\t\t\t=\tfonte.[Pausa Lanche (EPBX)]\n    \t\t\t\t,destino.[Pausa BackOffice (EPBX)]\t\t\t=\tfonte.[Pausa BackOffice (EPBX)]\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tfonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tfonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t=\tfonte.[Pausa Banheiro (Genesys)]\n    \t\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t=\tfonte.[Pausa Descanso (Genesys)]\n    \t\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t=\tfonte.[Pausa Feedback (Genesys)]\n    \t\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t=\tfonte.[Pausa Backoffice (Genesys)]\n    \t\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t=\tfonte.[Pausa Discagem Manual (Genesys)]\n    \t\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t=\tfonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\tfonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t=\tfonte.[Pausa Em Fila (Genesys)]\n    \t\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t=\tfonte.[Pausa Sistema Externo (Genesys)]\n    \t\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t=\tfonte.[Pausa Sistema Interno (Genesys)]\n    \t\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t=\tfonte.[Pausa Tratativa (Genesys)]\n    \t\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t=\tfonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t=\tfonte.[Pausa Treinamento (Genesys)]\n    \t\tWHEN NOT MATCHED BY SOURCE THEN\n    \t\t\tUPDATE SET\n    \t\t\t\t destino.[Teve Evento de Log?]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t=\tNULL\n    \t\t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t=\tNULL\n    \t\t\t\t,destino.[Jornada (Log)]\t\t\t\t\t=\t0\n\t\t\t\t\t,destino.[Login (Ponto)]\t\t\t\t\t=\tNULL\n\t\t\t\t\t,destino.[Logout (Ponto)]\t\t\t\t\t=\tNULL\n\t\t\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Login]\t\t\t\t\t\t\t=\tNULL\n    \t\t\t\t,destino.[Logout]\t\t\t\t\t\t\t=\tNULL\n    \t\t\t\t,destino.[Log descartado (>2HE)]\t\t\t=\t0\n    \t\t\t\t,destino.[Log HE]\t\t\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Log Produtivo]\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Log Improdutivo]\t\t\t\t\t=\t0\n\t\t\t\t\t,destino.[Tempo Total (Intelix)]\t\t\t=\t0\n\t\t\t\t\t,destino.[Tempo Total (EPBX)]\t\t\t\t=\t0\n\t\t\t\t\t,destino.[Tempo Total (Genesys)]\t\t\t=\t0\n\t\t\t\t\t,destino.[Tempo Total (Secullum)]\t\t\t=\t0\n    \t\t\t\t,destino.[Tempo Livre]\t\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Particular (Intelix)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Break (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa 10 (Intelix)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Outbound (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Lanche (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Feedback (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Interno (Intelix)]\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Externo (Intelix)]\t=\t0\n    \t\t\t\t,destino.[Pausa Treinamento (Intelix)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Banheiro (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa NR17 (Intelix)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Tratativa (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Discagem Manual (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Banheiro (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa WhatsApp (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Intervalo (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Discagem Retorno (EPBX)]\t=\t0\n    \t\t\t\t,destino.[Pausa Treinamento (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Feedback (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Login (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Interno (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Externo (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa NR17 (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Lanche (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa BackOffice (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t=\t0\n    \t\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t=\t0\n    \t\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t=\t0\n    \t\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t=\t0\n    \t\t;\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_log;\n        END\n    IF 1=1 BEGIN; PRINT '--- cleanup';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_cleanup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT DISTINCT\n    \t\t\t [DataHora]\t\t\t\t\t\t\t=\tc.[DataHora]\n    \t\t\t,[Intervalo]\t\t\t\t\t\t=\tMIN(c.[Intervalo])\n    \t\t\t,[Data]\t\t\t\t\t\t\t\t=\tMIN(c.[Data])\n    \t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t=\tMIN(c.[Ciclo (Primeiro Dia)])\n    \t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t=\tMIN(c.[M\u00eas (Primeiro Dia)])\n\n                ,[Feriado (Nome)]                                     =  MAX(c.[Feriado (Nome)])\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(MAX(c.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(MAX(c.[Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t        ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(MAX(c.[Secullum - Servi\u00e7o Militar]                                   ),0)\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(MAX(c.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t        ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(MAX(c.[Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t        ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(MAX(c.[Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(MAX(c.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t        ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(MAX(c.[Secullum - Licen\u00e7a Casamento]                                 ),0)\n                ,[Secullum - INSS - Afastamento]                                    =   ISNULL(MAX(c.[Secullum - INSS - Afastamento]                                ),0)\n                ,[Secullum - Folga]                                                 =   ISNULL(MAX(c.[Secullum - Folga]                                             ),0)\n                ,[Secullum - F\u00e9rias]                                                =   ISNULL(MAX(c.[Secullum - F\u00e9rias]                                            ),0)\n       \t        ,[Secullum - Feriado]                                               =   ISNULL(MAX(c.[Secullum - Feriado]                                           ),0)\n       \t        ,[Secullum - Falta Justificada]                                     =   ISNULL(MAX(c.[Secullum - Falta Justificada]                                 ),0)\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(MAX(c.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                ,[Secullum - Falta Injustificada]                                   =   ISNULL(MAX(c.[Secullum - Falta Injustificada]                               ),0)\n       \t        ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(MAX(c.[Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(MAX(c.[Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                ,[Secullum - Desligue]                                              =   ISNULL(MAX(c.[Secullum - Desligue]                                          ),0)\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(MAX(c.[Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t        ,[Secullum - Compensando Horas]                                     =   ISNULL(MAX(c.[Secullum - Compensando Horas]                                 ),0)\n       \t        ,[Secullum - Atestado]                                              =   ISNULL(MAX(c.[Secullum - Atestado]                                          ),0)\n                ,[Secullum - Abono]                                                 =   ISNULL(MAX(c.[Secullum - Abono]                                             ),0)\n       \t        ,[Secullum - Abono Lactante]                                        =   ISNULL(MAX(c.[Secullum - Abono Lactante]                                    ),0)\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(MAX(c.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t        ,[Faltas Justificadas]                                              =   ISNULL(MAX(c.[Faltas Justificadas]                                          ),0)\n       \t        ,[Faltas Injustificadas]                                            =   ISNULL(MAX(c.[Faltas Injustificadas]                                        ),0)\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tMIN(c.[DataHora da Atualiza\u00e7\u00e3o do MOP])\n    \t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n    \t\t\t,[Nome]\t\t\t\t\t\t\t\t=\tMIN(c.[Nome])\n    \t\t\t,[Status]\t\t\t\t\t\t\t=\tMIN(c.[Status])\n    \t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN(c.[Situa\u00e7\u00e3o])\n    \t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN(c.[Condi\u00e7\u00e3o])\n    \t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tMIN(c.[DMA Inicial])\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tMIN(c.[\u00daltima DMA Migra\u00e7\u00e3o])\n    \t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tMIN(c.[\u00daltima DMA Geral])\n    \t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tMIN(c.[Tipo da \u00daltima DMA])\n    \t\t\t,[Instrutor Inicial]\t\t\t\t=\tMIN(c.[Instrutor Inicial])\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tMIN(c.[Instrutor \u00daltima Migra\u00e7\u00e3o])\n    \t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tMIN(c.[Instrutor \u00daltima DMA])\n    \t\t\t,[Cliente]\t\t\t\t\t\t\t=\tPARSENAME(REPLACE(COALESCE(r.[Tribo Completa], c.[Tribo Completa]),'__','.'),3)\n    \t\t\t,[Projeto]\t\t\t\t\t\t\t=\tPARSENAME(REPLACE(COALESCE(r.[Tribo Completa], c.[Tribo Completa]),'__','.'),2)\n    \t\t\t,[Tribo]\t\t\t\t\t\t\t=\tPARSENAME(REPLACE(COALESCE(r.[Tribo Completa], c.[Tribo Completa]),'__','.'),1)\n    \t\t\t,[Cargo]\t\t\t\t\t\t\t=\tMIN(c.[Cargo])\n    \t\t\t,[Tribo Completa]\t\t\t\t\t=\tCOALESCE(r.[Tribo Completa], c.[Tribo Completa])\n    \t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tMIN(c.[Supervis\u00e3o])\n    \t\t\t,[Email Supervis\u00e3o]\t\t\t\t\t=\tMIN(c.[Email Supervis\u00e3o])\n\t\t\t\t,[Tempo de Casa (Dias)]\t\t\t\t=\tMIN(c.[Tempo de Casa (Dias)])\n\t\t\t\t,[Faixa Tempo de Casa]\t\t\t\t=\tMIN(c.[Faixa Tempo de Casa])\n\t\t\t\t,[Idade]\t\t\t\t\t\t\t=\tMIN(c.[Idade])\n\t\t\t\t,[Faixa de Idade]\t\t\t\t\t=\tMIN(c.[Faixa de Idade])\n    \t\t\t,[Turno]\t\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Turno]), NULL)\n    \t\t\t,[Escala (Ponto)]\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Escala (Ponto)]), NULL)\n    \t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Jornada (Ponto)]), 0)\n    \t\t\t,[Escala (MOP)]\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Escala (MOP)]), NULL)\n    \t\t\t,[Jornada (Log)]\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Jornada (Log)]), 0)\n\t\t\t\t,[Fonte de Log]\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Fonte de Log]), NULL)\n\n    \t\t\t,[Teve Evento de MOP?]\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], 1, 0)\n    \t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], 1, 0)\n\n    \t\t\t,[log_dia]\t\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], SUM(SUM(r.[Log])) OVER (PARTITION BY MIN(r.[Data]), MIN(r.[ID Selecionar]), MIN(r.[Tribo Completa])), 0)\n\t\t\t\t,[ponto_dia]\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], SUM(SUM(r.[Trabalhado (Ponto)])) OVER (PARTITION BY MIN(r.[Data]), MIN(r.[ID Selecionar]), MIN(r.[Tribo Completa])), 0)\n\n    \t\tFROM [#chaves] c\n    \t\tLEFT JOIN r_individuo_30min r\n    \t\tON r.[DataHora] = c.[DataHora]\n    \t\tAND COALESCE(r.[ID Selecionar], '-') = COALESCE(c.[ID Selecionar], '-')\n    \t\t--WHERE  (r.[DataHora] <= @datahora_fim AND r.[DataHora] >= @datahora_inicio)                   --<---- Por algum motivo, botar esse filtro acaba removendo os dias \"sem evento\", efetivamente ignorando aus\u00eancias de pessoas ativas no MOP.\n    \t\tGROUP BY c.[DataHora], c.[ID Selecionar], COALESCE(r.[Tribo Completa], c.[Tribo Completa]), c.[Tribo Completa]\n    \t) AS fonte\n    \tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT (\n    \t\t\t [DataHora]\n    \t\t\t,[Intervalo]\n    \t\t\t,[Data]\n    \t\t\t,[Ciclo (Primeiro Dia)]\n    \t\t\t,[M\u00eas (Primeiro Dia)]\n\n                ,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,[ID Selecionar]\n    \t\t\t,[Nome]\n    \t\t\t,[Status]\n    \t\t\t,[Situa\u00e7\u00e3o]\n    \t\t\t,[Condi\u00e7\u00e3o]\n    \t\t\t,[DMA Inicial]\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,[\u00daltima DMA Geral]\n    \t\t\t,[Tipo da \u00daltima DMA]\n    \t\t\t,[Instrutor Inicial]\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,[Instrutor \u00daltima DMA]\n    \t\t\t,[Cliente]\n    \t\t\t,[Projeto]\n    \t\t\t,[Cargo]\n    \t\t\t,[Tribo]\n    \t\t\t,[Tribo Completa]\n    \t\t\t,[Supervis\u00e3o]\n\t\t\t\t,[Email Supervis\u00e3o]\n\t\t\t\t,[Tempo de Casa (Dias)]\n\t\t\t\t,[Faixa Tempo de Casa]\n\t\t\t\t,[Idade]\n\t\t\t\t,[Faixa de Idade]\n    \t\t\t,[Turno]\n    \t\t\t,[Escala (Ponto)]\n    \t\t\t,[Jornada (Ponto)]\n    \t\t\t,[Tipo de Jornada (Ponto)]\n    \t\t\t,[Escala (MOP)]\n    \t\t\t,[Jornada (Log)]\n\t\t\t\t,[Fonte de Log]\n    \t\t\t,[Tipo de Jornada]\n    \t\t\t,[Teve Evento de MOP?]\n    \t\t\t,[\u00c9 A Tribo do MOP?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n    \t\t\t fonte.[DataHora]\n    \t\t\t,fonte.[Intervalo]\n    \t\t\t,fonte.[Data]\n    \t\t\t,fonte.[Ciclo (Primeiro Dia)]\n    \t\t\t,fonte.[M\u00eas (Primeiro Dia)]\n\n                ,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n    \t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,fonte.[ID Selecionar]\n    \t\t\t,fonte.[Nome]\n    \t\t\t,fonte.[Status]\n    \t\t\t,fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,fonte.[Condi\u00e7\u00e3o]\n    \t\t\t,fonte.[DMA Inicial]\n    \t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[\u00daltima DMA Geral]\n    \t\t\t,fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,fonte.[Instrutor Inicial]\n    \t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[Instrutor \u00daltima DMA]\n    \t\t\t,fonte.[Cliente]\n    \t\t\t,fonte.[Projeto]\n    \t\t\t,fonte.[Cargo]\n    \t\t\t,fonte.[Tribo]\n    \t\t\t,fonte.[Tribo Completa]\n    \t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t\t,fonte.[Email Supervis\u00e3o]\n\t\t\t\t,fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,fonte.[Faixa Tempo de Casa]\n\t\t\t\t,fonte.[Idade]\n\t\t\t\t,fonte.[Faixa de Idade]\n    \t\t\t,fonte.[Turno]\n\n    \t\t\t,fonte.[Escala (Ponto)]\n    \t\t\t,fonte.[Jornada (Ponto)]\n    \t\t\t,CASE\n    \t\t\t\tWHEN fonte.[Secullum - Folga]\t\t= 1 THEN 'FOLGA'\n    \t\t\t\tWHEN fonte.[Secullum - Feriado] >0\t\tTHEN 'FERIADO'\n    \t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\tTHEN 'TREINAMENTO'\n    \t\t\t\tWHEN fonte.[Jornada (Ponto)] = 0\t\tTHEN 'OK'\n    \t\t\t\tWHEN fonte.[Jornada (Ponto)] > 0\t\tTHEN 'FALTA'\n    \t\t\t END\n\n    \t\t\t,fonte.[Escala (MOP)]\n    \t\t\t,fonte.[Jornada (Log)]\n\t\t\t\t,fonte.[Fonte de Log]\n    \t\t\t,CASE\n    \t\t\t\tWHEN fonte.[Secullum - Folga]\t\t= 1 THEN 'FOLGA'\n    \t\t\t\tWHEN fonte.[Secullum - Feriado] >0\t\tTHEN 'FERIADO'\n    \t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\tTHEN 'TREINAMENTO'\n    \t\t\t\tWHEN fonte.[Jornada (Log)] = 0\t\t\tTHEN 'OK'\n    \t\t\t\tWHEN fonte.[Jornada (Log)] > 0\t\t\tTHEN 'FALTA'\n    \t\t\t END\n\n    \t\t\t,fonte.[Teve Evento de MOP?]\n    \t\t\t,fonte.[\u00c9 A Tribo do MOP?]\n    \t\t)\n\n    \tWHEN MATCHED\n    \t\tAND (\n    \t\t\t\tfonte.[Teve Evento de MOP?]\t\t\t= 1\n    \t\t\tOR  fonte.[\u00c9 a Tribo do MOP?]\t\t\t= 1\n    \t\t\tOR\tdestino.[Teve Evento de Tickets?]\t= 1\n    \t\t\tOR\tdestino.[Teve Evento de Chamadas?]\t= 1\n    \t\t\tOR\tdestino.[Teve Evento de NPS?]\t\t= 1\n    \t\t\tOR\tdestino.[Teve Evento de Log?]\t\t= 1\n    \t\t)\n    \t\tTHEN\n    \t\tUPDATE SET\n    \t\t\t destino.[\u00c9 A Tribo do MOP?]\t\t\t\t=\tfonte.[\u00c9 A Tribo do MOP?]\n    \t\t\t,destino.[Teve Evento de MOP?]\t\t\t\t=\tfonte.[Teve Evento de MOP?]\n\n    \t\t\t,destino.[Intervalo]\t\t\t\t\t\t=\tfonte.[Intervalo]\n    \t\t\t,destino.[Data]\t\t\t\t\t\t\t\t=\tfonte.[Data]\n    \t\t\t,destino.[Ciclo (Primeiro Dia)]\t\t\t\t=\tfonte.[Ciclo (Primeiro Dia)]\n    \t\t\t,destino.[M\u00eas (Primeiro Dia)]\t\t\t\t=\tfonte.[M\u00eas (Primeiro Dia)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n    \t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tfonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,destino.[ID Selecionar]\t\t\t\t\t=\tfonte.[ID Selecionar]\n    \t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t=\tfonte.[Nome]\n    \t\t\t,destino.[Status]\t\t\t\t\t\t\t=\tfonte.[Status]\n    \t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tfonte.[Situa\u00e7\u00e3o]\n    \t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tfonte.[Condi\u00e7\u00e3o]\n    \t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t=\tfonte.[DMA Inicial]\n    \t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tfonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t=\tfonte.[\u00daltima DMA Geral]\n    \t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t=\tfonte.[Tipo da \u00daltima DMA]\n    \t\t\t,destino.[Instrutor Inicial]\t\t\t\t=\tfonte.[Instrutor Inicial]\n    \t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tfonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t=\tfonte.[Instrutor \u00daltima DMA]\n    \t\t\t,destino.[Cliente]\t\t\t\t\t\t\t=\tfonte.[Cliente]\n    \t\t\t,destino.[Projeto]\t\t\t\t\t\t\t=\tfonte.[Projeto]\n    \t\t\t,destino.[Tribo]\t\t\t\t\t\t\t=\tfonte.[Tribo]\n    \t\t\t,destino.[Cargo]\t\t\t\t\t\t\t=\tfonte.[Cargo]\n    \t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t=\tfonte.[Supervis\u00e3o]\n\t\t\t\t,destino.[Email Supervis\u00e3o]\t\t\t\t\t=\tfonte.[Email Supervis\u00e3o]\n\t\t\t\t,destino.[Tempo de Casa (Dias)]\t\t\t\t=\tfonte.[Tempo de Casa (Dias)]\n\t\t\t\t,destino.[Faixa Tempo de Casa]\t\t\t\t=\tfonte.[Faixa Tempo de Casa]\n\t\t\t\t,destino.[Idade]\t\t\t\t\t\t\t=\tfonte.[Idade]\n\t\t\t\t,destino.[Faixa de Idade]\t\t\t\t\t=\tfonte.[Faixa de Idade]\n    \t\t\t,destino.[Turno]\t\t\t\t\t\t\t=\tfonte.[Turno]\n    \t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t=\tfonte.[Escala (Ponto)]\n    \t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t=\tfonte.[Jornada (Ponto)]\n    \t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t=\tfonte.[Escala (MOP)]\n    \t\t\t,destino.[Jornada (Log)]\t\t\t\t\t=\tfonte.[Jornada (Log)]\n\t\t\t\t,destino.[Fonte de Log]\t\t\t\t\t\t=\tfonte.[Fonte de Log]\n    \t\t\t,destino.[Tipo de Jornada (Ponto)]\t\t\t=\tCASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Secullum - Folga] = 1\t\t\t\t\t\tTHEN 'FOLGA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Secullum - Feriado] >0\t\t\t\t\t\tTHEN 'FERIADO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\t\t\t\t\tTHEN 'TREINAMENTO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Ponto)] = [ponto_dia]\t\t\t\tTHEN 'OK'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [ponto_dia] = 0 AND fonte.[Jornada (ponto)] > 0\tTHEN 'FALTA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Ponto)] > [ponto_dia]\t\t\t\tTHEN 'ABS'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Ponto)] < [ponto_dia]\t\t\t\tTHEN 'HE'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t END\n    \t\t\t,destino.[Tipo de Jornada]\t\t\t\t\t=\tCASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Secullum - Folga] = 1\t\t\t\t\tTHEN 'FOLGA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Secullum - Feriado] >0\t\t\t\t\tTHEN 'FERIADO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\t\t\t\tTHEN 'TREINAMENTO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Log)] = [log_dia]\t\t\t\tTHEN 'OK'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [log_dia] = 0 AND fonte.[Jornada (Log)] > 0\tTHEN 'FALTA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Log)] > [log_dia]\t\t\t\tTHEN 'ABS'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Log)] < [log_dia]\t\t\t\tTHEN 'HE'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t END\n\n    \tWHEN MATCHED AND\t(\n                fonte.[\u00c9 A Tribo do MOP?]\t\t    = 0\n    \t    AND\tfonte.[Teve Evento de MOP?]\t        = 0\n    \t\tAND\tdestino.[Teve Evento de Tickets?]\t= 0\n    \t\tAND\tdestino.[Teve Evento de Chamadas?]\t= 0\n    \t\tAND\tdestino.[Teve Evento de NPS?]\t\t= 0\n    \t\tAND\tdestino.[Teve Evento de Log?]\t\t= 0\n    \t\t)\n    \tTHEN DELETE\n\n    \tWHEN NOT MATCHED BY SOURCE AND\t(\n    \t\t    destino.[Teve Evento de Tickets?]\t= 0\n    \t\tAND\tdestino.[Teve Evento de Chamadas?]\t= 0\n    \t\tAND\tdestino.[Teve Evento de NPS?]\t\t= 0\n    \t\tAND\tdestino.[Teve Evento de Log?]\t\t= 0\n    \t\t)\n    \tTHEN DELETE;\n\n        DELETE FROM r_individuo_30min\n        WHERE [Data] >= CAST(GETDATE() AS DATE)\n\t\t\tOR(\t[\u00c9 A Tribo do MOP?]\t\t    = 0\n    \t    AND\t[Teve Evento de MOP?]\t    = 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0)\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_cleanup;\n        END\n    IF 1=1 BEGIN; PRINT '--- agrupamento individuo dia';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_dia]\n    \t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n    \t\tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT\n    \t\t\t [Data]\t\t\t\t\t\t\t\t=\t[Data]\n    \t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t=\tMIN([Ciclo (Primeiro Dia)])\n    \t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t=\tMIN([M\u00eas (Primeiro Dia)])\n\n\n                ,[Feriado (Nome)]                                     =  MAX([Feriado (Nome)])\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   MAX([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              )\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   MAX([Secullum - Suspens\u00e3o por advert\u00eancia]                         )\n       \t        ,[Secullum - Servi\u00e7o Militar]                                       =   MAX([Secullum - Servi\u00e7o Militar]                                   )\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   MAX([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  )\n       \t        ,[Secullum - Licen\u00e7a Paternidade]                                   =   MAX([Secullum - Licen\u00e7a Paternidade]                               )\n       \t        ,[Secullum - Licen\u00e7a Maternidade]                                   =   MAX([Secullum - Licen\u00e7a Maternidade]                               )\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   MAX([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     )\n       \t        ,[Secullum - Licen\u00e7a Casamento]                                     =   MAX([Secullum - Licen\u00e7a Casamento]                                 )\n                ,[Secullum - INSS - Afastamento]                                    =   MAX([Secullum - INSS - Afastamento]                                )\n                ,[Secullum - Folga]                                                 =   MAX([Secullum - Folga]                                             )\n                ,[Secullum - F\u00e9rias]                                                =   MAX([Secullum - F\u00e9rias]                                            )\n       \t        ,[Secullum - Feriado]                                               =   MAX([Secullum - Feriado]                                           )\n       \t        ,[Secullum - Falta Justificada]                                     =   MAX([Secullum - Falta Justificada]                                 )\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   MAX([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)])\n                ,[Secullum - Falta Injustificada]                                   =   MAX([Secullum - Falta Injustificada]                               )\n       \t        ,[Secullum - Prova de Vestibular / ENEM]                            =   MAX([Secullum - Prova de Vestibular / ENEM]                        )\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   MAX([Secullum - Doa\u00e7\u00e3o de Sangue]                                  )\n                ,[Secullum - Desligue]                                              =   MAX([Secullum - Desligue]                                          )\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   MAX([Secullum - Convoca\u00e7\u00e3o Judicial]                               )\n       \t        ,[Secullum - Compensando Horas]                                     =   MAX([Secullum - Compensando Horas]                                 )\n       \t        ,[Secullum - Atestado]                                              =   MAX([Secullum - Atestado]                                          )\n                ,[Secullum - Abono]                                                 =   MAX([Secullum - Abono]                                             )\n       \t        ,[Secullum - Abono Lactante]                                        =   MAX([Secullum - Abono Lactante]                                    )\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   MAX([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     )\n       \t        ,[Faltas Justificadas]                                              =   MAX([Faltas Justificadas]                                          )\n       \t        ,[Faltas Injustificadas]                                            =   MAX([Faltas Injustificadas]                                        )\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tMIN([DataHora da Atualiza\u00e7\u00e3o do MOP])\n    \t\t\t,[ID Selecionar]\t\t\t\t\t=\t[ID Selecionar]\n    \t\t\t,[Nome]\t\t\t\t\t\t\t\t=\tMIN([Nome])\n    \t\t\t,[Status]\t\t\t\t\t\t\t=\tMIN([Status])\n    \t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([Situa\u00e7\u00e3o])\n    \t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([Condi\u00e7\u00e3o])\n\n    \t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tMIN([DMA Inicial])\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tMIN([\u00daltima DMA Migra\u00e7\u00e3o])\n    \t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tMIN([\u00daltima DMA Geral])\n    \t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tMIN([Tipo da \u00daltima DMA])\n    \t\t\t,[Instrutor Inicial]\t\t\t\t=\tMIN([Instrutor Inicial])\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tMIN([Instrutor \u00daltima Migra\u00e7\u00e3o])\n    \t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tMIN([Instrutor \u00daltima DMA])\n\n    \t\t\t,[Cliente]\t\t\t\t\t\t\t=\tMIN([Cliente])\n    \t\t\t,[Projeto]\t\t\t\t\t\t\t=\tMIN([Projeto])\n    \t\t\t,[Cargo]\t\t\t\t\t\t\t=\tMIN([Cargo])\n    \t\t\t,[Tribo]\t\t\t\t\t\t\t=\tMIN([Tribo])\n    \t\t\t,[Tribo Completa]\t\t\t\t\t=\t[Tribo Completa]\n    \t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tMIN([Supervis\u00e3o])\n    \t\t\t,[Email Supervis\u00e3o]\t\t\t\t\t=\tMIN([Email Supervis\u00e3o])\n\t\t\t\t,[Tempo de Casa (Dias)]\t\t\t\t=\tMIN([Tempo de Casa (Dias)])\n\t\t\t\t,[Faixa Tempo de Casa]\t\t\t\t=\tMIN([Faixa Tempo de Casa])\n\t\t\t\t,[Idade]\t\t\t\t\t\t\t=\tMIN([Idade])\n\t\t\t\t,[Faixa de Idade]\t\t\t\t\t=\tMIN([Faixa de Idade])\n    \t\t\t,[Turno]\t\t\t\t\t\t\t=\tMIN([Turno])\n    \t\t\t,[Escala (Ponto)]\t\t\t\t\t=\tMIN([Escala (Ponto)])\n    \t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tMIN([Jornada (Ponto)])\n    \t\t\t,[Tipo de Jornada (Ponto)]\t\t\t=\t CASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN(CAST([Secullum - Folga] AS INT))\t= 1\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FOLGA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Secullum - Feriado]) >0\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FERIADO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Status]) = 'Treinamento'\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'TREINAMENTO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Ponto)]), 0) = SUM([Trabalhado (Ponto)])\t\t\tTHEN 'OK'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Trabalhado (Ponto)]) = 0 AND IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Ponto)]), 0) > 0\tTHEN 'FALTA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Ponto)]), 0) > SUM([Trabalhado (Ponto)])\t\t\tTHEN 'ABS'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Ponto)]), 0) < SUM([Trabalhado (Ponto)])\t\t\tTHEN 'HE'\n    \t\t\t\t\t\t\t\t\t\t\t\t\tEND\n    \t\t\t,[Login (Ponto)]\t\t\t\t\t=\tMIN([Login (Ponto)])\n    \t\t\t,[Logout (Ponto)]\t\t\t\t\t=\tMAX([Logout (Ponto)])\n    \t\t\t,[Trabalhado (Ponto)]\t\t\t\t=\tSUM([Trabalhado (Ponto)])\n    \t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=\tSUM([Em Pausa (Ponto)])\n\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t=\tSUM([Desvio Ponto-Log])\n    \t\t\t,[Escala (MOP)]\t\t\t\t\t\t=\tMIN([Escala (MOP)])\n    \t\t\t,[Jornada (Log)]\t\t\t\t\t=\tMIN([Jornada (Log)])\n\t\t\t\t,[Fonte de Log]\t\t\t\t\t\t=\tMIN([Fonte de Log])\n    \t\t\t,[Tipo de Jornada]\t\t\t\t\t=\t CASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN(CAST([Secullum - Folga] AS INT))\t= 1\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FOLGA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Secullum - Feriado]) >0\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FERIADO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Status]) = 'Treinamento'\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'TREINAMENTO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) = SUM([Log])\t\t\t\tTHEN 'OK'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Log]) = 0 AND IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) > 0\tTHEN 'FALTA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) > SUM([Log])\t\t\t\tTHEN 'ABS'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) < SUM([Log])\t\t\t\tTHEN 'HE'\n    \t\t\t\t\t\t\t\t\t\t\t\t\tEND\n    \t\t\t,[Login]\t\t\t\t\t\t\t=\tMIN([Login])\n    \t\t\t,[Logout]\t\t\t\t\t\t\t=\tMAX([Logout])\n    \t\t\t,[Log descartado (>2HE)]\t\t\t=\tSUM([Log descartado (>2HE)])\n    \t\t\t,[Log HE]\t\t\t\t\t\t\t\t=\tSUM([Log HE])\n    \t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM([Log])\n    \t\t\t,[Log Produtivo]\t\t\t\t\t=\tSUM([Log Produtivo])\n    \t\t \t,[Log Improdutivo]\t\t\t\t\t=\tSUM([Log Improdutivo])\n\t\t\t\t,[Tempo Total (Intelix)]\t\t\t=\tSUM([Tempo Total (Intelix)])\n\t\t\t\t,[Tempo Total (EPBX)]\t\t\t\t=\tSUM([Tempo Total (EPBX)])\n\t\t\t\t,[Tempo Total (Genesys)]\t\t\t=\tSUM([Tempo Total (Genesys)])\n\t\t\t\t,[Tempo Total (Secullum)]\t\t\t=\tSUM([Tempo Total (Secullum)])\n    \t\t \t,[Tempo Livre]\t\t\t\t\t\t=\tSUM([Tempo Livre])\n    \t\t \t,[Pausa Particular (Intelix)]\t\t=\tSUM([Pausa Particular (Intelix)])\n    \t\t \t,[Pausa Break (Intelix)]\t\t\t=\tSUM([Pausa Break (Intelix)])\n    \t\t \t,[Pausa 10 (Intelix)]\t\t\t\t=\tSUM([Pausa 10 (Intelix)])\n    \t\t \t,[Pausa Outbound (Intelix)]\t\t\t=\tSUM([Pausa Outbound (Intelix)])\n    \t\t  \t,[Pausa Lanche (Intelix)]\t\t\t=\tSUM([Pausa Lanche (Intelix)])\n    \t\t  \t,[Pausa R\u00e1pida (Intelix)]\t\t\t=\tSUM([Pausa R\u00e1pida (Intelix)])\n    \t\t  \t,[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Intelix)])\n    \t\t  \t,[Pausa Feedback (Intelix)]\t\t\t=\tSUM([Pausa Feedback (Intelix)])\n    \t\t  \t,[Pausa Sistema Interno (Intelix)]\t=\tSUM([Pausa Sistema Interno (Intelix)])\n    \t\t  \t,[Pausa Sistema Externo (Intelix)]\t=\tSUM([Pausa Sistema Externo (Intelix)])\n    \t\t  \t,[Pausa Treinamento (Intelix)]\t\t=\tSUM([Pausa Treinamento (Intelix)])\n    \t\t  \t,[Pausa Banheiro (Intelix)]\t\t\t=\tSUM([Pausa Banheiro (Intelix)])\n    \t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tSUM([Pausa Reuni\u00e3o (Intelix)])\n    \t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Intelix)])\n    \t\t  \t,[Pausa NR17 (Intelix)]\t\t\t\t=\tSUM([Pausa NR17 (Intelix)])\n    \t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Liga\u00e7\u00e3o (EPBX)])\n    \t\t  \t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tSUM([Pausa Almo\u00e7o (EPBX)])\n    \t\t  \t,[Pausa Tratativa (EPBX)]\t\t\t=\tSUM([Pausa Tratativa (EPBX)])\n    \t\t  \t,[Pausa Discagem Manual (EPBX)]\t\t=\tSUM([Pausa Discagem Manual (EPBX)])\n    \t\t  \t,[Pausa Banheiro (EPBX)]\t\t\t=\tSUM([Pausa Banheiro (EPBX)])\n    \t\t  \t,[Pausa WhatsApp (EPBX)]\t\t\t=\tSUM([Pausa WhatsApp (EPBX)])\n    \t\t  \t,[Pausa Intervalo (EPBX)]\t\t\t=\tSUM([Pausa Intervalo (EPBX)])\n    \t\t  \t,[Pausa Discagem Retorno (EPBX)]\t=\tSUM([Pausa Discagem Retorno (EPBX)])\n    \t\t  \t,[Pausa Treinamento (EPBX)]\t\t\t=\tSUM([Pausa Treinamento (EPBX)])\n    \t\t  \t,[Pausa Feedback (EPBX)]\t\t\t=\tSUM([Pausa Feedback (EPBX)])\n    \t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\t\t=\tSUM([Pausa Transfer\u00eancia (EPBX)])\n    \t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tSUM([Pausa N\u00e3o Disponivel (EPBX)])\n    \t\t  \t,[Pausa Login (EPBX)]\t\t\t\t=\tSUM([Pausa Login (EPBX)])\n    \t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Reuni\u00e3o (EPBX)])\n    \t\t  \t,[Pausa Sistema Interno (EPBX)]\t\t=\tSUM([Pausa Sistema Interno (EPBX)])\n    \t\t  \t,[Pausa Sistema Externo (EPBX)]\t\t=\tSUM([Pausa Sistema Externo (EPBX)])\n    \t\t  \t,[Pausa NR17 (EPBX)]\t\t\t\t=\tSUM([Pausa NR17 (EPBX)])\n    \t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tSUM([Pausa Ambulat\u00f3rio (EPBX)])\n    \t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tSUM([Pausa P\u00f3s Atendimento (EPBX)])\n    \t\t  \t,[Pausa Lanche (EPBX)]\t\t\t\t=\tSUM([Pausa Lanche (EPBX)])\n    \t\t  \t,[Pausa BackOffice (EPBX)]\t\t\t=\tSUM([Pausa BackOffice (EPBX)])\n    \t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Genesys)])\n    \t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Genesys)])\n    \t\t \t,[Pausa Banheiro (Genesys)]\t\t\t=\tSUM([Pausa Banheiro (Genesys)])\n    \t\t \t,[Pausa Descanso (Genesys)]\t\t\t=\tSUM([Pausa Descanso (Genesys)])\n    \t\t \t,[Pausa Feedback (Genesys)]\t\t\t=\tSUM([Pausa Feedback (Genesys)])\n    \t\t \t,[Pausa Backoffice (Genesys)]\t\t=\tSUM([Pausa Backoffice (Genesys)])\n    \t\t \t,[Pausa Discagem Manual (Genesys)]\t=\tSUM([Pausa Discagem Manual (Genesys)])\n    \t\t \t,[Pausa Discagem Retorno (Genesys)]\t=\tSUM([Pausa Discagem Retorno (Genesys)])\n    \t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tSUM([Pausa Dispon\u00edvel (Genesys)])\n    \t\t \t,[Pausa Em Fila (Genesys)]\t\t\t=\tSUM([Pausa Em Fila (Genesys)])\n    \t\t \t,[Pausa Sistema Externo (Genesys)]\t=\tSUM([Pausa Sistema Externo (Genesys)])\n    \t\t \t,[Pausa Sistema Interno (Genesys)]\t=\tSUM([Pausa Sistema Interno (Genesys)])\n    \t\t \t,[Pausa Tratativa (Genesys)]\t\t=\tSUM([Pausa Tratativa (Genesys)])\n    \t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t=\tSUM([Pausa Whatsapp (Genesys)])\n    \t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tSUM([Pausa Treinamento (Genesys)])\n\n    \t\t\t,[Criados]\t\t\t\t\t\t\t=\tSUM([Criados])\n    \t\t\t,[Tratados]\t\t\t\t\t\t\t=\tSUM([Tratados])\n    \t\t\t,[Tempo Total de Tratativa]\t\t\t=\tSUM([Tempo Total de Tratativa])\n    \t\t\t,[TMT]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n    \t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t=\tSUM([N\u00e3o Resolvidos])\n    \t\t\t,[Replicas]\t\t\t\t\t\t\t=\tSUM([Replicas])\n    \t\t\t,[Reincidentes 48h]\t\t\t\t\t=\tSUM([Reincidentes 48h])\n    \t\t\t,[Reincidentes 30d]\t\t\t\t\t=\tSUM([Reincidentes 30d])\n\n    \t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Iniciadas])\n    \t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas])\n    \t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Em Andamento])\n    \t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Finalizadas])\n    \t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Transferidas])\n    \t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Espera (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Chamada (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM([Inbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Espera (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Inbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Iniciados])\n    \t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Em Andamento])\n    \t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Finalizados])\n    \t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Abandonadas])\n    \t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\n    \t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Iniciadas])\n    \t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas])\n    \t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Em Andamento])\n    \t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Finalizadas])\n    \t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Transferidas])\n    \t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Espera (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM([Outbound - Tempo Em Chamada (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Outbound - Tempo Em Espera (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Iniciados])\n    \t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Em Andamento])\n    \t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Finalizados])\n    \t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Abandonadas])\n    \t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\n    \t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t=\tSUM([Avalia\u00e7\u00f5es de NPS])\n    \t\t\t,[Promotoras]\t\t\t\t\t\t=\tSUM([Promotoras])\n    \t\t\t,[Neutras]\t\t\t\t\t\t\t= \tSUM([Neutras])\n    \t\t\t,[Detratoras]\t\t\t\t\t\t= \tSUM([Detratoras])\n    \t\t\t,[NPS]\t\t\t\t\t\t\t\t=\tCAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n    \t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t= \tIIF(SUM([\u00c9 A Tribo do MOP?])=0,0,1)\n    \t\t\t,[Teve Evento de MOP?]\t\t\t\t= \tIIF(SUM([Teve Evento de MOP?])=0,0,1)\n    \t\t\t,[Teve Evento de Tickets?]\t\t\t= \tIIF(SUM([Teve Evento de Tickets?])=0,0,1)\n    \t\t\t,[Teve Evento de Chamadas?]\t\t\t= \tIIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n    \t\t\t,[Teve Evento de NPS?]\t\t\t\t= \tIIF(SUM([Teve Evento de NPS?])=0,0,1)\n    \t\t\t,[Teve Evento de Log?]\t\t\t\t= \tIIF(SUM([Teve Evento de Log?])=0,0,1)\n\n    \t\tFROM r_individuo_30min\n    \t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n    \t\tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n    \t\tGROUP BY [Data], [ID Selecionar], [Tribo Completa]\n    \t) AS fonte\n    \tON  fonte.[Data]  = destino.[Data]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t= COALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n    \t\t\t [Data]\n    \t\t\t,[Ciclo (Primeiro Dia)]\n    \t\t\t,[M\u00eas (Primeiro Dia)]\n\n                ,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,[ID Selecionar]\n    \t\t\t,[Nome]\n    \t\t\t,[Status]\n    \t\t\t,[Situa\u00e7\u00e3o]\n    \t\t\t,[Condi\u00e7\u00e3o]\n\n    \t\t\t,[DMA Inicial]\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,[\u00daltima DMA Geral]\n    \t\t\t,[Tipo da \u00daltima DMA]\n    \t\t\t,[Instrutor Inicial]\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,[Instrutor \u00daltima DMA]\n\n    \t\t\t,[Cliente]\n    \t\t\t,[Projeto]\n    \t\t\t,[Cargo]\n    \t\t\t,[Tribo]\n    \t\t\t,[Tribo Completa]\n    \t\t\t,[Supervis\u00e3o]\n\t\t\t\t,[Email Supervis\u00e3o]\n\t\t\t\t,[Tempo de Casa (Dias)]\n\t\t\t\t,[Faixa Tempo de Casa]\n\t\t\t\t,[Idade]\n\t\t\t\t,[Faixa de Idade]\n    \t\t\t,[Turno]\n    \t\t\t,[Escala (Ponto)]\n    \t\t\t,[Jornada (Ponto)]\n\t\t\t\t,[Tipo de Jornada (Ponto)]\n\t\t\t\t,[Login (Ponto)]\n\t\t\t\t,[Logout (Ponto)]\n    \t\t\t,[Trabalhado (Ponto)]\n    \t\t\t,[Em Pausa (Ponto)]\n\t\t\t\t,[Desvio Ponto-Log]\n    \t\t\t,[Escala (MOP)]\n    \t\t\t,[Jornada (Log)]\n\t\t\t\t,[Fonte de Log]\n    \t\t\t,[Tipo de Jornada]\n    \t\t\t,[Login]\n    \t\t\t,[Logout]\n    \t\t\t,[Log descartado (>2HE)]\n    \t\t\t,[Log HE]\n    \t\t\t,[Log]\n    \t\t\t,[Log Produtivo]\n    \t\t \t,[Log Improdutivo]\n\t\t\t\t,[Tempo Total (Intelix)]\n\t\t\t\t,[Tempo Total (EPBX)]\n\t\t\t\t,[Tempo Total (Genesys)]\n\t\t\t\t,[Tempo Total (Secullum)]\n    \t\t \t,[Tempo Livre]\n    \t\t \t,[Pausa Particular (Intelix)]\n    \t\t \t,[Pausa Break (Intelix)]\n    \t\t \t,[Pausa 10 (Intelix)]\n    \t\t \t,[Pausa Outbound (Intelix)]\n    \t\t  \t,[Pausa Lanche (Intelix)]\n    \t\t  \t,[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,[Pausa Feedback (Intelix)]\n    \t\t  \t,[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,[Pausa Treinamento (Intelix)]\n    \t\t  \t,[Pausa Banheiro (Intelix)]\n    \t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,[Pausa NR17 (Intelix)]\n    \t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,[Pausa Tratativa (EPBX)]\n    \t\t  \t,[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,[Pausa Banheiro (EPBX)]\n    \t\t  \t,[Pausa WhatsApp (EPBX)]\n    \t\t  \t,[Pausa Intervalo (EPBX)]\n    \t\t  \t,[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,[Pausa Treinamento (EPBX)]\n    \t\t  \t,[Pausa Feedback (EPBX)]\n    \t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,[Pausa Login (EPBX)]\n    \t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,[Pausa NR17 (EPBX)]\n    \t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,[Pausa Lanche (EPBX)]\n    \t\t  \t,[Pausa BackOffice (EPBX)]\n    \t\t\t,[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t \t,[Pausa Banheiro (Genesys)]\n    \t\t \t,[Pausa Descanso (Genesys)]\n    \t\t \t,[Pausa Feedback (Genesys)]\n    \t\t \t,[Pausa Backoffice (Genesys)]\n    \t\t \t,[Pausa Discagem Manual (Genesys)]\n    \t\t \t,[Pausa Discagem Retorno (Genesys)]\n    \t\t \t,[Pausa Dispon\u00edvel (Genesys)]\n    \t\t \t,[Pausa Em Fila (Genesys)]\n    \t\t \t,[Pausa Sistema Externo (Genesys)]\n    \t\t \t,[Pausa Sistema Interno (Genesys)]\n    \t\t \t,[Pausa Tratativa (Genesys)]\n    \t\t \t,[Pausa Whatsapp (Genesys)]\n    \t\t\t,[Pausa Treinamento (Genesys)]\n\n    \t\t\t,[Criados]\n    \t\t\t,[Tratados]\n    \t\t\t,[Tempo Total de Tratativa]\n    \t\t\t,[TMT]\n    \t\t\t,[N\u00e3o Resolvidos]\n    \t\t\t,[Replicas]\n    \t\t\t,[Reincidentes 48h]\n    \t\t\t,[Reincidentes 30d]\n\n    \t\t,[Inbound - Chamadas Iniciadas]\n    \t\t,[Inbound - Chamadas Atendidas]\n    \t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,[Inbound - Chamadas Em Andamento]\n    \t\t,[Inbound - Chamadas Finalizadas]\n    \t\t,[Inbound - Chamadas Transferidas]\n    \t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,[Inbound - Atendimentos Iniciados]\n    \t\t,[Inbound - Atendimentos Em Andamento]\n    \t\t,[Inbound - Atendimentos Finalizados]\n    \t\t,[Inbound - TMC]\n    \t\t,[Inbound - TMA]\n    \t\t,[Inbound - TME]\n    \t\t,[Inbound - TMO]\n    \t\t,[Inbound - % Nivel de Servi\u00e7o]\n    \t\t,[Inbound - Chamadas Abandonadas]\n    \t\t,[Inbound - % Abandono]\n\n    \t\t,[Outbound - Chamadas Iniciadas]\n    \t\t,[Outbound - Chamadas Atendidas]\n    \t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,[Outbound - Chamadas Em Andamento]\n    \t\t,[Outbound - Chamadas Finalizadas]\n    \t\t,[Outbound - Chamadas Transferidas]\n    \t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,[Outbound - Atendimentos Iniciados]\n    \t\t,[Outbound - Atendimentos Em Andamento]\n    \t\t,[Outbound - Atendimentos Finalizados]\n    \t\t,[Outbound - TMC]\n    \t\t,[Outbound - TMA]\n    \t\t,[Outbound - TME]\n    \t\t,[Outbound - TMO]\n    \t\t,[Outbound - % Nivel de Servi\u00e7o]\n    \t\t,[Outbound - Chamadas Abandonadas]\n    \t\t,[Outbound - % Abandono]\n\n\n    \t\t\t,[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t,[Promotoras]\n    \t\t\t,[Neutras]\n    \t\t\t,[Detratoras]\n    \t\t\t,[NPS]\n\n    \t\t\t,[\u00c9 A Tribo do MOP?]\n    \t\t\t,[Teve Evento de MOP?]\n    \t\t\t,[Teve Evento de Tickets?]\n    \t\t\t,[Teve Evento de Chamadas?]\n    \t\t\t,[Teve Evento de NPS?]\n    \t\t\t,[Teve Evento de Log?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n    \t\t     fonte.[Data]\n    \t\t\t,fonte.[Ciclo (Primeiro Dia)]\n    \t\t\t,fonte.[M\u00eas (Primeiro Dia)]\n\n                ,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n    \t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,fonte.[ID Selecionar]\n    \t\t\t,fonte.[Nome]\n    \t\t\t,fonte.[Status]\n    \t\t\t,fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,fonte.[Condi\u00e7\u00e3o]\n\n    \t\t\t,fonte.[DMA Inicial]\n    \t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[\u00daltima DMA Geral]\n    \t\t\t,fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,fonte.[Instrutor Inicial]\n    \t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[Instrutor \u00daltima DMA]\n\n    \t\t\t,fonte.[Cliente]\n    \t\t\t,fonte.[Projeto]\n    \t\t\t,fonte.[Cargo]\n    \t\t\t,fonte.[Tribo]\n    \t\t\t,fonte.[Tribo Completa]\n    \t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t\t,fonte.[Email Supervis\u00e3o]\n\t\t\t\t,fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,fonte.[Faixa Tempo de Casa]\n\t\t\t\t,fonte.[Idade]\n\t\t\t\t,fonte.[Faixa de Idade]\n    \t\t\t,fonte.[Turno]\n    \t\t\t,fonte.[Escala (Ponto)]\n    \t\t\t,fonte.[Jornada (Ponto)]\n\t\t\t\t,fonte.[Tipo de Jornada (Ponto)]\n\t\t\t\t,fonte.[Login (Ponto)]\n\t\t\t\t,fonte.[Logout (Ponto)]\n    \t\t\t,fonte.[Trabalhado (Ponto)]\n    \t\t\t,fonte.[Em Pausa (Ponto)]\n\t\t\t\t,fonte.[Desvio Ponto-Log]\n    \t\t\t,fonte.[Escala (MOP)]\n    \t\t\t,fonte.[Jornada (Log)]\n\t\t\t\t,fonte.[Fonte de Log]\n    \t\t\t,fonte.[Tipo de Jornada]\n    \t\t\t,fonte.[Login]\n    \t\t\t,fonte.[Logout]\n    \t\t\t,fonte.[Log descartado (>2HE)]\n    \t\t\t,fonte.[Log HE]\n    \t\t\t,fonte.[Log]\n    \t\t\t,fonte.[Log Produtivo]\n    \t\t \t,fonte.[Log Improdutivo]\n\t\t\t\t,fonte.[Tempo Total (Intelix)]\n\t\t\t\t,fonte.[Tempo Total (EPBX)]\n\t\t\t\t,fonte.[Tempo Total (Genesys)]\n\t\t\t\t,fonte.[Tempo Total (Secullum)]\n    \t\t \t,fonte.[Tempo Livre]\n    \t\t \t,fonte.[Pausa Particular (Intelix)]\n    \t\t \t,fonte.[Pausa Break (Intelix)]\n    \t\t \t,fonte.[Pausa 10 (Intelix)]\n    \t\t \t,fonte.[Pausa Outbound (Intelix)]\n    \t\t  \t,fonte.[Pausa Lanche (Intelix)]\n    \t\t  \t,fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,fonte.[Pausa Feedback (Intelix)]\n    \t\t  \t,fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,fonte.[Pausa Treinamento (Intelix)]\n    \t\t  \t,fonte.[Pausa Banheiro (Intelix)]\n    \t\t  \t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,fonte.[Pausa NR17 (Intelix)]\n    \t\t  \t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,fonte.[Pausa Tratativa (EPBX)]\n    \t\t  \t,fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,fonte.[Pausa Banheiro (EPBX)]\n    \t\t  \t,fonte.[Pausa WhatsApp (EPBX)]\n    \t\t  \t,fonte.[Pausa Intervalo (EPBX)]\n    \t\t  \t,fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,fonte.[Pausa Treinamento (EPBX)]\n    \t\t  \t,fonte.[Pausa Feedback (EPBX)]\n    \t\t  \t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,fonte.[Pausa Login (EPBX)]\n    \t\t  \t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,fonte.[Pausa NR17 (EPBX)]\n    \t\t  \t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,fonte.[Pausa Lanche (EPBX)]\n    \t\t  \t,fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t \t,fonte.[Pausa Banheiro (Genesys)]\n    \t\t \t,fonte.[Pausa Descanso (Genesys)]\n    \t\t \t,fonte.[Pausa Feedback (Genesys)]\n    \t\t \t,fonte.[Pausa Backoffice (Genesys)]\n    \t\t \t,fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t \t,fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t \t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t \t,fonte.[Pausa Em Fila (Genesys)]\n    \t\t \t,fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t \t,fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t \t,fonte.[Pausa Tratativa (Genesys)]\n    \t\t \t,fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t,fonte.[Pausa Treinamento (Genesys)]\n\n    \t\t\t,fonte.[Criados]\n    \t\t\t,fonte.[Tratados]\n    \t\t\t,fonte.[Tempo Total de Tratativa]\n    \t\t\t,fonte.[TMT]\n    \t\t\t,fonte.[N\u00e3o Resolvidos]\n    \t\t\t,fonte.[Replicas]\n    \t\t\t,fonte.[Reincidentes 48h]\n    \t\t\t,fonte.[Reincidentes 30d]\n\n    \t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n    \t\t    ,fonte.[Inbound - Chamadas Atendidas]\n    \t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n    \t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n    \t\t    ,fonte.[Inbound - Chamadas Transferidas]\n    \t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n    \t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n    \t\t    ,fonte.[Inbound - TMC]\n    \t\t    ,fonte.[Inbound - TMA]\n    \t\t    ,fonte.[Inbound - TME]\n    \t\t    ,fonte.[Inbound - TMO]\n    \t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n    \t\t    ,fonte.[Inbound - % Abandono]\n\n    \t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n    \t\t    ,fonte.[Outbound - Chamadas Atendidas]\n    \t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n    \t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n    \t\t    ,fonte.[Outbound - Chamadas Transferidas]\n    \t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n    \t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n    \t\t    ,fonte.[Outbound - TMC]\n    \t\t    ,fonte.[Outbound - TMA]\n    \t\t    ,fonte.[Outbound - TME]\n    \t\t    ,fonte.[Outbound - TMO]\n    \t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n    \t\t    ,fonte.[Outbound - % Abandono]\n\n    \t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t    ,fonte.[Promotoras]\n    \t\t    ,fonte.[Neutras]\n    \t\t    ,fonte.[Detratoras]\n    \t\t    ,fonte.[NPS]\n\n    \t\t    ,fonte.[\u00c9 A Tribo do MOP?]\n    \t\t    ,fonte.[Teve Evento de MOP?]\n    \t\t    ,fonte.[Teve Evento de Tickets?]\n    \t\t    ,fonte.[Teve Evento de Chamadas?]\n    \t\t    ,fonte.[Teve Evento de NPS?]\n    \t\t    ,fonte.[Teve Evento de Log?]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Data]\t\t\t\t\t\t\t\t= fonte.[Data]\n    \t\t\t,destino.[Ciclo (Primeiro Dia)]\t\t\t\t= fonte.[Ciclo (Primeiro Dia)]\n    \t\t\t,destino.[M\u00eas (Primeiro Dia)]\t\t\t\t= fonte.[M\u00eas (Primeiro Dia)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n    \t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t= fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,destino.[ID Selecionar]\t\t\t\t\t= fonte.[ID Selecionar]\n    \t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t= fonte.[Nome]\n    \t\t\t,destino.[Status]\t\t\t\t\t\t\t= fonte.[Status]\n    \t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Condi\u00e7\u00e3o]\n\n    \t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t= fonte.[DMA Inicial]\n    \t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t= fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t= fonte.[\u00daltima DMA Geral]\n    \t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t= fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,destino.[Instrutor Inicial]\t\t\t\t= fonte.[Instrutor Inicial]\n    \t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t= fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t= fonte.[Instrutor \u00daltima DMA]\n\n    \t\t\t,destino.[Cliente]\t\t\t\t\t\t\t= fonte.[Cliente]\n    \t\t\t,destino.[Projeto]\t\t\t\t\t\t\t= fonte.[Projeto]\n    \t\t\t,destino.[Cargo]\t\t\t\t\t\t\t= fonte.[Cargo]\n    \t\t\t,destino.[Tribo]\t\t\t\t\t\t\t= fonte.[Tribo]\n    \t\t\t,destino.[Tribo Completa]\t\t\t\t\t= fonte.[Tribo Completa]\n    \t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t= fonte.[Supervis\u00e3o]\n\t\t\t\t,destino.[Email Supervis\u00e3o]\t\t\t\t\t= fonte.[Email Supervis\u00e3o]\n\t\t\t\t,destino.[Tempo de Casa (Dias)]\t\t\t\t= fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,destino.[Faixa Tempo de Casa]\t\t\t\t= fonte.[Faixa Tempo de Casa]\n\t\t\t\t,destino.[Idade]\t\t\t\t\t\t\t= fonte.[Idade]\n\t\t\t\t,destino.[Faixa de Idade]\t\t\t\t\t= fonte.[Faixa de Idade]\n    \t\t\t,destino.[Turno]\t\t\t\t\t\t\t= fonte.[Turno]\n    \t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t= fonte.[Escala (Ponto)]\n    \t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t= fonte.[Jornada (Ponto)]\n\t\t\t\t,destino.[Tipo de Jornada (Ponto)]\t\t\t= fonte.[Tipo de Jornada (Ponto)]\n\t\t\t\t,destino.[Login (Ponto)]\t\t\t\t\t= fonte.[Login (Ponto)]\n\t\t\t\t,destino.[Logout (Ponto)]\t\t\t\t\t= fonte.[Logout (Ponto)]\n    \t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t= fonte.[Trabalhado (Ponto)]\n    \t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t= fonte.[Em Pausa (Ponto)]\n\t\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t= fonte.[Desvio Ponto-Log]\n    \t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t= fonte.[Escala (MOP)]\n    \t\t\t,destino.[Jornada (Log)]\t\t\t\t\t= fonte.[Jornada (Log)]\n\t\t\t\t,destino.[Fonte de Log]\t\t\t\t\t\t= fonte.[Fonte de Log]\n    \t\t\t,destino.[Tipo de Jornada]\t\t\t\t\t= fonte.[Tipo de Jornada]\n    \t\t\t,destino.[Login]\t\t\t\t\t\t\t= fonte.[Login]\n    \t\t\t,destino.[Logout]\t\t\t\t\t\t\t= fonte.[Logout]\n    \t\t\t,destino.[Log descartado (>2HE)]\t\t\t= fonte.[Log descartado (>2HE)]\n    \t\t\t,destino.[Log HE]\t\t\t\t\t\t\t= fonte.[Log HE]\n    \t\t\t,destino.[Log]\t\t\t\t\t\t\t\t= fonte.[Log]\n    \t\t\t,destino.[Log Produtivo]\t\t\t\t\t= fonte.[Log Produtivo]\n    \t\t \t,destino.[Log Improdutivo]\t\t\t\t\t= fonte.[Log Improdutivo]\n\t\t\t\t,destino.[Tempo Total (Intelix)]\t\t\t= fonte.[Tempo Total (Intelix)]\n\t\t\t\t,destino.[Tempo Total (EPBX)]\t\t\t\t= fonte.[Tempo Total (EPBX)]\n\t\t\t\t,destino.[Tempo Total (Genesys)]\t\t\t= fonte.[Tempo Total (Genesys)]\n\t\t\t\t,destino.[Tempo Total (Secullum)]\t\t\t= fonte.[Tempo Total (Secullum)]\n    \t\t \t,destino.[Tempo Livre]\t\t\t\t\t\t= fonte.[Tempo Livre]\n    \t\t \t,destino.[Pausa Particular (Intelix)]\t\t= fonte.[Pausa Particular (Intelix)]\n    \t\t \t,destino.[Pausa Break (Intelix)]\t\t\t= fonte.[Pausa Break (Intelix)]\n    \t\t \t,destino.[Pausa 10 (Intelix)]\t\t\t\t= fonte.[Pausa 10 (Intelix)]\n    \t\t \t,destino.[Pausa Outbound (Intelix)]\t\t\t= fonte.[Pausa Outbound (Intelix)]\n    \t\t  \t,destino.[Pausa Lanche (Intelix)]\t\t\t= fonte.[Pausa Lanche (Intelix)]\n    \t\t  \t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t= fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t= fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,destino.[Pausa Feedback (Intelix)]\t\t\t= fonte.[Pausa Feedback (Intelix)]\n    \t\t  \t,destino.[Pausa Sistema Interno (Intelix)]\t= fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,destino.[Pausa Sistema Externo (Intelix)]\t= fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,destino.[Pausa Treinamento (Intelix)]\t\t= fonte.[Pausa Treinamento (Intelix)]\n    \t\t  \t,destino.[Pausa Banheiro (Intelix)]\t\t\t= fonte.[Pausa Banheiro (Intelix)]\n    \t\t  \t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t= fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,destino.[Pausa NR17 (Intelix)]\t\t\t\t= fonte.[Pausa NR17 (Intelix)]\n    \t\t  \t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t= fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,destino.[Pausa Tratativa (EPBX)]\t\t\t= fonte.[Pausa Tratativa (EPBX)]\n    \t\t  \t,destino.[Pausa Discagem Manual (EPBX)]\t\t= fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,destino.[Pausa Banheiro (EPBX)]\t\t\t= fonte.[Pausa Banheiro (EPBX)]\n    \t\t  \t,destino.[Pausa WhatsApp (EPBX)]\t\t\t= fonte.[Pausa WhatsApp (EPBX)]\n    \t\t  \t,destino.[Pausa Intervalo (EPBX)]\t\t\t= fonte.[Pausa Intervalo (EPBX)]\n    \t\t  \t,destino.[Pausa Discagem Retorno (EPBX)]\t= fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,destino.[Pausa Treinamento (EPBX)]\t\t\t= fonte.[Pausa Treinamento (EPBX)]\n    \t\t  \t,destino.[Pausa Feedback (EPBX)]\t\t\t= fonte.[Pausa Feedback (EPBX)]\n    \t\t  \t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t= fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t= fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,destino.[Pausa Login (EPBX)]\t\t\t\t= fonte.[Pausa Login (EPBX)]\n    \t\t  \t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,destino.[Pausa Sistema Interno (EPBX)]\t\t= fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,destino.[Pausa Sistema Externo (EPBX)]\t\t= fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,destino.[Pausa NR17 (EPBX)]\t\t\t\t= fonte.[Pausa NR17 (EPBX)]\n    \t\t  \t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t= fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t= fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,destino.[Pausa Lanche (EPBX)]\t\t\t\t= fonte.[Pausa Lanche (EPBX)]\n    \t\t  \t,destino.[Pausa BackOffice (EPBX)]\t\t\t= fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t= fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t= fonte.[Pausa Banheiro (Genesys)]\n    \t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t= fonte.[Pausa Descanso (Genesys)]\n    \t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t= fonte.[Pausa Feedback (Genesys)]\n    \t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t= fonte.[Pausa Backoffice (Genesys)]\n    \t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t= fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t= fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t= fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t= fonte.[Pausa Em Fila (Genesys)]\n    \t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t= fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t= fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t= fonte.[Pausa Tratativa (Genesys)]\n    \t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t= fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t= fonte.[Pausa Treinamento (Genesys)]\n\n    \t\t\t,destino.[Criados]\t\t\t\t\t\t\t= fonte.[Criados]\n    \t\t\t,destino.[Tratados]\t\t\t\t\t\t\t= fonte.[Tratados]\n    \t\t\t,destino.[Tempo Total de Tratativa]\t\t\t= fonte.[Tempo Total de Tratativa]\n    \t\t\t,destino.[TMT]\t\t\t\t\t\t\t\t= fonte.[TMT]\n    \t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t\t\t= fonte.[N\u00e3o Resolvidos]\n    \t\t\t,destino.[Replicas]\t\t\t\t\t\t\t= fonte.[Replicas]\n    \t\t\t,destino.[Reincidentes 48h]\t\t\t\t\t= fonte.[Reincidentes 48h]\n    \t\t\t,destino.[Reincidentes 30d]\t\t\t\t\t= fonte.[Reincidentes 30d]\n\n    \t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Transferidas]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMC]\n    \t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMA]\n    \t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TME]\n    \t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMO]\n    \t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Abandono]\n\n    \t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Transferidas]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMC]\n    \t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMA]\n    \t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TME]\n    \t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMO]\n    \t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - % Abandono]\n\n\n    \t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t= fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t,destino.[Promotoras]\t\t\t\t\t\t= fonte.[Promotoras]\n    \t\t\t,destino.[Neutras]\t\t\t\t\t\t\t= fonte.[Neutras]\n    \t\t\t,destino.[Detratoras]\t\t\t\t\t\t= fonte.[Detratoras]\n    \t\t\t,destino.[NPS]\t\t\t\t\t\t\t\t= fonte.[NPS]\n\n    \t\t\t,destino.[\u00c9 A Tribo do MOP?]\t\t\t\t= fonte.[\u00c9 A Tribo do MOP?]\n    \t\t\t,destino.[Teve Evento de MOP?]\t\t\t\t= fonte.[Teve Evento de MOP?]\n    \t\t\t,destino.[Teve Evento de Tickets?]\t\t\t= fonte.[Teve Evento de Tickets?]\n    \t\t\t,destino.[Teve Evento de Chamadas?]\t\t\t= fonte.[Teve Evento de Chamadas?]\n    \t\t\t,destino.[Teve Evento de NPS?]\t\t\t\t= fonte.[Teve Evento de NPS?]\n    \t\t\t,destino.[Teve Evento de Log?]\t\t\t\t= fonte.[Teve Evento de Log?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_individuo_dia\n        WHERE [Data] >= CAST(GETDATE() AS DATE)\n\t\t\tOR(\t[\u00c9 A Tribo do MOP?]\t\t    = 0\n    \t    AND\t[Teve Evento de MOP?]\t    = 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0)\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n    IF 1=1 BEGIN; PRINT '--- agrupamento individuo_m\u00eas';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_m\u00eas]\n    \t\tWHERE [M\u00eas (Primeiro Dia)] >= DATEFROMPARTS(YEAR(@datahora_inicio ),MONTH(@datahora_inicio) ,1)\n    \t\tAND\t  [M\u00eas (Primeiro Dia)] <= DATEFROMPARTS(YEAR(@datahora_fim ),MONTH(@datahora_fim) ,1)\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT\n    \t\t\t [M\u00eas (Primeiro Dia)]\t\t\t\t=\t[M\u00eas (Primeiro Dia)]\n\n\n                --,[Feriado (Nome)]                                     =  SUM([Feriado (Nome)])\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(SUM([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(SUM([Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t        ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(SUM([Secullum - Servi\u00e7o Militar]                                   ),0)\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(SUM([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t        ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t        ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(SUM([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t        ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(SUM([Secullum - Licen\u00e7a Casamento]                                 ),0)\n                ,[Secullum - INSS - Afastamento]                                    =   ISNULL(SUM([Secullum - INSS - Afastamento]                                ),0)\n                ,[Secullum - Folga]                                                 =   ISNULL(SUM([Secullum - Folga]                                             ),0)\n                ,[Secullum - F\u00e9rias]                                                =   ISNULL(SUM([Secullum - F\u00e9rias]                                            ),0)\n       \t        ,[Secullum - Feriado]                                               =   ISNULL(SUM([Secullum - Feriado]                                           ),0)\n       \t        ,[Secullum - Falta Justificada]                                     =   ISNULL(SUM([Secullum - Falta Justificada]                                 ),0)\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(SUM([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                ,[Secullum - Falta Injustificada]                                   =   ISNULL(SUM([Secullum - Falta Injustificada]                               ),0)\n       \t        ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(SUM([Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(SUM([Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                ,[Secullum - Desligue]                                              =   ISNULL(SUM([Secullum - Desligue]                                          ),0)\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(SUM([Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t        ,[Secullum - Compensando Horas]                                     =   ISNULL(SUM([Secullum - Compensando Horas]                                 ),0)\n       \t        ,[Secullum - Atestado]                                              =   ISNULL(SUM([Secullum - Atestado]                                          ),0)\n                ,[Secullum - Abono]                                                 =   ISNULL(SUM([Secullum - Abono]                                             ),0)\n       \t        ,[Secullum - Abono Lactante]                                        =   ISNULL(SUM([Secullum - Abono Lactante]                                    ),0)\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(SUM([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t        ,[Faltas Justificadas]                                              =   ISNULL(SUM([Faltas Justificadas]                                          ),0)\n       \t        ,[Faltas Injustificadas]                                            =   ISNULL(SUM([Faltas Injustificadas]                                        ),0)\n\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tMAX([DataHora da Atualiza\u00e7\u00e3o do MOP])\n    \t\t\t,[ID Selecionar]\t\t\t\t\t=\t[ID Selecionar]\n    \t\t\t,[Nome]\t\t\t\t\t\t\t\t=   MIN([ult_Nome])\n    \t\t\t,[Status]\t\t\t\t\t\t\t=\tMIN([ult_Status])\n    \t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([ult_Situa\u00e7\u00e3o])\n    \t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([ult_Condi\u00e7\u00e3o])\n\n    \t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tMIN([ult_DMA Inicial])\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tMIN([ult_\u00daltima DMA Migra\u00e7\u00e3o])\n    \t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tMIN([ult_\u00daltima DMA Geral])\n    \t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tMIN([ult_Tipo da \u00daltima DMA])\n    \t\t\t,[Instrutor Inicial]\t\t\t\t=\tMIN([ult_Instrutor Inicial])\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tMIN([ult_Instrutor \u00daltima Migra\u00e7\u00e3o])\n    \t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tMIN([ult_Instrutor \u00daltima DMA])\n\n    \t\t\t,[Cliente]\t\t\t\t\t\t\t=\tMIN([Cliente])\n    \t\t\t,[Projeto]\t\t\t\t\t\t\t=\tMIN([Projeto])\n    \t\t\t,[Cargo]\t\t\t\t\t\t\t=\tMIN([ult_Cargo])\n    \t\t\t,[Tribo]\t\t\t\t\t\t\t=\tMIN([Tribo])\n    \t\t\t,[Tribo Completa]\t\t\t\t\t=\tMIN([Tribo Completa])\n    \t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tMIN([ult_Supervis\u00e3o])\n\t\t\t\t,[Email Supervis\u00e3o]\t\t\t\t\t=\tMIN([ult_Email Supervis\u00e3o])\n\t\t\t\t,[Tempo de Casa (Dias)]\t\t\t\t=\tMIN([ult_Tempo de Casa (Dias)])\n\t\t\t\t,[Faixa Tempo de Casa]\t\t\t\t=\tMIN([ult_Faixa Tempo de Casa])\n\t\t\t\t,[Idade]\t\t\t\t\t\t\t=\tMIN([ult_Idade])\n\t\t\t\t,[Faixa de Idade]\t\t\t\t\t=\tMIN([ult_Faixa de Idade])\n    \t\t\t,[Turno]\t\t\t\t\t\t\t=\tMIN([ult_Turno])\n\n    \t\t\t,[Escala (Ponto)]\t\t\t\t\t=\tMIN([ult_Escala (Ponto)])\n    \t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tMIN([ult_Jornada (Ponto)])\n    \t\t\t,[Trabalhado (Ponto)]\t\t\t\t=\tSUM([Trabalhado (Ponto)])\n    \t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=\tSUM([Em Pausa (Ponto)])\n\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t=\tSUM([Desvio Ponto-Log])\n    \t\t\t,[Escala (MOP)]\t\t\t\t\t\t=\tMIN([ult_Escala (MOP)])\n    \t\t\t,[Jornada (Log)]\t\t\t\t\t=\tMIN([ult_Jornada (Log)])\n\t\t\t\t,[Fonte de Log]\t\t\t\t\t\t=\tMIN([ult_Fonte de Log])\n\n    \t\t\t,[Log descartado (>2HE)]\t\t\t=\tSUM([Log descartado (>2HE)])\n    \t\t\t,[Log HE]\t\t\t\t\t\t\t=\tSUM([Log HE])\n    \t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM([Log])\n    \t\t\t,[Log Produtivo]\t\t\t\t\t=\tSUM([Log Produtivo])\n    \t\t \t,[Log Improdutivo]\t\t\t\t\t=\tSUM([Log Improdutivo])\n\t\t\t\t,[Tempo Total (Intelix)]\t\t\t=\tSUM([Tempo Total (Intelix)])\n\t\t\t\t,[Tempo Total (EPBX)]\t\t\t\t=\tSUM([Tempo Total (EPBX)])\n\t\t\t\t,[Tempo Total (Genesys)]\t\t\t=\tSUM([Tempo Total (Genesys)])\n\t\t\t\t,[Tempo Total (Secullum)]\t\t\t=\tSUM([Tempo Total (Secullum)])\n    \t\t \t,[Tempo Livre]\t\t\t\t\t\t=\tSUM([Tempo Livre])\n    \t\t \t,[Pausa Particular (Intelix)]\t\t=\tSUM([Pausa Particular (Intelix)])\n    \t\t \t,[Pausa Break (Intelix)]\t\t\t=\tSUM([Pausa Break (Intelix)])\n    \t\t \t,[Pausa 10 (Intelix)]\t\t\t\t=\tSUM([Pausa 10 (Intelix)])\n    \t\t \t,[Pausa Outbound (Intelix)]\t\t\t=\tSUM([Pausa Outbound (Intelix)])\n    \t\t  \t,[Pausa Lanche (Intelix)]\t\t\t=\tSUM([Pausa Lanche (Intelix)])\n    \t\t  \t,[Pausa R\u00e1pida (Intelix)]\t\t\t=\tSUM([Pausa R\u00e1pida (Intelix)])\n    \t\t  \t,[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Intelix)])\n    \t\t  \t,[Pausa Feedback (Intelix)]\t\t\t=\tSUM([Pausa Feedback (Intelix)])\n    \t\t  \t,[Pausa Sistema Interno (Intelix)]\t=\tSUM([Pausa Sistema Interno (Intelix)])\n    \t\t  \t,[Pausa Sistema Externo (Intelix)]\t=\tSUM([Pausa Sistema Externo (Intelix)])\n    \t\t  \t,[Pausa Treinamento (Intelix)]\t\t=\tSUM([Pausa Treinamento (Intelix)])\n    \t\t  \t,[Pausa Banheiro (Intelix)]\t\t\t=\tSUM([Pausa Banheiro (Intelix)])\n    \t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tSUM([Pausa Reuni\u00e3o (Intelix)])\n    \t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Intelix)])\n    \t\t  \t,[Pausa NR17 (Intelix)]\t\t\t\t=\tSUM([Pausa NR17 (Intelix)])\n    \t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Liga\u00e7\u00e3o (EPBX)])\n    \t\t  \t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tSUM([Pausa Almo\u00e7o (EPBX)])\n    \t\t  \t,[Pausa Tratativa (EPBX)]\t\t\t=\tSUM([Pausa Tratativa (EPBX)])\n    \t\t  \t,[Pausa Discagem Manual (EPBX)]\t\t=\tSUM([Pausa Discagem Manual (EPBX)])\n    \t\t  \t,[Pausa Banheiro (EPBX)]\t\t\t=\tSUM([Pausa Banheiro (EPBX)])\n    \t\t  \t,[Pausa WhatsApp (EPBX)]\t\t\t=\tSUM([Pausa WhatsApp (EPBX)])\n    \t\t  \t,[Pausa Intervalo (EPBX)]\t\t\t=\tSUM([Pausa Intervalo (EPBX)])\n    \t\t  \t,[Pausa Discagem Retorno (EPBX)]\t=\tSUM([Pausa Discagem Retorno (EPBX)])\n    \t\t  \t,[Pausa Treinamento (EPBX)]\t\t\t=\tSUM([Pausa Treinamento (EPBX)])\n    \t\t  \t,[Pausa Feedback (EPBX)]\t\t\t=\tSUM([Pausa Feedback (EPBX)])\n    \t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\t\t=\tSUM([Pausa Transfer\u00eancia (EPBX)])\n    \t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tSUM([Pausa N\u00e3o Disponivel (EPBX)])\n    \t\t  \t,[Pausa Login (EPBX)]\t\t\t\t=\tSUM([Pausa Login (EPBX)])\n    \t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Reuni\u00e3o (EPBX)])\n    \t\t  \t,[Pausa Sistema Interno (EPBX)]\t\t=\tSUM([Pausa Sistema Interno (EPBX)])\n    \t\t  \t,[Pausa Sistema Externo (EPBX)]\t\t=\tSUM([Pausa Sistema Externo (EPBX)])\n    \t\t  \t,[Pausa NR17 (EPBX)]\t\t\t\t=\tSUM([Pausa NR17 (EPBX)])\n    \t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tSUM([Pausa Ambulat\u00f3rio (EPBX)])\n    \t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tSUM([Pausa P\u00f3s Atendimento (EPBX)])\n    \t\t  \t,[Pausa Lanche (EPBX)]\t\t\t\t=\tSUM([Pausa Lanche (EPBX)])\n    \t\t  \t,[Pausa BackOffice (EPBX)]\t\t\t=\tSUM([Pausa BackOffice (EPBX)])\n    \t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Genesys)])\n    \t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Genesys)])\n    \t\t \t,[Pausa Banheiro (Genesys)]\t\t\t=\tSUM([Pausa Banheiro (Genesys)])\n    \t\t \t,[Pausa Descanso (Genesys)]\t\t\t=\tSUM([Pausa Descanso (Genesys)])\n    \t\t \t,[Pausa Feedback (Genesys)]\t\t\t=\tSUM([Pausa Feedback (Genesys)])\n    \t\t \t,[Pausa Backoffice (Genesys)]\t\t=\tSUM([Pausa Backoffice (Genesys)])\n    \t\t \t,[Pausa Discagem Manual (Genesys)]\t=\tSUM([Pausa Discagem Manual (Genesys)])\n    \t\t \t,[Pausa Discagem Retorno (Genesys)]\t=\tSUM([Pausa Discagem Retorno (Genesys)])\n    \t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tSUM([Pausa Dispon\u00edvel (Genesys)])\n    \t\t \t,[Pausa Em Fila (Genesys)]\t\t\t=\tSUM([Pausa Em Fila (Genesys)])\n    \t\t \t,[Pausa Sistema Externo (Genesys)]\t=\tSUM([Pausa Sistema Externo (Genesys)])\n    \t\t \t,[Pausa Sistema Interno (Genesys)]\t=\tSUM([Pausa Sistema Interno (Genesys)])\n    \t\t \t,[Pausa Tratativa (Genesys)]\t\t=\tSUM([Pausa Tratativa (Genesys)])\n    \t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t=\tSUM([Pausa Whatsapp (Genesys)])\n    \t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tSUM([Pausa Treinamento (Genesys)])\n\n    \t\t\t,[Criados]\t\t\t\t\t\t\t=\tSUM([Criados])\n    \t\t\t,[Tratados]\t\t\t\t\t\t\t=\tSUM([Tratados])\n    \t\t\t,[Tempo Total de Tratativa]\t\t\t=\tSUM([Tempo Total de Tratativa])\n    \t\t\t,[TMT]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n    \t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t=\tSUM([N\u00e3o Resolvidos])\n    \t\t\t,[Replicas]\t\t\t\t\t\t\t=\tSUM([Replicas])\n    \t\t\t,[Reincidentes 48h]\t\t\t\t\t=\tSUM([Reincidentes 48h])\n    \t\t\t,[Reincidentes 30d]\t\t\t\t\t=\tSUM([Reincidentes 30d])\n\n    \t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Iniciadas])\n    \t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas])\n    \t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Em Andamento])\n    \t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Finalizadas])\n    \t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Transferidas])\n    \t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Espera (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Chamada (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM([Inbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Espera (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Inbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Iniciados])\n    \t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Em Andamento])\n    \t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Finalizados])\n    \t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Abandonadas])\n    \t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\n    \t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Iniciadas])\n    \t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas])\n    \t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Em Andamento])\n    \t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Finalizadas])\n    \t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Transferidas])\n    \t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Espera (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM([Outbound - Tempo Em Chamada (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Outbound - Tempo Em Espera (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Iniciados])\n    \t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Em Andamento])\n    \t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Finalizados])\n    \t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas])AS DECIMAL),0),0)\n    \t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Abandonadas])\n    \t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n    \t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t=\tSUM([Avalia\u00e7\u00f5es de NPS])\n    \t\t\t,[Promotoras]\t\t\t\t\t\t=\tSUM([Promotoras])\n    \t\t\t,[Neutras]\t\t\t\t\t\t\t= \tSUM([Neutras])\n    \t\t\t,[Detratoras]\t\t\t\t\t\t= \tSUM([Detratoras])\n    \t\t\t,[NPS]\t\t\t\t\t\t\t\t=\tCAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n    \t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t= \tIIF(SUM([\u00c9 A Tribo do MOP?])=0,0,1)\n    \t\t\t,[Teve Evento de MOP?]\t\t\t\t= \tIIF(SUM([Teve Evento de MOP?])=0,0,1)\n    \t\t\t,[Teve Evento de Tickets?]\t\t\t= \tIIF(SUM([Teve Evento de Tickets?])=0,0,1)\n    \t\t\t,[Teve Evento de Chamadas?]\t\t\t= \tIIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n    \t\t\t,[Teve Evento de NPS?]\t\t\t\t= \tIIF(SUM([Teve Evento de NPS?])=0,0,1)\n    \t\t\t,[Teve Evento de Log?]\t\t\t\t= \tIIF(SUM([Teve Evento de Log?])=0,0,1)\n\n    \t\tFROM (\n                SELECT *\n    \t\t\t    ,[ult_Nome]\t\t\t\t\t\t\t=   FIRST_VALUE([Nome])                         OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Status]\t\t\t\t\t\t=\tFIRST_VALUE([Status])                       OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Situa\u00e7\u00e3o]\t\t\t\t\t\t=\tFIRST_VALUE([Situa\u00e7\u00e3o])                     OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Condi\u00e7\u00e3o]\t\t\t\t\t\t=\tFIRST_VALUE([Condi\u00e7\u00e3o])                     OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_DMA Inicial]\t\t\t\t\t=\tFIRST_VALUE([DMA Inicial])                  OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t=\tFIRST_VALUE([\u00daltima DMA Migra\u00e7\u00e3o])          OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_\u00daltima DMA Geral]\t\t\t\t=\tFIRST_VALUE([\u00daltima DMA Geral])             OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Tipo da \u00daltima DMA]\t\t\t=\tFIRST_VALUE([Tipo da \u00daltima DMA])           OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Instrutor Inicial]\t\t\t=\tFIRST_VALUE([Instrutor Inicial])            OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Instrutor \u00daltima Migra\u00e7\u00e3o]\t=\tFIRST_VALUE([Instrutor \u00daltima Migra\u00e7\u00e3o])    OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Instrutor \u00daltima DMA]\t\t\t=\tFIRST_VALUE([Instrutor \u00daltima DMA])         OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Cargo]\t\t\t\t\t\t=\tFIRST_VALUE([Cargo])                        OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Supervis\u00e3o]\t\t\t\t\t=\tFIRST_VALUE([Supervis\u00e3o])                   OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Email Supervis\u00e3o]\t\t\t\t=\tFIRST_VALUE([Email Supervis\u00e3o])             OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n\t\t\t\t\t,[ult_Tempo de Casa (Dias)]\t\t\t=\tFIRST_VALUE([Tempo de Casa (Dias)])         OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n\t\t\t\t\t,[ult_Faixa Tempo de Casa]\t\t\t=\tFIRST_VALUE([Faixa Tempo de Casa])          OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n\t\t\t\t\t,[ult_Idade]\t\t\t\t\t\t=\tFIRST_VALUE([Idade])\t\t\t\t\t\tOVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n\t\t\t\t\t,[ult_Faixa de Idade]\t\t\t\t=\tFIRST_VALUE([Faixa de Idade])\t\t\t\tOVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Turno]\t\t\t\t\t\t=\tFIRST_VALUE([Turno])                        OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Escala (Ponto)]\t\t\t\t=\tFIRST_VALUE([Escala (Ponto)])               OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Jornada (Ponto)]\t\t\t\t=\tFIRST_VALUE([Jornada (Ponto)])              OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Escala (MOP)]\t\t\t\t\t=\tFIRST_VALUE([Escala (MOP)])                 OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Jornada (Log)]\t\t\t\t=\tFIRST_VALUE([Jornada (Log)])                OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Fonte de Log]\t\t\t\t\t=\tFIRST_VALUE([Fonte de Log])                OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n                FROM r_individuo_dia\n    \t\t    WHERE [M\u00eas (Primeiro Dia)] >= DATEFROMPARTS(YEAR(@datahora_inicio ),MONTH(@datahora_inicio) ,1)\n    \t\t    AND\t  [M\u00eas (Primeiro Dia)] <= DATEFROMPARTS(YEAR(@datahora_fim ),MONTH(@datahora_fim) ,1)\n            ) _\n    \t\tGROUP BY [M\u00eas (Primeiro Dia)], [ID Selecionar], [Tribo Completa]\n    \t) AS fonte\n    \tON  fonte.[M\u00eas (Primeiro Dia)]  = destino.[M\u00eas (Primeiro Dia)]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t= COALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n    \t\t\t [M\u00eas (Primeiro Dia)]\n\n                --,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,[ID Selecionar]\n    \t\t\t,[Nome]\n    \t\t\t,[Status]\n    \t\t\t,[Situa\u00e7\u00e3o]\n    \t\t\t,[Condi\u00e7\u00e3o]\n\n    \t\t\t,[DMA Inicial]\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,[\u00daltima DMA Geral]\n    \t\t\t,[Tipo da \u00daltima DMA]\n    \t\t\t,[Instrutor Inicial]\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,[Instrutor \u00daltima DMA]\n\n    \t\t\t,[Cliente]\n    \t\t\t,[Projeto]\n    \t\t\t,[Cargo]\n    \t\t\t,[Tribo]\n    \t\t\t,[Tribo Completa]\n    \t\t\t,[Supervis\u00e3o]\n\t\t\t\t,[Email Supervis\u00e3o]\n\t\t\t\t,[Tempo de Casa (Dias)]\n\t\t\t\t,[Faixa Tempo de Casa]\n\t\t\t\t,[Idade]\n\t\t\t\t,[Faixa de Idade]\n    \t\t\t,[Turno]\n\n    \t\t\t,[Escala (Ponto)]\n    \t\t\t,[Jornada (Ponto)]\n    \t\t\t,[Trabalhado (Ponto)]\n    \t\t\t,[Em Pausa (Ponto)]\n\t\t\t\t,[Desvio Ponto-Log]\n    \t\t\t,[Escala (MOP)]\n    \t\t\t,[Jornada (Log)]\n\t\t\t\t,[Fonte de Log]\n\n    \t\t\t,[Log descartado (>2HE)]\n    \t\t\t,[Log HE]\n    \t\t\t,[Log]\n    \t\t\t,[Log Produtivo]\n    \t\t \t,[Log Improdutivo]\n\t\t\t\t,[Tempo Total (Intelix)]\n\t\t\t\t,[Tempo Total (EPBX)]\n\t\t\t\t,[Tempo Total (Genesys)]\n\t\t\t\t,[Tempo Total (Secullum)]\n    \t\t \t,[Tempo Livre]\n    \t\t \t,[Pausa Particular (Intelix)]\n    \t\t \t,[Pausa Break (Intelix)]\n    \t\t \t,[Pausa 10 (Intelix)]\n    \t\t \t,[Pausa Outbound (Intelix)]\n    \t\t  \t,[Pausa Lanche (Intelix)]\n    \t\t  \t,[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,[Pausa Feedback (Intelix)]\n    \t\t  \t,[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,[Pausa Treinamento (Intelix)]\n    \t\t  \t,[Pausa Banheiro (Intelix)]\n    \t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,[Pausa NR17 (Intelix)]\n    \t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,[Pausa Tratativa (EPBX)]\n    \t\t  \t,[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,[Pausa Banheiro (EPBX)]\n    \t\t  \t,[Pausa WhatsApp (EPBX)]\n    \t\t  \t,[Pausa Intervalo (EPBX)]\n    \t\t  \t,[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,[Pausa Treinamento (EPBX)]\n    \t\t  \t,[Pausa Feedback (EPBX)]\n    \t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,[Pausa Login (EPBX)]\n    \t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,[Pausa NR17 (EPBX)]\n    \t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,[Pausa Lanche (EPBX)]\n    \t\t  \t,[Pausa BackOffice (EPBX)]\n    \t\t\t,[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t \t,[Pausa Banheiro (Genesys)]\n    \t\t \t,[Pausa Descanso (Genesys)]\n    \t\t \t,[Pausa Feedback (Genesys)]\n    \t\t \t,[Pausa Backoffice (Genesys)]\n    \t\t \t,[Pausa Discagem Manual (Genesys)]\n    \t\t \t,[Pausa Discagem Retorno (Genesys)]\n    \t\t \t,[Pausa Dispon\u00edvel (Genesys)]\n    \t\t \t,[Pausa Em Fila (Genesys)]\n    \t\t \t,[Pausa Sistema Externo (Genesys)]\n    \t\t \t,[Pausa Sistema Interno (Genesys)]\n    \t\t \t,[Pausa Tratativa (Genesys)]\n    \t\t \t,[Pausa Whatsapp (Genesys)]\n    \t\t\t,[Pausa Treinamento (Genesys)]\n\n    \t\t\t,[Criados]\n    \t\t\t,[Tratados]\n    \t\t\t,[Tempo Total de Tratativa]\n    \t\t\t,[TMT]\n    \t\t\t,[N\u00e3o Resolvidos]\n    \t\t\t,[Replicas]\n    \t\t\t,[Reincidentes 48h]\n    \t\t\t,[Reincidentes 30d]\n\n    \t\t    ,[Inbound - Chamadas Iniciadas]\n    \t\t    ,[Inbound - Chamadas Atendidas]\n    \t\t    ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,[Inbound - Chamadas Em Andamento]\n    \t\t    ,[Inbound - Chamadas Finalizadas]\n    \t\t    ,[Inbound - Chamadas Transferidas]\n    \t\t    ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,[Inbound - Atendimentos Iniciados]\n    \t\t    ,[Inbound - Atendimentos Em Andamento]\n    \t\t    ,[Inbound - Atendimentos Finalizados]\n    \t\t    ,[Inbound - TMC]\n    \t\t    ,[Inbound - TMA]\n    \t\t    ,[Inbound - TME]\n    \t\t    ,[Inbound - TMO]\n    \t\t    ,[Inbound - % Nivel de Servi\u00e7o]\n    \t\t    ,[Inbound - Chamadas Abandonadas]\n    \t\t    ,[Inbound - % Abandono]\n\n    \t\t    ,[Outbound - Chamadas Iniciadas]\n    \t\t    ,[Outbound - Chamadas Atendidas]\n    \t\t    ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,[Outbound - Chamadas Em Andamento]\n    \t\t    ,[Outbound - Chamadas Finalizadas]\n    \t\t    ,[Outbound - Chamadas Transferidas]\n    \t\t    ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,[Outbound - Atendimentos Iniciados]\n    \t\t    ,[Outbound - Atendimentos Em Andamento]\n    \t\t    ,[Outbound - Atendimentos Finalizados]\n    \t\t    ,[Outbound - TMC]\n    \t\t    ,[Outbound - TMA]\n    \t\t    ,[Outbound - TME]\n    \t\t    ,[Outbound - TMO]\n    \t\t    ,[Outbound - % Nivel de Servi\u00e7o]\n    \t\t    ,[Outbound - Chamadas Abandonadas]\n    \t\t    ,[Outbound - % Abandono]\n\n    \t\t\t,[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t,[Promotoras]\n    \t\t\t,[Neutras]\n    \t\t\t,[Detratoras]\n    \t\t\t,[NPS]\n\n    \t\t\t,[\u00c9 A Tribo do MOP?]\n    \t\t\t,[Teve Evento de MOP?]\n    \t\t\t,[Teve Evento de Tickets?]\n    \t\t\t,[Teve Evento de Chamadas?]\n    \t\t\t,[Teve Evento de NPS?]\n    \t\t\t,[Teve Evento de Log?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n    \t\t\t fonte.[M\u00eas (Primeiro Dia)]\n\n                --,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n    \t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,fonte.[ID Selecionar]\n    \t\t\t,fonte.[Nome]\n    \t\t\t,fonte.[Status]\n    \t\t\t,fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,fonte.[Condi\u00e7\u00e3o]\n\n    \t\t\t,fonte.[DMA Inicial]\n    \t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[\u00daltima DMA Geral]\n    \t\t\t,fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,fonte.[Instrutor Inicial]\n    \t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[Instrutor \u00daltima DMA]\n\n    \t\t\t,fonte.[Cliente]\n    \t\t\t,fonte.[Projeto]\n    \t\t\t,fonte.[Cargo]\n    \t\t\t,fonte.[Tribo]\n    \t\t\t,fonte.[Tribo Completa]\n    \t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t\t,fonte.[Email Supervis\u00e3o]\n\t\t\t\t,fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,fonte.[Faixa Tempo de Casa]\n\t\t\t\t,fonte.[Idade]\n\t\t\t\t,fonte.[Faixa de Idade]\n    \t\t\t,fonte.[Turno]\n\n    \t\t\t,fonte.[Escala (Ponto)]\n    \t\t\t,fonte.[Jornada (Ponto)]\n    \t\t\t,fonte.[Trabalhado (Ponto)]\n    \t\t\t,fonte.[Em Pausa (Ponto)]\n\t\t\t\t,fonte.[Desvio Ponto-Log]\n    \t\t\t,fonte.[Escala (MOP)]\n    \t\t\t,fonte.[Jornada (Log)]\n\t\t\t\t,fonte.[Fonte de Log]\n\n    \t\t\t,fonte.[Log descartado (>2HE)]\n    \t\t\t,fonte.[Log HE]\n    \t\t\t,fonte.[Log]\n    \t\t\t,fonte.[Log Produtivo]\n    \t\t \t,fonte.[Log Improdutivo]\n\t\t\t\t,fonte.[Tempo Total (Intelix)]\n\t\t\t\t,fonte.[Tempo Total (EPBX)]\n\t\t\t\t,fonte.[Tempo Total (Genesys)]\n\t\t\t\t,fonte.[Tempo Total (Secullum)]\n    \t\t \t,fonte.[Tempo Livre]\n    \t\t \t,fonte.[Pausa Particular (Intelix)]\n    \t\t \t,fonte.[Pausa Break (Intelix)]\n    \t\t \t,fonte.[Pausa 10 (Intelix)]\n    \t\t \t,fonte.[Pausa Outbound (Intelix)]\n    \t\t  \t,fonte.[Pausa Lanche (Intelix)]\n    \t\t  \t,fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,fonte.[Pausa Feedback (Intelix)]\n    \t\t  \t,fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,fonte.[Pausa Treinamento (Intelix)]\n    \t\t  \t,fonte.[Pausa Banheiro (Intelix)]\n    \t\t  \t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,fonte.[Pausa NR17 (Intelix)]\n    \t\t  \t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,fonte.[Pausa Tratativa (EPBX)]\n    \t\t  \t,fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,fonte.[Pausa Banheiro (EPBX)]\n    \t\t  \t,fonte.[Pausa WhatsApp (EPBX)]\n    \t\t  \t,fonte.[Pausa Intervalo (EPBX)]\n    \t\t  \t,fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,fonte.[Pausa Treinamento (EPBX)]\n    \t\t  \t,fonte.[Pausa Feedback (EPBX)]\n    \t\t  \t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,fonte.[Pausa Login (EPBX)]\n    \t\t  \t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,fonte.[Pausa NR17 (EPBX)]\n    \t\t  \t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,fonte.[Pausa Lanche (EPBX)]\n    \t\t  \t,fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t \t,fonte.[Pausa Banheiro (Genesys)]\n    \t\t \t,fonte.[Pausa Descanso (Genesys)]\n    \t\t \t,fonte.[Pausa Feedback (Genesys)]\n    \t\t \t,fonte.[Pausa Backoffice (Genesys)]\n    \t\t \t,fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t \t,fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t \t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t \t,fonte.[Pausa Em Fila (Genesys)]\n    \t\t \t,fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t \t,fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t \t,fonte.[Pausa Tratativa (Genesys)]\n    \t\t \t,fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t,fonte.[Pausa Treinamento (Genesys)]\n\n    \t\t\t,fonte.[Criados]\n    \t\t\t,fonte.[Tratados]\n    \t\t\t,fonte.[Tempo Total de Tratativa]\n    \t\t\t,fonte.[TMT]\n    \t\t\t,fonte.[N\u00e3o Resolvidos]\n    \t\t\t,fonte.[Replicas]\n    \t\t\t,fonte.[Reincidentes 48h]\n    \t\t\t,fonte.[Reincidentes 30d]\n\n    \t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n    \t\t    ,fonte.[Inbound - Chamadas Atendidas]\n    \t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n    \t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n    \t\t    ,fonte.[Inbound - Chamadas Transferidas]\n    \t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n    \t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n    \t\t    ,fonte.[Inbound - TMC]\n    \t\t    ,fonte.[Inbound - TMA]\n    \t\t    ,fonte.[Inbound - TME]\n    \t\t    ,fonte.[Inbound - TMO]\n    \t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n    \t\t    ,fonte.[Inbound - % Abandono]\n\n    \t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n    \t\t    ,fonte.[Outbound - Chamadas Atendidas]\n    \t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n    \t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n    \t\t    ,fonte.[Outbound - Chamadas Transferidas]\n    \t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n    \t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n    \t\t    ,fonte.[Outbound - TMC]\n    \t\t    ,fonte.[Outbound - TMA]\n    \t\t    ,fonte.[Outbound - TME]\n    \t\t    ,fonte.[Outbound - TMO]\n    \t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n    \t\t    ,fonte.[Outbound - % Abandono]\n\n    \t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t    ,fonte.[Promotoras]\n    \t\t    ,fonte.[Neutras]\n    \t\t    ,fonte.[Detratoras]\n    \t\t    ,fonte.[NPS]\n\n    \t\t    ,fonte.[\u00c9 A Tribo do MOP?]\n    \t\t    ,fonte.[Teve Evento de MOP?]\n    \t\t    ,fonte.[Teve Evento de Tickets?]\n    \t\t    ,fonte.[Teve Evento de Chamadas?]\n    \t\t    ,fonte.[Teve Evento de NPS?]\n    \t\t    ,fonte.[Teve Evento de Log?]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[M\u00eas (Primeiro Dia)]\t\t\t\t= fonte.[M\u00eas (Primeiro Dia)]\n\n                --,destino.[Feriado (Nome)]                                     =   fonte.[Feriado (Nome)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n    \t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t= fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,destino.[ID Selecionar]\t\t\t\t\t= fonte.[ID Selecionar]\n    \t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t= fonte.[Nome]\n    \t\t\t,destino.[Status]\t\t\t\t\t\t\t= fonte.[Status]\n    \t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Condi\u00e7\u00e3o]\n\n    \t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t= fonte.[DMA Inicial]\n    \t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t= fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t= fonte.[\u00daltima DMA Geral]\n    \t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t= fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,destino.[Instrutor Inicial]\t\t\t\t= fonte.[Instrutor Inicial]\n    \t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t= fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t= fonte.[Instrutor \u00daltima DMA]\n\n    \t\t\t,destino.[Cliente]\t\t\t\t\t\t\t= fonte.[Cliente]\n    \t\t\t,destino.[Projeto]\t\t\t\t\t\t\t= fonte.[Projeto]\n    \t\t\t,destino.[Cargo]\t\t\t\t\t\t\t= fonte.[Cargo]\n    \t\t\t,destino.[Tribo]\t\t\t\t\t\t\t= fonte.[Tribo]\n    \t\t\t,destino.[Tribo Completa]\t\t\t\t\t= fonte.[Tribo Completa]\n    \t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t= fonte.[Supervis\u00e3o]\n    \t\t\t,destino.[Email Supervis\u00e3o]\t\t\t\t\t= fonte.[Email Supervis\u00e3o]\n\t\t\t\t,destino.[Tempo de Casa (Dias)]\t\t\t\t= fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,destino.[Faixa Tempo de Casa]\t\t\t\t= fonte.[Faixa Tempo de Casa]\n\t\t\t\t,destino.[Idade]\t\t\t\t\t\t\t= fonte.[Idade]\n\t\t\t\t,destino.[Faixa de Idade]\t\t\t\t\t= fonte.[Faixa de Idade]\n    \t\t\t,destino.[Turno]\t\t\t\t\t\t\t= fonte.[Turno]\n\n    \t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t= fonte.[Escala (Ponto)]\n    \t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t= fonte.[Jornada (Ponto)]\n    \t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t= fonte.[Trabalhado (Ponto)]\n    \t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t= fonte.[Em Pausa (Ponto)]\n\t\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t= fonte.[Desvio Ponto-Log]\n    \t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t= fonte.[Escala (MOP)]\n    \t\t\t,destino.[Jornada (Log)]\t\t\t\t\t= fonte.[Jornada (Log)]\n\t\t\t\t,destino.[Fonte de Log]\t\t\t\t\t\t= fonte.[Fonte de Log]\n\n    \t\t\t,destino.[Log descartado (>2HE)]\t\t\t= fonte.[Log descartado (>2HE)]\n    \t\t\t,destino.[Log HE]\t\t\t\t\t\t\t= fonte.[Log HE]\n    \t\t\t,destino.[Log]\t\t\t\t\t\t\t\t= fonte.[Log]\n    \t\t\t,destino.[Log Produtivo]\t\t\t\t\t= fonte.[Log Produtivo]\n    \t\t \t,destino.[Log Improdutivo]\t\t\t\t\t= fonte.[Log Improdutivo]\n\t\t\t\t,destino.[Tempo Total (Intelix)]\t\t\t= fonte.[Tempo Total (Intelix)]\n\t\t\t\t,destino.[Tempo Total (EPBX)]\t\t\t\t= fonte.[Tempo Total (EPBX)]\n\t\t\t\t,destino.[Tempo Total (Genesys)]\t\t\t= fonte.[Tempo Total (Genesys)]\n\t\t\t\t,destino.[Tempo Total (Secullum)]\t\t\t= fonte.[Tempo Total (Secullum)]\n    \t\t \t,destino.[Tempo Livre]\t\t\t\t\t\t= fonte.[Tempo Livre]\n    \t\t \t,destino.[Pausa Particular (Intelix)]\t\t= fonte.[Pausa Particular (Intelix)]\n    \t\t \t,destino.[Pausa Break (Intelix)]\t\t\t= fonte.[Pausa Break (Intelix)]\n    \t\t \t,destino.[Pausa 10 (Intelix)]\t\t\t\t= fonte.[Pausa 10 (Intelix)]\n    \t\t \t,destino.[Pausa Outbound (Intelix)]\t\t\t= fonte.[Pausa Outbound (Intelix)]\n    \t\t  \t,destino.[Pausa Lanche (Intelix)]\t\t\t= fonte.[Pausa Lanche (Intelix)]\n    \t\t  \t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t= fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t= fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,destino.[Pausa Feedback (Intelix)]\t\t\t= fonte.[Pausa Feedback (Intelix)]\n    \t\t  \t,destino.[Pausa Sistema Interno (Intelix)]\t= fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,destino.[Pausa Sistema Externo (Intelix)]\t= fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,destino.[Pausa Treinamento (Intelix)]\t\t= fonte.[Pausa Treinamento (Intelix)]\n    \t\t  \t,destino.[Pausa Banheiro (Intelix)]\t\t\t= fonte.[Pausa Banheiro (Intelix)]\n    \t\t  \t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t= fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,destino.[Pausa NR17 (Intelix)]\t\t\t\t= fonte.[Pausa NR17 (Intelix)]\n    \t\t  \t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t= fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,destino.[Pausa Tratativa (EPBX)]\t\t\t= fonte.[Pausa Tratativa (EPBX)]\n    \t\t  \t,destino.[Pausa Discagem Manual (EPBX)]\t\t= fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,destino.[Pausa Banheiro (EPBX)]\t\t\t= fonte.[Pausa Banheiro (EPBX)]\n    \t\t  \t,destino.[Pausa WhatsApp (EPBX)]\t\t\t= fonte.[Pausa WhatsApp (EPBX)]\n    \t\t  \t,destino.[Pausa Intervalo (EPBX)]\t\t\t= fonte.[Pausa Intervalo (EPBX)]\n    \t\t  \t,destino.[Pausa Discagem Retorno (EPBX)]\t= fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,destino.[Pausa Treinamento (EPBX)]\t\t\t= fonte.[Pausa Treinamento (EPBX)]\n    \t\t  \t,destino.[Pausa Feedback (EPBX)]\t\t\t= fonte.[Pausa Feedback (EPBX)]\n    \t\t  \t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t= fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t= fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,destino.[Pausa Login (EPBX)]\t\t\t\t= fonte.[Pausa Login (EPBX)]\n    \t\t  \t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,destino.[Pausa Sistema Interno (EPBX)]\t\t= fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,destino.[Pausa Sistema Externo (EPBX)]\t\t= fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,destino.[Pausa NR17 (EPBX)]\t\t\t\t= fonte.[Pausa NR17 (EPBX)]\n    \t\t  \t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t= fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t= fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,destino.[Pausa Lanche (EPBX)]\t\t\t\t= fonte.[Pausa Lanche (EPBX)]\n    \t\t  \t,destino.[Pausa BackOffice (EPBX)]\t\t\t= fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t= fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t= fonte.[Pausa Banheiro (Genesys)]\n    \t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t= fonte.[Pausa Descanso (Genesys)]\n    \t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t= fonte.[Pausa Feedback (Genesys)]\n    \t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t= fonte.[Pausa Backoffice (Genesys)]\n    \t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t= fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t= fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t= fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t= fonte.[Pausa Em Fila (Genesys)]\n    \t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t= fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t= fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t= fonte.[Pausa Tratativa (Genesys)]\n    \t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t= fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t= fonte.[Pausa Treinamento (Genesys)]\n\n    \t\t\t,destino.[Criados]\t\t\t\t\t\t\t= fonte.[Criados]\n    \t\t\t,destino.[Tratados]\t\t\t\t\t\t\t= fonte.[Tratados]\n    \t\t\t,destino.[Tempo Total de Tratativa]\t\t\t= fonte.[Tempo Total de Tratativa]\n    \t\t\t,destino.[TMT]\t\t\t\t\t\t\t\t= fonte.[TMT]\n    \t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t\t\t= fonte.[N\u00e3o Resolvidos]\n    \t\t\t,destino.[Replicas]\t\t\t\t\t\t\t= fonte.[Replicas]\n    \t\t\t,destino.[Reincidentes 48h]\t\t\t\t\t= fonte.[Reincidentes 48h]\n    \t\t\t,destino.[Reincidentes 30d]\t\t\t\t\t= fonte.[Reincidentes 30d]\n\n    \t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Transferidas]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMC]\n    \t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMA]\n    \t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TME]\n    \t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMO]\n    \t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Abandono]\n\n    \t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Transferidas]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMC]\n    \t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMA]\n    \t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TME]\n    \t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMO]\n    \t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - % Abandono]\n\n    \t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t= fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t,destino.[Promotoras]\t\t\t\t\t\t= fonte.[Promotoras]\n    \t\t\t,destino.[Neutras]\t\t\t\t\t\t\t= fonte.[Neutras]\n    \t\t\t,destino.[Detratoras]\t\t\t\t\t\t= fonte.[Detratoras]\n    \t\t\t,destino.[NPS]\t\t\t\t\t\t\t\t= fonte.[NPS]\n\n    \t\t\t,destino.[\u00c9 A Tribo do MOP?]\t\t\t\t= fonte.[\u00c9 A Tribo do MOP?]\n    \t\t\t,destino.[Teve Evento de MOP?]\t\t\t\t= fonte.[Teve Evento de MOP?]\n    \t\t\t,destino.[Teve Evento de Tickets?]\t\t\t= fonte.[Teve Evento de Tickets?]\n    \t\t\t,destino.[Teve Evento de Chamadas?]\t\t\t= fonte.[Teve Evento de Chamadas?]\n    \t\t\t,destino.[Teve Evento de NPS?]\t\t\t\t= fonte.[Teve Evento de NPS?]\n    \t\t\t,destino.[Teve Evento de Log?]\t\t\t\t= fonte.[Teve Evento de Log?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_individuo_m\u00eas\n        WHERE [M\u00eas (Primeiro Dia)] >= CAST(GETDATE() AS DATE)\n\t\t\tOR(\t[\u00c9 A Tribo do MOP?]\t\t    = 0\n    \t    AND\t[Teve Evento de MOP?]\t    = 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0)\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n    IF 1=1 BEGIN; PRINT '--- agrupamento tribo_30min';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_tribo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n            SELECT\n                 [Ader\u00eancia Log 102%]               =   [Log 102%] / NULLIF([Forecast Log],0)\n                ,[Ader\u00eancia Log Produtivo 102%]     =   [Log Produtivo 102%] / NULLIF([Forecast Log Produtivo],0)\n                ,[Log Perdido (>102%)]              =   [Log] - [Log 102%]\n                ,[Log Produtivo Perdido (>102%)]    =   [Log Produtivo] - [Log Produtivo 102%]\n                ,*\n            FROM (\n                SELECT\n                     [Ader\u00eancia Log]                    =   [Log] / NULLIF([Forecast Log],0)\n                    ,[Ader\u00eancia Log Produtivo]          =   [Log Produtivo] / NULLIF([Forecast Log Produtivo],0)\n                    ,[Log 102%]                         =   IIF([Log] > [Forecast Log] * 1.2, [Forecast Log] * 1.2, [Log])\n                    ,[Log Produtivo 102%]               =   IIF([Log Produtivo] > [Forecast Log Produtivo] * 1.2, [Forecast Log Produtivo] * 1.2, [Log Produtivo])\n                    ,[Ader\u00eancia TMT]                    =   [TMT] / NULLIF([Forecast TMT],0)\n                    ,[Ader\u00eancia TMA]                    =   COALESCE([Inbound - TMA], [Outbound - TMA]) / NULLIF([Forecast TMA],0)\n                    ,[Ader\u00eancia SLA]                    =   [SLA TPR] / NULLIF([Forecast SLA],0)\n                    ,[Ader\u00eancia NS]                     =   [Inbound - % Nivel de Servi\u00e7o] / NULLIF([Forecast NS],0)\n                    --,[Ader\u00eancia NPS]                    =   [NPS] / NULLIF([Forecast NPS],0)\n                    ,[Ader\u00eancia Abandono]               =   [Inbound - % Abandono] / NULLIF([Forecast Abandono],0)\n                    ,[Ader\u00eancia Casos N\u00e3o Resolvidos]   =   [N\u00e3o Resolvidos] / NULLIF([Forecast Casos N\u00e3o Resolvidos],0)\n                    ,*\n                FROM (\n                \tSELECT\n\n                         [DataHora]\t\t\t\t\t\t\t\t\t\t\t\t        =   COALESCE([DataHora], [f_DataHora])\n                        ,[Intervalo]\t\t\t\t\t\t\t\t\t\t\t        =   MIN([Intervalo])\n                        ,[Data]\t\t\t\t\t\t\t\t\t\t\t\t\t        =   MIN([Data])\n                        ,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t\t\t\t        =   MIN([Ciclo (Primeiro Dia)])\n                        ,[M\u00eas (Primeiro Dia)]\t\t\t\t                            =   MIN([M\u00eas (Primeiro Dia)])\n\n                        ,[Feriado (Nome)]                                               =  MAX([Feriado (Nome)])\n\n       \t                ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(SUM([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t                ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(SUM([Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t                ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(SUM([Secullum - Servi\u00e7o Militar]                                   ),0)\n                        ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(SUM([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t                ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t                ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t                ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(SUM([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t                ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(SUM([Secullum - Licen\u00e7a Casamento]                                 ),0)\n                        ,[Secullum - INSS - Afastamento]                                    =   ISNULL(SUM([Secullum - INSS - Afastamento]                                ),0)\n                        ,[Secullum - Folga]                                                 =   ISNULL(SUM([Secullum - Folga]                                             ),0)\n                        ,[Secullum - F\u00e9rias]                                                =   ISNULL(SUM([Secullum - F\u00e9rias]                                            ),0)\n       \t                ,[Secullum - Feriado]                                               =   ISNULL(SUM([Secullum - Feriado]                                           ),0)\n       \t                ,[Secullum - Falta Justificada]                                     =   ISNULL(SUM([Secullum - Falta Justificada]                                 ),0)\n       \t                ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(SUM([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                        ,[Secullum - Falta Injustificada]                                   =   ISNULL(SUM([Secullum - Falta Injustificada]                               ),0)\n       \t                ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(SUM([Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t                ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(SUM([Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                        ,[Secullum - Desligue]                                              =   ISNULL(SUM([Secullum - Desligue]                                          ),0)\n       \t                ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(SUM([Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t                ,[Secullum - Compensando Horas]                                     =   ISNULL(SUM([Secullum - Compensando Horas]                                 ),0)\n       \t                ,[Secullum - Atestado]                                              =   ISNULL(SUM([Secullum - Atestado]                                          ),0)\n                        ,[Secullum - Abono]                                                 =   ISNULL(SUM([Secullum - Abono]                                             ),0)\n       \t                ,[Secullum - Abono Lactante]                                        =   ISNULL(SUM([Secullum - Abono Lactante]                                    ),0)\n       \t                ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(SUM([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t                ,[Faltas Justificadas]                                              =   ISNULL(SUM([Faltas Justificadas]                                          ),0)\n       \t                ,[Faltas Injustificadas]                                            =   ISNULL(SUM([Faltas Injustificadas]                                        ),0)\n\n                        ,[Cliente]\t\t\t\t\t\t\t                            =   MIN([Cliente])\n                        ,[Projeto]\t\t\t\t\t\t\t                            =   MIN([Projeto])\n                        ,[Tribo]\t\t\t\t\t\t\t                            =   MIN([Tribo])\n                        ,[Tribo Completa]\t\t\t\t\t                            =   COALESCE([Tribo Completa], [f_Tribo Completa])\n\n                        ,[Trabalhado (Ponto)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Trabalhado (Ponto)]),0)\n                        ,[Em Pausa (Ponto)]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Em Pausa (Ponto)]),0)\n\t\t\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Desvio Ponto-Log]),0)\n\n                        ,[Forecast HC Taxa 1]                                           =   MAX(f.[Forecast HC Taxa 1])\n                        ,[Forecast HC Taxa 2]                                           =   MAX(f.[Forecast HC Taxa 2])\n                        ,[Forecast Pausas Taxa 1]                                       =   MAX(f.[Forecast Pausas Taxa 1])\n                        ,[Forecast Pausas Taxa 2]                                       =   MAX(f.[Forecast Pausas Taxa 2])\n                        ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                     =   MAX(f.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio])\n                        ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                 =   MAX(f.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio])\n                        ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t                    =   MAX(f.[Forecast PA Liquida (VOZ) - Provis\u00f3rio])\n                        ,[Forecast Volume]\t\t                                        =   MAX(f.[Forecast Volume])\n                        --,[Forecast Volume M\u00eas - Provis\u00f3rio]                           =\n                        ,[Forecast Log]                                                 =   (MAX(f.[Forecast HC Taxa 1]) * 1800) + (MAX(f.[Forecast HC Taxa 2]) * 1800)\n                        ,[Forecast Log Produtivo]                                       =   (MAX(f.[Forecast HC Taxa 1]) * 1800 * (1-MAX(f.[Forecast Pausas Taxa 1]))) + (MAX(f.[Forecast HC Taxa 2]) * 1800 * (1-MAX(f.[Forecast Pausas Taxa 2])))\n                        ,[Forecast NS]                                                  =   MAX(f.[Forecast NS])\n                        --,[Forecast NS M\u00eas - Provis\u00f3rio]                               =\n\n                        ,[Forecast TMT]                                                 =   MAX(f.[Forecast TMT])\n                        ,[Forecast TMA]                                                 =   MAX(f.[Forecast TMA])\n                        ,[Forecast SLA]                                                 =   MAX(f.[Forecast SLA])\n                        ,[Forecast Abandono]                                            =   MAX(m.[Forecast Abandono])\n                        ,[Forecast NPS]                                                 =   MAX(m.[Forecast NPS])\n                        ,[Forecast Casos N\u00e3o Resolvidos]                                =   MAX(m.[Forecast Casos N\u00e3o Resolvidos])\n                        ,[Forecast Rechamada]                                           =   MAX(m.[Forecast Rechamada])\n                        ,[Forecast Short Call]                                          =   MAX(m.[Forecast Short Call])\n                        ,[Forecast Instabilidade]                                       =   MAX(m.[Forecast Instabilidade])\n                        ,[Forecast Phishing]                                            =   MAX(m.[Forecast Phishing])\n\n                        --UP--,[Ader\u00eancia Log]                                          =\n                        --UP--,[Ader\u00eancia Log 102%]                                     =\n                        --UP--,[Ader\u00eancia Log Produtivo]                                =\n                        --UP--,[Ader\u00eancia Log Produtivo 102%]                           =\n                        --UP--,[Ader\u00eancia TMT]                                          =\n                        --UP--,[Ader\u00eancia TMA]                                          =\n                        --UP--,[Ader\u00eancia SLA]                                          =\n                        --UP--,[Ader\u00eancia NS]                                           =\n                        --UP--,[Ader\u00eancia Abandono]                                     =\n                        --UP--,[Ader\u00eancia NPS]                                          =\n                        --UP--,[Ader\u00eancia Casos N\u00e3o Resolvidos]                         =\n                        --,[Ader\u00eancia Rechamada]                                        =\n                        --,[Ader\u00eancia Short Call]                                       =\n                        --,[Ader\u00eancia Instabilidade]                                    =\n                        --,[Ader\u00eancia Phishing]                                         =\n\n                        --,[Penalidade TMT]                                             =\n                        --,[Penalidade TMA]                                             =\n                        --,[Penalidade SLA]                                             =\n                        --,[Penalidade NS]                                              =\n                        --,[Penalidade Abandono]                                        =\n                        --,[Penalidade NPS]                                             =\n                        --,[Penalidade Casos N\u00e3o Resolvidos]                            =\n                        --,[Penalidade Rechamada]                                       =\n                        --,[Penalidade Short Call]                                      =\n                        --,[Penalidade Instabilidade]                                   =\n                        --,[Penalidade Phishing]                                        =\n\n                        --,[PAs Contratadas]                                            =\n                        --,[Valor da PA]                                                =\n                        --,[Faturamento Antes das Penalidades]                          =\n                        --,[Faturamento Ap\u00f3s Penalidades]                               =\n\n                        ,[Log]\t\t\t\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log]),0)\n                        -- UP --,[Log 102%]\n                        -- UP --,[Log Perdido (>102%)]\n                        ,[Log Produtivo]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log Produtivo]),0)\n                        -- UP --,[Log Produtivo 102%]\n                        -- UP --,[Log Produtivo Perdido (>102%)]\n                        ,[Log HE]\t\t\t\t\t\t\t\t\t\t\t\t\t    =   ISNULL(SUM([Log HE]),0)\n                        ,[Log descartado (>2HE)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log descartado (>2HE)]),0)\n                        ,[Log Improdutivo]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log Improdutivo]),0)\n\t\t\t\t\t\t,[Tempo Total (Intelix)]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total (Intelix)]),0)\n\t\t\t\t\t\t,[Tempo Total (EPBX)]\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total (EPBX)]),0)\n\t\t\t\t\t\t,[Tempo Total (Genesys)]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total (Genesys)]),0)\n\t\t\t\t\t\t,[Tempo Total (Secullum)]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total (Secullum)]),0)\n                        ,[Tempo Livre]\t\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Tempo Livre]),0)\n                        ,[Pausa Particular (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Particular (Intelix)]),0)\n                        ,[Pausa Break (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Break (Intelix)]),0)\n                        ,[Pausa 10 (Intelix)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa 10 (Intelix)]),0)\n                        ,[Pausa Outbound (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Outbound (Intelix)]),0)\n                        ,[Pausa Lanche (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Lanche (Intelix)]),0)\n                        ,[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa R\u00e1pida (Intelix)]),0)\n                        ,[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (Intelix)]),0)\n                        ,[Pausa Feedback (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (Intelix)]),0)\n                        ,[Pausa Sistema Interno (Intelix)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (Intelix)]),0)\n                        ,[Pausa Sistema Externo (Intelix)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (Intelix)]),0)\n                        ,[Pausa Treinamento (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (Intelix)]),0)\n                        ,[Pausa Banheiro (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (Intelix)]),0)\n                        ,[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Reuni\u00e3o (Intelix)]),0)\n                        ,[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (Intelix)]),0)\n                        ,[Pausa NR17 (Intelix)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa NR17 (Intelix)]),0)\n                        ,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Liga\u00e7\u00e3o (EPBX)]),0)\n                        ,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (EPBX)]),0)\n                        ,[Pausa Tratativa (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Tratativa (EPBX)]),0)\n                        ,[Pausa Discagem Manual (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Manual (EPBX)]),0)\n                        ,[Pausa Banheiro (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (EPBX)]),0)\n                        ,[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa WhatsApp (EPBX)]),0)\n                        ,[Pausa Intervalo (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Intervalo (EPBX)]),0)\n                        ,[Pausa Discagem Retorno (EPBX)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Retorno (EPBX)]),0)\n                        ,[Pausa Treinamento (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (EPBX)]),0)\n                        ,[Pausa Feedback (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (EPBX)]),0)\n                        ,[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Transfer\u00eancia (EPBX)]),0)\n                        ,[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa N\u00e3o Disponivel (EPBX)]),0)\n                        ,[Pausa Login (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Login (EPBX)]),0)\n                        ,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Reuni\u00e3o (EPBX)]),0)\n                        ,[Pausa Sistema Interno (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (EPBX)]),0)\n                        ,[Pausa Sistema Externo (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (EPBX)]),0)\n                        ,[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa NR17 (EPBX)]),0)\n                        ,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (EPBX)]),0)\n                        ,[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa P\u00f3s Atendimento (EPBX)]),0)\n                        ,[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Lanche (EPBX)]),0)\n                        ,[Pausa BackOffice (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa BackOffice (EPBX)]),0)\n                        ,[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (Genesys)]),0)\n                        ,[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (Genesys)]),0)\n                        ,[Pausa Banheiro (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (Genesys)]),0)\n                        ,[Pausa Descanso (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Descanso (Genesys)]),0)\n                        ,[Pausa Feedback (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (Genesys)]),0)\n                        ,[Pausa Backoffice (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Backoffice (Genesys)]),0)\n                        ,[Pausa Discagem Manual (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Manual (Genesys)]),0)\n                        ,[Pausa Discagem Retorno (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Retorno (Genesys)]),0)\n                        ,[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Dispon\u00edvel (Genesys)]),0)\n                        ,[Pausa Em Fila (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Em Fila (Genesys)]),0)\n                        ,[Pausa Sistema Externo (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (Genesys)]),0)\n                        ,[Pausa Sistema Interno (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (Genesys)]),0)\n                        ,[Pausa Tratativa (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Tratativa (Genesys)]),0)\n                        ,[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Whatsapp (Genesys)]),0)\n                        ,[Pausa Treinamento (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (Genesys)]),0)\n\n                        ,[Criados]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Criados]),0)\n                        ,[Tratados]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Tratados]),0)\n                        ,[Tempo Total de Tratativa]\t\t\t                            =   ISNULL(SUM([Tempo Total de Tratativa]),0)\n                        ,[TMT]\t\t\t\t\t\t\t\t                            =   ISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n                        ,[N\u00e3o Resolvidos]\t\t\t\t\t                            =   ISNULL(SUM([N\u00e3o Resolvidos]),0)\n                        ,[Replicas]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Replicas]),0)\n                        ,[Reincidentes 48h]\t\t\t\t\t                            =   ISNULL(SUM([Reincidentes 48h]),0)\n                        ,[Reincidentes 30d]\t\t\t\t\t                            =   ISNULL(SUM([Reincidentes 30d]),0)\n\n                        ,[SLA TPR]                                                      =   AVG([SLA TPR])\n                        ,[SLA TES]                                                      =   AVG([SLA TES])\n                        ,[SLA TTR]                                                      =   AVG([SLA TTR])\n\n                        ,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Iniciadas]),0)\n                        ,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas]),0)\n                        ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s]),0)\n                        ,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Em Andamento]),0)\n                        ,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Finalizadas]),0)\n                        ,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Transferidas]),0)\n                        ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=   ISNULL(SUM([Inbound - Tempo Em Chamada (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=   ISNULL(SUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=   ISNULL(SUM([Inbound - Tempo Em Espera (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=   ISNULL(SUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Chamada (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Atendimento (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Espera (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Encerramento (Neste Intervalo)]),0)\n                        ,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Iniciados]),0)\n                        ,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Em Andamento]),0)\n                        ,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Finalizados]),0)\n                        ,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n                        ,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n                        ,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n                        ,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n                        ,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n                        ,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Abandonadas]),0)\n                        ,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n                        ,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Iniciadas]),0)\n                        ,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas]),0)\n                        ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s]),0)\n                        ,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Em Andamento]),0)\n                        ,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Finalizadas]),0)\n                        ,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Transferidas]),0)\n                        ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=   ISNULL(SUM([Outbound - Tempo Em Chamada (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=   ISNULL(SUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=   ISNULL(SUM([Outbound - Tempo Em Espera (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=   ISNULL(SUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Chamada (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Atendimento (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Espera (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Encerramento (Neste Intervalo)]),0)\n                        ,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Iniciados]),0)\n                        ,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Em Andamento]),0)\n                        ,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Finalizados]),0)\n                        ,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n                        ,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n                        ,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n                        ,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n                        ,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n                        ,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Abandonadas]),0)\n                        ,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n                        ,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t                            =   ISNULL(SUM([Avalia\u00e7\u00f5es de NPS]),0)\n                        ,[Promotoras]\t\t\t\t\t\t                            =   ISNULL(SUM([Promotoras]),0)\n                        ,[Neutras]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Neutras]),0)\n                        ,[Detratoras]\t\t\t\t\t\t                            =   ISNULL(SUM([Detratoras]),0)\n                          --,[NPS]\t\t\t\t\t\t\t\t                        =   CAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n                        ,[Teve Evento de MOP?]\t\t                                    =   IIF(SUM([Teve Evento de MOP?])=0,0,1)\n                        ,[Teve Evento de Tickets?]\t                                    =   IIF(SUM([Teve Evento de Tickets?])=0,0,1)\n                        ,[Teve Evento de Chamadas?]\t                                    =   IIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n                        ,[Teve Evento de NPS?]\t\t                                    =   IIF(SUM([Teve Evento de NPS?])=0,0,1)\n                        ,[Teve Evento de Log?]\t\t                                    =   IIF(SUM([Teve Evento de Log?])=0,0,1)\n                        ,[Teve Evento de Forecast?]\t\t                                =   IIF(SUM([Teve Evento de Forecast?]) IS NULL,0,1)\n\n                \tFROM r_individuo_30min r\n                    FULL OUTER JOIN (\n                        SELECT\n                        \t [f_Datahora]\t\t\t                            =\t[datahora]\n                        \t,[f_Tribo Completa]\t                                =\tCASE [tribo]\n                        \t\t\t\t\t\t                                \t\tWHEN '0800 Premium'\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n                        \t\t\t\t\t\t                                \t\tWHEN 'BackOffice'\t\t\t\t\t\tTHEN 'Serasa__Voz__BackOffice'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Cadastro Positivo'\t\t\t\tTHEN 'Serasa__Voz__Cadastro Positivo'\n                        \t\t\t\t\t\t                                \t\tWHEN 'SAC'\t\t\t\t\t\t\t\tTHEN 'Serasa__Voz__SAC'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Central de Ajuda'\t\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Central de Ajuda - Autentica\u00e7\u00e3o'\tTHEN 'Serasa__Digital__Central de Ajuda - Autentica\u00e7\u00e3o'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Central de Ajuda - Produtos'\t\tTHEN 'Serasa__Digital__Central de Ajuda - Produtos'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Chat'\t\t\t\t\t\t\t\tTHEN 'Serasa__Digital__Chat'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Facebook e Lojas'\t\t\t\t\tTHEN 'Serasa__Digital__Facebook e Lojas'\n                        \t\t\t\t\t\t                                \t\tWHEN 'GOV'\t\t\t\t\t\t\t\tTHEN 'Serasa__Digital__GOV'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Reclame Aqui'\t\t\t\t\t\tTHEN 'Serasa__Digital__Reclame Aqui'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Self Setup'\t\t\t\t\t\tTHEN 'Serasa__Digital__Self Setup'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Serasa na Estrada'\t\t\t\tTHEN 'Serasa__Digital__Serasa na Estrada'\n                        \t\t\t\t\t\t                                \t\tELSE '____'\n                        \t\t\t\t\t\t                                \tEND\n                        \t,[Forecast Volume]\t\t                            =   [volume]\n                        \t,[Forecast TMT]                                     =   [tmt]\n                        \t,[Forecast TMA]                                     =   [tma]\n                        \t,[Forecast NS]                                      =   [ns]\n                        \t,[Forecast SLA]                                     =   [sla]\n                        \t,[Forecast HC Taxa 1]                               =   [hc_tx1]\n                        \t,[Forecast HC Taxa 2]                               =   [hc_tx2]/2\n                        \t,[Forecast Pausas Taxa 1]                           =   [pausas_tx1]\n                        \t,[Forecast Pausas Taxa 2]                           =   [pausas_tx2]\n                        \t,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]         =   [Pausa Almo\u00e7o (%) (VOZ)]\n                        \t,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]     =\t[Agentes em Pausa (VOZ)]\n                        \t,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t\t    =   [PA Liquida (VOZ)]\n                            --,[Forecast Log]                                     =   ([hc_tx1] * 1800) + ([hc_tx2] * 1800)\n                            --,[Forecast Log Produtivo]                           =   ([hc_tx1] * 1800 * (1-[hc_tx2])) + ([pausas_tx2] * 1800 * (1-[pausas_tx2]))\n                            ,[Teve Evento de Forecast?]                         =   1\n                        FROM [db_Serasa_producao].[dbo].dim_forecast_30min\n                    ) f\n                    ON  r.[DataHora] = f.[f_DataHora]\n                    AND r.[Tribo Completa] = f.[f_Tribo Completa]\n\n                    FULL OUTER JOIN (\n                        SELECT\n                         [m_Tribo]  = [tribo]\n                        ,[m_M\u00eas]    = [m\u00eas]\n                        ,[Forecast Volume M\u00eas - Provis\u00f3rio] = [volume_projetado] -- S\u00f3 pra valida\u00e7\u00e3o, pra ver se t\u00e1 batendo com a dim_forecast_30min\n                        ,[Forecast NS M\u00eas - Provis\u00f3rio] = [NS]\n                        ,[Forecast TMT] = IIF([tribo] in ('Central de Ajuda - Autentica\u00e7\u00e3o', 'Central de Ajuda - Produtos', 'Reclame Aqui', 'GOV', 'Self Setup', 'BackOffice', 'Chat', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                        ,[Forecast TMA] = IIF([tribo] in ('BackOffice', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                        ,[Forecast SLA] = [SLA]\n                        ,[Forecast Abandono] = [abandono]\n                        ,[Forecast NPS] = [NPS]\n                        ,[Forecast Casos N\u00e3o Resolvidos] = [casos_n\u00e3o_resolvidos]\n                        ,[Forecast Rechamada] = [rechamada]\n                        ,[Forecast Short Call] = [short_call]\n                        ,[Forecast Instabilidade] = [instabilidade]\n                        ,[Forecast Phishing] = [phishing]\n                        --,[Forecast HC Taxa 1] = [hc_tx1]\n                        --,[Forecast HC Taxa 2] = [hc_tx2]\n                        ,[PAs Contratadas] = [hc_tx1] + [hc_tx2]\n                        ,[Valor da PA] = [valor_pa]\n                        FROM (\n                            SELECT [n]=ROW_NUMBER() OVER (PARTITION BY [tribo], [m\u00eas] ORDER BY [data_recebimento]), *\n                            FROM [db_serasa_producao].[dbo].dim_forecast_metas\n                        ) _\n                        WHERE [n] = 1\n                    ) m\n                    ON  r.[Tribo] = m.[m_tribo]\n                    AND r.[M\u00eas (Primeiro Dia)] = m.[m_m\u00eas]\n\n                    LEFT JOIN (\n                        SELECT\n                         [m_Tribo]  = [tribo_serasa]\n                        ,[m_Data]   = [data]\n                        ,[SLA TPR]  = AVG([primeira_resposta_s])\n                        ,[SLA TES]  = AVG([espera_solicitante_s])\n                        ,[SLA TTR]  = AVG([total_resolucao_s])\n                        FROM [db_serasa_producao].[dbo].dim_teste_sla\n                        GROUP BY [tribo_serasa], [data]\n                    ) s\n                    ON  r.[Tribo] = s.[m_Tribo]\n                    AND r.[Data] = s.[m_Data]\n\n                \tWHERE COALESCE([DataHora],[f_DataHora]) >= @datahora_inicio\n                \tAND\t  COALESCE([DataHora],[f_DataHora]) <= @datahora_fim\n                \tGROUP BY COALESCE([DataHora],[f_DataHora]), COALESCE([Tribo Completa], [f_Tribo Completa])\n                ) r\n                LEFT JOIN (\n                    SELECT\n                         [p_DataHora]                                       =   [In\u00edcio do Intervalo]\n                        ,[p_Tribo Completa]                                 =   CASE [Nome da Fila]\n                                                                                    WHEN 'S_SAC' THEN 'Serasa__Voz__SAC'\n                                                                                    WHEN 'S_CADASTRO_POSITIVO' THEN 'Serasa__Voz__Cadastro Positivo'\n                                                                                    WHEN 'S_PREMIUM' THEN 'Serasa__Voz__0800 Premium'\n                                                                                END\n                        ,[Genesys Provis\u00f3rio - Oferta]                      =   TRY_CAST([Oferta] AS int)\n                        ,[Genesys Provis\u00f3rio - Resposta]                    =   TRY_CAST([Resposta] AS int)\n                        ,[Genesys Provis\u00f3rio - Em Espera]                   =   TRY_CAST([Em Espera] AS int)\n                        ,[Genesys Provis\u00f3rio - Transferir]                  =   TRY_CAST([Transferir] AS int)\n                        ,[Genesys Provis\u00f3rio - Abandono]                    =   TRY_CAST([Abandono] AS int)\n                        ,[Genesys Provis\u00f3rio - % Resposta]                  =   TRY_CAST([% de resposta] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - % Abandono]                  =   TRY_CAST([% de abandono] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - % NS]                        =   TRY_CAST([% de n\u00ed\u00advel de servi\u00e7o] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - % Alvos do NS]               =   TRY_CAST([% de alvos do n\u00edvel de servi\u00e7o] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]     =   TRY_CAST([Conversa\u00e7\u00e3o m\u00e9dia] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)] =   TRY_CAST([Tempo m\u00e9dio de espera] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]      =   TRY_CAST([Tratamento m\u00e9dio] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - VMA]                         =   TRY_CAST([VMA] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - TPC]                         =   TRY_CAST([TPC m\u00e9dio] AS decimal(18,4))\n                    FROM [db_Serasa_producao].[dbo].dim_chamadas_genesys_manual\n                ) p\n                ON  r.[DataHora] = p.[p_DataHora]\n                AND r.[Tribo Completa] = p.[p_Tribo Completa]\n            ) _\n    \t) AS fonte\n    \tON  fonte.[DataHora]  = destino.[DataHora]\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n\t\t     [DataHora]\n\t\t    ,[Intervalo]\n\t\t    ,[Data]\n\t\t    ,[Ciclo (Primeiro Dia)]\n\t\t    ,[M\u00eas (Primeiro Dia)]\n\n            ,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n\n\t\t    ,[Cliente]\n\t\t    ,[Projeto]\n\t\t    ,[Tribo]\n\t\t    ,[Tribo Completa]\n\n\t\t    ,[Trabalhado (Ponto)]\n\t\t    ,[Em Pausa (Ponto)]\n\t\t\t,[Desvio Ponto-Log]\n\n            ,[Forecast HC Taxa 1]\n            ,[Forecast HC Taxa 2]\n            ,[Forecast Pausas Taxa 1]\n            ,[Forecast Pausas Taxa 2]\n            ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,[Forecast Volume]\n            --,[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,[Forecast Log]\n            ,[Forecast Log Produtivo]\n            ,[Forecast NS]\n            --,[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,[Forecast TMT]\n            ,[Forecast TMA]\n            ,[Forecast SLA]\n            ,[Forecast Abandono]\n            ,[Forecast NPS]\n            ,[Forecast Casos N\u00e3o Resolvidos]\n            ,[Forecast Rechamada]\n            ,[Forecast Short Call]\n            ,[Forecast Instabilidade]\n            ,[Forecast Phishing]\n\n            ,[Ader\u00eancia Log]\n            ,[Ader\u00eancia Log 102%]\n            ,[Ader\u00eancia Log Produtivo]\n            ,[Ader\u00eancia Log Produtivo 102%]\n            ,[Ader\u00eancia TMT]\n            ,[Ader\u00eancia TMA]\n            ,[Ader\u00eancia SLA]\n            ,[Ader\u00eancia NS]\n            ,[Ader\u00eancia Abandono]\n            --,[Ader\u00eancia NPS]\n            ,[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,[Ader\u00eancia Rechamada]\n            --,[Ader\u00eancia Short Call]\n            --,[Ader\u00eancia Instabilidade]\n            --,[Ader\u00eancia Phishing]\n\n            --,[Penalidade TMT]\n            --,[Penalidade TMA]\n            --,[Penalidade SLA]\n            --,[Penalidade NS]\n            --,[Penalidade Abandono]\n            --,[Penalidade NPS]\n            --,[Penalidade Casos N\u00e3o Resolvidos]\n            --,[Penalidade Rechamada]\n            --,[Penalidade Short Call]\n            --,[Penalidade Instabilidade]\n            --,[Penalidade Phishing]\n\n            --,[PAs Contratadas]\n            --,[Valor da PA]\n            --,[Faturamento Antes das Penalidades]\n            --,[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,[Log]\n            ,[Log 102%]\n            ,[Log Perdido (>102%)]\n\t\t    ,[Log Produtivo]\n            ,[Log Produtivo 102%]\n            ,[Log Produtivo Perdido (>102%)]\n\t\t    ,[Log HE]\n\t\t    ,[Log descartado (>2HE)]\n\t\t    ,[Log Improdutivo]\n\t\t\t,[Tempo Total (Intelix)]\n\t\t\t,[Tempo Total (EPBX)]\n\t\t\t,[Tempo Total (Genesys)]\n\t\t\t,[Tempo Total (Secullum)]\n\t\t    ,[Tempo Livre]\n\t\t    ,[Pausa Particular (Intelix)]\n\t\t    ,[Pausa Break (Intelix)]\n\t\t    ,[Pausa 10 (Intelix)]\n\t\t    ,[Pausa Outbound (Intelix)]\n\t\t    ,[Pausa Lanche (Intelix)]\n\t\t    ,[Pausa R\u00e1pida (Intelix)]\n\t\t    ,[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,[Pausa Feedback (Intelix)]\n\t\t    ,[Pausa Sistema Interno (Intelix)]\n\t\t    ,[Pausa Sistema Externo (Intelix)]\n\t\t    ,[Pausa Treinamento (Intelix)]\n\t\t    ,[Pausa Banheiro (Intelix)]\n\t\t    ,[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,[Pausa NR17 (Intelix)]\n\t\t    ,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,[Pausa Tratativa (EPBX)]\n\t\t    ,[Pausa Discagem Manual (EPBX)]\n\t\t    ,[Pausa Banheiro (EPBX)]\n\t\t    ,[Pausa WhatsApp (EPBX)]\n\t\t    ,[Pausa Intervalo (EPBX)]\n\t\t    ,[Pausa Discagem Retorno (EPBX)]\n\t\t    ,[Pausa Treinamento (EPBX)]\n\t\t    ,[Pausa Feedback (EPBX)]\n\t\t    ,[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,[Pausa Login (EPBX)]\n\t\t    ,[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,[Pausa Sistema Interno (EPBX)]\n\t\t    ,[Pausa Sistema Externo (EPBX)]\n\t\t    ,[Pausa NR17 (EPBX)]\n\t\t    ,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,[Pausa Lanche (EPBX)]\n\t\t    ,[Pausa BackOffice (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,[Pausa Banheiro (Genesys)]\n\t \t    ,[Pausa Descanso (Genesys)]\n\t \t    ,[Pausa Feedback (Genesys)]\n\t \t    ,[Pausa Backoffice (Genesys)]\n\t \t    ,[Pausa Discagem Manual (Genesys)]\n\t \t    ,[Pausa Discagem Retorno (Genesys)]\n\t \t    ,[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,[Pausa Em Fila (Genesys)]\n\t \t    ,[Pausa Sistema Externo (Genesys)]\n\t \t    ,[Pausa Sistema Interno (Genesys)]\n\t \t    ,[Pausa Tratativa (Genesys)]\n\t \t    ,[Pausa Whatsapp (Genesys)]\n\t\t    ,[Pausa Treinamento (Genesys)]\n\n\t\t    ,[Criados]\n\t\t    ,[Tratados]\n\t\t    ,[Tempo Total de Tratativa]\n\t\t    ,[TMT]\n\t\t    ,[N\u00e3o Resolvidos]\n\t\t    ,[Replicas]\n\t\t    ,[Reincidentes 48h]\n\t\t    ,[Reincidentes 30d]\n\n            ,[SLA TPR]\n            ,[SLA TES]\n            ,[SLA TTR]\n\n\t\t    ,[Inbound - Chamadas Iniciadas]\n\t\t    ,[Inbound - Chamadas Atendidas]\n\t\t    ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Inbound - Chamadas Em Andamento]\n\t\t    ,[Inbound - Chamadas Finalizadas]\n\t\t    ,[Inbound - Chamadas Transferidas]\n\t\t    ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Inbound - Atendimentos Iniciados]\n\t\t    ,[Inbound - Atendimentos Em Andamento]\n\t\t    ,[Inbound - Atendimentos Finalizados]\n\t\t    ,[Inbound - TMC]\n\t\t    ,[Inbound - TMA]\n\t\t    ,[Inbound - TME]\n\t\t    ,[Inbound - TMO]\n\t\t    ,[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Inbound - Chamadas Abandonadas]\n\t\t    ,[Inbound - % Abandono]\n\n\t\t    ,[Outbound - Chamadas Iniciadas]\n\t\t    ,[Outbound - Chamadas Atendidas]\n\t\t    ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Outbound - Chamadas Em Andamento]\n\t\t    ,[Outbound - Chamadas Finalizadas]\n\t\t    ,[Outbound - Chamadas Transferidas]\n\t\t    ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Outbound - Atendimentos Iniciados]\n\t\t    ,[Outbound - Atendimentos Em Andamento]\n\t\t    ,[Outbound - Atendimentos Finalizados]\n\t\t    ,[Outbound - TMC]\n\t\t    ,[Outbound - TMA]\n\t\t    ,[Outbound - TME]\n\t\t    ,[Outbound - TMO]\n\t\t    ,[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Outbound - Chamadas Abandonadas]\n\t\t    ,[Outbound - % Abandono]\n\n\t\t    ,[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,[Promotoras]\n\t\t    ,[Neutras]\n\t\t    ,[Detratoras]\n            --,[NPS]\n\n            ,[Genesys Provis\u00f3rio - Oferta]\n            ,[Genesys Provis\u00f3rio - Resposta]\n            ,[Genesys Provis\u00f3rio - Em Espera]\n            ,[Genesys Provis\u00f3rio - Transferir]\n            ,[Genesys Provis\u00f3rio - Abandono]\n            ,[Genesys Provis\u00f3rio - % Resposta]\n            ,[Genesys Provis\u00f3rio - % Abandono]\n            ,[Genesys Provis\u00f3rio - % NS]\n            ,[Genesys Provis\u00f3rio - % Alvos do NS]\n            ,[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]\n            ,[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)]\n            ,[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]\n            ,[Genesys Provis\u00f3rio - VMA]\n            ,[Genesys Provis\u00f3rio - TPC]\n\n\t\t    ,[Teve Evento de MOP?]\n\t\t    ,[Teve Evento de Tickets?]\n\t\t    ,[Teve Evento de Chamadas?]\n\t\t    ,[Teve Evento de NPS?]\n\t\t    ,[Teve Evento de Log?]\n\t\t    ,[Teve Evento de Forecast?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n\t\t     fonte.[DataHora]\n\t\t    ,fonte.[Intervalo]\n\t\t    ,fonte.[Data]\n\t\t    ,fonte.[Ciclo (Primeiro Dia)]\n\t\t    ,fonte.[M\u00eas (Primeiro Dia)]\n\n            ,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n\t\t    ,fonte.[Cliente]\n\t\t    ,fonte.[Projeto]\n\t\t    ,fonte.[Tribo]\n\t\t    ,fonte.[Tribo Completa]\n\n\t\t    ,fonte.[Trabalhado (Ponto)]\n\t\t    ,fonte.[Em Pausa (Ponto)]\n\t\t\t,fonte.[Desvio Ponto-Log]\n\n            ,fonte.[Forecast HC Taxa 1]\n            ,fonte.[Forecast HC Taxa 2]\n            ,fonte.[Forecast Pausas Taxa 1]\n            ,fonte.[Forecast Pausas Taxa 2]\n            ,fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Volume]\n            --,fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,fonte.[Forecast Log]\n            ,fonte.[Forecast Log Produtivo]\n            ,fonte.[Forecast NS]\n            --,fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,fonte.[Forecast TMT]\n            ,fonte.[Forecast TMA]\n            ,fonte.[Forecast SLA]\n            ,fonte.[Forecast Abandono]\n            ,fonte.[Forecast NPS]\n            ,fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,fonte.[Forecast Rechamada]\n            ,fonte.[Forecast Short Call]\n            ,fonte.[Forecast Instabilidade]\n            ,fonte.[Forecast Phishing]\n\n            ,fonte.[Ader\u00eancia Log]\n            ,fonte.[Ader\u00eancia Log 102%]\n            ,fonte.[Ader\u00eancia Log Produtivo]\n            ,fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,fonte.[Ader\u00eancia TMT]\n            ,fonte.[Ader\u00eancia TMA]\n            ,fonte.[Ader\u00eancia SLA]\n            ,fonte.[Ader\u00eancia NS]\n            ,fonte.[Ader\u00eancia Abandono]\n            --,fonte.[Ader\u00eancia NPS]\n            ,fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,fonte.[Ader\u00eancia Rechamada]\n            --,fonte.[Ader\u00eancia Short Call]\n            --,fonte.[Ader\u00eancia Instabilidade]\n            --,fonte.[Ader\u00eancia Phishing]\n\n            --,fonte.[Penalidade TMT]\n            --,fonte.[Penalidade TMA]\n            --,fonte.[Penalidade SLA]\n            --,fonte.[Penalidade NS]\n            --,fonte.[Penalidade Abandono]\n            --,fonte.[Penalidade NPS]\n            --,fonte.[Penalidade Casos N\u00e3o Resolvidos]\n            --,fonte.[Penalidade Rechamada]\n            --,fonte.[Penalidade Short Call]\n            --,fonte.[Penalidade Instabilidade]\n            --,fonte.[Penalidade Phishing]\n\n            --,fonte.[PAs Contratadas]\n            --,fonte.[Valor da PA]\n            --,fonte.[Faturamento Antes das Penalidades]\n            --,fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,fonte.[Log]\n            ,fonte.[Log 102%]\n            ,fonte.[Log Perdido (>102%)]\n\t\t    ,fonte.[Log Produtivo]\n            ,fonte.[Log Produtivo 102%]\n            ,fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,fonte.[Log HE]\n\t\t    ,fonte.[Log descartado (>2HE)]\n\t\t    ,fonte.[Log Improdutivo]\n\t\t\t,fonte.[Tempo Total (Intelix)]\n\t\t\t,fonte.[Tempo Total (EPBX)]\n\t\t\t,fonte.[Tempo Total (Genesys)]\n\t\t\t,fonte.[Tempo Total (Secullum)]\n\t\t    ,fonte.[Tempo Livre]\n\t\t    ,fonte.[Pausa Particular (Intelix)]\n\t\t    ,fonte.[Pausa Break (Intelix)]\n\t\t    ,fonte.[Pausa 10 (Intelix)]\n\t\t    ,fonte.[Pausa Outbound (Intelix)]\n\t\t    ,fonte.[Pausa Lanche (Intelix)]\n\t\t    ,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,fonte.[Pausa Feedback (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,fonte.[Pausa NR17 (Intelix)]\n\t\t    ,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,fonte.[Pausa Feedback (EPBX)]\n\t\t    ,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,fonte.[Pausa Login (EPBX)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,fonte.[Pausa NR17 (EPBX)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,fonte.[Pausa Lanche (EPBX)]\n\t\t    ,fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,fonte.[Pausa Descanso (Genesys)]\n\t \t    ,fonte.[Pausa Feedback (Genesys)]\n\t \t    ,fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,fonte.[Criados]\n\t\t    ,fonte.[Tratados]\n\t\t    ,fonte.[Tempo Total de Tratativa]\n\t\t    ,fonte.[TMT]\n\t\t    ,fonte.[N\u00e3o Resolvidos]\n\t\t    ,fonte.[Replicas]\n\t\t    ,fonte.[Reincidentes 48h]\n\t\t    ,fonte.[Reincidentes 30d]\n\n            ,fonte.[SLA TPR]\n            ,fonte.[SLA TES]\n            ,fonte.[SLA TTR]\n\n\t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Inbound - TMC]\n\t\t    ,fonte.[Inbound - TMA]\n\t\t    ,fonte.[Inbound - TME]\n\t\t    ,fonte.[Inbound - TMO]\n\t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Inbound - % Abandono]\n\n\t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Outbound - TMC]\n\t\t    ,fonte.[Outbound - TMA]\n\t\t    ,fonte.[Outbound - TME]\n\t\t    ,fonte.[Outbound - TMO]\n\t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Outbound - % Abandono]\n\n\t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,fonte.[Promotoras]\n\t\t    ,fonte.[Neutras]\n\t\t    ,fonte.[Detratoras]\n            --,fonte.[NPS]\n\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Oferta],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Resposta],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Em Espera],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Transferir],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Abandono],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - % Resposta],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - % Abandono],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - % NS],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - % Alvos do NS],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - VMA],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - TPC],0)\n\n\t\t    ,fonte.[Teve Evento de MOP?]\n\t\t    ,fonte.[Teve Evento de Tickets?]\n\t\t    ,fonte.[Teve Evento de Chamadas?]\n\t\t    ,fonte.[Teve Evento de NPS?]\n\t\t    ,fonte.[Teve Evento de Log?]\n\t\t    ,fonte.[Teve Evento de Forecast?]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n\t\t     destino.[DataHora]                                                                          = fonte.[DataHora]\n\t\t    ,destino.[Intervalo]                                                                         = fonte.[Intervalo]\n\t\t    ,destino.[Data]                                                                              = fonte.[Data]\n\t\t    ,destino.[Ciclo (Primeiro Dia)]                                                              = fonte.[Ciclo (Primeiro Dia)]\n\t\t    ,destino.[M\u00eas (Primeiro Dia)]                                                                = fonte.[M\u00eas (Primeiro Dia)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n\t\t    ,destino.[Cliente]                                                                           = fonte.[Cliente]\n\t\t    ,destino.[Projeto]                                                                           = fonte.[Projeto]\n\t\t    ,destino.[Tribo]                                                                             = fonte.[Tribo]\n\t\t    ,destino.[Tribo Completa]                                                                    = fonte.[Tribo Completa]\n\n\t\t    ,destino.[Trabalhado (Ponto)]                                                                = fonte.[Trabalhado (Ponto)]\n\t\t    ,destino.[Em Pausa (Ponto)]                                                                  = fonte.[Em Pausa (Ponto)]\n\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Desvio Ponto-Log]\n\n            ,destino.[Forecast HC Taxa 1]                                                                = fonte.[Forecast HC Taxa 1]\n            ,destino.[Forecast HC Taxa 2]                                                                = fonte.[Forecast HC Taxa 2]\n            ,destino.[Forecast Pausas Taxa 1]                                                            = fonte.[Forecast Pausas Taxa 1]\n            ,destino.[Forecast Pausas Taxa 2]                                                            = fonte.[Forecast Pausas Taxa 2]\n            ,destino.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                                          = fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                                      = fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]                                            = fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Volume]                                                                   = fonte.[Forecast Volume]\n            --,destino.[Forecast Volume M\u00eas - Provis\u00f3rio]                                                  = fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,destino.[Forecast Log]                                                                      = fonte.[Forecast Log]\n            ,destino.[Forecast Log Produtivo]                                                            = fonte.[Forecast Log Produtivo]\n            ,destino.[Forecast NS]                                                                       = fonte.[Forecast NS]\n            --,destino.[Forecast NS M\u00eas - Provis\u00f3rio]                                                      = fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,destino.[Forecast TMT]                                                                      = fonte.[Forecast TMT]\n            ,destino.[Forecast TMA]                                                                      = fonte.[Forecast TMA]\n            ,destino.[Forecast SLA]                                                                      = fonte.[Forecast SLA]\n            ,destino.[Forecast Abandono]                                                                 = fonte.[Forecast Abandono]\n            ,destino.[Forecast NPS]                                                                      = fonte.[Forecast NPS]\n            ,destino.[Forecast Casos N\u00e3o Resolvidos]                                                     = fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,destino.[Forecast Rechamada]                                                                = fonte.[Forecast Rechamada]\n            ,destino.[Forecast Short Call]                                                               = fonte.[Forecast Short Call]\n            ,destino.[Forecast Instabilidade]                                                            = fonte.[Forecast Instabilidade]\n            ,destino.[Forecast Phishing]                                                                 = fonte.[Forecast Phishing]\n\n            ,destino.[Ader\u00eancia Log]                                                                     = fonte.[Ader\u00eancia Log]\n            ,destino.[Ader\u00eancia Log 102%]                                                                = fonte.[Ader\u00eancia Log 102%]\n            ,destino.[Ader\u00eancia Log Produtivo]                                                           = fonte.[Ader\u00eancia Log Produtivo]\n            ,destino.[Ader\u00eancia Log Produtivo 102%]                                                      = fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,destino.[Ader\u00eancia TMT]                                                                     = fonte.[Ader\u00eancia TMT]\n            ,destino.[Ader\u00eancia TMA]                                                                     = fonte.[Ader\u00eancia TMA]\n            ,destino.[Ader\u00eancia SLA]                                                                     = fonte.[Ader\u00eancia SLA]\n            ,destino.[Ader\u00eancia NS]                                                                      = fonte.[Ader\u00eancia NS]\n            ,destino.[Ader\u00eancia Abandono]                                                                = fonte.[Ader\u00eancia Abandono]\n            --,destino.[Ader\u00eancia NPS]                                                                     = fonte.[Ader\u00eancia NPS]\n            ,destino.[Ader\u00eancia Casos N\u00e3o Resolvidos]                                                    = fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,destino.[Ader\u00eancia Rechamada]                                                               = fonte.[Ader\u00eancia Rechamada]\n            --,destino.[Ader\u00eancia Short Call]                                                              = fonte.[Ader\u00eancia Short Call]\n            --,destino.[Ader\u00eancia Instabilidade]                                                           = fonte.[Ader\u00eancia Instabilidade]\n            --,destino.[Ader\u00eancia Phishing]                                                                = fonte.[Ader\u00eancia Phishing]\n\n            --,destino.[Penalidade TMT]                                                                    = fonte.[Penalidade TMT]\n            --,destino.[Penalidade TMA]                                                                    = fonte.[Penalidade TMA]\n            --,destino.[Penalidade SLA]                                                                    = fonte.[Penalidade SLA]\n            --,destino.[Penalidade NS]                                                                     = fonte.[Penalidade NS]\n            --,destino.[Penalidade Abandono]                                                               = fonte.[Penalidade Abandono]\n            --,destino.[Penalidade NPS]                                                                    = fonte.[Penalidade NPS]\n            --,destino.[Penalidade Casos N\u00e3o Resolvidos]                                                   = fonte.[Penalidade Casos N\u00e3o Resolvidos]\n            --,destino.[Penalidade Rechamada]                                                              = fonte.[Penalidade Rechamada]\n            --,destino.[Penalidade Short Call]                                                             = fonte.[Penalidade Short Call]\n            --,destino.[Penalidade Instabilidade]                                                          = fonte.[Penalidade Instabilidade]\n            --,destino.[Penalidade Phishing]                                                               = fonte.[Penalidade Phishing]\n\n            --,destino.[PAs Contratadas]                                                                   = fonte.[PAs Contratadas]\n            --,destino.[Valor da PA]                                                                       = fonte.[Valor da PA]\n            --,destino.[Faturamento Antes das Penalidades]                                                 = fonte.[Faturamento Antes das Penalidades]\n            --,destino.[Faturamento Ap\u00f3s Penalidades]                                                      = fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,destino.[Log]                                                                               = fonte.[Log]\n            ,destino.[Log 102%]                                                                          = fonte.[Log 102%]\n            ,destino.[Log Perdido (>102%)]                                                               = fonte.[Log Perdido (>102%)]\n\t\t    ,destino.[Log Produtivo]                                                                     = fonte.[Log Produtivo]\n            ,destino.[Log Produtivo 102%]                                                                = fonte.[Log Produtivo 102%]\n            ,destino.[Log Produtivo Perdido (>102%)]                                                     = fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,destino.[Log HE]                                                                            = fonte.[Log HE]\n\t\t    ,destino.[Log descartado (>2HE)]                                                             = fonte.[Log descartado (>2HE)]\n\t\t    ,destino.[Log Improdutivo]                                                                   = fonte.[Log Improdutivo]\n\t\t\t,destino.[Tempo Total (Intelix)]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Tempo Total (Intelix)]\n\t\t\t,destino.[Tempo Total (EPBX)]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Tempo Total (EPBX)]\n\t\t\t,destino.[Tempo Total (Genesys)]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Tempo Total (Genesys)]\n\t\t\t,destino.[Tempo Total (Secullum)]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Tempo Total (Secullum)]\n\t\t    ,destino.[Tempo Livre]                                                                       = fonte.[Tempo Livre]\n\t\t    ,destino.[Pausa Particular (Intelix)]                                                        = fonte.[Pausa Particular (Intelix)]\n\t\t    ,destino.[Pausa Break (Intelix)]                                                             = fonte.[Pausa Break (Intelix)]\n\t\t    ,destino.[Pausa 10 (Intelix)]                                                                = fonte.[Pausa 10 (Intelix)]\n\t\t    ,destino.[Pausa Outbound (Intelix)]                                                          = fonte.[Pausa Outbound (Intelix)]\n\t\t    ,destino.[Pausa Lanche (Intelix)]                                                            = fonte.[Pausa Lanche (Intelix)]\n\t\t    ,destino.[Pausa R\u00e1pida (Intelix)]                                                            = fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Intelix)]                                                            = fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,destino.[Pausa Feedback (Intelix)]                                                          = fonte.[Pausa Feedback (Intelix)]\n\t\t    ,destino.[Pausa Sistema Interno (Intelix)]                                                   = fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,destino.[Pausa Sistema Externo (Intelix)]                                                   = fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,destino.[Pausa Treinamento (Intelix)]                                                       = fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,destino.[Pausa Banheiro (Intelix)]                                                          = fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (Intelix)]                                                           = fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Intelix)]                                                       = fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,destino.[Pausa NR17 (Intelix)]                                                              = fonte.[Pausa NR17 (Intelix)]\n\t\t    ,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]                                                              = fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (EPBX)]                                                               = fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,destino.[Pausa Tratativa (EPBX)]                                                            = fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,destino.[Pausa Discagem Manual (EPBX)]                                                      = fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,destino.[Pausa Banheiro (EPBX)]                                                             = fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,destino.[Pausa WhatsApp (EPBX)]                                                             = fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,destino.[Pausa Intervalo (EPBX)]                                                            = fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,destino.[Pausa Discagem Retorno (EPBX)]                                                     = fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,destino.[Pausa Treinamento (EPBX)]                                                          = fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,destino.[Pausa Feedback (EPBX)]                                                             = fonte.[Pausa Feedback (EPBX)]\n\t\t    ,destino.[Pausa Transfer\u00eancia (EPBX)]                                                        = fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,destino.[Pausa N\u00e3o Disponivel (EPBX)]                                                       = fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,destino.[Pausa Login (EPBX)]                                                                = fonte.[Pausa Login (EPBX)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (EPBX)]                                                              = fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Sistema Interno (EPBX)]                                                      = fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,destino.[Pausa Sistema Externo (EPBX)]                                                      = fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,destino.[Pausa NR17 (EPBX)]                                                                 = fonte.[Pausa NR17 (EPBX)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (EPBX)]                                                          = fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,destino.[Pausa P\u00f3s Atendimento (EPBX)]                                                      = fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,destino.[Pausa Lanche (EPBX)]                                                               = fonte.[Pausa Lanche (EPBX)]\n\t\t    ,destino.[Pausa BackOffice (EPBX)]                                                           = fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Genesys)]                                                            = fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Genesys)]                                                       = fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,destino.[Pausa Banheiro (Genesys)]                                                          = fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,destino.[Pausa Descanso (Genesys)]                                                          = fonte.[Pausa Descanso (Genesys)]\n\t \t    ,destino.[Pausa Feedback (Genesys)]                                                          = fonte.[Pausa Feedback (Genesys)]\n\t \t    ,destino.[Pausa Backoffice (Genesys)]                                                        = fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,destino.[Pausa Discagem Manual (Genesys)]                                                   = fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,destino.[Pausa Discagem Retorno (Genesys)]                                                  = fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,destino.[Pausa Dispon\u00edvel (Genesys)]                                                        = fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,destino.[Pausa Em Fila (Genesys)]                                                           = fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,destino.[Pausa Sistema Externo (Genesys)]                                                   = fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,destino.[Pausa Sistema Interno (Genesys)]                                                   = fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,destino.[Pausa Tratativa (Genesys)]                                                         = fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,destino.[Pausa Whatsapp (Genesys)]                                                          = fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,destino.[Pausa Treinamento (Genesys)]                                                       = fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,destino.[Criados]                                                                           = fonte.[Criados]\n\t\t    ,destino.[Tratados]                                                                          = fonte.[Tratados]\n\t\t    ,destino.[Tempo Total de Tratativa]                                                          = fonte.[Tempo Total de Tratativa]\n\t\t    ,destino.[TMT]                                                                               = fonte.[TMT]\n\t\t    ,destino.[N\u00e3o Resolvidos]                                                                    = fonte.[N\u00e3o Resolvidos]\n\t\t    ,destino.[Replicas]                                                                          = fonte.[Replicas]\n\t\t    ,destino.[Reincidentes 48h]                                                                  = fonte.[Reincidentes 48h]\n\t\t    ,destino.[Reincidentes 30d]                                                                  = fonte.[Reincidentes 30d]\n\n            ,destino.[SLA TPR]                                                                           = fonte.[SLA TPR]\n            ,destino.[SLA TES]                                                                           = fonte.[SLA TES]\n            ,destino.[SLA TTR]                                                                           = fonte.[SLA TTR]\n\n\t\t    ,destino.[Inbound - Chamadas Iniciadas]                                                      = fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas]                                                      = fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]                                           = fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Inbound - Chamadas Em Andamento]                                                   = fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,destino.[Inbound - Chamadas Finalizadas]                                                    = fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,destino.[Inbound - Chamadas Transferidas]                                                   = fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]                            = fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]                        = fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]                             = fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]                       = fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]                                      = fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]                                  = fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]                                       = fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]                                 = fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Atendimentos Iniciados]                                                  = fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,destino.[Inbound - Atendimentos Em Andamento]                                               = fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Inbound - Atendimentos Finalizados]                                                = fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,destino.[Inbound - TMC]                                                                     = fonte.[Inbound - TMC]\n\t\t    ,destino.[Inbound - TMA]                                                                     = fonte.[Inbound - TMA]\n\t\t    ,destino.[Inbound - TME]                                                                     = fonte.[Inbound - TME]\n\t\t    ,destino.[Inbound - TMO]                                                                     = fonte.[Inbound - TMO]\n\t\t    ,destino.[Inbound - % Nivel de Servi\u00e7o]                                                      = fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Inbound - Chamadas Abandonadas]                                                    = fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,destino.[Inbound - % Abandono]                                                              = fonte.[Inbound - % Abandono]\n\n\t\t    ,destino.[Outbound - Chamadas Iniciadas]                                                     = fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas]                                                     = fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]                                          = fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Outbound - Chamadas Em Andamento]                                                  = fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,destino.[Outbound - Chamadas Finalizadas]                                                   = fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,destino.[Outbound - Chamadas Transferidas]                                                  = fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]                           = fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]                       = fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]                            = fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]                      = fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]                                     = fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]                                 = fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]                                      = fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]                                = fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Atendimentos Iniciados]                                                 = fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,destino.[Outbound - Atendimentos Em Andamento]                                              = fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Outbound - Atendimentos Finalizados]                                               = fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,destino.[Outbound - TMC]                                                                    = fonte.[Outbound - TMC]\n\t\t    ,destino.[Outbound - TMA]                                                                    = fonte.[Outbound - TMA]\n\t\t    ,destino.[Outbound - TME]                                                                    = fonte.[Outbound - TME]\n\t\t    ,destino.[Outbound - TMO]                                                                    = fonte.[Outbound - TMO]\n\t\t    ,destino.[Outbound - % Nivel de Servi\u00e7o]                                                     = fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Outbound - Chamadas Abandonadas]                                                   = fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,destino.[Outbound - % Abandono]                                                             = fonte.[Outbound - % Abandono]\n\n\t\t    ,destino.[Avalia\u00e7\u00f5es de NPS]                                                                 = fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,destino.[Promotoras]                                                                        = fonte.[Promotoras]\n\t\t    ,destino.[Neutras]                                                                           = fonte.[Neutras]\n\t\t    ,destino.[Detratoras]                                                                        = fonte.[Detratoras]\n            --,destino.[NPS]                                                                               = fonte.[NPS]\n\n            ,destino.[Genesys Provis\u00f3rio - Oferta]                                                       = ISNULL(fonte.[Genesys Provis\u00f3rio - Oferta],0)\n            ,destino.[Genesys Provis\u00f3rio - Resposta]                                                     = ISNULL(fonte.[Genesys Provis\u00f3rio - Resposta],0)\n            ,destino.[Genesys Provis\u00f3rio - Em Espera]                                                    = ISNULL(fonte.[Genesys Provis\u00f3rio - Em Espera],0)\n            ,destino.[Genesys Provis\u00f3rio - Transferir]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - Transferir],0)\n            ,destino.[Genesys Provis\u00f3rio - Abandono]                                                     = ISNULL(fonte.[Genesys Provis\u00f3rio - Abandono],0)\n            ,destino.[Genesys Provis\u00f3rio - % Resposta]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - % Resposta],0)\n            ,destino.[Genesys Provis\u00f3rio - % Abandono]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - % Abandono],0)\n            ,destino.[Genesys Provis\u00f3rio - % NS]                                                         = ISNULL(fonte.[Genesys Provis\u00f3rio - % NS],0)\n            ,destino.[Genesys Provis\u00f3rio - % Alvos do NS]                                                = ISNULL(fonte.[Genesys Provis\u00f3rio - % Alvos do NS],0)\n            ,destino.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]                                      = ISNULL(fonte.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)],0)\n            ,destino.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)]                                  = ISNULL(fonte.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)],0)\n            ,destino.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]                                       = ISNULL(fonte.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)],0)\n            ,destino.[Genesys Provis\u00f3rio - VMA]                                                          = ISNULL(fonte.[Genesys Provis\u00f3rio - VMA],0)\n            ,destino.[Genesys Provis\u00f3rio - TPC]                                                          = ISNULL(fonte.[Genesys Provis\u00f3rio - TPC],0)\n\n\t\t    ,destino.[Teve Evento de MOP?]                                                               = fonte.[Teve Evento de MOP?]\n\t\t    ,destino.[Teve Evento de Tickets?]                                                           = fonte.[Teve Evento de Tickets?]\n\t\t    ,destino.[Teve Evento de Chamadas?]                                                          = fonte.[Teve Evento de Chamadas?]\n\t\t    ,destino.[Teve Evento de NPS?]                                                               = fonte.[Teve Evento de NPS?]\n\t\t    ,destino.[Teve Evento de Log?]                                                               = fonte.[Teve Evento de Log?]\n\t\t    ,destino.[Teve Evento de Forecast?]                                                          = fonte.[Teve Evento de Forecast?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_tribo_30min\n        WHERE [Data] >= CAST(GETDATE() AS DATE)\n\t\t\tOR(\t[Teve Evento de MOP?]\t    = 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0)\n\n        UPDATE r_tribo_30min\n        SET\n             [Intervalo]            = CAST([DataHora] AS TIME)\n            ,[Data]                 = CAST([DataHora] AS DATE)\n            ,[Ciclo (Primeiro Dia)] = DATEADD(DAY, (CASE WHEN (DATEPART(DAY, [DataHora]) > 21) THEN 4 ELSE ((DATEPART(DAY, [DataHora])-1)/7)+1 END-1)*7, DATEFROMPARTS(YEAR([DataHora]), MONTH([DataHora]), 1))\n            ,[M\u00eas (Primeiro Dia)]   = DATEFROMPARTS(YEAR([DataHora]), MONTH([DataHora]), 1)\n            ,[Cliente]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),3)\n            ,[Projeto]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),2)\n            ,[Tribo]\t\t\t       = PARSENAME(REPLACE([Tribo Completa],'__','.'),1)\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n    IF 1=1 BEGIN; PRINT '--- agrupamento tribo_dia';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_tribo_dia]\n    \t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n    \t\tAND\t  [Data] <= CAST(@datahora_fim    AS DATE)\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n            SELECT\n                 [Ader\u00eancia Log 102%]               =   [Log 102%] / NULLIF([Forecast Log],0)\n                ,[Ader\u00eancia Log Produtivo 102%]     =   [Log Produtivo 102%] / NULLIF([Forecast Log Produtivo],0)\n                ,[Log Perdido (>102%)]              =   [Log] - [Log 102%]\n                ,[Log Produtivo Perdido (>102%)]    =   [Log Produtivo] - [Log Produtivo 102%]\n                ,*\n            FROM (\n                SELECT\n                     [Ader\u00eancia Log]                    =   [Log] / NULLIF([Forecast Log],0)\n                    ,[Ader\u00eancia Log Produtivo]          =   [Log Produtivo] / NULLIF([Forecast Log Produtivo],0)\n                    ,[Log 102%]                         =   IIF([Log] > [Forecast Log] * 1.2, [Forecast Log] * 1.2, [Log])\n                    ,[Log Produtivo 102%]               =   IIF([Log Produtivo] > [Forecast Log Produtivo] * 1.2, [Forecast Log Produtivo] * 1.2, [Log Produtivo])\n                    ,[Ader\u00eancia TMT]                    =   [TMT] / NULLIF([Forecast TMT],0)\n                    ,[Ader\u00eancia TMA]                    =   COALESCE([Inbound - TMA], [Outbound - TMA]) / NULLIF([Forecast TMA],0)\n                    ,[Ader\u00eancia SLA]                    =   [SLA TPR] / NULLIF([Forecast SLA],0)\n                    ,[Ader\u00eancia NS]                     =   [Inbound - % Nivel de Servi\u00e7o] / NULLIF([Forecast NS],0)\n                    --,[Ader\u00eancia NPS]                    =   [NPS] / NULLIF([Forecast NPS],0)\n                    ,[Ader\u00eancia Abandono]               =   [Inbound - % Abandono] / NULLIF([Forecast Abandono],0)\n                    ,[Ader\u00eancia Casos N\u00e3o Resolvidos]   =   [N\u00e3o Resolvidos] / NULLIF([Forecast Casos N\u00e3o Resolvidos],0)\n                    ,*\n                FROM (\n                \tSELECT\n\n                        -- [DataHora]\t\t\t\t\t\t\t\t\t\t\t\t        =   COALESCE([DataHora], [f_DataHora])\n                        --,[Intervalo]\t\t\t\t\t\t\t\t\t\t\t        =   MIN([Intervalo])\n                         [Data]\t\t\t\t\t\t\t\t\t\t\t\t\t        =   [Data]\n                        ,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t\t\t\t        =   MIN([Ciclo (Primeiro Dia)])\n                        ,[M\u00eas (Primeiro Dia)]\t\t\t\t                            =   MIN([M\u00eas (Primeiro Dia)])\n\n                        ,[Feriado (Nome)]                                               =  MAX([Feriado (Nome)])\n\n       \t                ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(MAX([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t                ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(MAX([Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t                ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(MAX([Secullum - Servi\u00e7o Militar]                                   ),0)\n                        ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(MAX([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t                ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(MAX([Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t                ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(MAX([Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t                ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(MAX([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t                ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(MAX([Secullum - Licen\u00e7a Casamento]                                 ),0)\n                        ,[Secullum - INSS - Afastamento]                                    =   ISNULL(MAX([Secullum - INSS - Afastamento]                                ),0)\n                        ,[Secullum - Folga]                                                 =   ISNULL(MAX([Secullum - Folga]                                             ),0)\n                        ,[Secullum - F\u00e9rias]                                                =   ISNULL(MAX([Secullum - F\u00e9rias]                                            ),0)\n       \t                ,[Secullum - Feriado]                                               =   ISNULL(MAX([Secullum - Feriado]                                           ),0)\n       \t                ,[Secullum - Falta Justificada]                                     =   ISNULL(MAX([Secullum - Falta Justificada]                                 ),0)\n       \t                ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(MAX([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                        ,[Secullum - Falta Injustificada]                                   =   ISNULL(MAX([Secullum - Falta Injustificada]                               ),0)\n       \t                ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(MAX([Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t                ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(MAX([Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                        ,[Secullum - Desligue]                                              =   ISNULL(MAX([Secullum - Desligue]                                          ),0)\n       \t                ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(MAX([Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t                ,[Secullum - Compensando Horas]                                     =   ISNULL(MAX([Secullum - Compensando Horas]                                 ),0)\n       \t                ,[Secullum - Atestado]                                              =   ISNULL(MAX([Secullum - Atestado]                                          ),0)\n                        ,[Secullum - Abono]                                                 =   ISNULL(MAX([Secullum - Abono]                                             ),0)\n       \t                ,[Secullum - Abono Lactante]                                        =   ISNULL(MAX([Secullum - Abono Lactante]                                    ),0)\n       \t                ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(MAX([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t                ,[Faltas Justificadas]                                              =   ISNULL(MAX([Faltas Justificadas]                                          ),0)\n       \t                ,[Faltas Injustificadas]                                            =   ISNULL(MAX([Faltas Injustificadas]                                        ),0)\n\n                        ,[Cliente]\t\t\t\t\t\t\t                            =   MIN([Cliente])\n                        ,[Projeto]\t\t\t\t\t\t\t                            =   MIN([Projeto])\n                        ,[Tribo]\t\t\t\t\t\t\t                            =   MIN([Tribo])\n                        ,[Tribo Completa]\t\t\t\t\t                            =   [Tribo Completa]\n\n                        ,[Trabalhado (Ponto)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Trabalhado (Ponto)]),0)\n                        ,[Em Pausa (Ponto)]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Em Pausa (Ponto)]),0)\n\t\t\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Desvio Ponto-Log]),0)\n\n                        ,[Forecast HC Taxa 1]                                           =   MAX([Forecast HC Taxa 1])\n                        ,[Forecast HC Taxa 2]                                           =   MAX([Forecast HC Taxa 2]) * IIF(DATEPART(dw,[Data]) = 7 AND [Data] BETWEEN '01/02/2024' AND '01/01/2025' AND [Tribo Completa] <> 'Serasa__Digital__Chat', 1, 2)\n                        ,[Forecast Pausas Taxa 1]                                       =   MAX([Forecast Pausas Taxa 1])\n                        ,[Forecast Pausas Taxa 2]                                       =   MAX([Forecast Pausas Taxa 2])\n                        ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                     =   MAX([Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio])\n                        ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                 =   MAX([Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio])\n                        ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t                    =   MAX([Forecast PA Liquida (VOZ) - Provis\u00f3rio])\n                        ,[Forecast Volume]\t\t                                        =   SUM([Forecast Volume])\n                        --,[Forecast Volume M\u00eas - Provis\u00f3rio]                           =\n                        ,[Forecast Log]                                                 =   SUM([Forecast Log])\n                        ,[Forecast Log Produtivo]                                       =   SUM([Forecast Log Produtivo])\n                        ,[Forecast NS]                                                  =   MAX([Forecast NS])\n                        --,[Forecast NS M\u00eas - Provis\u00f3rio]                               =\n\n                        ,[Forecast TMT]                                                 =   MAX([Forecast TMT])\n                        ,[Forecast TMA]                                                 =   MAX([Forecast TMA])\n                        ,[Forecast SLA]                                                 =   MAX([Forecast SLA])\n                        ,[Forecast Abandono]                                            =   MAX([Forecast Abandono])\n                        ,[Forecast NPS]                                                 =   MAX([Forecast NPS])\n                        ,[Forecast Casos N\u00e3o Resolvidos]                                =   MAX([Forecast Casos N\u00e3o Resolvidos])\n                        ,[Forecast Rechamada]                                           =   MAX([Forecast Rechamada])\n                        ,[Forecast Short Call]                                          =   MAX([Forecast Short Call])\n                        ,[Forecast Instabilidade]                                       =   MAX([Forecast Instabilidade])\n                        ,[Forecast Phishing]                                            =   MAX([Forecast Phishing])\n\n                        --UP--,[Ader\u00eancia Log]                                          =\n                        --UP--,[Ader\u00eancia Log 102%]                                     =\n                        --UP--,[Ader\u00eancia Log Produtivo]                                =\n                        --UP--,[Ader\u00eancia Log Produtivo 102%]                           =\n                        --UP--,[Ader\u00eancia TMT]                                          =\n                        --UP--,[Ader\u00eancia TMA]                                          =\n                        --UP--,[Ader\u00eancia SLA]                                          =\n                        --UP--,[Ader\u00eancia NS]                                           =\n                        --UP--,[Ader\u00eancia Abandono]                                     =\n                        --UP--,[Ader\u00eancia NPS]                                          =\n                        --UP--,[Ader\u00eancia Casos N\u00e3o Resolvidos]                         =\n                        --,[Ader\u00eancia Rechamada]                                        =\n                        --,[Ader\u00eancia Short Call]                                       =\n                        --,[Ader\u00eancia Instabilidade]                                    =\n                        --,[Ader\u00eancia Phishing]                                         =\n\n                        --,[Penalidade TMT]                                             =\n                        --,[Penalidade TMA]                                             =\n                        --,[Penalidade SLA]                                             =\n                        --,[Penalidade NS]                                              =\n                        --,[Penalidade Abandono]                                        =\n                        --,[Penalidade NPS]                                             =\n                        --,[Penalidade Casos N\u00e3o Resolvidos]                            =\n                        --,[Penalidade Rechamada]                                       =\n                        --,[Penalidade Short Call]                                      =\n                        --,[Penalidade Instabilidade]                                   =\n                        --,[Penalidade Phishing]                                        =\n\n                        --,[PAs Contratadas]                                            =\n                        --,[Valor da PA]                                                =\n                        --,[Faturamento Antes das Penalidades]                          =\n                        --,[Faturamento Ap\u00f3s Penalidades]                               =\n\n                        ,[Log]\t\t\t\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log]),0)\n                        -- UP --,[Log 102%]\n                        -- UP --,[Log Perdido (>102%)]\n                        ,[Log Produtivo]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log Produtivo]),0)\n                        -- UP --,[Log Produtivo 102%]\n                        -- UP --,[Log Produtivo Perdido (>102%)]\n                        ,[Log HE]\t\t\t\t\t\t\t\t\t\t\t\t\t    =   ISNULL(SUM([Log HE]),0)\n                        ,[Log descartado (>2HE)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log descartado (>2HE)]),0)\n                        ,[Log Improdutivo]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log Improdutivo]),0)\n\t\t\t\t\t\t,[Tempo Total (Intelix)]\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Tempo Total (Intelix)]),0)\n\t\t\t\t\t\t,[Tempo Total (EPBX)]\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Tempo Total (EPBX)]),0)\n\t\t\t\t\t\t,[Tempo Total (Genesys)]\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Tempo Total (Genesys)]),0)\n\t\t\t\t\t\t,[Tempo Total (Secullum)]\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Tempo Total (Secullum)]),0)\n                        ,[Tempo Livre]\t\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Tempo Livre]),0)\n                        ,[Pausa Particular (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Particular (Intelix)]),0)\n                        ,[Pausa Break (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Break (Intelix)]),0)\n                        ,[Pausa 10 (Intelix)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa 10 (Intelix)]),0)\n                        ,[Pausa Outbound (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Outbound (Intelix)]),0)\n                        ,[Pausa Lanche (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Lanche (Intelix)]),0)\n                        ,[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa R\u00e1pida (Intelix)]),0)\n                        ,[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (Intelix)]),0)\n                        ,[Pausa Feedback (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (Intelix)]),0)\n                        ,[Pausa Sistema Interno (Intelix)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (Intelix)]),0)\n                        ,[Pausa Sistema Externo (Intelix)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (Intelix)]),0)\n                        ,[Pausa Treinamento (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (Intelix)]),0)\n                        ,[Pausa Banheiro (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (Intelix)]),0)\n                        ,[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Reuni\u00e3o (Intelix)]),0)\n                        ,[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (Intelix)]),0)\n                        ,[Pausa NR17 (Intelix)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa NR17 (Intelix)]),0)\n                        ,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Liga\u00e7\u00e3o (EPBX)]),0)\n                        ,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (EPBX)]),0)\n                        ,[Pausa Tratativa (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Tratativa (EPBX)]),0)\n                        ,[Pausa Discagem Manual (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Manual (EPBX)]),0)\n                        ,[Pausa Banheiro (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (EPBX)]),0)\n                        ,[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa WhatsApp (EPBX)]),0)\n                        ,[Pausa Intervalo (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Intervalo (EPBX)]),0)\n                        ,[Pausa Discagem Retorno (EPBX)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Retorno (EPBX)]),0)\n                        ,[Pausa Treinamento (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (EPBX)]),0)\n                        ,[Pausa Feedback (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (EPBX)]),0)\n                        ,[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Transfer\u00eancia (EPBX)]),0)\n                        ,[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa N\u00e3o Disponivel (EPBX)]),0)\n                        ,[Pausa Login (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Login (EPBX)]),0)\n                        ,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Reuni\u00e3o (EPBX)]),0)\n                        ,[Pausa Sistema Interno (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (EPBX)]),0)\n                        ,[Pausa Sistema Externo (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (EPBX)]),0)\n                        ,[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa NR17 (EPBX)]),0)\n                        ,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (EPBX)]),0)\n                        ,[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa P\u00f3s Atendimento (EPBX)]),0)\n                        ,[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Lanche (EPBX)]),0)\n                        ,[Pausa BackOffice (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa BackOffice (EPBX)]),0)\n                        ,[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (Genesys)]),0)\n                        ,[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (Genesys)]),0)\n                        ,[Pausa Banheiro (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (Genesys)]),0)\n                        ,[Pausa Descanso (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Descanso (Genesys)]),0)\n                        ,[Pausa Feedback (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (Genesys)]),0)\n                        ,[Pausa Backoffice (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Backoffice (Genesys)]),0)\n                        ,[Pausa Discagem Manual (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Manual (Genesys)]),0)\n                        ,[Pausa Discagem Retorno (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Retorno (Genesys)]),0)\n                        ,[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Dispon\u00edvel (Genesys)]),0)\n                        ,[Pausa Em Fila (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Em Fila (Genesys)]),0)\n                        ,[Pausa Sistema Externo (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (Genesys)]),0)\n                        ,[Pausa Sistema Interno (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (Genesys)]),0)\n                        ,[Pausa Tratativa (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Tratativa (Genesys)]),0)\n                        ,[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Whatsapp (Genesys)]),0)\n                        ,[Pausa Treinamento (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (Genesys)]),0)\n\n                        ,[Criados]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Criados]),0)\n                        ,[Tratados]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Tratados]),0)\n                        ,[Tempo Total de Tratativa]\t\t\t                            =   ISNULL(SUM([Tempo Total de Tratativa]),0)\n                        ,[TMT]\t\t\t\t\t\t\t\t                            =   ISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n                        ,[N\u00e3o Resolvidos]\t\t\t\t\t                            =   ISNULL(SUM([N\u00e3o Resolvidos]),0)\n                        ,[Replicas]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Replicas]),0)\n                        ,[Reincidentes 48h]\t\t\t\t\t                            =   ISNULL(SUM([Reincidentes 48h]),0)\n                        ,[Reincidentes 30d]\t\t\t\t\t                            =   ISNULL(SUM([Reincidentes 30d]),0)\n\n                        ,[SLA TPR]                                                      =   AVG([SLA TPR])\n                        ,[SLA TES]                                                      =   AVG([SLA TES])\n                        ,[SLA TTR]                                                      =   AVG([SLA TTR])\n\n                        ,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Iniciadas]),0)\n                        ,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas]),0)\n                        ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s]),0)\n                        ,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Em Andamento]),0)\n                        ,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Finalizadas]),0)\n                        ,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Transferidas]),0)\n                        ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=   ISNULL(SUM([Inbound - Tempo Em Chamada (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=   ISNULL(SUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=   ISNULL(SUM([Inbound - Tempo Em Espera (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=   ISNULL(SUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Chamada (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Atendimento (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Espera (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Encerramento (Neste Intervalo)]),0)\n                        ,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Iniciados]),0)\n                        ,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Em Andamento]),0)\n                        ,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Finalizados]),0)\n                        ,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n                        ,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n                        ,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n                        ,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n                        ,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n                        ,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Abandonadas]),0)\n                        ,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n                        ,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Iniciadas]),0)\n                        ,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas]),0)\n                        ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s]),0)\n                        ,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Em Andamento]),0)\n                        ,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Finalizadas]),0)\n                        ,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Transferidas]),0)\n                        ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=   ISNULL(SUM([Outbound - Tempo Em Chamada (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=   ISNULL(SUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=   ISNULL(SUM([Outbound - Tempo Em Espera (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=   ISNULL(SUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Chamada (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Atendimento (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Espera (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Encerramento (Neste Intervalo)]),0)\n                        ,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Iniciados]),0)\n                        ,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Em Andamento]),0)\n                        ,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Finalizados]),0)\n                        ,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n                        ,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n                        ,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n                        ,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n                        ,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n                        ,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Abandonadas]),0)\n                        ,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n                        ,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t                            =   ISNULL(SUM([Avalia\u00e7\u00f5es de NPS]),0)\n                        ,[Promotoras]\t\t\t\t\t\t                            =   ISNULL(SUM([Promotoras]),0)\n                        ,[Neutras]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Neutras]),0)\n                        ,[Detratoras]\t\t\t\t\t\t                            =   ISNULL(SUM([Detratoras]),0)\n                        ,[NPS]\t\t\t\t\t\t\t\t                            =   CAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n                        ,[Teve Evento de MOP?]\t\t                                    =   IIF(SUM([Teve Evento de MOP?])=0,0,1)\n                        ,[Teve Evento de Tickets?]\t                                    =   IIF(SUM([Teve Evento de Tickets?])=0,0,1)\n                        ,[Teve Evento de Chamadas?]\t                                    =   IIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n                        ,[Teve Evento de NPS?]\t\t                                    =   IIF(SUM([Teve Evento de NPS?])=0,0,1)\n                        ,[Teve Evento de Log?]\t\t                                    =   IIF(SUM([Teve Evento de Log?])=0,0,1)\n                        ,[Teve Evento de Forecast?]\t\t                                =   IIF(SUM([Teve Evento de Forecast?]) IS NULL,0,1)\n\n                \tFROM r_tribo_30min r\n                    --FULL OUTER JOIN (\n                    --    SELECT\n                    --     [m_Tribo]  = [tribo]\n                    --    ,[m_M\u00eas]    = [m\u00eas]\n                    --    ,[Forecast Volume M\u00eas - Provis\u00f3rio] = [volume_projetado] -- S\u00f3 pra valida\u00e7\u00e3o, pra ver se t\u00e1 batendo com a dim_forecast_30min\n                    --    ,[Forecast NS M\u00eas - Provis\u00f3rio] = [NS]\n                    --    ,[Forecast TMT] = IIF([tribo] in ('Central de Ajuda - Autentica\u00e7\u00e3o', 'Central de Ajuda - Produtos', 'Reclame Aqui', 'GOV', 'Self Setup', 'BackOffice', 'Chat', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                    --    ,[Forecast TMA] = IIF([tribo] in ('BackOffice', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                    --    ,[Forecast SLA] = [SLA]\n                    --    ,[Forecast Abandono] = [abandono]\n                    --    ,[Forecast NPS] = [NPS]\n                    --    ,[Forecast Casos N\u00e3o Resolvidos] = [casos_n\u00e3o_resolvidos]\n                    --    ,[Forecast Rechamada] = [rechamada]\n                    --    ,[Forecast Short Call] = [short_call]\n                    --    ,[Forecast Instabilidade] = [instabilidade]\n                    --    ,[Forecast Phishing] = [phishing]\n                    --    ,[PAs Contratadas] = [hc_tx1] + [hc_tx2]\n                    --    ,[Valor da PA] = [valor_pa]\n                    --    FROM (\n                    --        SELECT [n]=ROW_NUMBER() OVER (PARTITION BY [tribo], [m\u00eas] ORDER BY [data_recebimento]), *\n                    --        FROM [db_serasa_producao].[dbo].dim_forecast_metas\n                    --    ) _\n                    --    WHERE [n] = 1\n                    --) m\n                    --ON  r.[Tribo] = m.[m_tribo]\n                    --AND r.[M\u00eas (Primeiro Dia)] = m.[m_m\u00eas]\n\n                    --LEFT JOIN (\n                    --    SELECT\n                    --     [m_Tribo]  = [tribo_serasa]\n                    --    ,[m_Data]   = [data]\n                    --    ,[SLA TPR]  = AVG([primeira_resposta_s])\n                    --    ,[SLA TES]  = AVG([espera_solicitante_s])\n                    --    ,[SLA TTR]  = AVG([total_resolucao_s])\n                    --    FROM [db_serasa_producao].[dbo].dim_teste_sla\n                    --    GROUP BY [tribo_serasa], [data]\n                    --) s\n                    --ON  r.[Tribo] = s.[m_Tribo]\n                    --AND r.[Data] = s.[m_Data]\n\n                \tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n                \tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n                \tGROUP BY [Data], [Tribo Completa]\n                ) _\n            ) _\n    \t) AS fonte\n    \tON  fonte.[Data]  = destino.[Data]\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n\t\t    -- [DataHora]\n\t\t    --,[Intervalo]\n\t\t     [Data]\n\t\t    ,[Ciclo (Primeiro Dia)]\n\t\t    ,[M\u00eas (Primeiro Dia)]\n\n            ,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n\t\t    ,[Cliente]\n\t\t    ,[Projeto]\n\t\t    ,[Tribo]\n\t\t    ,[Tribo Completa]\n\n\t\t    ,[Trabalhado (Ponto)]\n\t\t    ,[Em Pausa (Ponto)]\n\t\t\t,[Desvio Ponto-Log]\n\n            ,[Forecast HC Taxa 1]\n            ,[Forecast HC Taxa 2]\n            ,[Forecast Pausas Taxa 1]\n            ,[Forecast Pausas Taxa 2]\n            ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,[Forecast Volume]\n            --,[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,[Forecast Log]\n            ,[Forecast Log Produtivo]\n            ,[Forecast NS]\n            --,[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,[Forecast TMT]\n            ,[Forecast TMA]\n            ,[Forecast SLA]\n            ,[Forecast Abandono]\n            ,[Forecast NPS]\n            ,[Forecast Casos N\u00e3o Resolvidos]\n            ,[Forecast Rechamada]\n            ,[Forecast Short Call]\n            ,[Forecast Instabilidade]\n            ,[Forecast Phishing]\n\n            ,[Ader\u00eancia Log]\n            ,[Ader\u00eancia Log 102%]\n            ,[Ader\u00eancia Log Produtivo]\n            ,[Ader\u00eancia Log Produtivo 102%]\n            ,[Ader\u00eancia TMT]\n            ,[Ader\u00eancia TMA]\n            ,[Ader\u00eancia SLA]\n            ,[Ader\u00eancia NS]\n            ,[Ader\u00eancia Abandono]\n            --,[Ader\u00eancia NPS]\n            ,[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,[Ader\u00eancia Rechamada]\n            --,[Ader\u00eancia Short Call]\n            --,[Ader\u00eancia Instabilidade]\n            --,[Ader\u00eancia Phishing]\n\n            --,[Penalidade TMT]\n            --,[Penalidade TMA]\n            --,[Penalidade SLA]\n            --,[Penalidade NS]\n            --,[Penalidade Abandono]\n            --,[Penalidade NPS]\n            --,[Penalidade Casos N\u00e3o Resolvidos]\n            --,[Penalidade Rechamada]\n            --,[Penalidade Short Call]\n            --,[Penalidade Instabilidade]\n            --,[Penalidade Phishing]\n\n            --,[PAs Contratadas]\n            --,[Valor da PA]\n            --,[Faturamento Antes das Penalidades]\n            --,[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,[Log]\n            ,[Log 102%]\n            ,[Log Perdido (>102%)]\n\t\t    ,[Log Produtivo]\n            ,[Log Produtivo 102%]\n            ,[Log Produtivo Perdido (>102%)]\n\t\t    ,[Log HE]\n\t\t    ,[Log descartado (>2HE)]\n\t\t    ,[Log Improdutivo]\n\t\t\t,[Tempo Total (Intelix)]\n\t\t\t,[Tempo Total (EPBX)]\n\t\t\t,[Tempo Total (Genesys)]\n\t\t\t,[Tempo Total (Secullum)]\n\t\t    ,[Tempo Livre]\n\t\t    ,[Pausa Particular (Intelix)]\n\t\t    ,[Pausa Break (Intelix)]\n\t\t    ,[Pausa 10 (Intelix)]\n\t\t    ,[Pausa Outbound (Intelix)]\n\t\t    ,[Pausa Lanche (Intelix)]\n\t\t    ,[Pausa R\u00e1pida (Intelix)]\n\t\t    ,[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,[Pausa Feedback (Intelix)]\n\t\t    ,[Pausa Sistema Interno (Intelix)]\n\t\t    ,[Pausa Sistema Externo (Intelix)]\n\t\t    ,[Pausa Treinamento (Intelix)]\n\t\t    ,[Pausa Banheiro (Intelix)]\n\t\t    ,[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,[Pausa NR17 (Intelix)]\n\t\t    ,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,[Pausa Tratativa (EPBX)]\n\t\t    ,[Pausa Discagem Manual (EPBX)]\n\t\t    ,[Pausa Banheiro (EPBX)]\n\t\t    ,[Pausa WhatsApp (EPBX)]\n\t\t    ,[Pausa Intervalo (EPBX)]\n\t\t    ,[Pausa Discagem Retorno (EPBX)]\n\t\t    ,[Pausa Treinamento (EPBX)]\n\t\t    ,[Pausa Feedback (EPBX)]\n\t\t    ,[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,[Pausa Login (EPBX)]\n\t\t    ,[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,[Pausa Sistema Interno (EPBX)]\n\t\t    ,[Pausa Sistema Externo (EPBX)]\n\t\t    ,[Pausa NR17 (EPBX)]\n\t\t    ,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,[Pausa Lanche (EPBX)]\n\t\t    ,[Pausa BackOffice (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,[Pausa Banheiro (Genesys)]\n\t \t    ,[Pausa Descanso (Genesys)]\n\t \t    ,[Pausa Feedback (Genesys)]\n\t \t    ,[Pausa Backoffice (Genesys)]\n\t \t    ,[Pausa Discagem Manual (Genesys)]\n\t \t    ,[Pausa Discagem Retorno (Genesys)]\n\t \t    ,[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,[Pausa Em Fila (Genesys)]\n\t \t    ,[Pausa Sistema Externo (Genesys)]\n\t \t    ,[Pausa Sistema Interno (Genesys)]\n\t \t    ,[Pausa Tratativa (Genesys)]\n\t \t    ,[Pausa Whatsapp (Genesys)]\n\t\t    ,[Pausa Treinamento (Genesys)]\n\n\t\t    ,[Criados]\n\t\t    ,[Tratados]\n\t\t    ,[Tempo Total de Tratativa]\n\t\t    ,[TMT]\n\t\t    ,[N\u00e3o Resolvidos]\n\t\t    ,[Replicas]\n\t\t    ,[Reincidentes 48h]\n\t\t    ,[Reincidentes 30d]\n\n            ,[SLA TPR]\n            ,[SLA TES]\n            ,[SLA TTR]\n\n\t\t    ,[Inbound - Chamadas Iniciadas]\n\t\t    ,[Inbound - Chamadas Atendidas]\n\t\t    ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Inbound - Chamadas Em Andamento]\n\t\t    ,[Inbound - Chamadas Finalizadas]\n\t\t    ,[Inbound - Chamadas Transferidas]\n\t\t    ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Inbound - Atendimentos Iniciados]\n\t\t    ,[Inbound - Atendimentos Em Andamento]\n\t\t    ,[Inbound - Atendimentos Finalizados]\n\t\t    ,[Inbound - TMC]\n\t\t    ,[Inbound - TMA]\n\t\t    ,[Inbound - TME]\n\t\t    ,[Inbound - TMO]\n\t\t    ,[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Inbound - Chamadas Abandonadas]\n\t\t    ,[Inbound - % Abandono]\n\n\t\t    ,[Outbound - Chamadas Iniciadas]\n\t\t    ,[Outbound - Chamadas Atendidas]\n\t\t    ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Outbound - Chamadas Em Andamento]\n\t\t    ,[Outbound - Chamadas Finalizadas]\n\t\t    ,[Outbound - Chamadas Transferidas]\n\t\t    ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Outbound - Atendimentos Iniciados]\n\t\t    ,[Outbound - Atendimentos Em Andamento]\n\t\t    ,[Outbound - Atendimentos Finalizados]\n\t\t    ,[Outbound - TMC]\n\t\t    ,[Outbound - TMA]\n\t\t    ,[Outbound - TME]\n\t\t    ,[Outbound - TMO]\n\t\t    ,[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Outbound - Chamadas Abandonadas]\n\t\t    ,[Outbound - % Abandono]\n\n\t\t    ,[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,[Promotoras]\n\t\t    ,[Neutras]\n\t\t    ,[Detratoras]\n            ,[NPS]\n\n            --,[Genesys Provis\u00f3rio - Oferta]\n            --,[Genesys Provis\u00f3rio - Resposta]\n            --,[Genesys Provis\u00f3rio - Em Espera]\n            --,[Genesys Provis\u00f3rio - Transferir]\n            --,[Genesys Provis\u00f3rio - Abandono]\n            --,[Genesys Provis\u00f3rio - % Resposta]\n            --,[Genesys Provis\u00f3rio - % Abandono]\n            --,[Genesys Provis\u00f3rio - % NS]\n            --,[Genesys Provis\u00f3rio - % Alvos do NS]\n            --,[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]\n            --,[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)]\n            --,[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]\n            --,[Genesys Provis\u00f3rio - VMA]\n            --,[Genesys Provis\u00f3rio - TPC]\n\n\t\t    ,[Teve Evento de MOP?]\n\t\t    ,[Teve Evento de Tickets?]\n\t\t    ,[Teve Evento de Chamadas?]\n\t\t    ,[Teve Evento de NPS?]\n\t\t    ,[Teve Evento de Log?]\n\t\t    ,[Teve Evento de Forecast?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n\t\t    -- fonte.[DataHora]\n\t\t    --,fonte.[Intervalo]\n\t\t     fonte.[Data]\n\t\t    ,fonte.[Ciclo (Primeiro Dia)]\n\t\t    ,fonte.[M\u00eas (Primeiro Dia)]\n\n            ,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n\t\t    ,fonte.[Cliente]\n\t\t    ,fonte.[Projeto]\n\t\t    ,fonte.[Tribo]\n\t\t    ,fonte.[Tribo Completa]\n\n\t\t    ,fonte.[Trabalhado (Ponto)]\n\t\t    ,fonte.[Em Pausa (Ponto)]\n\t\t\t,fonte.[Desvio Ponto-Log]\n\n            ,fonte.[Forecast HC Taxa 1]\n            ,fonte.[Forecast HC Taxa 2]\n            ,fonte.[Forecast Pausas Taxa 1]\n            ,fonte.[Forecast Pausas Taxa 2]\n            ,fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Volume]\n            --,fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,fonte.[Forecast Log]\n            ,fonte.[Forecast Log Produtivo]\n            ,fonte.[Forecast NS]\n            --,fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,fonte.[Forecast TMT]\n            ,fonte.[Forecast TMA]\n            ,fonte.[Forecast SLA]\n            ,fonte.[Forecast Abandono]\n            ,fonte.[Forecast NPS]\n            ,fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,fonte.[Forecast Rechamada]\n            ,fonte.[Forecast Short Call]\n            ,fonte.[Forecast Instabilidade]\n            ,fonte.[Forecast Phishing]\n\n            ,fonte.[Ader\u00eancia Log]\n            ,fonte.[Ader\u00eancia Log 102%]\n            ,fonte.[Ader\u00eancia Log Produtivo]\n            ,fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,fonte.[Ader\u00eancia TMT]\n            ,fonte.[Ader\u00eancia TMA]\n            ,fonte.[Ader\u00eancia SLA]\n            ,fonte.[Ader\u00eancia NS]\n            ,fonte.[Ader\u00eancia Abandono]\n            --,fonte.[Ader\u00eancia NPS]\n            ,fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,fonte.[Ader\u00eancia Rechamada]\n            --,fonte.[Ader\u00eancia Short Call]\n            --,fonte.[Ader\u00eancia Instabilidade]\n            --,fonte.[Ader\u00eancia Phishing]\n\n            --,fonte.[Penalidade TMT]\n            --,fonte.[Penalidade TMA]\n            --,fonte.[Penalidade SLA]\n            --,fonte.[Penalidade NS]\n            --,fonte.[Penalidade Abandono]\n            --,fonte.[Penalidade NPS]\n            --,fonte.[Penalidade Casos N\u00e3o Resolvidos]\n            --,fonte.[Penalidade Rechamada]\n            --,fonte.[Penalidade Short Call]\n            --,fonte.[Penalidade Instabilidade]\n            --,fonte.[Penalidade Phishing]\n\n            --,fonte.[PAs Contratadas]\n            --,fonte.[Valor da PA]\n            --,fonte.[Faturamento Antes das Penalidades]\n            --,fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,fonte.[Log]\n            ,fonte.[Log 102%]\n            ,fonte.[Log Perdido (>102%)]\n\t\t    ,fonte.[Log Produtivo]\n            ,fonte.[Log Produtivo 102%]\n            ,fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,fonte.[Log HE]\n\t\t    ,fonte.[Log descartado (>2HE)]\n\t\t    ,fonte.[Log Improdutivo]\n\t\t\t,fonte.[Tempo Total (Intelix)]\n\t\t\t,fonte.[Tempo Total (EPBX)]\n\t\t\t,fonte.[Tempo Total (Genesys)]\n\t\t\t,fonte.[Tempo Total (Secullum)]\n\t\t    ,fonte.[Tempo Livre]\n\t\t    ,fonte.[Pausa Particular (Intelix)]\n\t\t    ,fonte.[Pausa Break (Intelix)]\n\t\t    ,fonte.[Pausa 10 (Intelix)]\n\t\t    ,fonte.[Pausa Outbound (Intelix)]\n\t\t    ,fonte.[Pausa Lanche (Intelix)]\n\t\t    ,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,fonte.[Pausa Feedback (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,fonte.[Pausa NR17 (Intelix)]\n\t\t    ,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,fonte.[Pausa Feedback (EPBX)]\n\t\t    ,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,fonte.[Pausa Login (EPBX)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,fonte.[Pausa NR17 (EPBX)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,fonte.[Pausa Lanche (EPBX)]\n\t\t    ,fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,fonte.[Pausa Descanso (Genesys)]\n\t \t    ,fonte.[Pausa Feedback (Genesys)]\n\t \t    ,fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,fonte.[Criados]\n\t\t    ,fonte.[Tratados]\n\t\t    ,fonte.[Tempo Total de Tratativa]\n\t\t    ,fonte.[TMT]\n\t\t    ,fonte.[N\u00e3o Resolvidos]\n\t\t    ,fonte.[Replicas]\n\t\t    ,fonte.[Reincidentes 48h]\n\t\t    ,fonte.[Reincidentes 30d]\n\n            ,fonte.[SLA TPR]\n            ,fonte.[SLA TES]\n            ,fonte.[SLA TTR]\n\n\t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Inbound - TMC]\n\t\t    ,fonte.[Inbound - TMA]\n\t\t    ,fonte.[Inbound - TME]\n\t\t    ,fonte.[Inbound - TMO]\n\t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Inbound - % Abandono]\n\n\t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Outbound - TMC]\n\t\t    ,fonte.[Outbound - TMA]\n\t\t    ,fonte.[Outbound - TME]\n\t\t    ,fonte.[Outbound - TMO]\n\t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Outbound - % Abandono]\n\n\t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,fonte.[Promotoras]\n\t\t    ,fonte.[Neutras]\n\t\t    ,fonte.[Detratoras]\n            ,fonte.[NPS]\n\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Oferta],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Resposta],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Em Espera],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Transferir],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Abandono],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - % Resposta],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - % Abandono],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - % NS],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - % Alvos do NS],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - VMA],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - TPC],0)\n\n\t\t    ,fonte.[Teve Evento de MOP?]\n\t\t    ,fonte.[Teve Evento de Tickets?]\n\t\t    ,fonte.[Teve Evento de Chamadas?]\n\t\t    ,fonte.[Teve Evento de NPS?]\n\t\t    ,fonte.[Teve Evento de Log?]\n\t\t    ,fonte.[Teve Evento de Forecast?]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n\t\t    -- destino.[DataHora]                                                                          = fonte.[DataHora]\n\t\t    --,destino.[Intervalo]                                                                         = fonte.[Intervalo]\n\t\t     destino.[Data]                                                                              = fonte.[Data]\n\t\t    ,destino.[Ciclo (Primeiro Dia)]                                                              = fonte.[Ciclo (Primeiro Dia)]\n\t\t    ,destino.[M\u00eas (Primeiro Dia)]                                                                = fonte.[M\u00eas (Primeiro Dia)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n\t\t    ,destino.[Cliente]                                                                           = fonte.[Cliente]\n\t\t    ,destino.[Projeto]                                                                           = fonte.[Projeto]\n\t\t    ,destino.[Tribo]                                                                             = fonte.[Tribo]\n\t\t    ,destino.[Tribo Completa]                                                                    = fonte.[Tribo Completa]\n\n\t\t    ,destino.[Trabalhado (Ponto)]                                                                = fonte.[Trabalhado (Ponto)]\n\t\t    ,destino.[Em Pausa (Ponto)]                                                                  = fonte.[Em Pausa (Ponto)]\n\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Desvio Ponto-Log]\n\n            ,destino.[Forecast HC Taxa 1]                                                                = fonte.[Forecast HC Taxa 1]\n            ,destino.[Forecast HC Taxa 2]                                                                = fonte.[Forecast HC Taxa 2]\n            ,destino.[Forecast Pausas Taxa 1]                                                            = fonte.[Forecast Pausas Taxa 1]\n            ,destino.[Forecast Pausas Taxa 2]                                                            = fonte.[Forecast Pausas Taxa 2]\n            ,destino.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                                          = fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                                      = fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]                                            = fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Volume]                                                                   = fonte.[Forecast Volume]\n            --,destino.[Forecast Volume M\u00eas - Provis\u00f3rio]                                                  = fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,destino.[Forecast Log]                                                                      = fonte.[Forecast Log]\n            ,destino.[Forecast Log Produtivo]                                                            = fonte.[Forecast Log Produtivo]\n            ,destino.[Forecast NS]                                                                       = fonte.[Forecast NS]\n            --,destino.[Forecast NS M\u00eas - Provis\u00f3rio]                                                      = fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,destino.[Forecast TMT]                                                                      = fonte.[Forecast TMT]\n            ,destino.[Forecast TMA]                                                                      = fonte.[Forecast TMA]\n            ,destino.[Forecast SLA]                                                                      = fonte.[Forecast SLA]\n            ,destino.[Forecast Abandono]                                                                 = fonte.[Forecast Abandono]\n            ,destino.[Forecast NPS]                                                                      = fonte.[Forecast NPS]\n            ,destino.[Forecast Casos N\u00e3o Resolvidos]                                                     = fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,destino.[Forecast Rechamada]                                                                = fonte.[Forecast Rechamada]\n            ,destino.[Forecast Short Call]                                                               = fonte.[Forecast Short Call]\n            ,destino.[Forecast Instabilidade]                                                            = fonte.[Forecast Instabilidade]\n            ,destino.[Forecast Phishing]                                                                 = fonte.[Forecast Phishing]\n\n            ,destino.[Ader\u00eancia Log]                                                                     = fonte.[Ader\u00eancia Log]\n            ,destino.[Ader\u00eancia Log 102%]                                                                = fonte.[Ader\u00eancia Log 102%]\n            ,destino.[Ader\u00eancia Log Produtivo]                                                           = fonte.[Ader\u00eancia Log Produtivo]\n            ,destino.[Ader\u00eancia Log Produtivo 102%]                                                      = fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,destino.[Ader\u00eancia TMT]                                                                     = fonte.[Ader\u00eancia TMT]\n            ,destino.[Ader\u00eancia TMA]                                                                     = fonte.[Ader\u00eancia TMA]\n            ,destino.[Ader\u00eancia SLA]                                                                     = fonte.[Ader\u00eancia SLA]\n            ,destino.[Ader\u00eancia NS]                                                                      = fonte.[Ader\u00eancia NS]\n            ,destino.[Ader\u00eancia Abandono]                                                                = fonte.[Ader\u00eancia Abandono]\n            --,destino.[Ader\u00eancia NPS]                                                                     = fonte.[Ader\u00eancia NPS]\n            ,destino.[Ader\u00eancia Casos N\u00e3o Resolvidos]                                                    = fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,destino.[Ader\u00eancia Rechamada]                                                               = fonte.[Ader\u00eancia Rechamada]\n            --,destino.[Ader\u00eancia Short Call]                                                              = fonte.[Ader\u00eancia Short Call]\n            --,destino.[Ader\u00eancia Instabilidade]                                                           = fonte.[Ader\u00eancia Instabilidade]\n            --,destino.[Ader\u00eancia Phishing]                                                                = fonte.[Ader\u00eancia Phishing]\n\n            --,destino.[Penalidade TMT]                                                                    = fonte.[Penalidade TMT]\n            --,destino.[Penalidade TMA]                                                                    = fonte.[Penalidade TMA]\n            --,destino.[Penalidade SLA]                                                                    = fonte.[Penalidade SLA]\n            --,destino.[Penalidade NS]                                                                     = fonte.[Penalidade NS]\n            --,destino.[Penalidade Abandono]                                                               = fonte.[Penalidade Abandono]\n            --,destino.[Penalidade NPS]                                                                    = fonte.[Penalidade NPS]\n            --,destino.[Penalidade Casos N\u00e3o Resolvidos]                                                   = fonte.[Penalidade Casos N\u00e3o Resolvidos]\n            --,destino.[Penalidade Rechamada]                                                              = fonte.[Penalidade Rechamada]\n            --,destino.[Penalidade Short Call]                                                             = fonte.[Penalidade Short Call]\n            --,destino.[Penalidade Instabilidade]                                                          = fonte.[Penalidade Instabilidade]\n            --,destino.[Penalidade Phishing]                                                               = fonte.[Penalidade Phishing]\n\n            --,destino.[PAs Contratadas]                                                                   = fonte.[PAs Contratadas]\n            --,destino.[Valor da PA]                                                                       = fonte.[Valor da PA]\n            --,destino.[Faturamento Antes das Penalidades]                                                 = fonte.[Faturamento Antes das Penalidades]\n            --,destino.[Faturamento Ap\u00f3s Penalidades]                                                      = fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,destino.[Log]                                                                               = fonte.[Log]\n            ,destino.[Log 102%]                                                                          = fonte.[Log 102%]\n            ,destino.[Log Perdido (>102%)]                                                               = fonte.[Log Perdido (>102%)]\n\t\t    ,destino.[Log Produtivo]                                                                     = fonte.[Log Produtivo]\n            ,destino.[Log Produtivo 102%]                                                                = fonte.[Log Produtivo 102%]\n            ,destino.[Log Produtivo Perdido (>102%)]                                                     = fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,destino.[Log HE]                                                                            = fonte.[Log HE]\n\t\t    ,destino.[Log descartado (>2HE)]                                                             = fonte.[Log descartado (>2HE)]\n\t\t    ,destino.[Log Improdutivo]                                                                   = fonte.[Log Improdutivo]\n\t\t\t,destino.[Tempo Total (Intelix)]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Tempo Total (Intelix)]\n\t\t\t,destino.[Tempo Total (EPBX)]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Tempo Total (EPBX)]\n\t\t\t,destino.[Tempo Total (Genesys)]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Tempo Total (Genesys)]\n\t\t\t,destino.[Tempo Total (Secullum)]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Tempo Total (Secullum)]\n\t\t    ,destino.[Tempo Livre]                                                                       = fonte.[Tempo Livre]\n\t\t    ,destino.[Pausa Particular (Intelix)]                                                        = fonte.[Pausa Particular (Intelix)]\n\t\t    ,destino.[Pausa Break (Intelix)]                                                             = fonte.[Pausa Break (Intelix)]\n\t\t    ,destino.[Pausa 10 (Intelix)]                                                                = fonte.[Pausa 10 (Intelix)]\n\t\t    ,destino.[Pausa Outbound (Intelix)]                                                          = fonte.[Pausa Outbound (Intelix)]\n\t\t    ,destino.[Pausa Lanche (Intelix)]                                                            = fonte.[Pausa Lanche (Intelix)]\n\t\t    ,destino.[Pausa R\u00e1pida (Intelix)]                                                            = fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Intelix)]                                                            = fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,destino.[Pausa Feedback (Intelix)]                                                          = fonte.[Pausa Feedback (Intelix)]\n\t\t    ,destino.[Pausa Sistema Interno (Intelix)]                                                   = fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,destino.[Pausa Sistema Externo (Intelix)]                                                   = fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,destino.[Pausa Treinamento (Intelix)]                                                       = fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,destino.[Pausa Banheiro (Intelix)]                                                          = fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (Intelix)]                                                           = fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Intelix)]                                                       = fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,destino.[Pausa NR17 (Intelix)]                                                              = fonte.[Pausa NR17 (Intelix)]\n\t\t    ,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]                                                              = fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (EPBX)]                                                               = fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,destino.[Pausa Tratativa (EPBX)]                                                            = fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,destino.[Pausa Discagem Manual (EPBX)]                                                      = fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,destino.[Pausa Banheiro (EPBX)]                                                             = fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,destino.[Pausa WhatsApp (EPBX)]                                                             = fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,destino.[Pausa Intervalo (EPBX)]                                                            = fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,destino.[Pausa Discagem Retorno (EPBX)]                                                     = fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,destino.[Pausa Treinamento (EPBX)]                                                          = fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,destino.[Pausa Feedback (EPBX)]                                                             = fonte.[Pausa Feedback (EPBX)]\n\t\t    ,destino.[Pausa Transfer\u00eancia (EPBX)]                                                        = fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,destino.[Pausa N\u00e3o Disponivel (EPBX)]                                                       = fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,destino.[Pausa Login (EPBX)]                                                                = fonte.[Pausa Login (EPBX)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (EPBX)]                                                              = fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Sistema Interno (EPBX)]                                                      = fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,destino.[Pausa Sistema Externo (EPBX)]                                                      = fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,destino.[Pausa NR17 (EPBX)]                                                                 = fonte.[Pausa NR17 (EPBX)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (EPBX)]                                                          = fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,destino.[Pausa P\u00f3s Atendimento (EPBX)]                                                      = fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,destino.[Pausa Lanche (EPBX)]                                                               = fonte.[Pausa Lanche (EPBX)]\n\t\t    ,destino.[Pausa BackOffice (EPBX)]                                                           = fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Genesys)]                                                            = fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Genesys)]                                                       = fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,destino.[Pausa Banheiro (Genesys)]                                                          = fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,destino.[Pausa Descanso (Genesys)]                                                          = fonte.[Pausa Descanso (Genesys)]\n\t \t    ,destino.[Pausa Feedback (Genesys)]                                                          = fonte.[Pausa Feedback (Genesys)]\n\t \t    ,destino.[Pausa Backoffice (Genesys)]                                                        = fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,destino.[Pausa Discagem Manual (Genesys)]                                                   = fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,destino.[Pausa Discagem Retorno (Genesys)]                                                  = fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,destino.[Pausa Dispon\u00edvel (Genesys)]                                                        = fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,destino.[Pausa Em Fila (Genesys)]                                                           = fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,destino.[Pausa Sistema Externo (Genesys)]                                                   = fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,destino.[Pausa Sistema Interno (Genesys)]                                                   = fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,destino.[Pausa Tratativa (Genesys)]                                                         = fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,destino.[Pausa Whatsapp (Genesys)]                                                          = fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,destino.[Pausa Treinamento (Genesys)]                                                       = fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,destino.[Criados]                                                                           = fonte.[Criados]\n\t\t    ,destino.[Tratados]                                                                          = fonte.[Tratados]\n\t\t    ,destino.[Tempo Total de Tratativa]                                                          = fonte.[Tempo Total de Tratativa]\n\t\t    ,destino.[TMT]                                                                               = fonte.[TMT]\n\t\t    ,destino.[N\u00e3o Resolvidos]                                                                    = fonte.[N\u00e3o Resolvidos]\n\t\t    ,destino.[Replicas]                                                                          = fonte.[Replicas]\n\t\t    ,destino.[Reincidentes 48h]                                                                  = fonte.[Reincidentes 48h]\n\t\t    ,destino.[Reincidentes 30d]                                                                  = fonte.[Reincidentes 30d]\n\n            ,destino.[SLA TPR]                                                                           = fonte.[SLA TPR]\n            ,destino.[SLA TES]                                                                           = fonte.[SLA TES]\n            ,destino.[SLA TTR]                                                                           = fonte.[SLA TTR]\n\n\t\t    ,destino.[Inbound - Chamadas Iniciadas]                                                      = fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas]                                                      = fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]                                           = fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Inbound - Chamadas Em Andamento]                                                   = fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,destino.[Inbound - Chamadas Finalizadas]                                                    = fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,destino.[Inbound - Chamadas Transferidas]                                                   = fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]                            = fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]                        = fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]                             = fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]                       = fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]                                      = fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]                                  = fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]                                       = fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]                                 = fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Atendimentos Iniciados]                                                  = fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,destino.[Inbound - Atendimentos Em Andamento]                                               = fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Inbound - Atendimentos Finalizados]                                                = fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,destino.[Inbound - TMC]                                                                     = fonte.[Inbound - TMC]\n\t\t    ,destino.[Inbound - TMA]                                                                     = fonte.[Inbound - TMA]\n\t\t    ,destino.[Inbound - TME]                                                                     = fonte.[Inbound - TME]\n\t\t    ,destino.[Inbound - TMO]                                                                     = fonte.[Inbound - TMO]\n\t\t    ,destino.[Inbound - % Nivel de Servi\u00e7o]                                                      = fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Inbound - Chamadas Abandonadas]                                                    = fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,destino.[Inbound - % Abandono]                                                              = fonte.[Inbound - % Abandono]\n\n\t\t    ,destino.[Outbound - Chamadas Iniciadas]                                                     = fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas]                                                     = fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]                                          = fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Outbound - Chamadas Em Andamento]                                                  = fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,destino.[Outbound - Chamadas Finalizadas]                                                   = fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,destino.[Outbound - Chamadas Transferidas]                                                  = fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]                           = fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]                       = fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]                            = fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]                      = fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]                                     = fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]                                 = fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]                                      = fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]                                = fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Atendimentos Iniciados]                                                 = fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,destino.[Outbound - Atendimentos Em Andamento]                                              = fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Outbound - Atendimentos Finalizados]                                               = fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,destino.[Outbound - TMC]                                                                    = fonte.[Outbound - TMC]\n\t\t    ,destino.[Outbound - TMA]                                                                    = fonte.[Outbound - TMA]\n\t\t    ,destino.[Outbound - TME]                                                                    = fonte.[Outbound - TME]\n\t\t    ,destino.[Outbound - TMO]                                                                    = fonte.[Outbound - TMO]\n\t\t    ,destino.[Outbound - % Nivel de Servi\u00e7o]                                                     = fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Outbound - Chamadas Abandonadas]                                                   = fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,destino.[Outbound - % Abandono]                                                             = fonte.[Outbound - % Abandono]\n\n\t\t    ,destino.[Avalia\u00e7\u00f5es de NPS]                                                                 = fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,destino.[Promotoras]                                                                        = fonte.[Promotoras]\n\t\t    ,destino.[Neutras]                                                                           = fonte.[Neutras]\n\t\t    ,destino.[Detratoras]                                                                        = fonte.[Detratoras]\n            ,destino.[NPS]                                                                               = fonte.[NPS]\n\n            --,destino.[Genesys Provis\u00f3rio - Oferta]                                                       = ISNULL(fonte.[Genesys Provis\u00f3rio - Oferta],0)\n            --,destino.[Genesys Provis\u00f3rio - Resposta]                                                     = ISNULL(fonte.[Genesys Provis\u00f3rio - Resposta],0)\n            --,destino.[Genesys Provis\u00f3rio - Em Espera]                                                    = ISNULL(fonte.[Genesys Provis\u00f3rio - Em Espera],0)\n            --,destino.[Genesys Provis\u00f3rio - Transferir]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - Transferir],0)\n            --,destino.[Genesys Provis\u00f3rio - Abandono]                                                     = ISNULL(fonte.[Genesys Provis\u00f3rio - Abandono],0)\n            --,destino.[Genesys Provis\u00f3rio - % Resposta]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - % Resposta],0)\n            --,destino.[Genesys Provis\u00f3rio - % Abandono]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - % Abandono],0)\n            --,destino.[Genesys Provis\u00f3rio - % NS]                                                         = ISNULL(fonte.[Genesys Provis\u00f3rio - % NS],0)\n            --,destino.[Genesys Provis\u00f3rio - % Alvos do NS]                                                = ISNULL(fonte.[Genesys Provis\u00f3rio - % Alvos do NS],0)\n            --,destino.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]                                      = ISNULL(fonte.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)],0)\n            --,destino.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)]                                  = ISNULL(fonte.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)],0)\n            --,destino.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]                                       = ISNULL(fonte.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)],0)\n            --,destino.[Genesys Provis\u00f3rio - VMA]                                                          = ISNULL(fonte.[Genesys Provis\u00f3rio - VMA],0)\n            --,destino.[Genesys Provis\u00f3rio - TPC]                                                          = ISNULL(fonte.[Genesys Provis\u00f3rio - TPC],0)\n\n\t\t    ,destino.[Teve Evento de MOP?]                                                               = fonte.[Teve Evento de MOP?]\n\t\t    ,destino.[Teve Evento de Tickets?]                                                           = fonte.[Teve Evento de Tickets?]\n\t\t    ,destino.[Teve Evento de Chamadas?]                                                          = fonte.[Teve Evento de Chamadas?]\n\t\t    ,destino.[Teve Evento de NPS?]                                                               = fonte.[Teve Evento de NPS?]\n\t\t    ,destino.[Teve Evento de Log?]                                                               = fonte.[Teve Evento de Log?]\n\t\t    ,destino.[Teve Evento de Forecast?]                                                          = fonte.[Teve Evento de Forecast?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_tribo_dia\n        WHERE [Data] >= CAST(GETDATE() AS DATE)\n\t\t\tOR(\t[Teve Evento de MOP?]\t    = 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0)\n\n        UPDATE r_tribo_dia\n        SET\n            --[Data]                 = CAST([DataHora] AS DATE)\n             [Ciclo (Primeiro Dia)] = DATEADD(DAY, (CASE WHEN (DATEPART(DAY, [Data]) > 21) THEN 4 ELSE ((DATEPART(DAY, [Data])-1)/7)+1 END-1)*7, DATEFROMPARTS(YEAR([Data]), MONTH([Data]), 1))\n            ,[M\u00eas (Primeiro Dia)]   = DATEFROMPARTS(YEAR([Data]), MONTH([Data]), 1)\n            ,[Cliente]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),3)\n            ,[Projeto]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),2)\n            ,[Tribo]\t\t\t       = PARSENAME(REPLACE([Tribo Completa],'__','.'),1)\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n    IF 1=1 BEGIN; PRINT '--- agrupamento tribo_m\u00eas';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_tribo_m\u00eas]\n    \t\tWHERE [M\u00eas (Primeiro Dia)] >= DATEFROMPARTS(YEAR(@datahora_inicio ),MONTH(@datahora_inicio) ,1)\n    \t\tAND\t  [M\u00eas (Primeiro Dia)] <= DATEFROMPARTS(YEAR(@datahora_fim ),MONTH(@datahora_fim) ,1)\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n            SELECT\n                 [Faturamento Ap\u00f3s Penalidades] = [Faturamento Antes das Penalidades]\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade TMT],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade TMA],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade SLA],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade NS],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Abandono],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade NPS],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Casos N\u00e3o Resolvidos],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Rechamada],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Short Call],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Instabilidade],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Phishing],0)\n                ,*\n            FROM (\n                SELECT\n                     [Faturamento Antes das Penalidades]                            =   [Ader\u00eancia Log Produtivo 102%] * [PAs Contratadas] * [Valor da PA]\n                    ,[Penalidade TMT]                                               =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia TMT] >= [minimo] AND 1-[Ader\u00eancia TMT] <= [maximo]),0)\n                    ,[Penalidade TMA]                                               =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia TMA] >= [minimo] AND 1-[Ader\u00eancia TMA] <= [maximo]),0)\n                    ,[Penalidade SLA]                                               =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia SLA] >= [minimo] AND 1-[Ader\u00eancia SLA] <= [maximo]),0)\n                    ,[Penalidade NS]                                                =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia NS] >= [minimo] AND 1-[Ader\u00eancia NS] <= [maximo]),0)\n                    ,[Penalidade NPS]                                               =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia NPS] >= [minimo] AND 1-[Ader\u00eancia NPS] <= [maximo]),0)\n                    ,[Penalidade Abandono]                                          =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia Abandono] >= [minimo] AND 1-[Ader\u00eancia Abandono] <= [maximo]),0)\n                    ,[Penalidade Casos N\u00e3o Resolvidos]                              =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia Casos N\u00e3o Resolvidos] >= [minimo] AND 1-[Ader\u00eancia Casos N\u00e3o Resolvidos] <= [maximo]),0)\n                    --,[Penalidade Rechamada]                                       =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia ] >= [minimo] AND 1-[Ader\u00eancia ] <= [maximo]),0)\n                    --,[Penalidade Short Call]                                      =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia ] >= [minimo] AND 1-[Ader\u00eancia ] <= [maximo]),0)\n                    --,[Penalidade Instabilidade]                                   =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia ] >= [minimo] AND 1-[Ader\u00eancia ] <= [maximo]),0)\n                    --,[Penalidade Phishing]                                        =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia ] >= [minimo] AND 1-[Ader\u00eancia ] <= [maximo]),0)\n                    ,*\n                FROM (\n                    SELECT\n                         [Ader\u00eancia Log]                    =   [Log] / NULLIF([Forecast Log],0)\n                        ,[Ader\u00eancia Log 102%]               =   [Log 102%] / NULLIF([Forecast Log],0)\n                        ,[Ader\u00eancia Log Produtivo]          =   [Log Produtivo] / NULLIF([Forecast Log Produtivo],0)\n                        ,[Ader\u00eancia Log Produtivo 102%]     =   [Log Produtivo 102%] / NULLIF([Forecast Log Produtivo],0)\n                        ,[Ader\u00eancia TMT]                    =   [TMT] / NULLIF([Forecast TMT],0)\n                        ,[Ader\u00eancia TMA]                    =   COALESCE([Inbound - TMA], [Outbound - TMA]) / NULLIF([Forecast TMA],0)\n                        ,[Ader\u00eancia SLA]                    =   [SLA TPR] / NULLIF([Forecast SLA],0)\n                        ,[Ader\u00eancia NS]                     =   [Inbound - % Nivel de Servi\u00e7o] / NULLIF([Forecast NS],0)\n                        ,[Ader\u00eancia NPS]                    =   [NPS] / NULLIF([Forecast NPS],0)\n                        ,[Ader\u00eancia Abandono]               =   [Inbound - % Abandono] / NULLIF([Forecast Abandono],0)\n                        ,[Ader\u00eancia Casos N\u00e3o Resolvidos]   =   [N\u00e3o Resolvidos] / NULLIF([Forecast Casos N\u00e3o Resolvidos],0)\n                        --,[Ader\u00eancia Rechamada]            =   [] / NULLIF([],0)\n                        --,[Ader\u00eancia Short Call]           =   [] / NULLIF([],0)\n                        --,[Ader\u00eancia Instabilidade]        =   [] / NULLIF([],0)\n                        --,[Ader\u00eancia Phishing]             =   [] / NULLIF([],0)\n                        ,*\n                    FROM (\n    \t            \tSELECT\n    \t            \t\t [M\u00eas (Primeiro Dia)]\t\t\t\t                            =\t[M\u00eas (Primeiro Dia)]\n\n\n                            --,[Feriado (Nome)]                                               =  MAX([Feriado (Nome)])\n\n       \t                    ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(SUM([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t                    ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(SUM([Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t                    ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(SUM([Secullum - Servi\u00e7o Militar]                                   ),0)\n                            ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(SUM([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t                    ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t                    ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t                    ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(SUM([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t                    ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(SUM([Secullum - Licen\u00e7a Casamento]                                 ),0)\n                            ,[Secullum - INSS - Afastamento]                                    =   ISNULL(SUM([Secullum - INSS - Afastamento]                                ),0)\n                            ,[Secullum - Folga]                                                 =   ISNULL(SUM([Secullum - Folga]                                             ),0)\n                            ,[Secullum - F\u00e9rias]                                                =   ISNULL(SUM([Secullum - F\u00e9rias]                                            ),0)\n       \t                    ,[Secullum - Feriado]                                               =   ISNULL(SUM([Secullum - Feriado]                                           ),0)\n       \t                    ,[Secullum - Falta Justificada]                                     =   ISNULL(SUM([Secullum - Falta Justificada]                                 ),0)\n       \t                    ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(SUM([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                            ,[Secullum - Falta Injustificada]                                   =   ISNULL(SUM([Secullum - Falta Injustificada]                               ),0)\n       \t                    ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(SUM([Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t                    ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(SUM([Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                            ,[Secullum - Desligue]                                              =   ISNULL(SUM([Secullum - Desligue]                                          ),0)\n       \t                    ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(SUM([Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t                    ,[Secullum - Compensando Horas]                                     =   ISNULL(SUM([Secullum - Compensando Horas]                                 ),0)\n       \t                    ,[Secullum - Atestado]                                              =   ISNULL(SUM([Secullum - Atestado]                                          ),0)\n                            ,[Secullum - Abono]                                                 =   ISNULL(SUM([Secullum - Abono]                                             ),0)\n       \t                    ,[Secullum - Abono Lactante]                                        =   ISNULL(SUM([Secullum - Abono Lactante]                                    ),0)\n       \t                    ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(SUM([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t                    ,[Faltas Justificadas]                                              =   ISNULL(SUM([Faltas Justificadas]                                          ),0)\n       \t                    ,[Faltas Injustificadas]                                            =   ISNULL(SUM([Faltas Injustificadas]                                        ),0)\n\n    \t            \t\t,[Cliente]\t\t\t\t\t\t\t                            =\tMIN([Cliente])\n    \t            \t\t,[Projeto]\t\t\t\t\t\t\t                            =\tMIN([Projeto])\n    \t            \t\t,[Tribo]\t\t\t\t\t\t\t                            =\tMIN([Tribo])\n    \t            \t\t,[Tribo Completa]\t\t\t\t\t                            =\tMIN([Tribo Completa])\n\n\t\t                    ,[Trabalhado (Ponto)]\t\t\t\t\t\t\t                =   SUM([Trabalhado (Ponto)])\n\t\t                    ,[Em Pausa (Ponto)]\t\t\t\t\t\t\t\t                =   SUM([Em Pausa (Ponto)])\n\t\t\t\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t=\tSUM([Desvio Ponto-Log])\n\n                            ,[Forecast HC Taxa 1]                                           =   MAX([Forecast HC Taxa 1])\n                            ,[Forecast HC Taxa 2]                                           =   MAX([Forecast HC Taxa 2])\n                            ,[Forecast Pausas Taxa 1]                                       =   MAX([Forecast Pausas Taxa 1])\n                            ,[Forecast Pausas Taxa 2]                                       =   MAX([Forecast Pausas Taxa 2])\n                            ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                     =   MAX([Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio])\n                            ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                 =   MAX([Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio])\n                            ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t\t                =   MAX([Forecast PA Liquida (VOZ) - Provis\u00f3rio])\n                            ,[Forecast Volume]\t\t                       \t                =   SUM([Forecast Volume])\n                            ,[Forecast Volume M\u00eas - Provis\u00f3rio]                             =   MAX(m.[Forecast Volume M\u00eas - Provis\u00f3rio])\n                            ,[Forecast Log]                                                 =   SUM([Forecast Log])\n                            ,[Forecast Log Produtivo]                                       =   SUM([Forecast Log Produtivo])\n                            ,[Forecast NS]                                                  =   MAX(m.[Forecast NS M\u00eas - Provis\u00f3rio])--MAX([Forecast NS])\n                            ,[Forecast NS M\u00eas - Provis\u00f3rio]                                 =   MAX(m.[Forecast NS M\u00eas - Provis\u00f3rio])\n\n                            ,[Forecast TMT]                                                 =   MAX(m.[Forecast TMT])\n                            ,[Forecast TMA]                                                 =   MAX(m.[Forecast TMA])\n                            ,[Forecast SLA]                                                 =   MAX(m.[Forecast SLA])\n                            ,[Forecast NPS]                                                 =   MAX(m.[Forecast NPS])\n                            ,[Forecast Abandono]                                            =   MAX(m.[Forecast Abandono])\n                            ,[Forecast Casos N\u00e3o Resolvidos]                                =   MAX(m.[Forecast Casos N\u00e3o Resolvidos])\n                            ,[Forecast Rechamada]                                           =   MAX(m.[Forecast Rechamada])\n                            ,[Forecast Short Call]                                          =   MAX(m.[Forecast Short Call])\n                            ,[Forecast Instabilidade]                                       =   MAX(m.[Forecast Instabilidade])\n                            ,[Forecast Phishing]                                            =   MAX(m.[Forecast Phishing])\n\n                            ,[PAs Contratadas]                                              =   MAX([PAs Contratadas])\n                            ,[Valor da PA]                                                  =   MAX([Valor da PA])\n\n\t\t                    ,[Log]\t\t\t\t\t\t\t\t\t\t\t                =   SUM([Log])\n                            ,[Log 102%]                                                     =   SUM([Log 102%])\n                            ,[Log Perdido (>102%)]                                          =   SUM([Log Perdido (>102%)])\n\t\t                    ,[Log Produtivo]\t\t\t\t\t\t\t\t                =   SUM([Log Produtivo])\n                            ,[Log Produtivo 102%]                                           =   SUM([Log Produtivo 102%])\n                            ,[Log Produtivo Perdido (>102%)]                                =   SUM([Log Produtivo Perdido (>102%)])\n\t\t                    ,[Log HE]\t\t\t\t\t\t\t\t\t\t                =   SUM([Log HE])\n\t\t                    ,[Log descartado (>2HE)]\t\t\t\t\t\t                =   SUM([Log descartado (>2HE)])\n\t\t                    ,[Log Improdutivo]\t\t\t\t\t\t\t\t                =   SUM([Log Improdutivo])\n\t\t\t\t\t\t\t,[Tempo Total (Intelix)]\t\t\t\t\t\t\t\t\t\t=   SUM([Tempo Total (Intelix)])\n\t\t\t\t\t\t\t,[Tempo Total (EPBX)]\t\t\t\t\t\t\t\t\t\t\t=   SUM([Tempo Total (EPBX)])\n\t\t\t\t\t\t\t,[Tempo Total (Genesys)]\t\t\t\t\t\t\t\t\t\t=   SUM([Tempo Total (Genesys)])\n\t\t\t\t\t\t\t,[Tempo Total (Secullum)]\t\t\t\t\t\t\t\t\t\t=   SUM([Tempo Total (Secullum)])\n\t\t                    ,[Tempo Livre]\t\t\t\t\t\t\t\t\t                =   SUM([Tempo Livre])\n\t\t                    ,[Pausa Particular (Intelix)]\t\t\t\t\t                =   SUM([Pausa Particular (Intelix)])\n\t\t                    ,[Pausa Break (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Break (Intelix)])\n\t\t                    ,[Pausa 10 (Intelix)]\t\t\t\t\t\t\t                =   SUM([Pausa 10 (Intelix)])\n\t\t                    ,[Pausa Outbound (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Outbound (Intelix)])\n\t\t                    ,[Pausa Lanche (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Lanche (Intelix)])\n\t\t                    ,[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa R\u00e1pida (Intelix)])\n\t\t                    ,[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Almo\u00e7o (Intelix)])\n\t\t                    ,[Pausa Feedback (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Feedback (Intelix)])\n\t\t                    ,[Pausa Sistema Interno (Intelix)]\t\t\t\t                =   SUM([Pausa Sistema Interno (Intelix)])\n\t\t                    ,[Pausa Sistema Externo (Intelix)]\t\t\t\t                =   SUM([Pausa Sistema Externo (Intelix)])\n\t\t                    ,[Pausa Treinamento (Intelix)]\t\t\t\t\t                =   SUM([Pausa Treinamento (Intelix)])\n\t\t                    ,[Pausa Banheiro (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Banheiro (Intelix)])\n\t\t                    ,[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Reuni\u00e3o (Intelix)])\n\t\t                    ,[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t                =   SUM([Pausa Ambulat\u00f3rio (Intelix)])\n\t\t                    ,[Pausa NR17 (Intelix)]\t\t\t\t\t\t\t                =   SUM([Pausa NR17 (Intelix)])\n\t\t                    ,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Liga\u00e7\u00e3o (EPBX)])\n\t\t                    ,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Almo\u00e7o (EPBX)])\n\t\t                    ,[Pausa Tratativa (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Tratativa (EPBX)])\n\t\t                    ,[Pausa Discagem Manual (EPBX)]\t\t\t\t\t                =   SUM([Pausa Discagem Manual (EPBX)])\n\t\t                    ,[Pausa Banheiro (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Banheiro (EPBX)])\n\t\t                    ,[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa WhatsApp (EPBX)])\n\t\t                    ,[Pausa Intervalo (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Intervalo (EPBX)])\n\t\t                    ,[Pausa Discagem Retorno (EPBX)]\t\t\t\t                =   SUM([Pausa Discagem Retorno (EPBX)])\n\t\t                    ,[Pausa Treinamento (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Treinamento (EPBX)])\n\t\t                    ,[Pausa Feedback (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Feedback (EPBX)])\n\t\t                    ,[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t                =   SUM([Pausa Transfer\u00eancia (EPBX)])\n\t\t                    ,[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t                =   SUM([Pausa N\u00e3o Disponivel (EPBX)])\n\t\t                    ,[Pausa Login (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Login (EPBX)])\n\t\t                    ,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Reuni\u00e3o (EPBX)])\n\t\t                    ,[Pausa Sistema Interno (EPBX)]\t\t\t\t\t                =   SUM([Pausa Sistema Interno (EPBX)])\n\t\t                    ,[Pausa Sistema Externo (EPBX)]\t\t\t\t\t                =   SUM([Pausa Sistema Externo (EPBX)])\n\t\t                    ,[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa NR17 (EPBX)])\n\t\t                    ,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Ambulat\u00f3rio (EPBX)])\n\t\t                    ,[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t                =   SUM([Pausa P\u00f3s Atendimento (EPBX)])\n\t\t                    ,[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Lanche (EPBX)])\n\t\t                    ,[Pausa BackOffice (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa BackOffice (EPBX)])\n\t\t                    ,[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Almo\u00e7o (Genesys)])\n\t\t                    ,[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t                =   SUM([Pausa Ambulat\u00f3rio (Genesys)])\n\t \t                    ,[Pausa Banheiro (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Banheiro (Genesys)])\n\t \t                    ,[Pausa Descanso (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Descanso (Genesys)])\n\t \t                    ,[Pausa Feedback (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Feedback (Genesys)])\n\t \t                    ,[Pausa Backoffice (Genesys)]\t\t\t\t\t                =   SUM([Pausa Backoffice (Genesys)])\n\t \t                    ,[Pausa Discagem Manual (Genesys)]\t\t\t\t                =   SUM([Pausa Discagem Manual (Genesys)])\n\t \t                    ,[Pausa Discagem Retorno (Genesys)]\t\t\t\t                =   SUM([Pausa Discagem Retorno (Genesys)])\n\t \t                    ,[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t                =   SUM([Pausa Dispon\u00edvel (Genesys)])\n\t \t                    ,[Pausa Em Fila (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Em Fila (Genesys)])\n\t \t                    ,[Pausa Sistema Externo (Genesys)]\t\t\t\t                =   SUM([Pausa Sistema Externo (Genesys)])\n\t \t                    ,[Pausa Sistema Interno (Genesys)]\t\t\t\t                =   SUM([Pausa Sistema Interno (Genesys)])\n\t \t                    ,[Pausa Tratativa (Genesys)]\t\t\t\t\t                =   SUM([Pausa Tratativa (Genesys)])\n\t \t                    ,[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Whatsapp (Genesys)])\n\t\t                    ,[Pausa Treinamento (Genesys)]\t\t\t\t\t                =   SUM([Pausa Treinamento (Genesys)])\n\n    \t            \t\t,[Criados]\t\t\t\t\t\t\t                            =\tSUM([Criados])\n    \t            \t\t,[Tratados]\t\t\t\t\t\t\t                            =\tSUM([Tratados])\n    \t            \t\t,[Tempo Total de Tratativa]\t\t\t                            =\tSUM([Tempo Total de Tratativa])\n    \t            \t\t,[TMT]\t\t\t\t\t\t\t\t                            =\tISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n    \t            \t\t,[N\u00e3o Resolvidos]\t\t\t\t\t                            =\tSUM([N\u00e3o Resolvidos])\n    \t            \t\t,[Replicas]\t\t\t\t\t\t\t                            =\tSUM([Replicas])\n    \t            \t\t,[Reincidentes 48h]\t\t\t\t\t                            =\tSUM([Reincidentes 48h])\n    \t            \t\t,[Reincidentes 30d]\t\t\t\t\t                            =\tSUM([Reincidentes 30d])\n\n                            ,[SLA TPR]                                                      =   AVG(s.[SLA TPR])\n                            ,[SLA TES]                                                      =   AVG(s.[SLA TES])\n                            ,[SLA TTR]                                                      =   AVG(s.[SLA TTR])\n\n    \t            \t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Iniciadas])\n    \t            \t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas])\n    \t            \t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t            \t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Em Andamento])\n    \t            \t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Finalizadas])\n    \t            \t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Transferidas])\n    \t            \t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Espera (Independente do Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Chamada (Neste Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM([Inbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Espera (Neste Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Inbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t            \t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Iniciados])\n    \t            \t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Em Andamento])\n    \t            \t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Finalizados])\n    \t            \t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t            \t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t            \t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t            \t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t            \t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t            \t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Abandonadas])\n    \t            \t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n    \t            \t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Iniciadas])\n    \t            \t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas])\n    \t            \t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t            \t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Em Andamento])\n    \t            \t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Finalizadas])\n    \t            \t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Transferidas])\n    \t            \t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Espera (Independente do Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM([Outbound - Tempo Em Chamada (Neste Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Outbound - Tempo Em Espera (Neste Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t            \t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Iniciados])\n    \t            \t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Em Andamento])\n    \t            \t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Finalizados])\n    \t            \t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t            \t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t            \t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t            \t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t            \t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t            \t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Abandonadas])\n    \t            \t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n    \t            \t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t                            =\tSUM([Avalia\u00e7\u00f5es de NPS])\n    \t            \t\t,[Promotoras]\t\t\t\t\t\t                            =\tSUM([Promotoras])\n    \t            \t\t,[Neutras]\t\t\t\t\t\t\t                            = \tSUM([Neutras])\n    \t            \t\t,[Detratoras]\t\t\t\t\t\t                            = \tSUM([Detratoras])\n    \t            \t\t,[NPS]\t\t\t\t\t\t\t\t                            =\tCAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n    \t            \t\t,[Teve Evento de MOP?]\t\t\t\t                            = \tIIF(SUM([Teve Evento de MOP?])=0,0,1)\n    \t            \t\t,[Teve Evento de Tickets?]\t\t\t                            = \tIIF(SUM([Teve Evento de Tickets?])=0,0,1)\n    \t            \t\t,[Teve Evento de Chamadas?]\t\t\t                            = \tIIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n    \t            \t\t,[Teve Evento de NPS?]\t\t\t\t                            = \tIIF(SUM([Teve Evento de NPS?])=0,0,1)\n    \t            \t\t,[Teve Evento de Log?]\t\t\t\t                            = \tIIF(SUM([Teve Evento de Log?])=0,0,1)\n    \t            \t\t,[Teve Evento de Forecast?]\t\t\t                            = \tIIF(SUM([Teve Evento de Forecast?])=0,0,1)\n\n    \t            \tFROM r_tribo_dia r\n                        FULL OUTER JOIN (\n                            SELECT\n                             [m_Tribo]  = [tribo]\n                            ,[m_M\u00eas]    = [m\u00eas]\n                            ,[Forecast Volume M\u00eas - Provis\u00f3rio] = [volume_projetado] -- S\u00f3 pra valida\u00e7\u00e3o, pra ver se t\u00e1 batendo com a dim_forecast_30min\n                            ,[Forecast NS M\u00eas - Provis\u00f3rio] = [NS]\n                            ,[Forecast TMT] = IIF([tribo] in ('Central de Ajuda - Autentica\u00e7\u00e3o', 'Central de Ajuda - Produtos', 'Reclame Aqui', 'GOV', 'Self Setup', 'BackOffice', 'Chat'), [tmt_segundos], 0)\n                            ,[Forecast TMA] = IIF([tribo] in ('BackOffice', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                            ,[Forecast SLA] = [SLA]\n                            ,[Forecast Abandono] = [abandono]\n                            ,[Forecast NPS] = [NPS]\n                            ,[Forecast Casos N\u00e3o Resolvidos] = [casos_n\u00e3o_resolvidos]\n                            ,[Forecast Rechamada] = [rechamada]\n                            ,[Forecast Short Call] = [short_call]\n                            ,[Forecast Instabilidade] = [instabilidade]\n                            ,[Forecast Phishing] = [phishing]\n                            ,[PAs Contratadas] = [hc_tx1] + [hc_tx2]\n                            ,[Valor da PA] = [valor_pa]\n                            FROM (\n                                SELECT [n]=ROW_NUMBER() OVER (PARTITION BY [tribo], [m\u00eas] ORDER BY [data_recebimento]), *\n                                FROM [db_serasa_producao].[dbo].dim_forecast_metas\n                            ) _\n                            WHERE [n] = 1\n                        ) m\n                        ON  r.[Tribo] = m.[m_tribo]\n                        AND r.[M\u00eas (Primeiro Dia)] = m.[m_m\u00eas]\n\n                        LEFT JOIN (\n                            SELECT\n                             [m_Tribo]  = [tribo_serasa]\n                            ,[m_M\u00eas]    = DATEFROMPARTS(YEAR([data]),MONTH([data]) ,1)\n                            ,[SLA TPR]  = AVG([primeira_resposta_s])\n                            ,[SLA TES]  = AVG([espera_solicitante_s])\n                            ,[SLA TTR]  = AVG([total_resolucao_s])\n                            FROM (\n                                SELECT [n]=ROW_NUMBER() OVER (PARTITION BY [tribo_serasa], EOMONTH([data]) ORDER BY [data]), *\n                                FROM [db_serasa_producao].[dbo].dim_teste_sla\n                            ) _\n                            WHERE [n] = 1\n                            GROUP BY [tribo_serasa], DATEFROMPARTS(YEAR([data]),MONTH([data]) ,1)\n                        ) s\n                        ON  r.[Tribo] = s.[m_tribo]\n                        AND r.[M\u00eas (Primeiro Dia)] = s.[m_m\u00eas]\n    \t            \tWHERE   [M\u00eas (Primeiro Dia)] >= DATEFROMPARTS(YEAR(@datahora_inicio ),MONTH(@datahora_inicio) ,1)\n    \t            \t    AND\t[M\u00eas (Primeiro Dia)] <= DATEFROMPARTS(YEAR(@datahora_fim ),MONTH(@datahora_fim) ,1)\n    \t            \tGROUP BY [M\u00eas (Primeiro Dia)], [Tribo Completa]\n                    ) _\n                ) _\n            ) _\n    \t) AS fonte\n    \tON  fonte.[M\u00eas (Primeiro Dia)]  = destino.[M\u00eas (Primeiro Dia)]\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \tINSERT\n    \t\t(\n\t\t     [M\u00eas (Primeiro Dia)]\n\n            --[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n\t\t    ,[Cliente]\n\t\t    ,[Projeto]\n\t\t    ,[Tribo]\n\t\t    ,[Tribo Completa]\n\n\t\t    ,[Trabalhado (Ponto)]\n\t\t    ,[Em Pausa (Ponto)]\n\t\t\t,[Desvio Ponto-Log]\n\n            ,[Forecast HC Taxa 1]\n            ,[Forecast HC Taxa 2]\n            ,[Forecast Pausas Taxa 1]\n            ,[Forecast Pausas Taxa 2]\n            ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,[Forecast Volume]\n            ,[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,[Forecast Log]\n            ,[Forecast Log Produtivo]\n            ,[Forecast NS]\n            ,[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,[Forecast TMT]\n            ,[Forecast TMA]\n            ,[Forecast SLA]\n            ,[Forecast Abandono]\n            ,[Forecast NPS]\n            ,[Forecast Casos N\u00e3o Resolvidos]\n            ,[Forecast Rechamada]\n            ,[Forecast Short Call]\n            ,[Forecast Instabilidade]\n            ,[Forecast Phishing]\n\n            ,[Ader\u00eancia Log]\n            ,[Ader\u00eancia Log 102%]\n            ,[Ader\u00eancia Log Produtivo]\n            ,[Ader\u00eancia Log Produtivo 102%]\n            ,[Ader\u00eancia TMT]\n            ,[Ader\u00eancia TMA]\n            ,[Ader\u00eancia SLA]\n            ,[Ader\u00eancia NS]\n            ,[Ader\u00eancia Abandono]\n            ,[Ader\u00eancia NPS]\n            ,[Ader\u00eancia Casos N\u00e3o Resolvidos]\n\n            ,[Penalidade TMT]\n            ,[Penalidade TMA]\n            ,[Penalidade SLA]\n            ,[Penalidade NS]\n            ,[Penalidade Abandono]\n            ,[Penalidade NPS]\n            ,[Penalidade Casos N\u00e3o Resolvidos]\n\n            ,[PAs Contratadas]\n            ,[Valor da PA]\n            ,[Faturamento Antes das Penalidades]\n            ,[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,[Log]\n            ,[Log 102%]\n            ,[Log Perdido (>102%)]\n\t\t    ,[Log Produtivo]\n            ,[Log Produtivo 102%]\n            ,[Log Produtivo Perdido (>102%)]\n\t\t    ,[Log HE]\n\t\t    ,[Log descartado (>2HE)]\n\t\t    ,[Log Improdutivo]\n\t\t\t,[Tempo Total (Intelix)]\n\t\t\t,[Tempo Total (EPBX)]\n\t\t\t,[Tempo Total (Genesys)]\n\t\t\t,[Tempo Total (Secullum)]\n\t\t    ,[Tempo Livre]\n\t\t    ,[Pausa Particular (Intelix)]\n\t\t    ,[Pausa Break (Intelix)]\n\t\t    ,[Pausa 10 (Intelix)]\n\t\t    ,[Pausa Outbound (Intelix)]\n\t\t    ,[Pausa Lanche (Intelix)]\n\t\t    ,[Pausa R\u00e1pida (Intelix)]\n\t\t    ,[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,[Pausa Feedback (Intelix)]\n\t\t    ,[Pausa Sistema Interno (Intelix)]\n\t\t    ,[Pausa Sistema Externo (Intelix)]\n\t\t    ,[Pausa Treinamento (Intelix)]\n\t\t    ,[Pausa Banheiro (Intelix)]\n\t\t    ,[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,[Pausa NR17 (Intelix)]\n\t\t    ,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,[Pausa Tratativa (EPBX)]\n\t\t    ,[Pausa Discagem Manual (EPBX)]\n\t\t    ,[Pausa Banheiro (EPBX)]\n\t\t    ,[Pausa WhatsApp (EPBX)]\n\t\t    ,[Pausa Intervalo (EPBX)]\n\t\t    ,[Pausa Discagem Retorno (EPBX)]\n\t\t    ,[Pausa Treinamento (EPBX)]\n\t\t    ,[Pausa Feedback (EPBX)]\n\t\t    ,[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,[Pausa Login (EPBX)]\n\t\t    ,[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,[Pausa Sistema Interno (EPBX)]\n\t\t    ,[Pausa Sistema Externo (EPBX)]\n\t\t    ,[Pausa NR17 (EPBX)]\n\t\t    ,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,[Pausa Lanche (EPBX)]\n\t\t    ,[Pausa BackOffice (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,[Pausa Banheiro (Genesys)]\n\t \t    ,[Pausa Descanso (Genesys)]\n\t \t    ,[Pausa Feedback (Genesys)]\n\t \t    ,[Pausa Backoffice (Genesys)]\n\t \t    ,[Pausa Discagem Manual (Genesys)]\n\t \t    ,[Pausa Discagem Retorno (Genesys)]\n\t \t    ,[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,[Pausa Em Fila (Genesys)]\n\t \t    ,[Pausa Sistema Externo (Genesys)]\n\t \t    ,[Pausa Sistema Interno (Genesys)]\n\t \t    ,[Pausa Tratativa (Genesys)]\n\t \t    ,[Pausa Whatsapp (Genesys)]\n\t\t    ,[Pausa Treinamento (Genesys)]\n\n\t\t    ,[Criados]\n\t\t    ,[Tratados]\n\t\t    ,[Tempo Total de Tratativa]\n\t\t    ,[TMT]\n\t\t    ,[N\u00e3o Resolvidos]\n\t\t    ,[Replicas]\n\t\t    ,[Reincidentes 48h]\n\t\t    ,[Reincidentes 30d]\n\n            ,[SLA TPR]\n            ,[SLA TES]\n            ,[SLA TTR]\n\n\t\t    ,[Inbound - Chamadas Iniciadas]\n\t\t    ,[Inbound - Chamadas Atendidas]\n\t\t    ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Inbound - Chamadas Em Andamento]\n\t\t    ,[Inbound - Chamadas Finalizadas]\n\t\t    ,[Inbound - Chamadas Transferidas]\n\t\t    ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Inbound - Atendimentos Iniciados]\n\t\t    ,[Inbound - Atendimentos Em Andamento]\n\t\t    ,[Inbound - Atendimentos Finalizados]\n\t\t    ,[Inbound - TMC]\n\t\t    ,[Inbound - TMA]\n\t\t    ,[Inbound - TME]\n\t\t    ,[Inbound - TMO]\n\t\t    ,[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Inbound - Chamadas Abandonadas]\n\t\t    ,[Inbound - % Abandono]\n\n\t\t    ,[Outbound - Chamadas Iniciadas]\n\t\t    ,[Outbound - Chamadas Atendidas]\n\t\t    ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Outbound - Chamadas Em Andamento]\n\t\t    ,[Outbound - Chamadas Finalizadas]\n\t\t    ,[Outbound - Chamadas Transferidas]\n\t\t    ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Outbound - Atendimentos Iniciados]\n\t\t    ,[Outbound - Atendimentos Em Andamento]\n\t\t    ,[Outbound - Atendimentos Finalizados]\n\t\t    ,[Outbound - TMC]\n\t\t    ,[Outbound - TMA]\n\t\t    ,[Outbound - TME]\n\t\t    ,[Outbound - TMO]\n\t\t    ,[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Outbound - Chamadas Abandonadas]\n\t\t    ,[Outbound - % Abandono]\n\n\t\t    ,[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,[Promotoras]\n\t\t    ,[Neutras]\n\t\t    ,[Detratoras]\n\t\t    ,[NPS]\n\n\t\t    ,[Teve Evento de MOP?]\n\t\t    ,[Teve Evento de Tickets?]\n\t\t    ,[Teve Evento de Chamadas?]\n\t\t    ,[Teve Evento de NPS?]\n\t\t    ,[Teve Evento de Log?]\n\t\t    ,[Teve Evento de Forecast?]\n\n    \t\t)\n    \t\tVALUES\n    \t\t(\n\t\t     fonte.[M\u00eas (Primeiro Dia)]\n\n            --[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n\n\t\t    ,fonte.[Cliente]\n\t\t    ,fonte.[Projeto]\n\t\t    ,fonte.[Tribo]\n\t\t    ,fonte.[Tribo Completa]\n\n\t\t    ,fonte.[Trabalhado (Ponto)]\n\t\t    ,fonte.[Em Pausa (Ponto)]\n\t\t\t,fonte.[Desvio Ponto-Log]\n\n            ,fonte.[Forecast HC Taxa 1]\n            ,fonte.[Forecast HC Taxa 2]\n            ,fonte.[Forecast Pausas Taxa 1]\n            ,fonte.[Forecast Pausas Taxa 2]\n            ,fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Volume]\n            ,fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,fonte.[Forecast Log]\n            ,fonte.[Forecast Log Produtivo]\n            ,fonte.[Forecast NS]\n            ,fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,fonte.[Forecast TMT]\n            ,fonte.[Forecast TMA]\n            ,fonte.[Forecast SLA]\n            ,fonte.[Forecast Abandono]\n            ,fonte.[Forecast NPS]\n            ,fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,fonte.[Forecast Rechamada]\n            ,fonte.[Forecast Short Call]\n            ,fonte.[Forecast Instabilidade]\n            ,fonte.[Forecast Phishing]\n\n            ,fonte.[Ader\u00eancia Log]\n            ,fonte.[Ader\u00eancia Log 102%]\n            ,fonte.[Ader\u00eancia Log Produtivo]\n            ,fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,fonte.[Ader\u00eancia TMT]\n            ,fonte.[Ader\u00eancia TMA]\n            ,fonte.[Ader\u00eancia SLA]\n            ,fonte.[Ader\u00eancia NS]\n            ,fonte.[Ader\u00eancia Abandono]\n            ,fonte.[Ader\u00eancia NPS]\n            ,fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n\n            ,fonte.[Penalidade TMT]\n            ,fonte.[Penalidade TMA]\n            ,fonte.[Penalidade SLA]\n            ,fonte.[Penalidade NS]\n            ,fonte.[Penalidade Abandono]\n            ,fonte.[Penalidade NPS]\n            ,fonte.[Penalidade Casos N\u00e3o Resolvidos]\n\n            ,fonte.[PAs Contratadas]\n            ,fonte.[Valor da PA]\n            ,fonte.[Faturamento Antes das Penalidades]\n            ,fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,fonte.[Log]\n            ,fonte.[Log 102%]\n            ,fonte.[Log Perdido (>102%)]\n\t\t    ,fonte.[Log Produtivo]\n            ,fonte.[Log Produtivo 102%]\n            ,fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,fonte.[Log HE]\n\t\t    ,fonte.[Log descartado (>2HE)]\n\t\t    ,fonte.[Log Improdutivo]\n\t\t\t,fonte.[Tempo Total (Intelix)]\n\t\t\t,fonte.[Tempo Total (EPBX)]\n\t\t\t,fonte.[Tempo Total (Genesys)]\n\t\t\t,fonte.[Tempo Total (Secullum)]\n\t\t    ,fonte.[Tempo Livre]\n\t\t    ,fonte.[Pausa Particular (Intelix)]\n\t\t    ,fonte.[Pausa Break (Intelix)]\n\t\t    ,fonte.[Pausa 10 (Intelix)]\n\t\t    ,fonte.[Pausa Outbound (Intelix)]\n\t\t    ,fonte.[Pausa Lanche (Intelix)]\n\t\t    ,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,fonte.[Pausa Feedback (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,fonte.[Pausa NR17 (Intelix)]\n\t\t    ,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,fonte.[Pausa Feedback (EPBX)]\n\t\t    ,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,fonte.[Pausa Login (EPBX)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,fonte.[Pausa NR17 (EPBX)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,fonte.[Pausa Lanche (EPBX)]\n\t\t    ,fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,fonte.[Pausa Descanso (Genesys)]\n\t \t    ,fonte.[Pausa Feedback (Genesys)]\n\t \t    ,fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,fonte.[Criados]\n\t\t    ,fonte.[Tratados]\n\t\t    ,fonte.[Tempo Total de Tratativa]\n\t\t    ,fonte.[TMT]\n\t\t    ,fonte.[N\u00e3o Resolvidos]\n\t\t    ,fonte.[Replicas]\n\t\t    ,fonte.[Reincidentes 48h]\n\t\t    ,fonte.[Reincidentes 30d]\n\n            ,fonte.[SLA TPR]\n            ,fonte.[SLA TES]\n            ,fonte.[SLA TTR]\n\n\t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Inbound - TMC]\n\t\t    ,fonte.[Inbound - TMA]\n\t\t    ,fonte.[Inbound - TME]\n\t\t    ,fonte.[Inbound - TMO]\n\t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Inbound - % Abandono]\n\n\t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Outbound - TMC]\n\t\t    ,fonte.[Outbound - TMA]\n\t\t    ,fonte.[Outbound - TME]\n\t\t    ,fonte.[Outbound - TMO]\n\t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Outbound - % Abandono]\n\n\t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,fonte.[Promotoras]\n\t\t    ,fonte.[Neutras]\n\t\t    ,fonte.[Detratoras]\n\t\t    ,fonte.[NPS]\n\n\t\t    ,fonte.[Teve Evento de MOP?]\n\t\t    ,fonte.[Teve Evento de Tickets?]\n\t\t    ,fonte.[Teve Evento de Chamadas?]\n\t\t    ,fonte.[Teve Evento de NPS?]\n\t\t    ,fonte.[Teve Evento de Log?]\n\t\t    ,fonte.[Teve Evento de Forecast?]\n\n    \t\t)\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n\t\t     destino.[M\u00eas (Primeiro Dia)]\t\t\t\t                              = fonte.[M\u00eas (Primeiro Dia)]\n\n            --,destino.[Feriado (Nome)]                                     =   fonte.[Feriado (Nome)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n\t\t    ,destino.[Cliente]\t\t\t\t\t\t\t                              = fonte.[Cliente]\n\t\t    ,destino.[Projeto]\t\t\t\t\t\t\t                              = fonte.[Projeto]\n\t\t    ,destino.[Tribo]\t\t\t\t\t\t\t                              = fonte.[Tribo]\n\t\t    ,destino.[Tribo Completa]\t\t\t\t\t                              = fonte.[Tribo Completa]\n\n\t\t    ,destino.[Trabalhado (Ponto)]\t\t\t\t\t\t\t\t\t          = fonte.[Trabalhado (Ponto)]\n\t\t    ,destino.[Em Pausa (Ponto)]\t\t\t\t\t\t\t\t\t\t          = fonte.[Em Pausa (Ponto)]\n\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Desvio Ponto-Log]\n\n            ,destino.[Forecast HC Taxa 1]                                             = fonte.[Forecast HC Taxa 1]\n            ,destino.[Forecast HC Taxa 2]                                             = fonte.[Forecast HC Taxa 2]\n            ,destino.[Forecast Pausas Taxa 1]                                         = fonte.[Forecast Pausas Taxa 1]\n            ,destino.[Forecast Pausas Taxa 2]                                         = fonte.[Forecast Pausas Taxa 2]\n            ,destino.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                       = fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                   = fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t                      = fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Volume]\t\t                                          = fonte.[Forecast Volume]\n            ,destino.[Forecast Volume M\u00eas - Provis\u00f3rio]                               = fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,destino.[Forecast Log]                                                   = fonte.[Forecast Log]\n            ,destino.[Forecast Log Produtivo]                                         = fonte.[Forecast Log Produtivo]\n            ,destino.[Forecast NS]                                                    = fonte.[Forecast NS]\n            ,destino.[Forecast NS M\u00eas - Provis\u00f3rio]                                   = fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,destino.[Forecast TMT]                                                   = fonte.[Forecast TMT]\n            ,destino.[Forecast TMA]                                                   = fonte.[Forecast TMA]\n            ,destino.[Forecast SLA]                                                   = fonte.[Forecast SLA]\n            ,destino.[Forecast Abandono]                                              = fonte.[Forecast Abandono]\n            ,destino.[Forecast NPS]                                                   = fonte.[Forecast NPS]\n            ,destino.[Forecast Casos N\u00e3o Resolvidos]                                  = fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,destino.[Forecast Rechamada]                                             = fonte.[Forecast Rechamada]\n            ,destino.[Forecast Short Call]                                            = fonte.[Forecast Short Call]\n            ,destino.[Forecast Instabilidade]                                         = fonte.[Forecast Instabilidade]\n            ,destino.[Forecast Phishing]                                              = fonte.[Forecast Phishing]\n\n            ,destino.[Ader\u00eancia Log]                                                  = fonte.[Ader\u00eancia Log]\n            ,destino.[Ader\u00eancia Log 102%]                                             = fonte.[Ader\u00eancia Log 102%]\n            ,destino.[Ader\u00eancia Log Produtivo]                                        = fonte.[Ader\u00eancia Log Produtivo]\n            ,destino.[Ader\u00eancia Log Produtivo 102%]                                   = fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,destino.[Ader\u00eancia TMT]                                                  = fonte.[Ader\u00eancia TMT]\n            ,destino.[Ader\u00eancia TMA]                                                  = fonte.[Ader\u00eancia TMA]\n            ,destino.[Ader\u00eancia SLA]                                                  = fonte.[Ader\u00eancia SLA]\n            ,destino.[Ader\u00eancia NS]                                                   = fonte.[Ader\u00eancia NS]\n            ,destino.[Ader\u00eancia Abandono]                                             = fonte.[Ader\u00eancia Abandono]\n            ,destino.[Ader\u00eancia NPS]                                                  = fonte.[Ader\u00eancia NPS]\n            ,destino.[Ader\u00eancia Casos N\u00e3o Resolvidos]                                 = fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n\n            ,destino.[Penalidade TMT]                                                 = fonte.[Penalidade TMT]\n            ,destino.[Penalidade TMA]                                                 = fonte.[Penalidade TMA]\n            ,destino.[Penalidade SLA]                                                 = fonte.[Penalidade SLA]\n            ,destino.[Penalidade NS]                                                  = fonte.[Penalidade NS]\n            ,destino.[Penalidade Abandono]                                            = fonte.[Penalidade Abandono]\n            ,destino.[Penalidade NPS]                                                 = fonte.[Penalidade NPS]\n            ,destino.[Penalidade Casos N\u00e3o Resolvidos]                                = fonte.[Penalidade Casos N\u00e3o Resolvidos]\n\n            ,destino.[PAs Contratadas]                                                = fonte.[PAs Contratadas]\n            ,destino.[Valor da PA]                                                    = fonte.[Valor da PA]\n            ,destino.[Faturamento Antes das Penalidades]                              = fonte.[Faturamento Antes das Penalidades]\n            ,destino.[Faturamento Ap\u00f3s Penalidades]                                   = fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,destino.[Log]\t\t\t\t\t\t\t\t\t\t\t\t\t          = fonte.[Log]\n            ,destino.[Log 102%]                                                       = fonte.[Log 102%]\n            ,destino.[Log Perdido (>102%)]                                            = fonte.[Log Perdido (>102%)]\n\t\t    ,destino.[Log Produtivo]\t\t\t\t\t\t\t\t\t\t          = fonte.[Log Produtivo]\n            ,destino.[Log Produtivo 102%]                                             = fonte.[Log Produtivo 102%]\n            ,destino.[Log Produtivo Perdido (>102%)]                                  = fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,destino.[Log HE]\t\t\t\t\t\t\t\t\t\t\t\t\t      = fonte.[Log HE]\n\t\t    ,destino.[Log descartado (>2HE)]\t\t\t\t\t\t\t\t          = fonte.[Log descartado (>2HE)]\n\t\t    ,destino.[Log Improdutivo]\t\t\t\t\t\t\t\t\t\t          = fonte.[Log Improdutivo]\n\t\t\t,destino.[Tempo Total (Intelix)]\t\t\t\t\t\t\t\t\t\t  = fonte.[Tempo Total (Intelix)]\t\t\t\t\t\t\t\t\t\t  \n\t\t\t,destino.[Tempo Total (EPBX)]\t\t\t\t\t\t\t\t\t\t      = fonte.[Tempo Total (EPBX)]\t\t\t\t\t\t\t\t\t\t      \n\t\t\t,destino.[Tempo Total (Genesys)]\t\t\t\t\t\t\t\t\t\t  = fonte.[Tempo Total (Genesys)]\t\t\t\t\t\t\t\t\t\t  \n\t\t\t,destino.[Tempo Total (Secullum)]\t\t\t\t\t\t\t\t\t\t  = fonte.[Tempo Total (Secullum)]\t\t\t\t\t\t\t\t\t\t  \n\t\t    ,destino.[Tempo Livre]\t\t\t\t\t\t\t\t\t\t\t          = fonte.[Tempo Livre]\n\t\t    ,destino.[Pausa Particular (Intelix)]\t\t\t\t\t\t\t          = fonte.[Pausa Particular (Intelix)]\n\t\t    ,destino.[Pausa Break (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Break (Intelix)]\n\t\t    ,destino.[Pausa 10 (Intelix)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa 10 (Intelix)]\n\t\t    ,destino.[Pausa Outbound (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Outbound (Intelix)]\n\t\t    ,destino.[Pausa Lanche (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Lanche (Intelix)]\n\t\t    ,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,destino.[Pausa Feedback (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Feedback (Intelix)]\n\t\t    ,destino.[Pausa Sistema Interno (Intelix)]\t\t\t\t\t\t          = fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,destino.[Pausa Sistema Externo (Intelix)]\t\t\t\t\t\t          = fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,destino.[Pausa Treinamento (Intelix)]\t\t\t\t\t\t\t          = fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,destino.[Pausa Banheiro (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t\t\t          = fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,destino.[Pausa NR17 (Intelix)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa NR17 (Intelix)]\n\t\t    ,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,destino.[Pausa Tratativa (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,destino.[Pausa Discagem Manual (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,destino.[Pausa Banheiro (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,destino.[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,destino.[Pausa Intervalo (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,destino.[Pausa Discagem Retorno (EPBX)]\t\t\t\t\t\t          = fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,destino.[Pausa Treinamento (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,destino.[Pausa Feedback (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Feedback (EPBX)]\n\t\t    ,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,destino.[Pausa Login (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Login (EPBX)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Sistema Interno (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,destino.[Pausa Sistema Externo (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,destino.[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa NR17 (EPBX)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,destino.[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Lanche (EPBX)]\n\t\t    ,destino.[Pausa BackOffice (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,destino.[Pausa Banheiro (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,destino.[Pausa Descanso (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Descanso (Genesys)]\n\t \t    ,destino.[Pausa Feedback (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Feedback (Genesys)]\n\t \t    ,destino.[Pausa Backoffice (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,destino.[Pausa Discagem Manual (Genesys)]\t\t\t\t\t\t          = fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,destino.[Pausa Discagem Retorno (Genesys)]\t\t\t\t\t\t          = fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,destino.[Pausa Em Fila (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,destino.[Pausa Sistema Externo (Genesys)]\t\t\t\t\t\t          = fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,destino.[Pausa Sistema Interno (Genesys)]\t\t\t\t\t\t          = fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,destino.[Pausa Tratativa (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,destino.[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,destino.[Pausa Treinamento (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,destino.[Criados]\t\t\t\t\t\t\t                              = fonte.[Criados]\n\t\t    ,destino.[Tratados]\t\t\t\t\t\t\t                              = fonte.[Tratados]\n\t\t    ,destino.[Tempo Total de Tratativa]\t\t\t                              = fonte.[Tempo Total de Tratativa]\n\t\t    ,destino.[TMT]\t\t\t\t\t\t\t\t                              = fonte.[TMT]\n\t\t    ,destino.[N\u00e3o Resolvidos]\t\t\t\t\t                              = fonte.[N\u00e3o Resolvidos]\n\t\t    ,destino.[Replicas]\t\t\t\t\t\t\t                              = fonte.[Replicas]\n\t\t    ,destino.[Reincidentes 48h]\t\t\t\t\t                              = fonte.[Reincidentes 48h]\n\t\t    ,destino.[Reincidentes 30d]\t\t\t\t\t                              = fonte.[Reincidentes 30d]\n\n            ,destino.[SLA TPR]                                                        = fonte.[SLA TPR]\n            ,destino.[SLA TES]                                                        = fonte.[SLA TES]\n            ,destino.[SLA TTR]                                                        = fonte.[SLA TTR]\n\n\t\t    ,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t  = fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t  = fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t  = fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t  = fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t  = fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t  = fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t  = fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t  = fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t  = fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t  = fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - TMC]\n\t\t    ,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - TMA]\n\t\t    ,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - TME]\n\t\t    ,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - TMO]\n\t\t    ,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - % Abandono]\n\n\t\t    ,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t  = fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t  = fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t  = fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t  = fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t  = fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t  = fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t  = fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t  = fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t  = fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t  = fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t  = fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - TMC]\n\t\t    ,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - TMA]\n\t\t    ,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - TME]\n\t\t    ,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - TMO]\n\t\t    ,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t  = fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - % Abandono]\n\n\t\t    ,destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t                              = fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,destino.[Promotoras]\t\t\t\t\t\t                              = fonte.[Promotoras]\n\t\t    ,destino.[Neutras]\t\t\t\t\t\t\t                              = fonte.[Neutras]\n\t\t    ,destino.[Detratoras]\t\t\t\t\t\t                              = fonte.[Detratoras]\n\t\t    ,destino.[NPS]\t\t\t\t\t\t\t\t                              = fonte.[NPS]\n\n\t\t    ,destino.[Teve Evento de MOP?]\t\t                                      = fonte.[Teve Evento de MOP?]\n\t\t    ,destino.[Teve Evento de Tickets?]\t                                      = fonte.[Teve Evento de Tickets?]\n\t\t    ,destino.[Teve Evento de Chamadas?]\t                                      = fonte.[Teve Evento de Chamadas?]\n\t\t    ,destino.[Teve Evento de NPS?]\t\t                                      = fonte.[Teve Evento de NPS?]\n\t\t    ,destino.[Teve Evento de Log?]\t\t                                      = fonte.[Teve Evento de Log?]\n\t\t    ,destino.[Teve Evento de Forecast?]\t\t                                  = fonte.[Teve Evento de Forecast?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_tribo_m\u00eas\n        WHERE [M\u00eas (Primeiro Dia)] >= CAST(GETDATE() AS DATE)\n\t\t\tOR(\t[Teve Evento de MOP?]\t    = 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0)\n\n        UPDATE r_tribo_m\u00eas\n        SET\n            --[Data]                 = CAST([DataHora] AS DATE)\n            --[Ciclo (Primeiro Dia)] = DATEADD(DAY, (CASE WHEN (DATEPART(DAY, [Data]) > 21) THEN 4 ELSE ((DATEPART(DAY, [Data])-1)/7)+1 END-1)*7, DATEFROMPARTS(YEAR([Data]), MONTH([Data]), 1))\n            --[M\u00eas (Primeiro Dia)]   = DATEFROMPARTS(YEAR([Data]), MONTH([Data]), 1)\n             [Cliente]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),3)\n            ,[Projeto]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),2)\n            ,[Tribo]\t\t\t       = PARSENAME(REPLACE([Tribo Completa],'__','.'),1)\n\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n\n    PRINT CONCAT('Resumos atualizados (m\u00e9trica: ',@metrica,') ',@datahora_inicio,' - ',@datahora_fim, ' (dura\u00e7\u00e3o: ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio, GETDATE()), 0) as time(0)),')')\n\n\n\n\nGO\n",
        "build_order": 105,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]": [
                "UNKNOWN",
                "r_tribo_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "r_tribo_dia"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_m\u00eas]": [
                "UPDATE",
                "UPDATE r_tribo_m\u00eas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "UNKNOWN",
                "r_individuo_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": [
                "UNKNOWN",
                "r_individuo_dia"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "DELETE",
                "DELETE FROM r_individuo_m\u00eas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "UNKNOWN",
                "r_individuo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": [
                "UNKNOWN",
                "r_individuo_dia"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]": [
                "UNKNOWN",
                "r_tribo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "r_tribo_dia"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys_manual]": [
                "UNKNOWN",
                "dim_chamadas_genesys_manual"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]": [
                "UNKNOWN",
                "dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]": [
                "UNKNOWN",
                "dim_forecast_metas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": [
                "SELECT",
                "SELECT MAX([Data]) FROM [db_serasa_producao].[dbo].dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_penalidades]": [
                "SELECT",
                "SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": [
                "UNKNOWN",
                "dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_sla]": [
                "UNKNOWN",
                "dim_teste_sla"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": [
                "UNKNOWN",
                "f_nps_v2"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_prod_d-1].[dbo].[s_att_resumos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": {
        "address": "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]",
        "server": "003sql001prd",
        "database": "db_prod_d-1",
        "schema": "dbo",
        "name": "sp_sys_faxina",
        "type": "StoredProcedure",
        "start": 629330,
        "end": 629907,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_faxina]    Script Date: 2024-11-03 12:59:55 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE PROCEDURE [dbo].[sp_sys_faxina] AS\n\tALTER DATABASE [db_prod_d-1] SET RECOVERY SIMPLE;\n\tDBCC SHRINKDATABASE(N'db_prod_d-1');\n\tDBCC SHRINKFILE (N'db_prod_d-1', 0);\n\tDBCC SHRINKFILE (N'db_prod_d-1', 0);\n\tDBCC FREESYSTEMCACHE ('db_prod_d-1');\n\tDBCC FREESYSTEMCACHE ('tempdb');\n\tDBCC FREESYSTEMCACHE ('master');\n\tDBCC FREESYSTEMCACHE ('model');\n\tDBCC FREESYSTEMCACHE ('msdb');\n\tDBCC FREEPROCCACHE;\n\tDBCC FREESESSIONCACHE;\n\n\nGO\n",
        "build_order": 106,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_app].[dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0]": {
        "address": "[003sql001prd].[db_prod_d0]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "",
        "name": "",
        "type": "Database",
        "start": 17,
        "end": 2723,
        "code": "/****** Object:  Database [db_prod_d0]    Script Date: 2024-11-03 12:54:34 ******/\nCREATE DATABASE [db_prod_d0]\n CONTAINMENT = NONE\n ON  PRIMARY \n( NAME = N'db_prod_d0', FILENAME = N'C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\DATA\\db_prod_d0.mdf' , SIZE = 8192KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )\n LOG ON \n( NAME = N'db_prod_d0_log', FILENAME = N'C:\\Program Files\\Microsoft SQL Server\\MSSQL16.MSSQLSERVER\\MSSQL\\DATA\\db_prod_d0_log.ldf' , SIZE = 8192KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )\n WITH CATALOG_COLLATION = DATABASE_DEFAULT, LEDGER = OFF\nGO\nALTER DATABASE [db_prod_d0] SET COMPATIBILITY_LEVEL = 160\nGO\nIF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))\nbegin\nEXEC [db_prod_d0].[dbo].[sp_fulltext_database] @action = 'enable'\nend\nGO\nALTER DATABASE [db_prod_d0] SET ANSI_NULL_DEFAULT OFF \nGO\nALTER DATABASE [db_prod_d0] SET ANSI_NULLS OFF \nGO\nALTER DATABASE [db_prod_d0] SET ANSI_PADDING OFF \nGO\nALTER DATABASE [db_prod_d0] SET ANSI_WARNINGS OFF \nGO\nALTER DATABASE [db_prod_d0] SET ARITHABORT OFF \nGO\nALTER DATABASE [db_prod_d0] SET AUTO_CLOSE OFF \nGO\nALTER DATABASE [db_prod_d0] SET AUTO_SHRINK OFF \nGO\nALTER DATABASE [db_prod_d0] SET AUTO_UPDATE_STATISTICS ON \nGO\nALTER DATABASE [db_prod_d0] SET CURSOR_CLOSE_ON_COMMIT OFF \nGO\nALTER DATABASE [db_prod_d0] SET CURSOR_DEFAULT  GLOBAL \nGO\nALTER DATABASE [db_prod_d0] SET CONCAT_NULL_YIELDS_NULL OFF \nGO\nALTER DATABASE [db_prod_d0] SET NUMERIC_ROUNDABORT OFF \nGO\nALTER DATABASE [db_prod_d0] SET QUOTED_IDENTIFIER OFF \nGO\nALTER DATABASE [db_prod_d0] SET RECURSIVE_TRIGGERS OFF \nGO\nALTER DATABASE [db_prod_d0] SET  ENABLE_BROKER \nGO\nALTER DATABASE [db_prod_d0] SET AUTO_UPDATE_STATISTICS_ASYNC OFF \nGO\nALTER DATABASE [db_prod_d0] SET DATE_CORRELATION_OPTIMIZATION OFF \nGO\nALTER DATABASE [db_prod_d0] SET TRUSTWORTHY OFF \nGO\nALTER DATABASE [db_prod_d0] SET ALLOW_SNAPSHOT_ISOLATION OFF \nGO\nALTER DATABASE [db_prod_d0] SET PARAMETERIZATION SIMPLE \nGO\nALTER DATABASE [db_prod_d0] SET READ_COMMITTED_SNAPSHOT ON \nGO\nALTER DATABASE [db_prod_d0] SET HONOR_BROKER_PRIORITY OFF \nGO\nALTER DATABASE [db_prod_d0] SET RECOVERY SIMPLE \nGO\nALTER DATABASE [db_prod_d0] SET  MULTI_USER \nGO\nALTER DATABASE [db_prod_d0] SET PAGE_VERIFY CHECKSUM  \nGO\nALTER DATABASE [db_prod_d0] SET DB_CHAINING OFF \nGO\nALTER DATABASE [db_prod_d0] SET FILESTREAM( NON_TRANSACTED_ACCESS = OFF ) \nGO\nALTER DATABASE [db_prod_d0] SET TARGET_RECOVERY_TIME = 60 SECONDS \nGO\nALTER DATABASE [db_prod_d0] SET DELAYED_DURABILITY = DISABLED \nGO\nALTER DATABASE [db_prod_d0] SET ACCELERATED_DATABASE_RECOVERY = OFF  \nGO\nEXEC sys.sp_db_vardecimal_storage_format N'db_prod_d0', N'ON'\nGO\nALTER DATABASE [db_prod_d0] SET QUERY_STORE = OFF\nGO\nUSE [db_prod_d0]\nGO\n",
        "build_order": 107,
        "depends_on": {
            "": [
                "",
                ""
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "d_genesys_eventos",
        "type": "Table",
        "start": 2723,
        "end": 3392,
        "code": "/****** Object:  Table [dbo].[d_genesys_eventos]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_genesys_eventos](\n\t[genesys_usuario_id] [varchar](100) NOT NULL,\n\t[genesys_pausa_id] [varchar](100) NOT NULL,\n\t[datahora_inicio] [datetime] NOT NULL,\n\t[datahora_fim] [datetime] NULL,\n CONSTRAINT [d_genesys_eventos_PK] PRIMARY KEY CLUSTERED \n(\n\t[datahora_inicio] ASC,\n\t[genesys_usuario_id] ASC,\n\t[genesys_pausa_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n",
        "build_order": 108,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[d_genesys_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "d_genesys_pausas",
        "type": "Table",
        "start": 3392,
        "end": 4013,
        "code": "/****** Object:  Table [dbo].[d_genesys_pausas]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_genesys_pausas](\n\t[genesys_pausa_id] [varchar](100) NOT NULL,\n\t[tipo] [varchar](max) NOT NULL,\n\t[presenca] [varchar](max) NOT NULL,\n\t[nome] [varchar](max) NOT NULL,\n CONSTRAINT [d_genesys_pausas_PK] PRIMARY KEY CLUSTERED \n(\n\t[genesys_pausa_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 109,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_pausas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "UNKNOWN",
                "[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "d_genesys_usuarios",
        "type": "Table",
        "start": 4013,
        "end": 4712,
        "code": "/****** Object:  Table [dbo].[d_genesys_usuarios]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_genesys_usuarios](\n\t[genesys_usuario_id] [varchar](100) NOT NULL,\n\t[nome] [varchar](max) NOT NULL,\n\t[email] [varchar](max) NOT NULL,\n\t[divisao] [varchar](max) NOT NULL,\n\t[departamento] [varchar](max) NULL,\n\t[titulo] [varchar](max) NULL,\n CONSTRAINT [d_genesys_usuarios_PK] PRIMARY KEY CLUSTERED \n(\n\t[genesys_usuario_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 110,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "UNKNOWN",
                "[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "d_intelix_eventos",
        "type": "Table",
        "start": 4712,
        "end": 5469,
        "code": "/****** Object:  Table [dbo].[d_intelix_eventos]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_intelix_eventos](\n\t[intelix_usuario_id] [int] NOT NULL,\n\t[evento] [varchar](100) NOT NULL,\n\t[nome_pausa] [varchar](100) NOT NULL,\n\t[datahora_inicio] [datetime] NOT NULL,\n\t[datahora_fim] [datetime] NULL,\n\t[complemento] [varchar](max) NULL,\n CONSTRAINT [d_intelix_eventos_PK] PRIMARY KEY CLUSTERED \n(\n\t[datahora_inicio] ASC,\n\t[intelix_usuario_id] ASC,\n\t[evento] ASC,\n\t[nome_pausa] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 111,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[d_intelix_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "d_intelix_usuarios",
        "type": "Table",
        "start": 5469,
        "end": 6021,
        "code": "/****** Object:  Table [dbo].[d_intelix_usuarios]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[d_intelix_usuarios](\n\t[intelix_usuario_id] [int] NOT NULL,\n\t[nome] [varchar](max) NOT NULL,\n CONSTRAINT [d_intelix_usuarios_PK] PRIMARY KEY CLUSTERED \n(\n\t[intelix_usuario_id] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 112,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "UNKNOWN",
                "[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "UNKNOWN",
                "[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[f_log]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[f_log]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "f_log",
        "type": "Table",
        "start": 6021,
        "end": 6758,
        "code": "/****** Object:  Table [dbo].[f_log]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_log](\n\t[Fonte] [varchar](10) NOT NULL,\n\t[ID Selecionar] [varchar](10) NULL,\n\t[ID Intelix] [int] NULL,\n\t[ID Genesys] [varchar](100) NULL,\n\t[Evento] [varchar](100) NOT NULL,\n\t[In\u00edcio] [datetime] NOT NULL,\n\t[Fim] [datetime] NOT NULL,\n\t[Dura\u00e7\u00e3o] [decimal](16, 3) NOT NULL,\n CONSTRAINT [f_log_UQ01] UNIQUE NONCLUSTERED \n(\n\t[Fonte] ASC,\n\t[ID Intelix] ASC,\n\t[ID Genesys] ASC,\n\t[Evento] ASC,\n\t[In\u00edcio] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n",
        "build_order": 113,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_log"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "ALTER",
                "ALTER TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado_semTrava]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_log]": [
                "SELECT",
                "SELECT * FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "SELECT",
                "SELECT [Retorno]=CONCAT('f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": [
                "SELECT",
                "SELECT SUM(sub.[Dura\u00e7\u00e3o]) - (c.[Jornada (Log)]+7200000) FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_log"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "r_individuo_30min",
        "type": "Table",
        "start": 6758,
        "end": 16517,
        "code": "/****** Object:  Table [dbo].[r_individuo_30min]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_individuo_30min](\n\t[DataHora] [datetime2](3) NOT NULL,\n\t[Intervalo] [time](3) NULL,\n\t[Data] [date] NULL,\n\t[Ciclo (Primeiro Dia)] [date] NULL,\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Feriado (Nome)] [varchar](50) NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[DataHora da Atualiza\u00e7\u00e3o do MOP] [datetime2](0) NULL,\n\t[ID Selecionar] [varchar](30) NULL,\n\t[Nome] [varchar](100) NULL,\n\t[Status] [varchar](25) NULL,\n\t[Situa\u00e7\u00e3o] [varchar](25) NULL,\n\t[Condi\u00e7\u00e3o] [varchar](25) NULL,\n\t[DMA Inicial] [int] NULL,\n\t[\u00daltima DMA Migra\u00e7\u00e3o] [int] NULL,\n\t[\u00daltima DMA Geral] [int] NULL,\n\t[Tipo da \u00daltima DMA] [varchar](50) NULL,\n\t[Instrutor Inicial] [varchar](100) NULL,\n\t[Instrutor \u00daltima Migra\u00e7\u00e3o] [varchar](100) NULL,\n\t[Instrutor \u00daltima DMA] [varchar](100) NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Cargo] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Supervis\u00e3o] [varchar](100) NULL,\n\t[Turno] [varchar](10) NULL,\n\t[Escala (Ponto)] [varchar](15) NULL,\n\t[Jornada (Ponto)] [int] NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Escala (MOP)] [varchar](15) NULL,\n\t[Jornada (Log)] [int] NOT NULL,\n\t[Tipo de Jornada] [varchar](25) NULL,\n\t[Login] [time](3) NULL,\n\t[Logout] [time](3) NULL,\n\t[Log descartado (>2HE)] [decimal](18, 4) NOT NULL,\n\t[Log HE] [decimal](18, 4) NOT NULL,\n\t[Log] [decimal](18, 4) NOT NULL,\n\t[Log Produtivo] [decimal](18, 4) NOT NULL,\n\t[Log Improdutivo] [decimal](18, 4) NOT NULL,\n\t[Tempo Livre] [decimal](18, 4) NOT NULL,\n\t[Pausa Particular (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Break (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa 10 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Outbound (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Intervalo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Login (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa BackOffice (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Descanso (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Backoffice (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Em Fila (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [decimal](18, 4) NOT NULL,\n\t[Inbound - TMA] [decimal](18, 4) NOT NULL,\n\t[Inbound - TME] [decimal](18, 4) NOT NULL,\n\t[Inbound - TMO] [decimal](18, 4) NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [decimal](18, 4) NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [decimal](18, 4) NOT NULL,\n\t[Outbound - TMA] [decimal](18, 4) NOT NULL,\n\t[Outbound - TME] [decimal](18, 4) NOT NULL,\n\t[Outbound - TMO] [decimal](18, 4) NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[NPS] [int] NULL,\n\t[\u00c9 A Tribo do MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Email Supervis\u00e3o] [varchar](100) NULL,\n\t[Login (Ponto)] [time](3) NULL,\n\t[Logout (Ponto)] [time](3) NULL,\n\t[Tipo de Jornada (Ponto)] [varchar](25) NULL,\n\t[Tempo de Casa (Dias)] [int] NULL,\n\t[Faixa Tempo de Casa] [varchar](15) NULL,\n\t[Idade] [int] NULL,\n\t[Faixa de Idade] [varchar](16) NULL,\n\t[Desvio Ponto-Log] [int] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 114,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_30min]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "r_individuo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_individuo_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT * INTO r_individuo_30m_mili FROM r_individuo_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "r_individuo_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON [r_individuo_30min]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "r_individuo_dia",
        "type": "Table",
        "start": 16517,
        "end": 25194,
        "code": "/****** Object:  Table [dbo].[r_individuo_dia]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_individuo_dia](\n\t[Data] [date] NULL,\n\t[Ciclo (Primeiro Dia)] [date] NULL,\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Feriado (Nome)] [varchar](50) NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[DataHora da Atualiza\u00e7\u00e3o do MOP] [datetime2](0) NULL,\n\t[ID Selecionar] [varchar](30) NULL,\n\t[Nome] [varchar](100) NULL,\n\t[Status] [varchar](25) NULL,\n\t[Situa\u00e7\u00e3o] [varchar](25) NULL,\n\t[Condi\u00e7\u00e3o] [varchar](25) NULL,\n\t[DMA Inicial] [int] NULL,\n\t[\u00daltima DMA Migra\u00e7\u00e3o] [int] NULL,\n\t[\u00daltima DMA Geral] [int] NULL,\n\t[Tipo da \u00daltima DMA] [varchar](50) NULL,\n\t[Instrutor Inicial] [varchar](100) NULL,\n\t[Instrutor \u00daltima Migra\u00e7\u00e3o] [varchar](100) NULL,\n\t[Instrutor \u00daltima DMA] [varchar](100) NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Cargo] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Supervis\u00e3o] [varchar](100) NULL,\n\t[Turno] [varchar](10) NULL,\n\t[Escala (Ponto)] [varchar](15) NULL,\n\t[Jornada (Ponto)] [int] NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Escala (MOP)] [varchar](15) NULL,\n\t[Jornada (Log)] [int] NOT NULL,\n\t[Tipo de Jornada] [varchar](25) NULL,\n\t[Login] [time](0) NULL,\n\t[Logout] [time](0) NULL,\n\t[Log descartado (>2HE)] [int] NOT NULL,\n\t[Log HE] [int] NOT NULL,\n\t[Log] [int] NOT NULL,\n\t[Log Produtivo] [int] NOT NULL,\n\t[Log Improdutivo] [int] NOT NULL,\n\t[Tempo Livre] [int] NOT NULL,\n\t[Pausa Particular (Intelix)] [int] NOT NULL,\n\t[Pausa Break (Intelix)] [int] NOT NULL,\n\t[Pausa 10 (Intelix)] [int] NOT NULL,\n\t[Pausa Outbound (Intelix)] [int] NOT NULL,\n\t[Pausa Lanche (Intelix)] [int] NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [int] NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [int] NOT NULL,\n\t[Pausa Feedback (Intelix)] [int] NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [int] NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [int] NOT NULL,\n\t[Pausa Treinamento (Intelix)] [int] NOT NULL,\n\t[Pausa Banheiro (Intelix)] [int] NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [int] NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [int] NOT NULL,\n\t[Pausa NR17 (Intelix)] [int] NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [int] NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [int] NOT NULL,\n\t[Pausa Tratativa (EPBX)] [int] NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [int] NOT NULL,\n\t[Pausa Banheiro (EPBX)] [int] NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [int] NOT NULL,\n\t[Pausa Intervalo (EPBX)] [int] NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [int] NOT NULL,\n\t[Pausa Treinamento (EPBX)] [int] NOT NULL,\n\t[Pausa Feedback (EPBX)] [int] NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [int] NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [int] NOT NULL,\n\t[Pausa Login (EPBX)] [int] NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [int] NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [int] NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [int] NOT NULL,\n\t[Pausa NR17 (EPBX)] [int] NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [int] NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [int] NOT NULL,\n\t[Pausa Lanche (EPBX)] [int] NOT NULL,\n\t[Pausa BackOffice (EPBX)] [int] NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [int] NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [int] NOT NULL,\n\t[Pausa Banheiro (Genesys)] [int] NOT NULL,\n\t[Pausa Descanso (Genesys)] [int] NOT NULL,\n\t[Pausa Feedback (Genesys)] [int] NOT NULL,\n\t[Pausa Backoffice (Genesys)] [int] NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [int] NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [int] NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [int] NOT NULL,\n\t[Pausa Em Fila (Genesys)] [int] NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [int] NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [int] NOT NULL,\n\t[Pausa Tratativa (Genesys)] [int] NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [int] NOT NULL,\n\t[Pausa Treinamento (Genesys)] [int] NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [int] NOT NULL,\n\t[Inbound - TMA] [int] NOT NULL,\n\t[Inbound - TME] [int] NOT NULL,\n\t[Inbound - TMO] [int] NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [int] NOT NULL,\n\t[Outbound - TMA] [int] NOT NULL,\n\t[Outbound - TME] [int] NOT NULL,\n\t[Outbound - TMO] [int] NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[NPS] [int] NULL,\n\t[\u00c9 A Tribo do MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Email Supervis\u00e3o] [varchar](100) NULL,\n\t[Login (Ponto)] [time](3) NULL,\n\t[Logout (Ponto)] [time](3) NULL,\n\t[Tipo de Jornada (Ponto)] [varchar](25) NULL,\n\t[Tempo de Casa (Dias)] [int] NULL,\n\t[Faixa Tempo de Casa] [varchar](15) NULL,\n\t[Idade] [int] NULL,\n\t[Faixa de Idade] [varchar](16) NULL,\n\t[Desvio Ponto-Log] [int] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 115,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_dia]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "r_individuo_dia"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_individuo_dia"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "SELECT",
                "SELECT * FROM [r_individuo_dia]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON [r_individuo_dia]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "r_tribo_30min",
        "type": "Table",
        "start": 25194,
        "end": 36030,
        "code": "/****** Object:  Table [dbo].[r_tribo_30min]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_tribo_30min](\n\t[DataHora] [datetime2](3) NOT NULL,\n\t[Intervalo] [time](3) NULL,\n\t[Data] [date] NULL,\n\t[Ciclo (Primeiro Dia)] [date] NULL,\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Feriado (Nome)] [varchar](50) NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Forecast HC Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast HC Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast PA Liquida (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Volume] [decimal](18, 4) NULL,\n\t[Forecast Log] [decimal](18, 4) NULL,\n\t[Forecast Log Produtivo] [decimal](18, 4) NULL,\n\t[Forecast NS] [decimal](18, 4) NULL,\n\t[Forecast TMT] [decimal](18, 4) NULL,\n\t[Forecast TMA] [decimal](18, 4) NULL,\n\t[Forecast SLA] [decimal](18, 4) NULL,\n\t[Forecast Abandono] [decimal](18, 4) NULL,\n\t[Forecast NPS] [decimal](18, 4) NULL,\n\t[Forecast Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Forecast Rechamada] [decimal](18, 4) NULL,\n\t[Forecast Short Call] [decimal](18, 4) NULL,\n\t[Forecast Instabilidade] [decimal](18, 4) NULL,\n\t[Forecast Phishing] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMT] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia SLA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia NS] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Abandono] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Log] [decimal](18, 4) NOT NULL,\n\t[Log 102%] [decimal](18, 4) NULL,\n\t[Log Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log Produtivo] [decimal](18, 4) NOT NULL,\n\t[Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Log Produtivo Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log HE] [decimal](18, 4) NOT NULL,\n\t[Log descartado (>2HE)] [decimal](18, 4) NOT NULL,\n\t[Log Improdutivo] [decimal](18, 4) NOT NULL,\n\t[Tempo Livre] [decimal](18, 4) NOT NULL,\n\t[Pausa Particular (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Break (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa 10 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Outbound (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Intervalo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Login (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa BackOffice (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Descanso (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Backoffice (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Em Fila (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[SLA TPR] [int] NULL,\n\t[SLA TES] [int] NULL,\n\t[SLA TTR] [int] NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [int] NOT NULL,\n\t[Inbound - TMA] [int] NOT NULL,\n\t[Inbound - TME] [int] NOT NULL,\n\t[Inbound - TMO] [int] NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [int] NOT NULL,\n\t[Outbound - TMA] [int] NOT NULL,\n\t[Outbound - TME] [int] NOT NULL,\n\t[Outbound - TMO] [int] NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[Genesys Provis\u00f3rio - Oferta] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - Resposta] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - Em Espera] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - Transferir] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - Abandono] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - % Resposta] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - % NS] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - % Alvos do NS] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - VMA] [decimal](18, 4) NOT NULL,\n\t[Genesys Provis\u00f3rio - TPC] [decimal](18, 4) NOT NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Teve Evento de Forecast?] [tinyint] NOT NULL,\n\t[Desvio Ponto-Log] [bigint] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 116,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_30min]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_30min]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_30min]": [
                "UNKNOWN",
                "r_tribo_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "r_tribo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_tribo_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_tribo_30min]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "r_tribo_dia",
        "type": "Table",
        "start": 36030,
        "end": 47213,
        "code": "/****** Object:  Table [dbo].[r_tribo_dia]    Script Date: 2024-11-03 12:54:34 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[r_tribo_dia](\n\t[Data] [date] NULL,\n\t[Ciclo (Primeiro Dia)] [date] NULL,\n\t[M\u00eas (Primeiro Dia)] [date] NULL,\n\t[Feriado (Nome)] [varchar](50) NULL,\n\t[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] [int] NULL,\n\t[Secullum - Suspens\u00e3o por advert\u00eancia] [int] NULL,\n\t[Secullum - Servi\u00e7o Militar] [int] NULL,\n\t[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)] [int] NULL,\n\t[Secullum - Licen\u00e7a Paternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Maternidade] [int] NULL,\n\t[Secullum - Licen\u00e7a Luto (Atestado Obito)] [int] NULL,\n\t[Secullum - Licen\u00e7a Casamento] [int] NULL,\n\t[Secullum - INSS - Afastamento] [int] NULL,\n\t[Secullum - Folga] [int] NULL,\n\t[Secullum - F\u00e9rias] [int] NULL,\n\t[Secullum - Feriado] [int] NULL,\n\t[Secullum - Falta Justificada] [int] NULL,\n\t[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)] [int] NULL,\n\t[Secullum - Falta Injustificada] [int] NULL,\n\t[Secullum - Prova de Vestibular / ENEM] [int] NULL,\n\t[Secullum - Doa\u00e7\u00e3o de Sangue] [int] NULL,\n\t[Secullum - Desligue] [int] NULL,\n\t[Secullum - Convoca\u00e7\u00e3o Judicial] [int] NULL,\n\t[Secullum - Compensando Horas] [int] NULL,\n\t[Secullum - Atestado] [int] NULL,\n\t[Secullum - Abono] [int] NULL,\n\t[Secullum - Abono Lactante] [int] NULL,\n\t[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)] [int] NULL,\n\t[Faltas Justificadas] [int] NULL,\n\t[Faltas Injustificadas] [int] NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Tribo Completa] [varchar](150) NOT NULL,\n\t[Trabalhado (Ponto)] [int] NOT NULL,\n\t[Em Pausa (Ponto)] [int] NOT NULL,\n\t[Forecast HC Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast HC Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 1] [decimal](18, 4) NULL,\n\t[Forecast Pausas Taxa 2] [decimal](18, 4) NULL,\n\t[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast PA Liquida (VOZ) - Provis\u00f3rio] [decimal](18, 4) NULL,\n\t[Forecast Volume] [decimal](18, 4) NULL,\n\t[Forecast Log] [decimal](18, 4) NULL,\n\t[Forecast Log Produtivo] [decimal](18, 4) NULL,\n\t[Forecast NS] [decimal](18, 4) NULL,\n\t[Forecast TMT] [decimal](18, 4) NULL,\n\t[Forecast TMA] [decimal](18, 4) NULL,\n\t[Forecast SLA] [decimal](18, 4) NULL,\n\t[Forecast Abandono] [decimal](18, 4) NULL,\n\t[Forecast NPS] [decimal](18, 4) NULL,\n\t[Forecast Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Forecast Rechamada] [decimal](18, 4) NULL,\n\t[Forecast Short Call] [decimal](18, 4) NULL,\n\t[Forecast Instabilidade] [decimal](18, 4) NULL,\n\t[Forecast Phishing] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMT] [decimal](18, 4) NULL,\n\t[Ader\u00eancia TMA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia SLA] [decimal](18, 4) NULL,\n\t[Ader\u00eancia NS] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Abandono] [decimal](18, 4) NULL,\n\t[Ader\u00eancia NPS] [decimal](18, 4) NULL,\n\t[Ader\u00eancia Casos N\u00e3o Resolvidos] [decimal](18, 4) NULL,\n\t[Log] [decimal](18, 4) NOT NULL,\n\t[Log 102%] [decimal](18, 4) NULL,\n\t[Log Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log Produtivo] [decimal](18, 4) NOT NULL,\n\t[Log Produtivo 102%] [decimal](18, 4) NULL,\n\t[Log Produtivo Perdido (>102%)] [decimal](18, 4) NULL,\n\t[Log HE] [decimal](18, 4) NOT NULL,\n\t[Log descartado (>2HE)] [decimal](18, 4) NOT NULL,\n\t[Log Improdutivo] [decimal](18, 4) NOT NULL,\n\t[Tempo Livre] [decimal](18, 4) NOT NULL,\n\t[Pausa Particular (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Break (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa 10 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Outbound (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa R\u00e1pida (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (Intelix)] [decimal](18, 4) NOT NULL,\n\t[Pausa Liga\u00e7\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa WhatsApp (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Intervalo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Transfer\u00eancia (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa N\u00e3o Disponivel (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Login (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Reuni\u00e3o (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa NR17 (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa P\u00f3s Atendimento (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Lanche (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa BackOffice (EPBX)] [decimal](18, 4) NOT NULL,\n\t[Pausa Almo\u00e7o (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Ambulat\u00f3rio (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Banheiro (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Descanso (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Feedback (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Backoffice (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Manual (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Discagem Retorno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Dispon\u00edvel (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Em Fila (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Externo (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Sistema Interno (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Tratativa (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Whatsapp (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Pausa Treinamento (Genesys)] [decimal](18, 4) NOT NULL,\n\t[Criados] [int] NOT NULL,\n\t[Tratados] [int] NOT NULL,\n\t[Tempo Total de Tratativa] [int] NOT NULL,\n\t[TMT] [int] NOT NULL,\n\t[N\u00e3o Resolvidos] [int] NOT NULL,\n\t[Replicas] [int] NOT NULL,\n\t[Reincidentes 48h] [int] NOT NULL,\n\t[Reincidentes 30d] [int] NOT NULL,\n\t[SLA TPR] [int] NULL,\n\t[SLA TES] [int] NULL,\n\t[SLA TTR] [int] NULL,\n\t[Inbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Inbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Inbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Inbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Inbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Inbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Inbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Inbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Inbound - TMC] [int] NOT NULL,\n\t[Inbound - TMA] [int] NOT NULL,\n\t[Inbound - TME] [int] NOT NULL,\n\t[Inbound - TMO] [int] NOT NULL,\n\t[Inbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Inbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Inbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Iniciadas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas] [int] NOT NULL,\n\t[Outbound - Chamadas Atendidas Em At\u00e9 20s] [int] NOT NULL,\n\t[Outbound - Chamadas Em Andamento] [int] NOT NULL,\n\t[Outbound - Chamadas Finalizadas] [int] NOT NULL,\n\t[Outbound - Chamadas Transferidas] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Independente do Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Chamada (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Atendimento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Espera (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Tempo Em Encerramento (Neste Intervalo)] [int] NOT NULL,\n\t[Outbound - Atendimentos Iniciados] [int] NOT NULL,\n\t[Outbound - Atendimentos Em Andamento] [int] NOT NULL,\n\t[Outbound - Atendimentos Finalizados] [int] NOT NULL,\n\t[Outbound - TMC] [int] NOT NULL,\n\t[Outbound - TMA] [int] NOT NULL,\n\t[Outbound - TME] [int] NOT NULL,\n\t[Outbound - TMO] [int] NOT NULL,\n\t[Outbound - % Nivel de Servi\u00e7o] [decimal](18, 4) NOT NULL,\n\t[Outbound - Chamadas Abandonadas] [int] NOT NULL,\n\t[Outbound - % Abandono] [decimal](18, 4) NOT NULL,\n\t[Avalia\u00e7\u00f5es de NPS] [int] NOT NULL,\n\t[Promotoras] [int] NOT NULL,\n\t[Neutras] [int] NOT NULL,\n\t[Detratoras] [int] NOT NULL,\n\t[NPS] [int] NULL,\n\t[Teve Evento de MOP?] [tinyint] NOT NULL,\n\t[Teve Evento de Tickets?] [tinyint] NOT NULL,\n\t[Teve Evento de Chamadas?] [tinyint] NOT NULL,\n\t[Teve Evento de NPS?] [tinyint] NOT NULL,\n\t[Teve Evento de Log?] [tinyint] NOT NULL,\n\t[Teve Evento de Forecast?] [tinyint] NOT NULL,\n\t[Desvio Ponto-Log] [bigint] NULL\n) ON [PRIMARY]\nGO\nALTER TABLE [dbo].[d_genesys_eventos]  WITH CHECK ADD  CONSTRAINT [d_genesys_eventos_FK01] FOREIGN KEY([genesys_usuario_id])\nREFERENCES [dbo].[d_genesys_usuarios] ([genesys_usuario_id])\nGO\nALTER TABLE [dbo].[d_genesys_eventos] CHECK CONSTRAINT [d_genesys_eventos_FK01]\nGO\nALTER TABLE [dbo].[d_genesys_eventos]  WITH CHECK ADD  CONSTRAINT [d_genesys_eventos_FK02] FOREIGN KEY([genesys_pausa_id])\nREFERENCES [dbo].[d_genesys_pausas] ([genesys_pausa_id])\nGO\nALTER TABLE [dbo].[d_genesys_eventos] CHECK CONSTRAINT [d_genesys_eventos_FK02]\nGO\nALTER TABLE [dbo].[d_intelix_eventos]  WITH CHECK ADD  CONSTRAINT [d_intelix_eventos_FK01] FOREIGN KEY([intelix_usuario_id])\nREFERENCES [dbo].[d_intelix_usuarios] ([intelix_usuario_id])\nGO\nALTER TABLE [dbo].[d_intelix_eventos] CHECK CONSTRAINT [d_intelix_eventos_FK01]\nGO\nALTER TABLE [dbo].[f_log]  WITH CHECK ADD  CONSTRAINT [f_log_FK01] FOREIGN KEY([ID Intelix])\nREFERENCES [dbo].[d_intelix_usuarios] ([intelix_usuario_id])\nGO\nALTER TABLE [dbo].[f_log] CHECK CONSTRAINT [f_log_FK01]\nGO\nALTER TABLE [dbo].[f_log]  WITH CHECK ADD  CONSTRAINT [f_log_FK02] FOREIGN KEY([ID Genesys])\nREFERENCES [dbo].[d_genesys_usuarios] ([genesys_usuario_id])\nGO\nALTER TABLE [dbo].[f_log] CHECK CONSTRAINT [f_log_FK02]\nGO\n",
        "build_order": 117,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_dia]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "ALTER",
                "ALTER TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "[d_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "[d_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "ALTER",
                "ALTER TABLE [dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "[d_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "ALTER",
                "ALTER TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_dia]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "ALTER",
                "ALTER TABLE [dbo].[f_log]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_dia]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[vw_faturamento_dia]": [
                "UNKNOWN",
                "r_tribo_dia"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "r_tribo_dia"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "CREATE",
                "CREATE TABLE [dbo].[r_tribo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "DELETE",
                "DELETE FROM r_tribo_dia"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_tribo_dia]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "s_att_genesys_eventos",
        "type": "StoredProcedure",
        "start": 47213,
        "end": 48740,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_genesys_eventos]    Script Date: 2024-11-03 12:54:35 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_genesys_eventos] @genesys_usuario_id [VARCHAR](100), @genesys_pausa_id [VARCHAR](100), @datahora_inicio [DATETIMEOFFSET], @datahora_fim  [DATETIMEOFFSET]\nAS\n    MERGE d_genesys_eventos AS destino\n    USING (\n        SELECT\n             [genesys_usuario_id]   = @genesys_usuario_id\n            ,[genesys_pausa_id]     = @genesys_pausa_id\n            ,[datahora_inicio]      = CONVERT([DATETIME], @datahora_inicio AT TIME ZONE 'Bahia Standard Time')\n            ,[datahora_fim]         = IIF(@datahora_fim = CAST('1900-01-01 00:00:00' AS [DATETIMEOFFSET]), NULL, CONVERT([DATETIME], @datahora_fim AT TIME ZONE 'Bahia Standard Time'))\n    ) AS fonte\n    ON  destino.[genesys_usuario_id]    = fonte.[genesys_usuario_id]\n    AND destino.[genesys_pausa_id]      = fonte.[genesys_pausa_id]\n    AND destino.[datahora_inicio]       = fonte.[datahora_inicio]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([genesys_usuario_id], [genesys_pausa_id], [datahora_inicio], [datahora_fim])\n        VALUES(fonte.[genesys_usuario_id], fonte.[genesys_pausa_id], fonte.[datahora_inicio], fonte.[datahora_fim])\n    WHEN MATCHED AND (\n            COALESCE(destino.[datahora_fim], '1900-01-01 00:00:00')  <> COALESCE(fonte.[datahora_fim], '1900-01-01 00:00:00')\n    )\n    THEN\n        UPDATE SET\n            destino.[datahora_fim]      = fonte.[datahora_fim]\n;\n\nGO\n",
        "build_order": 118,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "s_att_genesys_pausas",
        "type": "StoredProcedure",
        "start": 48740,
        "end": 49914,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_genesys_pausas]    Script Date: 2024-11-03 12:54:35 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_genesys_pausas] @genesys_pausa_id [VARCHAR](100), @tipo [VARCHAR](MAX), @presenca [VARCHAR](MAX), @nome [VARCHAR](MAX)\nAS\n    MERGE d_genesys_pausas AS destino\n    USING (\n        SELECT\n             [genesys_pausa_id]   = @genesys_pausa_id\n            ,[tipo]               = @tipo\n            ,[presenca]           = @presenca\n            ,[nome]               = @nome\n    ) AS fonte\n    ON  destino.[genesys_pausa_id] = fonte.[genesys_pausa_id]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([genesys_pausa_id], [tipo], [presenca], [nome])\n        VALUES(fonte.[genesys_pausa_id], fonte.[tipo], fonte.[presenca], fonte.[nome])\n    WHEN MATCHED AND (\n            destino.[tipo]      <> fonte.[tipo]\n        OR  destino.[presenca]  <> fonte.[presenca]\n        OR  destino.[nome]      <> fonte.[nome]\n    )\n    THEN\n        UPDATE SET\n             destino.[tipo]      = fonte.[tipo]\n            ,destino.[presenca]  = fonte.[presenca]\n            ,destino.[nome]      = fonte.[nome]\n;\n\nGO\n",
        "build_order": 119,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "s_att_genesys_usuarios",
        "type": "StoredProcedure",
        "start": 49914,
        "end": 51662,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_genesys_usuarios]    Script Date: 2024-11-03 12:54:35 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_genesys_usuarios] @genesys_usuario_id [VARCHAR](100), @nome [VARCHAR](MAX), @email [VARCHAR](MAX), @divisao [VARCHAR](MAX), @departamento [VARCHAR](MAX), @titulo [VARCHAR](MAX)\nAS\n    MERGE d_genesys_usuarios AS destino\n    USING (\n        SELECT\n             [genesys_usuario_id]   = @genesys_usuario_id\n            ,[nome]                 = @nome\n            ,[email]                = @email\n            ,[divisao]              = @divisao\n            ,[departamento]         = @departamento\n            ,[titulo]               = @titulo\n    ) AS fonte\n    ON  destino.[genesys_usuario_id] = fonte.[genesys_usuario_id]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([genesys_usuario_id], [nome], [email], [divisao], [departamento], [titulo])\n        VALUES(fonte.[genesys_usuario_id], fonte.[nome], fonte.[email], fonte.[divisao], fonte.[departamento], fonte.[titulo])\n    WHEN MATCHED AND (\n            destino.[nome]                   <> fonte.[nome]\n        OR  destino.[email]                  <> fonte.[email]\n        OR  destino.[divisao]                <> fonte.[divisao]\n        OR  COALESCE(destino.[departamento], '-') <> COALESCE(fonte.[departamento], '-')\n        OR  COALESCE(destino.[titulo], '-')       <> COALESCE(fonte.[titulo], '-')\n    )\n    THEN\n        UPDATE SET\n             destino.[nome]         = fonte.[nome]\n            ,destino.[email]        = fonte.[email]\n            ,destino.[divisao]      = fonte.[divisao]\n            ,destino.[departamento] = fonte.[departamento]\n            ,destino.[titulo]       = fonte.[titulo]\n;\n\nGO\n",
        "build_order": 120,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "s_att_intelix_eventos",
        "type": "StoredProcedure",
        "start": 51662,
        "end": 53418,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_intelix_eventos]    Script Date: 2024-11-03 12:54:35 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_intelix_eventos] @intelix_usuario_id [INT], @datahora_inicio [DATETIME], @datahora_fim [DATETIME], @nome_pausa[VARCHAR](MAX), @evento[VARCHAR](MAX), @complemento[VARCHAR](MAX)\nAS\n    MERGE d_intelix_eventos AS destino\n    USING (\n        SELECT\n             [intelix_usuario_id]   = @intelix_usuario_id\n            ,[evento]               = @evento\n            ,[nome_pausa]           = @nome_pausa\n            ,[datahora_inicio]      = @datahora_inicio\n            ,[datahora_fim]         = IIF(@datahora_fim = CAST('1900-01-01 00:00:00' AS [DATETIME]), NULL, @datahora_fim)\n            ,[complemento]          = @complemento\n    ) AS fonte\n    ON  destino.[intelix_usuario_id] = fonte.[intelix_usuario_id]\n    AND destino.[evento]             = fonte.[evento]\n    AND destino.[nome_pausa]         = fonte.[nome_pausa]\n    AND destino.[datahora_inicio]    = fonte.[datahora_inicio]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([intelix_usuario_id], [evento], [nome_pausa], [datahora_inicio], [datahora_fim], [complemento])\n        VALUES(fonte.[intelix_usuario_id], fonte.[evento], fonte.[nome_pausa], fonte.[datahora_inicio], fonte.[datahora_fim], fonte.[complemento])\n    WHEN MATCHED AND (\n            COALESCE(destino.[datahora_fim], '1900-01-01 00:00:00')  <> COALESCE(fonte.[datahora_fim], '1900-01-01 00:00:00')\n        OR  COALESCE(destino.[complemento], '-')   <> COALESCE(fonte.[complemento], '-')\n    )\n    THEN\n        UPDATE SET\n             destino.[datahora_fim]  = fonte.[datahora_fim]\n            ,destino.[complemento]   = fonte.[complemento]\n;\n\nGO\n",
        "build_order": 121,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "s_att_intelix_usuarios",
        "type": "StoredProcedure",
        "start": 53418,
        "end": 54175,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_intelix_usuarios]    Script Date: 2024-11-03 12:54:35 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_intelix_usuarios] @intelix_usuario_id [INT], @nome [VARCHAR](MAX)\nAS\n    MERGE d_intelix_usuarios AS destino\n    USING (\n        SELECT\n             [intelix_usuario_id] = @intelix_usuario_id\n            ,[nome] = @nome\n    ) AS fonte\n    ON destino.[intelix_usuario_id] = fonte.[intelix_usuario_id]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([intelix_usuario_id], [nome])\n        VALUES(fonte.[intelix_usuario_id], fonte.[nome])\n    WHEN MATCHED\n        AND destino.[nome] <> fonte.[nome]\n    THEN\n        UPDATE SET\n            destino.[nome] = fonte.[nome]\n;\n\nGO\n",
        "build_order": 122,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "s_att_log",
        "type": "StoredProcedure",
        "start": 54175,
        "end": 60231,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_log]    Script Date: 2024-11-03 12:54:35 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_log] @fonte [VARCHAR](50) = NULL\nAS\n    DECLARE @null_logoff DATETIME = GETDATE()\n\n\tIF @fonte IS NULL OR @fonte='INTELIX' BEGIN\n\t\tPRINT 'INTELIX';\n\t\tWITH destino AS (\n\t\t\tSELECT * FROM [f_log]\n\t\t\tWHERE\t[Fonte]\t = 'INTELIX'\n\t\t)\n\t\tMERGE INTO destino USING (\n\t\t\tSELECT\n\t\t\t\t [Fonte]\t\t\t= 'INTELIX'\n\t\t\t\t,[ID Selecionar]\t= MAX([ID Selecionar])\n\t\t\t\t,[ID Intelix]\t\t= [intelix_usuario_id]\n\t\t\t\t,[ID Genesys]\t\t= NULL\n\t\t\t\t,[Evento]\t\t\t= [evento]\n\t\t\t\t,[In\u00edcio]\t\t\t= [datahora_inicio]\n\t\t\t\t,[Fim]\t\t\t\t= MAX([datahora_fim])\n\t\t\t\t,[Dura\u00e7\u00e3o]\t\t\t= DATEDIFF_BIG(s, [datahora_inicio], MAX([datahora_fim]))\n\t\t\tFROM (\n\t\t\t\tSELECT\n\t\t\t\t\t [intelix_usuario_id]\n\t\t\t\t\t,[evento] = IIF([evento] = 'Pausa', CONCAT('Pausa (',[nome_pausa],')'), [evento])\n\t\t\t\t\t,[datahora_inicio]\n\t\t\t\t\t,[datahora_fim] = CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END\n\t\t\t\tFROM d_intelix_eventos\n\t\t\t\tWHERE evento <> 'Login'\n\t\t\t\tUNION ALL\n\t\t\t\tSELECT [intelix_usuario_id] = p.[intelix_usuario_id]\n\t\t\t\t\t  ,[evento]\t= 'Login'\n\t\t\t\t\t  ,[inicio]\t= CASE WHEN LAG(p.[datahora_inicio]) OVER (PARTITION BY loginid ORDER BY p.rowid) IS NULL THEN l.[datahora_inicio] ELSE p.[datahora_fim] END\n\t\t\t\t\t  ,[fim]\t= CASE WHEN LEAD(p.[datahora_inicio]) OVER (PARTITION BY loginid ORDER BY p.rowid) IS NULL\n\t\t\t\t\t\t\t\t\t\tTHEN MAX(p.[datahora_fim]) OVER (PARTITION BY loginid)\n\t\t\t\t\t\t\t\t\t\tELSE LEAD(p.[datahora_inicio]) OVER (PARTITION BY loginid ORDER BY p.rowid) END\n\t\t\t\tFROM (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t [intelix_usuario_id]\n\t\t\t\t\t\t,[evento] = IIF([evento] = 'Pausa', CONCAT('Pausa (',[nome_pausa],')'), [evento])\n\t\t\t\t\t\t,[datahora_inicio]\n\t\t\t\t\t\t,[datahora_fim]   = CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END\n\t\t\t\t\t\t,[rowid] = ROW_NUMBER() OVER (ORDER BY [intelix_usuario_id], [datahora_inicio], CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END DESC)\n\t\t\t\t\tFROM d_intelix_eventos\n\t\t\t\t) p\n\t\t\t\tRIGHT JOIN (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t [intelix_usuario_id]\n\t\t\t\t\t\t,[datahora_inicio]\n\t\t\t\t\t\t,[datahora_fim] = CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END\n\t\t\t\t\t\t,[loginid] =  ROW_NUMBER() OVER (ORDER BY [intelix_usuario_id], [datahora_inicio], CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END)\n\t\t\t\t\tFROM d_intelix_eventos\n\t\t\t\t\tWHERE\tevento = 'Login'\n\t\t\t\t) l\n\t\t\t\tON p.[intelix_usuario_id] = l.[intelix_usuario_id]\n\t\t\t\tAND p.[datahora_inicio] >= l.[datahora_inicio]\n\t\t\t\tAND (p.[datahora_fim] <= l.[datahora_fim]\n\t\t\t\t\tOR (l.[datahora_fim] IS NULL\n\t\t\t\t\t\tAND CAST(p.[datahora_inicio] as date) = CAST(l.[datahora_inicio] as date)))\n\t\t\t) _\n\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].f_mop_historico\n\t\t\tON\t[intelix_usuario_id] = [ID Intelix]\n\t\t\tAND\t[Data da Atualiza\u00e7\u00e3o] = CAST([datahora_inicio] AS date)\n\t\t\tWHERE DATEDIFF_BIG(s, [datahora_inicio], [datahora_fim]) <> 0\n            GROUP BY [intelix_usuario_id],[Evento],[datahora_inicio]\n\t\t) AS fonte\n\t\tON  destino.[Fonte]\t\t\t=\tfonte.[Fonte]\n\t\tAND destino.[ID Intelix]\t=\tfonte.[ID Intelix]\n\t\tAND destino.[ID Genesys]\tIS\tNULL\n\t\tAND destino.[Evento]\t\t=\tfonte.[Evento]\n\t\tAND destino.[In\u00edcio]\t\t=\tfonte.[In\u00edcio]\n\n\t\tWHEN NOT MATCHED BY TARGET\n\t\tTHEN\n\t\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID Genesys], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o])\n\t\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID Genesys], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o])\n\n\t\tWHEN MATCHED AND(\n\t\t\t\tCOALESCE(destino.[ID Selecionar], '-')\t<>\tCOALESCE(fonte.[ID Selecionar], '-')\n\t\t\tOR\tCOALESCE(destino.[Fim], '1900-01-01')\t<>\tCOALESCE(fonte.[Fim], '1900-01-01')\n\t\t)\n\t\tTHEN UPDATE SET\n\t\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t\t,destino.[Fim]\t\t\t\t=\tfonte.[Fim]\n\t\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n\t\t;\n\t\t--OUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\tEND\n\n\tIF @fonte IS NULL OR @fonte='GENESYS' BEGIN\n\t\tPRINT 'GENESYS';\n\t\tWITH destino AS (\n\t\t\tSELECT * FROM [f_log]\n\t\t\tWHERE\t[Fonte]\t = 'GENESYS'\n\t\t)\n\t\tMERGE INTO destino USING (\n\t\t\tSELECT DISTINCT\n\t\t\t\t [Fonte]\t\t\t=\t'GENESYS'\n\t\t\t\t,[ID Selecionar]\t=\tm.[ID Selecionar]\n\t\t\t\t,[ID Intelix]\t\t=\tNULL\n\t\t\t\t,[ID Genesys]\t\t=\te.[genesys_usuario_id]\n\t\t\t\t,[Evento]\t\t\t=\tp.[nome]\n\t\t\t\t,[In\u00edcio]\t\t\t=\te.[datahora_inicio]\n\t\t\t\t,[Fim]\t\t\t\t=\tIIF(e.[datahora_fim] IS NULL, @null_logoff, e.[datahora_fim])\n\t\t\t\t,[Dura\u00e7\u00e3o]\t\t\t=\tDATEDIFF_BIG(ms, e.[datahora_inicio], IIF(e.[datahora_fim] IS NULL, @null_logoff, e.[datahora_fim])) / 1000.0\n\t\t\tFROM d_genesys_eventos e\n\t\t\tLEFT JOIN d_genesys_usuarios u\n\t\t\t\tON e.[genesys_usuario_id] = u.[genesys_usuario_id]\n\t\t\tLEFT JOIN d_genesys_pausas p\n\t\t\t\tON e.[genesys_pausa_id] = p.[genesys_pausa_id]\n\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].f_mop_historico m\n\t\t\t\tON e.[genesys_usuario_id] = m.[ID Genesys]\n\t\t\t\tAND CAST(e.[datahora_inicio] AS date) = m.[Data da Atualiza\u00e7\u00e3o]\n\t\t\tWHERE p.[nome] <> 'Offline'\n\n\n\t\t) AS fonte\n\t\tON  destino.[Fonte]\t\t\t=\tfonte.[Fonte]\n\t\tAND destino.[ID Intelix]\tIS\tNULL\n\t\tAND destino.[ID Genesys]\t=\tfonte.[ID Genesys]\n\t\tAND destino.[Evento]\t\t=\tfonte.[Evento]\n\t\tAND destino.[In\u00edcio]\t\t=\tfonte.[In\u00edcio]\n\n\t\tWHEN NOT MATCHED BY TARGET\n\t\tTHEN\n\t\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID Genesys], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o])\n\t\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID Genesys], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o])\n\n\t\tWHEN MATCHED AND(\n\t\t\t\tCOALESCE(destino.[ID Selecionar], '-')\t<>\tCOALESCE(fonte.[ID Selecionar], '-')\n\t\t\tOR\tCOALESCE(destino.[Fim], '1900-01-01')\t<>\tCOALESCE(fonte.[Fim], '1900-01-01')\n\t\t)\n\t\tTHEN UPDATE SET\n\t\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t\t,destino.[Fim]\t\t\t\t=\tfonte.[Fim]\n\t\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n\t\t;\n\t\t--OUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\tEND\n\nGO\n",
        "build_order": 123,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "s_att_resumos",
        "type": "StoredProcedure",
        "start": 60231,
        "end": 575602,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_resumos]    Script Date: 2024-11-03 12:54:35 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n\n\n\n\n\n\n\n\n-------------------------------------------------------------------------------------------------------------------------\n\nCREATE      PROCEDURE [dbo].[s_att_resumos] @datahora_inicio DATETIME = NULL,  @datahora_fim DATETIME = NULL, @metrica VARCHAR(50) = NULL \nAS\n\tSET @datahora_inicio = CAST(GETDATE() AS DATE)\n\tSET @datahora_fim = CAST(CAST(GETDATE() AS DATE) AS DATETIME) + CAST('23:59:59' AS DATETIME)\n    \n\tDECLARE @t_inicio datetime = GETDATE();\n    DECLARE @t_inicio_etapa datetime;\n    DECLARE @msg VARCHAR(MAX);\n\n    IF 1=1 BEGIN; PRINT '--- Prep';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_prep;\n\n    \tDROP TABLE IF EXISTS [#chaves];\n    \tSELECT * INTO [#chaves]\n    \tFROM (\n    \t\t\tSELECT\n    \t\t\t\t [DataHora]\t\t\t\t\t\t\t\t\t            =\tc.[DataHora]\n    \t\t\t\t,[Proxima_DataHora]\t\t\t\t\t\t\t            =\tDATEADD(MINUTE, 30, c.[DataHora])\n    \t\t\t\t,[Intervalo]\t\t\t\t\t\t\t\t            =\tCAST(c.[DataHora] as time(0))\n    \t\t\t\t,[Data]\t\t\t\t\t\t\t\t\t\t            =\tc.[Data]\n    \t\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t            =\tc.[Semana_Mes_For\u00e7ada_PrimeiroDia]\n    \t\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t\t\t            =\tc.[M\u00eas_PrimeroDia]\n    \t\t\t\t,[Feriado (Nome)]\t\t\t\t\t\t\t\t\t    =\tc.[Feriado_Nome]\n\n       \t            ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   sec_flags.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t            ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   sec_flags.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t            ,[Secullum - Servi\u00e7o Militar]                                       =   sec_flags.[Secullum - Servi\u00e7o Militar]\n                    ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   sec_flags.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t            ,[Secullum - Licen\u00e7a Paternidade]                                   =   sec_flags.[Secullum - Licen\u00e7a Paternidade]\n       \t            ,[Secullum - Licen\u00e7a Maternidade]                                   =   sec_flags.[Secullum - Licen\u00e7a Maternidade]\n       \t            ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   sec_flags.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t            ,[Secullum - Licen\u00e7a Casamento]                                     =   sec_flags.[Secullum - Licen\u00e7a Casamento]\n                    ,[Secullum - INSS - Afastamento]                                    =   sec_flags.[Secullum - INSS - Afastamento]\n                    ,[Secullum - Folga]                                                 =   sec_flags.[Secullum - Folga]\n                    ,[Secullum - F\u00e9rias]                                                =   sec_flags.[Secullum - F\u00e9rias]\n       \t            ,[Secullum - Feriado]                                               =   sec_flags.[Secullum - Feriado]\n       \t            ,[Secullum - Falta Justificada]                                     =   sec_flags.[Secullum - Falta Justificada]\n       \t            ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   sec_flags.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                    ,[Secullum - Falta Injustificada]                                   =   sec_flags.[Secullum - Falta Injustificada]\n       \t            ,[Secullum - Prova de Vestibular / ENEM]                            =   sec_flags.[Secullum - Prova de Vestibular / ENEM]\n       \t            ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   sec_flags.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                    ,[Secullum - Desligue]                                              =   sec_flags.[Secullum - Desligue]\n       \t            ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   sec_flags.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t            ,[Secullum - Compensando Horas]                                     =   sec_flags.[Secullum - Compensando Horas]\n       \t            ,[Secullum - Atestado]                                              =   sec_flags.[Secullum - Atestado]\n                    ,[Secullum - Abono]                                                 =   sec_flags.[Secullum - Abono]\n       \t            ,[Secullum - Abono Lactante]                                        =   sec_flags.[Secullum - Abono Lactante]\n       \t            ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   sec_flags.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t            ,[Faltas Justificadas]                                              =   sec_flags.[Faltas Justificadas]\n       \t            ,[Faltas Injustificadas]                                            =   sec_flags.[Faltas Injustificadas]\n\n\n    \t\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t\t\t            =\tmop.[Data da Atualiza\u00e7\u00e3o]\n    \t\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t            =\tmop.[ID Selecionar]\n    \t\t\t\t,[Nome]\t\t\t\t\t\t\t\t\t\t            =\tmop.[Nome]\n    \t\t\t\t,[Status]\t\t\t\t\t\t\t\t\t            =\tmop.[Status]\n    \t\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t            =\tmop.[Situa\u00e7\u00e3o]\n    \t\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t            =\tmop.[Condi\u00e7\u00e3o]\n\n    \t\t\t\t,[DMA Inicial]\t\t\t\t\t\t\t\t            =\tmop.[DMA Inicial]\n    \t\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t\t\t            =\tmop.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t\t\t            =\tmop.[\u00daltima DMA Geral]\n    \t\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t\t\t            =\tmop.[Tipo da \u00daltima DMA]\n    \t\t\t\t,[Instrutor Inicial]\t\t\t\t\t\t            =\tmop.[Instrutor Inicial]\n    \t\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t\t\t            =\tmop.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t\t\t            =\tmop.[Instrutor \u00daltima DMA]\n\n    \t\t\t\t,[Teve Evento de MOP?]\t\t\t\t\t\t            =\t1\n    \t\t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t\t\t            =\t1\n    \t\t\t\t,[Tribo Completa]\t\t\t\t\t\t\t            =\t[Tribo Completa]\n    \t\t\t\t,[Cargo]\t\t\t\t\t\t\t\t\t            =\tmop.[Cargo]\n    \t\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t\t\t            =\tmop.[Supervis\u00e3o]\n    \t\t\t\t,[Email Supervis\u00e3o]\t\t\t\t\t\t\t\t\t\t=\tmop.[Email Supervis\u00e3o]\n\t\t\t\t\t,[Tempo de Casa (Dias)]\t\t\t\t\t\t\t\t\t=\tmop.[Tempo de Casa (Dias)]\n\t\t\t\t\t,[Faixa Tempo de Casa]\t\t\t\t\t\t\t\t\t=\tmop.[Faixa Tempo de Casa]\n\t\t\t\t\t,[Idade]\t\t\t\t\t\t\t\t\t\t\t\t=\tmop.[Idade]\n\t\t\t\t\t,[Faixa de Idade]\t\t\t\t\t\t\t\t\t\t=\tmop.[Faixa de Idade]\n    \t\t\t\t,[Turno]\t\t\t\t\t\t\t\t\t            =\tCASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN DATEDIFF(s, '00:00:00', mop.[Jornada]) > 22800 THEN 'Integral'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN CAST(LEFT(mop.[Escala],5) AS TIME) <  CAST('12:00' AS TIME) THEN 'Manh\u00e3'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN CAST(LEFT(mop.[Escala],5) AS TIME) >= CAST('12:00' AS TIME) THEN 'Tarde'\n\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN sec_horarios.[Jornada] > 22800 THEN 'Integral'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN CAST(LEFT(sec_horarios.[Escala (Ponto)],5) AS TIME) <  CAST('12:00' AS TIME) THEN 'Manh\u00e3'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN CAST(LEFT(sec_horarios.[Escala (Ponto)],5) AS TIME) >= CAST('12:00' AS TIME) THEN 'Tarde'\n\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tELSE NULL\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \tEND\n\n    \t\t\t\t,[Escala (Ponto)]\t\t\t\t\t\t\t            =\tsec_horarios.[Escala (Ponto)]\n    \t\t\t\t,[Jornada (Ponto)]\t\t\t\t\t\t\t            =\tISNULL(ABS(CASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN [Feriado_Nome]                                                     IS NOT NULL  THEN 0\n       \t                                                                            WHEN [Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Suspens\u00e3o por advert\u00eancia]                             = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Servi\u00e7o Militar]                                       = 1 THEN 0\n                                                                                    WHEN [Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Licen\u00e7a Paternidade]                                   = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Licen\u00e7a Maternidade]                                   = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Licen\u00e7a Casamento]                                     = 1 THEN 0\n                                                                                    WHEN [Secullum - INSS - Afastamento]                                    = 1 THEN 0\n                                                                                    WHEN [Secullum - Folga]                                                 = 1 THEN 0\n                                                                                    WHEN [Secullum - F\u00e9rias]                                                = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Feriado]                                               = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Falta Justificada]                                     = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = 1 THEN 0\n                                                                                    WHEN [Secullum - Falta Injustificada]                                   = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Prova de Vestibular / ENEM]                            = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Doa\u00e7\u00e3o de Sangue]                                      = 1 THEN 0\n                                                                                    WHEN [Secullum - Desligue]                                              = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Convoca\u00e7\u00e3o Judicial]                                   = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Compensando Horas]                                     = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Atestado]                                              = 1 THEN 0\n                                                                                    WHEN [Secullum - Abono]                                                 = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Abono Lactante]                                        = 1 THEN 0\n       \t                                                                            WHEN [Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = 1 THEN 0\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tELSE sec_horarios.[Jornada]\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \tEND), 0)\n    \t\t\t\t,[Escala (MOP)]\t\t\t\t\t\t\t\t            =\tmop.[Escala]\n    \t\t\t\t,[Jornada (Log)]\t\t\t\t\t\t\t            =\tISNULL(ABS(CASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN [Feriado_Nome]                                     IS NOT NULL          THEN 0\n                                                                                    WHEN [Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)] \t= 1         THEN 0\n                                                                                    --WHEN [Secullum - Suspens\u00e3o por advert\u00eancia]\t            = 1         THEN 0\n                                                                                    WHEN [Secullum - INSS - Afastamento]\t                = 1         THEN 0\n                                                                                    WHEN [Secullum - Folga]\t                                = 1         THEN 0\n                                                                                    WHEN [Secullum - F\u00e9rias]\t                            = 1         THEN 0\n                                                                                    WHEN [Secullum - Feriado]\t                            = 1         THEN 0\n                                                                                    WHEN [Secullum - Desligue]\t                            = 1         THEN 0\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN mop.[Status]                                       <> 'Ativo'\tTHEN 0\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tWHEN sec_horarios.[Jornada]                             = 0\t\t\tTHEN 0\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t--WHEN sec_horarios.[Jornada]                           IS NULL\t    THEN -- <- Quando ID_Secullum n\u00e3o for preenchida no MOP\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t--    CASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t    \tWHEN mop.[Taxa] = 1 THEN CASE DATEPART(WEEKDAY, c.[Data]) WHEN 1 THEN 0  WHEN 7 THEN 0 ELSE DATEDIFF(s, 0, mop.[Jornada]) END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t    \tWHEN mop.[Taxa] = 2 THEN CASE DATEPART(WEEKDAY, c.[Data]) WHEN 1 THEN 0 ELSE DATEDIFF(s, 0, mop.[Jornada]) END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\t--    END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \t\tELSE DATEDIFF(s, 0, mop.[Jornada])\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t            \tEND), 0)\n\n    \t\t\tFROM [db_serasa_producao].[dbo].dim_calendario_30min c\n    \t\t\tLEFT JOIN ( SELECT [Data da Atualiza\u00e7\u00e3o], [Data da Proxima Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Intelix], [ID EPBX],[ID Secullum], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [DMA Inicial], [\u00daltima DMA Migra\u00e7\u00e3o], [\u00daltima DMA Geral], [Tipo da \u00daltima DMA], [Instrutor Inicial], [Instrutor \u00daltima Migra\u00e7\u00e3o], [Instrutor \u00daltima DMA], [Cargo], [Supervis\u00e3o], [Email Supervis\u00e3o], [Escala], [Jornada], [Taxa], [Tribo Completa] = CONCAT([Cliente], '__', [Projeto], '__', [Tribo]), [Tempo de Casa (Dias)], [Faixa Tempo de Casa], [Idade], [Faixa de Idade]\n    \t\t\t\t\t\tFROM [db_serasa_producao].[dbo].f_mop_eventos\n    \t\t\t\t\t\tWHERE [Data da Atualiza\u00e7\u00e3o] <= @datahora_fim\n    \t\t\t\t\t\tAND ([Data da Proxima Atualiza\u00e7\u00e3o] >= @datahora_inicio OR [Data da Proxima Atualiza\u00e7\u00e3o] IS NULL)\n    \t\t\t\t\t\tUNION ALL SELECT CAST('01/01/1900' AS datetime2(0)), CAST('01/01/2070' AS datetime2(0)), null, null, null, null, 'Colaborador n\u00e3o encontrado', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, '____', null, null, null, null\n    \t\t\t) as mop\n    \t\t\tON  c.[Data] >= mop.[Data da Atualiza\u00e7\u00e3o]\n    \t\t\tAND c.[Data] <  CASE  WHEN mop.[Data da Proxima Atualiza\u00e7\u00e3o] IS NULL AND [status] = 'Turnover' THEN DATEADD(DAY, 1, mop.[Data da Atualiza\u00e7\u00e3o])\n    \t\t\t\t\t\t\t\t\tWHEN mop.[Data da Proxima Atualiza\u00e7\u00e3o] IS NULL THEN DATEADD(DAY, 1, (SELECT MAX([Data]) FROM [db_serasa_producao].[dbo].dim_calendario_30min))\n    \t\t\t\t\t\t\t\t\tELSE mop.[Data da Proxima Atualiza\u00e7\u00e3o] END\n\n\n    \t\t\tLEFT JOIN (\n    \t\t\t\tSELECT DISTINCT\n    \t\t\t\t\t [ID Secullum]\t\t\t                                = id_funcionario\n    \t\t\t\t\t,[Data]\t\t\t\t\t                                = CAST(inicio AS DATE)\n\n       \t                ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                 = IIF([Obs] IN ('SuspCTT'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Suspens\u00e3o por advert\u00eancia]                            = IIF([Obs] IN ('SuspAdv', 'Sus/Adv'\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Servi\u00e7o Militar]                                      = IIF([Obs] IN ('ServMil'\t\t\t\t\t\t      ), 1, 0)\n                        ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]     = IIF([Obs] IN ('MFM'\t\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Licen\u00e7a Paternidade]                                  = IIF([Obs] IN ('LicPate'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Licen\u00e7a Maternidade]                                  = IIF([Obs] IN ('LicMate','MATER'\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                        = IIF([Obs] IN ('LicLuto'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Licen\u00e7a Casamento]                                    = IIF([Obs] IN ('LicCasa', 'LicGala'\t\t\t\t\t  ), 1, 0)\n                        ,[Secullum - INSS - Afastamento]                                   = IIF([Obs] IN ('INSS'\t\t\t\t\t\t\t\t  ), 1, 0)\n                        ,[Secullum - Folga]                                                = IIF([Obs] IN ('Folga', 'DayOff'\t\t\t\t\t  ), 1, 0)\n                        ,[Secullum - F\u00e9rias]                                               = IIF([Obs] IN ('F\u00c9RIAS','Ferias'\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Feriado]                                              = IIF([Obs] IN ('Feriado'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Falta Justificada]                                    = IIF([Obs] IN ('FaltaJu', 'FaltaJ', 'Falta J'         ), 1, 0)\n       \t                ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]   = IIF([Obs] IN ('FaltaAb'\t\t\t\t\t\t      ), 1, 0)\n                        ,[Secullum - Falta Injustificada]                                  = IIF([Obs] IN ('Falta', 'DecSAbo'\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Prova de Vestibular / ENEM]                           = IIF([Obs] IN ('ENEMVes'\t\t\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                     = IIF([Obs] IN ('DoaSang'\t\t\t\t\t          ), 1, 0)\n                        ,[Secullum - Desligue]                                             = IIF([Obs] IN ('Deslig', 'Deslig.'\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                  = IIF([Obs] IN ('ConvJud'\t\t\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Compensando Horas]                                    = IIF([Obs] IN ('ComHora'\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Atestado]                                             = IIF([Obs] IN ('Atest', 'Atestad', 'Declara'\t\t  ), 1, 0)\n                        ,[Secullum - Abono]                                                = IIF([Obs] IN ('Abono'\t\t\t\t\t\t\t\t  ), 1, 0)\n       \t                ,[Secullum - Abono Lactante]                                       = IIF([Obs] IN ('AboLact'\t\t\t\t\t\t      ), 1, 0)\n       \t                ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]        = IIF([Obs] IN ('AboElei'\t\t\t\t\t\t      ), 1, 0)\n       \t                ,[Faltas Justificadas]                                             = IIF([Obs] IN ('Declara','SuspCTT','ServMil','MFM','LicPate','LicMate', 'LicGala','Ferias', 'MATER','LicLuto', 'FaltaJ', 'Falta J','LicCasa','INSS','Folga', 'DayOff','F\u00c9RIAS','Feriado','FaltaJu','ENEMVes','DoaSang','Deslig','Deslig.','ConvJud','ComHora','Atest','Atestad','Abono','AboLact','AboElei'), 1, 0)\n       \t                ,[Faltas Injustificadas]                                           = IIF([Obs] IN ('DecSAbo','FaltaAb','Falta','SuspAdv','Sus/Adv'), 1, 0)\n\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].dim_secullum_batidas\n    \t\t\t\tWHERE [Obs] IS NOT NULL\n    \t\t\t) as sec_flags\n    \t\t\tON\tmop.[ID Secullum] = sec_flags.[ID Secullum]\n    \t\t\tAND c.[Data] = sec_flags.[Data]\n\n    \t\t\tLEFT JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Secullum]\t\t= ID_funcionario\n    \t\t\t\t\t,[DiaSemana]\t\t= (DATEPART(dw, [DiaSemana]) + @@DATEFIRST + 6 - 0) % 7 + 1\n    \t\t\t\t\t,[Jornada]\t\t\t= ISNULL(DATEDIFF(s, Entrada1, Saida1), 0) + ISNULL(DATEDIFF(s, Entrada2, Saida2),0)\n    \t\t\t\t\t,[Escala (Ponto)]\t= CONCAT(LEFT(COALESCE([Entrada1], [Entrada2]),5), ' - ',LEFT(COALESCE([Saida2], [Saida1]),5))\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].dim_secullum_funcionarios\n    \t\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].dim_log_secullum_horarios\n    \t\t\t\tON id_horario = horarioid\n    \t\t\t) as sec_horarios\n    \t\t\tON mop.[ID Secullum] = sec_horarios.[ID Secullum]\n    \t\t\tAND DATEPART(dw, c.[Data]) = sec_horarios.[DiaSemana]\n\n    \t\tWHERE c.[Data] <= @datahora_fim\n    \t\tAND c.[Data] >= @datahora_inicio\n\t\t\t\n    \t) _\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_prep;\n        END\n    IF 1=0 AND (@metrica IS NULL OR @metrica='tickets')\n        BEGIN; PRINT '--- tickets';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_tickets;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT\n    \t\t\t [DataHora]\t\t\t\t\t\t\t=\tc.[DataHora]\n    \t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n    \t\t\t,[Tribo Completa]\t\t\t\t\t=\tCONCAT('Serasa', '__',IIF(t.[Tribo] = '0800 Premium', 'Voz', 'Digital'), '__', t.[Tribo])\n    \t\t\t,[Criados]\t\t\t\t\t\t\t=\tt.[Criados]\n    \t\t\t,[Tratados]\t\t\t\t\t\t\t=\tt.[Tratados]\n    \t\t\t,[Tempo Total de Tratativa]\t\t\t=\tt.[Tempo Total de Tratativa]\n    \t\t\t,[TMT]\t\t\t\t\t\t\t\t=\tt.[TMT]\n    \t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t=\tt.[N\u00e3o Resolvidos]\n    \t\t\t,[Replicas]\t\t\t\t\t\t\t=\tt.[Replicas]\n    \t\t\t,[Reincidentes 48h]\t\t\t\t\t=\tt.[Reincidentes 48h]\n    \t\t\t,[Reincidentes 30d]\t\t\t\t\t=\tt.[Reincidentes 30d]\n    \t\tFROM [#chaves] c\n    \t\tRIGHT JOIN (\n    \t\t\tSELECT\n    \t\t\t\t [ID Selecionar]\t\t\t= tt.[ID Selecionar]\n    \t\t\t\t,[Tribo]\t\t\t\t\t= COALESCE(tt.[Tribo], tc.[Tribo])\n    \t\t\t\t,[DataHora]\t\t\t\t\t= COALESCE(tt.[DataHora], tc.[DataHora])\n    \t\t\t\t,[Criados]\t\t\t\t\t= ISNULL(tc.[Criados], 0)\n    \t\t\t\t,[Tratados]\t\t\t\t\t= ISNULL(tt.[Tratados], 0)\n    \t\t\t\t,[Tempo Total de Tratativa]\t= ISNULL(tt.[Tempo Total de Tratativa], 0)\n    \t\t\t\t,[TMT]\t\t\t\t\t\t= ISNULL(tt.[TMT], 0)\n    \t\t\t\t,[N\u00e3o Resolvidos]\t\t\t= ISNULL(tt.[N\u00e3o Resolvidos], 0)\n    \t\t\t\t,[Replicas]\t\t\t\t\t= ISNULL(tt.[Replicas], 0)\n    \t\t\t\t,[Reincidentes 48h]\t\t\t= ISNULL(tt.[Reincidentes 48h], 0)\n    \t\t\t\t,[Reincidentes 30d]\t\t\t= ISNULL(tt.[Reincidentes 30d], 0)\n    \t\t\tFROM (\n    \t\t\t\t\tSELECT\n    \t\t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t\t,[Tribo]\n    \t\t\t\t\t\t,[DataHora]\t\t\t\t\t= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Resolu\u00e7\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t\t\t\t,[Tratados]\t\t\t\t\t= COUNT(*)\n    \t\t\t\t\t\t,[Tempo Total de Tratativa]\t= SUM(TMT)\n    \t\t\t\t\t\t,[TMT]\t\t\t\t\t\t= SUM(TMT)/COUNT(*)\n    \t\t\t\t\t\t,[N\u00e3o Resolvidos]\t\t\t= SUM(CASE [Resolvido?] WHEN 0 THEN 1 ELSE 0 END)\n    \t\t\t\t\t\t,[Replicas]\t\t\t\t\t= SUM(R\u00e9plicas)\n    \t\t\t\t\t\t,[Reincidentes 48h]\t\t\t= SUM(CAST([Reincidente 48h?] AS INT))\n    \t\t\t\t\t\t,[Reincidentes 30d]\t\t\t= SUM(CAST([Reincidente 30d?] AS INT))\n    \t\t\t\t\tFROM [db_Serasa_producao].[dbo].f_tickets\n    \t\t\t\t\tWHERE  [Resolu\u00e7\u00e3o] >= @datahora_inicio AND [Resolu\u00e7\u00e3o] <= @datahora_fim\n    \t\t\t\t\tGROUP BY [ID Selecionar], [Tribo], DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Resolu\u00e7\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t) tt\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [Tribo]\n    \t\t\t\t\t,[DataHora]\t\t\t= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Cria\u00e7\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t\t\t,[Criados]\t\t\t= COUNT(*)\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_tickets\n    \t\t\t\tWHERE [Cria\u00e7\u00e3o] >= @datahora_inicio AND [Cria\u00e7\u00e3o] <= @datahora_fim\n    \t\t\t\tGROUP BY [Tribo], DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Cria\u00e7\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t) tc\n    \t\t\tON COALESCE(tt.[ID Selecionar], '-') = '-' AND tt.[Tribo] = tc.[Tribo] AND tt.[DataHora] = tc.[DataHora]\n    \t\t) t\n    \t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(t.[ID Selecionar], '-')\n    \t\tAND c.[DataHora] = t.[DataHora]\n    \t\tWHERE c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim\n    \t) AS fonte\n    \tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n    \t\t\t [Teve Evento de Tickets?]\n    \t\t\t,[DataHora]\n    \t\t\t,[ID Selecionar]\n    \t\t\t,[Tribo Completa]\n    \t\t\t,[Criados]\n    \t\t\t,[Tratados]\n    \t\t\t,[Tempo Total de Tratativa]\n    \t\t\t,[TMT]\n    \t\t\t,[N\u00e3o Resolvidos]\n    \t\t\t,[Replicas]\n    \t\t\t,[Reincidentes 48h]\n    \t\t\t,[Reincidentes 30d]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n    \t\t\t1\n    \t\t\t,fonte.[DataHora]\n    \t\t\t,fonte.[ID Selecionar]\n    \t\t\t,fonte.[Tribo Completa]\n    \t\t\t,fonte.[Criados]\n    \t\t\t,fonte.[Tratados]\n    \t\t\t,fonte.[Tempo Total de Tratativa]\n    \t\t\t,fonte.[TMT]\n    \t\t\t,fonte.[N\u00e3o Resolvidos]\n    \t\t\t,fonte.[Replicas]\n    \t\t\t,fonte.[Reincidentes 48h]\n    \t\t\t,fonte.[Reincidentes 30d]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Teve Evento de Tickets?]\t=\t1\n    \t\t\t,destino.[Criados]\t\t\t\t\t=\tfonte.[Criados]\n    \t\t\t,destino.[Tratados]\t\t\t\t\t=\tfonte.[Tratados]\n    \t\t\t,destino.[Tempo Total de Tratativa]\t=\tfonte.[Tempo Total de Tratativa]\n    \t\t\t,destino.[TMT]\t\t\t\t\t\t=\tfonte.[TMT]\n    \t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t=\tfonte.[N\u00e3o Resolvidos]\n    \t\t\t,destino.[Replicas]\t\t\t\t\t=\tfonte.[Replicas]\n    \t\t\t,destino.[Reincidentes 48h]\t\t\t=\tfonte.[Reincidentes 48h]\n    \t\t\t,destino.[Reincidentes 30d]\t\t\t=\tfonte.[Reincidentes 30d]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Teve Evento de Tickets?]\t=\t0\n    \t\t\t,destino.[Criados]\t\t\t\t\t=\t0\n    \t\t\t,destino.[Tratados]\t\t\t\t\t=\t0\n    \t\t\t,destino.[Tempo Total de Tratativa]\t=\t0\n    \t\t\t,destino.[TMT]\t\t\t\t\t\t=\t0\n    \t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t=\t0\n    \t\t\t,destino.[Replicas]\t\t\t\t\t=\t0\n    \t\t\t,destino.[Reincidentes 48h]\t\t\t=\t0\n    \t\t\t,destino.[Reincidentes 30d]\t\t\t=\t0\n    \t;\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_tickets;\n        END\n    IF 1=0 AND (@metrica IS NULL OR @metrica='chamadas')\n        BEGIN; PRINT '--- chamadas';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_chamadas;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT\n    \t\t\t*\n    \t\t\t,[Inbound - TMC]\t\t\t\t\t=\tISNULL([Inbound - Tempo Em Chamada (Independente do Intervalo)] / NULLIF([Inbound - Chamadas Finalizadas], 0), 0)\n    \t\t\t,[Inbound - TMA]\t\t\t\t\t=\tISNULL([Inbound - Tempo Em Atendimento (Independente do Intervalo)] / NULLIF([Inbound - Chamadas Atendidas Finalizadas], 0), 0)\n    \t\t\t,[Inbound - TME]\t\t\t\t\t=\tISNULL([Inbound - Tempo Em Espera (Independente do Intervalo)] / NULLIF([Inbound - Chamadas Finalizadas], 0), 0)\n    \t\t\t,[Inbound - TMO]\t\t\t\t\t=\tISNULL(([Inbound - Tempo Em Atendimento (Independente do Intervalo)] + [Inbound - Tempo Em Encerramento (Independente do Intervalo)]) / NULLIF([Inbound - Chamadas Atendidas Finalizadas], 0), 0)\n    \t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t=\tISNULL([Inbound - Chamadas Atendidas Em At\u00e9 20s] / CAST(NULLIF([Inbound - Chamadas Iniciadas], 0) AS [decimal](18,4)), 0)\n    \t\t\t,[Inbound - Chamadas Abandonadas]\t=\t[Inbound - Chamadas Iniciadas] - [Inbound - Chamadas Atendidas]\n    \t\t\t,[Inbound - % Abandono]\t\t\t\t=\tISNULL(([Inbound - Chamadas Iniciadas] - [Inbound - Chamadas Atendidas]) / CAST(NULLIF([Inbound - Chamadas Iniciadas], 0) AS [decimal](18,4)), 0)\n\n    \t\t\t,[Outbound - TMC]\t\t\t\t\t=\tISNULL([Outbound - Tempo Em Chamada (Independente do Intervalo)] / NULLIF([Outbound - Chamadas Finalizadas], 0), 0)\n    \t\t\t,[Outbound - TMA]\t\t\t\t\t=\tISNULL([Outbound - Tempo Em Atendimento (Independente do Intervalo)] / NULLIF([Outbound - Chamadas Atendidas Finalizadas], 0), 0)\n    \t\t\t,[Outbound - TME]\t\t\t\t\t=\tISNULL([Outbound - Tempo Em Espera (Independente do Intervalo)] / NULLIF([Outbound - Chamadas Finalizadas], 0), 0)\n    \t\t\t,[Outbound - TMO]\t\t\t\t\t=\tISNULL(([Outbound - Tempo Em Atendimento (Independente do Intervalo)] + [Outbound - Tempo Em Encerramento (Independente do Intervalo)]) / NULLIF([Outbound - Chamadas Atendidas Finalizadas], 0), 0)\n    \t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t=\tISNULL([Outbound - Chamadas Atendidas Em At\u00e9 20s] / CAST(NULLIF([Outbound - Chamadas Iniciadas], 0) AS [decimal](18,4)), 0)\n    \t\t\t,[Outbound - Chamadas Abandonadas]\t=\t[Outbound - Chamadas Iniciadas] - [Outbound - Chamadas Atendidas]\n    \t\t\t,[Outbound - % Abandono]\t\t\t=\tISNULL(([Outbound - Chamadas Iniciadas] - [Outbound - Chamadas Atendidas]) / CAST(NULLIF([Outbound - Chamadas Iniciadas], 0) AS [decimal](18,4)), 0)\n\n    \t\tFROM (\n\n    \t\t\tSELECT\n    \t\t\t\t [DataHora]\t\t\t\t\t\t\t\t\t\t\t\t        =\tc.[DataHora]\n    \t\t\t    ,[Tribo Completa]\t\t\t\t\t                            =\tCOALESCE(\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\tCASE COALESCE(ct.[Grupo],ce.[Grupo],ca.[Grupo],co.[Grupo],ctrans.[Grupo])\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_PREMIUM'\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'Atendimento_SELECIONAR_Premium'\tTHEN 'Serasa__Voz__0800 Premium'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_CADASTRO_POSITIVO'\t\t\t\tTHEN 'Serasa__Voz__Cadastro Positivo'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_SAC'\t\t\t\t\t\t\tTHEN 'Serasa__Voz__SAC'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'Atendimento_SELECIONAR_SAC'\t\tTHEN 'Serasa__Voz__SAC'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t,c.[Tribo Completa])\n    \t\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t\t\t\t        =\tc.[ID Selecionar]\n\n    \t\t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] = 'Atendida' AND ct.[Dura\u00e7\u00e3o Espera] <= 20000, CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] IS NOT NULL, 1, 0))\n    \t\t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', [Transferida?], 0)), 0)\n\n    \t\t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] ELSE 0 END, 0)), 0)/1000.0\n\n    \t\t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Atendimento])\tWHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN DATEDIFF(ms, [In\u00edcio_Atendimento], [Proxima_DataHora]) WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Atendimento] < [Fim_Atendimento], DATEDIFF(ms, [In\u00edcio_Atendimento], [Fim_Atendimento]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM(IIF(ce.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio_Espera] IS NULL OR [Fim_Espera] IS NULL\tTHEN 0 WHEN [Fim_Espera] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Espera] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Espera] <= [DataHora] AND [Fim_Espera] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Espera])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Espera], [Proxima_DataHora])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Espera] < [Fim_Espera], DATEDIFF(ms, [In\u00edcio_Espera], [Fim_Espera]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM(IIF(co.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio_Encerramento] IS NULL OR [Fim_Encerramento] IS NULL\tTHEN 0 WHEN [Fim_Encerramento] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Encerramento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Encerramento] <= [DataHora] AND [Fim_Encerramento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Encerramento])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Encerramento], [Proxima_DataHora])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Encerramento] < [Fim_Encerramento], DATEDIFF(ms, [In\u00edcio_Encerramento], [Fim_Encerramento]), 0) ELSE 1800000 END, 0))/1000.0\n\n    \t\t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', 1, 0))\n    \t\t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\n\n    \t\t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] = 'Atendida' AND ct.[Dura\u00e7\u00e3o Espera] <= 20, CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] IS NOT NULL, 1, 0))\n    \t\t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', [Transferida?], 0)), 0)\n\n    \t\t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] ELSE 0 END, 0)), 0)/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] ELSE 0 END, 0)), 0)/1000.0\n\n    \t\t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Atendimento])\tWHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN DATEDIFF(ms, [In\u00edcio_Atendimento], [Proxima_DataHora]) WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Atendimento] < [Fim_Atendimento], DATEDIFF(ms, [In\u00edcio_Atendimento], [Fim_Atendimento]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM(IIF(ce.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio_Espera] IS NULL OR [Fim_Espera] IS NULL\tTHEN 0 WHEN [Fim_Espera] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Espera] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Espera] <= [DataHora] AND [Fim_Espera] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Espera])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Espera], [Proxima_DataHora])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Espera] < [Fim_Espera], DATEDIFF(ms, [In\u00edcio_Espera], [Fim_Espera]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM(IIF(co.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio_Encerramento] IS NULL OR [Fim_Encerramento] IS NULL\tTHEN 0 WHEN [Fim_Encerramento] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Encerramento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Encerramento] <= [DataHora] AND [Fim_Encerramento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Encerramento])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Encerramento], [Proxima_DataHora])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Encerramento] < [Fim_Encerramento], DATEDIFF(ms, [In\u00edcio_Encerramento], [Fim_Encerramento]), 0) ELSE 1800000 END, 0))/1000.0\n    \t\t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n    \t\t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', 1, 0))\n    \t\t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\n\n    \t\t\tFROM (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n    \t\t\t\t\t,[In\u00edcio]\t\t\t\t=\t[DataHora]\n    \t\t\t\t\t,[Fim]\t\t\t\t\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Total] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Total]\t\t=\tCAST([Dura\u00e7\u00e3o Total] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t=\tCAST([Dura\u00e7\u00e3o Espera] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t=\tIIF([Status] = 'Atendida', CAST([Dura\u00e7\u00e3o Atendimento] AS [decimal](18,4)) * 1000, 0) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t=\tCAST([Dura\u00e7\u00e3o Encerramento] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim --AND [Dura\u00e7\u00e3o Total] > 0 <-Economiza recursos mas acaba ignorando as abandonadas/n\u00e3o atendidas\n\n    \t\t\t) ct\n\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n    \t\t\t\t\t,[In\u00edcio_Espera]\t\t=\t[DataHora]\n    \t\t\t\t\t,[Fim_Espera]\t\t\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Espera] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t=\tCAST([Dura\u00e7\u00e3o Espera] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Dura\u00e7\u00e3o Espera] > 0\n    \t\t\t) ce\n    \t\t\tON 1=0\n\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n    \t\t\t\t\t,[In\u00edcio_Atendimento]\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Espera] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Fim_Atendimento]\t\t=\tDATEADD(ms, ([Dura\u00e7\u00e3o Espera]+[Dura\u00e7\u00e3o Atendimento]) * 1000, [DataHora])  -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t=\tCAST([Dura\u00e7\u00e3o Atendimento] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Dura\u00e7\u00e3o Atendimento] > 0\n    \t\t\t) ca\n    \t\t\tON 1=0\n\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n    \t\t\t\t\t,[In\u00edcio_Encerramento]\t=\tDATEADD(ms, ([Dura\u00e7\u00e3o Espera]+[Dura\u00e7\u00e3o Atendimento]) *1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Fim_Encerramento]\t\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Total] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t=\tCAST([Dura\u00e7\u00e3o Encerramento] AS [decimal](18,4)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Dura\u00e7\u00e3o Encerramento] > 0\n    \t\t\t) co\n    \t\t\tON 1=0\n\n    \t\t\tFULL OUTER JOIN (\n    \t\t\t\tSELECT\n    \t\t\t\t\t [ID Selecionar]\t\t=\tCOALESCE(mop.[ID Selecionar], ch.[ID Genesys])\n    \t\t\t\t\t,[Grupo]\n    \t\t\t\t\t,[Dire\u00e7\u00e3o]\n    \t\t\t\t\t,[In\u00edcio_Transferencia]\t=\tch.[DataHora]\n    \t\t\t\t\t,[Fim_Transferencia]\t=\tch.[DataHora]\n    \t\t\t\t\t,[Transferida?]\t\t\t=\t1\n    \t\t\t\tFROM [db_Serasa_producao].[dbo].f_chamadas ch\n    \t\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].f_mop_historico mop\n    \t\t\t\tON CAST(ch.[DataHora] AS DATE)= mop.[Data da Atualiza\u00e7\u00e3o]\n    \t\t\t\tAND ch.[ID Genesys] = mop.[ID Genesys]\n    \t\t\t\tWHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Transferida Por] IS NOT NULL\n    \t\t\t) ctrans\n    \t\t\tON 1=0\n\n    \t\t\tLEFT JOIN [#chaves] c\n    \t\t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(ct.[ID Selecionar],  COALESCE(ce.[ID Selecionar], COALESCE(ca.[ID Selecionar],  COALESCE(co.[ID Selecionar], '-'))))\n    \t\t\tAND (\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio]) / 30.0) * 30, 0)\t\t\t\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim]) / 30.0) * 30, 0))\n    \t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Espera]) / 30.0) * 30, 0)\t\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Espera]) / 30.0) * 30, 0))\n    \t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Atendimento]) / 30.0) * 30, 0)\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Atendimento]) / 30.0) * 30, 0))\n    \t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Encerramento]) / 30.0) * 30, 0)\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Encerramento]) / 30.0) * 30, 0))\n    \t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Transferencia]) / 30.0) * 30, 0)\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Transferencia]) / 30.0) * 30, 0))\n    \t\t\t\t )\n    \t\t\tWHERE  c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim\n    \t\t\tGROUP BY c.[DataHora], c.[ID Selecionar],COALESCE(CASE COALESCE(ct.[Grupo],ce.[Grupo],ca.[Grupo],co.[Grupo],ctrans.[Grupo])\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_PREMIUM'\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'Atendimento_SELECIONAR_Premium'\tTHEN 'Serasa__Voz__0800 Premium'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_CADASTRO_POSITIVO'\t\t\t\tTHEN 'Serasa__Voz__Cadastro Positivo'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'S_SAC'\t\t\t\t\t\t\tTHEN 'Serasa__Voz__SAC'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t\t\t\tWHEN 'Atendimento_SELECIONAR_SAC'\t\tTHEN 'Serasa__Voz__SAC'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t    END\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t        \t    ,c.[Tribo Completa])\n    \t\t) _\n    \t) AS fonte\n    \tON  fonte.[DataHora] = destino.[DataHora]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT (\n    \t\t [Teve Evento de Chamadas?]\n    \t\t,[DataHora]\n    \t\t,[Tribo Completa]\n    \t\t,[ID Selecionar]\n\n    \t\t,[Inbound - Chamadas Iniciadas]\n    \t\t,[Inbound - Chamadas Atendidas]\n    \t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,[Inbound - Chamadas Em Andamento]\n    \t\t,[Inbound - Chamadas Finalizadas]\n    \t\t,[Inbound - Chamadas Atendidas Finalizadas]\n    \t\t,[Inbound - Chamadas Transferidas]\n    \t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,[Inbound - Atendimentos Iniciados]\n    \t\t,[Inbound - Atendimentos Em Andamento]\n    \t\t,[Inbound - Atendimentos Finalizados]\n    \t\t,[Inbound - TMC]\n    \t\t,[Inbound - TMA]\n    \t\t,[Inbound - TME]\n    \t\t,[Inbound - TMO]\n    \t\t,[Inbound - % Nivel de Servi\u00e7o]\n    \t\t,[Inbound - Chamadas Abandonadas]\n    \t\t,[Inbound - % Abandono]\n\n    \t\t,[Outbound - Chamadas Iniciadas]\n    \t\t,[Outbound - Chamadas Atendidas]\n    \t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,[Outbound - Chamadas Em Andamento]\n    \t\t,[Outbound - Chamadas Finalizadas]\n    \t\t,[Outbound - Chamadas Atendidas Finalizadas]\n    \t\t,[Outbound - Chamadas Transferidas]\n    \t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,[Outbound - Atendimentos Iniciados]\n    \t\t,[Outbound - Atendimentos Em Andamento]\n    \t\t,[Outbound - Atendimentos Finalizados]\n    \t\t,[Outbound - TMC]\n    \t\t,[Outbound - TMA]\n    \t\t,[Outbound - TME]\n    \t\t,[Outbound - TMO]\n    \t\t,[Outbound - % Nivel de Servi\u00e7o]\n    \t\t,[Outbound - Chamadas Abandonadas]\n    \t\t,[Outbound - % Abandono]\n    \t\t)\n    \t\tVALUES (\n    \t\t 1\n    \t\t,fonte.[DataHora]\n    \t\t,fonte.[Tribo Completa]\n    \t\t,fonte.[ID Selecionar]\n\n    \t\t,fonte.[Inbound - Chamadas Iniciadas]\n    \t\t,fonte.[Inbound - Chamadas Atendidas]\n    \t\t,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,fonte.[Inbound - Chamadas Em Andamento]\n    \t\t,fonte.[Inbound - Chamadas Finalizadas]\n    \t\t,fonte.[Inbound - Chamadas Atendidas Finalizadas]\n    \t\t,fonte.[Inbound - Chamadas Transferidas]\n    \t\t,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,fonte.[Inbound - Atendimentos Iniciados]\n    \t\t,fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t,fonte.[Inbound - Atendimentos Finalizados]\n    \t\t,fonte.[Inbound - TMC]\n    \t\t,fonte.[Inbound - TMA]\n    \t\t,fonte.[Inbound - TME]\n    \t\t,fonte.[Inbound - TMO]\n    \t\t,fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t,fonte.[Inbound - Chamadas Abandonadas]\n    \t\t,fonte.[Inbound - % Abandono]\n\n    \t\t,fonte.[Outbound - Chamadas Iniciadas]\n    \t\t,fonte.[Outbound - Chamadas Atendidas]\n    \t\t,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,fonte.[Outbound - Chamadas Em Andamento]\n    \t\t,fonte.[Outbound - Chamadas Finalizadas]\n    \t\t,fonte.[Outbound - Chamadas Atendidas Finalizadas]\n    \t\t,fonte.[Outbound - Chamadas Transferidas]\n    \t\t,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,fonte.[Outbound - Atendimentos Iniciados]\n    \t\t,fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t,fonte.[Outbound - Atendimentos Finalizados]\n    \t\t,fonte.[Outbound - TMC]\n    \t\t,fonte.[Outbound - TMA]\n    \t\t,fonte.[Outbound - TME]\n    \t\t,fonte.[Outbound - TMO]\n    \t\t,fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t,fonte.[Outbound - Chamadas Abandonadas]\n    \t\t,fonte.[Outbound - % Abandono]\n    \t\t)\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Teve Evento de Chamadas?]\t\t\t\t\t\t\t\t= 1\n    \t\t\t,destino.[DataHora]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[DataHora]\n    \t\t\t,destino.[Tribo Completa]\t\t\t\t\t\t\t\t\t\t= fonte.[Tribo Completa]\n    \t\t\t,destino.[ID Selecionar]\t\t\t\t\t\t\t\t\t\t= fonte.[ID Selecionar]\n\n    \t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Finalizadas]\n    \t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Transferidas]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMC]\n    \t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMA]\n    \t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TME]\n    \t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMO]\n    \t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Abandono]\n\n    \t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Finalizadas]\n    \t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Transferidas]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMC]\n    \t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMA]\n    \t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TME]\n    \t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMO]\n    \t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - % Abandono]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Teve Evento de Chamadas?]\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n    \t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= 0\n\n    \t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n    \t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n    \t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= 0\n    \t;\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_chamadas;\n        END\n    IF 1=1 AND (@metrica IS NULL OR @metrica='nps')\n        BEGIN; PRINT '--- nps';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_nps;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT *\n    \t\t\t,[NPS] = CAST((CAST(([Promotoras]-[Detratoras]) AS decimal(18,4))/CAST(NULLIF([Avalia\u00e7\u00f5es de NPS], 0) AS decimal(16,4)))*100 AS INT)\n    \t\tFROM (\n    \t\t\tSELECT\n    \t\t\t\t [DataHora]\t\t\t\t= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [DataHora da Opini\u00e3o]) / 30.0) * 30, 0)\n    \t\t\t\t,[ID Selecionar]\t\t= c.[ID Selecionar]\n    \t\t\t\t,[Tribo Completa]\t    = ISNULL([Tribo Completa Padronizada], '____')\n    \t\t\t\t,[Avalia\u00e7\u00f5es de NPS]\t= COUNT(*)\n    \t\t\t\t,[Promotoras]\t\t\t= ISNULL(SUM(IIF([Classifica\u00e7\u00e3o] = 'Promotores', 1,0)),0)\n    \t\t\t\t,[Neutras]\t\t\t\t= ISNULL(SUM(IIF([Classifica\u00e7\u00e3o] = 'Neutros', 1,0)),0)\n    \t\t\t\t,[Detratoras]\t\t\t= ISNULL(SUM(IIF([Classifica\u00e7\u00e3o] = 'Detratores', 1,0)),0)\n    \t\t\tFROM [db_Serasa_producao].[dbo].f_nps_v2 n\n    \t\t\tLEFT JOIN [#chaves] c\n    \t\t\tON c.[ID Selecionar] = n.[ID Selecionar]\n    \t\t\tAND c.[DataHora] = DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [DataHora da Opini\u00e3o]) / 30.0) * 30, 0)\n    \t\t\tWHERE n.[DataHora da Opini\u00e3o] >= @datahora_inicio AND n.[DataHora da Opini\u00e3o] <= @datahora_fim\n    \t\t\tGROUP BY DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [DataHora da Opini\u00e3o]) / 30.0) * 30, 0), [Tribo Completa Padronizada], c.[ID Selecionar]\n    \t\t) _\n    \t) AS fonte\n    \tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT (\n    \t\t\t\t [Teve Evento de NPS?]\n    \t\t\t\t,[DataHora]\n    \t\t\t\t,[ID Selecionar]\n    \t\t\t\t,[Tribo Completa]\n    \t\t\t\t,[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t\t,[Promotoras]\n    \t\t\t\t,[Neutras]\n    \t\t\t\t,[Detratoras]\n    \t\t\t\t,[NPS]\n    \t\t)\n    \t\tVALUES (\n    \t\t\t\t 1\n    \t\t\t\t,fonte.[DataHora]\n    \t\t\t\t,fonte.[ID Selecionar]\n    \t\t\t\t,fonte.[Tribo Completa]\n    \t\t\t\t,fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t\t,fonte.[Promotoras]\n    \t\t\t\t,fonte.[Neutras]\n    \t\t\t\t,fonte.[Detratoras]\n    \t\t\t\t,fonte.[NPS]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t\t destino.[Teve Evento de NPS?]\t= 1\n    \t\t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t= fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t\t,destino.[Promotoras]\t\t\t= fonte.[Promotoras]\n    \t\t\t\t,destino.[Neutras]\t\t\t\t= fonte.[Neutras]\n    \t\t\t\t,destino.[Detratoras]\t\t\t= fonte.[Detratoras]\n    \t\t\t\t,destino.[NPS]\t\t\t\t\t= fonte.[NPS]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tUPDATE SET\n    \t\t\t\t destino.[Teve Evento de NPS?]\t= 0\n    \t\t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t= 0\n    \t\t\t\t,destino.[Promotoras]\t\t\t= 0\n    \t\t\t\t,destino.[Neutras]\t\t\t\t= 0\n    \t\t\t\t,destino.[Detratoras]\t\t\t= 0\n    \t\t\t\t,destino.[NPS]\t\t\t\t\t= NULL\n    \t;\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_log;\n        END\n    IF 1=1 AND (@metrica IS NULL OR @metrica='log')\n        BEGIN; PRINT '--- log';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_log;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \t\tMERGE INTO destino USING\n    \t\t(\n    \t\t\tSELECT\n    \t\t\t\t [DataHora]\t\t\t\t\t\t\t=\t[DataHora]\n    \t\t\t\t,[ID Selecionar]\t\t\t\t\t=\t[ID Selecionar]\n    \t\t\t\t,[Tribo Completa]\t\t\t\t\t=\tISNULL([Tribo Completa], '____')\n    \t\t\t\t,[Login (Ponto)]\t\t\t\t\t=   CAST(IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto]) AS time(3))\n    \t\t\t\t,[Logout (Ponto)]\t\t\t\t\t=   CAST(IIF([Logout_ponto] > [Proxima_DataHora] , [Proxima_DataHora], [Logout_ponto]) AS time(3))\n    \t\t\t\t,[Trabalhado (Ponto)]\t\t\t\t=   ISNULL([Trabalhado (Ponto)], 0)/1000.0\n    \t\t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=   ISNULL([Em Pausa (Ponto)], 0)/1000.0\n\t\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t=\t(ISNULL([Trabalhado (Ponto)], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-\tIIF([Tribo Completa] IN ('Serasa - SP__SDR__Inside Sales', 'Serasa - SP__N1__Large N1', 'Serasa - SP__PME__PME', 'Diogo Cabido__Papa Fila__Papa Fila')\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Trabalhado_cortado_ponto]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Log_cortado]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n    \t\t\t\t,[Login]\t\t\t\t\t\t\t=\tIIF([Tribo Completa] IN ('Serasa - SP__SDR__Inside Sales', 'Serasa - SP__N1__Large N1', 'Serasa - SP__PME__PME', 'Diogo Cabido__Papa Fila__Papa Fila')\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto]) AS time(3))\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Login] < [DataHora] , [DataHora], [Login]) AS time(3))\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t,[Logout]\t\t\t\t\t\t\t=\tIIF([Tribo Completa] IN ('Serasa - SP__SDR__Inside Sales', 'Serasa - SP__N1__Large N1', 'Serasa - SP__PME__PME', 'Diogo Cabido__Papa Fila__Papa Fila')\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Logout_ponto] > [Proxima_DataHora] , [Proxima_DataHora], [Logout_ponto]) AS time(3))\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Logout] > [Proxima_DataHora] , [Proxima_DataHora], [Logout]) AS time(3))\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t,[Log descartado (>2HE)]\t\t\t=\tIIF([Tribo Completa] IN ('Serasa - SP__SDR__Inside Sales', 'Serasa - SP__N1__Large N1', 'Serasa - SP__PME__PME', 'Diogo Cabido__Papa Fila__Papa Fila')\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado_ponto] > [Limite_HE_ponto]\tTHEN CASE WHEN [Log_Acumulado_ponto] - [Limite_HE_ponto] < 1800000\tTHEN\t [Log_Acumulado_ponto] - [Limite_HE_ponto]\tELSE [Trabalhado (Ponto)]\tEND\tELSE 0\tEND/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado] > [Limite_HE]\tTHEN CASE WHEN [Log_Acumulado] - [Limite_HE] < 1800000\tTHEN\t [Log_Acumulado] - [Limite_HE]\tELSE [Log]\tEND\tELSE 0\tEND/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t,[Log HE]\t\t\t\t\t\t\t\t=\tIIF([Tribo Completa] IN ('Serasa - SP__SDR__Inside Sales', 'Serasa - SP__N1__Large N1', 'Serasa - SP__PME__PME', 'Diogo Cabido__Papa Fila__Papa Fila')\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado_ponto] > [Limite_HE_ponto]  THEN CASE WHEN [Log_Acumulado_ponto] - [Limite_HE_ponto] < 1800000 THEN\t [Trabalhado_cortado_ponto]\t\t\t\t\tELSE 0\t\tEND ELSE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   CASE WHEN [Log_Acumulado_ponto] > [Inicio_HE_ponto]\tTHEN CASE WHEN [Log_Acumulado_ponto] - [Inicio_HE_ponto] < 1800000 THEN\t([Log_Acumulado_ponto] - [Inicio_HE_ponto]) ELSE [Trabalhado (Ponto)]\tEND\tELSE 0\tEND\tEND/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado] > [Limite_HE]  THEN CASE WHEN [Log_Acumulado] - [Limite_HE] < 1800000 THEN\t [Log_cortado]\t\t\t\t\tELSE 0\t\tEND ELSE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   CASE WHEN [Log_Acumulado] > [Inicio_HE]\tTHEN CASE WHEN [Log_Acumulado] - [Inicio_HE] < 1800000 THEN\t([Log_Acumulado] - [Inicio_HE]) ELSE [log]\tEND\tELSE 0\tEND\tEND/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t    )\n    \t\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tIIF([Tribo Completa] IN ('Serasa - SP__SDR__Inside Sales', 'Serasa - SP__N1__Large N1', 'Serasa - SP__PME__PME', 'Diogo Cabido__Papa Fila__Papa Fila')\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Trabalhado_cortado_ponto]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Log_cortado]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t,[Log Produtivo]\t\t\t\t\t=\tIIF([Tribo Completa] IN ('Serasa - SP__SDR__Inside Sales', 'Serasa - SP__N1__Large N1', 'Serasa - SP__PME__PME', 'Diogo Cabido__Papa Fila__Papa Fila')\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Trabalhado_cortado_ponto]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,\n    \t\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Tempo Livre], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Sistema Externo], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Outbound], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tempo Livre], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Sistema (Externo)], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Discagem Manual], 0)\n\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Em Ligacao], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Transfer\u00eancia], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tratativa], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_WhatsApp], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Backoffice], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Discagem Manual], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Discagem Retorno], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Em Fila], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Sistema Externo], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Tratativa], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Whatsapp], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n    \t\t\t\t,[Log Improdutivo]\t\t\t\t\t=\tIIF([Tribo Completa] IN ('Serasa - SP__SDR__Inside Sales', 'Serasa - SP__N1__Large N1', 'Serasa - SP__PME__PME', 'Diogo Cabido__Papa Fila__Papa Fila')\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,0\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,\n    \t\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Pausa Particular], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Break], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa 10], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Lanche], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa R\u00e1pida], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Almo\u00e7o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Feedback], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Treinamento], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Banheiro], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Sistema Interno], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Reuni\u00e3o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Ambulat\u00f3rio], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa NR17], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Almo\u00e7o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Ambulat\u00f3rio], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Banheiro], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Feedback], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Intervalo], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_P\u00f3s Atendimento], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Reuni\u00e3o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Sistema (interno)], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Treinamento], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_BackOffice], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Login], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_N\u00e3o Disponivel], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Almo\u00e7o], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Ambulat\u00f3rio], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Banheiro], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Descanso], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Feedback], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Dispon\u00edvel], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Sistema Interno], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Treinamento], 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n\n    \t\t\t\t,[Tempo Livre]\t\t\t\t\t\t=\n    \t\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Tempo Livre]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tempo Livre]/1000.0, 0)\n    \t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n    \t\t\t\t,[Pausa Particular (Intelix)]\t\t=\tISNULL([Intelix_Pausa Particular]/1000.0, 0)\n    \t\t\t\t,[Pausa Break (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Break]/1000.0, 0)\n    \t\t\t\t,[Pausa 10 (Intelix)] \t\t\t\t=\tISNULL([Intelix_Pausa 10]/1000.0, 0)\n    \t\t\t\t,[Pausa Outbound (Intelix)] \t\t=\tISNULL([Intelix_Pausa Outbound]/1000.0, 0)\n    \t\t\t\t,[Pausa Lanche (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Lanche]/1000.0, 0)\n    \t\t\t\t,[Pausa R\u00e1pida (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa R\u00e1pida]/1000.0, 0)\n    \t\t\t\t,[Pausa Almo\u00e7o (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Almo\u00e7o]/1000.0, 0)\n    \t\t\t\t,[Pausa Feedback (Intelix)] \t\t=\tISNULL([Intelix_Pausa Feedback]/1000.0, 0)\n    \t\t\t\t,[Pausa Sistema Interno (Intelix)] \t=\tISNULL([Intelix_Pausa Sistema Interno]/1000.0, 0)\n    \t\t\t\t,[Pausa Sistema Externo (Intelix)] \t=\tISNULL([Intelix_Pausa Sistema Externo]/1000.0, 0)\n    \t\t\t\t,[Pausa Treinamento (Intelix)] \t\t=\tISNULL([Intelix_Pausa Treinamento]/1000.0, 0)\n    \t\t\t\t,[Pausa Banheiro (Intelix)] \t\t=\tISNULL([Intelix_Pausa Banheiro]/1000.0, 0)\n    \t\t\t\t,[Pausa Reuni\u00e3o (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Reuni\u00e3o]/1000.0, 0)\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)] \t\t=\tISNULL([Intelix_Pausa Ambulat\u00f3rio]/1000.0, 0)\n    \t\t\t\t,[Pausa NR17 (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa NR17]/1000.0, 0)\n\n    \t\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tISNULL([EPBX_Em Ligacao]/1000.0, 0)\n    \t\t\t\t,[Pausa Almo\u00e7o (EPBX)] \t\t\t\t=\tISNULL([EPBX_Almo\u00e7o]/1000.0, 0)\n    \t\t\t\t,[Pausa Tratativa (EPBX)] \t\t\t=\tISNULL([EPBX_Tratativa]/1000.0, 0)\n    \t\t\t\t,[Pausa Discagem Manual (EPBX)] \t=\tISNULL([EPBX_Discagem Manual]/1000.0, 0)\n    \t\t\t\t,[Pausa Banheiro (EPBX)] \t\t\t=\tISNULL([EPBX_Banheiro]/1000.0, 0)\n    \t\t\t\t,[Pausa WhatsApp (EPBX)] \t\t\t=\tISNULL([EPBX_WhatsApp]/1000.0, 0)\n    \t\t\t\t,[Pausa Intervalo (EPBX)] \t\t\t=\tISNULL([EPBX_Intervalo]/1000.0, 0)\n    \t\t\t\t,[Pausa Discagem Retorno (EPBX)] \t=\tISNULL([EPBX_Discagem Retorno]/1000.0, 0)\n    \t\t\t\t,[Pausa Treinamento (EPBX)] \t\t=\tISNULL([EPBX_Treinamento]/1000.0, 0)\n    \t\t\t\t,[Pausa Feedback (EPBX)] \t\t\t=\tISNULL([EPBX_Feedback]/1000.0, 0)\n    \t\t\t\t,[Pausa Transfer\u00eancia (EPBX)] \t\t=\tISNULL([EPBX_Transfer\u00eancia]/1000.0, 0)\n    \t\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)] \t\t=\tISNULL([EPBX_N\u00e3o Disponivel]/1000.0, 0)\n    \t\t\t\t,[Pausa Login (EPBX)] \t\t\t\t=\tISNULL([EPBX_Login]/1000.0, 0)\n    \t\t\t\t,[Pausa Reuni\u00e3o (EPBX)] \t\t\t=\tISNULL([EPBX_Reuni\u00e3o]/1000.0, 0)\n    \t\t\t\t,[Pausa Sistema Interno (EPBX)] \t=\tISNULL([EPBX_Sistema (interno)]/1000.0, 0)\n    \t\t\t\t,[Pausa Sistema Externo (EPBX)] \t=\tISNULL([EPBX_Sistema (Externo)]/1000.0, 0)\n    \t\t\t\t,[Pausa NR17 (EPBX)] \t\t\t\t=\tISNULL([EPBX_NR17]/1000.0, 0)\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)] \t\t=\tISNULL([EPBX_Ambulat\u00f3rio]/1000.0, 0)\n    \t\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)] \t=\tISNULL([EPBX_P\u00f3s Atendimento]/1000.0, 0)\n    \t\t\t\t,[Pausa Lanche (EPBX)] \t\t\t\t=\tISNULL([EPBX_Lanche]/1000.0, 0)\n    \t\t\t\t,[Pausa BackOffice (EPBX)] \t\t\t=\tISNULL([EPBX_BackOffice]/1000.0, 0)\n\n    \t\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tISNULL([Genesys_Almo\u00e7o]/1000.0, 0)\t\t\t\t-- Improd\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tISNULL([Genesys_Ambulat\u00f3rio]/1000.0, 0)\t\t\t-- Improd\n    \t\t\t\t,[Pausa Banheiro (Genesys)]\t\t\t=\tISNULL([Genesys_Banheiro]/1000.0, 0)\t\t\t-- Improd\n    \t\t\t\t,[Pausa Descanso (Genesys)]\t\t\t=\tISNULL([Genesys_Descanso]/1000.0, 0)\t\t\t-- Improd\n    \t\t\t\t,[Pausa Feedback (Genesys)]\t\t\t=\tISNULL([Genesys_Feedback]/1000.0, 0)\t\t\t-- Improd\n    \t\t\t\t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tISNULL([Genesys_Dispon\u00edvel]/1000.0, 0)\t\t\t-- Improd\n\n    \t\t\t\t,[Pausa Backoffice (Genesys)]\t\t=\tISNULL([Genesys_Backoffice]/1000.0, 0)\t\t\t-- Prod\n    \t\t\t\t,[Pausa Discagem Manual (Genesys)]\t=\tISNULL([Genesys_Discagem Manual]/1000.0, 0)\t\t-- Prod\n    \t\t\t\t,[Pausa Discagem Retorno (Genesys)]\t=\tISNULL([Genesys_Discagem Retorno]/1000.0, 0)\t-- Prod\n    \t\t\t\t,[Pausa Em Fila (Genesys)]\t\t\t=\tISNULL([Genesys_Em Fila]/1000.0, 0)\t\t\t\t-- Prod\n    \t\t\t\t,[Pausa Sistema Externo (Genesys)]\t=\tISNULL([Genesys_Sistema Externo]/1000.0, 0)\t\t-- Prod\n    \t\t\t\t,[Pausa Sistema Interno (Genesys)]\t=\tISNULL([Genesys_Sistema Interno]/1000.0, 0)\t\t-- Improd\n    \t\t\t\t,[Pausa Tratativa (Genesys)]\t\t=\tISNULL([Genesys_Tratativa]/1000.0, 0)\t\t\t-- Prod\n    \t\t\t\t,[Pausa Whatsapp (Genesys)]\t\t\t=\tISNULL([Genesys_Whatsapp]/1000.0, 0)\t\t\t-- Prod\n    \t\t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tISNULL([Genesys_Treinamento]/1000.0, 0)\t\t\t-- Improd\n\n    \t\t\tFROM (\n    \t\t\t\tSELECT *\n    \t\t\t\t\t,[Log_Acumulado]=\tSUM([Log]) OVER (PARTITION BY [ID Selecionar], [Data] ORDER BY [DataHora])\n    \t\t\t\t\t,[Inicio_HE]\t=\t[Jornada (Log)]\n    \t\t\t\t\t,[Limite_HE]\t=\t[Jornada (Log)]+7200000\n\n    \t\t\t\t\t,[Log_Acumulado_ponto]\t=\tSUM([Trabalhado (Ponto)]) OVER (PARTITION BY [ID Selecionar], [Data] ORDER BY [DataHora])\n    \t\t\t\t\t,[Inicio_HE_ponto]\t\t=\t[Jornada (Ponto)]\n    \t\t\t\t\t,[Limite_HE_ponto]\t\t=\t[Jornada (Ponto)]+7200000\n    \t\t\t\tFROM (\n    \t\t\t\t\tSELECT\n    \t\t\t\t\t\t [DataHora]\t\t\t\t\t\t\t=\t[DataHora]\n    \t\t\t\t\t\t,[Proxima_DataHora]\t\t\t\t\t=\t[Proxima_DataHora]\n    \t\t\t\t\t\t,[Data]\t\t\t\t\t\t\t\t=\t[Data]\n    \t\t\t\t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n    \t\t\t\t\t\t,[Tribo Completa]\t\t\t\t\t=\tISNULL([Tribo Completa], '____')\n\n    \t\t\t\t\t\t---\\/ponto\\/\n    \t\t\t\t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tMAX([Jornada (Ponto)])*1000\n    \t\t\t\t\t\t,[Login_ponto]\t\t\t\t\t\t=\tMIN(MIN(IIF(Fonte =  'SECULLUM',[In\u00edcio], NULL))) OVER (PARTITION BY c.[ID Selecionar], [Data])\n    \t\t\t\t\t\t,[Logout_ponto]\t\t\t\t\t\t=\tMAX(MAX(IIF(Fonte =  'SECULLUM',[Fim], NULL)))\t OVER (PARTITION BY c.[ID Selecionar], [Data])\n\n    \t\t\t\t\t\t,[Trabalhado (Ponto)]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'SECULLUM' AND Evento = ('Trabalhado'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Trabalhado_cortado_ponto]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'SECULLUM' AND Evento = ('Trabalhado'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'SECULLUM' AND Evento = ('Em Pausa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t---/\\ponto/\\\n\n    \t\t\t\t\t\t,[Jornada (Log)]\t\t\t\t\t=\tMAX([Jornada (Log)])*1000\n    \t\t\t\t\t\t,[Login]\t\t\t\t\t\t\t=\tMIN(MIN(IIF(Fonte = 'INTELIX' OR Fonte = 'EPBX' OR Fonte = 'GENESYS',[In\u00edcio], NULL))) OVER (PARTITION BY c.[ID Selecionar], [Data])\n    \t\t\t\t\t\t,[Logout]\t\t\t\t\t\t\t=\tMAX(MAX(IIF(Fonte = 'INTELIX' OR Fonte = 'EPBX' OR Fonte = 'GENESYS',[Fim], NULL)))\t OVER (PARTITION BY c.[ID Selecionar], [Data])\n\n    \t\t\t\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' OR Fonte = 'EPBX' OR Fonte = 'GENESYS'\t\t  THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Log_cortado]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' OR Fonte = 'EPBX' OR Fonte = 'GENESYS'\t\t  THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\n    \t\t\t\t\t\t,[Intelix_Tempo Livre]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Login'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Particular]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Particular (Break))'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Break]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Break)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa 10]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Pausa 10)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Outbound]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Outbound)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Lanche]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Lanche)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa R\u00e1pida]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Pausa Rapida)'\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Almo\u00e7o]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Almoco)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Feedback]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Feedback)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Sistema Externo]\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Sistema (Externo))'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Treinamento]\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Treinamento)'\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Banheiro]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Banheiro)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Sistema Interno]\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Sistema (Interno))'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Reuni\u00e3o]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Reuniao)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa Ambulat\u00f3rio]\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Ambulatorio)'\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Intelix_Pausa NR17]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (NR 17)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\n    \t\t\t\t\t\t,[EPBX_Tempo Livre]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Livre'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Em Ligacao]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Em Ligacao'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Almo\u00e7o]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Almo\u00e7o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Tratativa]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Tratativa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Discagem Manual]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Discagem Manual'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Banheiro]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Banheiro'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_WhatsApp]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('WhatsApp'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Intervalo]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Intervalo'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Discagem Retorno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Discagem Retorno'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Treinamento]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Treinamento'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Feedback]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Feedback'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Transfer\u00eancia]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Transfer\u00eancia'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Sistema (Externo)]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Sistema (Externo)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_N\u00e3o Disponivel]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('N\u00e3o Disponivel'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Login]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Login'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Reuni\u00e3o]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Reuni\u00e3o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Sistema (interno)]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Sistema (interno)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_NR17]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('NR17'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Ambulat\u00f3rio]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Ambulat\u00f3rio'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_P\u00f3s Atendimento]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('P\u00f3s Atendimento'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_Lanche]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Lanche'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[EPBX_BackOffice]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('BackOffice'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\n    \t\t\t\t\t\t,[Genesys_Almo\u00e7o]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Almo\u00e7o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Ambulat\u00f3rio]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Ambulat\u00f3rio'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Backoffice]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Backoffice'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Banheiro]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Banheiro'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Descanso]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Descanso'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Discagem Manual]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Discagem Manual'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Discagem Retorno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Discagem Retorno'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Dispon\u00edvel]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Dispon\u00edvel'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Em Fila]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Em Fila'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Feedback]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Feedback'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Sistema Externo]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Sistema Externo'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Sistema Interno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Sistema Interno'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Tratativa]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Tratativa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Whatsapp]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Whatsapp'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n    \t\t\t\t\t\t,[Genesys_Treinamento]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Treinamento'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\n\n    \t\t\t\t\tFROM [db_prod_d0].[dbo].[f_log] l\n    \t\t\t\t\tRIGHT JOIN [#chaves] c\n    \t\t\t\t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(l.[ID Selecionar], '-')\n    \t\t\t\t\tAND\tc.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio]) / 30.0) * 30, 0)\n    \t\t\t\t\tAND\tc.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim]) / 30.0) * 30, 0)\n\n    \t\t\t\t\tWHERE c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim\n    \t\t\t\t\tAND\t  In\u00edcio >= @datahora_inicio AND Fim <= @datahora_fim\n    \t\t\t\t\tAND c.[\u00c9 A Tribo do MOP?] = 1\n    \t\t\t\t\tGROUP BY [DataHora], [Proxima_DataHora], c.[ID Selecionar], [Data],\t[Tribo Completa]\n    \t\t\t\t) c\n    \t\t\t) c\n\n\n    \t\t) AS fonte\n\n    \t\tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n    \t\tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \t\tAND fonte.[Tribo Completa]\t=\tdestino.[Tribo Completa]\n\n    \t\tWHEN NOT MATCHED BY TARGET THEN\n    \t\t\tINSERT (\n    \t\t\t\t [Teve Evento de Log?]\n    \t\t\t\t,[DataHora]\n    \t\t\t\t,[ID Selecionar]\n    \t\t\t\t,[Tribo Completa]\n\t\t\t\t\t,[Login (Ponto)]\n\t\t\t\t\t,[Logout (Ponto)]\n    \t\t\t\t,[Trabalhado (Ponto)]\n    \t\t\t\t,[Em Pausa (Ponto)]\n\t\t\t\t\t,[Desvio Ponto-Log]\n    \t\t\t\t,[Login]\n    \t\t\t\t,[Logout]\n    \t\t\t\t,[Log descartado (>2HE)]\n    \t\t\t\t,[Log HE]\n    \t\t\t\t,[Log]\n    \t\t\t\t,[Log Produtivo]\n    \t\t\t\t,[Log Improdutivo]\n    \t\t\t\t,[Tempo Livre]\n    \t\t\t\t,[Pausa Particular (Intelix)]\n    \t\t\t\t,[Pausa Break (Intelix)]\n    \t\t\t\t,[Pausa 10 (Intelix)]\n    \t\t\t\t,[Pausa Outbound (Intelix)]\n    \t\t\t\t,[Pausa Lanche (Intelix)]\n    \t\t\t\t,[Pausa R\u00e1pida (Intelix)]\n    \t\t\t\t,[Pausa Almo\u00e7o (Intelix)]\n    \t\t\t\t,[Pausa Feedback (Intelix)]\n    \t\t\t\t,[Pausa Sistema Interno (Intelix)]\n    \t\t\t\t,[Pausa Sistema Externo (Intelix)]\n    \t\t\t\t,[Pausa Treinamento (Intelix)]\n    \t\t\t\t,[Pausa Banheiro (Intelix)]\n    \t\t\t\t,[Pausa Reuni\u00e3o (Intelix)]\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t\t\t,[Pausa NR17 (Intelix)]\n    \t\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t\t\t,[Pausa Almo\u00e7o (EPBX)]\n    \t\t\t\t,[Pausa Tratativa (EPBX)]\n    \t\t\t\t,[Pausa Discagem Manual (EPBX)]\n    \t\t\t\t,[Pausa Banheiro (EPBX)]\n    \t\t\t\t,[Pausa WhatsApp (EPBX)]\n    \t\t\t\t,[Pausa Intervalo (EPBX)]\n    \t\t\t\t,[Pausa Discagem Retorno (EPBX)]\n    \t\t\t\t,[Pausa Treinamento (EPBX)]\n    \t\t\t\t,[Pausa Feedback (EPBX)]\n    \t\t\t\t,[Pausa Transfer\u00eancia (EPBX)]\n    \t\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t\t\t,[Pausa Login (EPBX)]\n    \t\t\t\t,[Pausa Reuni\u00e3o (EPBX)]\n    \t\t\t\t,[Pausa Sistema Interno (EPBX)]\n    \t\t\t\t,[Pausa Sistema Externo (EPBX)]\n    \t\t\t\t,[Pausa NR17 (EPBX)]\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t\t\t,[Pausa Lanche (EPBX)]\n    \t\t\t\t,[Pausa BackOffice (EPBX)]\n    \t\t\t\t,[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t\t,[Pausa Banheiro (Genesys)]\n    \t\t\t\t,[Pausa Descanso (Genesys)]\n    \t\t\t\t,[Pausa Feedback (Genesys)]\n    \t\t\t\t,[Pausa Backoffice (Genesys)]\n    \t\t\t\t,[Pausa Discagem Manual (Genesys)]\n    \t\t\t\t,[Pausa Discagem Retorno (Genesys)]\n    \t\t\t\t,[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t\t,[Pausa Em Fila (Genesys)]\n    \t\t\t\t,[Pausa Sistema Externo (Genesys)]\n    \t\t\t\t,[Pausa Sistema Interno (Genesys)]\n    \t\t\t\t,[Pausa Tratativa (Genesys)]\n    \t\t\t\t,[Pausa Whatsapp (Genesys)]\n    \t\t\t\t,[Pausa Treinamento (Genesys)]\n    \t\t\t\t)\n    \t\t\tVALUES (\n    \t\t\t\t 1\n    \t\t\t\t,fonte.[DataHora]\n    \t\t\t\t,fonte.[ID Selecionar]\n    \t\t\t\t,fonte.[Tribo Completa]\n\t\t\t\t\t,fonte.[Login (Ponto)]\n\t\t\t\t\t,fonte.[Logout (Ponto)]\n    \t\t\t\t,fonte.[Trabalhado (Ponto)]\n    \t\t\t\t,fonte.[Em Pausa (Ponto)]\n\t\t\t\t\t,fonte.[Desvio Ponto-Log]\n    \t\t\t\t,fonte.[Login]\n    \t\t\t\t,fonte.[Logout]\n    \t\t\t\t,fonte.[Log descartado (>2HE)]\n    \t\t\t\t,fonte.[Log HE]\n    \t\t\t\t,fonte.[Log]\n    \t\t\t\t,fonte.[Log Produtivo]\n    \t\t\t\t,fonte.[Log Improdutivo]\n    \t\t\t\t,fonte.[Tempo Livre]\n    \t\t\t\t,fonte.[Pausa Particular (Intelix)]\n    \t\t\t\t,fonte.[Pausa Break (Intelix)]\n    \t\t\t\t,fonte.[Pausa 10 (Intelix)]\n    \t\t\t\t,fonte.[Pausa Outbound (Intelix)]\n    \t\t\t\t,fonte.[Pausa Lanche (Intelix)]\n    \t\t\t\t,fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t\t\t,fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t\t\t,fonte.[Pausa Feedback (Intelix)]\n    \t\t\t\t,fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t\t\t,fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t\t\t,fonte.[Pausa Treinamento (Intelix)]\n    \t\t\t\t,fonte.[Pausa Banheiro (Intelix)]\n    \t\t\t\t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t\t\t,fonte.[Pausa NR17 (Intelix)]\n    \t\t\t\t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t\t\t,fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t\t\t,fonte.[Pausa Tratativa (EPBX)]\n    \t\t\t\t,fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t\t\t,fonte.[Pausa Banheiro (EPBX)]\n    \t\t\t\t,fonte.[Pausa WhatsApp (EPBX)]\n    \t\t\t\t,fonte.[Pausa Intervalo (EPBX)]\n    \t\t\t\t,fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t\t\t,fonte.[Pausa Treinamento (EPBX)]\n    \t\t\t\t,fonte.[Pausa Feedback (EPBX)]\n    \t\t\t\t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t\t\t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t\t\t,fonte.[Pausa Login (EPBX)]\n    \t\t\t\t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t\t\t,fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t\t\t,fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t\t\t,fonte.[Pausa NR17 (EPBX)]\n    \t\t\t\t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t\t\t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t\t\t,fonte.[Pausa Lanche (EPBX)]\n    \t\t\t\t,fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t\t,fonte.[Pausa Banheiro (Genesys)]\n    \t\t\t\t,fonte.[Pausa Descanso (Genesys)]\n    \t\t\t\t,fonte.[Pausa Feedback (Genesys)]\n    \t\t\t\t,fonte.[Pausa Backoffice (Genesys)]\n    \t\t\t\t,fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t\t\t,fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t\t\t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t\t,fonte.[Pausa Em Fila (Genesys)]\n    \t\t\t\t,fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t\t\t,fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t\t\t,fonte.[Pausa Tratativa (Genesys)]\n    \t\t\t\t,fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t\t,fonte.[Pausa Treinamento (Genesys)]\n    \t\t\t\t)\n    \t\tWHEN MATCHED THEN\n    \t\t\tUPDATE SET\n    \t\t\t\t destino.[Teve Evento de Log?]\t\t\t\t=\t1\n    \t\t\t\t,destino.[DataHora]\t\t\t\t\t\t\t=\tfonte.[DataHora]\n    \t\t\t\t,destino.[ID Selecionar]\t\t\t\t\t=\tfonte.[ID Selecionar]\n    \t\t\t\t,destino.[Tribo Completa]\t\t\t\t\t=\tfonte.[Tribo Completa]\n\t\t\t\t\t,destino.[Login (Ponto)]\t\t\t\t\t=\tfonte.[Login (Ponto)]\n\t\t\t\t\t,destino.[Logout (Ponto)]\t\t\t\t\t=\tfonte.[Logout (Ponto)]\n    \t\t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t=\tfonte.[Trabalhado (Ponto)]\n    \t\t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t=\tfonte.[Em Pausa (Ponto)]\n\t\t\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t=\tfonte.[Desvio Ponto-Log]\n    \t\t\t\t,destino.[Login]\t\t\t\t\t\t\t=\tfonte.[Login]\n    \t\t\t\t,destino.[Logout]\t\t\t\t\t\t\t=\tfonte.[Logout]\n    \t\t\t\t,destino.[Log descartado (>2HE)]\t\t\t=\tfonte.[Log descartado (>2HE)]\n    \t\t\t\t,destino.[Log HE]\t\t\t\t\t\t\t=\tfonte.[Log HE]\n    \t\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t=\tfonte.[Log]\n    \t\t\t\t,destino.[Log Produtivo]\t\t\t\t\t=\tfonte.[Log Produtivo]\n    \t\t\t\t,destino.[Log Improdutivo]\t\t\t\t\t=\tfonte.[Log Improdutivo]\n    \t\t\t\t,destino.[Tempo Livre]\t\t\t\t\t\t=\tfonte.[Tempo Livre]\n    \t\t\t\t,destino.[Pausa Particular (Intelix)]\t\t=\tfonte.[Pausa Particular (Intelix)]\n    \t\t\t\t,destino.[Pausa Break (Intelix)]\t\t\t=\tfonte.[Pausa Break (Intelix)]\n    \t\t\t\t,destino.[Pausa 10 (Intelix)]\t\t\t\t=\tfonte.[Pausa 10 (Intelix)]\n    \t\t\t\t,destino.[Pausa Outbound (Intelix)]\t\t\t=\tfonte.[Pausa Outbound (Intelix)]\n    \t\t\t\t,destino.[Pausa Lanche (Intelix)]\t\t\t=\tfonte.[Pausa Lanche (Intelix)]\n    \t\t\t\t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\tfonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tfonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t\t\t,destino.[Pausa Feedback (Intelix)]\t\t\t=\tfonte.[Pausa Feedback (Intelix)]\n    \t\t\t\t,destino.[Pausa Sistema Interno (Intelix)]\t=\tfonte.[Pausa Sistema Interno (Intelix)]\n    \t\t\t\t,destino.[Pausa Sistema Externo (Intelix)]\t=\tfonte.[Pausa Sistema Externo (Intelix)]\n    \t\t\t\t,destino.[Pausa Treinamento (Intelix)]\t\t=\tfonte.[Pausa Treinamento (Intelix)]\n    \t\t\t\t,destino.[Pausa Banheiro (Intelix)]\t\t\t=\tfonte.[Pausa Banheiro (Intelix)]\n    \t\t\t\t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tfonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tfonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t\t\t,destino.[Pausa NR17 (Intelix)]\t\t\t\t=\tfonte.[Pausa NR17 (Intelix)]\n    \t\t\t\t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tfonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tfonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t\t\t,destino.[Pausa Tratativa (EPBX)]\t\t\t=\tfonte.[Pausa Tratativa (EPBX)]\n    \t\t\t\t,destino.[Pausa Discagem Manual (EPBX)]\t\t=\tfonte.[Pausa Discagem Manual (EPBX)]\n    \t\t\t\t,destino.[Pausa Banheiro (EPBX)]\t\t\t=\tfonte.[Pausa Banheiro (EPBX)]\n    \t\t\t\t,destino.[Pausa WhatsApp (EPBX)]\t\t\t=\tfonte.[Pausa WhatsApp (EPBX)]\n    \t\t\t\t,destino.[Pausa Intervalo (EPBX)]\t\t\t=\tfonte.[Pausa Intervalo (EPBX)]\n    \t\t\t\t,destino.[Pausa Discagem Retorno (EPBX)]\t=\tfonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t\t\t,destino.[Pausa Treinamento (EPBX)]\t\t\t=\tfonte.[Pausa Treinamento (EPBX)]\n    \t\t\t\t,destino.[Pausa Feedback (EPBX)]\t\t\t=\tfonte.[Pausa Feedback (EPBX)]\n    \t\t\t\t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\tfonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t\t\t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tfonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t\t\t,destino.[Pausa Login (EPBX)]\t\t\t\t=\tfonte.[Pausa Login (EPBX)]\n    \t\t\t\t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tfonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t\t\t,destino.[Pausa Sistema Interno (EPBX)]\t\t=\tfonte.[Pausa Sistema Interno (EPBX)]\n    \t\t\t\t,destino.[Pausa Sistema Externo (EPBX)]\t\t=\tfonte.[Pausa Sistema Externo (EPBX)]\n    \t\t\t\t,destino.[Pausa NR17 (EPBX)]\t\t\t\t=\tfonte.[Pausa NR17 (EPBX)]\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tfonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t\t\t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tfonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t\t\t,destino.[Pausa Lanche (EPBX)]\t\t\t\t=\tfonte.[Pausa Lanche (EPBX)]\n    \t\t\t\t,destino.[Pausa BackOffice (EPBX)]\t\t\t=\tfonte.[Pausa BackOffice (EPBX)]\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tfonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tfonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t=\tfonte.[Pausa Banheiro (Genesys)]\n    \t\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t=\tfonte.[Pausa Descanso (Genesys)]\n    \t\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t=\tfonte.[Pausa Feedback (Genesys)]\n    \t\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t=\tfonte.[Pausa Backoffice (Genesys)]\n    \t\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t=\tfonte.[Pausa Discagem Manual (Genesys)]\n    \t\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t=\tfonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\tfonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t=\tfonte.[Pausa Em Fila (Genesys)]\n    \t\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t=\tfonte.[Pausa Sistema Externo (Genesys)]\n    \t\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t=\tfonte.[Pausa Sistema Interno (Genesys)]\n    \t\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t=\tfonte.[Pausa Tratativa (Genesys)]\n    \t\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t=\tfonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t=\tfonte.[Pausa Treinamento (Genesys)]\n    \t\tWHEN NOT MATCHED BY SOURCE THEN\n    \t\t\tUPDATE SET\n    \t\t\t\t destino.[Teve Evento de Log?]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t=\tNULL\n    \t\t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t=\tNULL\n    \t\t\t\t,destino.[Jornada (Log)]\t\t\t\t\t=\t0\n\t\t\t\t\t,destino.[Login (Ponto)]\t\t\t\t\t=\tNULL\n\t\t\t\t\t,destino.[Logout (Ponto)]\t\t\t\t\t=\tNULL\n\t\t\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Login]\t\t\t\t\t\t\t=\tNULL\n    \t\t\t\t,destino.[Logout]\t\t\t\t\t\t\t=\tNULL\n    \t\t\t\t,destino.[Log descartado (>2HE)]\t\t\t=\t0\n    \t\t\t\t,destino.[Log HE]\t\t\t\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Log Produtivo]\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Log Improdutivo]\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Tempo Livre]\t\t\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Particular (Intelix)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Break (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa 10 (Intelix)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Outbound (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Lanche (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Feedback (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Interno (Intelix)]\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Externo (Intelix)]\t=\t0\n    \t\t\t\t,destino.[Pausa Treinamento (Intelix)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Banheiro (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa NR17 (Intelix)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Tratativa (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Discagem Manual (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Banheiro (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa WhatsApp (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Intervalo (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Discagem Retorno (EPBX)]\t=\t0\n    \t\t\t\t,destino.[Pausa Treinamento (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Feedback (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Login (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Interno (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Externo (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa NR17 (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Lanche (EPBX)]\t\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa BackOffice (EPBX)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t=\t0\n    \t\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t=\t0\n    \t\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t=\t0\n    \t\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t=\t0\n    \t\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t=\t0\n    \t\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t=\t0\n    \t\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t=\t0\n    \t\t;\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_log;\n        END\n    IF 1=1 BEGIN; PRINT '--- cleanup';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_cleanup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT DISTINCT\n    \t\t\t [DataHora]\t\t\t\t\t\t\t=\tc.[DataHora]\n    \t\t\t,[Intervalo]\t\t\t\t\t\t=\tMIN(c.[Intervalo])\n    \t\t\t,[Data]\t\t\t\t\t\t\t\t=\tMIN(c.[Data])\n    \t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t=\tMIN(c.[Ciclo (Primeiro Dia)])\n    \t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t=\tMIN(c.[M\u00eas (Primeiro Dia)])\n\n                ,[Feriado (Nome)]                                     =  MAX(c.[Feriado (Nome)])\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(MAX(c.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(MAX(c.[Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t        ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(MAX(c.[Secullum - Servi\u00e7o Militar]                                   ),0)\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(MAX(c.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t        ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(MAX(c.[Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t        ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(MAX(c.[Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(MAX(c.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t        ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(MAX(c.[Secullum - Licen\u00e7a Casamento]                                 ),0)\n                ,[Secullum - INSS - Afastamento]                                    =   ISNULL(MAX(c.[Secullum - INSS - Afastamento]                                ),0)\n                ,[Secullum - Folga]                                                 =   ISNULL(MAX(c.[Secullum - Folga]                                             ),0)\n                ,[Secullum - F\u00e9rias]                                                =   ISNULL(MAX(c.[Secullum - F\u00e9rias]                                            ),0)\n       \t        ,[Secullum - Feriado]                                               =   ISNULL(MAX(c.[Secullum - Feriado]                                           ),0)\n       \t        ,[Secullum - Falta Justificada]                                     =   ISNULL(MAX(c.[Secullum - Falta Justificada]                                 ),0)\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(MAX(c.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                ,[Secullum - Falta Injustificada]                                   =   ISNULL(MAX(c.[Secullum - Falta Injustificada]                               ),0)\n       \t        ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(MAX(c.[Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(MAX(c.[Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                ,[Secullum - Desligue]                                              =   ISNULL(MAX(c.[Secullum - Desligue]                                          ),0)\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(MAX(c.[Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t        ,[Secullum - Compensando Horas]                                     =   ISNULL(MAX(c.[Secullum - Compensando Horas]                                 ),0)\n       \t        ,[Secullum - Atestado]                                              =   ISNULL(MAX(c.[Secullum - Atestado]                                          ),0)\n                ,[Secullum - Abono]                                                 =   ISNULL(MAX(c.[Secullum - Abono]                                             ),0)\n       \t        ,[Secullum - Abono Lactante]                                        =   ISNULL(MAX(c.[Secullum - Abono Lactante]                                    ),0)\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(MAX(c.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t        ,[Faltas Justificadas]                                              =   ISNULL(MAX(c.[Faltas Justificadas]                                          ),0)\n       \t        ,[Faltas Injustificadas]                                            =   ISNULL(MAX(c.[Faltas Injustificadas]                                        ),0)\n\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tMIN(c.[DataHora da Atualiza\u00e7\u00e3o do MOP])\n    \t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n    \t\t\t,[Nome]\t\t\t\t\t\t\t\t=\tMIN(c.[Nome])\n    \t\t\t,[Status]\t\t\t\t\t\t\t=\tMIN(c.[Status])\n    \t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN(c.[Situa\u00e7\u00e3o])\n    \t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN(c.[Condi\u00e7\u00e3o])\n    \t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tMIN(c.[DMA Inicial])\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tMIN(c.[\u00daltima DMA Migra\u00e7\u00e3o])\n    \t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tMIN(c.[\u00daltima DMA Geral])\n    \t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tMIN(c.[Tipo da \u00daltima DMA])\n    \t\t\t,[Instrutor Inicial]\t\t\t\t=\tMIN(c.[Instrutor Inicial])\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tMIN(c.[Instrutor \u00daltima Migra\u00e7\u00e3o])\n    \t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tMIN(c.[Instrutor \u00daltima DMA])\n    \t\t\t,[Cliente]\t\t\t\t\t\t\t=\tPARSENAME(REPLACE(COALESCE(r.[Tribo Completa], c.[Tribo Completa]),'__','.'),3)\n    \t\t\t,[Projeto]\t\t\t\t\t\t\t=\tPARSENAME(REPLACE(COALESCE(r.[Tribo Completa], c.[Tribo Completa]),'__','.'),2)\n    \t\t\t,[Tribo]\t\t\t\t\t\t\t=\tPARSENAME(REPLACE(COALESCE(r.[Tribo Completa], c.[Tribo Completa]),'__','.'),1)\n    \t\t\t,[Cargo]\t\t\t\t\t\t\t=\tMIN(c.[Cargo])\n    \t\t\t,[Tribo Completa]\t\t\t\t\t=\tCOALESCE(r.[Tribo Completa], c.[Tribo Completa])\n    \t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tMIN(c.[Supervis\u00e3o])\n    \t\t\t,[Email Supervis\u00e3o]\t\t\t\t\t=\tMIN(c.[Email Supervis\u00e3o])\n\t\t\t\t,[Tempo de Casa (Dias)]\t\t\t\t=\tMIN(c.[Tempo de Casa (Dias)])\n\t\t\t\t,[Faixa Tempo de Casa]\t\t\t\t=\tMIN(c.[Faixa Tempo de Casa])\n\t\t\t\t,[Idade]\t\t\t\t\t\t\t=\tMIN(c.[Idade])\n\t\t\t\t,[Faixa de Idade]\t\t\t\t\t=\tMIN(c.[Faixa de Idade])\n    \t\t\t,[Turno]\t\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Turno]), NULL)\n    \t\t\t,[Escala (Ponto)]\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Escala (Ponto)]), NULL)\n    \t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Jornada (Ponto)]), 0)\n    \t\t\t,[Escala (MOP)]\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Escala (MOP)]), NULL)\n    \t\t\t,[Jornada (Log)]\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Jornada (Log)]), 0)\n\n    \t\t\t,[Teve Evento de MOP?]\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], 1, 0)\n    \t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], 1, 0)\n\n    \t\t\t,[log_dia]\t\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], SUM(SUM(r.[Log])) OVER (PARTITION BY MIN(r.[Data]), MIN(r.[ID Selecionar]), MIN(r.[Tribo Completa])), 0)\n\t\t\t\t,[ponto_dia]\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], SUM(SUM(r.[Trabalhado (Ponto)])) OVER (PARTITION BY MIN(r.[Data]), MIN(r.[ID Selecionar]), MIN(r.[Tribo Completa])), 0)\n\n    \t\tFROM [#chaves] c\n    \t\tLEFT JOIN r_individuo_30min r\n    \t\tON r.[DataHora] = c.[DataHora]\n    \t\tAND COALESCE(r.[ID Selecionar], '-') = COALESCE(c.[ID Selecionar], '-')\n    \t\t--WHERE  (r.[DataHora] <= @datahora_fim AND r.[DataHora] >= @datahora_inicio)                   --<---- Por algum motivo, botar esse filtro acaba removendo os dias \"sem evento\", efetivamente ignorando aus\u00eancias de pessoas ativas no MOP.\n    \t\tGROUP BY c.[DataHora], c.[ID Selecionar], COALESCE(r.[Tribo Completa], c.[Tribo Completa]), c.[Tribo Completa]\n    \t) AS fonte\n    \tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT (\n    \t\t\t [DataHora]\n    \t\t\t,[Intervalo]\n    \t\t\t,[Data]\n    \t\t\t,[Ciclo (Primeiro Dia)]\n    \t\t\t,[M\u00eas (Primeiro Dia)]\n\n                ,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,[ID Selecionar]\n    \t\t\t,[Nome]\n    \t\t\t,[Status]\n    \t\t\t,[Situa\u00e7\u00e3o]\n    \t\t\t,[Condi\u00e7\u00e3o]\n    \t\t\t,[DMA Inicial]\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,[\u00daltima DMA Geral]\n    \t\t\t,[Tipo da \u00daltima DMA]\n    \t\t\t,[Instrutor Inicial]\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,[Instrutor \u00daltima DMA]\n    \t\t\t,[Cliente]\n    \t\t\t,[Projeto]\n    \t\t\t,[Cargo]\n    \t\t\t,[Tribo]\n    \t\t\t,[Tribo Completa]\n    \t\t\t,[Supervis\u00e3o]\n\t\t\t\t,[Email Supervis\u00e3o]\n\t\t\t\t,[Tempo de Casa (Dias)]\n\t\t\t\t,[Faixa Tempo de Casa]\n\t\t\t\t,[Idade]\n\t\t\t\t,[Faixa de Idade]\n    \t\t\t,[Turno]\n    \t\t\t,[Escala (Ponto)]\n    \t\t\t,[Jornada (Ponto)]\n    \t\t\t,[Tipo de Jornada (Ponto)]\n    \t\t\t,[Escala (MOP)]\n    \t\t\t,[Jornada (Log)]\n    \t\t\t,[Tipo de Jornada]\n    \t\t\t,[Teve Evento de MOP?]\n    \t\t\t,[\u00c9 A Tribo do MOP?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n    \t\t\t fonte.[DataHora]\n    \t\t\t,fonte.[Intervalo]\n    \t\t\t,fonte.[Data]\n    \t\t\t,fonte.[Ciclo (Primeiro Dia)]\n    \t\t\t,fonte.[M\u00eas (Primeiro Dia)]\n\n                ,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n    \t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,fonte.[ID Selecionar]\n    \t\t\t,fonte.[Nome]\n    \t\t\t,fonte.[Status]\n    \t\t\t,fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,fonte.[Condi\u00e7\u00e3o]\n    \t\t\t,fonte.[DMA Inicial]\n    \t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[\u00daltima DMA Geral]\n    \t\t\t,fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,fonte.[Instrutor Inicial]\n    \t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[Instrutor \u00daltima DMA]\n    \t\t\t,fonte.[Cliente]\n    \t\t\t,fonte.[Projeto]\n    \t\t\t,fonte.[Cargo]\n    \t\t\t,fonte.[Tribo]\n    \t\t\t,fonte.[Tribo Completa]\n    \t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t\t,fonte.[Email Supervis\u00e3o]\n\t\t\t\t,fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,fonte.[Faixa Tempo de Casa]\n\t\t\t\t,fonte.[Idade]\n\t\t\t\t,fonte.[Faixa de Idade]\n    \t\t\t,fonte.[Turno]\n\n    \t\t\t,fonte.[Escala (Ponto)]\n    \t\t\t,fonte.[Jornada (Ponto)]\n    \t\t\t,CASE\n    \t\t\t\tWHEN fonte.[Secullum - Folga]\t\t= 1 THEN 'FOLGA'\n    \t\t\t\tWHEN fonte.[Secullum - Feriado] >0\t\tTHEN 'FERIADO'\n    \t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\tTHEN 'TREINAMENTO'\n    \t\t\t\tWHEN fonte.[Jornada (Ponto)] = 0\t\tTHEN 'OK'\n    \t\t\t\tWHEN fonte.[Jornada (Ponto)] > 0\t\tTHEN 'FALTA'\n    \t\t\t END\n\n    \t\t\t,fonte.[Escala (MOP)]\n    \t\t\t,fonte.[Jornada (Log)]\n    \t\t\t,CASE\n    \t\t\t\tWHEN fonte.[Secullum - Folga]\t\t= 1 THEN 'FOLGA'\n    \t\t\t\tWHEN fonte.[Secullum - Feriado] >0\t\tTHEN 'FERIADO'\n    \t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\tTHEN 'TREINAMENTO'\n    \t\t\t\tWHEN fonte.[Jornada (Log)] = 0\t\t\tTHEN 'OK'\n    \t\t\t\tWHEN fonte.[Jornada (Log)] > 0\t\t\tTHEN 'FALTA'\n    \t\t\t END\n\n    \t\t\t,fonte.[Teve Evento de MOP?]\n    \t\t\t,fonte.[\u00c9 A Tribo do MOP?]\n    \t\t)\n\n    \tWHEN MATCHED\n    \t\tAND (\n    \t\t\t\tfonte.[Teve Evento de MOP?]\t\t\t= 1\n    \t\t\tOR  fonte.[\u00c9 a Tribo do MOP?]\t\t\t= 1\n    \t\t\tOR\tdestino.[Teve Evento de Tickets?]\t= 1\n    \t\t\tOR\tdestino.[Teve Evento de Chamadas?]\t= 1\n    \t\t\tOR\tdestino.[Teve Evento de NPS?]\t\t= 1\n    \t\t\tOR\tdestino.[Teve Evento de Log?]\t\t= 1\n    \t\t)\n    \t\tTHEN\n    \t\tUPDATE SET\n    \t\t\t destino.[\u00c9 A Tribo do MOP?]\t\t\t\t=\tfonte.[\u00c9 A Tribo do MOP?]\n    \t\t\t,destino.[Teve Evento de MOP?]\t\t\t\t=\tfonte.[Teve Evento de MOP?]\n\n    \t\t\t,destino.[Intervalo]\t\t\t\t\t\t=\tfonte.[Intervalo]\n    \t\t\t,destino.[Data]\t\t\t\t\t\t\t\t=\tfonte.[Data]\n    \t\t\t,destino.[Ciclo (Primeiro Dia)]\t\t\t\t=\tfonte.[Ciclo (Primeiro Dia)]\n    \t\t\t,destino.[M\u00eas (Primeiro Dia)]\t\t\t\t=\tfonte.[M\u00eas (Primeiro Dia)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n    \t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tfonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,destino.[ID Selecionar]\t\t\t\t\t=\tfonte.[ID Selecionar]\n    \t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t=\tfonte.[Nome]\n    \t\t\t,destino.[Status]\t\t\t\t\t\t\t=\tfonte.[Status]\n    \t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tfonte.[Situa\u00e7\u00e3o]\n    \t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tfonte.[Condi\u00e7\u00e3o]\n    \t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t=\tfonte.[DMA Inicial]\n    \t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tfonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t=\tfonte.[\u00daltima DMA Geral]\n    \t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t=\tfonte.[Tipo da \u00daltima DMA]\n    \t\t\t,destino.[Instrutor Inicial]\t\t\t\t=\tfonte.[Instrutor Inicial]\n    \t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tfonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t=\tfonte.[Instrutor \u00daltima DMA]\n    \t\t\t,destino.[Cliente]\t\t\t\t\t\t\t=\tfonte.[Cliente]\n    \t\t\t,destino.[Projeto]\t\t\t\t\t\t\t=\tfonte.[Projeto]\n    \t\t\t,destino.[Tribo]\t\t\t\t\t\t\t=\tfonte.[Tribo]\n    \t\t\t,destino.[Cargo]\t\t\t\t\t\t\t=\tfonte.[Cargo]\n    \t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t=\tfonte.[Supervis\u00e3o]\n\t\t\t\t,destino.[Email Supervis\u00e3o]\t\t\t\t\t=\tfonte.[Email Supervis\u00e3o]\n\t\t\t\t,destino.[Tempo de Casa (Dias)]\t\t\t\t=\tfonte.[Tempo de Casa (Dias)]\n\t\t\t\t,destino.[Faixa Tempo de Casa]\t\t\t\t=\tfonte.[Faixa Tempo de Casa]\n\t\t\t\t,destino.[Idade]\t\t\t\t\t\t\t=\tfonte.[Idade]\n\t\t\t\t,destino.[Faixa de Idade]\t\t\t\t\t=\tfonte.[Faixa de Idade]\n    \t\t\t,destino.[Turno]\t\t\t\t\t\t\t=\tfonte.[Turno]\n    \t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t=\tfonte.[Escala (Ponto)]\n    \t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t=\tfonte.[Jornada (Ponto)]\n    \t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t=\tfonte.[Escala (MOP)]\n    \t\t\t,destino.[Jornada (Log)]\t\t\t\t\t=\tfonte.[Jornada (Log)]\n    \t\t\t,destino.[Tipo de Jornada (Ponto)]\t\t\t=\tCASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Secullum - Folga] = 1\t\t\t\t\t\tTHEN 'FOLGA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Secullum - Feriado] >0\t\t\t\t\t\tTHEN 'FERIADO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\t\t\t\t\tTHEN 'TREINAMENTO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Ponto)] = [ponto_dia]\t\t\t\tTHEN 'OK'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [ponto_dia] = 0 AND fonte.[Jornada (ponto)] > 0\tTHEN 'FALTA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Ponto)] > [ponto_dia]\t\t\t\tTHEN 'ABS'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Ponto)] < [ponto_dia]\t\t\t\tTHEN 'HE'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t END\n    \t\t\t,destino.[Tipo de Jornada]\t\t\t\t\t=\tCASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Secullum - Folga] = 1\t\t\t\t\tTHEN 'FOLGA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Secullum - Feriado] >0\t\t\t\t\tTHEN 'FERIADO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\t\t\t\tTHEN 'TREINAMENTO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Log)] = [log_dia]\t\t\t\tTHEN 'OK'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [log_dia] = 0 AND fonte.[Jornada (Log)] > 0\tTHEN 'FALTA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Log)] > [log_dia]\t\t\t\tTHEN 'ABS'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Log)] < [log_dia]\t\t\t\tTHEN 'HE'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t END\n\n    \tWHEN MATCHED AND\t(\n                fonte.[\u00c9 A Tribo do MOP?]\t\t    = 0\n    \t    AND\tfonte.[Teve Evento de MOP?]\t        = 0\n    \t\tAND\tdestino.[Teve Evento de Tickets?]\t= 0\n    \t\tAND\tdestino.[Teve Evento de Chamadas?]\t= 0\n    \t\tAND\tdestino.[Teve Evento de NPS?]\t\t= 0\n    \t\tAND\tdestino.[Teve Evento de Log?]\t\t= 0\n    \t\t)\n    \tTHEN DELETE\n\n    \tWHEN NOT MATCHED BY SOURCE AND\t(\n    \t\t    destino.[Teve Evento de Tickets?]\t= 0\n    \t\tAND\tdestino.[Teve Evento de Chamadas?]\t= 0\n    \t\tAND\tdestino.[Teve Evento de NPS?]\t\t= 0\n    \t\tAND\tdestino.[Teve Evento de Log?]\t\t= 0\n    \t\t)\n    \tTHEN DELETE;\n\n        DELETE FROM r_individuo_30min\n        WHERE   [\u00c9 A Tribo do MOP?]\t\t    = 0\n    \t    AND\t[Teve Evento de MOP?]\t    = 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_cleanup;\n        END\n    IF 1=1 BEGIN; PRINT '--- agrupamento individuo dia';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_dia]\n    \t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n    \t\tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT\n    \t\t\t [Data]\t\t\t\t\t\t\t\t=\t[Data]\n    \t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t=\tMIN([Ciclo (Primeiro Dia)])\n    \t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t=\tMIN([M\u00eas (Primeiro Dia)])\n\n\n                ,[Feriado (Nome)]                                     =  MAX([Feriado (Nome)])\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   MAX([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              )\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   MAX([Secullum - Suspens\u00e3o por advert\u00eancia]                         )\n       \t        ,[Secullum - Servi\u00e7o Militar]                                       =   MAX([Secullum - Servi\u00e7o Militar]                                   )\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   MAX([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  )\n       \t        ,[Secullum - Licen\u00e7a Paternidade]                                   =   MAX([Secullum - Licen\u00e7a Paternidade]                               )\n       \t        ,[Secullum - Licen\u00e7a Maternidade]                                   =   MAX([Secullum - Licen\u00e7a Maternidade]                               )\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   MAX([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     )\n       \t        ,[Secullum - Licen\u00e7a Casamento]                                     =   MAX([Secullum - Licen\u00e7a Casamento]                                 )\n                ,[Secullum - INSS - Afastamento]                                    =   MAX([Secullum - INSS - Afastamento]                                )\n                ,[Secullum - Folga]                                                 =   MAX([Secullum - Folga]                                             )\n                ,[Secullum - F\u00e9rias]                                                =   MAX([Secullum - F\u00e9rias]                                            )\n       \t        ,[Secullum - Feriado]                                               =   MAX([Secullum - Feriado]                                           )\n       \t        ,[Secullum - Falta Justificada]                                     =   MAX([Secullum - Falta Justificada]                                 )\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   MAX([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)])\n                ,[Secullum - Falta Injustificada]                                   =   MAX([Secullum - Falta Injustificada]                               )\n       \t        ,[Secullum - Prova de Vestibular / ENEM]                            =   MAX([Secullum - Prova de Vestibular / ENEM]                        )\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   MAX([Secullum - Doa\u00e7\u00e3o de Sangue]                                  )\n                ,[Secullum - Desligue]                                              =   MAX([Secullum - Desligue]                                          )\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   MAX([Secullum - Convoca\u00e7\u00e3o Judicial]                               )\n       \t        ,[Secullum - Compensando Horas]                                     =   MAX([Secullum - Compensando Horas]                                 )\n       \t        ,[Secullum - Atestado]                                              =   MAX([Secullum - Atestado]                                          )\n                ,[Secullum - Abono]                                                 =   MAX([Secullum - Abono]                                             )\n       \t        ,[Secullum - Abono Lactante]                                        =   MAX([Secullum - Abono Lactante]                                    )\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   MAX([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     )\n       \t        ,[Faltas Justificadas]                                              =   MAX([Faltas Justificadas]                                          )\n       \t        ,[Faltas Injustificadas]                                            =   MAX([Faltas Injustificadas]                                        )\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tMIN([DataHora da Atualiza\u00e7\u00e3o do MOP])\n    \t\t\t,[ID Selecionar]\t\t\t\t\t=\t[ID Selecionar]\n    \t\t\t,[Nome]\t\t\t\t\t\t\t\t=\tMIN([Nome])\n    \t\t\t,[Status]\t\t\t\t\t\t\t=\tMIN([Status])\n    \t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([Situa\u00e7\u00e3o])\n    \t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([Condi\u00e7\u00e3o])\n\n    \t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tMIN([DMA Inicial])\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tMIN([\u00daltima DMA Migra\u00e7\u00e3o])\n    \t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tMIN([\u00daltima DMA Geral])\n    \t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tMIN([Tipo da \u00daltima DMA])\n    \t\t\t,[Instrutor Inicial]\t\t\t\t=\tMIN([Instrutor Inicial])\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tMIN([Instrutor \u00daltima Migra\u00e7\u00e3o])\n    \t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tMIN([Instrutor \u00daltima DMA])\n\n    \t\t\t,[Cliente]\t\t\t\t\t\t\t=\tMIN([Cliente])\n    \t\t\t,[Projeto]\t\t\t\t\t\t\t=\tMIN([Projeto])\n    \t\t\t,[Cargo]\t\t\t\t\t\t\t=\tMIN([Cargo])\n    \t\t\t,[Tribo]\t\t\t\t\t\t\t=\tMIN([Tribo])\n    \t\t\t,[Tribo Completa]\t\t\t\t\t=\t[Tribo Completa]\n    \t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tMIN([Supervis\u00e3o])\n    \t\t\t,[Email Supervis\u00e3o]\t\t\t\t\t=\tMIN([Email Supervis\u00e3o])\n\t\t\t\t,[Tempo de Casa (Dias)]\t\t\t\t=\tMIN([Tempo de Casa (Dias)])\n\t\t\t\t,[Faixa Tempo de Casa]\t\t\t\t=\tMIN([Faixa Tempo de Casa])\n\t\t\t\t,[Idade]\t\t\t\t\t\t\t=\tMIN([Idade])\n\t\t\t\t,[Faixa de Idade]\t\t\t\t\t=\tMIN([Faixa de Idade])\n    \t\t\t,[Turno]\t\t\t\t\t\t\t=\tMIN([Turno])\n    \t\t\t,[Escala (Ponto)]\t\t\t\t\t=\tMIN([Escala (Ponto)])\n    \t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tMIN([Jornada (Ponto)])\n    \t\t\t,[Tipo de Jornada (Ponto)]\t\t\t=\t CASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN(CAST([Secullum - Folga] AS INT))\t= 1\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FOLGA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Secullum - Feriado]) >0\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FERIADO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Status]) = 'Treinamento'\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'TREINAMENTO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Ponto)]), 0) = SUM([Trabalhado (Ponto)])\t\t\tTHEN 'OK'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Trabalhado (Ponto)]) = 0 AND IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Ponto)]), 0) > 0\tTHEN 'FALTA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Ponto)]), 0) > SUM([Trabalhado (Ponto)])\t\t\tTHEN 'ABS'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Ponto)]), 0) < SUM([Trabalhado (Ponto)])\t\t\tTHEN 'HE'\n    \t\t\t\t\t\t\t\t\t\t\t\t\tEND\n    \t\t\t,[Login (Ponto)]\t\t\t\t\t=\tMIN([Login (Ponto)])\n    \t\t\t,[Logout (Ponto)]\t\t\t\t\t=\tMAX([Logout (Ponto)])\n    \t\t\t,[Trabalhado (Ponto)]\t\t\t\t=\tSUM([Trabalhado (Ponto)])\n    \t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=\tSUM([Em Pausa (Ponto)])\n\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t=\tSUM([Desvio Ponto-Log])\n    \t\t\t,[Escala (MOP)]\t\t\t\t\t\t=\tMIN([Escala (MOP)])\n    \t\t\t,[Jornada (Log)]\t\t\t\t\t=\tMIN([Jornada (Log)])\n    \t\t\t,[Tipo de Jornada]\t\t\t\t\t=\t CASE\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN(CAST([Secullum - Folga] AS INT))\t= 1\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FOLGA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Secullum - Feriado]) >0\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FERIADO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Status]) = 'Treinamento'\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'TREINAMENTO'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) = SUM([Log])\t\t\t\tTHEN 'OK'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Log]) = 0 AND IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) > 0\tTHEN 'FALTA'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) > SUM([Log])\t\t\t\tTHEN 'ABS'\n    \t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) < SUM([Log])\t\t\t\tTHEN 'HE'\n    \t\t\t\t\t\t\t\t\t\t\t\t\tEND\n    \t\t\t,[Login]\t\t\t\t\t\t\t=\tMIN([Login])\n    \t\t\t,[Logout]\t\t\t\t\t\t\t=\tMAX([Logout])\n    \t\t\t,[Log descartado (>2HE)]\t\t\t=\tSUM([Log descartado (>2HE)])\n    \t\t\t,[Log HE]\t\t\t\t\t\t\t\t=\tSUM([Log HE])\n    \t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM([Log])\n    \t\t\t,[Log Produtivo]\t\t\t\t\t=\tSUM([Log Produtivo])\n    \t\t \t,[Log Improdutivo]\t\t\t\t\t=\tSUM([Log Improdutivo])\n    \t\t \t,[Tempo Livre]\t\t\t\t\t\t=\tSUM([Tempo Livre])\n    \t\t \t,[Pausa Particular (Intelix)]\t\t=\tSUM([Pausa Particular (Intelix)])\n    \t\t \t,[Pausa Break (Intelix)]\t\t\t=\tSUM([Pausa Break (Intelix)])\n    \t\t \t,[Pausa 10 (Intelix)]\t\t\t\t=\tSUM([Pausa 10 (Intelix)])\n    \t\t \t,[Pausa Outbound (Intelix)]\t\t\t=\tSUM([Pausa Outbound (Intelix)])\n    \t\t  \t,[Pausa Lanche (Intelix)]\t\t\t=\tSUM([Pausa Lanche (Intelix)])\n    \t\t  \t,[Pausa R\u00e1pida (Intelix)]\t\t\t=\tSUM([Pausa R\u00e1pida (Intelix)])\n    \t\t  \t,[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Intelix)])\n    \t\t  \t,[Pausa Feedback (Intelix)]\t\t\t=\tSUM([Pausa Feedback (Intelix)])\n    \t\t  \t,[Pausa Sistema Interno (Intelix)]\t=\tSUM([Pausa Sistema Interno (Intelix)])\n    \t\t  \t,[Pausa Sistema Externo (Intelix)]\t=\tSUM([Pausa Sistema Externo (Intelix)])\n    \t\t  \t,[Pausa Treinamento (Intelix)]\t\t=\tSUM([Pausa Treinamento (Intelix)])\n    \t\t  \t,[Pausa Banheiro (Intelix)]\t\t\t=\tSUM([Pausa Banheiro (Intelix)])\n    \t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tSUM([Pausa Reuni\u00e3o (Intelix)])\n    \t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Intelix)])\n    \t\t  \t,[Pausa NR17 (Intelix)]\t\t\t\t=\tSUM([Pausa NR17 (Intelix)])\n    \t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Liga\u00e7\u00e3o (EPBX)])\n    \t\t  \t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tSUM([Pausa Almo\u00e7o (EPBX)])\n    \t\t  \t,[Pausa Tratativa (EPBX)]\t\t\t=\tSUM([Pausa Tratativa (EPBX)])\n    \t\t  \t,[Pausa Discagem Manual (EPBX)]\t\t=\tSUM([Pausa Discagem Manual (EPBX)])\n    \t\t  \t,[Pausa Banheiro (EPBX)]\t\t\t=\tSUM([Pausa Banheiro (EPBX)])\n    \t\t  \t,[Pausa WhatsApp (EPBX)]\t\t\t=\tSUM([Pausa WhatsApp (EPBX)])\n    \t\t  \t,[Pausa Intervalo (EPBX)]\t\t\t=\tSUM([Pausa Intervalo (EPBX)])\n    \t\t  \t,[Pausa Discagem Retorno (EPBX)]\t=\tSUM([Pausa Discagem Retorno (EPBX)])\n    \t\t  \t,[Pausa Treinamento (EPBX)]\t\t\t=\tSUM([Pausa Treinamento (EPBX)])\n    \t\t  \t,[Pausa Feedback (EPBX)]\t\t\t=\tSUM([Pausa Feedback (EPBX)])\n    \t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\t\t=\tSUM([Pausa Transfer\u00eancia (EPBX)])\n    \t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tSUM([Pausa N\u00e3o Disponivel (EPBX)])\n    \t\t  \t,[Pausa Login (EPBX)]\t\t\t\t=\tSUM([Pausa Login (EPBX)])\n    \t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Reuni\u00e3o (EPBX)])\n    \t\t  \t,[Pausa Sistema Interno (EPBX)]\t\t=\tSUM([Pausa Sistema Interno (EPBX)])\n    \t\t  \t,[Pausa Sistema Externo (EPBX)]\t\t=\tSUM([Pausa Sistema Externo (EPBX)])\n    \t\t  \t,[Pausa NR17 (EPBX)]\t\t\t\t=\tSUM([Pausa NR17 (EPBX)])\n    \t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tSUM([Pausa Ambulat\u00f3rio (EPBX)])\n    \t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tSUM([Pausa P\u00f3s Atendimento (EPBX)])\n    \t\t  \t,[Pausa Lanche (EPBX)]\t\t\t\t=\tSUM([Pausa Lanche (EPBX)])\n    \t\t  \t,[Pausa BackOffice (EPBX)]\t\t\t=\tSUM([Pausa BackOffice (EPBX)])\n    \t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Genesys)])\n    \t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Genesys)])\n    \t\t \t,[Pausa Banheiro (Genesys)]\t\t\t=\tSUM([Pausa Banheiro (Genesys)])\n    \t\t \t,[Pausa Descanso (Genesys)]\t\t\t=\tSUM([Pausa Descanso (Genesys)])\n    \t\t \t,[Pausa Feedback (Genesys)]\t\t\t=\tSUM([Pausa Feedback (Genesys)])\n    \t\t \t,[Pausa Backoffice (Genesys)]\t\t=\tSUM([Pausa Backoffice (Genesys)])\n    \t\t \t,[Pausa Discagem Manual (Genesys)]\t=\tSUM([Pausa Discagem Manual (Genesys)])\n    \t\t \t,[Pausa Discagem Retorno (Genesys)]\t=\tSUM([Pausa Discagem Retorno (Genesys)])\n    \t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tSUM([Pausa Dispon\u00edvel (Genesys)])\n    \t\t \t,[Pausa Em Fila (Genesys)]\t\t\t=\tSUM([Pausa Em Fila (Genesys)])\n    \t\t \t,[Pausa Sistema Externo (Genesys)]\t=\tSUM([Pausa Sistema Externo (Genesys)])\n    \t\t \t,[Pausa Sistema Interno (Genesys)]\t=\tSUM([Pausa Sistema Interno (Genesys)])\n    \t\t \t,[Pausa Tratativa (Genesys)]\t\t=\tSUM([Pausa Tratativa (Genesys)])\n    \t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t=\tSUM([Pausa Whatsapp (Genesys)])\n    \t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tSUM([Pausa Treinamento (Genesys)])\n\n    \t\t\t,[Criados]\t\t\t\t\t\t\t=\tSUM([Criados])\n    \t\t\t,[Tratados]\t\t\t\t\t\t\t=\tSUM([Tratados])\n    \t\t\t,[Tempo Total de Tratativa]\t\t\t=\tSUM([Tempo Total de Tratativa])\n    \t\t\t,[TMT]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n    \t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t=\tSUM([N\u00e3o Resolvidos])\n    \t\t\t,[Replicas]\t\t\t\t\t\t\t=\tSUM([Replicas])\n    \t\t\t,[Reincidentes 48h]\t\t\t\t\t=\tSUM([Reincidentes 48h])\n    \t\t\t,[Reincidentes 30d]\t\t\t\t\t=\tSUM([Reincidentes 30d])\n\n    \t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Iniciadas])\n    \t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas])\n    \t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Em Andamento])\n    \t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Finalizadas])\n    \t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Transferidas])\n    \t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Espera (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Chamada (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM([Inbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Espera (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Inbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Iniciados])\n    \t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Em Andamento])\n    \t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Finalizados])\n    \t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Abandonadas])\n    \t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\n    \t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Iniciadas])\n    \t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas])\n    \t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Em Andamento])\n    \t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Finalizadas])\n    \t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Transferidas])\n    \t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Espera (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM([Outbound - Tempo Em Chamada (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Outbound - Tempo Em Espera (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Iniciados])\n    \t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Em Andamento])\n    \t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Finalizados])\n    \t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Abandonadas])\n    \t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\n    \t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t=\tSUM([Avalia\u00e7\u00f5es de NPS])\n    \t\t\t,[Promotoras]\t\t\t\t\t\t=\tSUM([Promotoras])\n    \t\t\t,[Neutras]\t\t\t\t\t\t\t= \tSUM([Neutras])\n    \t\t\t,[Detratoras]\t\t\t\t\t\t= \tSUM([Detratoras])\n    \t\t\t,[NPS]\t\t\t\t\t\t\t\t=\tCAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n    \t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t= \tIIF(SUM([\u00c9 A Tribo do MOP?])=0,0,1)\n    \t\t\t,[Teve Evento de MOP?]\t\t\t\t= \tIIF(SUM([Teve Evento de MOP?])=0,0,1)\n    \t\t\t,[Teve Evento de Tickets?]\t\t\t= \tIIF(SUM([Teve Evento de Tickets?])=0,0,1)\n    \t\t\t,[Teve Evento de Chamadas?]\t\t\t= \tIIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n    \t\t\t,[Teve Evento de NPS?]\t\t\t\t= \tIIF(SUM([Teve Evento de NPS?])=0,0,1)\n    \t\t\t,[Teve Evento de Log?]\t\t\t\t= \tIIF(SUM([Teve Evento de Log?])=0,0,1)\n\n    \t\tFROM r_individuo_30min\n    \t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n    \t\tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n    \t\tGROUP BY [Data], [ID Selecionar], [Tribo Completa]\n    \t) AS fonte\n    \tON  fonte.[Data]  = destino.[Data]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t= COALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n    \t\t\t [Data]\n    \t\t\t,[Ciclo (Primeiro Dia)]\n    \t\t\t,[M\u00eas (Primeiro Dia)]\n\n                ,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,[ID Selecionar]\n    \t\t\t,[Nome]\n    \t\t\t,[Status]\n    \t\t\t,[Situa\u00e7\u00e3o]\n    \t\t\t,[Condi\u00e7\u00e3o]\n\n    \t\t\t,[DMA Inicial]\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,[\u00daltima DMA Geral]\n    \t\t\t,[Tipo da \u00daltima DMA]\n    \t\t\t,[Instrutor Inicial]\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,[Instrutor \u00daltima DMA]\n\n    \t\t\t,[Cliente]\n    \t\t\t,[Projeto]\n    \t\t\t,[Cargo]\n    \t\t\t,[Tribo]\n    \t\t\t,[Tribo Completa]\n    \t\t\t,[Supervis\u00e3o]\n\t\t\t\t,[Email Supervis\u00e3o]\n\t\t\t\t,[Tempo de Casa (Dias)]\n\t\t\t\t,[Faixa Tempo de Casa]\n\t\t\t\t,[Idade]\n\t\t\t\t,[Faixa de Idade]\n    \t\t\t,[Turno]\n    \t\t\t,[Escala (Ponto)]\n    \t\t\t,[Jornada (Ponto)]\n\t\t\t\t,[Tipo de Jornada (Ponto)]\n\t\t\t\t,[Login (Ponto)]\n\t\t\t\t,[Logout (Ponto)]\n    \t\t\t,[Trabalhado (Ponto)]\n    \t\t\t,[Em Pausa (Ponto)]\n\t\t\t\t,[Desvio Ponto-Log]\n    \t\t\t,[Escala (MOP)]\n    \t\t\t,[Jornada (Log)]\n    \t\t\t,[Tipo de Jornada]\n    \t\t\t,[Login]\n    \t\t\t,[Logout]\n    \t\t\t,[Log descartado (>2HE)]\n    \t\t\t,[Log HE]\n    \t\t\t,[Log]\n    \t\t\t,[Log Produtivo]\n    \t\t \t,[Log Improdutivo]\n    \t\t \t,[Tempo Livre]\n    \t\t \t,[Pausa Particular (Intelix)]\n    \t\t \t,[Pausa Break (Intelix)]\n    \t\t \t,[Pausa 10 (Intelix)]\n    \t\t \t,[Pausa Outbound (Intelix)]\n    \t\t  \t,[Pausa Lanche (Intelix)]\n    \t\t  \t,[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,[Pausa Feedback (Intelix)]\n    \t\t  \t,[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,[Pausa Treinamento (Intelix)]\n    \t\t  \t,[Pausa Banheiro (Intelix)]\n    \t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,[Pausa NR17 (Intelix)]\n    \t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,[Pausa Tratativa (EPBX)]\n    \t\t  \t,[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,[Pausa Banheiro (EPBX)]\n    \t\t  \t,[Pausa WhatsApp (EPBX)]\n    \t\t  \t,[Pausa Intervalo (EPBX)]\n    \t\t  \t,[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,[Pausa Treinamento (EPBX)]\n    \t\t  \t,[Pausa Feedback (EPBX)]\n    \t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,[Pausa Login (EPBX)]\n    \t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,[Pausa NR17 (EPBX)]\n    \t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,[Pausa Lanche (EPBX)]\n    \t\t  \t,[Pausa BackOffice (EPBX)]\n    \t\t\t,[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t \t,[Pausa Banheiro (Genesys)]\n    \t\t \t,[Pausa Descanso (Genesys)]\n    \t\t \t,[Pausa Feedback (Genesys)]\n    \t\t \t,[Pausa Backoffice (Genesys)]\n    \t\t \t,[Pausa Discagem Manual (Genesys)]\n    \t\t \t,[Pausa Discagem Retorno (Genesys)]\n    \t\t \t,[Pausa Dispon\u00edvel (Genesys)]\n    \t\t \t,[Pausa Em Fila (Genesys)]\n    \t\t \t,[Pausa Sistema Externo (Genesys)]\n    \t\t \t,[Pausa Sistema Interno (Genesys)]\n    \t\t \t,[Pausa Tratativa (Genesys)]\n    \t\t \t,[Pausa Whatsapp (Genesys)]\n    \t\t\t,[Pausa Treinamento (Genesys)]\n\n    \t\t\t,[Criados]\n    \t\t\t,[Tratados]\n    \t\t\t,[Tempo Total de Tratativa]\n    \t\t\t,[TMT]\n    \t\t\t,[N\u00e3o Resolvidos]\n    \t\t\t,[Replicas]\n    \t\t\t,[Reincidentes 48h]\n    \t\t\t,[Reincidentes 30d]\n\n    \t\t,[Inbound - Chamadas Iniciadas]\n    \t\t,[Inbound - Chamadas Atendidas]\n    \t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,[Inbound - Chamadas Em Andamento]\n    \t\t,[Inbound - Chamadas Finalizadas]\n    \t\t,[Inbound - Chamadas Transferidas]\n    \t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,[Inbound - Atendimentos Iniciados]\n    \t\t,[Inbound - Atendimentos Em Andamento]\n    \t\t,[Inbound - Atendimentos Finalizados]\n    \t\t,[Inbound - TMC]\n    \t\t,[Inbound - TMA]\n    \t\t,[Inbound - TME]\n    \t\t,[Inbound - TMO]\n    \t\t,[Inbound - % Nivel de Servi\u00e7o]\n    \t\t,[Inbound - Chamadas Abandonadas]\n    \t\t,[Inbound - % Abandono]\n\n    \t\t,[Outbound - Chamadas Iniciadas]\n    \t\t,[Outbound - Chamadas Atendidas]\n    \t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t,[Outbound - Chamadas Em Andamento]\n    \t\t,[Outbound - Chamadas Finalizadas]\n    \t\t,[Outbound - Chamadas Transferidas]\n    \t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t,[Outbound - Atendimentos Iniciados]\n    \t\t,[Outbound - Atendimentos Em Andamento]\n    \t\t,[Outbound - Atendimentos Finalizados]\n    \t\t,[Outbound - TMC]\n    \t\t,[Outbound - TMA]\n    \t\t,[Outbound - TME]\n    \t\t,[Outbound - TMO]\n    \t\t,[Outbound - % Nivel de Servi\u00e7o]\n    \t\t,[Outbound - Chamadas Abandonadas]\n    \t\t,[Outbound - % Abandono]\n\n\n    \t\t\t,[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t,[Promotoras]\n    \t\t\t,[Neutras]\n    \t\t\t,[Detratoras]\n    \t\t\t,[NPS]\n\n    \t\t\t,[\u00c9 A Tribo do MOP?]\n    \t\t\t,[Teve Evento de MOP?]\n    \t\t\t,[Teve Evento de Tickets?]\n    \t\t\t,[Teve Evento de Chamadas?]\n    \t\t\t,[Teve Evento de NPS?]\n    \t\t\t,[Teve Evento de Log?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n    \t\t     fonte.[Data]\n    \t\t\t,fonte.[Ciclo (Primeiro Dia)]\n    \t\t\t,fonte.[M\u00eas (Primeiro Dia)]\n\n                ,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n    \t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,fonte.[ID Selecionar]\n    \t\t\t,fonte.[Nome]\n    \t\t\t,fonte.[Status]\n    \t\t\t,fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,fonte.[Condi\u00e7\u00e3o]\n\n    \t\t\t,fonte.[DMA Inicial]\n    \t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[\u00daltima DMA Geral]\n    \t\t\t,fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,fonte.[Instrutor Inicial]\n    \t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[Instrutor \u00daltima DMA]\n\n    \t\t\t,fonte.[Cliente]\n    \t\t\t,fonte.[Projeto]\n    \t\t\t,fonte.[Cargo]\n    \t\t\t,fonte.[Tribo]\n    \t\t\t,fonte.[Tribo Completa]\n    \t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t\t,fonte.[Email Supervis\u00e3o]\n\t\t\t\t,fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,fonte.[Faixa Tempo de Casa]\n\t\t\t\t,fonte.[Idade]\n\t\t\t\t,fonte.[Faixa de Idade]\n    \t\t\t,fonte.[Turno]\n    \t\t\t,fonte.[Escala (Ponto)]\n    \t\t\t,fonte.[Jornada (Ponto)]\n\t\t\t\t,fonte.[Tipo de Jornada (Ponto)]\n\t\t\t\t,fonte.[Login (Ponto)]\n\t\t\t\t,fonte.[Logout (Ponto)]\n    \t\t\t,fonte.[Trabalhado (Ponto)]\n    \t\t\t,fonte.[Em Pausa (Ponto)]\n\t\t\t\t,fonte.[Desvio Ponto-Log]\n    \t\t\t,fonte.[Escala (MOP)]\n    \t\t\t,fonte.[Jornada (Log)]\n    \t\t\t,fonte.[Tipo de Jornada]\n    \t\t\t,fonte.[Login]\n    \t\t\t,fonte.[Logout]\n    \t\t\t,fonte.[Log descartado (>2HE)]\n    \t\t\t,fonte.[Log HE]\n    \t\t\t,fonte.[Log]\n    \t\t\t,fonte.[Log Produtivo]\n    \t\t \t,fonte.[Log Improdutivo]\n    \t\t \t,fonte.[Tempo Livre]\n    \t\t \t,fonte.[Pausa Particular (Intelix)]\n    \t\t \t,fonte.[Pausa Break (Intelix)]\n    \t\t \t,fonte.[Pausa 10 (Intelix)]\n    \t\t \t,fonte.[Pausa Outbound (Intelix)]\n    \t\t  \t,fonte.[Pausa Lanche (Intelix)]\n    \t\t  \t,fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,fonte.[Pausa Feedback (Intelix)]\n    \t\t  \t,fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,fonte.[Pausa Treinamento (Intelix)]\n    \t\t  \t,fonte.[Pausa Banheiro (Intelix)]\n    \t\t  \t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,fonte.[Pausa NR17 (Intelix)]\n    \t\t  \t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,fonte.[Pausa Tratativa (EPBX)]\n    \t\t  \t,fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,fonte.[Pausa Banheiro (EPBX)]\n    \t\t  \t,fonte.[Pausa WhatsApp (EPBX)]\n    \t\t  \t,fonte.[Pausa Intervalo (EPBX)]\n    \t\t  \t,fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,fonte.[Pausa Treinamento (EPBX)]\n    \t\t  \t,fonte.[Pausa Feedback (EPBX)]\n    \t\t  \t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,fonte.[Pausa Login (EPBX)]\n    \t\t  \t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,fonte.[Pausa NR17 (EPBX)]\n    \t\t  \t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,fonte.[Pausa Lanche (EPBX)]\n    \t\t  \t,fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t \t,fonte.[Pausa Banheiro (Genesys)]\n    \t\t \t,fonte.[Pausa Descanso (Genesys)]\n    \t\t \t,fonte.[Pausa Feedback (Genesys)]\n    \t\t \t,fonte.[Pausa Backoffice (Genesys)]\n    \t\t \t,fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t \t,fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t \t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t \t,fonte.[Pausa Em Fila (Genesys)]\n    \t\t \t,fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t \t,fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t \t,fonte.[Pausa Tratativa (Genesys)]\n    \t\t \t,fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t,fonte.[Pausa Treinamento (Genesys)]\n\n    \t\t\t,fonte.[Criados]\n    \t\t\t,fonte.[Tratados]\n    \t\t\t,fonte.[Tempo Total de Tratativa]\n    \t\t\t,fonte.[TMT]\n    \t\t\t,fonte.[N\u00e3o Resolvidos]\n    \t\t\t,fonte.[Replicas]\n    \t\t\t,fonte.[Reincidentes 48h]\n    \t\t\t,fonte.[Reincidentes 30d]\n\n    \t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n    \t\t    ,fonte.[Inbound - Chamadas Atendidas]\n    \t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n    \t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n    \t\t    ,fonte.[Inbound - Chamadas Transferidas]\n    \t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n    \t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n    \t\t    ,fonte.[Inbound - TMC]\n    \t\t    ,fonte.[Inbound - TMA]\n    \t\t    ,fonte.[Inbound - TME]\n    \t\t    ,fonte.[Inbound - TMO]\n    \t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n    \t\t    ,fonte.[Inbound - % Abandono]\n\n    \t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n    \t\t    ,fonte.[Outbound - Chamadas Atendidas]\n    \t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n    \t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n    \t\t    ,fonte.[Outbound - Chamadas Transferidas]\n    \t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n    \t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n    \t\t    ,fonte.[Outbound - TMC]\n    \t\t    ,fonte.[Outbound - TMA]\n    \t\t    ,fonte.[Outbound - TME]\n    \t\t    ,fonte.[Outbound - TMO]\n    \t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n    \t\t    ,fonte.[Outbound - % Abandono]\n\n    \t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t    ,fonte.[Promotoras]\n    \t\t    ,fonte.[Neutras]\n    \t\t    ,fonte.[Detratoras]\n    \t\t    ,fonte.[NPS]\n\n    \t\t    ,fonte.[\u00c9 A Tribo do MOP?]\n    \t\t    ,fonte.[Teve Evento de MOP?]\n    \t\t    ,fonte.[Teve Evento de Tickets?]\n    \t\t    ,fonte.[Teve Evento de Chamadas?]\n    \t\t    ,fonte.[Teve Evento de NPS?]\n    \t\t    ,fonte.[Teve Evento de Log?]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[Data]\t\t\t\t\t\t\t\t= fonte.[Data]\n    \t\t\t,destino.[Ciclo (Primeiro Dia)]\t\t\t\t= fonte.[Ciclo (Primeiro Dia)]\n    \t\t\t,destino.[M\u00eas (Primeiro Dia)]\t\t\t\t= fonte.[M\u00eas (Primeiro Dia)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n    \t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t= fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,destino.[ID Selecionar]\t\t\t\t\t= fonte.[ID Selecionar]\n    \t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t= fonte.[Nome]\n    \t\t\t,destino.[Status]\t\t\t\t\t\t\t= fonte.[Status]\n    \t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Condi\u00e7\u00e3o]\n\n    \t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t= fonte.[DMA Inicial]\n    \t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t= fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t= fonte.[\u00daltima DMA Geral]\n    \t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t= fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,destino.[Instrutor Inicial]\t\t\t\t= fonte.[Instrutor Inicial]\n    \t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t= fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t= fonte.[Instrutor \u00daltima DMA]\n\n    \t\t\t,destino.[Cliente]\t\t\t\t\t\t\t= fonte.[Cliente]\n    \t\t\t,destino.[Projeto]\t\t\t\t\t\t\t= fonte.[Projeto]\n    \t\t\t,destino.[Cargo]\t\t\t\t\t\t\t= fonte.[Cargo]\n    \t\t\t,destino.[Tribo]\t\t\t\t\t\t\t= fonte.[Tribo]\n    \t\t\t,destino.[Tribo Completa]\t\t\t\t\t= fonte.[Tribo Completa]\n    \t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t= fonte.[Supervis\u00e3o]\n\t\t\t\t,destino.[Email Supervis\u00e3o]\t\t\t\t\t= fonte.[Email Supervis\u00e3o]\n\t\t\t\t,destino.[Tempo de Casa (Dias)]\t\t\t\t= fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,destino.[Faixa Tempo de Casa]\t\t\t\t= fonte.[Faixa Tempo de Casa]\n\t\t\t\t,destino.[Idade]\t\t\t\t\t\t\t= fonte.[Idade]\n\t\t\t\t,destino.[Faixa de Idade]\t\t\t\t\t= fonte.[Faixa de Idade]\n    \t\t\t,destino.[Turno]\t\t\t\t\t\t\t= fonte.[Turno]\n    \t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t= fonte.[Escala (Ponto)]\n    \t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t= fonte.[Jornada (Ponto)]\n\t\t\t\t,destino.[Tipo de Jornada (Ponto)]\t\t\t= fonte.[Tipo de Jornada (Ponto)]\n\t\t\t\t,destino.[Login (Ponto)]\t\t\t\t\t= fonte.[Login (Ponto)]\n\t\t\t\t,destino.[Logout (Ponto)]\t\t\t\t\t= fonte.[Logout (Ponto)]\n    \t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t= fonte.[Trabalhado (Ponto)]\n    \t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t= fonte.[Em Pausa (Ponto)]\n\t\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t= fonte.[Desvio Ponto-Log]\n    \t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t= fonte.[Escala (MOP)]\n    \t\t\t,destino.[Jornada (Log)]\t\t\t\t\t= fonte.[Jornada (Log)]\n    \t\t\t,destino.[Tipo de Jornada]\t\t\t\t\t= fonte.[Tipo de Jornada]\n    \t\t\t,destino.[Login]\t\t\t\t\t\t\t= fonte.[Login]\n    \t\t\t,destino.[Logout]\t\t\t\t\t\t\t= fonte.[Logout]\n    \t\t\t,destino.[Log descartado (>2HE)]\t\t\t= fonte.[Log descartado (>2HE)]\n    \t\t\t,destino.[Log HE]\t\t\t\t\t\t\t\t= fonte.[Log HE]\n    \t\t\t,destino.[Log]\t\t\t\t\t\t\t\t= fonte.[Log]\n    \t\t\t,destino.[Log Produtivo]\t\t\t\t\t= fonte.[Log Produtivo]\n    \t\t \t,destino.[Log Improdutivo]\t\t\t\t\t= fonte.[Log Improdutivo]\n    \t\t \t,destino.[Tempo Livre]\t\t\t\t\t\t= fonte.[Tempo Livre]\n    \t\t \t,destino.[Pausa Particular (Intelix)]\t\t= fonte.[Pausa Particular (Intelix)]\n    \t\t \t,destino.[Pausa Break (Intelix)]\t\t\t= fonte.[Pausa Break (Intelix)]\n    \t\t \t,destino.[Pausa 10 (Intelix)]\t\t\t\t= fonte.[Pausa 10 (Intelix)]\n    \t\t \t,destino.[Pausa Outbound (Intelix)]\t\t\t= fonte.[Pausa Outbound (Intelix)]\n    \t\t  \t,destino.[Pausa Lanche (Intelix)]\t\t\t= fonte.[Pausa Lanche (Intelix)]\n    \t\t  \t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t= fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t= fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,destino.[Pausa Feedback (Intelix)]\t\t\t= fonte.[Pausa Feedback (Intelix)]\n    \t\t  \t,destino.[Pausa Sistema Interno (Intelix)]\t= fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,destino.[Pausa Sistema Externo (Intelix)]\t= fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,destino.[Pausa Treinamento (Intelix)]\t\t= fonte.[Pausa Treinamento (Intelix)]\n    \t\t  \t,destino.[Pausa Banheiro (Intelix)]\t\t\t= fonte.[Pausa Banheiro (Intelix)]\n    \t\t  \t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t= fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,destino.[Pausa NR17 (Intelix)]\t\t\t\t= fonte.[Pausa NR17 (Intelix)]\n    \t\t  \t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t= fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,destino.[Pausa Tratativa (EPBX)]\t\t\t= fonte.[Pausa Tratativa (EPBX)]\n    \t\t  \t,destino.[Pausa Discagem Manual (EPBX)]\t\t= fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,destino.[Pausa Banheiro (EPBX)]\t\t\t= fonte.[Pausa Banheiro (EPBX)]\n    \t\t  \t,destino.[Pausa WhatsApp (EPBX)]\t\t\t= fonte.[Pausa WhatsApp (EPBX)]\n    \t\t  \t,destino.[Pausa Intervalo (EPBX)]\t\t\t= fonte.[Pausa Intervalo (EPBX)]\n    \t\t  \t,destino.[Pausa Discagem Retorno (EPBX)]\t= fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,destino.[Pausa Treinamento (EPBX)]\t\t\t= fonte.[Pausa Treinamento (EPBX)]\n    \t\t  \t,destino.[Pausa Feedback (EPBX)]\t\t\t= fonte.[Pausa Feedback (EPBX)]\n    \t\t  \t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t= fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t= fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,destino.[Pausa Login (EPBX)]\t\t\t\t= fonte.[Pausa Login (EPBX)]\n    \t\t  \t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,destino.[Pausa Sistema Interno (EPBX)]\t\t= fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,destino.[Pausa Sistema Externo (EPBX)]\t\t= fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,destino.[Pausa NR17 (EPBX)]\t\t\t\t= fonte.[Pausa NR17 (EPBX)]\n    \t\t  \t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t= fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t= fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,destino.[Pausa Lanche (EPBX)]\t\t\t\t= fonte.[Pausa Lanche (EPBX)]\n    \t\t  \t,destino.[Pausa BackOffice (EPBX)]\t\t\t= fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t= fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t= fonte.[Pausa Banheiro (Genesys)]\n    \t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t= fonte.[Pausa Descanso (Genesys)]\n    \t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t= fonte.[Pausa Feedback (Genesys)]\n    \t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t= fonte.[Pausa Backoffice (Genesys)]\n    \t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t= fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t= fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t= fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t= fonte.[Pausa Em Fila (Genesys)]\n    \t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t= fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t= fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t= fonte.[Pausa Tratativa (Genesys)]\n    \t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t= fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t= fonte.[Pausa Treinamento (Genesys)]\n\n    \t\t\t,destino.[Criados]\t\t\t\t\t\t\t= fonte.[Criados]\n    \t\t\t,destino.[Tratados]\t\t\t\t\t\t\t= fonte.[Tratados]\n    \t\t\t,destino.[Tempo Total de Tratativa]\t\t\t= fonte.[Tempo Total de Tratativa]\n    \t\t\t,destino.[TMT]\t\t\t\t\t\t\t\t= fonte.[TMT]\n    \t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t\t\t= fonte.[N\u00e3o Resolvidos]\n    \t\t\t,destino.[Replicas]\t\t\t\t\t\t\t= fonte.[Replicas]\n    \t\t\t,destino.[Reincidentes 48h]\t\t\t\t\t= fonte.[Reincidentes 48h]\n    \t\t\t,destino.[Reincidentes 30d]\t\t\t\t\t= fonte.[Reincidentes 30d]\n\n    \t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Transferidas]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMC]\n    \t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMA]\n    \t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TME]\n    \t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMO]\n    \t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Abandono]\n\n    \t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Transferidas]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMC]\n    \t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMA]\n    \t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TME]\n    \t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMO]\n    \t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - % Abandono]\n\n\n    \t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t= fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t,destino.[Promotoras]\t\t\t\t\t\t= fonte.[Promotoras]\n    \t\t\t,destino.[Neutras]\t\t\t\t\t\t\t= fonte.[Neutras]\n    \t\t\t,destino.[Detratoras]\t\t\t\t\t\t= fonte.[Detratoras]\n    \t\t\t,destino.[NPS]\t\t\t\t\t\t\t\t= fonte.[NPS]\n\n    \t\t\t,destino.[\u00c9 A Tribo do MOP?]\t\t\t\t= fonte.[\u00c9 A Tribo do MOP?]\n    \t\t\t,destino.[Teve Evento de MOP?]\t\t\t\t= fonte.[Teve Evento de MOP?]\n    \t\t\t,destino.[Teve Evento de Tickets?]\t\t\t= fonte.[Teve Evento de Tickets?]\n    \t\t\t,destino.[Teve Evento de Chamadas?]\t\t\t= fonte.[Teve Evento de Chamadas?]\n    \t\t\t,destino.[Teve Evento de NPS?]\t\t\t\t= fonte.[Teve Evento de NPS?]\n    \t\t\t,destino.[Teve Evento de Log?]\t\t\t\t= fonte.[Teve Evento de Log?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_individuo_dia\n        WHERE   [\u00c9 A Tribo do MOP?]\t\t    = 0\n    \t    AND\t[Teve Evento de MOP?]\t    = 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n    IF 1=0 BEGIN; PRINT '--- agrupamento individuo_m\u00eas';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_individuo_m\u00eas]\n    \t\tWHERE [M\u00eas (Primeiro Dia)] >= DATEFROMPARTS(YEAR(@datahora_inicio ),MONTH(@datahora_inicio) ,1)\n    \t\tAND\t  [M\u00eas (Primeiro Dia)] <= DATEFROMPARTS(YEAR(@datahora_fim ),MONTH(@datahora_fim) ,1)\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n    \t\tSELECT\n    \t\t\t [M\u00eas (Primeiro Dia)]\t\t\t\t=\t[M\u00eas (Primeiro Dia)]\n\n\n                --,[Feriado (Nome)]                                     =  SUM([Feriado (Nome)])\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(SUM([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(SUM([Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t        ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(SUM([Secullum - Servi\u00e7o Militar]                                   ),0)\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(SUM([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t        ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t        ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(SUM([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t        ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(SUM([Secullum - Licen\u00e7a Casamento]                                 ),0)\n                ,[Secullum - INSS - Afastamento]                                    =   ISNULL(SUM([Secullum - INSS - Afastamento]                                ),0)\n                ,[Secullum - Folga]                                                 =   ISNULL(SUM([Secullum - Folga]                                             ),0)\n                ,[Secullum - F\u00e9rias]                                                =   ISNULL(SUM([Secullum - F\u00e9rias]                                            ),0)\n       \t        ,[Secullum - Feriado]                                               =   ISNULL(SUM([Secullum - Feriado]                                           ),0)\n       \t        ,[Secullum - Falta Justificada]                                     =   ISNULL(SUM([Secullum - Falta Justificada]                                 ),0)\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(SUM([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                ,[Secullum - Falta Injustificada]                                   =   ISNULL(SUM([Secullum - Falta Injustificada]                               ),0)\n       \t        ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(SUM([Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(SUM([Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                ,[Secullum - Desligue]                                              =   ISNULL(SUM([Secullum - Desligue]                                          ),0)\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(SUM([Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t        ,[Secullum - Compensando Horas]                                     =   ISNULL(SUM([Secullum - Compensando Horas]                                 ),0)\n       \t        ,[Secullum - Atestado]                                              =   ISNULL(SUM([Secullum - Atestado]                                          ),0)\n                ,[Secullum - Abono]                                                 =   ISNULL(SUM([Secullum - Abono]                                             ),0)\n       \t        ,[Secullum - Abono Lactante]                                        =   ISNULL(SUM([Secullum - Abono Lactante]                                    ),0)\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(SUM([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t        ,[Faltas Justificadas]                                              =   ISNULL(SUM([Faltas Justificadas]                                          ),0)\n       \t        ,[Faltas Injustificadas]                                            =   ISNULL(SUM([Faltas Injustificadas]                                        ),0)\n\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tMAX([DataHora da Atualiza\u00e7\u00e3o do MOP])\n    \t\t\t,[ID Selecionar]\t\t\t\t\t=\t[ID Selecionar]\n    \t\t\t,[Nome]\t\t\t\t\t\t\t\t=   MIN([ult_Nome])\n    \t\t\t,[Status]\t\t\t\t\t\t\t=\tMIN([ult_Status])\n    \t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([ult_Situa\u00e7\u00e3o])\n    \t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([ult_Condi\u00e7\u00e3o])\n\n    \t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tMIN([ult_DMA Inicial])\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tMIN([ult_\u00daltima DMA Migra\u00e7\u00e3o])\n    \t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tMIN([ult_\u00daltima DMA Geral])\n    \t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tMIN([ult_Tipo da \u00daltima DMA])\n    \t\t\t,[Instrutor Inicial]\t\t\t\t=\tMIN([ult_Instrutor Inicial])\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tMIN([ult_Instrutor \u00daltima Migra\u00e7\u00e3o])\n    \t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tMIN([ult_Instrutor \u00daltima DMA])\n\n    \t\t\t,[Cliente]\t\t\t\t\t\t\t=\tMIN([Cliente])\n    \t\t\t,[Projeto]\t\t\t\t\t\t\t=\tMIN([Projeto])\n    \t\t\t,[Cargo]\t\t\t\t\t\t\t=\tMIN([ult_Cargo])\n    \t\t\t,[Tribo]\t\t\t\t\t\t\t=\tMIN([Tribo])\n    \t\t\t,[Tribo Completa]\t\t\t\t\t=\tMIN([Tribo Completa])\n    \t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tMIN([ult_Supervis\u00e3o])\n\t\t\t\t,[Email Supervis\u00e3o]\t\t\t\t\t=\tMIN([ult_Email Supervis\u00e3o])\n\t\t\t\t,[Tempo de Casa (Dias)]\t\t\t\t=\tMIN([ult_Tempo de Casa (Dias)])\n\t\t\t\t,[Faixa Tempo de Casa]\t\t\t\t=\tMIN([ult_Faixa Tempo de Casa])\n\t\t\t\t,[Idade]\t\t\t\t\t\t\t=\tMIN([ult_Idade])\n\t\t\t\t,[Faixa de Idade]\t\t\t\t\t=\tMIN([ult_Faixa de Idade])\n    \t\t\t,[Turno]\t\t\t\t\t\t\t=\tMIN([ult_Turno])\n\n    \t\t\t,[Escala (Ponto)]\t\t\t\t\t=\tMIN([ult_Escala (Ponto)])\n    \t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tMIN([ult_Jornada (Ponto)])\n    \t\t\t,[Trabalhado (Ponto)]\t\t\t\t=\tSUM([Trabalhado (Ponto)])\n    \t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=\tSUM([Em Pausa (Ponto)])\n\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t=\tSUM([Desvio Ponto-Log])\n    \t\t\t,[Escala (MOP)]\t\t\t\t\t\t=\tMIN([ult_Escala (MOP)])\n    \t\t\t,[Jornada (Log)]\t\t\t\t\t=\tMIN([ult_Jornada (Log)])\n\n    \t\t\t,[Log descartado (>2HE)]\t\t\t=\tSUM([Log descartado (>2HE)])\n    \t\t\t,[Log HE]\t\t\t\t\t\t\t\t=\tSUM([Log HE])\n    \t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM([Log])\n    \t\t\t,[Log Produtivo]\t\t\t\t\t=\tSUM([Log Produtivo])\n    \t\t \t,[Log Improdutivo]\t\t\t\t\t=\tSUM([Log Improdutivo])\n    \t\t \t,[Tempo Livre]\t\t\t\t\t\t=\tSUM([Tempo Livre])\n    \t\t \t,[Pausa Particular (Intelix)]\t\t=\tSUM([Pausa Particular (Intelix)])\n    \t\t \t,[Pausa Break (Intelix)]\t\t\t=\tSUM([Pausa Break (Intelix)])\n    \t\t \t,[Pausa 10 (Intelix)]\t\t\t\t=\tSUM([Pausa 10 (Intelix)])\n    \t\t \t,[Pausa Outbound (Intelix)]\t\t\t=\tSUM([Pausa Outbound (Intelix)])\n    \t\t  \t,[Pausa Lanche (Intelix)]\t\t\t=\tSUM([Pausa Lanche (Intelix)])\n    \t\t  \t,[Pausa R\u00e1pida (Intelix)]\t\t\t=\tSUM([Pausa R\u00e1pida (Intelix)])\n    \t\t  \t,[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Intelix)])\n    \t\t  \t,[Pausa Feedback (Intelix)]\t\t\t=\tSUM([Pausa Feedback (Intelix)])\n    \t\t  \t,[Pausa Sistema Interno (Intelix)]\t=\tSUM([Pausa Sistema Interno (Intelix)])\n    \t\t  \t,[Pausa Sistema Externo (Intelix)]\t=\tSUM([Pausa Sistema Externo (Intelix)])\n    \t\t  \t,[Pausa Treinamento (Intelix)]\t\t=\tSUM([Pausa Treinamento (Intelix)])\n    \t\t  \t,[Pausa Banheiro (Intelix)]\t\t\t=\tSUM([Pausa Banheiro (Intelix)])\n    \t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tSUM([Pausa Reuni\u00e3o (Intelix)])\n    \t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Intelix)])\n    \t\t  \t,[Pausa NR17 (Intelix)]\t\t\t\t=\tSUM([Pausa NR17 (Intelix)])\n    \t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Liga\u00e7\u00e3o (EPBX)])\n    \t\t  \t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tSUM([Pausa Almo\u00e7o (EPBX)])\n    \t\t  \t,[Pausa Tratativa (EPBX)]\t\t\t=\tSUM([Pausa Tratativa (EPBX)])\n    \t\t  \t,[Pausa Discagem Manual (EPBX)]\t\t=\tSUM([Pausa Discagem Manual (EPBX)])\n    \t\t  \t,[Pausa Banheiro (EPBX)]\t\t\t=\tSUM([Pausa Banheiro (EPBX)])\n    \t\t  \t,[Pausa WhatsApp (EPBX)]\t\t\t=\tSUM([Pausa WhatsApp (EPBX)])\n    \t\t  \t,[Pausa Intervalo (EPBX)]\t\t\t=\tSUM([Pausa Intervalo (EPBX)])\n    \t\t  \t,[Pausa Discagem Retorno (EPBX)]\t=\tSUM([Pausa Discagem Retorno (EPBX)])\n    \t\t  \t,[Pausa Treinamento (EPBX)]\t\t\t=\tSUM([Pausa Treinamento (EPBX)])\n    \t\t  \t,[Pausa Feedback (EPBX)]\t\t\t=\tSUM([Pausa Feedback (EPBX)])\n    \t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\t\t=\tSUM([Pausa Transfer\u00eancia (EPBX)])\n    \t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tSUM([Pausa N\u00e3o Disponivel (EPBX)])\n    \t\t  \t,[Pausa Login (EPBX)]\t\t\t\t=\tSUM([Pausa Login (EPBX)])\n    \t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Reuni\u00e3o (EPBX)])\n    \t\t  \t,[Pausa Sistema Interno (EPBX)]\t\t=\tSUM([Pausa Sistema Interno (EPBX)])\n    \t\t  \t,[Pausa Sistema Externo (EPBX)]\t\t=\tSUM([Pausa Sistema Externo (EPBX)])\n    \t\t  \t,[Pausa NR17 (EPBX)]\t\t\t\t=\tSUM([Pausa NR17 (EPBX)])\n    \t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tSUM([Pausa Ambulat\u00f3rio (EPBX)])\n    \t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tSUM([Pausa P\u00f3s Atendimento (EPBX)])\n    \t\t  \t,[Pausa Lanche (EPBX)]\t\t\t\t=\tSUM([Pausa Lanche (EPBX)])\n    \t\t  \t,[Pausa BackOffice (EPBX)]\t\t\t=\tSUM([Pausa BackOffice (EPBX)])\n    \t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Genesys)])\n    \t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Genesys)])\n    \t\t \t,[Pausa Banheiro (Genesys)]\t\t\t=\tSUM([Pausa Banheiro (Genesys)])\n    \t\t \t,[Pausa Descanso (Genesys)]\t\t\t=\tSUM([Pausa Descanso (Genesys)])\n    \t\t \t,[Pausa Feedback (Genesys)]\t\t\t=\tSUM([Pausa Feedback (Genesys)])\n    \t\t \t,[Pausa Backoffice (Genesys)]\t\t=\tSUM([Pausa Backoffice (Genesys)])\n    \t\t \t,[Pausa Discagem Manual (Genesys)]\t=\tSUM([Pausa Discagem Manual (Genesys)])\n    \t\t \t,[Pausa Discagem Retorno (Genesys)]\t=\tSUM([Pausa Discagem Retorno (Genesys)])\n    \t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tSUM([Pausa Dispon\u00edvel (Genesys)])\n    \t\t \t,[Pausa Em Fila (Genesys)]\t\t\t=\tSUM([Pausa Em Fila (Genesys)])\n    \t\t \t,[Pausa Sistema Externo (Genesys)]\t=\tSUM([Pausa Sistema Externo (Genesys)])\n    \t\t \t,[Pausa Sistema Interno (Genesys)]\t=\tSUM([Pausa Sistema Interno (Genesys)])\n    \t\t \t,[Pausa Tratativa (Genesys)]\t\t=\tSUM([Pausa Tratativa (Genesys)])\n    \t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t=\tSUM([Pausa Whatsapp (Genesys)])\n    \t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tSUM([Pausa Treinamento (Genesys)])\n\n    \t\t\t,[Criados]\t\t\t\t\t\t\t=\tSUM([Criados])\n    \t\t\t,[Tratados]\t\t\t\t\t\t\t=\tSUM([Tratados])\n    \t\t\t,[Tempo Total de Tratativa]\t\t\t=\tSUM([Tempo Total de Tratativa])\n    \t\t\t,[TMT]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n    \t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t=\tSUM([N\u00e3o Resolvidos])\n    \t\t\t,[Replicas]\t\t\t\t\t\t\t=\tSUM([Replicas])\n    \t\t\t,[Reincidentes 48h]\t\t\t\t\t=\tSUM([Reincidentes 48h])\n    \t\t\t,[Reincidentes 30d]\t\t\t\t\t=\tSUM([Reincidentes 30d])\n\n    \t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Iniciadas])\n    \t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas])\n    \t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Em Andamento])\n    \t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Finalizadas])\n    \t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Transferidas])\n    \t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Espera (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Chamada (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM([Inbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Espera (Neste Intervalo)])\n    \t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Inbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Iniciados])\n    \t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Em Andamento])\n    \t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Finalizados])\n    \t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Abandonadas])\n    \t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\n    \t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Iniciadas])\n    \t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas])\n    \t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Em Andamento])\n    \t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Finalizadas])\n    \t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Transferidas])\n    \t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Espera (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM([Outbound - Tempo Em Chamada (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Outbound - Tempo Em Espera (Neste Intervalo)])\n    \t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Iniciados])\n    \t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Em Andamento])\n    \t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Finalizados])\n    \t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas])AS DECIMAL),0),0)\n    \t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Abandonadas])\n    \t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n    \t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t=\tSUM([Avalia\u00e7\u00f5es de NPS])\n    \t\t\t,[Promotoras]\t\t\t\t\t\t=\tSUM([Promotoras])\n    \t\t\t,[Neutras]\t\t\t\t\t\t\t= \tSUM([Neutras])\n    \t\t\t,[Detratoras]\t\t\t\t\t\t= \tSUM([Detratoras])\n    \t\t\t,[NPS]\t\t\t\t\t\t\t\t=\tCAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n    \t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t= \tIIF(SUM([\u00c9 A Tribo do MOP?])=0,0,1)\n    \t\t\t,[Teve Evento de MOP?]\t\t\t\t= \tIIF(SUM([Teve Evento de MOP?])=0,0,1)\n    \t\t\t,[Teve Evento de Tickets?]\t\t\t= \tIIF(SUM([Teve Evento de Tickets?])=0,0,1)\n    \t\t\t,[Teve Evento de Chamadas?]\t\t\t= \tIIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n    \t\t\t,[Teve Evento de NPS?]\t\t\t\t= \tIIF(SUM([Teve Evento de NPS?])=0,0,1)\n    \t\t\t,[Teve Evento de Log?]\t\t\t\t= \tIIF(SUM([Teve Evento de Log?])=0,0,1)\n\n    \t\tFROM (\n                SELECT *\n    \t\t\t    ,[ult_Nome]\t\t\t\t\t\t\t=   FIRST_VALUE([Nome])                         OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Status]\t\t\t\t\t\t=\tFIRST_VALUE([Status])                       OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Situa\u00e7\u00e3o]\t\t\t\t\t\t=\tFIRST_VALUE([Situa\u00e7\u00e3o])                     OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Condi\u00e7\u00e3o]\t\t\t\t\t\t=\tFIRST_VALUE([Condi\u00e7\u00e3o])                     OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_DMA Inicial]\t\t\t\t\t=\tFIRST_VALUE([DMA Inicial])                  OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t=\tFIRST_VALUE([\u00daltima DMA Migra\u00e7\u00e3o])          OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_\u00daltima DMA Geral]\t\t\t\t=\tFIRST_VALUE([\u00daltima DMA Geral])             OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Tipo da \u00daltima DMA]\t\t\t=\tFIRST_VALUE([Tipo da \u00daltima DMA])           OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Instrutor Inicial]\t\t\t=\tFIRST_VALUE([Instrutor Inicial])            OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Instrutor \u00daltima Migra\u00e7\u00e3o]\t=\tFIRST_VALUE([Instrutor \u00daltima Migra\u00e7\u00e3o])    OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Instrutor \u00daltima DMA]\t\t\t=\tFIRST_VALUE([Instrutor \u00daltima DMA])         OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Cargo]\t\t\t\t\t\t=\tFIRST_VALUE([Cargo])                        OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Supervis\u00e3o]\t\t\t\t\t=\tFIRST_VALUE([Supervis\u00e3o])                   OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Email Supervis\u00e3o]\t\t\t\t=\tFIRST_VALUE([Email Supervis\u00e3o])             OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n\t\t\t\t\t,[ult_Tempo de Casa (Dias)]\t\t\t=\tFIRST_VALUE([Tempo de Casa (Dias)])         OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n\t\t\t\t\t,[ult_Faixa Tempo de Casa]\t\t\t=\tFIRST_VALUE([Faixa Tempo de Casa])          OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n\t\t\t\t\t,[ult_Idade]\t\t\t\t\t\t=\tFIRST_VALUE([Idade])\t\t\t\t\t\tOVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n\t\t\t\t\t,[ult_Faixa de Idade]\t\t\t\t=\tFIRST_VALUE([Faixa de Idade])\t\t\t\tOVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Turno]\t\t\t\t\t\t=\tFIRST_VALUE([Turno])                        OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Escala (Ponto)]\t\t\t\t=\tFIRST_VALUE([Escala (Ponto)])               OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Jornada (Ponto)]\t\t\t\t=\tFIRST_VALUE([Jornada (Ponto)])              OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Escala (MOP)]\t\t\t\t\t=\tFIRST_VALUE([Escala (MOP)])                 OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n    \t\t\t    ,[ult_Jornada (Log)]\t\t\t\t=\tFIRST_VALUE([Jornada (Log)])                OVER (PARTITION BY [ID Selecionar], [M\u00eas (Primeiro Dia)] ORDER BY [Data] DESC)\n                FROM r_individuo_dia\n    \t\t    WHERE [M\u00eas (Primeiro Dia)] >= DATEFROMPARTS(YEAR(@datahora_inicio ),MONTH(@datahora_inicio) ,1)\n    \t\t    AND\t  [M\u00eas (Primeiro Dia)] <= DATEFROMPARTS(YEAR(@datahora_fim ),MONTH(@datahora_fim) ,1)\n            ) _\n    \t\tGROUP BY [M\u00eas (Primeiro Dia)], [ID Selecionar], [Tribo Completa]\n    \t) AS fonte\n    \tON  fonte.[M\u00eas (Primeiro Dia)]  = destino.[M\u00eas (Primeiro Dia)]\n    \tAND COALESCE(fonte.[ID Selecionar], '-')\t= COALESCE(destino.[ID Selecionar], '-')\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n    \t\t\t [M\u00eas (Primeiro Dia)]\n\n                --,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n    \t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,[ID Selecionar]\n    \t\t\t,[Nome]\n    \t\t\t,[Status]\n    \t\t\t,[Situa\u00e7\u00e3o]\n    \t\t\t,[Condi\u00e7\u00e3o]\n\n    \t\t\t,[DMA Inicial]\n    \t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,[\u00daltima DMA Geral]\n    \t\t\t,[Tipo da \u00daltima DMA]\n    \t\t\t,[Instrutor Inicial]\n    \t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,[Instrutor \u00daltima DMA]\n\n    \t\t\t,[Cliente]\n    \t\t\t,[Projeto]\n    \t\t\t,[Cargo]\n    \t\t\t,[Tribo]\n    \t\t\t,[Tribo Completa]\n    \t\t\t,[Supervis\u00e3o]\n\t\t\t\t,[Email Supervis\u00e3o]\n\t\t\t\t,[Tempo de Casa (Dias)]\n\t\t\t\t,[Faixa Tempo de Casa]\n\t\t\t\t,[Idade]\n\t\t\t\t,[Faixa de Idade]\n    \t\t\t,[Turno]\n\n    \t\t\t,[Escala (Ponto)]\n    \t\t\t,[Jornada (Ponto)]\n    \t\t\t,[Trabalhado (Ponto)]\n    \t\t\t,[Em Pausa (Ponto)]\n\t\t\t\t,[Desvio Ponto-Log]\n    \t\t\t,[Escala (MOP)]\n    \t\t\t,[Jornada (Log)]\n\n    \t\t\t,[Log descartado (>2HE)]\n    \t\t\t,[Log HE]\n    \t\t\t,[Log]\n    \t\t\t,[Log Produtivo]\n    \t\t \t,[Log Improdutivo]\n    \t\t \t,[Tempo Livre]\n    \t\t \t,[Pausa Particular (Intelix)]\n    \t\t \t,[Pausa Break (Intelix)]\n    \t\t \t,[Pausa 10 (Intelix)]\n    \t\t \t,[Pausa Outbound (Intelix)]\n    \t\t  \t,[Pausa Lanche (Intelix)]\n    \t\t  \t,[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,[Pausa Feedback (Intelix)]\n    \t\t  \t,[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,[Pausa Treinamento (Intelix)]\n    \t\t  \t,[Pausa Banheiro (Intelix)]\n    \t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,[Pausa NR17 (Intelix)]\n    \t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,[Pausa Tratativa (EPBX)]\n    \t\t  \t,[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,[Pausa Banheiro (EPBX)]\n    \t\t  \t,[Pausa WhatsApp (EPBX)]\n    \t\t  \t,[Pausa Intervalo (EPBX)]\n    \t\t  \t,[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,[Pausa Treinamento (EPBX)]\n    \t\t  \t,[Pausa Feedback (EPBX)]\n    \t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,[Pausa Login (EPBX)]\n    \t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,[Pausa NR17 (EPBX)]\n    \t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,[Pausa Lanche (EPBX)]\n    \t\t  \t,[Pausa BackOffice (EPBX)]\n    \t\t\t,[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t \t,[Pausa Banheiro (Genesys)]\n    \t\t \t,[Pausa Descanso (Genesys)]\n    \t\t \t,[Pausa Feedback (Genesys)]\n    \t\t \t,[Pausa Backoffice (Genesys)]\n    \t\t \t,[Pausa Discagem Manual (Genesys)]\n    \t\t \t,[Pausa Discagem Retorno (Genesys)]\n    \t\t \t,[Pausa Dispon\u00edvel (Genesys)]\n    \t\t \t,[Pausa Em Fila (Genesys)]\n    \t\t \t,[Pausa Sistema Externo (Genesys)]\n    \t\t \t,[Pausa Sistema Interno (Genesys)]\n    \t\t \t,[Pausa Tratativa (Genesys)]\n    \t\t \t,[Pausa Whatsapp (Genesys)]\n    \t\t\t,[Pausa Treinamento (Genesys)]\n\n    \t\t\t,[Criados]\n    \t\t\t,[Tratados]\n    \t\t\t,[Tempo Total de Tratativa]\n    \t\t\t,[TMT]\n    \t\t\t,[N\u00e3o Resolvidos]\n    \t\t\t,[Replicas]\n    \t\t\t,[Reincidentes 48h]\n    \t\t\t,[Reincidentes 30d]\n\n    \t\t    ,[Inbound - Chamadas Iniciadas]\n    \t\t    ,[Inbound - Chamadas Atendidas]\n    \t\t    ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,[Inbound - Chamadas Em Andamento]\n    \t\t    ,[Inbound - Chamadas Finalizadas]\n    \t\t    ,[Inbound - Chamadas Transferidas]\n    \t\t    ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,[Inbound - Atendimentos Iniciados]\n    \t\t    ,[Inbound - Atendimentos Em Andamento]\n    \t\t    ,[Inbound - Atendimentos Finalizados]\n    \t\t    ,[Inbound - TMC]\n    \t\t    ,[Inbound - TMA]\n    \t\t    ,[Inbound - TME]\n    \t\t    ,[Inbound - TMO]\n    \t\t    ,[Inbound - % Nivel de Servi\u00e7o]\n    \t\t    ,[Inbound - Chamadas Abandonadas]\n    \t\t    ,[Inbound - % Abandono]\n\n    \t\t    ,[Outbound - Chamadas Iniciadas]\n    \t\t    ,[Outbound - Chamadas Atendidas]\n    \t\t    ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,[Outbound - Chamadas Em Andamento]\n    \t\t    ,[Outbound - Chamadas Finalizadas]\n    \t\t    ,[Outbound - Chamadas Transferidas]\n    \t\t    ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,[Outbound - Atendimentos Iniciados]\n    \t\t    ,[Outbound - Atendimentos Em Andamento]\n    \t\t    ,[Outbound - Atendimentos Finalizados]\n    \t\t    ,[Outbound - TMC]\n    \t\t    ,[Outbound - TMA]\n    \t\t    ,[Outbound - TME]\n    \t\t    ,[Outbound - TMO]\n    \t\t    ,[Outbound - % Nivel de Servi\u00e7o]\n    \t\t    ,[Outbound - Chamadas Abandonadas]\n    \t\t    ,[Outbound - % Abandono]\n\n    \t\t\t,[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t,[Promotoras]\n    \t\t\t,[Neutras]\n    \t\t\t,[Detratoras]\n    \t\t\t,[NPS]\n\n    \t\t\t,[\u00c9 A Tribo do MOP?]\n    \t\t\t,[Teve Evento de MOP?]\n    \t\t\t,[Teve Evento de Tickets?]\n    \t\t\t,[Teve Evento de Chamadas?]\n    \t\t\t,[Teve Evento de NPS?]\n    \t\t\t,[Teve Evento de Log?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n    \t\t\t fonte.[M\u00eas (Primeiro Dia)]\n\n                --,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n    \t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,fonte.[ID Selecionar]\n    \t\t\t,fonte.[Nome]\n    \t\t\t,fonte.[Status]\n    \t\t\t,fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,fonte.[Condi\u00e7\u00e3o]\n\n    \t\t\t,fonte.[DMA Inicial]\n    \t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[\u00daltima DMA Geral]\n    \t\t\t,fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,fonte.[Instrutor Inicial]\n    \t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,fonte.[Instrutor \u00daltima DMA]\n\n    \t\t\t,fonte.[Cliente]\n    \t\t\t,fonte.[Projeto]\n    \t\t\t,fonte.[Cargo]\n    \t\t\t,fonte.[Tribo]\n    \t\t\t,fonte.[Tribo Completa]\n    \t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t\t,fonte.[Email Supervis\u00e3o]\n\t\t\t\t,fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,fonte.[Faixa Tempo de Casa]\n\t\t\t\t,fonte.[Idade]\n\t\t\t\t,fonte.[Faixa de Idade]\n    \t\t\t,fonte.[Turno]\n\n    \t\t\t,fonte.[Escala (Ponto)]\n    \t\t\t,fonte.[Jornada (Ponto)]\n    \t\t\t,fonte.[Trabalhado (Ponto)]\n    \t\t\t,fonte.[Em Pausa (Ponto)]\n\t\t\t\t,fonte.[Desvio Ponto-Log]\n    \t\t\t,fonte.[Escala (MOP)]\n    \t\t\t,fonte.[Jornada (Log)]\n\n    \t\t\t,fonte.[Log descartado (>2HE)]\n    \t\t\t,fonte.[Log HE]\n    \t\t\t,fonte.[Log]\n    \t\t\t,fonte.[Log Produtivo]\n    \t\t \t,fonte.[Log Improdutivo]\n    \t\t \t,fonte.[Tempo Livre]\n    \t\t \t,fonte.[Pausa Particular (Intelix)]\n    \t\t \t,fonte.[Pausa Break (Intelix)]\n    \t\t \t,fonte.[Pausa 10 (Intelix)]\n    \t\t \t,fonte.[Pausa Outbound (Intelix)]\n    \t\t  \t,fonte.[Pausa Lanche (Intelix)]\n    \t\t  \t,fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,fonte.[Pausa Feedback (Intelix)]\n    \t\t  \t,fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,fonte.[Pausa Treinamento (Intelix)]\n    \t\t  \t,fonte.[Pausa Banheiro (Intelix)]\n    \t\t  \t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,fonte.[Pausa NR17 (Intelix)]\n    \t\t  \t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,fonte.[Pausa Tratativa (EPBX)]\n    \t\t  \t,fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,fonte.[Pausa Banheiro (EPBX)]\n    \t\t  \t,fonte.[Pausa WhatsApp (EPBX)]\n    \t\t  \t,fonte.[Pausa Intervalo (EPBX)]\n    \t\t  \t,fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,fonte.[Pausa Treinamento (EPBX)]\n    \t\t  \t,fonte.[Pausa Feedback (EPBX)]\n    \t\t  \t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,fonte.[Pausa Login (EPBX)]\n    \t\t  \t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,fonte.[Pausa NR17 (EPBX)]\n    \t\t  \t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,fonte.[Pausa Lanche (EPBX)]\n    \t\t  \t,fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t \t,fonte.[Pausa Banheiro (Genesys)]\n    \t\t \t,fonte.[Pausa Descanso (Genesys)]\n    \t\t \t,fonte.[Pausa Feedback (Genesys)]\n    \t\t \t,fonte.[Pausa Backoffice (Genesys)]\n    \t\t \t,fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t \t,fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t \t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t \t,fonte.[Pausa Em Fila (Genesys)]\n    \t\t \t,fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t \t,fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t \t,fonte.[Pausa Tratativa (Genesys)]\n    \t\t \t,fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t,fonte.[Pausa Treinamento (Genesys)]\n\n    \t\t\t,fonte.[Criados]\n    \t\t\t,fonte.[Tratados]\n    \t\t\t,fonte.[Tempo Total de Tratativa]\n    \t\t\t,fonte.[TMT]\n    \t\t\t,fonte.[N\u00e3o Resolvidos]\n    \t\t\t,fonte.[Replicas]\n    \t\t\t,fonte.[Reincidentes 48h]\n    \t\t\t,fonte.[Reincidentes 30d]\n\n    \t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n    \t\t    ,fonte.[Inbound - Chamadas Atendidas]\n    \t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n    \t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n    \t\t    ,fonte.[Inbound - Chamadas Transferidas]\n    \t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n    \t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n    \t\t    ,fonte.[Inbound - TMC]\n    \t\t    ,fonte.[Inbound - TMA]\n    \t\t    ,fonte.[Inbound - TME]\n    \t\t    ,fonte.[Inbound - TMO]\n    \t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n    \t\t    ,fonte.[Inbound - % Abandono]\n\n    \t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n    \t\t    ,fonte.[Outbound - Chamadas Atendidas]\n    \t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n    \t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n    \t\t    ,fonte.[Outbound - Chamadas Transferidas]\n    \t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n    \t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n    \t\t    ,fonte.[Outbound - TMC]\n    \t\t    ,fonte.[Outbound - TMA]\n    \t\t    ,fonte.[Outbound - TME]\n    \t\t    ,fonte.[Outbound - TMO]\n    \t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n    \t\t    ,fonte.[Outbound - % Abandono]\n\n    \t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t    ,fonte.[Promotoras]\n    \t\t    ,fonte.[Neutras]\n    \t\t    ,fonte.[Detratoras]\n    \t\t    ,fonte.[NPS]\n\n    \t\t    ,fonte.[\u00c9 A Tribo do MOP?]\n    \t\t    ,fonte.[Teve Evento de MOP?]\n    \t\t    ,fonte.[Teve Evento de Tickets?]\n    \t\t    ,fonte.[Teve Evento de Chamadas?]\n    \t\t    ,fonte.[Teve Evento de NPS?]\n    \t\t    ,fonte.[Teve Evento de Log?]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n    \t\t\t destino.[M\u00eas (Primeiro Dia)]\t\t\t\t= fonte.[M\u00eas (Primeiro Dia)]\n\n                --,destino.[Feriado (Nome)]                                     =   fonte.[Feriado (Nome)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n    \t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t= fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n    \t\t\t,destino.[ID Selecionar]\t\t\t\t\t= fonte.[ID Selecionar]\n    \t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t= fonte.[Nome]\n    \t\t\t,destino.[Status]\t\t\t\t\t\t\t= fonte.[Status]\n    \t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Situa\u00e7\u00e3o]\n    \t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Condi\u00e7\u00e3o]\n\n    \t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t= fonte.[DMA Inicial]\n    \t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t= fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n    \t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t= fonte.[\u00daltima DMA Geral]\n    \t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t= fonte.[Tipo da \u00daltima DMA]\n    \t\t\t,destino.[Instrutor Inicial]\t\t\t\t= fonte.[Instrutor Inicial]\n    \t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t= fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n    \t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t= fonte.[Instrutor \u00daltima DMA]\n\n    \t\t\t,destino.[Cliente]\t\t\t\t\t\t\t= fonte.[Cliente]\n    \t\t\t,destino.[Projeto]\t\t\t\t\t\t\t= fonte.[Projeto]\n    \t\t\t,destino.[Cargo]\t\t\t\t\t\t\t= fonte.[Cargo]\n    \t\t\t,destino.[Tribo]\t\t\t\t\t\t\t= fonte.[Tribo]\n    \t\t\t,destino.[Tribo Completa]\t\t\t\t\t= fonte.[Tribo Completa]\n    \t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t= fonte.[Supervis\u00e3o]\n    \t\t\t,destino.[Email Supervis\u00e3o]\t\t\t\t\t= fonte.[Email Supervis\u00e3o]\n\t\t\t\t,destino.[Tempo de Casa (Dias)]\t\t\t\t= fonte.[Tempo de Casa (Dias)]\n\t\t\t\t,destino.[Faixa Tempo de Casa]\t\t\t\t= fonte.[Faixa Tempo de Casa]\n\t\t\t\t,destino.[Idade]\t\t\t\t\t\t\t= fonte.[Idade]\n\t\t\t\t,destino.[Faixa de Idade]\t\t\t\t\t= fonte.[Faixa de Idade]\n    \t\t\t,destino.[Turno]\t\t\t\t\t\t\t= fonte.[Turno]\n\n    \t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t= fonte.[Escala (Ponto)]\n    \t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t= fonte.[Jornada (Ponto)]\n    \t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t= fonte.[Trabalhado (Ponto)]\n    \t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t= fonte.[Em Pausa (Ponto)]\n\t\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t= fonte.[Desvio Ponto-Log]\n    \t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t= fonte.[Escala (MOP)]\n    \t\t\t,destino.[Jornada (Log)]\t\t\t\t\t= fonte.[Jornada (Log)]\n\n    \t\t\t,destino.[Log descartado (>2HE)]\t\t\t= fonte.[Log descartado (>2HE)]\n    \t\t\t,destino.[Log HE]\t\t\t\t\t\t\t= fonte.[Log HE]\n    \t\t\t,destino.[Log]\t\t\t\t\t\t\t\t= fonte.[Log]\n    \t\t\t,destino.[Log Produtivo]\t\t\t\t\t= fonte.[Log Produtivo]\n    \t\t \t,destino.[Log Improdutivo]\t\t\t\t\t= fonte.[Log Improdutivo]\n    \t\t \t,destino.[Tempo Livre]\t\t\t\t\t\t= fonte.[Tempo Livre]\n    \t\t \t,destino.[Pausa Particular (Intelix)]\t\t= fonte.[Pausa Particular (Intelix)]\n    \t\t \t,destino.[Pausa Break (Intelix)]\t\t\t= fonte.[Pausa Break (Intelix)]\n    \t\t \t,destino.[Pausa 10 (Intelix)]\t\t\t\t= fonte.[Pausa 10 (Intelix)]\n    \t\t \t,destino.[Pausa Outbound (Intelix)]\t\t\t= fonte.[Pausa Outbound (Intelix)]\n    \t\t  \t,destino.[Pausa Lanche (Intelix)]\t\t\t= fonte.[Pausa Lanche (Intelix)]\n    \t\t  \t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t= fonte.[Pausa R\u00e1pida (Intelix)]\n    \t\t  \t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t= fonte.[Pausa Almo\u00e7o (Intelix)]\n    \t\t  \t,destino.[Pausa Feedback (Intelix)]\t\t\t= fonte.[Pausa Feedback (Intelix)]\n    \t\t  \t,destino.[Pausa Sistema Interno (Intelix)]\t= fonte.[Pausa Sistema Interno (Intelix)]\n    \t\t  \t,destino.[Pausa Sistema Externo (Intelix)]\t= fonte.[Pausa Sistema Externo (Intelix)]\n    \t\t  \t,destino.[Pausa Treinamento (Intelix)]\t\t= fonte.[Pausa Treinamento (Intelix)]\n    \t\t  \t,destino.[Pausa Banheiro (Intelix)]\t\t\t= fonte.[Pausa Banheiro (Intelix)]\n    \t\t  \t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t= fonte.[Pausa Reuni\u00e3o (Intelix)]\n    \t\t  \t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n    \t\t  \t,destino.[Pausa NR17 (Intelix)]\t\t\t\t= fonte.[Pausa NR17 (Intelix)]\n    \t\t  \t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n    \t\t  \t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t= fonte.[Pausa Almo\u00e7o (EPBX)]\n    \t\t  \t,destino.[Pausa Tratativa (EPBX)]\t\t\t= fonte.[Pausa Tratativa (EPBX)]\n    \t\t  \t,destino.[Pausa Discagem Manual (EPBX)]\t\t= fonte.[Pausa Discagem Manual (EPBX)]\n    \t\t  \t,destino.[Pausa Banheiro (EPBX)]\t\t\t= fonte.[Pausa Banheiro (EPBX)]\n    \t\t  \t,destino.[Pausa WhatsApp (EPBX)]\t\t\t= fonte.[Pausa WhatsApp (EPBX)]\n    \t\t  \t,destino.[Pausa Intervalo (EPBX)]\t\t\t= fonte.[Pausa Intervalo (EPBX)]\n    \t\t  \t,destino.[Pausa Discagem Retorno (EPBX)]\t= fonte.[Pausa Discagem Retorno (EPBX)]\n    \t\t  \t,destino.[Pausa Treinamento (EPBX)]\t\t\t= fonte.[Pausa Treinamento (EPBX)]\n    \t\t  \t,destino.[Pausa Feedback (EPBX)]\t\t\t= fonte.[Pausa Feedback (EPBX)]\n    \t\t  \t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t= fonte.[Pausa Transfer\u00eancia (EPBX)]\n    \t\t  \t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t= fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n    \t\t  \t,destino.[Pausa Login (EPBX)]\t\t\t\t= fonte.[Pausa Login (EPBX)]\n    \t\t  \t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Reuni\u00e3o (EPBX)]\n    \t\t  \t,destino.[Pausa Sistema Interno (EPBX)]\t\t= fonte.[Pausa Sistema Interno (EPBX)]\n    \t\t  \t,destino.[Pausa Sistema Externo (EPBX)]\t\t= fonte.[Pausa Sistema Externo (EPBX)]\n    \t\t  \t,destino.[Pausa NR17 (EPBX)]\t\t\t\t= fonte.[Pausa NR17 (EPBX)]\n    \t\t  \t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t= fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n    \t\t  \t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t= fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n    \t\t  \t,destino.[Pausa Lanche (EPBX)]\t\t\t\t= fonte.[Pausa Lanche (EPBX)]\n    \t\t  \t,destino.[Pausa BackOffice (EPBX)]\t\t\t= fonte.[Pausa BackOffice (EPBX)]\n    \t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t= fonte.[Pausa Almo\u00e7o (Genesys)]\n    \t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n    \t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t= fonte.[Pausa Banheiro (Genesys)]\n    \t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t= fonte.[Pausa Descanso (Genesys)]\n    \t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t= fonte.[Pausa Feedback (Genesys)]\n    \t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t= fonte.[Pausa Backoffice (Genesys)]\n    \t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t= fonte.[Pausa Discagem Manual (Genesys)]\n    \t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t= fonte.[Pausa Discagem Retorno (Genesys)]\n    \t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t= fonte.[Pausa Dispon\u00edvel (Genesys)]\n    \t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t= fonte.[Pausa Em Fila (Genesys)]\n    \t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t= fonte.[Pausa Sistema Externo (Genesys)]\n    \t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t= fonte.[Pausa Sistema Interno (Genesys)]\n    \t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t= fonte.[Pausa Tratativa (Genesys)]\n    \t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t= fonte.[Pausa Whatsapp (Genesys)]\n    \t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t= fonte.[Pausa Treinamento (Genesys)]\n\n    \t\t\t,destino.[Criados]\t\t\t\t\t\t\t= fonte.[Criados]\n    \t\t\t,destino.[Tratados]\t\t\t\t\t\t\t= fonte.[Tratados]\n    \t\t\t,destino.[Tempo Total de Tratativa]\t\t\t= fonte.[Tempo Total de Tratativa]\n    \t\t\t,destino.[TMT]\t\t\t\t\t\t\t\t= fonte.[TMT]\n    \t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t\t\t= fonte.[N\u00e3o Resolvidos]\n    \t\t\t,destino.[Replicas]\t\t\t\t\t\t\t= fonte.[Replicas]\n    \t\t\t,destino.[Reincidentes 48h]\t\t\t\t\t= fonte.[Reincidentes 48h]\n    \t\t\t,destino.[Reincidentes 30d]\t\t\t\t\t= fonte.[Reincidentes 30d]\n\n    \t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas]\n    \t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Transferidas]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMC]\n    \t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMA]\n    \t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TME]\n    \t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMO]\n    \t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Abandono]\n\n    \t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Iniciadas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas]\n    \t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n    \t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Em Andamento]\n    \t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Finalizadas]\n    \t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Transferidas]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n    \t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Iniciados]\n    \t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Em Andamento]\n    \t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Finalizados]\n    \t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMC]\n    \t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMA]\n    \t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TME]\n    \t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMO]\n    \t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= fonte.[Outbound - % Nivel de Servi\u00e7o]\n    \t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Abandonadas]\n    \t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - % Abandono]\n\n    \t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t= fonte.[Avalia\u00e7\u00f5es de NPS]\n    \t\t\t,destino.[Promotoras]\t\t\t\t\t\t= fonte.[Promotoras]\n    \t\t\t,destino.[Neutras]\t\t\t\t\t\t\t= fonte.[Neutras]\n    \t\t\t,destino.[Detratoras]\t\t\t\t\t\t= fonte.[Detratoras]\n    \t\t\t,destino.[NPS]\t\t\t\t\t\t\t\t= fonte.[NPS]\n\n    \t\t\t,destino.[\u00c9 A Tribo do MOP?]\t\t\t\t= fonte.[\u00c9 A Tribo do MOP?]\n    \t\t\t,destino.[Teve Evento de MOP?]\t\t\t\t= fonte.[Teve Evento de MOP?]\n    \t\t\t,destino.[Teve Evento de Tickets?]\t\t\t= fonte.[Teve Evento de Tickets?]\n    \t\t\t,destino.[Teve Evento de Chamadas?]\t\t\t= fonte.[Teve Evento de Chamadas?]\n    \t\t\t,destino.[Teve Evento de NPS?]\t\t\t\t= fonte.[Teve Evento de NPS?]\n    \t\t\t,destino.[Teve Evento de Log?]\t\t\t\t= fonte.[Teve Evento de Log?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_individuo_m\u00eas\n        WHERE   [\u00c9 A Tribo do MOP?]\t\t    = 0\n    \t    AND\t[Teve Evento de MOP?]\t    = 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n    IF 1=1 BEGIN; PRINT '--- agrupamento tribo_30min';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_tribo_30min]\n    \t\tWHERE [DataHora] >= @datahora_inicio\n    \t\tAND\t  [DataHora] <= @datahora_fim\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n            SELECT\n                 [Ader\u00eancia Log 102%]               =   [Log 102%] / NULLIF([Forecast Log],0)\n                ,[Ader\u00eancia Log Produtivo 102%]     =   [Log Produtivo 102%] / NULLIF([Forecast Log Produtivo],0)\n                ,[Log Perdido (>102%)]              =   [Log] - [Log 102%]\n                ,[Log Produtivo Perdido (>102%)]    =   [Log Produtivo] - [Log Produtivo 102%]\n                ,*\n            FROM (\n                SELECT\n                     [Ader\u00eancia Log]                    =   [Log] / NULLIF([Forecast Log],0)\n                    ,[Ader\u00eancia Log Produtivo]          =   [Log Produtivo] / NULLIF([Forecast Log Produtivo],0)\n                    ,[Log 102%]                         =   IIF([Log] > [Forecast Log] * 1.2, [Forecast Log] * 1.2, [Log])\n                    ,[Log Produtivo 102%]               =   IIF([Log Produtivo] > [Forecast Log Produtivo] * 1.2, [Forecast Log Produtivo] * 1.2, [Log Produtivo])\n                    ,[Ader\u00eancia TMT]                    =   [TMT] / NULLIF([Forecast TMT],0)\n                    ,[Ader\u00eancia TMA]                    =   COALESCE([Inbound - TMA], [Outbound - TMA]) / NULLIF([Forecast TMA],0)\n                    ,[Ader\u00eancia SLA]                    =   [SLA TPR] / NULLIF([Forecast SLA],0)\n                    ,[Ader\u00eancia NS]                     =   [Inbound - % Nivel de Servi\u00e7o] / NULLIF([Forecast NS],0)\n                    --,[Ader\u00eancia NPS]                    =   [NPS] / NULLIF([Forecast NPS],0)\n                    ,[Ader\u00eancia Abandono]               =   [Inbound - % Abandono] / NULLIF([Forecast Abandono],0)\n                    ,[Ader\u00eancia Casos N\u00e3o Resolvidos]   =   [N\u00e3o Resolvidos] / NULLIF([Forecast Casos N\u00e3o Resolvidos],0)\n                    ,*\n                FROM (\n                \tSELECT\n\n                         [DataHora]\t\t\t\t\t\t\t\t\t\t\t\t        =   COALESCE([DataHora], [f_DataHora])\n                        ,[Intervalo]\t\t\t\t\t\t\t\t\t\t\t        =   MIN([Intervalo])\n                        ,[Data]\t\t\t\t\t\t\t\t\t\t\t\t\t        =   MIN([Data])\n                        ,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t\t\t\t        =   MIN([Ciclo (Primeiro Dia)])\n                        ,[M\u00eas (Primeiro Dia)]\t\t\t\t                            =   MIN([M\u00eas (Primeiro Dia)])\n\n                        ,[Feriado (Nome)]                                               =  MAX([Feriado (Nome)])\n\n       \t                ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(SUM([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t                ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(SUM([Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t                ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(SUM([Secullum - Servi\u00e7o Militar]                                   ),0)\n                        ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(SUM([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t                ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t                ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t                ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(SUM([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t                ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(SUM([Secullum - Licen\u00e7a Casamento]                                 ),0)\n                        ,[Secullum - INSS - Afastamento]                                    =   ISNULL(SUM([Secullum - INSS - Afastamento]                                ),0)\n                        ,[Secullum - Folga]                                                 =   ISNULL(SUM([Secullum - Folga]                                             ),0)\n                        ,[Secullum - F\u00e9rias]                                                =   ISNULL(SUM([Secullum - F\u00e9rias]                                            ),0)\n       \t                ,[Secullum - Feriado]                                               =   ISNULL(SUM([Secullum - Feriado]                                           ),0)\n       \t                ,[Secullum - Falta Justificada]                                     =   ISNULL(SUM([Secullum - Falta Justificada]                                 ),0)\n       \t                ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(SUM([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                        ,[Secullum - Falta Injustificada]                                   =   ISNULL(SUM([Secullum - Falta Injustificada]                               ),0)\n       \t                ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(SUM([Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t                ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(SUM([Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                        ,[Secullum - Desligue]                                              =   ISNULL(SUM([Secullum - Desligue]                                          ),0)\n       \t                ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(SUM([Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t                ,[Secullum - Compensando Horas]                                     =   ISNULL(SUM([Secullum - Compensando Horas]                                 ),0)\n       \t                ,[Secullum - Atestado]                                              =   ISNULL(SUM([Secullum - Atestado]                                          ),0)\n                        ,[Secullum - Abono]                                                 =   ISNULL(SUM([Secullum - Abono]                                             ),0)\n       \t                ,[Secullum - Abono Lactante]                                        =   ISNULL(SUM([Secullum - Abono Lactante]                                    ),0)\n       \t                ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(SUM([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t                ,[Faltas Justificadas]                                              =   ISNULL(SUM([Faltas Justificadas]                                          ),0)\n       \t                ,[Faltas Injustificadas]                                            =   ISNULL(SUM([Faltas Injustificadas]                                        ),0)\n\n                        ,[Cliente]\t\t\t\t\t\t\t                            =   MIN([Cliente])\n                        ,[Projeto]\t\t\t\t\t\t\t                            =   MIN([Projeto])\n                        ,[Tribo]\t\t\t\t\t\t\t                            =   MIN([Tribo])\n                        ,[Tribo Completa]\t\t\t\t\t                            =   COALESCE([Tribo Completa], [f_Tribo Completa])\n\n                        ,[Trabalhado (Ponto)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Trabalhado (Ponto)]),0)\n                        ,[Em Pausa (Ponto)]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Em Pausa (Ponto)]),0)\n\t\t\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Desvio Ponto-Log]),0)\n\n                        ,[Forecast HC Taxa 1]                                           =   MAX(f.[Forecast HC Taxa 1])\n                        ,[Forecast HC Taxa 2]                                           =   MAX(f.[Forecast HC Taxa 2])\n                        ,[Forecast Pausas Taxa 1]                                       =   MAX(f.[Forecast Pausas Taxa 1])\n                        ,[Forecast Pausas Taxa 2]                                       =   MAX(f.[Forecast Pausas Taxa 2])\n                        ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                     =   MAX(f.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio])\n                        ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                 =   MAX(f.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio])\n                        ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t                    =   MAX(f.[Forecast PA Liquida (VOZ) - Provis\u00f3rio])\n                        ,[Forecast Volume]\t\t                                        =   MAX(f.[Forecast Volume])\n                        --,[Forecast Volume M\u00eas - Provis\u00f3rio]                           =\n                        ,[Forecast Log]                                                 =   (MAX(f.[Forecast HC Taxa 1]) * 1800) + (MAX(f.[Forecast HC Taxa 2]) * 1800)\n                        ,[Forecast Log Produtivo]                                       =   (MAX(f.[Forecast HC Taxa 1]) * 1800 * (1-MAX(f.[Forecast Pausas Taxa 1]))) + (MAX(f.[Forecast HC Taxa 2]) * 1800 * (1-MAX(f.[Forecast Pausas Taxa 2])))\n                        ,[Forecast NS]                                                  =   MAX(f.[Forecast NS])\n                        --,[Forecast NS M\u00eas - Provis\u00f3rio]                               =\n\n                        ,[Forecast TMT]                                                 =   MAX(f.[Forecast TMT])\n                        ,[Forecast TMA]                                                 =   MAX(f.[Forecast TMA])\n                        ,[Forecast SLA]                                                 =   MAX(f.[Forecast SLA])\n                        ,[Forecast Abandono]                                            =   MAX(m.[Forecast Abandono])\n                        ,[Forecast NPS]                                                 =   MAX(m.[Forecast NPS])\n                        ,[Forecast Casos N\u00e3o Resolvidos]                                =   MAX(m.[Forecast Casos N\u00e3o Resolvidos])\n                        ,[Forecast Rechamada]                                           =   MAX(m.[Forecast Rechamada])\n                        ,[Forecast Short Call]                                          =   MAX(m.[Forecast Short Call])\n                        ,[Forecast Instabilidade]                                       =   MAX(m.[Forecast Instabilidade])\n                        ,[Forecast Phishing]                                            =   MAX(m.[Forecast Phishing])\n\n                        --UP--,[Ader\u00eancia Log]                                          =\n                        --UP--,[Ader\u00eancia Log 102%]                                     =\n                        --UP--,[Ader\u00eancia Log Produtivo]                                =\n                        --UP--,[Ader\u00eancia Log Produtivo 102%]                           =\n                        --UP--,[Ader\u00eancia TMT]                                          =\n                        --UP--,[Ader\u00eancia TMA]                                          =\n                        --UP--,[Ader\u00eancia SLA]                                          =\n                        --UP--,[Ader\u00eancia NS]                                           =\n                        --UP--,[Ader\u00eancia Abandono]                                     =\n                        --UP--,[Ader\u00eancia NPS]                                          =\n                        --UP--,[Ader\u00eancia Casos N\u00e3o Resolvidos]                         =\n                        --,[Ader\u00eancia Rechamada]                                        =\n                        --,[Ader\u00eancia Short Call]                                       =\n                        --,[Ader\u00eancia Instabilidade]                                    =\n                        --,[Ader\u00eancia Phishing]                                         =\n\n                        --,[Penalidade TMT]                                             =\n                        --,[Penalidade TMA]                                             =\n                        --,[Penalidade SLA]                                             =\n                        --,[Penalidade NS]                                              =\n                        --,[Penalidade Abandono]                                        =\n                        --,[Penalidade NPS]                                             =\n                        --,[Penalidade Casos N\u00e3o Resolvidos]                            =\n                        --,[Penalidade Rechamada]                                       =\n                        --,[Penalidade Short Call]                                      =\n                        --,[Penalidade Instabilidade]                                   =\n                        --,[Penalidade Phishing]                                        =\n\n                        --,[PAs Contratadas]                                            =\n                        --,[Valor da PA]                                                =\n                        --,[Faturamento Antes das Penalidades]                          =\n                        --,[Faturamento Ap\u00f3s Penalidades]                               =\n\n                        ,[Log]\t\t\t\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log]),0)\n                        -- UP --,[Log 102%]\n                        -- UP --,[Log Perdido (>102%)]\n                        ,[Log Produtivo]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log Produtivo]),0)\n                        -- UP --,[Log Produtivo 102%]\n                        -- UP --,[Log Produtivo Perdido (>102%)]\n                        ,[Log HE]\t\t\t\t\t\t\t\t\t\t\t\t\t    =   ISNULL(SUM([Log HE]),0)\n                        ,[Log descartado (>2HE)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log descartado (>2HE)]),0)\n                        ,[Log Improdutivo]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log Improdutivo]),0)\n                        ,[Tempo Livre]\t\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Tempo Livre]),0)\n                        ,[Pausa Particular (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Particular (Intelix)]),0)\n                        ,[Pausa Break (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Break (Intelix)]),0)\n                        ,[Pausa 10 (Intelix)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa 10 (Intelix)]),0)\n                        ,[Pausa Outbound (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Outbound (Intelix)]),0)\n                        ,[Pausa Lanche (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Lanche (Intelix)]),0)\n                        ,[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa R\u00e1pida (Intelix)]),0)\n                        ,[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (Intelix)]),0)\n                        ,[Pausa Feedback (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (Intelix)]),0)\n                        ,[Pausa Sistema Interno (Intelix)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (Intelix)]),0)\n                        ,[Pausa Sistema Externo (Intelix)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (Intelix)]),0)\n                        ,[Pausa Treinamento (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (Intelix)]),0)\n                        ,[Pausa Banheiro (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (Intelix)]),0)\n                        ,[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Reuni\u00e3o (Intelix)]),0)\n                        ,[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (Intelix)]),0)\n                        ,[Pausa NR17 (Intelix)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa NR17 (Intelix)]),0)\n                        ,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Liga\u00e7\u00e3o (EPBX)]),0)\n                        ,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (EPBX)]),0)\n                        ,[Pausa Tratativa (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Tratativa (EPBX)]),0)\n                        ,[Pausa Discagem Manual (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Manual (EPBX)]),0)\n                        ,[Pausa Banheiro (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (EPBX)]),0)\n                        ,[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa WhatsApp (EPBX)]),0)\n                        ,[Pausa Intervalo (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Intervalo (EPBX)]),0)\n                        ,[Pausa Discagem Retorno (EPBX)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Retorno (EPBX)]),0)\n                        ,[Pausa Treinamento (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (EPBX)]),0)\n                        ,[Pausa Feedback (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (EPBX)]),0)\n                        ,[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Transfer\u00eancia (EPBX)]),0)\n                        ,[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa N\u00e3o Disponivel (EPBX)]),0)\n                        ,[Pausa Login (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Login (EPBX)]),0)\n                        ,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Reuni\u00e3o (EPBX)]),0)\n                        ,[Pausa Sistema Interno (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (EPBX)]),0)\n                        ,[Pausa Sistema Externo (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (EPBX)]),0)\n                        ,[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa NR17 (EPBX)]),0)\n                        ,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (EPBX)]),0)\n                        ,[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa P\u00f3s Atendimento (EPBX)]),0)\n                        ,[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Lanche (EPBX)]),0)\n                        ,[Pausa BackOffice (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa BackOffice (EPBX)]),0)\n                        ,[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (Genesys)]),0)\n                        ,[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (Genesys)]),0)\n                        ,[Pausa Banheiro (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (Genesys)]),0)\n                        ,[Pausa Descanso (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Descanso (Genesys)]),0)\n                        ,[Pausa Feedback (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (Genesys)]),0)\n                        ,[Pausa Backoffice (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Backoffice (Genesys)]),0)\n                        ,[Pausa Discagem Manual (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Manual (Genesys)]),0)\n                        ,[Pausa Discagem Retorno (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Retorno (Genesys)]),0)\n                        ,[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Dispon\u00edvel (Genesys)]),0)\n                        ,[Pausa Em Fila (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Em Fila (Genesys)]),0)\n                        ,[Pausa Sistema Externo (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (Genesys)]),0)\n                        ,[Pausa Sistema Interno (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (Genesys)]),0)\n                        ,[Pausa Tratativa (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Tratativa (Genesys)]),0)\n                        ,[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Whatsapp (Genesys)]),0)\n                        ,[Pausa Treinamento (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (Genesys)]),0)\n\n                        ,[Criados]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Criados]),0)\n                        ,[Tratados]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Tratados]),0)\n                        ,[Tempo Total de Tratativa]\t\t\t                            =   ISNULL(SUM([Tempo Total de Tratativa]),0)\n                        ,[TMT]\t\t\t\t\t\t\t\t                            =   ISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n                        ,[N\u00e3o Resolvidos]\t\t\t\t\t                            =   ISNULL(SUM([N\u00e3o Resolvidos]),0)\n                        ,[Replicas]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Replicas]),0)\n                        ,[Reincidentes 48h]\t\t\t\t\t                            =   ISNULL(SUM([Reincidentes 48h]),0)\n                        ,[Reincidentes 30d]\t\t\t\t\t                            =   ISNULL(SUM([Reincidentes 30d]),0)\n\n                        ,[SLA TPR]                                                      =   AVG([SLA TPR])\n                        ,[SLA TES]                                                      =   AVG([SLA TES])\n                        ,[SLA TTR]                                                      =   AVG([SLA TTR])\n\n                        ,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Iniciadas]),0)\n                        ,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas]),0)\n                        ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s]),0)\n                        ,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Em Andamento]),0)\n                        ,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Finalizadas]),0)\n                        ,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Transferidas]),0)\n                        ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=   ISNULL(SUM([Inbound - Tempo Em Chamada (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=   ISNULL(SUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=   ISNULL(SUM([Inbound - Tempo Em Espera (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=   ISNULL(SUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Chamada (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Atendimento (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Espera (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Encerramento (Neste Intervalo)]),0)\n                        ,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Iniciados]),0)\n                        ,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Em Andamento]),0)\n                        ,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Finalizados]),0)\n                        ,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n                        ,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n                        ,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n                        ,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n                        ,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n                        ,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Abandonadas]),0)\n                        ,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n                        ,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Iniciadas]),0)\n                        ,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas]),0)\n                        ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s]),0)\n                        ,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Em Andamento]),0)\n                        ,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Finalizadas]),0)\n                        ,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Transferidas]),0)\n                        ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=   ISNULL(SUM([Outbound - Tempo Em Chamada (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=   ISNULL(SUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=   ISNULL(SUM([Outbound - Tempo Em Espera (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=   ISNULL(SUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Chamada (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Atendimento (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Espera (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Encerramento (Neste Intervalo)]),0)\n                        ,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Iniciados]),0)\n                        ,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Em Andamento]),0)\n                        ,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Finalizados]),0)\n                        ,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n                        ,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n                        ,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n                        ,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n                        ,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n                        ,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Abandonadas]),0)\n                        ,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n                        ,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t                            =   ISNULL(SUM([Avalia\u00e7\u00f5es de NPS]),0)\n                        ,[Promotoras]\t\t\t\t\t\t                            =   ISNULL(SUM([Promotoras]),0)\n                        ,[Neutras]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Neutras]),0)\n                        ,[Detratoras]\t\t\t\t\t\t                            =   ISNULL(SUM([Detratoras]),0)\n                          --,[NPS]\t\t\t\t\t\t\t\t                        =   CAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n                        ,[Teve Evento de MOP?]\t\t                                    =   IIF(SUM([Teve Evento de MOP?])=0,0,1)\n                        ,[Teve Evento de Tickets?]\t                                    =   IIF(SUM([Teve Evento de Tickets?])=0,0,1)\n                        ,[Teve Evento de Chamadas?]\t                                    =   IIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n                        ,[Teve Evento de NPS?]\t\t                                    =   IIF(SUM([Teve Evento de NPS?])=0,0,1)\n                        ,[Teve Evento de Log?]\t\t                                    =   IIF(SUM([Teve Evento de Log?])=0,0,1)\n                        ,[Teve Evento de Forecast?]\t\t                                =   IIF(SUM([Teve Evento de Forecast?]) IS NULL,0,1)\n\n                \tFROM r_individuo_30min r\n                    FULL OUTER JOIN (\n                        SELECT\n                        \t [f_Datahora]\t\t\t                            =\t[datahora]\n                        \t,[f_Tribo Completa]\t                                =\tCASE [tribo]\n                        \t\t\t\t\t\t                                \t\tWHEN '0800 Premium'\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n                        \t\t\t\t\t\t                                \t\tWHEN 'BackOffice'\t\t\t\t\t\tTHEN 'Serasa__Voz__BackOffice'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Cadastro Positivo'\t\t\t\tTHEN 'Serasa__Voz__Cadastro Positivo'\n                        \t\t\t\t\t\t                                \t\tWHEN 'SAC'\t\t\t\t\t\t\t\tTHEN 'Serasa__Voz__SAC'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Central de Ajuda'\t\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Central de Ajuda - Autentica\u00e7\u00e3o'\tTHEN 'Serasa__Digital__Central de Ajuda - Autentica\u00e7\u00e3o'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Central de Ajuda - Produtos'\t\tTHEN 'Serasa__Digital__Central de Ajuda - Produtos'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Chat'\t\t\t\t\t\t\t\tTHEN 'Serasa__Digital__Chat'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Facebook e Lojas'\t\t\t\t\tTHEN 'Serasa__Digital__Facebook e Lojas'\n                        \t\t\t\t\t\t                                \t\tWHEN 'GOV'\t\t\t\t\t\t\t\tTHEN 'Serasa__Digital__GOV'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Reclame Aqui'\t\t\t\t\t\tTHEN 'Serasa__Digital__Reclame Aqui'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Self Setup'\t\t\t\t\t\tTHEN 'Serasa__Digital__Self Setup'\n                        \t\t\t\t\t\t                                \t\tWHEN 'Serasa na Estrada'\t\t\t\tTHEN 'Serasa__Digital__Serasa na Estrada'\n                        \t\t\t\t\t\t                                \t\tELSE '____'\n                        \t\t\t\t\t\t                                \tEND\n                        \t,[Forecast Volume]\t\t                            =   [volume]\n                        \t,[Forecast TMT]                                     =   [tmt]\n                        \t,[Forecast TMA]                                     =   [tma]\n                        \t,[Forecast NS]                                      =   [ns]\n                        \t,[Forecast SLA]                                     =   [sla]\n                        \t,[Forecast HC Taxa 1]                               =   [hc_tx1]\n                        \t,[Forecast HC Taxa 2]                               =   [hc_tx2]/2\n                        \t,[Forecast Pausas Taxa 1]                           =   [pausas_tx1]\n                        \t,[Forecast Pausas Taxa 2]                           =   [pausas_tx2]\n                        \t,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]         =   [Pausa Almo\u00e7o (%) (VOZ)]\n                        \t,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]     =\t[Agentes em Pausa (VOZ)]\n                        \t,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t\t    =   [PA Liquida (VOZ)]\n                            --,[Forecast Log]                                     =   ([hc_tx1] * 1800) + ([hc_tx2] * 1800)\n                            --,[Forecast Log Produtivo]                           =   ([hc_tx1] * 1800 * (1-[hc_tx2])) + ([pausas_tx2] * 1800 * (1-[pausas_tx2]))\n                            ,[Teve Evento de Forecast?]                         =   1\n                        FROM [db_Serasa_producao].[dbo].dim_forecast_30min\n                    ) f\n                    ON  r.[DataHora] = f.[f_DataHora]\n                    AND r.[Tribo Completa] = f.[f_Tribo Completa]\n\n                    FULL OUTER JOIN (\n                        SELECT\n                         [m_Tribo]  = [tribo]\n                        ,[m_M\u00eas]    = [m\u00eas]\n                        ,[Forecast Volume M\u00eas - Provis\u00f3rio] = [volume_projetado] -- S\u00f3 pra valida\u00e7\u00e3o, pra ver se t\u00e1 batendo com a dim_forecast_30min\n                        ,[Forecast NS M\u00eas - Provis\u00f3rio] = [NS]\n                        ,[Forecast TMT] = IIF([tribo] in ('Central de Ajuda - Autentica\u00e7\u00e3o', 'Central de Ajuda - Produtos', 'Reclame Aqui', 'GOV', 'Self Setup', 'BackOffice', 'Chat', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                        ,[Forecast TMA] = IIF([tribo] in ('BackOffice', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                        ,[Forecast SLA] = [SLA]\n                        ,[Forecast Abandono] = [abandono]\n                        ,[Forecast NPS] = [NPS]\n                        ,[Forecast Casos N\u00e3o Resolvidos] = [casos_n\u00e3o_resolvidos]\n                        ,[Forecast Rechamada] = [rechamada]\n                        ,[Forecast Short Call] = [short_call]\n                        ,[Forecast Instabilidade] = [instabilidade]\n                        ,[Forecast Phishing] = [phishing]\n                        --,[Forecast HC Taxa 1] = [hc_tx1]\n                        --,[Forecast HC Taxa 2] = [hc_tx2]\n                        ,[PAs Contratadas] = [hc_tx1] + [hc_tx2]\n                        ,[Valor da PA] = [valor_pa]\n                        FROM (\n                            SELECT [n]=ROW_NUMBER() OVER (PARTITION BY [tribo], [m\u00eas] ORDER BY [data_recebimento]), *\n                            FROM [db_serasa_producao].[dbo].dim_forecast_metas\n                        ) _\n                        WHERE [n] = 1\n                    ) m\n                    ON  r.[Tribo] = m.[m_tribo]\n                    AND r.[M\u00eas (Primeiro Dia)] = m.[m_m\u00eas]\n\n                    LEFT JOIN (\n                        SELECT\n                         [m_Tribo]  = [tribo_serasa]\n                        ,[m_Data]   = [data]\n                        ,[SLA TPR]  = AVG([primeira_resposta_s])\n                        ,[SLA TES]  = AVG([espera_solicitante_s])\n                        ,[SLA TTR]  = AVG([total_resolucao_s])\n                        FROM [db_serasa_producao].[dbo].dim_teste_sla\n                        GROUP BY [tribo_serasa], [data]\n                    ) s\n                    ON  r.[Tribo] = s.[m_Tribo]\n                    AND r.[Data] = s.[m_Data]\n\n                \tWHERE COALESCE([DataHora],[f_DataHora]) >= @datahora_inicio\n                \tAND\t  COALESCE([DataHora],[f_DataHora]) <= @datahora_fim\n                \tGROUP BY COALESCE([DataHora],[f_DataHora]), COALESCE([Tribo Completa], [f_Tribo Completa])\n                ) r\n                LEFT JOIN (\n                    SELECT\n                         [p_DataHora]                                       =   [In\u00edcio do Intervalo]\n                        ,[p_Tribo Completa]                                 =   CASE [Nome da Fila]\n                                                                                    WHEN 'S_SAC' THEN 'Serasa__Voz__SAC'\n                                                                                    WHEN 'S_CADASTRO_POSITIVO' THEN 'Serasa__Voz__Cadastro Positivo'\n                                                                                    WHEN 'S_PREMIUM' THEN 'Serasa__Voz__0800 Premium'\n                                                                                END\n                        ,[Genesys Provis\u00f3rio - Oferta]                      =   TRY_CAST([Oferta] AS int)\n                        ,[Genesys Provis\u00f3rio - Resposta]                    =   TRY_CAST([Resposta] AS int)\n                        ,[Genesys Provis\u00f3rio - Em Espera]                   =   TRY_CAST([Em Espera] AS int)\n                        ,[Genesys Provis\u00f3rio - Transferir]                  =   TRY_CAST([Transferir] AS int)\n                        ,[Genesys Provis\u00f3rio - Abandono]                    =   TRY_CAST([Abandono] AS int)\n                        ,[Genesys Provis\u00f3rio - % Resposta]                  =   TRY_CAST([% de resposta] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - % Abandono]                  =   TRY_CAST([% de abandono] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - % NS]                        =   TRY_CAST([% de n\u00ed\u00advel de servi\u00e7o] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - % Alvos do NS]               =   TRY_CAST([% de alvos do n\u00edvel de servi\u00e7o] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]     =   TRY_CAST([Conversa\u00e7\u00e3o m\u00e9dia] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)] =   TRY_CAST([Tempo m\u00e9dio de espera] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]      =   TRY_CAST([Tratamento m\u00e9dio] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - VMA]                         =   TRY_CAST([VMA] AS decimal(18,4))\n                        ,[Genesys Provis\u00f3rio - TPC]                         =   TRY_CAST([TPC m\u00e9dio] AS decimal(18,4))\n                    FROM [db_Serasa_producao].[dbo].dim_chamadas_genesys_manual\n                ) p\n                ON  r.[DataHora] = p.[p_DataHora]\n                AND r.[Tribo Completa] = p.[p_Tribo Completa]\n            ) _\n    \t) AS fonte\n    \tON  fonte.[DataHora]  = destino.[DataHora]\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n\t\t     [DataHora]\n\t\t    ,[Intervalo]\n\t\t    ,[Data]\n\t\t    ,[Ciclo (Primeiro Dia)]\n\t\t    ,[M\u00eas (Primeiro Dia)]\n\n            ,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n\n\t\t    ,[Cliente]\n\t\t    ,[Projeto]\n\t\t    ,[Tribo]\n\t\t    ,[Tribo Completa]\n\n\t\t    ,[Trabalhado (Ponto)]\n\t\t    ,[Em Pausa (Ponto)]\n\t\t\t,[Desvio Ponto-Log]\n\n            ,[Forecast HC Taxa 1]\n            ,[Forecast HC Taxa 2]\n            ,[Forecast Pausas Taxa 1]\n            ,[Forecast Pausas Taxa 2]\n            ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,[Forecast Volume]\n            --,[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,[Forecast Log]\n            ,[Forecast Log Produtivo]\n            ,[Forecast NS]\n            --,[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,[Forecast TMT]\n            ,[Forecast TMA]\n            ,[Forecast SLA]\n            ,[Forecast Abandono]\n            ,[Forecast NPS]\n            ,[Forecast Casos N\u00e3o Resolvidos]\n            ,[Forecast Rechamada]\n            ,[Forecast Short Call]\n            ,[Forecast Instabilidade]\n            ,[Forecast Phishing]\n\n            ,[Ader\u00eancia Log]\n            ,[Ader\u00eancia Log 102%]\n            ,[Ader\u00eancia Log Produtivo]\n            ,[Ader\u00eancia Log Produtivo 102%]\n            ,[Ader\u00eancia TMT]\n            ,[Ader\u00eancia TMA]\n            ,[Ader\u00eancia SLA]\n            ,[Ader\u00eancia NS]\n            ,[Ader\u00eancia Abandono]\n            --,[Ader\u00eancia NPS]\n            ,[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,[Ader\u00eancia Rechamada]\n            --,[Ader\u00eancia Short Call]\n            --,[Ader\u00eancia Instabilidade]\n            --,[Ader\u00eancia Phishing]\n\n            --,[Penalidade TMT]\n            --,[Penalidade TMA]\n            --,[Penalidade SLA]\n            --,[Penalidade NS]\n            --,[Penalidade Abandono]\n            --,[Penalidade NPS]\n            --,[Penalidade Casos N\u00e3o Resolvidos]\n            --,[Penalidade Rechamada]\n            --,[Penalidade Short Call]\n            --,[Penalidade Instabilidade]\n            --,[Penalidade Phishing]\n\n            --,[PAs Contratadas]\n            --,[Valor da PA]\n            --,[Faturamento Antes das Penalidades]\n            --,[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,[Log]\n            ,[Log 102%]\n            ,[Log Perdido (>102%)]\n\t\t    ,[Log Produtivo]\n            ,[Log Produtivo 102%]\n            ,[Log Produtivo Perdido (>102%)]\n\t\t    ,[Log HE]\n\t\t    ,[Log descartado (>2HE)]\n\t\t    ,[Log Improdutivo]\n\t\t    ,[Tempo Livre]\n\t\t    ,[Pausa Particular (Intelix)]\n\t\t    ,[Pausa Break (Intelix)]\n\t\t    ,[Pausa 10 (Intelix)]\n\t\t    ,[Pausa Outbound (Intelix)]\n\t\t    ,[Pausa Lanche (Intelix)]\n\t\t    ,[Pausa R\u00e1pida (Intelix)]\n\t\t    ,[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,[Pausa Feedback (Intelix)]\n\t\t    ,[Pausa Sistema Interno (Intelix)]\n\t\t    ,[Pausa Sistema Externo (Intelix)]\n\t\t    ,[Pausa Treinamento (Intelix)]\n\t\t    ,[Pausa Banheiro (Intelix)]\n\t\t    ,[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,[Pausa NR17 (Intelix)]\n\t\t    ,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,[Pausa Tratativa (EPBX)]\n\t\t    ,[Pausa Discagem Manual (EPBX)]\n\t\t    ,[Pausa Banheiro (EPBX)]\n\t\t    ,[Pausa WhatsApp (EPBX)]\n\t\t    ,[Pausa Intervalo (EPBX)]\n\t\t    ,[Pausa Discagem Retorno (EPBX)]\n\t\t    ,[Pausa Treinamento (EPBX)]\n\t\t    ,[Pausa Feedback (EPBX)]\n\t\t    ,[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,[Pausa Login (EPBX)]\n\t\t    ,[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,[Pausa Sistema Interno (EPBX)]\n\t\t    ,[Pausa Sistema Externo (EPBX)]\n\t\t    ,[Pausa NR17 (EPBX)]\n\t\t    ,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,[Pausa Lanche (EPBX)]\n\t\t    ,[Pausa BackOffice (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,[Pausa Banheiro (Genesys)]\n\t \t    ,[Pausa Descanso (Genesys)]\n\t \t    ,[Pausa Feedback (Genesys)]\n\t \t    ,[Pausa Backoffice (Genesys)]\n\t \t    ,[Pausa Discagem Manual (Genesys)]\n\t \t    ,[Pausa Discagem Retorno (Genesys)]\n\t \t    ,[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,[Pausa Em Fila (Genesys)]\n\t \t    ,[Pausa Sistema Externo (Genesys)]\n\t \t    ,[Pausa Sistema Interno (Genesys)]\n\t \t    ,[Pausa Tratativa (Genesys)]\n\t \t    ,[Pausa Whatsapp (Genesys)]\n\t\t    ,[Pausa Treinamento (Genesys)]\n\n\t\t    ,[Criados]\n\t\t    ,[Tratados]\n\t\t    ,[Tempo Total de Tratativa]\n\t\t    ,[TMT]\n\t\t    ,[N\u00e3o Resolvidos]\n\t\t    ,[Replicas]\n\t\t    ,[Reincidentes 48h]\n\t\t    ,[Reincidentes 30d]\n\n            ,[SLA TPR]\n            ,[SLA TES]\n            ,[SLA TTR]\n\n\t\t    ,[Inbound - Chamadas Iniciadas]\n\t\t    ,[Inbound - Chamadas Atendidas]\n\t\t    ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Inbound - Chamadas Em Andamento]\n\t\t    ,[Inbound - Chamadas Finalizadas]\n\t\t    ,[Inbound - Chamadas Transferidas]\n\t\t    ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Inbound - Atendimentos Iniciados]\n\t\t    ,[Inbound - Atendimentos Em Andamento]\n\t\t    ,[Inbound - Atendimentos Finalizados]\n\t\t    ,[Inbound - TMC]\n\t\t    ,[Inbound - TMA]\n\t\t    ,[Inbound - TME]\n\t\t    ,[Inbound - TMO]\n\t\t    ,[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Inbound - Chamadas Abandonadas]\n\t\t    ,[Inbound - % Abandono]\n\n\t\t    ,[Outbound - Chamadas Iniciadas]\n\t\t    ,[Outbound - Chamadas Atendidas]\n\t\t    ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Outbound - Chamadas Em Andamento]\n\t\t    ,[Outbound - Chamadas Finalizadas]\n\t\t    ,[Outbound - Chamadas Transferidas]\n\t\t    ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Outbound - Atendimentos Iniciados]\n\t\t    ,[Outbound - Atendimentos Em Andamento]\n\t\t    ,[Outbound - Atendimentos Finalizados]\n\t\t    ,[Outbound - TMC]\n\t\t    ,[Outbound - TMA]\n\t\t    ,[Outbound - TME]\n\t\t    ,[Outbound - TMO]\n\t\t    ,[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Outbound - Chamadas Abandonadas]\n\t\t    ,[Outbound - % Abandono]\n\n\t\t    ,[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,[Promotoras]\n\t\t    ,[Neutras]\n\t\t    ,[Detratoras]\n            --,[NPS]\n\n            ,[Genesys Provis\u00f3rio - Oferta]\n            ,[Genesys Provis\u00f3rio - Resposta]\n            ,[Genesys Provis\u00f3rio - Em Espera]\n            ,[Genesys Provis\u00f3rio - Transferir]\n            ,[Genesys Provis\u00f3rio - Abandono]\n            ,[Genesys Provis\u00f3rio - % Resposta]\n            ,[Genesys Provis\u00f3rio - % Abandono]\n            ,[Genesys Provis\u00f3rio - % NS]\n            ,[Genesys Provis\u00f3rio - % Alvos do NS]\n            ,[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]\n            ,[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)]\n            ,[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]\n            ,[Genesys Provis\u00f3rio - VMA]\n            ,[Genesys Provis\u00f3rio - TPC]\n\n\t\t    ,[Teve Evento de MOP?]\n\t\t    ,[Teve Evento de Tickets?]\n\t\t    ,[Teve Evento de Chamadas?]\n\t\t    ,[Teve Evento de NPS?]\n\t\t    ,[Teve Evento de Log?]\n\t\t    ,[Teve Evento de Forecast?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n\t\t     fonte.[DataHora]\n\t\t    ,fonte.[Intervalo]\n\t\t    ,fonte.[Data]\n\t\t    ,fonte.[Ciclo (Primeiro Dia)]\n\t\t    ,fonte.[M\u00eas (Primeiro Dia)]\n\n            ,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n\t\t    ,fonte.[Cliente]\n\t\t    ,fonte.[Projeto]\n\t\t    ,fonte.[Tribo]\n\t\t    ,fonte.[Tribo Completa]\n\n\t\t    ,fonte.[Trabalhado (Ponto)]\n\t\t    ,fonte.[Em Pausa (Ponto)]\n\t\t\t,fonte.[Desvio Ponto-Log]\n\n            ,fonte.[Forecast HC Taxa 1]\n            ,fonte.[Forecast HC Taxa 2]\n            ,fonte.[Forecast Pausas Taxa 1]\n            ,fonte.[Forecast Pausas Taxa 2]\n            ,fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Volume]\n            --,fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,fonte.[Forecast Log]\n            ,fonte.[Forecast Log Produtivo]\n            ,fonte.[Forecast NS]\n            --,fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,fonte.[Forecast TMT]\n            ,fonte.[Forecast TMA]\n            ,fonte.[Forecast SLA]\n            ,fonte.[Forecast Abandono]\n            ,fonte.[Forecast NPS]\n            ,fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,fonte.[Forecast Rechamada]\n            ,fonte.[Forecast Short Call]\n            ,fonte.[Forecast Instabilidade]\n            ,fonte.[Forecast Phishing]\n\n            ,fonte.[Ader\u00eancia Log]\n            ,fonte.[Ader\u00eancia Log 102%]\n            ,fonte.[Ader\u00eancia Log Produtivo]\n            ,fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,fonte.[Ader\u00eancia TMT]\n            ,fonte.[Ader\u00eancia TMA]\n            ,fonte.[Ader\u00eancia SLA]\n            ,fonte.[Ader\u00eancia NS]\n            ,fonte.[Ader\u00eancia Abandono]\n            --,fonte.[Ader\u00eancia NPS]\n            ,fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,fonte.[Ader\u00eancia Rechamada]\n            --,fonte.[Ader\u00eancia Short Call]\n            --,fonte.[Ader\u00eancia Instabilidade]\n            --,fonte.[Ader\u00eancia Phishing]\n\n            --,fonte.[Penalidade TMT]\n            --,fonte.[Penalidade TMA]\n            --,fonte.[Penalidade SLA]\n            --,fonte.[Penalidade NS]\n            --,fonte.[Penalidade Abandono]\n            --,fonte.[Penalidade NPS]\n            --,fonte.[Penalidade Casos N\u00e3o Resolvidos]\n            --,fonte.[Penalidade Rechamada]\n            --,fonte.[Penalidade Short Call]\n            --,fonte.[Penalidade Instabilidade]\n            --,fonte.[Penalidade Phishing]\n\n            --,fonte.[PAs Contratadas]\n            --,fonte.[Valor da PA]\n            --,fonte.[Faturamento Antes das Penalidades]\n            --,fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,fonte.[Log]\n            ,fonte.[Log 102%]\n            ,fonte.[Log Perdido (>102%)]\n\t\t    ,fonte.[Log Produtivo]\n            ,fonte.[Log Produtivo 102%]\n            ,fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,fonte.[Log HE]\n\t\t    ,fonte.[Log descartado (>2HE)]\n\t\t    ,fonte.[Log Improdutivo]\n\t\t    ,fonte.[Tempo Livre]\n\t\t    ,fonte.[Pausa Particular (Intelix)]\n\t\t    ,fonte.[Pausa Break (Intelix)]\n\t\t    ,fonte.[Pausa 10 (Intelix)]\n\t\t    ,fonte.[Pausa Outbound (Intelix)]\n\t\t    ,fonte.[Pausa Lanche (Intelix)]\n\t\t    ,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,fonte.[Pausa Feedback (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,fonte.[Pausa NR17 (Intelix)]\n\t\t    ,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,fonte.[Pausa Feedback (EPBX)]\n\t\t    ,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,fonte.[Pausa Login (EPBX)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,fonte.[Pausa NR17 (EPBX)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,fonte.[Pausa Lanche (EPBX)]\n\t\t    ,fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,fonte.[Pausa Descanso (Genesys)]\n\t \t    ,fonte.[Pausa Feedback (Genesys)]\n\t \t    ,fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,fonte.[Criados]\n\t\t    ,fonte.[Tratados]\n\t\t    ,fonte.[Tempo Total de Tratativa]\n\t\t    ,fonte.[TMT]\n\t\t    ,fonte.[N\u00e3o Resolvidos]\n\t\t    ,fonte.[Replicas]\n\t\t    ,fonte.[Reincidentes 48h]\n\t\t    ,fonte.[Reincidentes 30d]\n\n            ,fonte.[SLA TPR]\n            ,fonte.[SLA TES]\n            ,fonte.[SLA TTR]\n\n\t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Inbound - TMC]\n\t\t    ,fonte.[Inbound - TMA]\n\t\t    ,fonte.[Inbound - TME]\n\t\t    ,fonte.[Inbound - TMO]\n\t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Inbound - % Abandono]\n\n\t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Outbound - TMC]\n\t\t    ,fonte.[Outbound - TMA]\n\t\t    ,fonte.[Outbound - TME]\n\t\t    ,fonte.[Outbound - TMO]\n\t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Outbound - % Abandono]\n\n\t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,fonte.[Promotoras]\n\t\t    ,fonte.[Neutras]\n\t\t    ,fonte.[Detratoras]\n            --,fonte.[NPS]\n\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Oferta],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Resposta],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Em Espera],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Transferir],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - Abandono],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - % Resposta],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - % Abandono],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - % NS],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - % Alvos do NS],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - VMA],0)\n            ,ISNULL(fonte.[Genesys Provis\u00f3rio - TPC],0)\n\n\t\t    ,fonte.[Teve Evento de MOP?]\n\t\t    ,fonte.[Teve Evento de Tickets?]\n\t\t    ,fonte.[Teve Evento de Chamadas?]\n\t\t    ,fonte.[Teve Evento de NPS?]\n\t\t    ,fonte.[Teve Evento de Log?]\n\t\t    ,fonte.[Teve Evento de Forecast?]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n\t\t     destino.[DataHora]                                                                          = fonte.[DataHora]\n\t\t    ,destino.[Intervalo]                                                                         = fonte.[Intervalo]\n\t\t    ,destino.[Data]                                                                              = fonte.[Data]\n\t\t    ,destino.[Ciclo (Primeiro Dia)]                                                              = fonte.[Ciclo (Primeiro Dia)]\n\t\t    ,destino.[M\u00eas (Primeiro Dia)]                                                                = fonte.[M\u00eas (Primeiro Dia)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n\t\t    ,destino.[Cliente]                                                                           = fonte.[Cliente]\n\t\t    ,destino.[Projeto]                                                                           = fonte.[Projeto]\n\t\t    ,destino.[Tribo]                                                                             = fonte.[Tribo]\n\t\t    ,destino.[Tribo Completa]                                                                    = fonte.[Tribo Completa]\n\n\t\t    ,destino.[Trabalhado (Ponto)]                                                                = fonte.[Trabalhado (Ponto)]\n\t\t    ,destino.[Em Pausa (Ponto)]                                                                  = fonte.[Em Pausa (Ponto)]\n\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Desvio Ponto-Log]\n\n            ,destino.[Forecast HC Taxa 1]                                                                = fonte.[Forecast HC Taxa 1]\n            ,destino.[Forecast HC Taxa 2]                                                                = fonte.[Forecast HC Taxa 2]\n            ,destino.[Forecast Pausas Taxa 1]                                                            = fonte.[Forecast Pausas Taxa 1]\n            ,destino.[Forecast Pausas Taxa 2]                                                            = fonte.[Forecast Pausas Taxa 2]\n            ,destino.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                                          = fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                                      = fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]                                            = fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Volume]                                                                   = fonte.[Forecast Volume]\n            --,destino.[Forecast Volume M\u00eas - Provis\u00f3rio]                                                  = fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,destino.[Forecast Log]                                                                      = fonte.[Forecast Log]\n            ,destino.[Forecast Log Produtivo]                                                            = fonte.[Forecast Log Produtivo]\n            ,destino.[Forecast NS]                                                                       = fonte.[Forecast NS]\n            --,destino.[Forecast NS M\u00eas - Provis\u00f3rio]                                                      = fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,destino.[Forecast TMT]                                                                      = fonte.[Forecast TMT]\n            ,destino.[Forecast TMA]                                                                      = fonte.[Forecast TMA]\n            ,destino.[Forecast SLA]                                                                      = fonte.[Forecast SLA]\n            ,destino.[Forecast Abandono]                                                                 = fonte.[Forecast Abandono]\n            ,destino.[Forecast NPS]                                                                      = fonte.[Forecast NPS]\n            ,destino.[Forecast Casos N\u00e3o Resolvidos]                                                     = fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,destino.[Forecast Rechamada]                                                                = fonte.[Forecast Rechamada]\n            ,destino.[Forecast Short Call]                                                               = fonte.[Forecast Short Call]\n            ,destino.[Forecast Instabilidade]                                                            = fonte.[Forecast Instabilidade]\n            ,destino.[Forecast Phishing]                                                                 = fonte.[Forecast Phishing]\n\n            ,destino.[Ader\u00eancia Log]                                                                     = fonte.[Ader\u00eancia Log]\n            ,destino.[Ader\u00eancia Log 102%]                                                                = fonte.[Ader\u00eancia Log 102%]\n            ,destino.[Ader\u00eancia Log Produtivo]                                                           = fonte.[Ader\u00eancia Log Produtivo]\n            ,destino.[Ader\u00eancia Log Produtivo 102%]                                                      = fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,destino.[Ader\u00eancia TMT]                                                                     = fonte.[Ader\u00eancia TMT]\n            ,destino.[Ader\u00eancia TMA]                                                                     = fonte.[Ader\u00eancia TMA]\n            ,destino.[Ader\u00eancia SLA]                                                                     = fonte.[Ader\u00eancia SLA]\n            ,destino.[Ader\u00eancia NS]                                                                      = fonte.[Ader\u00eancia NS]\n            ,destino.[Ader\u00eancia Abandono]                                                                = fonte.[Ader\u00eancia Abandono]\n            --,destino.[Ader\u00eancia NPS]                                                                     = fonte.[Ader\u00eancia NPS]\n            ,destino.[Ader\u00eancia Casos N\u00e3o Resolvidos]                                                    = fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,destino.[Ader\u00eancia Rechamada]                                                               = fonte.[Ader\u00eancia Rechamada]\n            --,destino.[Ader\u00eancia Short Call]                                                              = fonte.[Ader\u00eancia Short Call]\n            --,destino.[Ader\u00eancia Instabilidade]                                                           = fonte.[Ader\u00eancia Instabilidade]\n            --,destino.[Ader\u00eancia Phishing]                                                                = fonte.[Ader\u00eancia Phishing]\n\n            --,destino.[Penalidade TMT]                                                                    = fonte.[Penalidade TMT]\n            --,destino.[Penalidade TMA]                                                                    = fonte.[Penalidade TMA]\n            --,destino.[Penalidade SLA]                                                                    = fonte.[Penalidade SLA]\n            --,destino.[Penalidade NS]                                                                     = fonte.[Penalidade NS]\n            --,destino.[Penalidade Abandono]                                                               = fonte.[Penalidade Abandono]\n            --,destino.[Penalidade NPS]                                                                    = fonte.[Penalidade NPS]\n            --,destino.[Penalidade Casos N\u00e3o Resolvidos]                                                   = fonte.[Penalidade Casos N\u00e3o Resolvidos]\n            --,destino.[Penalidade Rechamada]                                                              = fonte.[Penalidade Rechamada]\n            --,destino.[Penalidade Short Call]                                                             = fonte.[Penalidade Short Call]\n            --,destino.[Penalidade Instabilidade]                                                          = fonte.[Penalidade Instabilidade]\n            --,destino.[Penalidade Phishing]                                                               = fonte.[Penalidade Phishing]\n\n            --,destino.[PAs Contratadas]                                                                   = fonte.[PAs Contratadas]\n            --,destino.[Valor da PA]                                                                       = fonte.[Valor da PA]\n            --,destino.[Faturamento Antes das Penalidades]                                                 = fonte.[Faturamento Antes das Penalidades]\n            --,destino.[Faturamento Ap\u00f3s Penalidades]                                                      = fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,destino.[Log]                                                                               = fonte.[Log]\n            ,destino.[Log 102%]                                                                          = fonte.[Log 102%]\n            ,destino.[Log Perdido (>102%)]                                                               = fonte.[Log Perdido (>102%)]\n\t\t    ,destino.[Log Produtivo]                                                                     = fonte.[Log Produtivo]\n            ,destino.[Log Produtivo 102%]                                                                = fonte.[Log Produtivo 102%]\n            ,destino.[Log Produtivo Perdido (>102%)]                                                     = fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,destino.[Log HE]                                                                            = fonte.[Log HE]\n\t\t    ,destino.[Log descartado (>2HE)]                                                             = fonte.[Log descartado (>2HE)]\n\t\t    ,destino.[Log Improdutivo]                                                                   = fonte.[Log Improdutivo]\n\t\t    ,destino.[Tempo Livre]                                                                       = fonte.[Tempo Livre]\n\t\t    ,destino.[Pausa Particular (Intelix)]                                                        = fonte.[Pausa Particular (Intelix)]\n\t\t    ,destino.[Pausa Break (Intelix)]                                                             = fonte.[Pausa Break (Intelix)]\n\t\t    ,destino.[Pausa 10 (Intelix)]                                                                = fonte.[Pausa 10 (Intelix)]\n\t\t    ,destino.[Pausa Outbound (Intelix)]                                                          = fonte.[Pausa Outbound (Intelix)]\n\t\t    ,destino.[Pausa Lanche (Intelix)]                                                            = fonte.[Pausa Lanche (Intelix)]\n\t\t    ,destino.[Pausa R\u00e1pida (Intelix)]                                                            = fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Intelix)]                                                            = fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,destino.[Pausa Feedback (Intelix)]                                                          = fonte.[Pausa Feedback (Intelix)]\n\t\t    ,destino.[Pausa Sistema Interno (Intelix)]                                                   = fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,destino.[Pausa Sistema Externo (Intelix)]                                                   = fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,destino.[Pausa Treinamento (Intelix)]                                                       = fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,destino.[Pausa Banheiro (Intelix)]                                                          = fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (Intelix)]                                                           = fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Intelix)]                                                       = fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,destino.[Pausa NR17 (Intelix)]                                                              = fonte.[Pausa NR17 (Intelix)]\n\t\t    ,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]                                                              = fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (EPBX)]                                                               = fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,destino.[Pausa Tratativa (EPBX)]                                                            = fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,destino.[Pausa Discagem Manual (EPBX)]                                                      = fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,destino.[Pausa Banheiro (EPBX)]                                                             = fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,destino.[Pausa WhatsApp (EPBX)]                                                             = fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,destino.[Pausa Intervalo (EPBX)]                                                            = fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,destino.[Pausa Discagem Retorno (EPBX)]                                                     = fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,destino.[Pausa Treinamento (EPBX)]                                                          = fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,destino.[Pausa Feedback (EPBX)]                                                             = fonte.[Pausa Feedback (EPBX)]\n\t\t    ,destino.[Pausa Transfer\u00eancia (EPBX)]                                                        = fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,destino.[Pausa N\u00e3o Disponivel (EPBX)]                                                       = fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,destino.[Pausa Login (EPBX)]                                                                = fonte.[Pausa Login (EPBX)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (EPBX)]                                                              = fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Sistema Interno (EPBX)]                                                      = fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,destino.[Pausa Sistema Externo (EPBX)]                                                      = fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,destino.[Pausa NR17 (EPBX)]                                                                 = fonte.[Pausa NR17 (EPBX)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (EPBX)]                                                          = fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,destino.[Pausa P\u00f3s Atendimento (EPBX)]                                                      = fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,destino.[Pausa Lanche (EPBX)]                                                               = fonte.[Pausa Lanche (EPBX)]\n\t\t    ,destino.[Pausa BackOffice (EPBX)]                                                           = fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Genesys)]                                                            = fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Genesys)]                                                       = fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,destino.[Pausa Banheiro (Genesys)]                                                          = fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,destino.[Pausa Descanso (Genesys)]                                                          = fonte.[Pausa Descanso (Genesys)]\n\t \t    ,destino.[Pausa Feedback (Genesys)]                                                          = fonte.[Pausa Feedback (Genesys)]\n\t \t    ,destino.[Pausa Backoffice (Genesys)]                                                        = fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,destino.[Pausa Discagem Manual (Genesys)]                                                   = fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,destino.[Pausa Discagem Retorno (Genesys)]                                                  = fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,destino.[Pausa Dispon\u00edvel (Genesys)]                                                        = fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,destino.[Pausa Em Fila (Genesys)]                                                           = fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,destino.[Pausa Sistema Externo (Genesys)]                                                   = fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,destino.[Pausa Sistema Interno (Genesys)]                                                   = fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,destino.[Pausa Tratativa (Genesys)]                                                         = fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,destino.[Pausa Whatsapp (Genesys)]                                                          = fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,destino.[Pausa Treinamento (Genesys)]                                                       = fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,destino.[Criados]                                                                           = fonte.[Criados]\n\t\t    ,destino.[Tratados]                                                                          = fonte.[Tratados]\n\t\t    ,destino.[Tempo Total de Tratativa]                                                          = fonte.[Tempo Total de Tratativa]\n\t\t    ,destino.[TMT]                                                                               = fonte.[TMT]\n\t\t    ,destino.[N\u00e3o Resolvidos]                                                                    = fonte.[N\u00e3o Resolvidos]\n\t\t    ,destino.[Replicas]                                                                          = fonte.[Replicas]\n\t\t    ,destino.[Reincidentes 48h]                                                                  = fonte.[Reincidentes 48h]\n\t\t    ,destino.[Reincidentes 30d]                                                                  = fonte.[Reincidentes 30d]\n\n            ,destino.[SLA TPR]                                                                           = fonte.[SLA TPR]\n            ,destino.[SLA TES]                                                                           = fonte.[SLA TES]\n            ,destino.[SLA TTR]                                                                           = fonte.[SLA TTR]\n\n\t\t    ,destino.[Inbound - Chamadas Iniciadas]                                                      = fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas]                                                      = fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]                                           = fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Inbound - Chamadas Em Andamento]                                                   = fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,destino.[Inbound - Chamadas Finalizadas]                                                    = fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,destino.[Inbound - Chamadas Transferidas]                                                   = fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]                            = fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]                        = fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]                             = fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]                       = fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]                                      = fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]                                  = fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]                                       = fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]                                 = fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Atendimentos Iniciados]                                                  = fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,destino.[Inbound - Atendimentos Em Andamento]                                               = fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Inbound - Atendimentos Finalizados]                                                = fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,destino.[Inbound - TMC]                                                                     = fonte.[Inbound - TMC]\n\t\t    ,destino.[Inbound - TMA]                                                                     = fonte.[Inbound - TMA]\n\t\t    ,destino.[Inbound - TME]                                                                     = fonte.[Inbound - TME]\n\t\t    ,destino.[Inbound - TMO]                                                                     = fonte.[Inbound - TMO]\n\t\t    ,destino.[Inbound - % Nivel de Servi\u00e7o]                                                      = fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Inbound - Chamadas Abandonadas]                                                    = fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,destino.[Inbound - % Abandono]                                                              = fonte.[Inbound - % Abandono]\n\n\t\t    ,destino.[Outbound - Chamadas Iniciadas]                                                     = fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas]                                                     = fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]                                          = fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Outbound - Chamadas Em Andamento]                                                  = fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,destino.[Outbound - Chamadas Finalizadas]                                                   = fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,destino.[Outbound - Chamadas Transferidas]                                                  = fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]                           = fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]                       = fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]                            = fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]                      = fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]                                     = fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]                                 = fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]                                      = fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]                                = fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Atendimentos Iniciados]                                                 = fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,destino.[Outbound - Atendimentos Em Andamento]                                              = fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Outbound - Atendimentos Finalizados]                                               = fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,destino.[Outbound - TMC]                                                                    = fonte.[Outbound - TMC]\n\t\t    ,destino.[Outbound - TMA]                                                                    = fonte.[Outbound - TMA]\n\t\t    ,destino.[Outbound - TME]                                                                    = fonte.[Outbound - TME]\n\t\t    ,destino.[Outbound - TMO]                                                                    = fonte.[Outbound - TMO]\n\t\t    ,destino.[Outbound - % Nivel de Servi\u00e7o]                                                     = fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Outbound - Chamadas Abandonadas]                                                   = fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,destino.[Outbound - % Abandono]                                                             = fonte.[Outbound - % Abandono]\n\n\t\t    ,destino.[Avalia\u00e7\u00f5es de NPS]                                                                 = fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,destino.[Promotoras]                                                                        = fonte.[Promotoras]\n\t\t    ,destino.[Neutras]                                                                           = fonte.[Neutras]\n\t\t    ,destino.[Detratoras]                                                                        = fonte.[Detratoras]\n            --,destino.[NPS]                                                                               = fonte.[NPS]\n\n            ,destino.[Genesys Provis\u00f3rio - Oferta]                                                       = ISNULL(fonte.[Genesys Provis\u00f3rio - Oferta],0)\n            ,destino.[Genesys Provis\u00f3rio - Resposta]                                                     = ISNULL(fonte.[Genesys Provis\u00f3rio - Resposta],0)\n            ,destino.[Genesys Provis\u00f3rio - Em Espera]                                                    = ISNULL(fonte.[Genesys Provis\u00f3rio - Em Espera],0)\n            ,destino.[Genesys Provis\u00f3rio - Transferir]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - Transferir],0)\n            ,destino.[Genesys Provis\u00f3rio - Abandono]                                                     = ISNULL(fonte.[Genesys Provis\u00f3rio - Abandono],0)\n            ,destino.[Genesys Provis\u00f3rio - % Resposta]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - % Resposta],0)\n            ,destino.[Genesys Provis\u00f3rio - % Abandono]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - % Abandono],0)\n            ,destino.[Genesys Provis\u00f3rio - % NS]                                                         = ISNULL(fonte.[Genesys Provis\u00f3rio - % NS],0)\n            ,destino.[Genesys Provis\u00f3rio - % Alvos do NS]                                                = ISNULL(fonte.[Genesys Provis\u00f3rio - % Alvos do NS],0)\n            ,destino.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]                                      = ISNULL(fonte.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)],0)\n            ,destino.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)]                                  = ISNULL(fonte.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)],0)\n            ,destino.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]                                       = ISNULL(fonte.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)],0)\n            ,destino.[Genesys Provis\u00f3rio - VMA]                                                          = ISNULL(fonte.[Genesys Provis\u00f3rio - VMA],0)\n            ,destino.[Genesys Provis\u00f3rio - TPC]                                                          = ISNULL(fonte.[Genesys Provis\u00f3rio - TPC],0)\n\n\t\t    ,destino.[Teve Evento de MOP?]                                                               = fonte.[Teve Evento de MOP?]\n\t\t    ,destino.[Teve Evento de Tickets?]                                                           = fonte.[Teve Evento de Tickets?]\n\t\t    ,destino.[Teve Evento de Chamadas?]                                                          = fonte.[Teve Evento de Chamadas?]\n\t\t    ,destino.[Teve Evento de NPS?]                                                               = fonte.[Teve Evento de NPS?]\n\t\t    ,destino.[Teve Evento de Log?]                                                               = fonte.[Teve Evento de Log?]\n\t\t    ,destino.[Teve Evento de Forecast?]                                                          = fonte.[Teve Evento de Forecast?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_tribo_30min\n        WHERE   [Teve Evento de MOP?]\t\t= 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0\n            AND [Teve Evento de Forecast?]  = 0\n\n        UPDATE r_tribo_30min\n        SET\n             [Intervalo]            = CAST([DataHora] AS TIME)\n            ,[Data]                 = CAST([DataHora] AS DATE)\n            ,[Ciclo (Primeiro Dia)] = DATEADD(DAY, (CASE WHEN (DATEPART(DAY, [DataHora]) > 21) THEN 4 ELSE ((DATEPART(DAY, [DataHora])-1)/7)+1 END-1)*7, DATEFROMPARTS(YEAR([DataHora]), MONTH([DataHora]), 1))\n            ,[M\u00eas (Primeiro Dia)]   = DATEFROMPARTS(YEAR([DataHora]), MONTH([DataHora]), 1)\n            ,[Cliente]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),3)\n            ,[Projeto]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),2)\n            ,[Tribo]\t\t\t       = PARSENAME(REPLACE([Tribo Completa],'__','.'),1)\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n    IF 1=1 BEGIN; PRINT '--- agrupamento tribo_dia';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_tribo_dia]\n    \t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n    \t\tAND\t  [Data] <= CAST(@datahora_fim    AS DATE)\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n            SELECT\n                 [Ader\u00eancia Log 102%]               =   [Log 102%] / NULLIF([Forecast Log],0)\n                ,[Ader\u00eancia Log Produtivo 102%]     =   [Log Produtivo 102%] / NULLIF([Forecast Log Produtivo],0)\n                ,[Log Perdido (>102%)]              =   [Log] - [Log 102%]\n                ,[Log Produtivo Perdido (>102%)]    =   [Log Produtivo] - [Log Produtivo 102%]\n                ,*\n            FROM (\n                SELECT\n                     [Ader\u00eancia Log]                    =   [Log] / NULLIF([Forecast Log],0)\n                    ,[Ader\u00eancia Log Produtivo]          =   [Log Produtivo] / NULLIF([Forecast Log Produtivo],0)\n                    ,[Log 102%]                         =   IIF([Log] > [Forecast Log] * 1.2, [Forecast Log] * 1.2, [Log])\n                    ,[Log Produtivo 102%]               =   IIF([Log Produtivo] > [Forecast Log Produtivo] * 1.2, [Forecast Log Produtivo] * 1.2, [Log Produtivo])\n                    ,[Ader\u00eancia TMT]                    =   [TMT] / NULLIF([Forecast TMT],0)\n                    ,[Ader\u00eancia TMA]                    =   COALESCE([Inbound - TMA], [Outbound - TMA]) / NULLIF([Forecast TMA],0)\n                    ,[Ader\u00eancia SLA]                    =   [SLA TPR] / NULLIF([Forecast SLA],0)\n                    ,[Ader\u00eancia NS]                     =   [Inbound - % Nivel de Servi\u00e7o] / NULLIF([Forecast NS],0)\n                    --,[Ader\u00eancia NPS]                    =   [NPS] / NULLIF([Forecast NPS],0)\n                    ,[Ader\u00eancia Abandono]               =   [Inbound - % Abandono] / NULLIF([Forecast Abandono],0)\n                    ,[Ader\u00eancia Casos N\u00e3o Resolvidos]   =   [N\u00e3o Resolvidos] / NULLIF([Forecast Casos N\u00e3o Resolvidos],0)\n                    ,*\n                FROM (\n                \tSELECT\n\n                        -- [DataHora]\t\t\t\t\t\t\t\t\t\t\t\t        =   COALESCE([DataHora], [f_DataHora])\n                        --,[Intervalo]\t\t\t\t\t\t\t\t\t\t\t        =   MIN([Intervalo])\n                         [Data]\t\t\t\t\t\t\t\t\t\t\t\t\t        =   [Data]\n                        ,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t\t\t\t        =   MIN([Ciclo (Primeiro Dia)])\n                        ,[M\u00eas (Primeiro Dia)]\t\t\t\t                            =   MIN([M\u00eas (Primeiro Dia)])\n\n                        ,[Feriado (Nome)]                                               =  MAX([Feriado (Nome)])\n\n       \t                ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(MAX([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t                ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(MAX([Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t                ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(MAX([Secullum - Servi\u00e7o Militar]                                   ),0)\n                        ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(MAX([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t                ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(MAX([Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t                ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(MAX([Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t                ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(MAX([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t                ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(MAX([Secullum - Licen\u00e7a Casamento]                                 ),0)\n                        ,[Secullum - INSS - Afastamento]                                    =   ISNULL(MAX([Secullum - INSS - Afastamento]                                ),0)\n                        ,[Secullum - Folga]                                                 =   ISNULL(MAX([Secullum - Folga]                                             ),0)\n                        ,[Secullum - F\u00e9rias]                                                =   ISNULL(MAX([Secullum - F\u00e9rias]                                            ),0)\n       \t                ,[Secullum - Feriado]                                               =   ISNULL(MAX([Secullum - Feriado]                                           ),0)\n       \t                ,[Secullum - Falta Justificada]                                     =   ISNULL(MAX([Secullum - Falta Justificada]                                 ),0)\n       \t                ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(MAX([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                        ,[Secullum - Falta Injustificada]                                   =   ISNULL(MAX([Secullum - Falta Injustificada]                               ),0)\n       \t                ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(MAX([Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t                ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(MAX([Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                        ,[Secullum - Desligue]                                              =   ISNULL(MAX([Secullum - Desligue]                                          ),0)\n       \t                ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(MAX([Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t                ,[Secullum - Compensando Horas]                                     =   ISNULL(MAX([Secullum - Compensando Horas]                                 ),0)\n       \t                ,[Secullum - Atestado]                                              =   ISNULL(MAX([Secullum - Atestado]                                          ),0)\n                        ,[Secullum - Abono]                                                 =   ISNULL(MAX([Secullum - Abono]                                             ),0)\n       \t                ,[Secullum - Abono Lactante]                                        =   ISNULL(MAX([Secullum - Abono Lactante]                                    ),0)\n       \t                ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(MAX([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t                ,[Faltas Justificadas]                                              =   ISNULL(MAX([Faltas Justificadas]                                          ),0)\n       \t                ,[Faltas Injustificadas]                                            =   ISNULL(MAX([Faltas Injustificadas]                                        ),0)\n\n                        ,[Cliente]\t\t\t\t\t\t\t                            =   MIN([Cliente])\n                        ,[Projeto]\t\t\t\t\t\t\t                            =   MIN([Projeto])\n                        ,[Tribo]\t\t\t\t\t\t\t                            =   MIN([Tribo])\n                        ,[Tribo Completa]\t\t\t\t\t                            =   [Tribo Completa]\n\n                        ,[Trabalhado (Ponto)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Trabalhado (Ponto)]),0)\n                        ,[Em Pausa (Ponto)]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Em Pausa (Ponto)]),0)\n\t\t\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Desvio Ponto-Log]),0)\n\n                        ,[Forecast HC Taxa 1]                                           =   MAX([Forecast HC Taxa 1])\n                        ,[Forecast HC Taxa 2]                                           =   MAX([Forecast HC Taxa 2]) * IIF(DATEPART(dw,[Data]) = 7 AND [Data] BETWEEN '01/02/2024' AND '01/01/2025' AND [Tribo Completa] <> 'Serasa__Digital__Chat', 1, 2)\n                        ,[Forecast Pausas Taxa 1]                                       =   MAX([Forecast Pausas Taxa 1])\n                        ,[Forecast Pausas Taxa 2]                                       =   MAX([Forecast Pausas Taxa 2])\n                        ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                     =   MAX([Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio])\n                        ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                 =   MAX([Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio])\n                        ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t                    =   MAX([Forecast PA Liquida (VOZ) - Provis\u00f3rio])\n                        ,[Forecast Volume]\t\t                                        =   SUM([Forecast Volume])\n                        --,[Forecast Volume M\u00eas - Provis\u00f3rio]                           =\n                        ,[Forecast Log]                                                 =   SUM([Forecast Log])\n                        ,[Forecast Log Produtivo]                                       =   SUM([Forecast Log Produtivo])\n                        ,[Forecast NS]                                                  =   MAX([Forecast NS])\n                        --,[Forecast NS M\u00eas - Provis\u00f3rio]                               =\n\n                        ,[Forecast TMT]                                                 =   MAX([Forecast TMT])\n                        ,[Forecast TMA]                                                 =   MAX([Forecast TMA])\n                        ,[Forecast SLA]                                                 =   MAX([Forecast SLA])\n                        ,[Forecast Abandono]                                            =   MAX([Forecast Abandono])\n                        ,[Forecast NPS]                                                 =   MAX([Forecast NPS])\n                        ,[Forecast Casos N\u00e3o Resolvidos]                                =   MAX([Forecast Casos N\u00e3o Resolvidos])\n                        ,[Forecast Rechamada]                                           =   MAX([Forecast Rechamada])\n                        ,[Forecast Short Call]                                          =   MAX([Forecast Short Call])\n                        ,[Forecast Instabilidade]                                       =   MAX([Forecast Instabilidade])\n                        ,[Forecast Phishing]                                            =   MAX([Forecast Phishing])\n\n                        --UP--,[Ader\u00eancia Log]                                          =\n                        --UP--,[Ader\u00eancia Log 102%]                                     =\n                        --UP--,[Ader\u00eancia Log Produtivo]                                =\n                        --UP--,[Ader\u00eancia Log Produtivo 102%]                           =\n                        --UP--,[Ader\u00eancia TMT]                                          =\n                        --UP--,[Ader\u00eancia TMA]                                          =\n                        --UP--,[Ader\u00eancia SLA]                                          =\n                        --UP--,[Ader\u00eancia NS]                                           =\n                        --UP--,[Ader\u00eancia Abandono]                                     =\n                        --UP--,[Ader\u00eancia NPS]                                          =\n                        --UP--,[Ader\u00eancia Casos N\u00e3o Resolvidos]                         =\n                        --,[Ader\u00eancia Rechamada]                                        =\n                        --,[Ader\u00eancia Short Call]                                       =\n                        --,[Ader\u00eancia Instabilidade]                                    =\n                        --,[Ader\u00eancia Phishing]                                         =\n\n                        --,[Penalidade TMT]                                             =\n                        --,[Penalidade TMA]                                             =\n                        --,[Penalidade SLA]                                             =\n                        --,[Penalidade NS]                                              =\n                        --,[Penalidade Abandono]                                        =\n                        --,[Penalidade NPS]                                             =\n                        --,[Penalidade Casos N\u00e3o Resolvidos]                            =\n                        --,[Penalidade Rechamada]                                       =\n                        --,[Penalidade Short Call]                                      =\n                        --,[Penalidade Instabilidade]                                   =\n                        --,[Penalidade Phishing]                                        =\n\n                        --,[PAs Contratadas]                                            =\n                        --,[Valor da PA]                                                =\n                        --,[Faturamento Antes das Penalidades]                          =\n                        --,[Faturamento Ap\u00f3s Penalidades]                               =\n\n                        ,[Log]\t\t\t\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log]),0)\n                        -- UP --,[Log 102%]\n                        -- UP --,[Log Perdido (>102%)]\n                        ,[Log Produtivo]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log Produtivo]),0)\n                        -- UP --,[Log Produtivo 102%]\n                        -- UP --,[Log Produtivo Perdido (>102%)]\n                        ,[Log HE]\t\t\t\t\t\t\t\t\t\t\t\t\t    =   ISNULL(SUM([Log HE]),0)\n                        ,[Log descartado (>2HE)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log descartado (>2HE)]),0)\n                        ,[Log Improdutivo]\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Log Improdutivo]),0)\n                        ,[Tempo Livre]\t\t\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Tempo Livre]),0)\n                        ,[Pausa Particular (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Particular (Intelix)]),0)\n                        ,[Pausa Break (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Break (Intelix)]),0)\n                        ,[Pausa 10 (Intelix)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa 10 (Intelix)]),0)\n                        ,[Pausa Outbound (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Outbound (Intelix)]),0)\n                        ,[Pausa Lanche (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Lanche (Intelix)]),0)\n                        ,[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa R\u00e1pida (Intelix)]),0)\n                        ,[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (Intelix)]),0)\n                        ,[Pausa Feedback (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (Intelix)]),0)\n                        ,[Pausa Sistema Interno (Intelix)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (Intelix)]),0)\n                        ,[Pausa Sistema Externo (Intelix)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (Intelix)]),0)\n                        ,[Pausa Treinamento (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (Intelix)]),0)\n                        ,[Pausa Banheiro (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (Intelix)]),0)\n                        ,[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Reuni\u00e3o (Intelix)]),0)\n                        ,[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (Intelix)]),0)\n                        ,[Pausa NR17 (Intelix)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa NR17 (Intelix)]),0)\n                        ,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Liga\u00e7\u00e3o (EPBX)]),0)\n                        ,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (EPBX)]),0)\n                        ,[Pausa Tratativa (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Tratativa (EPBX)]),0)\n                        ,[Pausa Discagem Manual (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Manual (EPBX)]),0)\n                        ,[Pausa Banheiro (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (EPBX)]),0)\n                        ,[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa WhatsApp (EPBX)]),0)\n                        ,[Pausa Intervalo (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Intervalo (EPBX)]),0)\n                        ,[Pausa Discagem Retorno (EPBX)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Retorno (EPBX)]),0)\n                        ,[Pausa Treinamento (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (EPBX)]),0)\n                        ,[Pausa Feedback (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (EPBX)]),0)\n                        ,[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Transfer\u00eancia (EPBX)]),0)\n                        ,[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa N\u00e3o Disponivel (EPBX)]),0)\n                        ,[Pausa Login (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Login (EPBX)]),0)\n                        ,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Reuni\u00e3o (EPBX)]),0)\n                        ,[Pausa Sistema Interno (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (EPBX)]),0)\n                        ,[Pausa Sistema Externo (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (EPBX)]),0)\n                        ,[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa NR17 (EPBX)]),0)\n                        ,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (EPBX)]),0)\n                        ,[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa P\u00f3s Atendimento (EPBX)]),0)\n                        ,[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Lanche (EPBX)]),0)\n                        ,[Pausa BackOffice (EPBX)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa BackOffice (EPBX)]),0)\n                        ,[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Almo\u00e7o (Genesys)]),0)\n                        ,[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Ambulat\u00f3rio (Genesys)]),0)\n                        ,[Pausa Banheiro (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Banheiro (Genesys)]),0)\n                        ,[Pausa Descanso (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Descanso (Genesys)]),0)\n                        ,[Pausa Feedback (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Feedback (Genesys)]),0)\n                        ,[Pausa Backoffice (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Backoffice (Genesys)]),0)\n                        ,[Pausa Discagem Manual (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Manual (Genesys)]),0)\n                        ,[Pausa Discagem Retorno (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Discagem Retorno (Genesys)]),0)\n                        ,[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Dispon\u00edvel (Genesys)]),0)\n                        ,[Pausa Em Fila (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Em Fila (Genesys)]),0)\n                        ,[Pausa Sistema Externo (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Externo (Genesys)]),0)\n                        ,[Pausa Sistema Interno (Genesys)]\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Sistema Interno (Genesys)]),0)\n                        ,[Pausa Tratativa (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Tratativa (Genesys)]),0)\n                        ,[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Whatsapp (Genesys)]),0)\n                        ,[Pausa Treinamento (Genesys)]\t\t\t\t\t\t\t        =   ISNULL(SUM([Pausa Treinamento (Genesys)]),0)\n\n                        ,[Criados]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Criados]),0)\n                        ,[Tratados]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Tratados]),0)\n                        ,[Tempo Total de Tratativa]\t\t\t                            =   ISNULL(SUM([Tempo Total de Tratativa]),0)\n                        ,[TMT]\t\t\t\t\t\t\t\t                            =   ISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n                        ,[N\u00e3o Resolvidos]\t\t\t\t\t                            =   ISNULL(SUM([N\u00e3o Resolvidos]),0)\n                        ,[Replicas]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Replicas]),0)\n                        ,[Reincidentes 48h]\t\t\t\t\t                            =   ISNULL(SUM([Reincidentes 48h]),0)\n                        ,[Reincidentes 30d]\t\t\t\t\t                            =   ISNULL(SUM([Reincidentes 30d]),0)\n\n                        ,[SLA TPR]                                                      =   AVG([SLA TPR])\n                        ,[SLA TES]                                                      =   AVG([SLA TES])\n                        ,[SLA TTR]                                                      =   AVG([SLA TTR])\n\n                        ,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Iniciadas]),0)\n                        ,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas]),0)\n                        ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s]),0)\n                        ,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Em Andamento]),0)\n                        ,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Finalizadas]),0)\n                        ,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Transferidas]),0)\n                        ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=   ISNULL(SUM([Inbound - Tempo Em Chamada (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=   ISNULL(SUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=   ISNULL(SUM([Inbound - Tempo Em Espera (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=   ISNULL(SUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)]),0)\n                        ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Chamada (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Atendimento (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Espera (Neste Intervalo)]),0)\n                        ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Inbound - Tempo Em Encerramento (Neste Intervalo)]),0)\n                        ,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Iniciados]),0)\n                        ,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Em Andamento]),0)\n                        ,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Atendimentos Finalizados]),0)\n                        ,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n                        ,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n                        ,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n                        ,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n                        ,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n                        ,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Abandonadas]),0)\n                        ,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n                        ,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Iniciadas]),0)\n                        ,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas]),0)\n                        ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s]),0)\n                        ,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Em Andamento]),0)\n                        ,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Finalizadas]),0)\n                        ,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Transferidas]),0)\n                        ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=   ISNULL(SUM([Outbound - Tempo Em Chamada (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=   ISNULL(SUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=   ISNULL(SUM([Outbound - Tempo Em Espera (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=   ISNULL(SUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)]),0)\n                        ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Chamada (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Atendimento (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Espera (Neste Intervalo)]),0)\n                        ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=   ISNULL(SUM([Outbound - Tempo Em Encerramento (Neste Intervalo)]),0)\n                        ,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Iniciados]),0)\n                        ,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Em Andamento]),0)\n                        ,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Atendimentos Finalizados]),0)\n                        ,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n                        ,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n                        ,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n                        ,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n                        ,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n                        ,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Abandonadas]),0)\n                        ,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=   ISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n                        ,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t                            =   ISNULL(SUM([Avalia\u00e7\u00f5es de NPS]),0)\n                        ,[Promotoras]\t\t\t\t\t\t                            =   ISNULL(SUM([Promotoras]),0)\n                        ,[Neutras]\t\t\t\t\t\t\t                            =   ISNULL(SUM([Neutras]),0)\n                        ,[Detratoras]\t\t\t\t\t\t                            =   ISNULL(SUM([Detratoras]),0)\n                        ,[NPS]\t\t\t\t\t\t\t\t                            =   CAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n                        ,[Teve Evento de MOP?]\t\t                                    =   IIF(SUM([Teve Evento de MOP?])=0,0,1)\n                        ,[Teve Evento de Tickets?]\t                                    =   IIF(SUM([Teve Evento de Tickets?])=0,0,1)\n                        ,[Teve Evento de Chamadas?]\t                                    =   IIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n                        ,[Teve Evento de NPS?]\t\t                                    =   IIF(SUM([Teve Evento de NPS?])=0,0,1)\n                        ,[Teve Evento de Log?]\t\t                                    =   IIF(SUM([Teve Evento de Log?])=0,0,1)\n                        ,[Teve Evento de Forecast?]\t\t                                =   IIF(SUM([Teve Evento de Forecast?]) IS NULL,0,1)\n\n                \tFROM r_tribo_30min r\n                    --FULL OUTER JOIN (\n                    --    SELECT\n                    --     [m_Tribo]  = [tribo]\n                    --    ,[m_M\u00eas]    = [m\u00eas]\n                    --    ,[Forecast Volume M\u00eas - Provis\u00f3rio] = [volume_projetado] -- S\u00f3 pra valida\u00e7\u00e3o, pra ver se t\u00e1 batendo com a dim_forecast_30min\n                    --    ,[Forecast NS M\u00eas - Provis\u00f3rio] = [NS]\n                    --    ,[Forecast TMT] = IIF([tribo] in ('Central de Ajuda - Autentica\u00e7\u00e3o', 'Central de Ajuda - Produtos', 'Reclame Aqui', 'GOV', 'Self Setup', 'BackOffice', 'Chat', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                    --    ,[Forecast TMA] = IIF([tribo] in ('BackOffice', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                    --    ,[Forecast SLA] = [SLA]\n                    --    ,[Forecast Abandono] = [abandono]\n                    --    ,[Forecast NPS] = [NPS]\n                    --    ,[Forecast Casos N\u00e3o Resolvidos] = [casos_n\u00e3o_resolvidos]\n                    --    ,[Forecast Rechamada] = [rechamada]\n                    --    ,[Forecast Short Call] = [short_call]\n                    --    ,[Forecast Instabilidade] = [instabilidade]\n                    --    ,[Forecast Phishing] = [phishing]\n                    --    ,[PAs Contratadas] = [hc_tx1] + [hc_tx2]\n                    --    ,[Valor da PA] = [valor_pa]\n                    --    FROM (\n                    --        SELECT [n]=ROW_NUMBER() OVER (PARTITION BY [tribo], [m\u00eas] ORDER BY [data_recebimento]), *\n                    --        FROM [db_serasa_producao].[dbo].dim_forecast_metas\n                    --    ) _\n                    --    WHERE [n] = 1\n                    --) m\n                    --ON  r.[Tribo] = m.[m_tribo]\n                    --AND r.[M\u00eas (Primeiro Dia)] = m.[m_m\u00eas]\n\n                    --LEFT JOIN (\n                    --    SELECT\n                    --     [m_Tribo]  = [tribo_serasa]\n                    --    ,[m_Data]   = [data]\n                    --    ,[SLA TPR]  = AVG([primeira_resposta_s])\n                    --    ,[SLA TES]  = AVG([espera_solicitante_s])\n                    --    ,[SLA TTR]  = AVG([total_resolucao_s])\n                    --    FROM [db_serasa_producao].[dbo].dim_teste_sla\n                    --    GROUP BY [tribo_serasa], [data]\n                    --) s\n                    --ON  r.[Tribo] = s.[m_Tribo]\n                    --AND r.[Data] = s.[m_Data]\n\n                \tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n                \tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n                \tGROUP BY [Data], [Tribo Completa]\n                ) _\n            ) _\n    \t) AS fonte\n    \tON  fonte.[Data]  = destino.[Data]\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \t\tINSERT\n    \t\t(\n\t\t    -- [DataHora]\n\t\t    --,[Intervalo]\n\t\t     [Data]\n\t\t    ,[Ciclo (Primeiro Dia)]\n\t\t    ,[M\u00eas (Primeiro Dia)]\n\n            ,[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n\t\t    ,[Cliente]\n\t\t    ,[Projeto]\n\t\t    ,[Tribo]\n\t\t    ,[Tribo Completa]\n\n\t\t    ,[Trabalhado (Ponto)]\n\t\t    ,[Em Pausa (Ponto)]\n\t\t\t,[Desvio Ponto-Log]\n\n            ,[Forecast HC Taxa 1]\n            ,[Forecast HC Taxa 2]\n            ,[Forecast Pausas Taxa 1]\n            ,[Forecast Pausas Taxa 2]\n            ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,[Forecast Volume]\n            --,[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,[Forecast Log]\n            ,[Forecast Log Produtivo]\n            ,[Forecast NS]\n            --,[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,[Forecast TMT]\n            ,[Forecast TMA]\n            ,[Forecast SLA]\n            ,[Forecast Abandono]\n            ,[Forecast NPS]\n            ,[Forecast Casos N\u00e3o Resolvidos]\n            ,[Forecast Rechamada]\n            ,[Forecast Short Call]\n            ,[Forecast Instabilidade]\n            ,[Forecast Phishing]\n\n            ,[Ader\u00eancia Log]\n            ,[Ader\u00eancia Log 102%]\n            ,[Ader\u00eancia Log Produtivo]\n            ,[Ader\u00eancia Log Produtivo 102%]\n            ,[Ader\u00eancia TMT]\n            ,[Ader\u00eancia TMA]\n            ,[Ader\u00eancia SLA]\n            ,[Ader\u00eancia NS]\n            ,[Ader\u00eancia Abandono]\n            --,[Ader\u00eancia NPS]\n            ,[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,[Ader\u00eancia Rechamada]\n            --,[Ader\u00eancia Short Call]\n            --,[Ader\u00eancia Instabilidade]\n            --,[Ader\u00eancia Phishing]\n\n            --,[Penalidade TMT]\n            --,[Penalidade TMA]\n            --,[Penalidade SLA]\n            --,[Penalidade NS]\n            --,[Penalidade Abandono]\n            --,[Penalidade NPS]\n            --,[Penalidade Casos N\u00e3o Resolvidos]\n            --,[Penalidade Rechamada]\n            --,[Penalidade Short Call]\n            --,[Penalidade Instabilidade]\n            --,[Penalidade Phishing]\n\n            --,[PAs Contratadas]\n            --,[Valor da PA]\n            --,[Faturamento Antes das Penalidades]\n            --,[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,[Log]\n            ,[Log 102%]\n            ,[Log Perdido (>102%)]\n\t\t    ,[Log Produtivo]\n            ,[Log Produtivo 102%]\n            ,[Log Produtivo Perdido (>102%)]\n\t\t    ,[Log HE]\n\t\t    ,[Log descartado (>2HE)]\n\t\t    ,[Log Improdutivo]\n\t\t    ,[Tempo Livre]\n\t\t    ,[Pausa Particular (Intelix)]\n\t\t    ,[Pausa Break (Intelix)]\n\t\t    ,[Pausa 10 (Intelix)]\n\t\t    ,[Pausa Outbound (Intelix)]\n\t\t    ,[Pausa Lanche (Intelix)]\n\t\t    ,[Pausa R\u00e1pida (Intelix)]\n\t\t    ,[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,[Pausa Feedback (Intelix)]\n\t\t    ,[Pausa Sistema Interno (Intelix)]\n\t\t    ,[Pausa Sistema Externo (Intelix)]\n\t\t    ,[Pausa Treinamento (Intelix)]\n\t\t    ,[Pausa Banheiro (Intelix)]\n\t\t    ,[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,[Pausa NR17 (Intelix)]\n\t\t    ,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,[Pausa Tratativa (EPBX)]\n\t\t    ,[Pausa Discagem Manual (EPBX)]\n\t\t    ,[Pausa Banheiro (EPBX)]\n\t\t    ,[Pausa WhatsApp (EPBX)]\n\t\t    ,[Pausa Intervalo (EPBX)]\n\t\t    ,[Pausa Discagem Retorno (EPBX)]\n\t\t    ,[Pausa Treinamento (EPBX)]\n\t\t    ,[Pausa Feedback (EPBX)]\n\t\t    ,[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,[Pausa Login (EPBX)]\n\t\t    ,[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,[Pausa Sistema Interno (EPBX)]\n\t\t    ,[Pausa Sistema Externo (EPBX)]\n\t\t    ,[Pausa NR17 (EPBX)]\n\t\t    ,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,[Pausa Lanche (EPBX)]\n\t\t    ,[Pausa BackOffice (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,[Pausa Banheiro (Genesys)]\n\t \t    ,[Pausa Descanso (Genesys)]\n\t \t    ,[Pausa Feedback (Genesys)]\n\t \t    ,[Pausa Backoffice (Genesys)]\n\t \t    ,[Pausa Discagem Manual (Genesys)]\n\t \t    ,[Pausa Discagem Retorno (Genesys)]\n\t \t    ,[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,[Pausa Em Fila (Genesys)]\n\t \t    ,[Pausa Sistema Externo (Genesys)]\n\t \t    ,[Pausa Sistema Interno (Genesys)]\n\t \t    ,[Pausa Tratativa (Genesys)]\n\t \t    ,[Pausa Whatsapp (Genesys)]\n\t\t    ,[Pausa Treinamento (Genesys)]\n\n\t\t    ,[Criados]\n\t\t    ,[Tratados]\n\t\t    ,[Tempo Total de Tratativa]\n\t\t    ,[TMT]\n\t\t    ,[N\u00e3o Resolvidos]\n\t\t    ,[Replicas]\n\t\t    ,[Reincidentes 48h]\n\t\t    ,[Reincidentes 30d]\n\n            ,[SLA TPR]\n            ,[SLA TES]\n            ,[SLA TTR]\n\n\t\t    ,[Inbound - Chamadas Iniciadas]\n\t\t    ,[Inbound - Chamadas Atendidas]\n\t\t    ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Inbound - Chamadas Em Andamento]\n\t\t    ,[Inbound - Chamadas Finalizadas]\n\t\t    ,[Inbound - Chamadas Transferidas]\n\t\t    ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Inbound - Atendimentos Iniciados]\n\t\t    ,[Inbound - Atendimentos Em Andamento]\n\t\t    ,[Inbound - Atendimentos Finalizados]\n\t\t    ,[Inbound - TMC]\n\t\t    ,[Inbound - TMA]\n\t\t    ,[Inbound - TME]\n\t\t    ,[Inbound - TMO]\n\t\t    ,[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Inbound - Chamadas Abandonadas]\n\t\t    ,[Inbound - % Abandono]\n\n\t\t    ,[Outbound - Chamadas Iniciadas]\n\t\t    ,[Outbound - Chamadas Atendidas]\n\t\t    ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Outbound - Chamadas Em Andamento]\n\t\t    ,[Outbound - Chamadas Finalizadas]\n\t\t    ,[Outbound - Chamadas Transferidas]\n\t\t    ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Outbound - Atendimentos Iniciados]\n\t\t    ,[Outbound - Atendimentos Em Andamento]\n\t\t    ,[Outbound - Atendimentos Finalizados]\n\t\t    ,[Outbound - TMC]\n\t\t    ,[Outbound - TMA]\n\t\t    ,[Outbound - TME]\n\t\t    ,[Outbound - TMO]\n\t\t    ,[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Outbound - Chamadas Abandonadas]\n\t\t    ,[Outbound - % Abandono]\n\n\t\t    ,[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,[Promotoras]\n\t\t    ,[Neutras]\n\t\t    ,[Detratoras]\n            ,[NPS]\n\n            --,[Genesys Provis\u00f3rio - Oferta]\n            --,[Genesys Provis\u00f3rio - Resposta]\n            --,[Genesys Provis\u00f3rio - Em Espera]\n            --,[Genesys Provis\u00f3rio - Transferir]\n            --,[Genesys Provis\u00f3rio - Abandono]\n            --,[Genesys Provis\u00f3rio - % Resposta]\n            --,[Genesys Provis\u00f3rio - % Abandono]\n            --,[Genesys Provis\u00f3rio - % NS]\n            --,[Genesys Provis\u00f3rio - % Alvos do NS]\n            --,[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]\n            --,[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)]\n            --,[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]\n            --,[Genesys Provis\u00f3rio - VMA]\n            --,[Genesys Provis\u00f3rio - TPC]\n\n\t\t    ,[Teve Evento de MOP?]\n\t\t    ,[Teve Evento de Tickets?]\n\t\t    ,[Teve Evento de Chamadas?]\n\t\t    ,[Teve Evento de NPS?]\n\t\t    ,[Teve Evento de Log?]\n\t\t    ,[Teve Evento de Forecast?]\n    \t\t)\n    \t\tVALUES\n    \t\t(\n\t\t    -- fonte.[DataHora]\n\t\t    --,fonte.[Intervalo]\n\t\t     fonte.[Data]\n\t\t    ,fonte.[Ciclo (Primeiro Dia)]\n\t\t    ,fonte.[M\u00eas (Primeiro Dia)]\n\n            ,fonte.[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n\t\t    ,fonte.[Cliente]\n\t\t    ,fonte.[Projeto]\n\t\t    ,fonte.[Tribo]\n\t\t    ,fonte.[Tribo Completa]\n\n\t\t    ,fonte.[Trabalhado (Ponto)]\n\t\t    ,fonte.[Em Pausa (Ponto)]\n\t\t\t,fonte.[Desvio Ponto-Log]\n\n            ,fonte.[Forecast HC Taxa 1]\n            ,fonte.[Forecast HC Taxa 2]\n            ,fonte.[Forecast Pausas Taxa 1]\n            ,fonte.[Forecast Pausas Taxa 2]\n            ,fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Volume]\n            --,fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,fonte.[Forecast Log]\n            ,fonte.[Forecast Log Produtivo]\n            ,fonte.[Forecast NS]\n            --,fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,fonte.[Forecast TMT]\n            ,fonte.[Forecast TMA]\n            ,fonte.[Forecast SLA]\n            ,fonte.[Forecast Abandono]\n            ,fonte.[Forecast NPS]\n            ,fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,fonte.[Forecast Rechamada]\n            ,fonte.[Forecast Short Call]\n            ,fonte.[Forecast Instabilidade]\n            ,fonte.[Forecast Phishing]\n\n            ,fonte.[Ader\u00eancia Log]\n            ,fonte.[Ader\u00eancia Log 102%]\n            ,fonte.[Ader\u00eancia Log Produtivo]\n            ,fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,fonte.[Ader\u00eancia TMT]\n            ,fonte.[Ader\u00eancia TMA]\n            ,fonte.[Ader\u00eancia SLA]\n            ,fonte.[Ader\u00eancia NS]\n            ,fonte.[Ader\u00eancia Abandono]\n            --,fonte.[Ader\u00eancia NPS]\n            ,fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,fonte.[Ader\u00eancia Rechamada]\n            --,fonte.[Ader\u00eancia Short Call]\n            --,fonte.[Ader\u00eancia Instabilidade]\n            --,fonte.[Ader\u00eancia Phishing]\n\n            --,fonte.[Penalidade TMT]\n            --,fonte.[Penalidade TMA]\n            --,fonte.[Penalidade SLA]\n            --,fonte.[Penalidade NS]\n            --,fonte.[Penalidade Abandono]\n            --,fonte.[Penalidade NPS]\n            --,fonte.[Penalidade Casos N\u00e3o Resolvidos]\n            --,fonte.[Penalidade Rechamada]\n            --,fonte.[Penalidade Short Call]\n            --,fonte.[Penalidade Instabilidade]\n            --,fonte.[Penalidade Phishing]\n\n            --,fonte.[PAs Contratadas]\n            --,fonte.[Valor da PA]\n            --,fonte.[Faturamento Antes das Penalidades]\n            --,fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,fonte.[Log]\n            ,fonte.[Log 102%]\n            ,fonte.[Log Perdido (>102%)]\n\t\t    ,fonte.[Log Produtivo]\n            ,fonte.[Log Produtivo 102%]\n            ,fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,fonte.[Log HE]\n\t\t    ,fonte.[Log descartado (>2HE)]\n\t\t    ,fonte.[Log Improdutivo]\n\t\t    ,fonte.[Tempo Livre]\n\t\t    ,fonte.[Pausa Particular (Intelix)]\n\t\t    ,fonte.[Pausa Break (Intelix)]\n\t\t    ,fonte.[Pausa 10 (Intelix)]\n\t\t    ,fonte.[Pausa Outbound (Intelix)]\n\t\t    ,fonte.[Pausa Lanche (Intelix)]\n\t\t    ,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,fonte.[Pausa Feedback (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,fonte.[Pausa NR17 (Intelix)]\n\t\t    ,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,fonte.[Pausa Feedback (EPBX)]\n\t\t    ,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,fonte.[Pausa Login (EPBX)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,fonte.[Pausa NR17 (EPBX)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,fonte.[Pausa Lanche (EPBX)]\n\t\t    ,fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,fonte.[Pausa Descanso (Genesys)]\n\t \t    ,fonte.[Pausa Feedback (Genesys)]\n\t \t    ,fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,fonte.[Criados]\n\t\t    ,fonte.[Tratados]\n\t\t    ,fonte.[Tempo Total de Tratativa]\n\t\t    ,fonte.[TMT]\n\t\t    ,fonte.[N\u00e3o Resolvidos]\n\t\t    ,fonte.[Replicas]\n\t\t    ,fonte.[Reincidentes 48h]\n\t\t    ,fonte.[Reincidentes 30d]\n\n            ,fonte.[SLA TPR]\n            ,fonte.[SLA TES]\n            ,fonte.[SLA TTR]\n\n\t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Inbound - TMC]\n\t\t    ,fonte.[Inbound - TMA]\n\t\t    ,fonte.[Inbound - TME]\n\t\t    ,fonte.[Inbound - TMO]\n\t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Inbound - % Abandono]\n\n\t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Outbound - TMC]\n\t\t    ,fonte.[Outbound - TMA]\n\t\t    ,fonte.[Outbound - TME]\n\t\t    ,fonte.[Outbound - TMO]\n\t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Outbound - % Abandono]\n\n\t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,fonte.[Promotoras]\n\t\t    ,fonte.[Neutras]\n\t\t    ,fonte.[Detratoras]\n            ,fonte.[NPS]\n\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Oferta],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Resposta],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Em Espera],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Transferir],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - Abandono],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - % Resposta],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - % Abandono],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - % NS],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - % Alvos do NS],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - VMA],0)\n            --,ISNULL(fonte.[Genesys Provis\u00f3rio - TPC],0)\n\n\t\t    ,fonte.[Teve Evento de MOP?]\n\t\t    ,fonte.[Teve Evento de Tickets?]\n\t\t    ,fonte.[Teve Evento de Chamadas?]\n\t\t    ,fonte.[Teve Evento de NPS?]\n\t\t    ,fonte.[Teve Evento de Log?]\n\t\t    ,fonte.[Teve Evento de Forecast?]\n    \t\t)\n\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n\t\t    -- destino.[DataHora]                                                                          = fonte.[DataHora]\n\t\t    --,destino.[Intervalo]                                                                         = fonte.[Intervalo]\n\t\t     destino.[Data]                                                                              = fonte.[Data]\n\t\t    ,destino.[Ciclo (Primeiro Dia)]                                                              = fonte.[Ciclo (Primeiro Dia)]\n\t\t    ,destino.[M\u00eas (Primeiro Dia)]                                                                = fonte.[M\u00eas (Primeiro Dia)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n\t\t    ,destino.[Cliente]                                                                           = fonte.[Cliente]\n\t\t    ,destino.[Projeto]                                                                           = fonte.[Projeto]\n\t\t    ,destino.[Tribo]                                                                             = fonte.[Tribo]\n\t\t    ,destino.[Tribo Completa]                                                                    = fonte.[Tribo Completa]\n\n\t\t    ,destino.[Trabalhado (Ponto)]                                                                = fonte.[Trabalhado (Ponto)]\n\t\t    ,destino.[Em Pausa (Ponto)]                                                                  = fonte.[Em Pausa (Ponto)]\n\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t = fonte.[Desvio Ponto-Log]\n\n            ,destino.[Forecast HC Taxa 1]                                                                = fonte.[Forecast HC Taxa 1]\n            ,destino.[Forecast HC Taxa 2]                                                                = fonte.[Forecast HC Taxa 2]\n            ,destino.[Forecast Pausas Taxa 1]                                                            = fonte.[Forecast Pausas Taxa 1]\n            ,destino.[Forecast Pausas Taxa 2]                                                            = fonte.[Forecast Pausas Taxa 2]\n            ,destino.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                                          = fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                                      = fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]                                            = fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Volume]                                                                   = fonte.[Forecast Volume]\n            --,destino.[Forecast Volume M\u00eas - Provis\u00f3rio]                                                  = fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,destino.[Forecast Log]                                                                      = fonte.[Forecast Log]\n            ,destino.[Forecast Log Produtivo]                                                            = fonte.[Forecast Log Produtivo]\n            ,destino.[Forecast NS]                                                                       = fonte.[Forecast NS]\n            --,destino.[Forecast NS M\u00eas - Provis\u00f3rio]                                                      = fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,destino.[Forecast TMT]                                                                      = fonte.[Forecast TMT]\n            ,destino.[Forecast TMA]                                                                      = fonte.[Forecast TMA]\n            ,destino.[Forecast SLA]                                                                      = fonte.[Forecast SLA]\n            ,destino.[Forecast Abandono]                                                                 = fonte.[Forecast Abandono]\n            ,destino.[Forecast NPS]                                                                      = fonte.[Forecast NPS]\n            ,destino.[Forecast Casos N\u00e3o Resolvidos]                                                     = fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,destino.[Forecast Rechamada]                                                                = fonte.[Forecast Rechamada]\n            ,destino.[Forecast Short Call]                                                               = fonte.[Forecast Short Call]\n            ,destino.[Forecast Instabilidade]                                                            = fonte.[Forecast Instabilidade]\n            ,destino.[Forecast Phishing]                                                                 = fonte.[Forecast Phishing]\n\n            ,destino.[Ader\u00eancia Log]                                                                     = fonte.[Ader\u00eancia Log]\n            ,destino.[Ader\u00eancia Log 102%]                                                                = fonte.[Ader\u00eancia Log 102%]\n            ,destino.[Ader\u00eancia Log Produtivo]                                                           = fonte.[Ader\u00eancia Log Produtivo]\n            ,destino.[Ader\u00eancia Log Produtivo 102%]                                                      = fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,destino.[Ader\u00eancia TMT]                                                                     = fonte.[Ader\u00eancia TMT]\n            ,destino.[Ader\u00eancia TMA]                                                                     = fonte.[Ader\u00eancia TMA]\n            ,destino.[Ader\u00eancia SLA]                                                                     = fonte.[Ader\u00eancia SLA]\n            ,destino.[Ader\u00eancia NS]                                                                      = fonte.[Ader\u00eancia NS]\n            ,destino.[Ader\u00eancia Abandono]                                                                = fonte.[Ader\u00eancia Abandono]\n            --,destino.[Ader\u00eancia NPS]                                                                     = fonte.[Ader\u00eancia NPS]\n            ,destino.[Ader\u00eancia Casos N\u00e3o Resolvidos]                                                    = fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n            --,destino.[Ader\u00eancia Rechamada]                                                               = fonte.[Ader\u00eancia Rechamada]\n            --,destino.[Ader\u00eancia Short Call]                                                              = fonte.[Ader\u00eancia Short Call]\n            --,destino.[Ader\u00eancia Instabilidade]                                                           = fonte.[Ader\u00eancia Instabilidade]\n            --,destino.[Ader\u00eancia Phishing]                                                                = fonte.[Ader\u00eancia Phishing]\n\n            --,destino.[Penalidade TMT]                                                                    = fonte.[Penalidade TMT]\n            --,destino.[Penalidade TMA]                                                                    = fonte.[Penalidade TMA]\n            --,destino.[Penalidade SLA]                                                                    = fonte.[Penalidade SLA]\n            --,destino.[Penalidade NS]                                                                     = fonte.[Penalidade NS]\n            --,destino.[Penalidade Abandono]                                                               = fonte.[Penalidade Abandono]\n            --,destino.[Penalidade NPS]                                                                    = fonte.[Penalidade NPS]\n            --,destino.[Penalidade Casos N\u00e3o Resolvidos]                                                   = fonte.[Penalidade Casos N\u00e3o Resolvidos]\n            --,destino.[Penalidade Rechamada]                                                              = fonte.[Penalidade Rechamada]\n            --,destino.[Penalidade Short Call]                                                             = fonte.[Penalidade Short Call]\n            --,destino.[Penalidade Instabilidade]                                                          = fonte.[Penalidade Instabilidade]\n            --,destino.[Penalidade Phishing]                                                               = fonte.[Penalidade Phishing]\n\n            --,destino.[PAs Contratadas]                                                                   = fonte.[PAs Contratadas]\n            --,destino.[Valor da PA]                                                                       = fonte.[Valor da PA]\n            --,destino.[Faturamento Antes das Penalidades]                                                 = fonte.[Faturamento Antes das Penalidades]\n            --,destino.[Faturamento Ap\u00f3s Penalidades]                                                      = fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,destino.[Log]                                                                               = fonte.[Log]\n            ,destino.[Log 102%]                                                                          = fonte.[Log 102%]\n            ,destino.[Log Perdido (>102%)]                                                               = fonte.[Log Perdido (>102%)]\n\t\t    ,destino.[Log Produtivo]                                                                     = fonte.[Log Produtivo]\n            ,destino.[Log Produtivo 102%]                                                                = fonte.[Log Produtivo 102%]\n            ,destino.[Log Produtivo Perdido (>102%)]                                                     = fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,destino.[Log HE]                                                                            = fonte.[Log HE]\n\t\t    ,destino.[Log descartado (>2HE)]                                                             = fonte.[Log descartado (>2HE)]\n\t\t    ,destino.[Log Improdutivo]                                                                   = fonte.[Log Improdutivo]\n\t\t    ,destino.[Tempo Livre]                                                                       = fonte.[Tempo Livre]\n\t\t    ,destino.[Pausa Particular (Intelix)]                                                        = fonte.[Pausa Particular (Intelix)]\n\t\t    ,destino.[Pausa Break (Intelix)]                                                             = fonte.[Pausa Break (Intelix)]\n\t\t    ,destino.[Pausa 10 (Intelix)]                                                                = fonte.[Pausa 10 (Intelix)]\n\t\t    ,destino.[Pausa Outbound (Intelix)]                                                          = fonte.[Pausa Outbound (Intelix)]\n\t\t    ,destino.[Pausa Lanche (Intelix)]                                                            = fonte.[Pausa Lanche (Intelix)]\n\t\t    ,destino.[Pausa R\u00e1pida (Intelix)]                                                            = fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Intelix)]                                                            = fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,destino.[Pausa Feedback (Intelix)]                                                          = fonte.[Pausa Feedback (Intelix)]\n\t\t    ,destino.[Pausa Sistema Interno (Intelix)]                                                   = fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,destino.[Pausa Sistema Externo (Intelix)]                                                   = fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,destino.[Pausa Treinamento (Intelix)]                                                       = fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,destino.[Pausa Banheiro (Intelix)]                                                          = fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (Intelix)]                                                           = fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Intelix)]                                                       = fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,destino.[Pausa NR17 (Intelix)]                                                              = fonte.[Pausa NR17 (Intelix)]\n\t\t    ,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]                                                              = fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (EPBX)]                                                               = fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,destino.[Pausa Tratativa (EPBX)]                                                            = fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,destino.[Pausa Discagem Manual (EPBX)]                                                      = fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,destino.[Pausa Banheiro (EPBX)]                                                             = fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,destino.[Pausa WhatsApp (EPBX)]                                                             = fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,destino.[Pausa Intervalo (EPBX)]                                                            = fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,destino.[Pausa Discagem Retorno (EPBX)]                                                     = fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,destino.[Pausa Treinamento (EPBX)]                                                          = fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,destino.[Pausa Feedback (EPBX)]                                                             = fonte.[Pausa Feedback (EPBX)]\n\t\t    ,destino.[Pausa Transfer\u00eancia (EPBX)]                                                        = fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,destino.[Pausa N\u00e3o Disponivel (EPBX)]                                                       = fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,destino.[Pausa Login (EPBX)]                                                                = fonte.[Pausa Login (EPBX)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (EPBX)]                                                              = fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Sistema Interno (EPBX)]                                                      = fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,destino.[Pausa Sistema Externo (EPBX)]                                                      = fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,destino.[Pausa NR17 (EPBX)]                                                                 = fonte.[Pausa NR17 (EPBX)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (EPBX)]                                                          = fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,destino.[Pausa P\u00f3s Atendimento (EPBX)]                                                      = fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,destino.[Pausa Lanche (EPBX)]                                                               = fonte.[Pausa Lanche (EPBX)]\n\t\t    ,destino.[Pausa BackOffice (EPBX)]                                                           = fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Genesys)]                                                            = fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Genesys)]                                                       = fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,destino.[Pausa Banheiro (Genesys)]                                                          = fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,destino.[Pausa Descanso (Genesys)]                                                          = fonte.[Pausa Descanso (Genesys)]\n\t \t    ,destino.[Pausa Feedback (Genesys)]                                                          = fonte.[Pausa Feedback (Genesys)]\n\t \t    ,destino.[Pausa Backoffice (Genesys)]                                                        = fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,destino.[Pausa Discagem Manual (Genesys)]                                                   = fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,destino.[Pausa Discagem Retorno (Genesys)]                                                  = fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,destino.[Pausa Dispon\u00edvel (Genesys)]                                                        = fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,destino.[Pausa Em Fila (Genesys)]                                                           = fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,destino.[Pausa Sistema Externo (Genesys)]                                                   = fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,destino.[Pausa Sistema Interno (Genesys)]                                                   = fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,destino.[Pausa Tratativa (Genesys)]                                                         = fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,destino.[Pausa Whatsapp (Genesys)]                                                          = fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,destino.[Pausa Treinamento (Genesys)]                                                       = fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,destino.[Criados]                                                                           = fonte.[Criados]\n\t\t    ,destino.[Tratados]                                                                          = fonte.[Tratados]\n\t\t    ,destino.[Tempo Total de Tratativa]                                                          = fonte.[Tempo Total de Tratativa]\n\t\t    ,destino.[TMT]                                                                               = fonte.[TMT]\n\t\t    ,destino.[N\u00e3o Resolvidos]                                                                    = fonte.[N\u00e3o Resolvidos]\n\t\t    ,destino.[Replicas]                                                                          = fonte.[Replicas]\n\t\t    ,destino.[Reincidentes 48h]                                                                  = fonte.[Reincidentes 48h]\n\t\t    ,destino.[Reincidentes 30d]                                                                  = fonte.[Reincidentes 30d]\n\n            ,destino.[SLA TPR]                                                                           = fonte.[SLA TPR]\n            ,destino.[SLA TES]                                                                           = fonte.[SLA TES]\n            ,destino.[SLA TTR]                                                                           = fonte.[SLA TTR]\n\n\t\t    ,destino.[Inbound - Chamadas Iniciadas]                                                      = fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas]                                                      = fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]                                           = fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Inbound - Chamadas Em Andamento]                                                   = fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,destino.[Inbound - Chamadas Finalizadas]                                                    = fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,destino.[Inbound - Chamadas Transferidas]                                                   = fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]                            = fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]                        = fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]                             = fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]                       = fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]                                      = fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]                                  = fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]                                       = fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]                                 = fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Atendimentos Iniciados]                                                  = fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,destino.[Inbound - Atendimentos Em Andamento]                                               = fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Inbound - Atendimentos Finalizados]                                                = fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,destino.[Inbound - TMC]                                                                     = fonte.[Inbound - TMC]\n\t\t    ,destino.[Inbound - TMA]                                                                     = fonte.[Inbound - TMA]\n\t\t    ,destino.[Inbound - TME]                                                                     = fonte.[Inbound - TME]\n\t\t    ,destino.[Inbound - TMO]                                                                     = fonte.[Inbound - TMO]\n\t\t    ,destino.[Inbound - % Nivel de Servi\u00e7o]                                                      = fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Inbound - Chamadas Abandonadas]                                                    = fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,destino.[Inbound - % Abandono]                                                              = fonte.[Inbound - % Abandono]\n\n\t\t    ,destino.[Outbound - Chamadas Iniciadas]                                                     = fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas]                                                     = fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]                                          = fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Outbound - Chamadas Em Andamento]                                                  = fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,destino.[Outbound - Chamadas Finalizadas]                                                   = fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,destino.[Outbound - Chamadas Transferidas]                                                  = fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]                           = fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]                       = fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]                            = fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]                      = fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]                                     = fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]                                 = fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]                                      = fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]                                = fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Atendimentos Iniciados]                                                 = fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,destino.[Outbound - Atendimentos Em Andamento]                                              = fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Outbound - Atendimentos Finalizados]                                               = fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,destino.[Outbound - TMC]                                                                    = fonte.[Outbound - TMC]\n\t\t    ,destino.[Outbound - TMA]                                                                    = fonte.[Outbound - TMA]\n\t\t    ,destino.[Outbound - TME]                                                                    = fonte.[Outbound - TME]\n\t\t    ,destino.[Outbound - TMO]                                                                    = fonte.[Outbound - TMO]\n\t\t    ,destino.[Outbound - % Nivel de Servi\u00e7o]                                                     = fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Outbound - Chamadas Abandonadas]                                                   = fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,destino.[Outbound - % Abandono]                                                             = fonte.[Outbound - % Abandono]\n\n\t\t    ,destino.[Avalia\u00e7\u00f5es de NPS]                                                                 = fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,destino.[Promotoras]                                                                        = fonte.[Promotoras]\n\t\t    ,destino.[Neutras]                                                                           = fonte.[Neutras]\n\t\t    ,destino.[Detratoras]                                                                        = fonte.[Detratoras]\n            ,destino.[NPS]                                                                               = fonte.[NPS]\n\n            --,destino.[Genesys Provis\u00f3rio - Oferta]                                                       = ISNULL(fonte.[Genesys Provis\u00f3rio - Oferta],0)\n            --,destino.[Genesys Provis\u00f3rio - Resposta]                                                     = ISNULL(fonte.[Genesys Provis\u00f3rio - Resposta],0)\n            --,destino.[Genesys Provis\u00f3rio - Em Espera]                                                    = ISNULL(fonte.[Genesys Provis\u00f3rio - Em Espera],0)\n            --,destino.[Genesys Provis\u00f3rio - Transferir]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - Transferir],0)\n            --,destino.[Genesys Provis\u00f3rio - Abandono]                                                     = ISNULL(fonte.[Genesys Provis\u00f3rio - Abandono],0)\n            --,destino.[Genesys Provis\u00f3rio - % Resposta]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - % Resposta],0)\n            --,destino.[Genesys Provis\u00f3rio - % Abandono]                                                   = ISNULL(fonte.[Genesys Provis\u00f3rio - % Abandono],0)\n            --,destino.[Genesys Provis\u00f3rio - % NS]                                                         = ISNULL(fonte.[Genesys Provis\u00f3rio - % NS],0)\n            --,destino.[Genesys Provis\u00f3rio - % Alvos do NS]                                                = ISNULL(fonte.[Genesys Provis\u00f3rio - % Alvos do NS],0)\n            --,destino.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)]                                      = ISNULL(fonte.[Genesys Provis\u00f3rio - TMA (Conversa\u00e7\u00e3o M\u00e9dia)],0)\n            --,destino.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)]                                  = ISNULL(fonte.[Genesys Provis\u00f3rio - TME (Tempo M\u00e9dio de Espera)],0)\n            --,destino.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)]                                       = ISNULL(fonte.[Genesys Provis\u00f3rio - TMO (Tratamento M\u00e9dio)],0)\n            --,destino.[Genesys Provis\u00f3rio - VMA]                                                          = ISNULL(fonte.[Genesys Provis\u00f3rio - VMA],0)\n            --,destino.[Genesys Provis\u00f3rio - TPC]                                                          = ISNULL(fonte.[Genesys Provis\u00f3rio - TPC],0)\n\n\t\t    ,destino.[Teve Evento de MOP?]                                                               = fonte.[Teve Evento de MOP?]\n\t\t    ,destino.[Teve Evento de Tickets?]                                                           = fonte.[Teve Evento de Tickets?]\n\t\t    ,destino.[Teve Evento de Chamadas?]                                                          = fonte.[Teve Evento de Chamadas?]\n\t\t    ,destino.[Teve Evento de NPS?]                                                               = fonte.[Teve Evento de NPS?]\n\t\t    ,destino.[Teve Evento de Log?]                                                               = fonte.[Teve Evento de Log?]\n\t\t    ,destino.[Teve Evento de Forecast?]                                                          = fonte.[Teve Evento de Forecast?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_tribo_dia\n        WHERE   [Teve Evento de MOP?]\t\t= 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0\n    \t    AND\t[Teve Evento de Forecast?]\t= 0\n\n        UPDATE r_tribo_dia\n        SET\n            --[Data]                 = CAST([DataHora] AS DATE)\n             [Ciclo (Primeiro Dia)] = DATEADD(DAY, (CASE WHEN (DATEPART(DAY, [Data]) > 21) THEN 4 ELSE ((DATEPART(DAY, [Data])-1)/7)+1 END-1)*7, DATEFROMPARTS(YEAR([Data]), MONTH([Data]), 1))\n            ,[M\u00eas (Primeiro Dia)]   = DATEFROMPARTS(YEAR([Data]), MONTH([Data]), 1)\n            ,[Cliente]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),3)\n            ,[Projeto]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),2)\n            ,[Tribo]\t\t\t       = PARSENAME(REPLACE([Tribo Completa],'__','.'),1)\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n    IF 1=0 BEGIN; PRINT '--- agrupamento tribo_m\u00eas';\n    \tSET @t_inicio_etapa = GETDATE();\n    \tBEGIN TRANSACTION tran_agrup;\n\n    \t;WITH destino AS\n    \t(\n    \t\tSELECT * FROM [r_tribo_m\u00eas]\n    \t\tWHERE [M\u00eas (Primeiro Dia)] >= DATEFROMPARTS(YEAR(@datahora_inicio ),MONTH(@datahora_inicio) ,1)\n    \t\tAND\t  [M\u00eas (Primeiro Dia)] <= DATEFROMPARTS(YEAR(@datahora_fim ),MONTH(@datahora_fim) ,1)\n    \t)\n    \tMERGE INTO destino USING\n    \t(\n            SELECT\n                 [Faturamento Ap\u00f3s Penalidades] = [Faturamento Antes das Penalidades]\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade TMT],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade TMA],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade SLA],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade NS],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Abandono],0)\n                                                  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade NPS],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Casos N\u00e3o Resolvidos],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Rechamada],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Short Call],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Instabilidade],0)\n                                              --  - ISNULL([Faturamento Antes das Penalidades]*[Penalidade Phishing],0)\n                ,*\n            FROM (\n                SELECT\n                     [Faturamento Antes das Penalidades]                            =   [Ader\u00eancia Log Produtivo 102%] * [PAs Contratadas] * [Valor da PA]\n                    ,[Penalidade TMT]                                               =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia TMT] >= [minimo] AND 1-[Ader\u00eancia TMT] <= [maximo]),0)\n                    ,[Penalidade TMA]                                               =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia TMA] >= [minimo] AND 1-[Ader\u00eancia TMA] <= [maximo]),0)\n                    ,[Penalidade SLA]                                               =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia SLA] >= [minimo] AND 1-[Ader\u00eancia SLA] <= [maximo]),0)\n                    ,[Penalidade NS]                                                =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia NS] >= [minimo] AND 1-[Ader\u00eancia NS] <= [maximo]),0)\n                    ,[Penalidade NPS]                                               =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia NPS] >= [minimo] AND 1-[Ader\u00eancia NPS] <= [maximo]),0)\n                    ,[Penalidade Abandono]                                          =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia Abandono] >= [minimo] AND 1-[Ader\u00eancia Abandono] <= [maximo]),0)\n                    ,[Penalidade Casos N\u00e3o Resolvidos]                              =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia Casos N\u00e3o Resolvidos] >= [minimo] AND 1-[Ader\u00eancia Casos N\u00e3o Resolvidos] <= [maximo]),0)\n                    --,[Penalidade Rechamada]                                       =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia ] >= [minimo] AND 1-[Ader\u00eancia ] <= [maximo]),0)\n                    --,[Penalidade Short Call]                                      =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia ] >= [minimo] AND 1-[Ader\u00eancia ] <= [maximo]),0)\n                    --,[Penalidade Instabilidade]                                   =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia ] >= [minimo] AND 1-[Ader\u00eancia ] <= [maximo]),0)\n                    --,[Penalidade Phishing]                                        =   ISNULL((SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades WHERE 1-[Ader\u00eancia ] >= [minimo] AND 1-[Ader\u00eancia ] <= [maximo]),0)\n                    ,*\n                FROM (\n                    SELECT\n                         [Ader\u00eancia Log]                    =   [Log] / NULLIF([Forecast Log],0)\n                        ,[Ader\u00eancia Log 102%]               =   [Log 102%] / NULLIF([Forecast Log],0)\n                        ,[Ader\u00eancia Log Produtivo]          =   [Log Produtivo] / NULLIF([Forecast Log Produtivo],0)\n                        ,[Ader\u00eancia Log Produtivo 102%]     =   [Log Produtivo 102%] / NULLIF([Forecast Log Produtivo],0)\n                        ,[Ader\u00eancia TMT]                    =   [TMT] / NULLIF([Forecast TMT],0)\n                        ,[Ader\u00eancia TMA]                    =   COALESCE([Inbound - TMA], [Outbound - TMA]) / NULLIF([Forecast TMA],0)\n                        ,[Ader\u00eancia SLA]                    =   [SLA TPR] / NULLIF([Forecast SLA],0)\n                        ,[Ader\u00eancia NS]                     =   [Inbound - % Nivel de Servi\u00e7o] / NULLIF([Forecast NS],0)\n                        ,[Ader\u00eancia NPS]                    =   [NPS] / NULLIF([Forecast NPS],0)\n                        ,[Ader\u00eancia Abandono]               =   [Inbound - % Abandono] / NULLIF([Forecast Abandono],0)\n                        ,[Ader\u00eancia Casos N\u00e3o Resolvidos]   =   [N\u00e3o Resolvidos] / NULLIF([Forecast Casos N\u00e3o Resolvidos],0)\n                        --,[Ader\u00eancia Rechamada]            =   [] / NULLIF([],0)\n                        --,[Ader\u00eancia Short Call]           =   [] / NULLIF([],0)\n                        --,[Ader\u00eancia Instabilidade]        =   [] / NULLIF([],0)\n                        --,[Ader\u00eancia Phishing]             =   [] / NULLIF([],0)\n                        ,*\n                    FROM (\n    \t            \tSELECT\n    \t            \t\t [M\u00eas (Primeiro Dia)]\t\t\t\t                            =\t[M\u00eas (Primeiro Dia)]\n\n\n                            --,[Feriado (Nome)]                                               =  MAX([Feriado (Nome)])\n\n       \t                    ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  =   ISNULL(SUM([Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]              ),0)\n       \t                    ,[Secullum - Suspens\u00e3o por advert\u00eancia]                             =   ISNULL(SUM([Secullum - Suspens\u00e3o por advert\u00eancia]                         ),0)\n       \t                    ,[Secullum - Servi\u00e7o Militar]                                       =   ISNULL(SUM([Secullum - Servi\u00e7o Militar]                                   ),0)\n                            ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      =   ISNULL(SUM([Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]  ),0)\n       \t                    ,[Secullum - Licen\u00e7a Paternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Paternidade]                               ),0)\n       \t                    ,[Secullum - Licen\u00e7a Maternidade]                                   =   ISNULL(SUM([Secullum - Licen\u00e7a Maternidade]                               ),0)\n       \t                    ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         =   ISNULL(SUM([Secullum - Licen\u00e7a Luto (Atestado Obito)]                     ),0)\n       \t                    ,[Secullum - Licen\u00e7a Casamento]                                     =   ISNULL(SUM([Secullum - Licen\u00e7a Casamento]                                 ),0)\n                            ,[Secullum - INSS - Afastamento]                                    =   ISNULL(SUM([Secullum - INSS - Afastamento]                                ),0)\n                            ,[Secullum - Folga]                                                 =   ISNULL(SUM([Secullum - Folga]                                             ),0)\n                            ,[Secullum - F\u00e9rias]                                                =   ISNULL(SUM([Secullum - F\u00e9rias]                                            ),0)\n       \t                    ,[Secullum - Feriado]                                               =   ISNULL(SUM([Secullum - Feriado]                                           ),0)\n       \t                    ,[Secullum - Falta Justificada]                                     =   ISNULL(SUM([Secullum - Falta Justificada]                                 ),0)\n       \t                    ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    =   ISNULL(SUM([Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]),0)\n                            ,[Secullum - Falta Injustificada]                                   =   ISNULL(SUM([Secullum - Falta Injustificada]                               ),0)\n       \t                    ,[Secullum - Prova de Vestibular / ENEM]                            =   ISNULL(SUM([Secullum - Prova de Vestibular / ENEM]                        ),0)\n       \t                    ,[Secullum - Doa\u00e7\u00e3o de Sangue]                                      =   ISNULL(SUM([Secullum - Doa\u00e7\u00e3o de Sangue]                                  ),0)\n                            ,[Secullum - Desligue]                                              =   ISNULL(SUM([Secullum - Desligue]                                          ),0)\n       \t                    ,[Secullum - Convoca\u00e7\u00e3o Judicial]                                   =   ISNULL(SUM([Secullum - Convoca\u00e7\u00e3o Judicial]                               ),0)\n       \t                    ,[Secullum - Compensando Horas]                                     =   ISNULL(SUM([Secullum - Compensando Horas]                                 ),0)\n       \t                    ,[Secullum - Atestado]                                              =   ISNULL(SUM([Secullum - Atestado]                                          ),0)\n                            ,[Secullum - Abono]                                                 =   ISNULL(SUM([Secullum - Abono]                                             ),0)\n       \t                    ,[Secullum - Abono Lactante]                                        =   ISNULL(SUM([Secullum - Abono Lactante]                                    ),0)\n       \t                    ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         =   ISNULL(SUM([Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]     ),0)\n       \t                    ,[Faltas Justificadas]                                              =   ISNULL(SUM([Faltas Justificadas]                                          ),0)\n       \t                    ,[Faltas Injustificadas]                                            =   ISNULL(SUM([Faltas Injustificadas]                                        ),0)\n\n    \t            \t\t,[Cliente]\t\t\t\t\t\t\t                            =\tMIN([Cliente])\n    \t            \t\t,[Projeto]\t\t\t\t\t\t\t                            =\tMIN([Projeto])\n    \t            \t\t,[Tribo]\t\t\t\t\t\t\t                            =\tMIN([Tribo])\n    \t            \t\t,[Tribo Completa]\t\t\t\t\t                            =\tMIN([Tribo Completa])\n\n\t\t                    ,[Trabalhado (Ponto)]\t\t\t\t\t\t\t                =   SUM([Trabalhado (Ponto)])\n\t\t                    ,[Em Pausa (Ponto)]\t\t\t\t\t\t\t\t                =   SUM([Em Pausa (Ponto)])\n\t\t\t\t\t\t\t,[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t=\tSUM([Desvio Ponto-Log])\n\n                            ,[Forecast HC Taxa 1]                                           =   MAX([Forecast HC Taxa 1])\n                            ,[Forecast HC Taxa 2]                                           =   MAX([Forecast HC Taxa 2])\n                            ,[Forecast Pausas Taxa 1]                                       =   MAX([Forecast Pausas Taxa 1])\n                            ,[Forecast Pausas Taxa 2]                                       =   MAX([Forecast Pausas Taxa 2])\n                            ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                     =   MAX([Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio])\n                            ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                 =   MAX([Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio])\n                            ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t\t                =   MAX([Forecast PA Liquida (VOZ) - Provis\u00f3rio])\n                            ,[Forecast Volume]\t\t                       \t                =   SUM([Forecast Volume])\n                            ,[Forecast Volume M\u00eas - Provis\u00f3rio]                             =   MAX(m.[Forecast Volume M\u00eas - Provis\u00f3rio])\n                            ,[Forecast Log]                                                 =   SUM([Forecast Log])\n                            ,[Forecast Log Produtivo]                                       =   SUM([Forecast Log Produtivo])\n                            ,[Forecast NS]                                                  =   MAX(m.[Forecast NS M\u00eas - Provis\u00f3rio])--MAX([Forecast NS])\n                            ,[Forecast NS M\u00eas - Provis\u00f3rio]                                 =   MAX(m.[Forecast NS M\u00eas - Provis\u00f3rio])\n\n                            ,[Forecast TMT]                                                 =   MAX(m.[Forecast TMT])\n                            ,[Forecast TMA]                                                 =   MAX(m.[Forecast TMA])\n                            ,[Forecast SLA]                                                 =   MAX(m.[Forecast SLA])\n                            ,[Forecast NPS]                                                 =   MAX(m.[Forecast NPS])\n                            ,[Forecast Abandono]                                            =   MAX(m.[Forecast Abandono])\n                            ,[Forecast Casos N\u00e3o Resolvidos]                                =   MAX(m.[Forecast Casos N\u00e3o Resolvidos])\n                            ,[Forecast Rechamada]                                           =   MAX(m.[Forecast Rechamada])\n                            ,[Forecast Short Call]                                          =   MAX(m.[Forecast Short Call])\n                            ,[Forecast Instabilidade]                                       =   MAX(m.[Forecast Instabilidade])\n                            ,[Forecast Phishing]                                            =   MAX(m.[Forecast Phishing])\n\n                            ,[PAs Contratadas]                                              =   MAX([PAs Contratadas])\n                            ,[Valor da PA]                                                  =   MAX([Valor da PA])\n\n\t\t                    ,[Log]\t\t\t\t\t\t\t\t\t\t\t                =   SUM([Log])\n                            ,[Log 102%]                                                     =   SUM([Log 102%])\n                            ,[Log Perdido (>102%)]                                          =   SUM([Log Perdido (>102%)])\n\t\t                    ,[Log Produtivo]\t\t\t\t\t\t\t\t                =   SUM([Log Produtivo])\n                            ,[Log Produtivo 102%]                                           =   SUM([Log Produtivo 102%])\n                            ,[Log Produtivo Perdido (>102%)]                                =   SUM([Log Produtivo Perdido (>102%)])\n\t\t                    ,[Log HE]\t\t\t\t\t\t\t\t\t\t                =   SUM([Log HE])\n\t\t                    ,[Log descartado (>2HE)]\t\t\t\t\t\t                =   SUM([Log descartado (>2HE)])\n\t\t                    ,[Log Improdutivo]\t\t\t\t\t\t\t\t                =   SUM([Log Improdutivo])\n\t\t                    ,[Tempo Livre]\t\t\t\t\t\t\t\t\t                =   SUM([Tempo Livre])\n\t\t                    ,[Pausa Particular (Intelix)]\t\t\t\t\t                =   SUM([Pausa Particular (Intelix)])\n\t\t                    ,[Pausa Break (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Break (Intelix)])\n\t\t                    ,[Pausa 10 (Intelix)]\t\t\t\t\t\t\t                =   SUM([Pausa 10 (Intelix)])\n\t\t                    ,[Pausa Outbound (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Outbound (Intelix)])\n\t\t                    ,[Pausa Lanche (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Lanche (Intelix)])\n\t\t                    ,[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa R\u00e1pida (Intelix)])\n\t\t                    ,[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Almo\u00e7o (Intelix)])\n\t\t                    ,[Pausa Feedback (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Feedback (Intelix)])\n\t\t                    ,[Pausa Sistema Interno (Intelix)]\t\t\t\t                =   SUM([Pausa Sistema Interno (Intelix)])\n\t\t                    ,[Pausa Sistema Externo (Intelix)]\t\t\t\t                =   SUM([Pausa Sistema Externo (Intelix)])\n\t\t                    ,[Pausa Treinamento (Intelix)]\t\t\t\t\t                =   SUM([Pausa Treinamento (Intelix)])\n\t\t                    ,[Pausa Banheiro (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Banheiro (Intelix)])\n\t\t                    ,[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t                =   SUM([Pausa Reuni\u00e3o (Intelix)])\n\t\t                    ,[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t                =   SUM([Pausa Ambulat\u00f3rio (Intelix)])\n\t\t                    ,[Pausa NR17 (Intelix)]\t\t\t\t\t\t\t                =   SUM([Pausa NR17 (Intelix)])\n\t\t                    ,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Liga\u00e7\u00e3o (EPBX)])\n\t\t                    ,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Almo\u00e7o (EPBX)])\n\t\t                    ,[Pausa Tratativa (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Tratativa (EPBX)])\n\t\t                    ,[Pausa Discagem Manual (EPBX)]\t\t\t\t\t                =   SUM([Pausa Discagem Manual (EPBX)])\n\t\t                    ,[Pausa Banheiro (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Banheiro (EPBX)])\n\t\t                    ,[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa WhatsApp (EPBX)])\n\t\t                    ,[Pausa Intervalo (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Intervalo (EPBX)])\n\t\t                    ,[Pausa Discagem Retorno (EPBX)]\t\t\t\t                =   SUM([Pausa Discagem Retorno (EPBX)])\n\t\t                    ,[Pausa Treinamento (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Treinamento (EPBX)])\n\t\t                    ,[Pausa Feedback (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Feedback (EPBX)])\n\t\t                    ,[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t                =   SUM([Pausa Transfer\u00eancia (EPBX)])\n\t\t                    ,[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t                =   SUM([Pausa N\u00e3o Disponivel (EPBX)])\n\t\t                    ,[Pausa Login (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Login (EPBX)])\n\t\t                    ,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Reuni\u00e3o (EPBX)])\n\t\t                    ,[Pausa Sistema Interno (EPBX)]\t\t\t\t\t                =   SUM([Pausa Sistema Interno (EPBX)])\n\t\t                    ,[Pausa Sistema Externo (EPBX)]\t\t\t\t\t                =   SUM([Pausa Sistema Externo (EPBX)])\n\t\t                    ,[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa NR17 (EPBX)])\n\t\t                    ,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa Ambulat\u00f3rio (EPBX)])\n\t\t                    ,[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t                =   SUM([Pausa P\u00f3s Atendimento (EPBX)])\n\t\t                    ,[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t                =   SUM([Pausa Lanche (EPBX)])\n\t\t                    ,[Pausa BackOffice (EPBX)]\t\t\t\t\t\t                =   SUM([Pausa BackOffice (EPBX)])\n\t\t                    ,[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Almo\u00e7o (Genesys)])\n\t\t                    ,[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t                =   SUM([Pausa Ambulat\u00f3rio (Genesys)])\n\t \t                    ,[Pausa Banheiro (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Banheiro (Genesys)])\n\t \t                    ,[Pausa Descanso (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Descanso (Genesys)])\n\t \t                    ,[Pausa Feedback (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Feedback (Genesys)])\n\t \t                    ,[Pausa Backoffice (Genesys)]\t\t\t\t\t                =   SUM([Pausa Backoffice (Genesys)])\n\t \t                    ,[Pausa Discagem Manual (Genesys)]\t\t\t\t                =   SUM([Pausa Discagem Manual (Genesys)])\n\t \t                    ,[Pausa Discagem Retorno (Genesys)]\t\t\t\t                =   SUM([Pausa Discagem Retorno (Genesys)])\n\t \t                    ,[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t                =   SUM([Pausa Dispon\u00edvel (Genesys)])\n\t \t                    ,[Pausa Em Fila (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Em Fila (Genesys)])\n\t \t                    ,[Pausa Sistema Externo (Genesys)]\t\t\t\t                =   SUM([Pausa Sistema Externo (Genesys)])\n\t \t                    ,[Pausa Sistema Interno (Genesys)]\t\t\t\t                =   SUM([Pausa Sistema Interno (Genesys)])\n\t \t                    ,[Pausa Tratativa (Genesys)]\t\t\t\t\t                =   SUM([Pausa Tratativa (Genesys)])\n\t \t                    ,[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t                =   SUM([Pausa Whatsapp (Genesys)])\n\t\t                    ,[Pausa Treinamento (Genesys)]\t\t\t\t\t                =   SUM([Pausa Treinamento (Genesys)])\n\n    \t            \t\t,[Criados]\t\t\t\t\t\t\t                            =\tSUM([Criados])\n    \t            \t\t,[Tratados]\t\t\t\t\t\t\t                            =\tSUM([Tratados])\n    \t            \t\t,[Tempo Total de Tratativa]\t\t\t                            =\tSUM([Tempo Total de Tratativa])\n    \t            \t\t,[TMT]\t\t\t\t\t\t\t\t                            =\tISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n    \t            \t\t,[N\u00e3o Resolvidos]\t\t\t\t\t                            =\tSUM([N\u00e3o Resolvidos])\n    \t            \t\t,[Replicas]\t\t\t\t\t\t\t                            =\tSUM([Replicas])\n    \t            \t\t,[Reincidentes 48h]\t\t\t\t\t                            =\tSUM([Reincidentes 48h])\n    \t            \t\t,[Reincidentes 30d]\t\t\t\t\t                            =\tSUM([Reincidentes 30d])\n\n                            ,[SLA TPR]                                                      =   AVG(s.[SLA TPR])\n                            ,[SLA TES]                                                      =   AVG(s.[SLA TES])\n                            ,[SLA TTR]                                                      =   AVG(s.[SLA TTR])\n\n    \t            \t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Iniciadas])\n    \t            \t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas])\n    \t            \t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t            \t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Em Andamento])\n    \t            \t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Finalizadas])\n    \t            \t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Transferidas])\n    \t            \t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Espera (Independente do Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Chamada (Neste Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM([Inbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Espera (Neste Intervalo)])\n    \t            \t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Inbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t            \t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Iniciados])\n    \t            \t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Em Andamento])\n    \t            \t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Finalizados])\n    \t            \t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t            \t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t            \t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n    \t            \t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n    \t            \t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t            \t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Abandonadas])\n    \t            \t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Inbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n    \t            \t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Iniciadas])\n    \t            \t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas])\n    \t            \t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])\n    \t            \t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Em Andamento])\n    \t            \t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Finalizadas])\n    \t            \t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Transferidas])\n    \t            \t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Chamada (Independente do Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Espera (Independente do Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM([Outbound - Tempo Em Chamada (Neste Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Atendimento (Neste Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Outbound - Tempo Em Espera (Neste Intervalo)])\n    \t            \t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Encerramento (Neste Intervalo)])\n    \t            \t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Iniciados])\n    \t            \t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Em Andamento])\n    \t            \t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Finalizados])\n    \t            \t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t            \t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t            \t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n    \t            \t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n    \t            \t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n    \t            \t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Abandonadas])\n    \t            \t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(CAST(SUM([Outbound - Chamadas Iniciadas]) AS DECIMAL),0),0)\n\n    \t            \t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t                            =\tSUM([Avalia\u00e7\u00f5es de NPS])\n    \t            \t\t,[Promotoras]\t\t\t\t\t\t                            =\tSUM([Promotoras])\n    \t            \t\t,[Neutras]\t\t\t\t\t\t\t                            = \tSUM([Neutras])\n    \t            \t\t,[Detratoras]\t\t\t\t\t\t                            = \tSUM([Detratoras])\n    \t            \t\t,[NPS]\t\t\t\t\t\t\t\t                            =\tCAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(18,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\n    \t            \t\t,[Teve Evento de MOP?]\t\t\t\t                            = \tIIF(SUM([Teve Evento de MOP?])=0,0,1)\n    \t            \t\t,[Teve Evento de Tickets?]\t\t\t                            = \tIIF(SUM([Teve Evento de Tickets?])=0,0,1)\n    \t            \t\t,[Teve Evento de Chamadas?]\t\t\t                            = \tIIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n    \t            \t\t,[Teve Evento de NPS?]\t\t\t\t                            = \tIIF(SUM([Teve Evento de NPS?])=0,0,1)\n    \t            \t\t,[Teve Evento de Log?]\t\t\t\t                            = \tIIF(SUM([Teve Evento de Log?])=0,0,1)\n    \t            \t\t,[Teve Evento de Forecast?]\t\t\t                            = \tIIF(SUM([Teve Evento de Forecast?])=0,0,1)\n\n    \t            \tFROM r_tribo_dia r\n                        FULL OUTER JOIN (\n                            SELECT\n                             [m_Tribo]  = [tribo]\n                            ,[m_M\u00eas]    = [m\u00eas]\n                            ,[Forecast Volume M\u00eas - Provis\u00f3rio] = [volume_projetado] -- S\u00f3 pra valida\u00e7\u00e3o, pra ver se t\u00e1 batendo com a dim_forecast_30min\n                            ,[Forecast NS M\u00eas - Provis\u00f3rio] = [NS]\n                            ,[Forecast TMT] = IIF([tribo] in ('Central de Ajuda - Autentica\u00e7\u00e3o', 'Central de Ajuda - Produtos', 'Reclame Aqui', 'GOV', 'Self Setup', 'BackOffice', 'Chat'), [tmt_segundos], 0)\n                            ,[Forecast TMA] = IIF([tribo] in ('BackOffice', '0800 Premium', 'SAC', 'Cadastro Positivo'), [tmt_segundos], 0)\n                            ,[Forecast SLA] = [SLA]\n                            ,[Forecast Abandono] = [abandono]\n                            ,[Forecast NPS] = [NPS]\n                            ,[Forecast Casos N\u00e3o Resolvidos] = [casos_n\u00e3o_resolvidos]\n                            ,[Forecast Rechamada] = [rechamada]\n                            ,[Forecast Short Call] = [short_call]\n                            ,[Forecast Instabilidade] = [instabilidade]\n                            ,[Forecast Phishing] = [phishing]\n                            ,[PAs Contratadas] = [hc_tx1] + [hc_tx2]\n                            ,[Valor da PA] = [valor_pa]\n                            FROM (\n                                SELECT [n]=ROW_NUMBER() OVER (PARTITION BY [tribo], [m\u00eas] ORDER BY [data_recebimento]), *\n                                FROM [db_serasa_producao].[dbo].dim_forecast_metas\n                            ) _\n                            WHERE [n] = 1\n                        ) m\n                        ON  r.[Tribo] = m.[m_tribo]\n                        AND r.[M\u00eas (Primeiro Dia)] = m.[m_m\u00eas]\n\n                        LEFT JOIN (\n                            SELECT\n                             [m_Tribo]  = [tribo_serasa]\n                            ,[m_M\u00eas]    = DATEFROMPARTS(YEAR([data]),MONTH([data]) ,1)\n                            ,[SLA TPR]  = AVG([primeira_resposta_s])\n                            ,[SLA TES]  = AVG([espera_solicitante_s])\n                            ,[SLA TTR]  = AVG([total_resolucao_s])\n                            FROM (\n                                SELECT [n]=ROW_NUMBER() OVER (PARTITION BY [tribo_serasa], EOMONTH([data]) ORDER BY [data]), *\n                                FROM [db_serasa_producao].[dbo].dim_teste_sla\n                            ) _\n                            WHERE [n] = 1\n                            GROUP BY [tribo_serasa], DATEFROMPARTS(YEAR([data]),MONTH([data]) ,1)\n                        ) s\n                        ON  r.[Tribo] = s.[m_tribo]\n                        AND r.[M\u00eas (Primeiro Dia)] = s.[m_m\u00eas]\n    \t            \tWHERE   [M\u00eas (Primeiro Dia)] >= DATEFROMPARTS(YEAR(@datahora_inicio ),MONTH(@datahora_inicio) ,1)\n    \t            \t    AND\t[M\u00eas (Primeiro Dia)] <= DATEFROMPARTS(YEAR(@datahora_fim ),MONTH(@datahora_fim) ,1)\n    \t            \tGROUP BY [M\u00eas (Primeiro Dia)], [Tribo Completa]\n                    ) _\n                ) _\n            ) _\n    \t) AS fonte\n    \tON  fonte.[M\u00eas (Primeiro Dia)]  = destino.[M\u00eas (Primeiro Dia)]\n    \tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n    \tWHEN NOT MATCHED BY TARGET THEN\n    \tINSERT\n    \t\t(\n\t\t     [M\u00eas (Primeiro Dia)]\n\n            --[Feriado (Nome)]\n\n       \t        ,[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,[Secullum - Servi\u00e7o Militar]\n                ,[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,[Secullum - Licen\u00e7a Paternidade]\n       \t        ,[Secullum - Licen\u00e7a Maternidade]\n       \t        ,[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,[Secullum - Licen\u00e7a Casamento]\n                ,[Secullum - INSS - Afastamento]\n                ,[Secullum - Folga]\n                ,[Secullum - F\u00e9rias]\n       \t        ,[Secullum - Feriado]\n       \t        ,[Secullum - Falta Justificada]\n       \t        ,[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,[Secullum - Falta Injustificada]\n       \t        ,[Secullum - Prova de Vestibular / ENEM]\n       \t        ,[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,[Secullum - Desligue]\n       \t        ,[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,[Secullum - Compensando Horas]\n       \t        ,[Secullum - Atestado]\n                ,[Secullum - Abono]\n       \t        ,[Secullum - Abono Lactante]\n       \t        ,[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,[Faltas Justificadas]\n       \t        ,[Faltas Injustificadas]\n\n\t\t    ,[Cliente]\n\t\t    ,[Projeto]\n\t\t    ,[Tribo]\n\t\t    ,[Tribo Completa]\n\n\t\t    ,[Trabalhado (Ponto)]\n\t\t    ,[Em Pausa (Ponto)]\n\t\t\t,[Desvio Ponto-Log]\n\n            ,[Forecast HC Taxa 1]\n            ,[Forecast HC Taxa 2]\n            ,[Forecast Pausas Taxa 1]\n            ,[Forecast Pausas Taxa 2]\n            ,[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,[Forecast Volume]\n            ,[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,[Forecast Log]\n            ,[Forecast Log Produtivo]\n            ,[Forecast NS]\n            ,[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,[Forecast TMT]\n            ,[Forecast TMA]\n            ,[Forecast SLA]\n            ,[Forecast Abandono]\n            ,[Forecast NPS]\n            ,[Forecast Casos N\u00e3o Resolvidos]\n            ,[Forecast Rechamada]\n            ,[Forecast Short Call]\n            ,[Forecast Instabilidade]\n            ,[Forecast Phishing]\n\n            ,[Ader\u00eancia Log]\n            ,[Ader\u00eancia Log 102%]\n            ,[Ader\u00eancia Log Produtivo]\n            ,[Ader\u00eancia Log Produtivo 102%]\n            ,[Ader\u00eancia TMT]\n            ,[Ader\u00eancia TMA]\n            ,[Ader\u00eancia SLA]\n            ,[Ader\u00eancia NS]\n            ,[Ader\u00eancia Abandono]\n            ,[Ader\u00eancia NPS]\n            ,[Ader\u00eancia Casos N\u00e3o Resolvidos]\n\n            ,[Penalidade TMT]\n            ,[Penalidade TMA]\n            ,[Penalidade SLA]\n            ,[Penalidade NS]\n            ,[Penalidade Abandono]\n            ,[Penalidade NPS]\n            ,[Penalidade Casos N\u00e3o Resolvidos]\n\n            ,[PAs Contratadas]\n            ,[Valor da PA]\n            ,[Faturamento Antes das Penalidades]\n            ,[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,[Log]\n            ,[Log 102%]\n            ,[Log Perdido (>102%)]\n\t\t    ,[Log Produtivo]\n            ,[Log Produtivo 102%]\n            ,[Log Produtivo Perdido (>102%)]\n\t\t    ,[Log HE]\n\t\t    ,[Log descartado (>2HE)]\n\t\t    ,[Log Improdutivo]\n\t\t    ,[Tempo Livre]\n\t\t    ,[Pausa Particular (Intelix)]\n\t\t    ,[Pausa Break (Intelix)]\n\t\t    ,[Pausa 10 (Intelix)]\n\t\t    ,[Pausa Outbound (Intelix)]\n\t\t    ,[Pausa Lanche (Intelix)]\n\t\t    ,[Pausa R\u00e1pida (Intelix)]\n\t\t    ,[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,[Pausa Feedback (Intelix)]\n\t\t    ,[Pausa Sistema Interno (Intelix)]\n\t\t    ,[Pausa Sistema Externo (Intelix)]\n\t\t    ,[Pausa Treinamento (Intelix)]\n\t\t    ,[Pausa Banheiro (Intelix)]\n\t\t    ,[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,[Pausa NR17 (Intelix)]\n\t\t    ,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,[Pausa Tratativa (EPBX)]\n\t\t    ,[Pausa Discagem Manual (EPBX)]\n\t\t    ,[Pausa Banheiro (EPBX)]\n\t\t    ,[Pausa WhatsApp (EPBX)]\n\t\t    ,[Pausa Intervalo (EPBX)]\n\t\t    ,[Pausa Discagem Retorno (EPBX)]\n\t\t    ,[Pausa Treinamento (EPBX)]\n\t\t    ,[Pausa Feedback (EPBX)]\n\t\t    ,[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,[Pausa Login (EPBX)]\n\t\t    ,[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,[Pausa Sistema Interno (EPBX)]\n\t\t    ,[Pausa Sistema Externo (EPBX)]\n\t\t    ,[Pausa NR17 (EPBX)]\n\t\t    ,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,[Pausa Lanche (EPBX)]\n\t\t    ,[Pausa BackOffice (EPBX)]\n\t\t    ,[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,[Pausa Banheiro (Genesys)]\n\t \t    ,[Pausa Descanso (Genesys)]\n\t \t    ,[Pausa Feedback (Genesys)]\n\t \t    ,[Pausa Backoffice (Genesys)]\n\t \t    ,[Pausa Discagem Manual (Genesys)]\n\t \t    ,[Pausa Discagem Retorno (Genesys)]\n\t \t    ,[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,[Pausa Em Fila (Genesys)]\n\t \t    ,[Pausa Sistema Externo (Genesys)]\n\t \t    ,[Pausa Sistema Interno (Genesys)]\n\t \t    ,[Pausa Tratativa (Genesys)]\n\t \t    ,[Pausa Whatsapp (Genesys)]\n\t\t    ,[Pausa Treinamento (Genesys)]\n\n\t\t    ,[Criados]\n\t\t    ,[Tratados]\n\t\t    ,[Tempo Total de Tratativa]\n\t\t    ,[TMT]\n\t\t    ,[N\u00e3o Resolvidos]\n\t\t    ,[Replicas]\n\t\t    ,[Reincidentes 48h]\n\t\t    ,[Reincidentes 30d]\n\n            ,[SLA TPR]\n            ,[SLA TES]\n            ,[SLA TTR]\n\n\t\t    ,[Inbound - Chamadas Iniciadas]\n\t\t    ,[Inbound - Chamadas Atendidas]\n\t\t    ,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Inbound - Chamadas Em Andamento]\n\t\t    ,[Inbound - Chamadas Finalizadas]\n\t\t    ,[Inbound - Chamadas Transferidas]\n\t\t    ,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Inbound - Atendimentos Iniciados]\n\t\t    ,[Inbound - Atendimentos Em Andamento]\n\t\t    ,[Inbound - Atendimentos Finalizados]\n\t\t    ,[Inbound - TMC]\n\t\t    ,[Inbound - TMA]\n\t\t    ,[Inbound - TME]\n\t\t    ,[Inbound - TMO]\n\t\t    ,[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Inbound - Chamadas Abandonadas]\n\t\t    ,[Inbound - % Abandono]\n\n\t\t    ,[Outbound - Chamadas Iniciadas]\n\t\t    ,[Outbound - Chamadas Atendidas]\n\t\t    ,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,[Outbound - Chamadas Em Andamento]\n\t\t    ,[Outbound - Chamadas Finalizadas]\n\t\t    ,[Outbound - Chamadas Transferidas]\n\t\t    ,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,[Outbound - Atendimentos Iniciados]\n\t\t    ,[Outbound - Atendimentos Em Andamento]\n\t\t    ,[Outbound - Atendimentos Finalizados]\n\t\t    ,[Outbound - TMC]\n\t\t    ,[Outbound - TMA]\n\t\t    ,[Outbound - TME]\n\t\t    ,[Outbound - TMO]\n\t\t    ,[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,[Outbound - Chamadas Abandonadas]\n\t\t    ,[Outbound - % Abandono]\n\n\t\t    ,[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,[Promotoras]\n\t\t    ,[Neutras]\n\t\t    ,[Detratoras]\n\t\t    ,[NPS]\n\n\t\t    ,[Teve Evento de MOP?]\n\t\t    ,[Teve Evento de Tickets?]\n\t\t    ,[Teve Evento de Chamadas?]\n\t\t    ,[Teve Evento de NPS?]\n\t\t    ,[Teve Evento de Log?]\n\t\t    ,[Teve Evento de Forecast?]\n\n    \t\t)\n    \t\tVALUES\n    \t\t(\n\t\t     fonte.[M\u00eas (Primeiro Dia)]\n\n            --[Feriado (Nome)]\n\n       \t        ,fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,fonte.[Secullum - Servi\u00e7o Militar]\n                ,fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,fonte.[Secullum - Licen\u00e7a Casamento]\n                ,fonte.[Secullum - INSS - Afastamento]\n                ,fonte.[Secullum - Folga]\n                ,fonte.[Secullum - F\u00e9rias]\n       \t        ,fonte.[Secullum - Feriado]\n       \t        ,fonte.[Secullum - Falta Justificada]\n       \t        ,fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,fonte.[Secullum - Falta Injustificada]\n       \t        ,fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,fonte.[Secullum - Desligue]\n       \t        ,fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,fonte.[Secullum - Compensando Horas]\n       \t        ,fonte.[Secullum - Atestado]\n                ,fonte.[Secullum - Abono]\n       \t        ,fonte.[Secullum - Abono Lactante]\n       \t        ,fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,fonte.[Faltas Justificadas]\n       \t        ,fonte.[Faltas Injustificadas]\n\n\n\t\t    ,fonte.[Cliente]\n\t\t    ,fonte.[Projeto]\n\t\t    ,fonte.[Tribo]\n\t\t    ,fonte.[Tribo Completa]\n\n\t\t    ,fonte.[Trabalhado (Ponto)]\n\t\t    ,fonte.[Em Pausa (Ponto)]\n\t\t\t,fonte.[Desvio Ponto-Log]\n\n            ,fonte.[Forecast HC Taxa 1]\n            ,fonte.[Forecast HC Taxa 2]\n            ,fonte.[Forecast Pausas Taxa 1]\n            ,fonte.[Forecast Pausas Taxa 2]\n            ,fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,fonte.[Forecast Volume]\n            ,fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,fonte.[Forecast Log]\n            ,fonte.[Forecast Log Produtivo]\n            ,fonte.[Forecast NS]\n            ,fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,fonte.[Forecast TMT]\n            ,fonte.[Forecast TMA]\n            ,fonte.[Forecast SLA]\n            ,fonte.[Forecast Abandono]\n            ,fonte.[Forecast NPS]\n            ,fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,fonte.[Forecast Rechamada]\n            ,fonte.[Forecast Short Call]\n            ,fonte.[Forecast Instabilidade]\n            ,fonte.[Forecast Phishing]\n\n            ,fonte.[Ader\u00eancia Log]\n            ,fonte.[Ader\u00eancia Log 102%]\n            ,fonte.[Ader\u00eancia Log Produtivo]\n            ,fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,fonte.[Ader\u00eancia TMT]\n            ,fonte.[Ader\u00eancia TMA]\n            ,fonte.[Ader\u00eancia SLA]\n            ,fonte.[Ader\u00eancia NS]\n            ,fonte.[Ader\u00eancia Abandono]\n            ,fonte.[Ader\u00eancia NPS]\n            ,fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n\n            ,fonte.[Penalidade TMT]\n            ,fonte.[Penalidade TMA]\n            ,fonte.[Penalidade SLA]\n            ,fonte.[Penalidade NS]\n            ,fonte.[Penalidade Abandono]\n            ,fonte.[Penalidade NPS]\n            ,fonte.[Penalidade Casos N\u00e3o Resolvidos]\n\n            ,fonte.[PAs Contratadas]\n            ,fonte.[Valor da PA]\n            ,fonte.[Faturamento Antes das Penalidades]\n            ,fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,fonte.[Log]\n            ,fonte.[Log 102%]\n            ,fonte.[Log Perdido (>102%)]\n\t\t    ,fonte.[Log Produtivo]\n            ,fonte.[Log Produtivo 102%]\n            ,fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,fonte.[Log HE]\n\t\t    ,fonte.[Log descartado (>2HE)]\n\t\t    ,fonte.[Log Improdutivo]\n\t\t    ,fonte.[Tempo Livre]\n\t\t    ,fonte.[Pausa Particular (Intelix)]\n\t\t    ,fonte.[Pausa Break (Intelix)]\n\t\t    ,fonte.[Pausa 10 (Intelix)]\n\t\t    ,fonte.[Pausa Outbound (Intelix)]\n\t\t    ,fonte.[Pausa Lanche (Intelix)]\n\t\t    ,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,fonte.[Pausa Feedback (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,fonte.[Pausa NR17 (Intelix)]\n\t\t    ,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,fonte.[Pausa Feedback (EPBX)]\n\t\t    ,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,fonte.[Pausa Login (EPBX)]\n\t\t    ,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,fonte.[Pausa NR17 (EPBX)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,fonte.[Pausa Lanche (EPBX)]\n\t\t    ,fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,fonte.[Pausa Descanso (Genesys)]\n\t \t    ,fonte.[Pausa Feedback (Genesys)]\n\t \t    ,fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,fonte.[Criados]\n\t\t    ,fonte.[Tratados]\n\t\t    ,fonte.[Tempo Total de Tratativa]\n\t\t    ,fonte.[TMT]\n\t\t    ,fonte.[N\u00e3o Resolvidos]\n\t\t    ,fonte.[Replicas]\n\t\t    ,fonte.[Reincidentes 48h]\n\t\t    ,fonte.[Reincidentes 30d]\n\n            ,fonte.[SLA TPR]\n            ,fonte.[SLA TES]\n            ,fonte.[SLA TTR]\n\n\t\t    ,fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Inbound - TMC]\n\t\t    ,fonte.[Inbound - TMA]\n\t\t    ,fonte.[Inbound - TME]\n\t\t    ,fonte.[Inbound - TMO]\n\t\t    ,fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Inbound - % Abandono]\n\n\t\t    ,fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,fonte.[Outbound - TMC]\n\t\t    ,fonte.[Outbound - TMA]\n\t\t    ,fonte.[Outbound - TME]\n\t\t    ,fonte.[Outbound - TMO]\n\t\t    ,fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,fonte.[Outbound - % Abandono]\n\n\t\t    ,fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,fonte.[Promotoras]\n\t\t    ,fonte.[Neutras]\n\t\t    ,fonte.[Detratoras]\n\t\t    ,fonte.[NPS]\n\n\t\t    ,fonte.[Teve Evento de MOP?]\n\t\t    ,fonte.[Teve Evento de Tickets?]\n\t\t    ,fonte.[Teve Evento de Chamadas?]\n\t\t    ,fonte.[Teve Evento de NPS?]\n\t\t    ,fonte.[Teve Evento de Log?]\n\t\t    ,fonte.[Teve Evento de Forecast?]\n\n    \t\t)\n    \tWHEN MATCHED THEN\n    \t\tUPDATE SET\n\t\t     destino.[M\u00eas (Primeiro Dia)]\t\t\t\t                              = fonte.[M\u00eas (Primeiro Dia)]\n\n            --,destino.[Feriado (Nome)]                                     =   fonte.[Feriado (Nome)]\n\n       \t        ,destino.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]                  = fonte.[Secullum - Suspens\u00e3o CTT (Contrato de Trabalho)]\n       \t        ,destino.[Secullum - Suspens\u00e3o por advert\u00eancia]                             = fonte.[Secullum - Suspens\u00e3o por advert\u00eancia]\n       \t        ,destino.[Secullum - Servi\u00e7o Militar]                                       = fonte.[Secullum - Servi\u00e7o Militar]\n                ,destino.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]      = fonte.[Secullum - Motivo de For\u00e7a Maior (usar com aprova\u00e7\u00e3o de RT)]\n       \t        ,destino.[Secullum - Licen\u00e7a Paternidade]                                   = fonte.[Secullum - Licen\u00e7a Paternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Maternidade]                                   = fonte.[Secullum - Licen\u00e7a Maternidade]\n       \t        ,destino.[Secullum - Licen\u00e7a Luto (Atestado Obito)]                         = fonte.[Secullum - Licen\u00e7a Luto (Atestado Obito)]\n       \t        ,destino.[Secullum - Licen\u00e7a Casamento]                                     = fonte.[Secullum - Licen\u00e7a Casamento]\n                ,destino.[Secullum - INSS - Afastamento]                                    = fonte.[Secullum - INSS - Afastamento]\n                ,destino.[Secullum - Folga]                                                 = fonte.[Secullum - Folga]\n                ,destino.[Secullum - F\u00e9rias]                                                = fonte.[Secullum - F\u00e9rias]\n       \t        ,destino.[Secullum - Feriado]                                               = fonte.[Secullum - Feriado]\n       \t        ,destino.[Secullum - Falta Justificada]                                     = fonte.[Secullum - Falta Justificada]\n       \t        ,destino.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]    = fonte.[Secullum - Falta Injust. / Abandono (+15d Ininterrupto Falta)]\n                ,destino.[Secullum - Falta Injustificada]                                   = fonte.[Secullum - Falta Injustificada]\n       \t        ,destino.[Secullum - Prova de Vestibular / ENEM]                            = fonte.[Secullum - Prova de Vestibular / ENEM]\n       \t        ,destino.[Secullum - Doa\u00e7\u00e3o de Sangue]                                      = fonte.[Secullum - Doa\u00e7\u00e3o de Sangue]\n                ,destino.[Secullum - Desligue]                                              = fonte.[Secullum - Desligue]\n       \t        ,destino.[Secullum - Convoca\u00e7\u00e3o Judicial]                                   = fonte.[Secullum - Convoca\u00e7\u00e3o Judicial]\n       \t        ,destino.[Secullum - Compensando Horas]                                     = fonte.[Secullum - Compensando Horas]\n       \t        ,destino.[Secullum - Atestado]                                              = fonte.[Secullum - Atestado]\n                ,destino.[Secullum - Abono]                                                 = fonte.[Secullum - Abono]\n       \t        ,destino.[Secullum - Abono Lactante]                                        = fonte.[Secullum - Abono Lactante]\n       \t        ,destino.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]         = fonte.[Secullum - Abono - Elei\u00e7\u00f5es (Quando Trabalha em Elei\u00e7\u00e3o)]\n       \t        ,destino.[Faltas Justificadas]                                              = fonte.[Faltas Justificadas]\n       \t        ,destino.[Faltas Injustificadas]                                            = fonte.[Faltas Injustificadas]\n\n\t\t    ,destino.[Cliente]\t\t\t\t\t\t\t                              = fonte.[Cliente]\n\t\t    ,destino.[Projeto]\t\t\t\t\t\t\t                              = fonte.[Projeto]\n\t\t    ,destino.[Tribo]\t\t\t\t\t\t\t                              = fonte.[Tribo]\n\t\t    ,destino.[Tribo Completa]\t\t\t\t\t                              = fonte.[Tribo Completa]\n\n\t\t    ,destino.[Trabalhado (Ponto)]\t\t\t\t\t\t\t\t\t          = fonte.[Trabalhado (Ponto)]\n\t\t    ,destino.[Em Pausa (Ponto)]\t\t\t\t\t\t\t\t\t\t          = fonte.[Em Pausa (Ponto)]\n\t\t\t,destino.[Desvio Ponto-Log]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Desvio Ponto-Log]\n\n            ,destino.[Forecast HC Taxa 1]                                             = fonte.[Forecast HC Taxa 1]\n            ,destino.[Forecast HC Taxa 2]                                             = fonte.[Forecast HC Taxa 2]\n            ,destino.[Forecast Pausas Taxa 1]                                         = fonte.[Forecast Pausas Taxa 1]\n            ,destino.[Forecast Pausas Taxa 2]                                         = fonte.[Forecast Pausas Taxa 2]\n            ,destino.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]                       = fonte.[Forecast Pausa Almo\u00e7o (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]                   = fonte.[Forecast Agentes em Pausa (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\t                      = fonte.[Forecast PA Liquida (VOZ) - Provis\u00f3rio]\n            ,destino.[Forecast Volume]\t\t                                          = fonte.[Forecast Volume]\n            ,destino.[Forecast Volume M\u00eas - Provis\u00f3rio]                               = fonte.[Forecast Volume M\u00eas - Provis\u00f3rio]\n            ,destino.[Forecast Log]                                                   = fonte.[Forecast Log]\n            ,destino.[Forecast Log Produtivo]                                         = fonte.[Forecast Log Produtivo]\n            ,destino.[Forecast NS]                                                    = fonte.[Forecast NS]\n            ,destino.[Forecast NS M\u00eas - Provis\u00f3rio]                                   = fonte.[Forecast NS M\u00eas - Provis\u00f3rio]\n\n            ,destino.[Forecast TMT]                                                   = fonte.[Forecast TMT]\n            ,destino.[Forecast TMA]                                                   = fonte.[Forecast TMA]\n            ,destino.[Forecast SLA]                                                   = fonte.[Forecast SLA]\n            ,destino.[Forecast Abandono]                                              = fonte.[Forecast Abandono]\n            ,destino.[Forecast NPS]                                                   = fonte.[Forecast NPS]\n            ,destino.[Forecast Casos N\u00e3o Resolvidos]                                  = fonte.[Forecast Casos N\u00e3o Resolvidos]\n            ,destino.[Forecast Rechamada]                                             = fonte.[Forecast Rechamada]\n            ,destino.[Forecast Short Call]                                            = fonte.[Forecast Short Call]\n            ,destino.[Forecast Instabilidade]                                         = fonte.[Forecast Instabilidade]\n            ,destino.[Forecast Phishing]                                              = fonte.[Forecast Phishing]\n\n            ,destino.[Ader\u00eancia Log]                                                  = fonte.[Ader\u00eancia Log]\n            ,destino.[Ader\u00eancia Log 102%]                                             = fonte.[Ader\u00eancia Log 102%]\n            ,destino.[Ader\u00eancia Log Produtivo]                                        = fonte.[Ader\u00eancia Log Produtivo]\n            ,destino.[Ader\u00eancia Log Produtivo 102%]                                   = fonte.[Ader\u00eancia Log Produtivo 102%]\n            ,destino.[Ader\u00eancia TMT]                                                  = fonte.[Ader\u00eancia TMT]\n            ,destino.[Ader\u00eancia TMA]                                                  = fonte.[Ader\u00eancia TMA]\n            ,destino.[Ader\u00eancia SLA]                                                  = fonte.[Ader\u00eancia SLA]\n            ,destino.[Ader\u00eancia NS]                                                   = fonte.[Ader\u00eancia NS]\n            ,destino.[Ader\u00eancia Abandono]                                             = fonte.[Ader\u00eancia Abandono]\n            ,destino.[Ader\u00eancia NPS]                                                  = fonte.[Ader\u00eancia NPS]\n            ,destino.[Ader\u00eancia Casos N\u00e3o Resolvidos]                                 = fonte.[Ader\u00eancia Casos N\u00e3o Resolvidos]\n\n            ,destino.[Penalidade TMT]                                                 = fonte.[Penalidade TMT]\n            ,destino.[Penalidade TMA]                                                 = fonte.[Penalidade TMA]\n            ,destino.[Penalidade SLA]                                                 = fonte.[Penalidade SLA]\n            ,destino.[Penalidade NS]                                                  = fonte.[Penalidade NS]\n            ,destino.[Penalidade Abandono]                                            = fonte.[Penalidade Abandono]\n            ,destino.[Penalidade NPS]                                                 = fonte.[Penalidade NPS]\n            ,destino.[Penalidade Casos N\u00e3o Resolvidos]                                = fonte.[Penalidade Casos N\u00e3o Resolvidos]\n\n            ,destino.[PAs Contratadas]                                                = fonte.[PAs Contratadas]\n            ,destino.[Valor da PA]                                                    = fonte.[Valor da PA]\n            ,destino.[Faturamento Antes das Penalidades]                              = fonte.[Faturamento Antes das Penalidades]\n            ,destino.[Faturamento Ap\u00f3s Penalidades]                                   = fonte.[Faturamento Ap\u00f3s Penalidades]\n\n\t\t    ,destino.[Log]\t\t\t\t\t\t\t\t\t\t\t\t\t          = fonte.[Log]\n            ,destino.[Log 102%]                                                       = fonte.[Log 102%]\n            ,destino.[Log Perdido (>102%)]                                            = fonte.[Log Perdido (>102%)]\n\t\t    ,destino.[Log Produtivo]\t\t\t\t\t\t\t\t\t\t          = fonte.[Log Produtivo]\n            ,destino.[Log Produtivo 102%]                                             = fonte.[Log Produtivo 102%]\n            ,destino.[Log Produtivo Perdido (>102%)]                                  = fonte.[Log Produtivo Perdido (>102%)]\n\t\t    ,destino.[Log HE]\t\t\t\t\t\t\t\t\t\t\t\t\t      = fonte.[Log HE]\n\t\t    ,destino.[Log descartado (>2HE)]\t\t\t\t\t\t\t\t          = fonte.[Log descartado (>2HE)]\n\t\t    ,destino.[Log Improdutivo]\t\t\t\t\t\t\t\t\t\t          = fonte.[Log Improdutivo]\n\t\t    ,destino.[Tempo Livre]\t\t\t\t\t\t\t\t\t\t\t          = fonte.[Tempo Livre]\n\t\t    ,destino.[Pausa Particular (Intelix)]\t\t\t\t\t\t\t          = fonte.[Pausa Particular (Intelix)]\n\t\t    ,destino.[Pausa Break (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Break (Intelix)]\n\t\t    ,destino.[Pausa 10 (Intelix)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa 10 (Intelix)]\n\t\t    ,destino.[Pausa Outbound (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Outbound (Intelix)]\n\t\t    ,destino.[Pausa Lanche (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Lanche (Intelix)]\n\t\t    ,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t    ,destino.[Pausa Feedback (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Feedback (Intelix)]\n\t\t    ,destino.[Pausa Sistema Interno (Intelix)]\t\t\t\t\t\t          = fonte.[Pausa Sistema Interno (Intelix)]\n\t\t    ,destino.[Pausa Sistema Externo (Intelix)]\t\t\t\t\t\t          = fonte.[Pausa Sistema Externo (Intelix)]\n\t\t    ,destino.[Pausa Treinamento (Intelix)]\t\t\t\t\t\t\t          = fonte.[Pausa Treinamento (Intelix)]\n\t\t    ,destino.[Pausa Banheiro (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Banheiro (Intelix)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t\t\t          = fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t    ,destino.[Pausa NR17 (Intelix)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa NR17 (Intelix)]\n\t\t    ,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t    ,destino.[Pausa Tratativa (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Tratativa (EPBX)]\n\t\t    ,destino.[Pausa Discagem Manual (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa Discagem Manual (EPBX)]\n\t\t    ,destino.[Pausa Banheiro (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Banheiro (EPBX)]\n\t\t    ,destino.[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa WhatsApp (EPBX)]\n\t\t    ,destino.[Pausa Intervalo (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Intervalo (EPBX)]\n\t\t    ,destino.[Pausa Discagem Retorno (EPBX)]\t\t\t\t\t\t          = fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t    ,destino.[Pausa Treinamento (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Treinamento (EPBX)]\n\t\t    ,destino.[Pausa Feedback (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Feedback (EPBX)]\n\t\t    ,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t    ,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t    ,destino.[Pausa Login (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Login (EPBX)]\n\t\t    ,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t    ,destino.[Pausa Sistema Interno (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa Sistema Interno (EPBX)]\n\t\t    ,destino.[Pausa Sistema Externo (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa Sistema Externo (EPBX)]\n\t\t    ,destino.[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa NR17 (EPBX)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t    ,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t\t\t          = fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t    ,destino.[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t\t\t          = fonte.[Pausa Lanche (EPBX)]\n\t\t    ,destino.[Pausa BackOffice (EPBX)]\t\t\t\t\t\t\t\t          = fonte.[Pausa BackOffice (EPBX)]\n\t\t    ,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t    ,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t \t    ,destino.[Pausa Banheiro (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Banheiro (Genesys)]\n\t \t    ,destino.[Pausa Descanso (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Descanso (Genesys)]\n\t \t    ,destino.[Pausa Feedback (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Feedback (Genesys)]\n\t \t    ,destino.[Pausa Backoffice (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Backoffice (Genesys)]\n\t \t    ,destino.[Pausa Discagem Manual (Genesys)]\t\t\t\t\t\t          = fonte.[Pausa Discagem Manual (Genesys)]\n\t \t    ,destino.[Pausa Discagem Retorno (Genesys)]\t\t\t\t\t\t          = fonte.[Pausa Discagem Retorno (Genesys)]\n\t \t    ,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t \t    ,destino.[Pausa Em Fila (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Em Fila (Genesys)]\n\t \t    ,destino.[Pausa Sistema Externo (Genesys)]\t\t\t\t\t\t          = fonte.[Pausa Sistema Externo (Genesys)]\n\t \t    ,destino.[Pausa Sistema Interno (Genesys)]\t\t\t\t\t\t          = fonte.[Pausa Sistema Interno (Genesys)]\n\t \t    ,destino.[Pausa Tratativa (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Tratativa (Genesys)]\n\t \t    ,destino.[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t\t\t          = fonte.[Pausa Whatsapp (Genesys)]\n\t\t    ,destino.[Pausa Treinamento (Genesys)]\t\t\t\t\t\t\t          = fonte.[Pausa Treinamento (Genesys)]\n\n\t\t    ,destino.[Criados]\t\t\t\t\t\t\t                              = fonte.[Criados]\n\t\t    ,destino.[Tratados]\t\t\t\t\t\t\t                              = fonte.[Tratados]\n\t\t    ,destino.[Tempo Total de Tratativa]\t\t\t                              = fonte.[Tempo Total de Tratativa]\n\t\t    ,destino.[TMT]\t\t\t\t\t\t\t\t                              = fonte.[TMT]\n\t\t    ,destino.[N\u00e3o Resolvidos]\t\t\t\t\t                              = fonte.[N\u00e3o Resolvidos]\n\t\t    ,destino.[Replicas]\t\t\t\t\t\t\t                              = fonte.[Replicas]\n\t\t    ,destino.[Reincidentes 48h]\t\t\t\t\t                              = fonte.[Reincidentes 48h]\n\t\t    ,destino.[Reincidentes 30d]\t\t\t\t\t                              = fonte.[Reincidentes 30d]\n\n            ,destino.[SLA TPR]                                                        = fonte.[SLA TPR]\n            ,destino.[SLA TES]                                                        = fonte.[SLA TES]\n            ,destino.[SLA TTR]                                                        = fonte.[SLA TTR]\n\n\t\t    ,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Iniciadas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Atendidas]\n\t\t    ,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Em Andamento]\n\t\t    ,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Finalizadas]\n\t\t    ,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Transferidas]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t  = fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t  = fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t  = fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t  = fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t  = fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t  = fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t  = fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t  = fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Atendimentos Iniciados]\n\t\t    ,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t  = fonte.[Inbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t  = fonte.[Inbound - Atendimentos Finalizados]\n\t\t    ,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - TMC]\n\t\t    ,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - TMA]\n\t\t    ,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - TME]\n\t\t    ,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - TMO]\n\t\t    ,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t  = fonte.[Inbound - Chamadas Abandonadas]\n\t\t    ,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Inbound - % Abandono]\n\n\t\t    ,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Iniciadas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Atendidas]\n\t\t    ,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t    ,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Em Andamento]\n\t\t    ,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Finalizadas]\n\t\t    ,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Transferidas]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t  = fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t  = fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t  = fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t  = fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t  = fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t  = fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t  = fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t  = fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t    ,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t  = fonte.[Outbound - Atendimentos Iniciados]\n\t\t    ,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t  = fonte.[Outbound - Atendimentos Em Andamento]\n\t\t    ,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t  = fonte.[Outbound - Atendimentos Finalizados]\n\t\t    ,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - TMC]\n\t\t    ,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - TMA]\n\t\t    ,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - TME]\n\t\t    ,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - TMO]\n\t\t    ,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t  = fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t    ,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t  = fonte.[Outbound - Chamadas Abandonadas]\n\t\t    ,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t  = fonte.[Outbound - % Abandono]\n\n\t\t    ,destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t                              = fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t    ,destino.[Promotoras]\t\t\t\t\t\t                              = fonte.[Promotoras]\n\t\t    ,destino.[Neutras]\t\t\t\t\t\t\t                              = fonte.[Neutras]\n\t\t    ,destino.[Detratoras]\t\t\t\t\t\t                              = fonte.[Detratoras]\n\t\t    ,destino.[NPS]\t\t\t\t\t\t\t\t                              = fonte.[NPS]\n\n\t\t    ,destino.[Teve Evento de MOP?]\t\t                                      = fonte.[Teve Evento de MOP?]\n\t\t    ,destino.[Teve Evento de Tickets?]\t                                      = fonte.[Teve Evento de Tickets?]\n\t\t    ,destino.[Teve Evento de Chamadas?]\t                                      = fonte.[Teve Evento de Chamadas?]\n\t\t    ,destino.[Teve Evento de NPS?]\t\t                                      = fonte.[Teve Evento de NPS?]\n\t\t    ,destino.[Teve Evento de Log?]\t\t                                      = fonte.[Teve Evento de Log?]\n\t\t    ,destino.[Teve Evento de Forecast?]\t\t                                  = fonte.[Teve Evento de Forecast?]\n\n    \tWHEN NOT MATCHED BY SOURCE THEN\n    \t\tDELETE;\n\n        DELETE FROM r_tribo_m\u00eas\n        WHERE   [Teve Evento de MOP?]\t\t= 0\n    \t    AND\t[Teve Evento de Tickets?]\t= 0\n    \t    AND\t[Teve Evento de Chamadas?]\t= 0\n    \t    AND\t[Teve Evento de NPS?]\t\t= 0\n    \t    AND\t[Teve Evento de Log?]\t\t= 0\n    \t    AND\t[Teve Evento de Forecast?]\t= 0\n\n        UPDATE r_tribo_m\u00eas\n        SET\n            --[Data]                 = CAST([DataHora] AS DATE)\n            --[Ciclo (Primeiro Dia)] = DATEADD(DAY, (CASE WHEN (DATEPART(DAY, [Data]) > 21) THEN 4 ELSE ((DATEPART(DAY, [Data])-1)/7)+1 END-1)*7, DATEFROMPARTS(YEAR([Data]), MONTH([Data]), 1))\n            --[M\u00eas (Primeiro Dia)]   = DATEFROMPARTS(YEAR([Data]), MONTH([Data]), 1)\n             [Cliente]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),3)\n            ,[Projeto]\t\t\t   = PARSENAME(REPLACE([Tribo Completa],'__','.'),2)\n            ,[Tribo]\t\t\t       = PARSENAME(REPLACE([Tribo Completa],'__','.'),1)\n\n\n\n    \tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n    \tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n    \tCOMMIT TRANSACTION tran_agrup;\n        END\n\n\t\n    DELETE FROM r_individuo_30min WHERE [Teve Evento de Log?] = 0;\t-- Remover depois de sinalizar o Plan.\n    DELETE FROM r_individuo_dia WHERE [Teve Evento de Log?] = 0;\t-- Remover depois de sinalizar o Plan.\n    DELETE FROM r_tribo_30min WHERE [Teve Evento de Log?] = 0;\t\t-- Remover depois de sinalizar o Plan.\n    DELETE FROM r_tribo_dia WHERE [Teve Evento de Log?] = 0;\t\t-- Remover depois de sinalizar o Plan.\n\n\n    PRINT CONCAT('Resumos atualizados (m\u00e9trica: ',@metrica,') ',@datahora_inicio,' - ',@datahora_fim, ' (dura\u00e7\u00e3o: ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio, GETDATE()), 0) as time(0)),')')\n\nGO\n",
        "build_order": 124,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]": [
                "DELETE",
                "DELETE FROM r_tribo_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]": [
                "DELETE",
                "DELETE FROM r_tribo_dia"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_m\u00eas]": [
                "UPDATE",
                "UPDATE r_tribo_m\u00eas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "DELETE",
                "DELETE FROM r_individuo_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": [
                "DELETE",
                "DELETE FROM r_individuo_dia"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_m\u00eas]": [
                "DELETE",
                "DELETE FROM r_individuo_m\u00eas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "DELETE",
                "DELETE FROM r_individuo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": [
                "DELETE",
                "DELETE FROM r_individuo_dia"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]": [
                "DELETE",
                "DELETE FROM r_tribo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "DELETE",
                "DELETE FROM r_tribo_dia"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys_manual]": [
                "UNKNOWN",
                "dim_chamadas_genesys_manual"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]": [
                "UNKNOWN",
                "dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]": [
                "UNKNOWN",
                "dim_forecast_metas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": [
                "SELECT",
                "SELECT MAX([Data]) FROM [db_serasa_producao].[dbo].dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_penalidades]": [
                "SELECT",
                "SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": [
                "UNKNOWN",
                "dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_sla]": [
                "UNKNOWN",
                "dim_teste_sla"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": [
                "UNKNOWN",
                "f_nps_v2"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_prod_d-1].[dbo].[s_att_resumos]"
            ]
        }
    },
    "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": {
        "address": "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]",
        "server": "003sql001prd",
        "database": "db_prod_d0",
        "schema": "dbo",
        "name": "sp_sys_faxina",
        "type": "StoredProcedure",
        "start": 575602,
        "end": 576172,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_faxina]    Script Date: 2024-11-03 12:54:35 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE PROCEDURE [dbo].[sp_sys_faxina] AS\n\tALTER DATABASE db_prod_d0 SET RECOVERY SIMPLE;\n\tDBCC SHRINKDATABASE(N'db_prod_d0');\n\tDBCC SHRINKFILE (N'db_prod_d0', 0);\n\tDBCC SHRINKFILE (N'db_prod_d0', 0);\n\tDBCC FREESYSTEMCACHE ('db_prod_d0');\n\tDBCC FREESYSTEMCACHE ('tempdb');\n\tDBCC FREESYSTEMCACHE ('master');\n\tDBCC FREESYSTEMCACHE ('model');\n\tDBCC FREESYSTEMCACHE ('msdb');\n\tDBCC FREEPROCCACHE;\n\tDBCC FREESESSIONCACHE;\n\n\nGO\n",
        "build_order": 125,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_app].[dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao]": {
        "address": "[003sql001prd].[db_Serasa_producao]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "",
        "name": "",
        "type": "Schema",
        "start": 3992,
        "end": 4093,
        "code": "/****** Object:  Schema [users]    Script Date: 2024-11-03 12:59:59 ******/\nCREATE SCHEMA [users]\nGO\n",
        "build_order": 126,
        "depends_on": {
            "": [
                "",
                ""
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[fx].[getNumbers]": {
        "address": "[003sql001prd].[db_Serasa_producao].[fx].[getNumbers]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "fx",
        "name": "getNumbers",
        "type": "UserDefinedFunction",
        "start": 4093,
        "end": 4679,
        "code": "/****** Object:  UserDefinedFunction [fx].[getNumbers]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n--CREATE SCHEMA fx\nCREATE FUNCTION [fx].[getNumbers]\n(\n  @strAlphaNumeric VARCHAR(MAX)\n)\nRETURNS INT\nAS\nBEGIN\n  DECLARE @intAlpha INT\n  SET @intAlpha = PATINDEX('%[^0-9]%', @strAlphaNumeric)\n  BEGIN\n    WHILE @intAlpha > 0\n    BEGIN\n      SET @strAlphaNumeric = STUFF(@strAlphaNumeric, @intAlpha, 1, '' )\n      SET @intAlpha = PATINDEX('%[^0-9]%', @strAlphaNumeric )\n    END\n  END\n  RETURN ISNULL(CAST(@strAlphaNumeric AS INT),0)\nEND\n\nGO\n",
        "build_order": 127,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[getNumbers]": [
                "CREATE",
                "CREATE FUNCTION [fx].[getNumbers]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[getNumbers]": [
                "CREATE",
                "CREATE FUNCTION [fx].[getNumbers]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]": {
        "address": "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "fx",
        "name": "PriMaiuscula",
        "type": "UserDefinedFunction",
        "start": 4679,
        "end": 6253,
        "code": "/****** Object:  UserDefinedFunction [fx].[PriMaiuscula]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n--DROP FUNCTION IF EXISTS fx.PriMaiuscula\nCREATE FUNCTION [fx].[PriMaiuscula]\n(\n--string need to format\n@string VARCHAR(MAX)--increase the variable size depending on your needs.\n)\nRETURNS VARCHAR(MAX)\nAS\n\nBEGIN\n--Declare Variables\nDECLARE @Index INT,\n@ResultString VARCHAR(MAX)--result string size should equal to the @string variable size\n--Initialize the variables\nSET @Index = 1\nSET @ResultString = ''\n--Run the Loop until END of the string\n\nWHILE (@Index <LEN(@string)+1)\nBEGIN\nIF (@Index = 1)--first letter of the string\nBEGIN\n--make the first letter capital\nSET @ResultString =\n@ResultString + UPPER(SUBSTRING(@string, @Index, 1))\nSET @Index = @Index+ 1--increase the index\nEND\n\n-- IF the previous character is space or '-' or next character is '-'\n\nELSE IF ((SUBSTRING(@string, @Index-1, 1) =' 'or SUBSTRING(@string, @Index-1, 1) ='-' or SUBSTRING(@string, @Index+1, 1) ='-') and @Index+1 <> LEN(@string))\nBEGIN\n--make the letter capital\nSET\n@ResultString = @ResultString + UPPER(SUBSTRING(@string,@Index, 1))\nSET\n@Index = @Index +1--increase the index\nEND\nELSE-- all others\nBEGIN\n-- make the letter simple\nSET\n@ResultString = @ResultString + LOWER(SUBSTRING(@string,@Index, 1))\nSET\n@Index = @Index +1--incerase the index\nEND\nEND--END of the loop\n\nIF (@@ERROR\n<> 0)-- any error occur return the sEND string\nBEGIN\nSET\n@ResultString = @string\nEND\n-- IF no error found return the new string\nRETURN @ResultString\nEND\n\nGO\n",
        "build_order": 128,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]": [
                "CREATE",
                "CREATE FUNCTION [fx].[PriMaiuscula]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]": [
                "CREATE",
                "CREATE FUNCTION [fx].[PriMaiuscula]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_forms]": [
                "UNKNOWN",
                "PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": [
                "SELECT",
                "SELECT DISTINCT fx.PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_you_gendo]": [
                "UNKNOWN",
                "PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_oneaone]": [
                "UNKNOWN",
                "PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "UNKNOWN",
                "PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "PriMaiuscula"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[fx].[SplitStringToTable]": {
        "address": "[003sql001prd].[db_Serasa_producao].[fx].[SplitStringToTable]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "fx",
        "name": "SplitStringToTable",
        "type": "UserDefinedFunction",
        "start": 6253,
        "end": 7305,
        "code": "/****** Object:  UserDefinedFunction [fx].[SplitStringToTable]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   FUNCTION [fx].[SplitStringToTable]\n(\n    @String NVARCHAR(MAX),\n    @ColumnName NVARCHAR(MAX)\n)\nRETURNS @Values TABLE\n(\n    [Value] NVARCHAR(MAX)\n)\nAS\nBEGIN\n    DECLARE @PosicaoInicial INT,\n            @PosicaoFinal INT,\n            @TamanhoSubstring INT;\n\n    SET @PosicaoInicial = 1;\n    SET @PosicaoFinal = CHARINDEX(';', @String);\n\n    WHILE @PosicaoFinal > 0\n    BEGIN\n        SET @TamanhoSubstring = @PosicaoFinal - @PosicaoInicial;\n\n        INSERT INTO @Values ([Value])\n        VALUES (SUBSTRING(@String, @PosicaoInicial, @TamanhoSubstring));\n\n        SET @PosicaoInicial = @PosicaoFinal + 1;\n        SET @PosicaoFinal = CHARINDEX(';', @String, @PosicaoInicial);\n    END\n\n    IF @PosicaoInicial <= LEN(@String)\n    BEGIN\n        INSERT INTO @Values ([Value])\n        VALUES (SUBSTRING(@String, @PosicaoInicial, LEN(@String) - @PosicaoInicial + 1));\n    END\n\n    RETURN;\nEND;\n\nGO\n",
        "build_order": 129,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[SplitStringToTable]": [
                "CREATE",
                "CREATE   FUNCTION [fx].[SplitStringToTable]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[SplitStringToTable]": [
                "CREATE",
                "CREATE   FUNCTION [fx].[SplitStringToTable]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[fx].[ToHHMMSS]": {
        "address": "[003sql001prd].[db_Serasa_producao].[fx].[ToHHMMSS]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "fx",
        "name": "ToHHMMSS",
        "type": "UserDefinedFunction",
        "start": 7305,
        "end": 8309,
        "code": "/****** Object:  UserDefinedFunction [fx].[ToHHMMSS]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\ncreate function [fx].[ToHHMMSS]\n(\n    @time decimal(28,3), \n    @unit varchar(20)\n)\nreturns varchar(20)\nas\nbegin\n\n    declare @seconds decimal(18,3), @minutes int, @hours int;\n\n    if(@unit = 'hour' or @unit = 'hh' )\n        set @seconds = @time * 60 * 60;\n    else if(@unit = 'minute' or @unit = 'mi' or @unit = 'n')\n        set @seconds = @time * 60;\n    else if(@unit = 'second' or @unit = 'ss' or @unit = 's')\n        set @seconds = @time;\n    else set @seconds = 0; -- unknown time units\n\n    set @hours = convert(int, @seconds /60 / 60);\n    set @minutes = convert(int, (@seconds / 60) - (@hours * 60 ));\n    set @seconds = @seconds % 60;\n\n    return \n        convert(varchar(9), convert(int, @hours)) + ':' +\n        right('00' + convert(varchar(2), convert(int, @minutes)), 2) + ':' +\n        right('00' + convert(varchar(6), @seconds), 6)\n\nend\n\nGO\n",
        "build_order": 130,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[ToHHMMSS]": [
                "UNKNOWN",
                "create function [fx].[ToHHMMSS]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[ToHHMMSS]": [
                "UNKNOWN",
                "create function [fx].[ToHHMMSS]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": [
                "UNKNOWN",
                "ToHHMMSS"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "UNKNOWN",
                "ToHHMMSS"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mop_eventos",
        "type": "Table",
        "start": 8309,
        "end": 9507,
        "code": "/****** Object:  Table [dbo].[dim_mop_eventos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mop_eventos](\n\t[data_atualizacao] [datetime] NOT NULL,\n\t[ID_selecionar] [varchar](30) NOT NULL,\n\t[ID_unico] [varchar](30) NULL,\n\t[ID_secullum] [int] NULL,\n\t[ID_serasa] [varchar](10) NULL,\n\t[ID_intelix] [int] NULL,\n\t[ID_epbx] [int] NULL,\n\t[ID_genesys] [varchar](100) NULL,\n\t[status] [varchar](25) NOT NULL,\n\t[situacao] [varchar](25) NOT NULL,\n\t[condicao] [varchar](25) NOT NULL,\n\t[cliente] [varchar](50) NOT NULL,\n\t[projeto] [varchar](50) NOT NULL,\n\t[cargo] [varchar](50) NOT NULL,\n\t[tribo] [varchar](50) NOT NULL,\n\t[subtribo] [varchar](50) NOT NULL,\n\t[escala] [varchar](15) NOT NULL,\n\t[jornada] [time](7) NOT NULL,\n\t[taxa] [int] NOT NULL,\n\t[pausa_manha] [time](7) NULL,\n\t[pausa_almoco] [time](7) NULL,\n\t[pausa_tarde] [time](7) NULL,\n\t[supervisao] [varchar](100) NULL,\n\t[coordenacao] [varchar](100) NULL,\n\t[gerencia] [varchar](100) NULL,\n\t[diretoria] [varchar](100) NULL,\n\t[req] [varchar](100) NULL,\n\t[dma] [int] NULL,\n\t[instrutor] [varchar](100) NULL,\n\t[tipo_dma] [varchar](50) NULL,\n\t[fonte_log] [varchar](10) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 131,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_eventos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": [
                "SELECT",
                "SELECT data_atualizacao, ID_intelix, projeto FROM dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_DMA_eventos]": [
                "UNKNOWN",
                "dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT data_atualizacao, ID_intelix, projeto FROM dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "SELECT",
                "SELECT COUNT(*) FROM dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON dim_mop_eventos"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_chamadas_intelix",
        "type": "Table",
        "start": 9507,
        "end": 10254,
        "code": "/****** Object:  Table [dbo].[dim_chamadas_intelix]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_chamadas_intelix](\n\t[id] [varchar](50) NOT NULL,\n\t[datahora] [datetime] NOT NULL,\n\t[ramal] [int] NOT NULL,\n\t[ramal_nome] [varchar](50) NOT NULL,\n\t[atendente] [int] NOT NULL,\n\t[atendente_nome] [varchar](150) NOT NULL,\n\t[telefone] [bigint] NULL,\n\t[tronco] [varchar](50) NULL,\n\t[ddr] [varchar](50) NULL,\n\t[destino_interno_tipo] [varchar](50) NULL,\n\t[destino_interno_nome] [varchar](50) NULL,\n\t[tipo_chamada] [varchar](50) NULL,\n\t[status] [varchar](50) NULL,\n\t[duracao_total] [time](7) NULL,\n\t[duracao_atendimento] [time](7) NULL,\n\t[duracao_espera] [time](7) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 132,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_chamadas_intelix]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_intelix]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_chamadas_intelix]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": [
                "UNKNOWN",
                "dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_h_detalhadas]": [
                "SELECT",
                "SELECT CAST( t0.datahora AS DATE) as data, CAST(t0.datahora as TIME)as hora, t0.atendente, t1.Tribo, t1.[Sub Tribo], t1.Projeto, t1.Cliente, t0.Status, t0.duracao_total, t0.duracao_atendimento, t0.telefone FROM dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT CAST(MAX([datahora]) AS datetime) from dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "UNKNOWN",
                "dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_intelix]": [
                "SELECT",
                "SELECT * FROM dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "SELECT",
                "SELECT TOP(3) 'INTELIX', 'CHA',[datahora] FROM [db_Serasa_producao].[dbo].[dim_chamadas_intelix]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_chamadas_intelix"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_mop_eventos",
        "type": "Table",
        "start": 10254,
        "end": 12913,
        "code": "/****** Object:  Table [dbo].[f_mop_eventos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_mop_eventos](\n\t[Data da Atualiza\u00e7\u00e3o] [datetime2](0) NULL,\n\t[ID Selecionar] [varchar](30) NOT NULL,\n\t[ID \u00danico] [varchar](30) NULL,\n\t[ID Secullum] [int] NULL,\n\t[ID Serasa] [varchar](10) NULL,\n\t[ID Intelix] [int] NULL,\n\t[ID EPBX] [int] NULL,\n\t[ID Genesys] [varchar](100) NULL,\n\t[Nome] [varchar](100) NULL,\n\t[Status] [varchar](25) NOT NULL,\n\t[Situa\u00e7\u00e3o] [varchar](25) NOT NULL,\n\t[Condi\u00e7\u00e3o] [varchar](25) NOT NULL,\n\t[Cliente] [varchar](50) NOT NULL,\n\t[Projeto] [varchar](50) NOT NULL,\n\t[Cargo] [varchar](50) NOT NULL,\n\t[Tribo] [varchar](50) NOT NULL,\n\t[Sub Tribo] [varchar](50) NOT NULL,\n\t[Escala] [varchar](15) NOT NULL,\n\t[Jornada] [time](7) NOT NULL,\n\t[Taxa] [int] NOT NULL,\n\t[Pausa Manh\u00e3] [time](7) NULL,\n\t[Pausa Almo\u00e7o] [time](7) NULL,\n\t[Pausa Tarde] [time](7) NULL,\n\t[Supervis\u00e3o] [varchar](100) NULL,\n\t[Coordena\u00e7\u00e3o] [varchar](100) NULL,\n\t[Ger\u00eancia] [varchar](100) NULL,\n\t[Diretoria] [varchar](100) NULL,\n\t[Email Selecionar] [varchar](100) NULL,\n\t[Email Serasa] [varchar](100) NULL,\n\t[Email Supervis\u00e3o] [varchar](100) NULL,\n\t[Telefone] [varchar](20) NULL,\n\t[CPF] [varchar](15) NULL,\n\t[Data de Nascimento] [date] NULL,\n\t[Nome de Registro] [varchar](100) NULL,\n\t[Sexo Biol\u00f3gico] [varchar](1) NULL,\n\t[REQ] [varchar](100) NULL,\n\t[DMA] [int] NULL,\n\t[DMA Inicial] [int] NULL,\n\t[\u00daltima DMA Migra\u00e7\u00e3o] [int] NULL,\n\t[\u00daltima DMA Geral] [int] NULL,\n\t[Tipo de DMA] [varchar](50) NULL,\n\t[Tipo da \u00daltima DMA] [varchar](50) NULL,\n\t[Instrutor] [varchar](100) NULL,\n\t[Instrutor Inicial] [varchar](100) NULL,\n\t[Instrutor \u00daltima Migra\u00e7\u00e3o] [varchar](100) NULL,\n\t[Instrutor \u00daltima DMA] [varchar](100) NULL,\n\t[Data de Admiss\u00e3o] [date] NULL,\n\t[Data de In\u00edcio em Opera\u00e7\u00e3o] [datetime] NULL,\n\t[Tempo de Casa (Dias)] [int] NULL,\n\t[Faixa Tempo de Casa] [varchar](15) NOT NULL,\n\t[Idade] [numeric](18, 0) NULL,\n\t[Faixa de Idade] [varchar](16) NOT NULL,\n\t[Data de Sa\u00edda (F\u00e9rias/Afastamento)] [datetime] NULL,\n\t[Data de Retorno (F\u00e9rias/Afastamento)] [datetime] NULL,\n\t[Data de Solicita\u00e7\u00e3o (Turnover)] [datetime] NULL,\n\t[\u00daltima Data Trabalhada (Turnover)] [datetime] NULL,\n\t[Per\u00edodo do Desligamento (Turnover)] [varchar](100) NULL,\n\t[Motivo do Desligamento (Turnover)] [varchar](100) NULL,\n\t[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)] [varchar](3) NULL,\n\t[Custo da Rescis\u00e3o (Turnover)] [float] NULL,\n\t[Data da Proxima Atualiza\u00e7\u00e3o] [datetime] NULL,\n\t[Vencimento Contrato Exp. 30d] [date] NULL,\n\t[Vencimento Contrato Exp. 60d] [date] NULL,\n\t[Vencimento Contrato Exp. 90d] [date] NULL,\n\t[Fonte de Log] [varchar](10) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 133,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mopeventos_dma_complete]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_turnover]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o], [Data da Proxima Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Intelix], [ID EPBX], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [DMA Inicial], [\u00daltima DMA Migra\u00e7\u00e3o], [\u00daltima DMA Geral], [Tipo da \u00daltima DMA], [Instrutor Inicial], [Instrutor \u00daltima Migra\u00e7\u00e3o], [Instrutor \u00daltima DMA], [Cliente], [Projeto], [Cargo], [Tribo], [Supervis\u00e3o], [Escala], [Jornada], [Taxa] FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_mop_eventos"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_chamadas_V2",
        "type": "View",
        "start": 12913,
        "end": 18229,
        "code": "/****** Object:  View [dbo].[f_chamadas_V2]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\tCREATE VIEW [dbo].[f_chamadas_V2] AS\n\n\tWITH chaves (data, atendente, data_mop)\n\tAS\n\t(\n\t\tSELECT data, atendente, data_mop FROM\n\t\t(\n\t\t\tSELECT\n\t\t\t\tt2.data,\n\t\t\t\tt2.atendente,\n\t\t\t\tMAX(t1.data_atualizacao) as data_mop\n\t\t\tFROM dim_mop_eventos AS t1\n\t\t\tRIGHT JOIN (\n\t\t\t\tSELECT CAST(datahora as DATE) as data, atendente FROM dim_chamadas_intelix\n\t\t\t\tWHERE datahora >= DATEFROMPARTS(YEAR(DATEADD(MONTH, -12, GETDATE())), MONTH(DATEADD(MONTH, -12, GETDATE())), 01)\n\t\t\t) AS t2\n\t\t\tON t2.atendente = ID_intelix\n\t\t\tAND data >= data_atualizacao\n\t\t\tGROUP BY t2.data, t2.atendente\n\t\t) AS t1\n\t\tLEFT JOIN (\n\t\t\tSELECT data_atualizacao, ID_intelix, projeto FROM dim_mop_eventos \n\t\t) AS t2\n\t\tON t1.atendente = t2.ID_intelix\n\t\tAND t1.data_mop = t2.data_atualizacao\n\t\t--WHERE projeto = 'Digital'\n\t\tGROUP BY data, atendente, data_mop\n\t),\n\tcaixa AS\n\t(\n\t\tSELECT datahora, ramal, ramal_nome, atendente, atendente_nome, tipo_chamada, duracao_atendimento, duracao_espera, duracao_total, \t\n\t\tCASE\n\t\t\tWHEN status = 'Atendida' AND DATEDIFF(s, '00:00:00', duracao_total) <= 60 THEN 'Caixa postal'\n\t\t\tELSE Status\n\t\tEND AS status\n\t\tFROM dim_chamadas_intelix\n\n\t),\n\tgrude ([Data],[ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], [Duracao Total], [Duracao Atendimento], [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status])  \n\tAS  \n\t(  \n\t\tSELECT t0.data,t0.atendente,t2.ID_selecionar,t2.ID_serasa,t2.nome,t1.status,SUM(DATEDIFF(s, '00:00:00.000', t1.duracao_total)),SUM(DATEDIFF(s, '00:00:00.000', t1.duracao_atendimento)),count(*) as chamadas,t2.tribo,t2.subtribo,t2.escala,t2.jornada,t2.supervisao,t2.coordenacao,t2.status\n\t\tFROM chaves AS t0\n\t\tLEFT JOIN (\n\t\t\tSELECT * FROM caixa\n\t\t\tWHERE datahora >= DATEFROMPARTS(YEAR(DATEADD(MONTH, -12, GETDATE())), MONTH(DATEADD(MONTH, -12, GETDATE())), 01)\n\t\t) AS t1\n\t\tON t0.atendente = t1.atendente\n\t\tAND t0.data = CAST(t1.datahora AS DATE)\n\t\tLEFT JOIN (\n\t\t\tSELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos\n\t\t) AS t2\n\t\tON t0.atendente = t2.ID_intelix\n\t\tAND t0.data_mop = t2.data_atualizacao\n\t\tGROUP BY \n\t\t\tt0.data,\n\t\t\tt0.atendente,\n\t\t\tt2.ID_selecionar,\n\t\t\tt2.ID_serasa,\n\t\t\tt2.nome,\n\t\t\tt1.status,\n\t\t\tt2.tribo,\n\t\t\tt2.subtribo,\n\t\t\tt2.escala,\n\t\t\tt2.jornada,\n\t\t\tt2.supervisao,\n\t\t\tt2.coordenacao,\n\t\t\tt2.status\n\t),\n\tquartis (mes, atendente, quartil_chamadas, quartil_tma_total, quartil_tma_atendimento)\n\tAS\n\t(\n\t\tSELECT DATEFROMPARTS(YEAR(data), MONTH(data), 01), ID_intelix,\n\n\t\tCONCAT('Q',1+(RANK() OVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01) ORDER BY count(*)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDESC)-1) * 4 /COUNT(1)\tOVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01))),\n\t\tCONCAT('Q',1+(RANK() OVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01) ORDER BY SUM([Duracao Total])/SUM([Chamadas])\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tASC)-1) * 4 /COUNT(1)\tOVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01))),\n\t\tCONCAT('Q',1+(RANK() OVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01) ORDER BY SUM([Duracao Atendimento])/NULLIF(SUM(CASE WHEN [Status Chamada]='Atendida' THEN [Chamadas] ELSE 0 END),0)\tASC)-1) * 4 /COUNT(1)\tOVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01)))\n\n\t\tFROM grude\n\t\tGROUP BY DATEFROMPARTS(YEAR(data), MONTH(data), 01), ID_intelix\n\n\t),\n\tfinal([Data], [ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], [Duracao Total], [Duracao Atendimento], [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status], [Quartil Chamadas], [Quartil TMA Total], [Quartil TMA Atendidas])  \n\tAS  \n\t(\n\t\tSELECT t1.[Data], [ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], fx.ToHHMMSS([Duracao Total], 'ss'), fx.ToHHMMSS([Duracao Atendimento], 'ss'), [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status], quartil_chamadas, quartil_tma_total, quartil_tma_atendimento\n\t\tFROM grude AS t1\n\t\tLEFT JOIN (\n\t\t\tSELECT * FROM quartis\n\t\t) AS t2\n\t\tON\tDATEFROMPARTS(YEAR(t1.data), MONTH(t1.data), 01) = t2.mes\n\t\tAND\tt1.ID_intelix = t2.atendente\n\t),\n\n\tconverter_tempo([Data], [ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], [Duracao Total], [Duracao Atendimento], [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status], [Quartil Chamadas], [Quartil TMA Total], [Quartil TMA Atendidas], [Duracao Total (s)], [Duracao Atendimento (s)])  \n\tAS  \n\t(\n\t\tSELECT [Data], [ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], [Duracao Total], [Duracao Atendimento], [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status], [Quartil Chamadas], [Quartil TMA Total], [Quartil TMA Atendidas],\n\t\n\t\tDATEDIFF(s, '00:00:00.000', [Duracao Total]) AS [Duracao Total (s)],\n\t\n\t\tDATEDIFF(s, '00:00:00.000', [Duracao Atendimento]) AS [Duracao Atendimento (s)]\n\t\tFROM final\n\n\t)\n\tSELECT * FROM converter_tempo\n\tWHERE Data >= '01/01/2023'\n\nGO\n",
        "build_order": 134,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[ToHHMMSS]": [
                "UNKNOWN",
                "ToHHMMSS"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": [
                "SELECT",
                "SELECT data_atualizacao, ID_intelix, projeto FROM dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "UNKNOWN",
                "dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_chamadas_V2]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_chamadas_V2]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT CAST(MAX([datahora]) AS datetime) from dim_chamadas_intelix) WHERE [table] = 'f_chamadas_V2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_chamadas_V2"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_mop_historico",
        "type": "Table",
        "start": 18229,
        "end": 20870,
        "code": "/****** Object:  Table [dbo].[f_mop_historico]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_mop_historico](\n\t[Data da Atualiza\u00e7\u00e3o] [date] NULL,\n\t[ID Selecionar] [varchar](30) NULL,\n\t[ID \u00danico] [varchar](30) NULL,\n\t[ID Secullum] [int] NULL,\n\t[ID Serasa] [varchar](10) NULL,\n\t[ID Intelix] [int] NULL,\n\t[ID EPBX] [int] NULL,\n\t[ID Genesys] [varchar](100) NULL,\n\t[Nome] [varchar](100) NULL,\n\t[Status] [varchar](25) NULL,\n\t[Situa\u00e7\u00e3o] [varchar](25) NULL,\n\t[Condi\u00e7\u00e3o] [varchar](25) NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Cargo] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Sub Tribo] [varchar](50) NULL,\n\t[Escala] [varchar](15) NULL,\n\t[Jornada] [time](7) NULL,\n\t[Taxa] [int] NULL,\n\t[Pausa Manh\u00e3] [time](7) NULL,\n\t[Pausa Almo\u00e7o] [time](7) NULL,\n\t[Pausa Tarde] [time](7) NULL,\n\t[Supervis\u00e3o] [varchar](100) NULL,\n\t[Coordena\u00e7\u00e3o] [varchar](100) NULL,\n\t[Ger\u00eancia] [varchar](100) NULL,\n\t[Diretoria] [varchar](100) NULL,\n\t[Email Selecionar] [varchar](100) NULL,\n\t[Email Serasa] [varchar](100) NULL,\n\t[Email Supervis\u00e3o] [varchar](100) NULL,\n\t[Telefone] [varchar](20) NULL,\n\t[CPF] [varchar](15) NULL,\n\t[Data de Nascimento] [date] NULL,\n\t[Nome de Registro] [varchar](100) NULL,\n\t[Sexo Biol\u00f3gico] [varchar](1) NULL,\n\t[REQ] [varchar](100) NULL,\n\t[DMA] [int] NULL,\n\t[DMA Inicial] [int] NULL,\n\t[\u00daltima DMA Migra\u00e7\u00e3o] [int] NULL,\n\t[\u00daltima DMA Geral] [int] NULL,\n\t[Tipo de DMA] [varchar](50) NULL,\n\t[Tipo da \u00daltima DMA] [varchar](50) NULL,\n\t[Instrutor] [varchar](100) NULL,\n\t[Instrutor Inicial] [varchar](100) NULL,\n\t[Instrutor \u00daltima Migra\u00e7\u00e3o] [varchar](100) NULL,\n\t[Instrutor \u00daltima DMA] [varchar](100) NULL,\n\t[Data de Admiss\u00e3o] [date] NULL,\n\t[Data de In\u00edcio em Opera\u00e7\u00e3o] [datetime] NULL,\n\t[Tempo de Casa (Dias)] [int] NULL,\n\t[Faixa Tempo de Casa] [varchar](15) NOT NULL,\n\t[Idade] [numeric](18, 0) NULL,\n\t[Faixa de Idade] [varchar](16) NOT NULL,\n\t[Data de Sa\u00edda (F\u00e9rias/Afastamento)] [datetime] NULL,\n\t[Data de Retorno (F\u00e9rias/Afastamento)] [datetime] NULL,\n\t[Data de Solicita\u00e7\u00e3o (Turnover)] [datetime] NULL,\n\t[\u00daltima Data Trabalhada (Turnover)] [datetime] NULL,\n\t[Per\u00edodo do Desligamento (Turnover)] [varchar](100) NULL,\n\t[Motivo do Desligamento (Turnover)] [varchar](100) NULL,\n\t[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)] [varchar](3) NULL,\n\t[Custo da Rescis\u00e3o (Turnover)] [float] NULL,\n\t[Vencimento Contrato Exp. 30d] [date] NULL,\n\t[Vencimento Contrato Exp. 60d] [date] NULL,\n\t[Vencimento Contrato Exp. 90d] [date] NULL,\n\t[Data de Entrada no Status] [date] NULL,\n\t[Data de Sa\u00edda do Status] [date] NULL,\n\t[Fonte de Log] [varchar](10) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 135,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_historico]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_historico]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_historico]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_h_detalhadas]": [
                "SELECT",
                "SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_metas]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado_semTrava]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": [
                "SELECT",
                "SELECT * FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_quadro_funcionarios_dia]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_turnover]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Selecionar] as ID_selecionar, nome, tribo, [Sub Tribo] as subtribo, [Supervis\u00e3o] as supervisao, status FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "SELECT",
                "SELECT * FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_mop_historico"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_h_detalhadas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_h_detalhadas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_chamadas_h_detalhadas",
        "type": "View",
        "start": 20870,
        "end": 24594,
        "code": "/****** Object:  View [dbo].[f_chamadas_h_detalhadas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\tCREATE VIEW [dbo].[f_chamadas_h_detalhadas] AS\n\n\tWITH inicio(data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, duracao_total, duracao_atendimento, telefone)\n\tAs\n\t(\n\t\tSELECT CAST( t0.datahora AS DATE) as data, CAST(t0.datahora as TIME)as hora, t0.atendente, t1.Tribo, t1.[Sub Tribo], t1.Projeto, t1.Cliente, t0.Status, t0.duracao_total, t0.duracao_atendimento, t0.telefone FROM dim_chamadas_intelix\n\t\tAS t0\n\n\t\tLEFT JOIN( SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico )\n\t\tAS t1\n\t\tON CAST(t0.datahora AS DATE)= t1.[Data da Atualiza\u00e7\u00e3o]\n\t\tAND t0.atendente = t1.[ID Intelix]\n\t),\n\n\tfaixa_hora (data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, duracao_total, duracao_atendimento, telefone, faixa_hora) \n\tAS\n\t(\n\t\tSELECT data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, duracao_total, duracao_atendimento, telefone,\n\t\t\tCASE\n\t\t\t\tWHEN hora < CAST('08:00:00' AS TIME) THEN 'Fora de Escala'\n\t\t\t\tWHEN hora < CAST('09:00:00' AS TIME) THEN '08h'\n\t\t\t\tWHEN hora < CAST('10:00:00' AS TIME) THEN '09h'\n\t\t\t\tWHEN hora < CAST('11:00:00' AS TIME) THEN '10h'\n\t\t\t\tWHEN hora < CAST('12:00:00' AS TIME) THEN '11h'\n\t\t\t\tWHEN hora < CAST('13:00:00' AS TIME) THEN '12h'\n\t\t\t\tWHEN hora < CAST('14:00:00' AS TIME) THEN '13h'\n\t\t\t\tWHEN hora < CAST('15:00:00' AS TIME) THEN '14h'\n\t\t\t\tWHEN hora < CAST('16:00:00' AS TIME) THEN '15h'\n\t\t\t\tWHEN hora < CAST('17:00:00' AS TIME) THEN '16h'\n\t\t\t\tWHEN hora < CAST('18:00:00' AS TIME) THEN '17h'\n\t\t\t\tWHEN hora < CAST('19:00:00' AS TIME) THEN '18h'\n\t\t\t\tWHEN hora < CAST('20:00:00' AS TIME) THEN '19h'\n\t\t\t\tWHEN hora < CAST('21:00:00' AS TIME) THEN '20h'\t\t\n\t\t\t\tELSE 'Fora de Escala'\n\t\t\tEND \n\t\n\t\t\tFROM inicio\n\t),\n\n\tconverter_tempo(data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, [Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)])\n\tAS\n\t(\n\n\t\tSELECT [Data], [hora], [atendente], [Tribo], [Sub Tribo], Projeto, Cliente, [Status],[duracao_total], [duracao_atendimento], telefone, [faixa_hora], \n\t\n\t\tDATEDIFF(s, '00:00:00.000', [duracao_total]) AS [Duracao Total (s)],\n\t\n\t\tDATEDIFF(s, '00:00:00.000', [duracao_atendimento]) AS [Duracao Atendimento (s)]\n\t\tFROM faixa_hora\n\n\t),\n\n\tajuste_texto (data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, [Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)])\n\tAS\n\t(\tSELECT data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente,\n\t\t\n\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\t\t[Status], 'Numero','N\u00famero'),\n\t\t\t\t\t\t  'Nao','N\u00e3o'),\n\t\t\t\t\t\t  'Autenticacao','Autentica\u00e7\u00e3o'),\n\t\t\t\t\t\t  'Endereco','Endere\u00e7o'),\n\t\t\t\t\t\t  'Proibido','Pro\u00edbido'),\n\t\t\t\t\t\t  'Servico','Servi\u00e7o'),\n\t\t\t\t\t\t  'indisponivel','indispon\u00edvel'), \n\t\t\t\t\t\t   [Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)]\n\t\n\t\tFROM converter_tempo\n\t),\n\n\tajuste_status (data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, [Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)])\n\tAS\n\t(\tSELECT data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente,\n\t\t\n\t\tCASE\n\t\t\tWHEN status = 'Atendida' AND [Duracao Total (s)] <= 60 THEN 'Caixa postal'\n\t\t\tELSE Status\n\t\tEND,\n\t\t\t[Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)]\n\t\n\t\tFROM ajuste_texto\n\t)\n\tSELECT * FROM ajuste_status\n\tWHERE data >= '01/01/2023'\n\nGO\n",
        "build_order": 136,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "SELECT",
                "SELECT CAST( t0.datahora AS DATE) as data, CAST(t0.datahora as TIME)as hora, t0.atendente, t1.Tribo, t1.[Sub Tribo], t1.Projeto, t1.Cliente, t0.Status, t0.duracao_total, t0.duracao_atendimento, t0.telefone FROM dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_h_detalhadas]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_chamadas_h_detalhadas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_h_detalhadas]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_chamadas_h_detalhadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT CAST(MAX([datahora]) AS datetime) from dim_chamadas_intelix) WHERE [table] = 'f_chamadas_h_detalhadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_chamadas_h_detalhadas"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mopeventos_dma_complete]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mopeventos_dma_complete]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mopeventos_dma_complete",
        "type": "View",
        "start": 24594,
        "end": 30922,
        "code": "/****** Object:  View [dbo].[vw_mopeventos_dma_complete]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n--select * from [vw_mopeventos_dma_complete]\n\nCREATE VIEW [dbo].[vw_mopeventos_dma_complete] AS \nWITH\ninicio AS (\n\tSELECT * \n\tFROM f_mop_eventos \n),\netapa_2 AS (\n\tSELECT\n\t [Data da Atualiza\u00e7\u00e3o]\n\t,[ID Selecionar]\n\t,[ID \u00danico]\n\t,[ID Secullum]\n\t,[ID Serasa]\n\t,[ID Intelix] \n\t,[ID EPBX]\n\t,[Nome]\n\t,[Status]\n\t,[Situa\u00e7\u00e3o]\n\t,[Condi\u00e7\u00e3o]\n\t,[Cliente]\n\t,[Projeto]\n\t,[Cargo]\n\t,[Tribo]\n\t,[Sub Tribo]\n\t,[Escala]\n\t,[Jornada]\n\t,[Taxa]\n\t,[Pausa Manh\u00e3]\n\t,[Pausa Almo\u00e7o]\n\t,[Pausa Tarde]\n\t,[Supervis\u00e3o]\n\t,[Coordena\u00e7\u00e3o]\n\t,[Ger\u00eancia]\n\t,[Diretoria]\n\t,[Email Selecionar]\n\t,[Email Serasa]\n\t,[Telefone]\n\t,[CPF]\n\t,[Data de Nascimento]\n\t,[Nome de Registro]\n\t,[Sexo Biol\u00f3gico]\n\t,[REQ]\n\t,[DMA]\n\t,[Tipo de DMA]\n\t,[Tipo da \u00daltima DMA]   = MAX([Tipo de DMA]) OVER (PARTITION BY [ID SELECIONAR] ORDER BY [Data da Atualiza\u00e7\u00e3o] ROWS UNBOUNDED PRECEDING)  \t\t\t\t\n\t,[DMA Inicial]              = MAX(CASE \n\t\t\t\t\t\t\t\t       WHEN [Tipo de DMA] = 'CONTRATA\u00c7\u00c3O' THEN DMA\n\t\t\t\t\t\t\t\t       ELSE NULL\n\t\t\t\t\t\t\t           END) \n\t\t\t\t\t\t\t          OVER (PARTITION BY [ID SELECIONAR] ORDER BY [Data da Atualiza\u00e7\u00e3o] ROWS UNBOUNDED PRECEDING)\t\t\t\t\t\t\t\t\n\t,[\u00daltima DMA Migra\u00e7\u00e3o]      = MAX(CASE \n\t\t\t\t\t\t\t\t\t   WHEN [Tipo de DMA] = 'MIGRA\u00c7\u00c3O' THEN DMA\n\t\t\t\t\t\t\t\t\t   ELSE NULL\n\t\t\t\t\t\t\t\t\t   END) \n\t\t\t\t\t\t\t\t\t  OVER (PARTITION BY [ID SELECIONAR] ORDER BY [Data da Atualiza\u00e7\u00e3o] ROWS UNBOUNDED PRECEDING)\n\t,[Instrutor]\n\t,[Data de Admiss\u00e3o]\n\t,[Data de In\u00edcio em Opera\u00e7\u00e3o]\n\t,[Tempo de Casa (Dias)]\n\t,[Faixa Tempo de Casa]\n\t,[Idade]\n\t,[Faixa de Idade]\n\t,[Data de Sa\u00edda (F\u00e9rias/Afastamento)]\n\t,[Data de Retorno (F\u00e9rias/Afastamento)]\n\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\n\t,[\u00daltima Data Trabalhada (Turnover)]\n\t,[Per\u00edodo do Desligamento (Turnover)]\n\t,[Motivo do Desligamento (Turnover)]\n\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)]\n\t,[Custo da Rescis\u00e3o (Turnover)]\n\t,[Data da Proxima Atualiza\u00e7\u00e3o]\n\n\tFROM inicio\n),\n\netapa_3 AS (\n\tSELECT\n\t [Data da Atualiza\u00e7\u00e3o]\n\t,[ID Selecionar]\n\t,[ID \u00danico]\n\t,[ID Secullum]\n\t,[ID Serasa]\n\t,[ID Intelix] \n\t,[ID EPBX]\n\t,[Nome]\n\t,[Status]\n\t,[Situa\u00e7\u00e3o]\n\t,[Condi\u00e7\u00e3o]\n\t,[Cliente]\n\t,[Projeto]\n\t,[Cargo]\n\t,[Tribo]\n\t,[Sub Tribo]\n\t,[Escala]\n\t,[Jornada]\n\t,[Taxa]\n\t,[Pausa Manh\u00e3]\n\t,[Pausa Almo\u00e7o]\n\t,[Pausa Tarde]\n\t,[Supervis\u00e3o]\n\t,[Coordena\u00e7\u00e3o]\n\t,[Ger\u00eancia]\n\t,[Diretoria]\n\t,[Email Selecionar]\n\t,[Email Serasa]\n\t,[Telefone]\n\t,[CPF]\n\t,[Data de Nascimento]\n\t,[Nome de Registro]\n\t,[Sexo Biol\u00f3gico]\n\t,[REQ]\n\t,[DMA]\n\t,[Tipo de DMA]\n\t,[Tipo da \u00daltima DMA]\t\t\t\n\t,[DMA Inicial]\n\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n\t,[\u00daltima DMA Geral] = case when [\u00daltima DMA Migra\u00e7\u00e3o] is null then [DMA Inicial] else [\u00daltima DMA Migra\u00e7\u00e3o] end\n\t,[Instrutor] \n\t,[Data de Admiss\u00e3o]\n\t,[Data de In\u00edcio em Opera\u00e7\u00e3o]\n\t,[Tempo de Casa (Dias)]\n\t,[Faixa Tempo de Casa]\n\t,[Idade]\n\t,[Faixa de Idade]\n\t,[Data de Sa\u00edda (F\u00e9rias/Afastamento)]\n\t,[Data de Retorno (F\u00e9rias/Afastamento)]\n\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\n\t,[\u00daltima Data Trabalhada (Turnover)]\n\t,[Per\u00edodo do Desligamento (Turnover)]\n\t,[Motivo do Desligamento (Turnover)]\n\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)]\n\t,[Custo da Rescis\u00e3o (Turnover)]\n\t,[Data da Proxima Atualiza\u00e7\u00e3o]\n\n\tFROM etapa_2\n),\n\netapa_4 AS (\n\tSELECT\n\t [Data da Atualiza\u00e7\u00e3o]\n\t,[ID Selecionar]\n\t,[ID \u00danico]\n\t,[ID Secullum]\n\t,[ID Serasa]\n\t,[ID Intelix] \n\t,[ID EPBX]\n\t,[Nome]\n\t,[Status]\n\t,[Situa\u00e7\u00e3o]\n\t,[Condi\u00e7\u00e3o]\n\t,[Cliente]\n\t,[Projeto]\n\t,[Cargo]\n\t,[Tribo]\n\t,[Sub Tribo]\n\t,[Escala]\n\t,[Jornada]\n\t,[Taxa]\n\t,[Pausa Manh\u00e3]\n\t,[Pausa Almo\u00e7o]\n\t,[Pausa Tarde]\n\t,[Supervis\u00e3o]\n\t,[Coordena\u00e7\u00e3o]\n\t,[Ger\u00eancia]\n\t,[Diretoria]\n\t,[Email Selecionar]\n\t,[Email Serasa]\n\t,[Telefone]\n\t,[CPF]\n\t,[Data de Nascimento]\n\t,[Nome de Registro]\n\t,[Sexo Biol\u00f3gico]\n\t,[REQ]\n\t,[DMA]\n\t,[Tipo de DMA]\n\t,[Tipo da \u00daltima DMA]\t\t\t\n\t,[DMA Inicial]\n\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n\t,[\u00daltima DMA Geral]\n\t,[Instrutor] \n\t,[Instrutor \u00daltima DMA] = (\n\t\t\t\t\t\t\t\tSELECT TOP 1 Instrutor FROM etapa_3 AS innerTable\n\t\t\t\t\t\t\t\tWHERE innerTable.[ID Selecionar] = etapa_3.[ID Selecionar]\n\t\t\t\t\t\t\t\tAND innerTable.[\u00daltima DMA Geral] = etapa_3.[\u00daltima DMA Geral]\n\t\t\t\t\t\t\t\tORDER BY innerTable.[Data da Atualiza\u00e7\u00e3o] asc\n\t\t\t\t\t\t\t   )\n\t,[Data de Admiss\u00e3o]\n\t,[Data de In\u00edcio em Opera\u00e7\u00e3o]\n\t,[Tempo de Casa (Dias)]\n\t,[Faixa Tempo de Casa]\n\t,[Idade]\n\t,[Faixa de Idade]\n\t,[Data de Sa\u00edda (F\u00e9rias/Afastamento)]\n\t,[Data de Retorno (F\u00e9rias/Afastamento)]\n\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\n\t,[\u00daltima Data Trabalhada (Turnover)]\n\t,[Per\u00edodo do Desligamento (Turnover)]\n\t,[Motivo do Desligamento (Turnover)]\n\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)]\n\t,[Custo da Rescis\u00e3o (Turnover)]\n\t,[Data da Proxima Atualiza\u00e7\u00e3o]\n\n\tFROM etapa_3\n),\netapa_5 AS (\n\tSELECT\n\t [Data da Atualiza\u00e7\u00e3o]\n\t,[ID Selecionar]\n\t,[ID \u00danico]\n\t,[ID Secullum]\n\t,[ID Serasa]\n\t,[ID Intelix] \n\t,[ID EPBX]\n\t,[Nome]\n\t,[Status]\n\t,[Situa\u00e7\u00e3o]\n\t,[Condi\u00e7\u00e3o]\n\t,[Cliente]\n\t,[Projeto]\n\t,[Cargo]\n\t,[Tribo]\n\t,[Sub Tribo]\n\t,[Escala]\n\t,[Jornada]\n\t,[Taxa]\n\t,[Pausa Manh\u00e3]\n\t,[Pausa Almo\u00e7o]\n\t,[Pausa Tarde]\n\t,[Supervis\u00e3o]\n\t,[Coordena\u00e7\u00e3o]\n\t,[Ger\u00eancia]\n\t,[Diretoria]\n\t,[Email Selecionar]\n\t,[Email Serasa]\n\t,[Telefone]\n\t,[CPF]\n\t,[Data de Nascimento]\n\t,[Nome de Registro]\n\t,[Sexo Biol\u00f3gico]\n\t,[REQ]\n\t,[DMA]\n\t,[Tipo de DMA]\n\t,[Tipo da \u00daltima DMA]\t\t\t\n\t,[DMA Inicial]\n\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n\t,[\u00daltima DMA Geral]\n\t,[Instrutor]\n\t,[Instrutor Inicial]            = MAX(CASE \n\t\t\t\t\t\t\t\t\t\t   WHEN [Tipo da \u00daltima DMA] = 'CONTRATA\u00c7\u00c3O' THEN [Instrutor \u00daltima DMA]\n\t\t\t\t\t\t\t\t\t\t   ELSE NULL\n\t\t\t\t\t\t\t\t\t\t END) \n\t\t\t\t\t\t\t\t\t\t OVER (PARTITION BY [ID SELECIONAR] ORDER BY [Data da Atualiza\u00e7\u00e3o] ROWS UNBOUNDED PRECEDING)\n\t,[Instrutor \u00daltima DMA]\n\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]    = MAX(CASE \n\t\t\t\t\t\t\t\t\t       WHEN [Tipo da \u00daltima DMA] = 'MIGRA\u00c7\u00c3O' THEN [Instrutor \u00daltima DMA]\n\t\t\t\t\t\t\t\t\t       ELSE NULL\n\t\t\t\t\t\t\t\t\t     END) \n\t\t\t\t\t\t\t\t\t     OVER (PARTITION BY [ID SELECIONAR] ORDER BY [Data da Atualiza\u00e7\u00e3o] ROWS UNBOUNDED PRECEDING)\n\t,[Data de Admiss\u00e3o]\n\t,[Data de In\u00edcio em Opera\u00e7\u00e3o]\n\t,[Tempo de Casa (Dias)]\n\t,[Faixa Tempo de Casa]\n\t,[Idade]\n\t,[Faixa de Idade]\n\t,[Data de Sa\u00edda (F\u00e9rias/Afastamento)]\n\t,[Data de Retorno (F\u00e9rias/Afastamento)]\n\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\n\t,[\u00daltima Data Trabalhada (Turnover)]\n\t,[Per\u00edodo do Desligamento (Turnover)]\n\t,[Motivo do Desligamento (Turnover)]\n\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)]\n\t,[Custo da Rescis\u00e3o (Turnover)]\n\t,[Data da Proxima Atualiza\u00e7\u00e3o]\n\n\tFROM etapa_4\n)\n\nSELECT * FROM etapa_5\n\n\n\nGO\n",
        "build_order": 137,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mopeventos_dma_complete]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_mopeventos_dma_complete]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mopeventos_dma_complete]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_mopeventos_dma_complete]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_tags]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_tags]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_tickets_tags",
        "type": "Table",
        "start": 30922,
        "end": 31180,
        "code": "/****** Object:  Table [dbo].[dim_tickets_tags]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_tickets_tags](\n\t[ID_ticket] [int] NOT NULL,\n\t[tag] [varchar](250) NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 138,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_tags]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_tickets_tags]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tags]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_tickets_tags"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_tags]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_tickets_tags]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_tickets_tags]": [
                "UNKNOWN",
                "dim_tickets_tags"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "SELECT",
                "SELECT [ID_ticket], [Chatbot?] = IIF(SUM(IIF([tag] like '%chatbot%',1,0))=0,0,1) FROM dim_tickets_tags"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tags]": [
                "INSERT",
                "INSERT INTO dim_tickets_tags"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_tickets",
        "type": "Table",
        "start": 31180,
        "end": 31836,
        "code": "/****** Object:  Table [dbo].[f_tickets]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_tickets](\n\t[Tribo] [varchar](50) NOT NULL,\n\t[ID Selecionar] [varchar](10) NULL,\n\t[ID Serasa] [varchar](10) NULL,\n\t[ID Ticket] [int] NOT NULL,\n\t[Status] [varchar](150) NULL,\n\t[Cria\u00e7\u00e3o] [datetime] NOT NULL,\n\t[Resolu\u00e7\u00e3o] [datetime] NULL,\n\t[Formul\u00e1rio] [varchar](500) NOT NULL,\n\t[Motivos] [varchar](500) NULL,\n\t[TMT] [int] NULL,\n\t[R\u00e9plicas] [int] NOT NULL,\n\t[Resolvido?] [bit] NOT NULL,\n\t[Reincidente 48h?] [bit] NOT NULL,\n\t[Reincidente 30d?] [bit] NOT NULL,\n\t[Chatbot?] [bit] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 139,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_tickets]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_tickets]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_tickets"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_tickets]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_tickets_tags]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT subtribo_serasa=[tribo], CAST(Resolu\u00e7\u00e3o AS DATE) as data, COUNT([Resolvido?]) as tratados FROM f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": [
                "SELECT",
                "SELECT * FROM f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_tickets"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_tickets_tags]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_tickets_tags]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_tickets_tags",
        "type": "View",
        "start": 31836,
        "end": 32405,
        "code": "/****** Object:  View [dbo].[vw_tickets_tags]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   VIEW [dbo].[vw_tickets_tags] AS\n\n\n\tSELECT \n\t\t [Tribo]\n\t\t,[ID Selecionar]\n\t\t,[ID Serasa]\n\t\t,[ID Ticket]\n\t\t,[Cria\u00e7\u00e3o]\n\t\t,[Resolu\u00e7\u00e3o]\n\t\t,[Formul\u00e1rio]\n\t\t,[Motivos]\n\t\t,[TMT]\n\t\t,[R\u00e9plicas]\n\t\t,[Resolvido?]\n\t\t,[Reincidente 48h?]\n\t\t,[Reincidente 30d?]\n\t\t,[Tags] = [tag]\n\tFROM f_tickets tkts\n\tLEFT JOIN dim_tickets_tags tags\n\tON tkts.[ID Ticket] = tags.[ID_ticket]\n\tWHERE [tag] IS NOT NULL\n\t--ORDER BY [ID Ticket] DESC, [tag]\n\n\nGO\n",
        "build_order": 140,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_tags]": [
                "UNKNOWN",
                "dim_tickets_tags"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_tickets_tags]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_tickets_tags]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_tickets_tags]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_tickets_tags]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod8]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod8]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod8",
        "type": "Table",
        "start": 32405,
        "end": 32908,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod8]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod8](\n\t[id] [varchar](250) NOT NULL,\n\t[inst_id] [varchar](50) NULL,\n\t[inst_nome] [varchar](50) NULL,\n\t[mes_ref] [date] NULL,\n\t[agda_rotulo] [varchar](100) NULL,\n\t[nome_operadora] [varchar](50) NULL,\n\t[proc_nome] [varchar](50) NULL,\n\t[qtd_pessoas] [int] NULL,\n\t[qtd_procedimentos] [int] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 141,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod8]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod8]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod8]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod8"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod8]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod8]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod8]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod8]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod8]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod8]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod8]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod8]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod8",
        "type": "View",
        "start": 32908,
        "end": 33470,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod8]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   VIEW [dbo].[vw_mendi_saudevianet_cod8] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[inst_nome]\t\t\t\t\n\t\t\t,[mes_ref]\t\t\t\t\t\n\t\t\t,[agda_rotulo]\t\t\t\t\n\t\t\t,[nome_operadora]\t\t\t\n\t\t\t,[proc_nome]\t\t\t\t\n\t\t\t,[qtd_pessoas]\t\t\t\t\n\t\t\t,[qtd_procedimentos]\t\n\tFROM [dim_mendi_saudevianet_cod8]\n),\n\ninsert_data AS\n(\n\tSELECT *\n\t,[data] = CAST([mes_ref] AS DATE)\n\n\tFROM inicio\n)\n\nSELECT * FROM insert_data\n\nGO\n",
        "build_order": 142,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod8]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod8]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod8]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod8]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod8]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod8]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod12]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod12]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod12",
        "type": "Table",
        "start": 33470,
        "end": 34574,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod12]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod12](\n\t[id] [varchar](100) NOT NULL,\n\t[nome] [varchar](100) NOT NULL,\n\t[dt_nascimento] [date] NULL,\n\t[cpf] [varchar](50) NULL,\n\t[rg] [varchar](50) NULL,\n\t[sexo] [varchar](50) NULL,\n\t[profissao] [varchar](100) NULL,\n\t[num_prontuario] [varchar](50) NULL,\n\t[indicado_por] [varchar](100) NULL,\n\t[logradouro] [varchar](100) NULL,\n\t[bairro] [varchar](100) NULL,\n\t[cep] [int] NULL,\n\t[cidade] [varchar](100) NULL,\n\t[estado] [varchar](50) NULL,\n\t[telefone] [varchar](50) NULL,\n\t[emails] [varchar](100) NULL,\n\t[dt_cadastro] [datetime] NULL,\n\t[resp_cadastro] [varchar](100) NULL,\n\t[dt_ultimo_atendimento] [datetime] NULL,\n\t[dt_primeiro_atendimento] [datetime] NULL,\n\t[qtd_agendamento] [int] NULL,\n\t[etiqueta] [varchar](100) NULL,\n\t[prof_primeiro_atendimento] [varchar](100) NULL,\n\t[prof_ultimo_atendimento] [varchar](100) NULL,\n\t[plano_saude] [varchar](50) NULL,\n\t[mes_aniversario] [varchar](50) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 143,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod12]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod12]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod12]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod12"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod12]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod12]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod12]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod12]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod12]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod12]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod15]": [
                "SELECT",
                "SELECT * FROM dim_mendi_saudevianet_cod12"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod12]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod12]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod12",
        "type": "View",
        "start": 34574,
        "end": 35564,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod12]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   VIEW [dbo].[vw_mendi_saudevianet_cod12] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t [id]\t\t\t\t\t\t\t \n\t\t\t,[nome]\t\t\t\t\t\t\t \n\t\t\t,[dt_nascimento]\t\t\t\t \n\t\t\t,[cpf]\t\t\t\t\t\t\t \n\t\t\t,[rg]\t\t\t\t\t\t\t \n\t\t\t,[sexo]\t\t\t\t\t\t\t \n\t\t\t,[profissao]\t\t\t\t\t \n\t\t\t,[num_prontuario]\t\t\t\t \n\t\t\t,[indicado_por]\t\t\t\t\t \n\t\t\t,[logradouro]\t\t\t\t\t \n\t\t\t,[bairro]\t\t\t\t\t\t \n\t\t\t,[cep]\t\t\t\t\t\t\t \n\t\t\t,[cidade]\t\t\t\t\t\t \n\t\t\t,[estado]\t\t\t\t\t\t \n\t\t\t,[telefone]\t\t\t\t\t\t \n\t\t\t,[emails]\t\t\t\t\t\t \n\t\t\t,[dt_cadastro]\t\t\t\t\t \n\t\t\t,[resp_cadastro]\t\t\t\t \n\t\t\t,[dt_ultimo_atendimento]\t\t \n\t\t\t,[dt_primeiro_atendimento]\t\t \n\t\t\t,[qtd_agendamento]\t\t\t\t \n\t\t\t,[etiqueta]\t\t\t\t\t\t \n\t\t\t,[prof_primeiro_atendimento]\t \n\t\t\t,[prof_ultimo_atendimento]\t\t \n\t\t\t,[plano_saude]\t\t\t\t\t \n\t\t\t,[mes_aniversario]\t\n\tFROM [dim_mendi_saudevianet_cod12]\n),\n\ninsert_data AS\n(\n\tSELECT *\n\t,[data] = CAST([dt_cadastro] AS DATE)\n\n\tFROM inicio\n)\n\nSELECT * FROM insert_data\n\nGO\n",
        "build_order": 144,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod12]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod12]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod12]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod12]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod12]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod12]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod79]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod79]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod79",
        "type": "Table",
        "start": 35564,
        "end": 36119,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod79]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod79](\n\t[id] [varchar](150) NOT NULL,\n\t[pess_tx_nome] [varchar](100) NOT NULL,\n\t[pess_nr_cpf] [varchar](25) NOT NULL,\n\t[ref_conselho] [varchar](25) NOT NULL,\n\t[pess_dt_nascimento] [date] NULL,\n\t[usua_tx_email] [varchar](100) NOT NULL,\n\t[especialidades] [varchar](250) NULL,\n\t[telefones] [varchar](50) NULL,\n\t[dt_cadastro] [datetime] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 145,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod79]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod79]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod79]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod79"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod79]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod79]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod79]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod79]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod79]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod79]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod79]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod79]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod79",
        "type": "View",
        "start": 36119,
        "end": 36603,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod79]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE   VIEW [dbo].[vw_mendi_saudevianet_cod79] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t [id]\t\t\t\t\t\n\t\t\t,[pess_tx_nome]\t\t\t\n\t\t\t,[pess_nr_cpf]\t\t\t\n\t\t\t,[ref_conselho]\t\t\t\n\t\t\t,[pess_dt_nascimento]\t\n\t\t\t,[usua_tx_email]\t\t\n\t\t\t,[especialidades]\t\t\n\t\t\t,[telefones]\t\t\t\n\t\t\t,[dt_cadastro]\t\n\tFROM [dim_mendi_saudevianet_cod79]\n\n)\n\nSELECT * FROM inicio\n\nGO\n",
        "build_order": 146,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod79]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod79]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod79]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod79]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod79]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod79]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod15]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod15]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod15",
        "type": "Table",
        "start": 36603,
        "end": 37414,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod15]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod15](\n\t[id] [varchar](50) NOT NULL,\n\t[nome_paciente] [varchar](100) NULL,\n\t[data_agendamento] [datetime] NULL,\n\t[nome_prof] [varchar](100) NULL,\n\t[situacao_agendamento] [varchar](50) NULL,\n\t[email_contato] [varchar](100) NULL,\n\t[telefones] [varchar](50) NULL,\n\t[procedimento] [varchar](50) NULL,\n\t[plano_saude] [varchar](50) NULL,\n\t[anotacao] [varchar](max) NULL,\n\t[agen_tx_observacao] [varchar](max) NULL,\n\t[resp_alteracao] [varchar](100) NULL,\n\t[agen_dt_alteracao] [datetime] NULL,\n\t[inma_tx_motivo] [varchar](100) NULL,\n\t[agen_tx_motivo_cancelamento] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 147,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod15]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod15]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod15]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod15"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod15]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod15]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod15]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod15]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod15]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod15]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod15]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod15]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod15",
        "type": "View",
        "start": 37414,
        "end": 38172,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod15]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   VIEW [dbo].[vw_mendi_saudevianet_cod15] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t [id]\t\t\t\t\t\t\t\n\t\t\t,[nome_paciente]\t\t\t\t\n\t\t\t,[data_agendamento]\t\t\t\t\n\t\t\t,[nome_prof]\t\t\t\t\t\n\t\t\t,[situacao_agendamento]\t\t\t\n\t\t\t,[email_contato]\t\t\t\t\n\t\t\t,[telefones]\t\t\t\t\t\n\t\t\t,[procedimento]\t\t\t\t\t\n\t\t\t,[plano_saude]\t\t\t\t\t\n\t\t\t,[anotacao]\t\t\t\t\t\t\n\t\t\t,[agen_tx_observacao]\t\t\t\n\t\t\t,[resp_alteracao]\t\t\t\t\n\t\t\t,[agen_dt_alteracao]\t\t\t\n\t\t\t,[inma_tx_motivo]\t\t\t\t\n\t\t\t,[agen_tx_motivo_cancelamento]\n\tFROM [dim_mendi_saudevianet_cod15]\n),\n\ninsert_data AS\n(\n\tSELECT *\n\t,[data] = CAST([data_agendamento] AS DATE)\n\n\tFROM inicio\n)\n\nSELECT * FROM insert_data\n\nGO\n",
        "build_order": 148,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod15]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod15]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod15]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod15]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod15]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod15]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod3]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod3]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_2clix_analiticosAvaliacoes_cod3",
        "type": "Table",
        "start": 38172,
        "end": 40650,
        "code": "/****** Object:  Table [dbo].[dim_2clix_analiticosAvaliacoes_cod3]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_2clix_analiticosAvaliacoes_cod3](\n\t[codigo] [int] NULL,\n\t[cliente] [varchar](max) NULL,\n\t[campanha] [varchar](max) NULL,\n\t[avaliado] [varchar](max) NULL,\n\t[superior] [varchar](max) NULL,\n\t[data_avaliacao] [datetime] NULL,\n\t[tipo_avaliacao] [varchar](max) NULL,\n\t[departamento] [varchar](max) NULL,\n\t[avaliador] [varchar](max) NULL,\n\t[processo] [varchar](max) NULL,\n\t[codigo_gravacao] [varchar](max) NULL,\n\t[tempo_avaliacao] [varchar](max) NULL,\n\t[nota] [int] NULL,\n\t[data_feedback] [datetime] NULL,\n\t[resultado_feedback] [varchar](max) NULL,\n\t[responsavel_feedback] [varchar](max) NULL,\n\t[obs_responsavel_feedback] [varchar](max) NULL,\n\t[obs_avaliado] [varchar](max) NULL,\n\t[tabulacao] [varchar](max) NULL,\n\t[nota_sem_ncg] [varchar](max) NULL,\n\t[visualizacao_avaliado] [int] NULL,\n\t[pesquisa_avaliado] [varchar](max) NULL,\n\t[login_avaliado] [varchar](max) NULL,\n\t[data_admissao_avaliado] [datetime] NULL,\n\t[data_inicio_setor] [datetime] NULL,\n\t[codigo_externo] [int] NULL,\n\t[status_feedback] [varchar](max) NULL,\n\t[tempo_feedback] [varchar](max) NULL,\n\t[formulario] [varchar](max) NULL,\n\t[codigo_gravador] [varchar](max) NULL,\n\t[codigo_integracao] [int] NULL,\n\t[data_contato] [datetime] NULL,\n\t[atendimento realizado dentro do sla] [varchar](max) NULL,\n\t[causa raiz] [varchar](max) NULL,\n\t[classificacao da tratativa] [varchar](max) NULL,\n\t[comentario] [varchar](max) NULL,\n\t[data/hora da opiniao] [datetime] NULL,\n\t[ilha] [varchar](max) NULL,\n\t[nota avaliacao] [float] NULL,\n\t[n\u00famero do ticket] [bigint] NULL,\n\t[parceiros] [varchar](max) NULL,\n\t[ponto de oportunidade] [varchar](max) NULL,\n\t[produto identificado] [varchar](max) NULL,\n\t[tema pedido] [varchar](max) NULL,\n\t[tema resposta] [varchar](max) NULL,\n\t[periodo] [varchar](max) NULL,\n\t[pontos_positivos] [varchar](max) NULL,\n\t[pontos_melhorar] [varchar](max) NULL,\n\t[qtd_arquivos] [int] NULL,\n\t[matricula] [varchar](max) NULL,\n\t[observacao] [varchar](max) NULL,\n\t[email_avaliado] [varchar](max) NULL,\n\t[ticket] [bigint] NULL,\n\t[acima_meta] [varchar](max) NULL,\n\t[unidade] [varchar](max) NULL,\n\t[status_usuario] [varchar](max) NULL,\n\t[segundo_superior] [varchar](max) NULL,\n\t[terceiro_superior] [varchar](max) NULL,\n\t[tipo_auditoria] [varchar](max) NULL,\n\t[analise_auditoria] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 149,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_analiticosAvaliacoes_cod3]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_analiticosAvaliacoes_cod3]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT [codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario], [data/hora da opiniao], [ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta],\t[periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], CAST(data_avaliacao AS DATE), [tipo_auditoria], [analise_auditoria] FROM dim_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod3]": [
                "INSERT",
                "INSERT INTO dim_2clix_analiticosAvaliacoes_cod3"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_mop_vigente",
        "type": "Table",
        "start": 40650,
        "end": 43321,
        "code": "/****** Object:  Table [dbo].[f_mop_vigente]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_mop_vigente](\n\t[Data da Atualiza\u00e7\u00e3o] [date] NULL,\n\t[ID Selecionar] [varchar](30) NULL,\n\t[ID \u00danico] [varchar](30) NULL,\n\t[ID Secullum] [int] NULL,\n\t[ID Serasa] [varchar](10) NULL,\n\t[ID Intelix] [int] NULL,\n\t[ID EPBX] [int] NULL,\n\t[ID Genesys] [varchar](100) NULL,\n\t[Nome] [varchar](100) NULL,\n\t[Status] [varchar](25) NULL,\n\t[Situa\u00e7\u00e3o] [varchar](25) NULL,\n\t[Condi\u00e7\u00e3o] [varchar](25) NULL,\n\t[Cliente] [varchar](50) NULL,\n\t[Projeto] [varchar](50) NULL,\n\t[Cargo] [varchar](50) NULL,\n\t[Tribo] [varchar](50) NULL,\n\t[Sub Tribo] [varchar](50) NULL,\n\t[Escala] [varchar](15) NULL,\n\t[Jornada] [time](7) NULL,\n\t[Taxa] [int] NULL,\n\t[Turno] [varchar](8) NOT NULL,\n\t[Pausa Manh\u00e3] [time](7) NULL,\n\t[Pausa Almo\u00e7o] [time](7) NULL,\n\t[Pausa Tarde] [time](7) NULL,\n\t[Supervis\u00e3o] [varchar](100) NULL,\n\t[Coordena\u00e7\u00e3o] [varchar](100) NULL,\n\t[Ger\u00eancia] [varchar](100) NULL,\n\t[Diretoria] [varchar](100) NULL,\n\t[Email Selecionar] [varchar](100) NULL,\n\t[Email Serasa] [varchar](100) NULL,\n\t[Email Supervis\u00e3o] [varchar](100) NULL,\n\t[Telefone] [varchar](20) NULL,\n\t[CPF] [varchar](15) NULL,\n\t[Data de Nascimento] [date] NULL,\n\t[Nome de Registro] [varchar](100) NULL,\n\t[Sexo Biol\u00f3gico] [varchar](1) NULL,\n\t[REQ] [varchar](100) NULL,\n\t[DMA] [int] NULL,\n\t[DMA Inicial] [int] NULL,\n\t[\u00daltima DMA Migra\u00e7\u00e3o] [int] NULL,\n\t[\u00daltima DMA Geral] [int] NULL,\n\t[Tipo de DMA] [varchar](50) NULL,\n\t[Tipo da \u00daltima DMA] [varchar](50) NULL,\n\t[Instrutor] [varchar](100) NULL,\n\t[Instrutor Inicial] [varchar](100) NULL,\n\t[Instrutor \u00daltima Migra\u00e7\u00e3o] [varchar](100) NULL,\n\t[Instrutor \u00daltima DMA] [varchar](100) NULL,\n\t[HC 06:20] [int] NOT NULL,\n\t[HC 10:00] [int] NOT NULL,\n\t[HC 08:12] [int] NOT NULL,\n\t[Data de Admiss\u00e3o] [date] NULL,\n\t[Tempo de Casa (Dias)] [int] NULL,\n\t[Faixa Tempo de Casa] [varchar](15) NOT NULL,\n\t[Idade] [numeric](18, 0) NULL,\n\t[Faixa de Idade] [varchar](16) NOT NULL,\n\t[Data de In\u00edcio em Opera\u00e7\u00e3o] [datetime] NULL,\n\t[Data de Sa\u00edda (F\u00e9rias/Afastamento)] [datetime] NULL,\n\t[Data de Retorno (F\u00e9rias/Afastamento)] [datetime] NULL,\n\t[Data de Solicita\u00e7\u00e3o (Turnover)] [datetime] NULL,\n\t[\u00daltima Data Trabalhada (Turnover)] [datetime] NULL,\n\t[Per\u00edodo do Desligamento (Turnover)] [varchar](100) NULL,\n\t[Motivo do Desligamento (Turnover)] [varchar](100) NULL,\n\t[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)] [varchar](3) NULL,\n\t[Custo da Rescis\u00e3o (Turnover)] [float] NULL,\n\t[Vencimento Contrato Exp. 30d] [date] NULL,\n\t[Vencimento Contrato Exp. 60d] [date] NULL,\n\t[Vencimento Contrato Exp. 90d] [date] NULL,\n\t[Fonte de Log] [varchar](10) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 150,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_vigente]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_vigente]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mop_vigente]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod3]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": [
                "SELECT",
                "SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "SELECT",
                "SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "SELECT",
                "SELECT data_to = CAST([Data da Atualiza\u00e7\u00e3o] AS DATE), data_ev, [ID Intelix], [ID Selecionar], diff = DATEDIFF(DAY, [Data da Atualiza\u00e7\u00e3o], data_ev), [Motivo do Desligamento (Turnover)]  FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_mop_vigente"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod3]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod3]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_2clix_analiticosAvaliacoes_cod3",
        "type": "View",
        "start": 43321,
        "end": 59170,
        "code": "/****** Object:  View [dbo].[vw_2clix_analiticosAvaliacoes_cod3]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\n-- select * from [vw_2clix_analiticosAvaliacoes_cod3]\n\n\n\n\n\n\n\n\n\nCREATE    VIEW [dbo].[vw_2clix_analiticosAvaliacoes_cod3] AS\nWITH \ninicio([codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao], [data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta],\t[periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date], [tipo_auditoria], [analise_auditoria])\nAs\n(\nSELECT [codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario], [data/hora da opiniao], [ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta],\t[periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], CAST(data_avaliacao AS DATE), [tipo_auditoria], [analise_auditoria] FROM dim_2clix_analiticosAvaliacoes_cod3\n),\n\nadd_projetos([codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta],\t[periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date], [projeto], [tipo_auditoria], [analise_auditoria])\nAS\n(\nSELECT [codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta],\t[periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date],\n\tCASE\n\t\tWHEN ilha IN ('0800 - Premium', '') THEN 'Premium'\n\t\tWHEN ilha =\t'Cadastro Positivo' THEN 'Cadastro Positivo'\n\t\tWHEN ilha = 'SAC' THEN 'SAC'\n\t\tWHEN ilha = 'BKO' THEN 'BackOffice'\n\t\tWHEN campanha = 'Progrid 2022' THEN 'Progrid'\n\t\tWHEN campanha IN ('Progrid','') THEN 'Progrid'\n\t\tWHEN campanha IN ('Viacredi','') THEN 'Viacredi'\n\t\tWHEN campanha IN ('VIACREDI AGC 2023','') THEN 'Viacredi'\n\t\tELSE 'Digital'\n\n\tEND, [tipo_auditoria], [analise_auditoria]\n\tFROM inicio\n\tWHERE campanha <> 'SDR' AND campanha <> 'PME' AND campanha <> 'SAC N1' \n),\n\ncorrigir_caracteres ([codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta], [periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date], [projeto], [tipo_auditoria], [analise_auditoria])\nAS\n(\n\tSELECT [codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao], [n\u00famero do ticket], [parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta],\t[periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date], [projeto], [tipo_auditoria], [analise_auditoria] FROM  add_projetos\n),\n\nadd_tribo_mop([codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta], [periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date], [projeto], [Tribo_mop], [tipo_auditoria], [analise_auditoria])\nAS\n(\n\tSELECT [codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta], [periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date], [projeto],\n\t\tCASE\n\t\t\tWHEN ilha = '0800 - Premium'             THEN '0800 Premium'\n\t\t\tWHEN ilha = 'BKO'                        THEN 'BackOffice'\n\t\t\tWHEN ilha = 'Cadastro Positivo'          THEN 'Cadastro Positivo'\n\t\t\tWHEN ilha = 'C\u00e9lula  Baby'               THEN 'C\u00e9lula Baby'\n\t\t\tWHEN ilha = 'Central de Ajuda'           THEN 'Central de Ajuda'\n\t\t\tWHEN ilha = 'Consumidor.Gov'             THEN 'GOV'\n\t\t\tWHEN ilha = 'Cr\u00e9dito'                    THEN 'Cr\u00e9dito'\n\t\t\tWHEN ilha = 'D\u00edvidas'                    THEN 'D\u00edvidas'\n\t\t\tWHEN ilha = 'Facebook'                   THEN 'Facebook'\n\t\t\tWHEN ilha = 'Google Play'                THEN 'Lojas'\n\t\t\tWHEN ilha = 'OCR'                        THEN 'OCR'\n\t\t\tWHEN ilha = 'Portal Parceiros'           THEN 'Self Setup'\n\t\t\tWHEN ilha = 'PROGRID 2023'               THEN 'Progrid'\n\t\t\tWHEN ilha = 'Reclame Aqui'               THEN 'Reclame Aqui'\n\t\t\tWHEN ilha = 'SAC'                        THEN 'SAC'\n\t\t\tWHEN ilha = 'Score'                      THEN 'Score'\n\t\t\tWHEN ilha = 'VIACREDI AGC 2023'          THEN 'Assembl\u00e9ias'\n\t\t\tWHEN ilha = 'Lojas'                      THEN 'Lojas'\n\t\t\tELSE ilha\n\t\tEND, [tipo_auditoria], [analise_auditoria]\n\n\tFROM corrigir_caracteres\n),\n\nadd_tribo_padronizada([codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta], [periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date], [projeto], [Tribo_mop], [Tribo_padronizada], [tipo_auditoria], [analise_auditoria])\nAS\n(\n\n\tSELECT [codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta], [periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date], [projeto], [Tribo_mop],\n\t\tCASE\n\t\t\tWHEN ilha = '0800 - Premium'             THEN '0800 Premium'\n\t\t\tWHEN ilha = 'BKO'                        THEN 'BackOffice'\n\t\t\tWHEN ilha = 'Cadastro Positivo'          THEN 'Cadastro Positivo'\n\t\t\tWHEN ilha = 'C\u00e9lula  Baby'               THEN 'Outros'\n\t\t\tWHEN ilha = 'Central de Ajuda'           THEN 'Central de Ajuda'\n\t\t\tWHEN ilha = 'Consumidor.Gov'             THEN 'Outros'\n\t\t\tWHEN ilha = 'Cr\u00e9dito'                    THEN 'Central de Ajuda'\n\t\t\tWHEN ilha = 'D\u00edvidas'                    THEN 'Central de Ajuda'\n\t\t\tWHEN ilha = 'D?vidas'                    THEN 'Central de Ajuda'\n\t\t\tWHEN ilha = 'Facebook'                   THEN 'Outros'\n\t\t\tWHEN ilha = 'Google Play'                THEN 'Outros'\n\t\t\tWHEN ilha = 'OCR'                        THEN 'OCR - IDWALL'\n\t\t\tWHEN ilha = 'Portal Parceiros'           THEN 'Outros'\n\t\t\tWHEN ilha = 'PROGRID 2023'               THEN 'Outros'\n\t\t\tWHEN ilha = 'Reclame Aqui'               THEN 'Outros'\n\t\t\tWHEN ilha = 'SAC'                        THEN 'SAC'\n\t\t\tWHEN ilha = 'Score'                      THEN 'Central de Ajuda'\n\t\t\tWHEN ilha = 'VIACREDI AGC 2023'          THEN 'Outros'\n\t\t\tWHEN ilha = 'Lojas'                      THEN 'Outros'\n\t\t\tELSE 'Outros'\n\t\tEND, [tipo_auditoria], [analise_auditoria]\n\tFROM add_tribo_mop\n),\nadd_super_vigente\nAS\n(\nSELECT [codigo], t0.[cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario],\t[data/hora da opiniao],\t[ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta], [periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], [date], t0.[projeto], [Tribo_mop], [Tribo_padronizada], [tipo_auditoria], [analise_auditoria],\n\t[Supervisor_vigente] = mop_v.Supervis\u00e3o\nFROM add_tribo_padronizada as t0\nLEFT JOIN ( SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), \n* FROM f_mop_vigente) as mop_v ON  t0.login_avaliado = mop_v.[ID Serasa] AND n = 1\n)\nSELECT * FROM add_super_vigente\n--WHERE formulario LIKE '%AN\u00c1LISE DE NPS%'\n--OR formulario LIKE '%AUDITORIAS%'\n--AND campanha LIKE '%An\u00e1lises%'\n\n\n--SELECT * FROM vw_2clix_analiticosAvaliacoes_cod3\n\n--WHERE faixa_hora = 'Fora de Escala'   \t\n\nGO\n",
        "build_order": 151,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT [codigo], [cliente], [campanha], [avaliado],\t[superior],\t[data_avaliacao], [tipo_avaliacao],\t[departamento],\t[avaliador], [processo], [codigo_gravacao],\t[tempo_avaliacao], [nota], [data_feedback],\t[resultado_feedback],\t[responsavel_feedback],\t[obs_responsavel_feedback],\t[obs_avaliado],\t[tabulacao],\t[nota_sem_ncg],\t[visualizacao_avaliado],\t[pesquisa_avaliado],\t[login_avaliado],\t[data_admissao_avaliado],\t[data_inicio_setor],\t[codigo_externo],\t[status_feedback],\t[tempo_feedback],\t[formulario],\t[codigo_gravador],\t[codigo_integracao],\t[data_contato],\t[atendimento realizado dentro do sla],\t[causa raiz],\t[classificacao da tratativa],\t[comentario], [data/hora da opiniao], [ilha],\t[nota avaliacao],\t[n\u00famero do ticket],\t[parceiros],\t[ponto de oportunidade],\t[produto identificado],\t[tema pedido],\t[tema resposta],\t[periodo],\t[pontos_positivos],\t[pontos_melhorar],\t[qtd_arquivos],\t[matricula],\t[observacao],\t[email_avaliado],\t[ticket],\t[acima_meta],\t[unidade],\t[status_usuario],\t[segundo_superior],\t[terceiro_superior], CAST(data_avaliacao AS DATE), [tipo_auditoria], [analise_auditoria] FROM dim_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT * FROM vw_2clix_analiticosAvaliacoes_cod3"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT * FROM vw_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod3]": [
                "DROP",
                "DROP TABLE f_2clix_analiticosAvaliacoes_cod3; SELECT * INTO f_2clix_analiticosAvaliacoes_cod3 FROM vw_2clix_analiticosAvaliacoes_cod3"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod304]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod304]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod304",
        "type": "Table",
        "start": 59170,
        "end": 59568,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod304]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod304](\n\t[id] [varchar](100) NOT NULL,\n\t[nome_instituicao] [varchar](50) NULL,\n\t[mes_cadastro] [date] NULL,\n\t[sexo] [varchar](1) NULL,\n\t[idade] [int] NULL,\n\t[qtd_pacientes] [int] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 152,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod304]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod304]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod304]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod304"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod304]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod304]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod304]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod304]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod304]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod304]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod304]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod304]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod304",
        "type": "View",
        "start": 59568,
        "end": 59977,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod304]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE   VIEW [dbo].[vw_mendi_saudevianet_cod304] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t [id]\t\t\t\t\t \n\t\t\t,[nome_instituicao]\t\t\n\t\t\t,[mes_cadastro]\n\t\t\t,[sexo]\t\t\t\t\t\n\t\t\t,[idade]\t\t\t\t\n\t\t\t,[qtd_pacientes]\n\tFROM [dim_mendi_saudevianet_cod304]\n)\n\nSELECT * FROM inicio\n\nGO\n",
        "build_order": 153,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod304]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod304]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod304]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod304]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod304]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod304]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod61]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod61]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod61",
        "type": "Table",
        "start": 59977,
        "end": 60763,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod61]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod61](\n\t[id] [varchar](150) NOT NULL,\n\t[inst_id] [varchar](50) NOT NULL,\n\t[inst_tx_nome] [varchar](50) NOT NULL,\n\t[mes_ref] [datetime] NOT NULL,\n\t[qtd_total] [int] NOT NULL,\n\t[qtd_agendamentos] [int] NOT NULL,\n\t[qtd_marcados] [int] NOT NULL,\n\t[qtd_atendido] [int] NOT NULL,\n\t[qtd_falta] [int] NOT NULL,\n\t[qtd_desmarcados] [int] NOT NULL,\n\t[qtd_remarcacao] [int] NOT NULL,\n\t[perc_faltas] [float] NOT NULL,\n\t[qtd_retornos] [int] NOT NULL,\n\t[valor_marcados] [int] NOT NULL,\n\t[valor_atendido] [int] NOT NULL,\n\t[valor_faltas] [int] NOT NULL,\n\t[valor_desmarcados] [int] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 154,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod61]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod61]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod61]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod61"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod61]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod61]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod61]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod61]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod61]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod61]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod61]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod61]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod61",
        "type": "View",
        "start": 60763,
        "end": 61519,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod61]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   VIEW [dbo].[vw_mendi_saudevianet_cod61] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[inst_tx_nome]\t\t\t\t\n\t\t\t,[mes_ref]\t\t\t\t\t\n\t\t\t,[qtd_total]\t\t\t\t\n\t\t\t,[qtd_agendamentos]\t\t\t\n\t\t\t,[qtd_marcados]\t\t\t\t\n\t\t\t,[qtd_atendido]\t\t\t\t\n\t\t\t,[qtd_falta]\t\t\t\t\n\t\t\t,[qtd_desmarcados]\t\t\t\n\t\t\t,[qtd_remarcacao]\t\t\t\n\t\t\t,[perc_faltas]\t\t\t\t\n\t\t\t,[qtd_retornos]\t\t\t\t\n\t\t\t,[valor_marcados]\t\t\t\n\t\t\t,[valor_atendido]\t\t\t\n\t\t\t,[valor_faltas]\t\t\t\t\n\t\t\t,[valor_desmarcados]\n\tFROM [dim_mendi_saudevianet_cod61]\n),\n\ninsert_data AS\n(\n\tSELECT *\n\t,[data] = CAST([mes_ref] AS DATE)\n\n\tFROM inicio\n)\n\nSELECT * FROM insert_data\n\nGO\n",
        "build_order": 155,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod61]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod61]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod61]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod61]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod61]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod61]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod78]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod78]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod78",
        "type": "Table",
        "start": 61519,
        "end": 62179,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod78]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod78](\n\t[id] [varchar](150) NOT NULL,\n\t[inst_id] [varchar](50) NOT NULL,\n\t[agda_tx_rotulo] [varchar](100) NOT NULL,\n\t[agda_id] [varchar](50) NOT NULL,\n\t[data_ref] [date] NOT NULL,\n\t[qtd_ocupado] [int] NOT NULL,\n\t[qtd_total] [int] NOT NULL,\n\t[qtd_min_dia] [int] NOT NULL,\n\t[perc_ocupacao_slot] [float] NOT NULL,\n\t[tempo_ocupado] [int] NOT NULL,\n\t[perc_ocupacao_tempo] [float] NOT NULL,\n\t[qtd_agend] [int] NOT NULL,\n\t[qtd_agend_slot] [int] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 156,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod78]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod78]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod78]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod78"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod78]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod78]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod78]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod78]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod78]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod78]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod78]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod78]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod78",
        "type": "View",
        "start": 62179,
        "end": 62839,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod78]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   VIEW [dbo].[vw_mendi_saudevianet_cod78] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[agda_tx_rotulo]\t\t\t\n\t\t\t,[agda_id]\t\t\t\t\t\n\t\t\t,[data_ref]\t\t\t\t\t\n\t\t\t,[qtd_ocupado]\t\t\t\t\n\t\t\t,[qtd_total]\t\t\t\t\n\t\t\t,[qtd_min_dia]\t\t\t\t\n\t\t\t,[perc_ocupacao_slot]\t\t\n\t\t\t,[tempo_ocupado]\t\t\t\n\t\t\t,[perc_ocupacao_tempo]\t\t\n\t\t\t,[qtd_agend]\t\t\t\t\n\t\t\t,[qtd_agend_slot]\n\tFROM [dim_mendi_saudevianet_cod78]\n),\n\ninsert_data AS\n(\n\tSELECT *\n\t,[data] = CAST([data_ref] AS DATE)\n\n\tFROM inicio\n)\n\nSELECT * FROM insert_data\n\nGO\n",
        "build_order": 157,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod78]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod78]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod78]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod78]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod78]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod78]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_forms]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_forms]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_you_forms",
        "type": "Table",
        "start": 62839,
        "end": 63812,
        "code": "/****** Object:  Table [dbo].[dim_you_forms]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_you_forms](\n\t[ID] [bigint] NULL,\n\t[Hora de in\u00edcio] [datetime] NULL,\n\t[Hora de conclus\u00e3o] [datetime] NULL,\n\t[Email] [varchar](max) NULL,\n\t[Nome] [float] NULL,\n\t[Informe a data da consulta.] [datetime] NULL,\n\t[Informe a hora da consulta, no formato \"HH:MM\".] [varchar](max) NULL,\n\t[Selecione seu nome e (CRP).] [varchar](max) NULL,\n\t[Selecione o cliente relacionado a consulta.] [varchar](max) NULL,\n\t[Selecione a cidade em que o paciente trabalha.] [varchar](max) NULL,\n\t[De acordo com a vida pessoal do paciente, selecione as informa\u00e7\u00f5es abaixo:] [varchar](max) NULL,\n\t[De acordo com a sa\u00fade mental do paciente, selecione as informa\u00e7\u00f5es abaixo:] [varchar](max) NULL,\n\t[De acordo com a\u00a0vida profissional\u00a0do paciente, selecione as informa\u00e7\u00f5es abaixo:] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 158,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_forms]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_you_forms]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_you_forms]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_you_forms"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_forms]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_you_forms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_forms]": [
                "UNKNOWN",
                "[dim_you_forms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_you_forms]": [
                "SELECT",
                "SELECT * INTO dim_you_forms"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_forms]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_forms]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_forms",
        "type": "Table",
        "start": 63812,
        "end": 65668,
        "code": "/****** Object:  Table [dbo].[dim_mendi_forms]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_forms](\n\t[ID] [bigint] NULL,\n\t[Hora de in\u00edcio] [datetime] NULL,\n\t[Hora de conclus\u00e3o] [datetime] NULL,\n\t[Email] [varchar](max) NULL,\n\t[Nome] [float] NULL,\n\t[Informe a data da consulta.] [datetime] NULL,\n\t[Informe a hora da consulta, no formato \"HH:MM\".] [varchar](max) NULL,\n\t[Selecione seu nome e (CRP).] [varchar](max) NULL,\n\t[Informe o procedimento relacionado a consulta.] [varchar](max) NULL,\n\t[Selecione o cliente relacionado a consulta.] [varchar](max) NULL,\n\t[Selecione a cidade em que o paciente trabalha.] [varchar](max) NULL,\n\t[Selecione a unidade que o paciente trabalha. BNU] [varchar](max) NULL,\n\t[Selecione a unidade que o paciente trabalha. Gaspar] [varchar](max) NULL,\n\t[Selecione a unidade que o paciente trabalha. Guaramirim] [varchar](max) NULL,\n\t[Selecione a unidade que o paciente trabalha. Ibirama] [float] NULL,\n\t[Selecione a unidade que o paciente trabalha. Indaial] [varchar](max) NULL,\n\t[Selecione a unidade que o paciente trabalha. JS] [varchar](max) NULL,\n\t[Selecione a unidade que o paciente trabalha. Joinville] [varchar](max) NULL,\n\t[Selecione a unidade que o paciente trabalha. Rodeio] [varchar](max) NULL,\n\t[Selecione a unidade que o paciente trabalha. Timbo] [varchar](max) NULL,\n\t[De acordo com a vida pessoal do paciente, selecione as informa\u00e7\u00f5es abaixo:] [varchar](max) NULL,\n\t[De acordo com a Sa\u00fade Emocional, o colaborador/a manifestou:] [varchar](max) NULL,\n\t[De acordo com a sa\u00fade mental do paciente, apresenta sinais ou sintomas de: ] [varchar](max) NULL,\n\t[De acordo com a vida profissional do paciente, apresenta sinais ou sintomas de:] [varchar](max) NULL,\n\t[Hora da \u00faltima modifica\u00e7\u00e3o] [float] NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 159,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_forms]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_forms]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_forms]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_forms"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_forms]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_forms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_forms]": [
                "UNKNOWN",
                "[dim_mendi_forms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_forms]": [
                "SELECT",
                "SELECT * INTO dim_mendi_forms"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_forms]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_forms]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_forms",
        "type": "View",
        "start": 65668,
        "end": 70225,
        "code": "/****** Object:  View [dbo].[vw_mendi_forms]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE     VIEW [dbo].[vw_mendi_forms] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t [ID]\n\t,[Hora de in\u00edcio]\n\t,[Hora de conclus\u00e3o]\n\t,[Email]\n\t,[Nome]\n\t,[Informe a data da consulta.]\n\t,[Informe a hora da consulta, no formato \"HH:MM\".]\n\t,[Selecione seu nome e (CRP).]\n\t,[Informe o procedimento relacionado a consulta.]\n\t,[Selecione o cliente relacionado a consulta.]\n\t,[Selecione a cidade em que o paciente trabalha.]\n\t,[Selecione a unidade que o paciente trabalha. BNU]\n\t,[Selecione a unidade que o paciente trabalha. Gaspar]\n\t,[Selecione a unidade que o paciente trabalha. Guaramirim]\n\t,[Selecione a unidade que o paciente trabalha. Ibirama]\n\t,[Selecione a unidade que o paciente trabalha. Indaial]\n\t,[Selecione a unidade que o paciente trabalha. JS]\n\t,[Selecione a unidade que o paciente trabalha. Joinville]\n\t,[Selecione a unidade que o paciente trabalha. Rodeio]\n\t,[Selecione a unidade que o paciente trabalha. Timbo]\n\t,[De acordo com a vida pessoal do paciente, selecione as informa\u00e7\u00f5es abaixo:]\n\t,[De acordo com a Sa\u00fade Emocional, o colaborador/a manifestou:]\n\t,[De acordo com a sa\u00fade mental do paciente, apresenta sinais ou sintomas de: ]\n\t,[De acordo com a vida profissional do paciente, apresenta sinais ou sintomas de:]\n\t,[Hora da \u00faltima modifica\u00e7\u00e3o]\n\n\tFROM [dim_mendi_forms]\n\n\tUNION ALL\n\t\tSELECT\n\t\t [ID]                                                                                 = [ID]\n\t\t,[Hora de in\u00edcio]                                                                     = [Hora de in\u00edcio]\n\t\t,[Hora de conclus\u00e3o]                                                                  = [Hora de conclus\u00e3o]\n\t\t,[Email]                                                                              = [Email]\n\t\t,[Nome]                                                                               = [Nome]\n\t\t,[Informe a data da consulta.]                                                        = [Informe a data da consulta.]\n\t\t,[Informe a hora da consulta, no formato \"HH:MM\".]                                    = [Informe a hora da consulta, no formato \"HH:MM\".]\n\t\t,[Selecione seu nome e (CRP).]                                                        = [Selecione seu nome e (CRP).]\n\t\t,[Informe o procedimento relacionado a consulta.]                                     = 'Psicoterapia Online'\n\t\t,[Selecione o cliente relacionado a consulta.]                                        = [Selecione o cliente relacionado a consulta.]\n\t\t,[Selecione a cidade em que o paciente trabalha.]                                     = [Selecione a cidade em que o paciente trabalha.]\n\t\t,[Selecione a unidade que o paciente trabalha. BNU]                                   = NULL\n\t\t,[Selecione a unidade que o paciente trabalha. Gaspar]                                = NULL\n\t\t,[Selecione a unidade que o paciente trabalha. Guaramirim]                            = NULL\n\t\t,[Selecione a unidade que o paciente trabalha. Ibirama]                               = NULL\n\t\t,[Selecione a unidade que o paciente trabalha. Indaial]                               = NULL \n\t\t,[Selecione a unidade que o paciente trabalha. JS]                                    = NULL\n\t\t,[Selecione a unidade que o paciente trabalha. Joinville]                             = NULL  \n\t\t,[Selecione a unidade que o paciente trabalha. Rodeio]                                = NULL\n\t\t,[Selecione a unidade que o paciente trabalha. Timbo]                                 = NULL\n\t\t,[De acordo com a vida pessoal do paciente, selecione as informa\u00e7\u00f5es abaixo:]         = [De acordo com a vida pessoal do paciente, selecione as informa\u00e7\u00f5es abaixo:] \n\t\t,[De acordo com a Sa\u00fade Emocional, o colaborador/a manifestou:]                       = NULL\n\t\t,[De acordo com a sa\u00fade mental do paciente, apresenta sinais ou sintomas de: ]        = [De acordo com a sa\u00fade mental do paciente, selecione as informa\u00e7\u00f5es abaixo:]\n\t\t,[De acordo com a vida profissional do paciente, apresenta sinais ou sintomas de:]    = [De acordo com a\u00a0vida profissional\u00a0do paciente, selecione as informa\u00e7\u00f5es abaixo:] \n\t\t,[Hora da \u00faltima modifica\u00e7\u00e3o]                                                         = NULL\n\n\t\tFROM [dim_you_forms]\n\n),\n\ninsert_data AS\n(\n\tSELECT *\n\t,[data]          = CAST([Informe a data da consulta.] AS DATE)\n\t,[nome_psico_id] = FX.PriMaiuscula(TRIM(LEFT([Selecione seu nome e (CRP).],CHARINDEX('-',[Selecione seu nome e (CRP).])-1)))\n\n\tFROM inicio\n)\n\nSELECT * FROM insert_data\n\nGO\n",
        "build_order": 160,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]": [
                "UNKNOWN",
                "PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_forms]": [
                "UNKNOWN",
                "[dim_you_forms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_forms]": [
                "UNKNOWN",
                "[dim_mendi_forms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_forms]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_mendi_forms]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_forms]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_mendi_forms]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod62]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod62]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod62",
        "type": "Table",
        "start": 70225,
        "end": 70870,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod62]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod62](\n\t[id] [varchar](150) NOT NULL,\n\t[inst_id] [varchar](50) NOT NULL,\n\t[inst_tx_nome] [varchar](50) NOT NULL,\n\t[agda_tx_rotulo] [varchar](100) NOT NULL,\n\t[nome_profissional] [varchar](100) NOT NULL,\n\t[qtd_agendamentos] [int] NOT NULL,\n\t[qtd_marcados] [int] NOT NULL,\n\t[qtd_atendido] [int] NOT NULL,\n\t[qtd_falta] [int] NOT NULL,\n\t[qtd_desmarcados] [int] NOT NULL,\n\t[qtd_remarcacao] [int] NOT NULL,\n\t[perc_faltas] [float] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 161,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod62]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod62]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod62]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod62"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod62]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod62]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod62]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod62]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod62]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod62]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod78]": [
                "SELECT",
                "SELECT * FROM dim_mendi_saudevianet_cod62"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod62]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod62]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod62",
        "type": "View",
        "start": 70870,
        "end": 71434,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod62]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE   VIEW [dbo].[vw_mendi_saudevianet_cod62] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[inst_tx_nome]\t\t\t\t\n\t\t\t,[agda_tx_rotulo]\t\t\t\t\t\n\t\t\t,[nome_profissional]\t\t\t\t\n\t\t\t,[qtd_agendamentos]\t\t\t\n\t\t\t,[qtd_marcados]\t\t\t\t\n\t\t\t,[qtd_atendido]\t\t\t\t\n\t\t\t,[qtd_falta]\t\t\t\t\n\t\t\t,[qtd_desmarcados]\t\t\t\n\t\t\t,[qtd_remarcacao]\t\t\t\n\t\t\t,[perc_faltas]\n\tFROM [dim_mendi_saudevianet_cod62]\n)\nSELECT * FROM inicio\n\nGO\n",
        "build_order": 162,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod62]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod62]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod62]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod62]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod62]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_saudevianet_cod62]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_calendario",
        "type": "Table",
        "start": 71434,
        "end": 72553,
        "code": "/****** Object:  Table [dbo].[dim_calendario]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_calendario](\n\t[Data] [date] NULL,\n\t[Ano] [int] NULL,\n\t[M\u00eas] [int] NULL,\n\t[M\u00eas_Nome] [nvarchar](30) NULL,\n\t[M\u00eas_PrimeroDia] [date] NULL,\n\t[M\u00eas_Passado] [nvarchar](30) NULL,\n\t[M\u00easAno_Formatado] [nvarchar](61) NULL,\n\t[M\u00easAno_FormatadoAbreviado] [nvarchar](34) NULL,\n\t[M\u00easAno_FormatadoClassific] [int] NULL,\n\t[Dia] [int] NULL,\n\t[DiaSemana] [int] NULL,\n\t[DiaSemana_Nome] [nvarchar](30) NULL,\n\t[DiaSemana_NomeCurto] [nvarchar](3) NULL,\n\t[DiaUtil] [int] NOT NULL,\n\t[DiaUtil_ComSabado] [int] NOT NULL,\n\t[DiaUtil_N\u00e3oFeriados] [int] NULL,\n\t[DiaUtil_ComSabado_N\u00e3oFeriados] [int] NULL,\n\t[Semana_Ano] [int] NULL,\n\t[Semana_Mes] [int] NULL,\n\t[Semana_Mes_For\u00e7ada] [int] NULL,\n\t[Semana_Mes_For\u00e7ada_PrimeiroDia] [date] NULL,\n\t[Semana_Mes_For\u00e7ada_Texto] [varchar](38) NOT NULL,\n\t[Trimestre] [int] NULL,\n\t[Trimestre_Texto] [varchar](41) NOT NULL,\n\t[Semestre] [int] NULL,\n\t[Feriados] [int] NOT NULL,\n\t[Feriado_Nome] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 163,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_calendario]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_calendario]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_metas]": [
                "UNKNOWN",
                "dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": [
                "UNKNOWN",
                "dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": [
                "SELECT",
                "SELECT * FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "SELECT",
                "SELECT Data FROM (SELECT MAX(Data) as Data FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": [
                "UNKNOWN",
                "dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": [
                "SELECT",
                "SELECT DISTINCT fx.PriMaiuscula(FORMAT(Data, 'yyyy - MMMM')) AS [M\u00eas], DATEFROMPARTS(YEAR(Data),MONTH(Data),1) AS [Data In\u00edcio], EOMONTH(Data) AS [Data Fim] FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA_usuarioreuniao]": [
                "UNKNOWN",
                "select MAX(data) from dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_creditos]": [
                "SELECT",
                "SELECT DISTINCT [M\u00easAno_FormatadoAbreviado],[M\u00eas_PrimeroDia] FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_intelix]": [
                "SELECT",
                "SELECT MAX([Data]) FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "SELECT",
                "SELECT MAX([Data]) FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": [
                "SELECT",
                "SELECT MAX([Data]) FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_calendario]": [
                "UNKNOWN",
                "dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "SELECT",
                "SELECT * FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "SELECT",
                "SELECT MAX(CAST(Data AS DATE)) FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_calendario"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_metas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_metas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_xl_qualidade_metas",
        "type": "View",
        "start": 72553,
        "end": 73121,
        "code": "/****** Object:  View [dbo].[vw_xl_qualidade_metas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE     VIEW [dbo].[vw_xl_qualidade_metas] AS\n\n\tselect distinct\n\t\t[Data] = c.[Semana_Mes_For\u00e7ada_PrimeiroDia],\n\t\tmop.[ID Selecionar], \n\t\tmop.[ID Serasa], \n\t\tmop.[Nome], \n\t\tmop.[Status],\n\t\tmop.[Tribo]\n\tfrom f_mop_historico as mop\n\tleft join dim_calendario as c\n\ton mop.[Data da Atualiza\u00e7\u00e3o] = c.[Data]\n\twhere [Cliente] = 'Serasa' and [Projeto] not in ('BodyShop', 'Gest\u00e3o', 'Suporte')\n\tand c.Data >= '01/10/2023'\n\n\n\nGO\n",
        "build_order": 164,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "UNKNOWN",
                "dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_metas]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_xl_qualidade_metas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_metas]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_xl_qualidade_metas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON [vw_xl_qualidade_metas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_2clix_treinamentos",
        "type": "Table",
        "start": 73121,
        "end": 73987,
        "code": "/****** Object:  Table [dbo].[dim_2clix_treinamentos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_2clix_treinamentos](\n\t[codigo] [int] NOT NULL,\n\t[avaliado] [varchar](100) NOT NULL,\n\t[id_avaliado] [varchar](25) NOT NULL,\n\t[campanhas] [varchar](500) NOT NULL,\n\t[status] [varchar](50) NOT NULL,\n\t[responsavel] [varchar](100) NOT NULL,\n\t[motivo] [varchar](50) NOT NULL,\n\t[formato] [varchar](50) NOT NULL,\n\t[tipo] [varchar](50) NOT NULL,\n\t[periodo] [varchar](50) NOT NULL,\n\t[superior] [varchar](100) NOT NULL,\n\t[titulo] [varchar](250) NOT NULL,\n\t[reunioes_previstas] [int] NOT NULL,\n\t[reunioes_realizadas] [int] NOT NULL,\n\t[presencas] [int] NOT NULL,\n\t[absenteismo] [float] NULL,\n\t[questionarios] [int] NOT NULL,\n\t[pontuacao] [float] NULL,\n\t[duracao_estimada] [time](7) NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 165,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_treinamentos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_treinamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_treinamentos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_treinamentos]": [
                "UNKNOWN",
                "dim_2clix_treinamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_treinamentos]": [
                "SELECT",
                "SELECT * FROM [dim_2clix_treinamentos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON [dim_2clix_treinamentos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos_demandas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos_demandas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_2clix_treinamentos_demandas",
        "type": "Table",
        "start": 73987,
        "end": 74569,
        "code": "/****** Object:  Table [dbo].[dim_2clix_treinamentos_demandas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_2clix_treinamentos_demandas](\n\t[campanhas] [nvarchar](250) NOT NULL,\n\t[status] [nvarchar](50) NOT NULL,\n\t[responsavel] [nvarchar](50) NOT NULL,\n\t[motivo] [nvarchar](50) NOT NULL,\n\t[formato] [nvarchar](50) NOT NULL,\n\t[tipo] [nvarchar](50) NOT NULL,\n\t[periodo] [nvarchar](50) NOT NULL,\n\t[titulo] [nvarchar](100) NOT NULL,\n\t[participantes] [tinyint] NOT NULL,\n\t[DMA] [nvarchar](50) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 166,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos_demandas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_treinamentos_demandas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_treinamentos_demandas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_treinamentos_demandas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos_demandas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_treinamentos_demandas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_treinamentos]": [
                "UNKNOWN",
                "dim_2clix_treinamentos_demandas"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_treinamentos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_treinamentos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_2clix_treinamentos",
        "type": "View",
        "start": 74569,
        "end": 75694,
        "code": "/****** Object:  View [dbo].[vw_2clix_treinamentos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE VIEW [dbo].[vw_2clix_treinamentos] AS\nWITH \ninicio AS ( \n\tSELECT \n\t [codigo]\n\t,[avaliado]\n\t,[id_avaliado]\n\t,[campanhas]\n\t,[status]\n\t,[responsavel]\n\t,[motivo]\n\t,[formato]\n\t,[tipo]\n\t,[periodo]\n\t,[superior]\n\t,[titulo]\n\t,[reunioes_previstas]\n\t,[reunioes_realizadas]\n\t,[presencas]\n\t,[absenteismo]\n\t,[questionarios]\n\t,[pontuacao]\n\t,[duracao_estimada] \n\t\n\tFROM dim_2clix_treinamentos\n\t\n),\ngrude AS(\n\n\tSELECT \n\t t0.[codigo]\n\t,t0.[avaliado]\n\t,t0.[id_avaliado]\n\t,t0.[campanhas]\n\t,t0.[status]\n\t,t0.[responsavel]\n\t,t0.[motivo]\n\t,t0.[formato]\n\t,t0.[tipo]\n\t,t0.[periodo]\n\t,[data_inicio] = CAST(LEFT(t0.periodo,10) AS DATE)\n\t,[data_fim] = CAST(RIGHT(t0.periodo,10) AS DATE)\n\t,t0.[superior]\n\t,t0.[titulo]\n\t,t0.[reunioes_previstas]\n\t,t0.[reunioes_realizadas]\n\t,t0.[presencas]\n\t,t0.[absenteismo]\n\t,t0.[questionarios]\n\t,t0.[pontuacao]\n\t,t0.[duracao_estimada]\n\t,t1.[DMA]\n\tFROM inicio AS t0\n\tLEFT JOIN dim_2clix_treinamentos_demandas AS t1 ON t0.titulo = t1.titulo\n\n)\nSELECT * FROM grude\n\nGO\n",
        "build_order": 167,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos]": [
                "UNKNOWN",
                "dim_2clix_treinamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos_demandas]": [
                "UNKNOWN",
                "dim_2clix_treinamentos_demandas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_treinamentos]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_2clix_treinamentos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_treinamentos]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_2clix_treinamentos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_DMA_eventos]": [
                "UNKNOWN",
                "vw_2clix_treinamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA]": [
                "UNKNOWN",
                "vw_2clix_treinamentos"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_prognostico",
        "type": "Table",
        "start": 75694,
        "end": 76354,
        "code": "/****** Object:  Table [dbo].[dim_prognostico]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_prognostico](\n\t[id_movimento] [int] NOT NULL,\n\t[tipo_pedido] [varchar](max) NOT NULL,\n\t[status] [varchar](max) NOT NULL,\n\t[operacao_origem] [varchar](max) NOT NULL,\n\t[operacao_destino] [varchar](max) NOT NULL,\n\t[admissao] [date] NULL,\n\t[inicio_treinamento_real] [date] NULL,\n\t[fim_treinamento_real] [date] NULL,\n\t[data_pa_real] [date] NULL,\n\t[hcs_pedido] [int] NOT NULL,\n\t[hcs_entregue_treinamento] [int] NOT NULL,\n\t[hcs_entregue_operacao] [int] NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 168,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_prognostico]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_prognostico]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_prognostico]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_DMA_eventos]": [
                "UNKNOWN",
                "dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA]": [
                "UNKNOWN",
                "dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico]": [
                "UNKNOWN",
                "dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico]": [
                "INSERT",
                "INSERT INTO dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_prognostico"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_DMA_eventos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_DMA_eventos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mop_DMA_eventos",
        "type": "View",
        "start": 76354,
        "end": 77847,
        "code": "/****** Object:  View [dbo].[vw_mop_DMA_eventos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n--SELECT * FROM dim_mop_eventos\n\nCREATE VIEW [dbo].[vw_mop_DMA_eventos] AS\nWITH\ninicio AS (\n\tSELECT \n\t [data_atualizacao]\n\t,[ID_selecionar]\n\t,[ID_serasa]\n\t,[tribo]\n\t,[dma]\n\t,[instrutor]\t\n\tFROM dim_mop_eventos\n),\ngrude AS (\n \tSELECT \n\t t1.titulo\n\t,t1.[id_avaliado]\n\t,t1.[data_inicio]\n\t,t1.[data_fim]\n\t,t0.[data_atualizacao]\n\t,t0.[ID_selecionar]\n\t,t0.[tribo]\n\t,t0.[dma]\n\t,[DMA_qld] = t1.[DMA]\n\t,t0.[instrutor]\n\t,[instrutor_qld] = t1.[responsavel]\n\t,t2.[data_pa_real]\n\tFROM vw_2clix_treinamentos AS t1\n\tLEFT JOIN dim_prognostico AS t2 ON t2.id_movimento = TRY_CAST(RIGHT(t1.dma,3) AS INT)\n\t\t\t\t\t\t\t\t\tOR t2.id_movimento = TRY_CAST(LEFT(t1.dma,3) AS INT)\n\tLEFT JOIN inicio AS t0 ON t0.[ID_Selecionar] = t1.[id_avaliado] AND\n\t\t\t\t\t\t\t\t\t\t\t t0.[data_atualizacao]>=t1.[data_inicio] AND\n\t\t\t\t\t\t\t\t\t\t\t t0.[data_atualizacao]<=t2.[data_pa_real]\n\t\t\t\t\t\t\t\t\t\t\t WHERE t1.DMA IS NOT NULL \n),\ngrude_2 AS(\n\tSELECT\n\t [titulo]\n\t,[id_avaliado]\n\t,[data_inicio]\n\t,[data_fim]\n\t,[data_atualizacao]\n\t,[ID_selecionar]\n\t,[tribo]\n\t,[dma]\n\t,[DMA_qld]\n\t,[instrutor]\n\t,[instrutor_qld]\n\t,[data_pa_real]\n\t,[dma_preenchido] = MAX(DMA_qld) OVER (PARTITION BY titulo ORDER BY [data_atualizacao] ROWS UNBOUNDED PRECEDING)\n\t,[trinador_preenchido] = MAX([instrutor_qld]) OVER (PARTITION BY ID_SELECIONAR ORDER BY [data_atualizacao] ROWS UNBOUNDED PRECEDING)\n\tFROM grude\n)\nSELECT * FROM grude_2\n\nGO\n",
        "build_order": 169,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": [
                "UNKNOWN",
                "dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_treinamentos]": [
                "UNKNOWN",
                "vw_2clix_treinamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]": [
                "UNKNOWN",
                "dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_DMA_eventos]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_mop_DMA_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_DMA_eventos]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_mop_DMA_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_you_gendo",
        "type": "Table",
        "start": 77847,
        "end": 78338,
        "code": "/****** Object:  Table [dbo].[dim_you_gendo]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_you_gendo](\n\t[id_paciente] [varchar](max) NOT NULL,\n\t[data] [date] NOT NULL,\n\t[hora_inicio] [time](5) NOT NULL,\n\t[hora_fim] [time](5) NOT NULL,\n\t[paciente] [varchar](150) NOT NULL,\n\t[telefone] [varchar](max) NULL,\n\t[responsavel] [varchar](150) NOT NULL,\n\t[status] [varchar](100) NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 170,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_you_gendo]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_you_gendo]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_you_gendo]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_atendimentostotal]": [
                "SELECT",
                "SELECT COUNT([id_paciente]) FROM dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_vidasatendidas]": [
                "SELECT",
                "SELECT COUNT(DISTINCT [id_paciente]) FROM dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_colaboradorescadastrados]": [
                "SELECT",
                "SELECT COUNT(DISTINCT [id_paciente]) FROM dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_you_gendo]": [
                "UNKNOWN",
                "dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "UNKNOWN",
                "dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_formulario]": [
                "INSERT",
                "INSERT INTO dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_gendo]": [
                "SELECT",
                "SELECT * FROM dim_you_gendo"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod7",
        "type": "Table",
        "start": 78338,
        "end": 79706,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod7]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod7](\n\t[id] [varchar](50) NOT NULL,\n\t[inst_id] [varchar](50) NOT NULL,\n\t[inst_nome] [varchar](50) NOT NULL,\n\t[agen_motivo_cancelamento] [varchar](250) NULL,\n\t[agda_rotulo] [varchar](100) NOT NULL,\n\t[pess_id] [varchar](50) NOT NULL,\n\t[pess_nome] [varchar](100) NOT NULL,\n\t[agen_inicio] [datetime] NOT NULL,\n\t[agen_chegada] [datetime] NULL,\n\t[agen_intervalo] [int] NOT NULL,\n\t[agen_inicio_atendimento] [datetime] NULL,\n\t[agen_fim_atendimento] [datetime] NULL,\n\t[siag_situacao_agend] [varchar](25) NOT NULL,\n\t[agen_encaixe] [varchar](3) NOT NULL,\n\t[agen_antecipar] [varchar](3) NOT NULL,\n\t[agen_online] [varchar](3) NOT NULL,\n\t[nome_profissional] [varchar](100) NOT NULL,\n\t[nome_operadora] [varchar](50) NOT NULL,\n\t[tabela_preco] [varchar](50) NULL,\n\t[procedimento] [varchar](250) NULL,\n\t[etiqueta_paciente] [varchar](50) NULL,\n\t[etiqueta_agendamento] [varchar](50) NULL,\n\t[agen_alteracao] [datetime] NOT NULL,\n\t[agen_cadastro] [datetime] NOT NULL,\n\t[nome_responsavel] [varchar](100) NULL,\n\t[ultimo_atend_inst] [datetime] NULL,\n\t[qtd_dias_sem_retorno] [int] NULL,\n\t[orca_id] [int] NULL,\n\t[inma_motivo] [varchar](100) NULL,\n\t[prox_agendamento] [datetime] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 171,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod7]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod7]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod7"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod7]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_atendimentostotal]": [
                "SELECT",
                "SELECT [Vidas Atendidas]\t= (SELECT COUNT([pess_id]) FROM dim_mendi_saudevianet_cod7"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_vidasatendidas]": [
                "SELECT",
                "SELECT [Vidas Atendidas]\t= (SELECT COUNT(DISTINCT [pess_id]) FROM dim_mendi_saudevianet_cod7"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_colaboradorescadastrados]": [
                "SELECT",
                "SELECT [Vidas Atendidas]\t= (SELECT COUNT(DISTINCT [pess_id]) FROM dim_mendi_saudevianet_cod7"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod7]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod7]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod7]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_atendimentostotal]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_atendimentostotal]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mkt_mendi_atendimentostotal",
        "type": "View",
        "start": 79706,
        "end": 80245,
        "code": "/****** Object:  View [dbo].[vw_mkt_mendi_atendimentostotal]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE         VIEW [dbo].[vw_mkt_mendi_atendimentostotal] AS\n\tSELECT [Vidas Atendidas]\t= (SELECT COUNT([pess_id]) FROM dim_mendi_saudevianet_cod7 WHERE [agen_inicio_atendimento] <= GETDATE() AND [siag_situacao_agend] IN ('Atendido', 'Em atendimento'))\n\t\t\t\t\t\t\t\t+ (SELECT COUNT([id_paciente]) FROM dim_you_gendo WHERE [Data] <= GETDATE() AND [status] IN ('Fechado e Faturado'))\n\nGO\n",
        "build_order": 172,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "SELECT",
                "SELECT COUNT([id_paciente]) FROM dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]": [
                "SELECT",
                "SELECT [Vidas Atendidas]\t= (SELECT COUNT([pess_id]) FROM dim_mendi_saudevianet_cod7"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_atendimentostotal]": [
                "CREATE",
                "CREATE         VIEW [dbo].[vw_mkt_mendi_atendimentostotal]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_atendimentostotal]": [
                "CREATE",
                "CREATE         VIEW [dbo].[vw_mkt_mendi_atendimentostotal]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_log",
        "type": "Table",
        "start": 80245,
        "end": 80839,
        "code": "/****** Object:  Table [dbo].[f_log]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_log](\n\t[Fonte] [varchar](10) NOT NULL,\n\t[ID Selecionar] [varchar](30) NULL,\n\t[ID Intelix] [int] NULL,\n\t[ID EPBX] [int] NULL,\n\t[ID Genesys] [varchar](100) NULL,\n\t[ID Secullum] [int] NULL,\n\t[Evento] [varchar](100) NOT NULL,\n\t[In\u00edcio] [datetime] NOT NULL,\n\t[Fim] [datetime] NOT NULL,\n\t[Dura\u00e7\u00e3o] [bigint] NOT NULL,\n\t[Ajustado?] [varchar](10) NOT NULL,\n\t[In\u00edcio_Original] [datetime] NOT NULL,\n\t[Fim_Original] [datetime] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 173,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_log"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "ALTER",
                "ALTER TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado_semTrava]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_log]": [
                "SELECT",
                "SELECT * FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "SELECT",
                "SELECT [Retorno]=CONCAT('f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": [
                "SELECT",
                "SELECT SUM(sub.[Dura\u00e7\u00e3o]) - (c.[Jornada (Log)]+7200000) FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_log"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_loginlogout_eventos_loginRachado",
        "type": "View",
        "start": 80839,
        "end": 82744,
        "code": "/****** Object:  View [dbo].[f_loginlogout_eventos_loginRachado]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\t---\\/---\\/---\\/---------------------------------------------------------------------------\\/---\\/---\\/---\n\t-- C\u00f3digo legado. Apagar quando a f_loginlogout_eventos_loginRachado n\u00e3o estiver mais em uso.\n\t\n\t\tCREATE VIEW [dbo].[f_loginlogout_eventos_loginRachado] AS\n\t\tSELECT\t [ID Selecionar]\n\t\t\t\t,[ID Serasa]\n\t\t\t\t,[Nome]\n\t\t\t\t,[Evento]\n\t\t\t\t,[Data]\t\t= CAST([In\u00edcio] as date)\n\t\t\t\t,[In\u00edcio]\t= CAST([In\u00edcio] as time)\n\t\t\t\t,[Fim]\t\t= CAST(DATEADD(s, CASE WHEN log_acumulado > log_limite THEN [Dura\u00e7\u00e3o]-(log_acumulado-log_limite) ELSE [Dura\u00e7\u00e3o] END, CAST([In\u00edcio] as time)) as time)\n\t\t\t\t,[Dura\u00e7\u00e3o]\t= CAST(DATEADD(s, CASE WHEN log_acumulado > log_limite THEN [Dura\u00e7\u00e3o]-(log_acumulado-log_limite) ELSE [Dura\u00e7\u00e3o] END, '00:00:00') as time)\n\t\t\t\t,[Carga]\t= [Jornada]\n\t\t\t\t,[Tipo]\n\t\t\t\t,[Ilha]\t\t= [Tribo]\n\t\t\t\t,[Projeto]\n\t\t\t\t,[Escala]\n\t\tFROM (\tSELECT ev.[ID Selecionar], mop.[ID Serasa], mop.[Nome], mop.[Jornada], mop.[Tribo], mop.[Projeto], mop.[Escala], ev.[evento], ev.[In\u00edcio], ev.[fim], ev.[Dura\u00e7\u00e3o], [log_acumulado]=SUM(ev.[Dura\u00e7\u00e3o]) OVER (PARTITION BY ev.[ID Selecionar], CAST(ev.[In\u00edcio] AS date) ORDER BY ev.[In\u00edcio]), [log_limite]=DATEDIFF(s, '00:00:00', mop.Jornada)+7200, [Tipo]=CASE WHEN ev.[fim]=CAST(CAST(ev.[In\u00edcio] AS date) AS datetime) + CAST('23:59:59' AS datetime) THEN 'Projetado' ELSE 'Realizado' END \n\t\t\t\tFROM [f_log] as ev\n\t\t\t\tINNER JOIN f_mop_historico as mop\n\t\t\t\tON\tev.[ID Selecionar] = mop.[ID Selecionar]\n\t\t\t\tAND\t[Data da Atualiza\u00e7\u00e3o] = CAST([In\u00edcio] AS date)\n\t\t\t\tWHERE ev.[Fonte] <> 'SECULLUM'\n\t\t) _ WHERE CASE WHEN log_acumulado > log_limite THEN [Dura\u00e7\u00e3o]-(log_acumulado-log_limite) ELSE [Dura\u00e7\u00e3o] END > 0\n\n\t---------------------------------------------------------------------------------------------------------------------------\n\nGO\n",
        "build_order": 174,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_loginlogout_eventos_loginRachado]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_loginlogout_eventos_loginRachado]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_loginlogout_eventos_loginRachado"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado_semTrava]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado_semTrava]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_loginlogout_eventos_loginRachado_semTrava",
        "type": "View",
        "start": 82744,
        "end": 84448,
        "code": "/****** Object:  View [dbo].[f_loginlogout_eventos_loginRachado_semTrava]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\t\tCREATE VIEW [dbo].[f_loginlogout_eventos_loginRachado_semTrava] as\n\t\tSELECT\t [ID Selecionar]\n\t\t\t\t,[ID Serasa]\n\t\t\t\t,[Nome]\n\t\t\t\t,[Evento]\n\t\t\t\t,[Data]\t\t= CAST([In\u00edcio] as date)\n\t\t\t\t,[In\u00edcio]\t= CAST([In\u00edcio] as time)\n\t\t\t\t,[Fim]\t\t= CAST(DATEADD(s, CASE WHEN log_acumulado > log_limite THEN [Dura\u00e7\u00e3o]-(log_acumulado-log_limite) ELSE [Dura\u00e7\u00e3o] END, CAST([In\u00edcio] as time)) as time)\n\t\t\t\t,[Dura\u00e7\u00e3o]\t= CAST(DATEADD(s, CASE WHEN log_acumulado > log_limite THEN [Dura\u00e7\u00e3o]-(log_acumulado-log_limite) ELSE [Dura\u00e7\u00e3o] END, '00:00:00') as time)\n\t\t\t\t,[Carga]\t= [Jornada]\n\t\t\t\t,[Tipo]\n\t\t\t\t,[Ilha]\t\t= [Tribo]\n\t\t\t\t,[Projeto]\n\t\t\t\t,[Escala]\n\t\tFROM (\tSELECT ev.[ID Selecionar], mop.[ID Serasa], mop.[Nome], mop.[Jornada], mop.[Tribo], mop.[Projeto], mop.[Escala], ev.[evento], ev.[In\u00edcio], ev.[fim], ev.[Dura\u00e7\u00e3o], [log_acumulado]=SUM(ev.[Dura\u00e7\u00e3o]) OVER (PARTITION BY ev.[ID Selecionar], CAST(ev.[In\u00edcio] AS date) ORDER BY ev.[In\u00edcio]), [log_limite]=DATEDIFF(s, '00:00:00', mop.Jornada)+7200, [Tipo]=CASE WHEN ev.[fim]=CAST(CAST(ev.[In\u00edcio] AS date) AS datetime) + CAST('23:59:59' AS datetime) THEN 'Projetado' ELSE 'Realizado' END \n\t\t\t\tFROM [f_log] as ev\n\t\t\t\tINNER JOIN f_mop_historico as mop\n\t\t\t\tON\tev.[ID Selecionar] = mop.[ID Selecionar]\n\t\t\t\tAND\t[Data da Atualiza\u00e7\u00e3o] = CAST([In\u00edcio] AS date)\n\t\t\t\tWHERE ev.[Fonte] <> 'SECULLUM'\n\t\t) _ WHERE CASE WHEN log_acumulado > log_limite THEN [Dura\u00e7\u00e3o]-(log_acumulado-log_limite) ELSE [Dura\u00e7\u00e3o] END > 0\n\t\n\n\t---/\\---/\\---/\\---------------------------------------------------------------------------/\\---/\\---/\\---\n\nGO\n",
        "build_order": 175,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "UNKNOWN",
                "[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado_semTrava]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_loginlogout_eventos_loginRachado_semTrava]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado_semTrava]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_loginlogout_eventos_loginRachado_semTrava]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_zendesk]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_zendesk]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_tickets_zendesk",
        "type": "Table",
        "start": 84448,
        "end": 85129,
        "code": "/****** Object:  Table [dbo].[dim_tickets_zendesk]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_tickets_zendesk](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[subtribo_serasa] [varchar](50) NOT NULL,\n\t[ID_ticket] [int] NOT NULL,\n\t[status] [varchar](150) NULL,\n\t[ID_serasa] [varchar](10) NULL,\n\t[criacao] [datetime] NOT NULL,\n\t[resolucao] [datetime] NULL,\n\t[formulario] [varchar](500) NULL,\n\t[motivos] [varchar](500) NULL,\n\t[tmt] [int] NULL,\n\t[replicas] [int] NOT NULL,\n\t[resolvido] [bit] NOT NULL,\n\t[reincidente_48h] [bit] NOT NULL,\n\t[reincidente_30d] [bit] NOT NULL,\n\t[chatbot] [bit] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 176,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_zendesk]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_tickets_zendesk]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_zendesk]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_tickets_zendesk]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": [
                "UNKNOWN",
                "dim_tickets_zendesk"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": [
                "UNKNOWN",
                "dim_tickets_zendesk"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": [
                "UNKNOWN",
                "dim_tickets_zendesk"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "SELECT",
                "SELECT [Retorno]=CONCAT('dim_tickets_zendesk"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_tickets_zendesk"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_xl_qualidade_loteria",
        "type": "View",
        "start": 85129,
        "end": 86646,
        "code": "/****** Object:  View [dbo].[vw_xl_qualidade_loteria]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE   VIEW [dbo].[vw_xl_qualidade_loteria] AS\n\n\nWITH\nseed AS ( SELECT seed = 333 ),\nquery AS\n(\n\tSELECT\n\t\t --randid,\n\t\t [M\u00eas]\t\t\t\t\t\t=\tt.[M\u00eas]\n\t\t,[Ciclo]\t\t\t\t\t=\tt.[Ciclo]\n\t\t,[Tribo (ticket)]\t\t\t=\tt.[Tribo (ticket)]\n\t\t,[Tribo (mop)]\t\t\t\t=\tmh.[Tribo]\n\t\t,[ID Selecionar]\t\t\t=\tmh.[ID Selecionar]\n\t\t,[ID Serasa]\t\t\t\t=\tt.[ID Serasa]\n\t\t,[Status Atual]\t\t\t\t=\tmv.[Status]\n\t\t,[ID Ticket]\t\t\t\t=\tt.[ID Ticket]\n\t\t,[Data de Resolu\u00e7\u00e3o]\t\t=\tt.[Data de Resolu\u00e7\u00e3o]\n\t\t,[Motivos]\t\t\t\t\t=\tt.[Motivos]\n\tFROM (\n\t\tSELECT \n\t\t\t randid=ROW_NUMBER() OVER (PARTITION BY t.ID_serasa, c.Semana_Mes_For\u00e7ada_PrimeiroDia ORDER BY HASHBYTES('md5',cast(t.[ID_Ticket]+(SELECT [seed] FROM seed) as varchar)))\n\t\t\t,[M\u00eas]\t\t\t\t\t\t=\tc.M\u00easAno_Formatado\n\t\t\t,[Ciclo]\t\t\t\t\t=\tc.Semana_Mes_For\u00e7ada\n\t\t\t,[Tribo (ticket)]\t\t\t=\tt.tribo_serasa\n\t\t\t,[ID Serasa]\t\t\t\t=\tt.ID_serasa\n\t\t\t,[ID Ticket]\t\t\t\t=\tt.ID_ticket\n\t\t\t,[Data de Resolu\u00e7\u00e3o]\t\t=\tt.resolucao\n\t\t\t,[Motivos]\t\t\t\t\t=\tt.motivos\n\t\tFROM dim_tickets_zendesk t\n\t\tLEFT JOIN dim_calendario c ON CAST(t.resolucao as date) = c.Data\n\t) t\n\tLEFT JOIN f_mop_historico mh\n\tON\tt.[ID Serasa] = mh.[ID Serasa]\n\tAND CAST(t.[Data de Resolu\u00e7\u00e3o] as date) = mh.[Data da Atualiza\u00e7\u00e3o]\n\tLEFT JOIN f_mop_vigente mv ON mh.[ID Selecionar] = mv.[ID Selecionar]\n\tWHERE randid = 1 AND mh.[ID Selecionar] IS NOT NULL\n)\nSELECT * FROM query\n--ORDER BY [M\u00eas] DESC, [Ciclo] DESC, [Tribo (ticket)], [ID Selecionar]\n\nGO\n",
        "build_order": 177,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "UNKNOWN",
                "dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_zendesk]": [
                "UNKNOWN",
                "dim_tickets_zendesk"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_xl_qualidade_loteria]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_xl_qualidade_loteria]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON [vw_xl_qualidade_loteria]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[tb_nps]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[tb_nps]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "tb_nps",
        "type": "Table",
        "start": 86646,
        "end": 87441,
        "code": "/****** Object:  Table [dbo].[tb_nps]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[tb_nps](\n\t[data_atualizacao] [datetime] NULL,\n\t[data_avaliacao] [datetime] NOT NULL,\n\t[ID_ticket] [int] NULL,\n\t[ID_avaliacao] [int] NOT NULL,\n\t[tribo] [varchar](max) NULL,\n\t[ID_serasa] [varchar](max) NOT NULL,\n\t[campanha] [varchar](max) NULL,\n\t[motivo_contato] [varchar](max) NULL,\n\t[produto] [varchar](max) NULL,\n\t[nota] [int] NULL,\n\t[comentario] [varchar](max) NULL,\n CONSTRAINT [PK_nps] PRIMARY KEY CLUSTERED \n(\n\t[ID_avaliacao] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = ON, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 178,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[tb_nps]": [
                "CREATE",
                "CREATE TABLE [dbo].[tb_nps]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_nps]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].tb_nps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[tb_nps]": [
                "CREATE",
                "CREATE TABLE [dbo].[tb_nps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": [
                "UNKNOWN",
                "tb_nps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "UNKNOWN",
                "tb_nps"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_nps]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_nps]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_teste_tickets_nps",
        "type": "Table",
        "start": 87441,
        "end": 87794,
        "code": "/****** Object:  Table [dbo].[dim_teste_tickets_nps]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_teste_tickets_nps](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[subtribo_serasa] [varchar](50) NOT NULL,\n\t[ID_ticket] [int] NOT NULL,\n\t[resolucao] [datetime] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 179,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_nps]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tickets_nps]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_nps]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tickets_nps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": [
                "SELECT",
                "SELECT * FROM dim_teste_tickets_nps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "SELECT",
                "SELECT * FROM dim_teste_tickets_nps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_nps]": [
                "INSERT",
                "INSERT INTO dim_teste_tickets_nps"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_nps_V2",
        "type": "View",
        "start": 87794,
        "end": 102564,
        "code": "/****** Object:  View [dbo].[vw_nps_V2]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCREATE        VIEW [dbo].[vw_nps_V2] AS\n\nWITH\nnps_base AS\n(\n\tSELECT \n\t\t[data_atualizacao_nps]\t\t\t\t=\tnps.data_atualizacao,\n\t\t[data_atualizacao_mop]\t\t\t\t=\tmop.[Data da Atualiza\u00e7\u00e3o],\n\t\t[DataHora da Opini\u00e3o]\t\t\t\t=\tnps.data_avaliacao,\n\t\t[Hora da Opini\u00e3o]\t\t\t\t\t=\tCAST(nps.data_avaliacao AS TIME),\n\t\t[Data da Opini\u00e3o]\t\t\t\t\t=\tcal.Data,\n\t\t[Semana da Opini\u00e3o]\t\t\t\t\t=\tcal.Semana_Mes_For\u00e7ada,\n\t\t[M\u00eas da Opini\u00e3o]\t\t\t\t\t=\tcal.M\u00eas_PrimeroDia,\n\t\t[ID do Ticket/Protocolo]\t\t\t=\tnps.ID_ticket,\n\t\t[ID da Opini\u00e3o]\t\t\t\t\t\t=\tnps.ID_avaliacao,\n\t\t[Tribo Serasa Original]\t\t\t\t=\tnps.tribo,\n\t\t[Tribo Serasa Padronizada]\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.data_avaliacao < '01/06/2023' \n\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - 0800 Premium'\t\t\t\t\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'NPS - Atendimento Premium (0800)'\t\tTHEN '0800 Premium'\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - Produto Autentica\u00e7\u00e3o - Desbloqueio' THEN 'OCR - IDWALL'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cadastro Positivo'\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'SAC'\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'BackOffice'\t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'OCR'\t\t\t\t\tTHEN 'OCR - IDWALL'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'OCR - IDWALL'\t\tTHEN 'OCR - IDWALL'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda'\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cr\u00e9dito'\t\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'D\u00edvidas'\t\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Score'\t\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Outros'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Premium - 0800'\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= '0800 Premium'\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cadastro Positivo'\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Sac'\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Backoffice'\t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda'\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Outros'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[Login]\t\t\t\t\t\t\t\t=\tmop.[ID Serasa],\n\t\t[ID Selecionar]\t\t\t\t\t\t=\tmop.[ID Selecionar],\n\t\t[Campanha]\t\t\t\t\t\t\t=\tnps.campanha,\n\t\t[Motivos de Contato]\t\t\t\t=\tmotivo_contato,\n\t\t[Produto]\t\t\t\t\t\t\t=\tTRIM(nps.produto),\n\t\t[Nota]\t\t\t\t\t\t\t\t=\tnps.nota,\n\t\t[Classifica\u00e7\u00e3o]\t\t\t\t\t\t=\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.nota<7 THEN 'Detratores'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.nota>8 THEN 'Promotores'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Neutros'\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[Coment\u00e1rio]\t\t\t\t\t\t=\tnps.comentario,\n\t\t[DataHora de Resolu\u00e7\u00e3o do Ticket]\t=\ttkt.resolucao,\n\t\t[Status]\t\t\t\t\t\t\t=\tmop.status,\n\t\t[Status Vigente]\t\t\t\t\t=\tmop_v.Status,\n\t\t[Nome]\t\t\t\t\t\t\t\t=\tmop.nome,\n\t\t[Projeto]\t\t\t\t\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'NPS - Atendimento Premium (0800)'\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - 0800 Premium'\t\t\t\t\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - 0800 Premium'\t\t\t\t\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Premium - 0800'\t\t\t\t\t\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= '0800 Premium'\t\t\t\t\t\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'CADASTRO POSITIVO'\t\t\t\t\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'SAC'\t\t\t\t\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Digital'\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[Tribo Selecionar]\t\t\t\t\t=\tmop.tribo,\n\t\t[Subtribo Selecionar]\t\t\t\t=\tmop.[Sub Tribo],\n\t\t[Escala]\t\t\t\t\t\t\t=\tmop.escala,\n\t\t[Supervis\u00e3o]\t\t\t\t\t\t=\tmop.Supervis\u00e3o,\n\t\t[Supervis\u00e3o Vigente]\t\t\t\t=\tmop_v.Supervis\u00e3o,\n\t\t[Coordena\u00e7\u00e3o]\t\t\t\t\t\t=\tmop.Coordena\u00e7\u00e3o,\n\t\t[tribo_2clix]\t\t\t\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = '0800 - Premium'       THEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'PREMIUM - 0800'       THEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'OCR'\t\t\t\t\tTHEN 'OCR'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'OCR - IDWALL'\t\t\tTHEN 'OCR'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Cadastro Positivo'\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'CADASTRO POSITIVO'\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'SAC'\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'BACKOFFICE'\t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'BackOffice'\t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'BKO'       \t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'RA'\t\t\t\t\tTHEN 'Reclame Aqui'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Reclame Aqui'\t\t\tTHEN 'Reclame Aqui'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Central de Ajuda'\t\tTHEN 'Central De Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'CENTRAL DE AJUDA'\t\tTHEN 'Central De Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Cr\u00e9dito'\t\t\t\tTHEN 'Cr\u00e9dito'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'D\u00edvidas'\t\t\t\tTHEN 'D\u00edvidas'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'D\u00cdVIDAS'\t\t\t\tTHEN 'D\u00edvidas'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Score'\t\t\t\tTHEN 'Score'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'SCORE'\t\t\t\tTHEN 'Score'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'GOV'\t\t\t\t\tTHEN 'GOV'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Facebook e Lojas'\t\tTHEN 'Facebook'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'FACEBOOK E LOJAS'\t\tTHEN 'Facebook'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Outros'\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[Tempo de Resposta]\t\t\t\t\t=\tDATEDIFF(DAY, tkt.resolucao, nps.data_avaliacao)\n\n\t\n\tFROM tb_nps as nps\n\tLEFT JOIN ( SELECT * FROM dim_calendario\t\t) as cal ON CAST(nps.data_avaliacao AS DATE) = cal.Data\n\tLEFT JOIN ( SELECT * FROM dim_teste_tickets_nps\t) as tkt ON nps.ID_ticket = tkt.[ID_ticket]\n\tLEFT JOIN ( SELECT * FROM f_mop_historico\t\t) as mop ON cal.Data = mop.[Data da Atualiza\u00e7\u00e3o] AND nps.ID_serasa = mop.[ID Serasa]\n\tLEFT JOIN ( SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente) as mop_v ON  nps.ID_serasa = mop_v.[ID Serasa] AND n = 1\n\tWHERE cal.Data IS NOT NULL\n),\n\nqtd_avaliacoes AS\n(\n\tSELECT *,\n\t\t[AvaliacoesXAgentesXtriboXDia] =    COUNT(*) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [Data da Opini\u00e3o]),\n\t\t[AvaliacoesXAgentesXtriboXSemana] = COUNT(*) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o]),\n\t\t[AvaliacoesXAgentesXtriboXMes] =    COUNT(*) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])\n\tFROM nps_base\n),\n\nnps_calculado AS\n(\n\tSELECT *,\n\t\t[Grupo Tempo de Resposta]\t\t=\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] < 0\tTHEN 'Neg'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] <= 1\tTHEN 'At\u00e9 24h'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] <= 2\tTHEN 'At\u00e9 48h'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] <=\t15\tTHEN 'At\u00e9 15 Dias'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] <=\t30\tTHEN 'At\u00e9 30 Dias'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] >\t30\tTHEN 'Acima de 30 Dias'\n\t\t\t\t\t\t\t\t\t\t\t\tELSE NULL\n\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[NPSxAgentexTriboSerasaxDia]\t= CAST(( SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Promotores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [Data da Opini\u00e3o])\n\t\t\t\t\t\t\t\t\t\t\t\t-SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Detratores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [Data da Opini\u00e3o]))\n\t\t\t\t\t\t\t\t\t\t\t\t/CAST([AvaliacoesXAgentesXtriboXDia] AS FLOAT)*100 AS INT),\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t[NPSxAgentexTriboSerasaxSemana]\t= CAST(( SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Promotores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])\n\t\t\t\t\t\t\t\t\t\t\t\t-SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Detratores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o]))\n\t\t\t\t\t\t\t\t\t\t\t\t/CAST([AvaliacoesXAgentesXtriboXSemana] AS FLOAT)*100 AS INT),\n\n\t\t[NPSxAgentexTriboSerasaxM\u00eas]\t= CAST(( SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Promotores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])\n\t\t\t\t\t\t\t\t\t\t\t\t-SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Detratores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o]))\n\t\t\t\t\t\t\t\t\t\t\t\t/CAST([AvaliacoesXAgentesXtriboXMes] AS FLOAT)*100 AS INT)\nFROM qtd_avaliacoes\n),\nquartil_simples AS\n(\n\tSELECT *,\n\t\t[rank_nps_Dia] =          CASE WHEN [AvaliacoesXAgentesXtriboXDia]<=0 THEN -1 ELSE RANK() OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada],[Data da Opini\u00e3o]\t\t\t\t\t\t\tORDER BY [NPSxAgentexTriboSerasaxDia] DESC,[AvaliacoesXAgentesXtriboXDia] DESC)END,\n\t\t[rank_nps_Semana] =       CASE WHEN [AvaliacoesXAgentesXtriboXSemana]<=5 THEN -1 ELSE RANK() OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o]  ORDER BY [NPSxAgentexTriboSerasaxSemana] DESC,[AvaliacoesXAgentesXtriboXSemana] DESC)END,\n\t\t[rank_nps_Mes] =          CASE WHEN [AvaliacoesXAgentesXtriboXMes]<=5 THEN -1 ELSE RANK() OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o]\t\t\t\t\t\t\tORDER BY [NPSxAgentexTriboSerasaxM\u00eas] DESC,[AvaliacoesXAgentesXtriboXMes] DESC)END\n\n\n\tFROM nps_calculado\n),\nfaixas AS\n(\n\tSELECT *,\n\t\t[QuartilxAgentexTriboSerasaxDia] =\tCASE WHEN (COUNT([ID da Opini\u00e3o]) OVER (PARTITION BY [Login],  [Tribo Serasa Padronizada], [Data da Opini\u00e3o])) <= 0 THEN 'Q N\u00c3O AVALIADO' ELSE CASE \n\t\t\t\tWHEN [Projeto] = 'Digital'\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 75 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 70 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 64 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END    \n\t\t\t\tWHEN [Projeto] = 'Sac'\t\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 70 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 65 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 58 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Cadastro Positivo' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 67 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 60 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 50 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Premium' THEN  CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 84 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 78 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 73 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END END END,\n\t\t[QuartilxAgentexTriboSerasaxSemana] =\t\tCASE WHEN (COUNT([ID da Opini\u00e3o]) OVER (PARTITION BY [Login],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])) <= 5 THEN 'Q N\u00c3O AVALIADO' ELSE CASE\n\t\t\t\tWHEN [Projeto] = 'Digital'\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 75 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 70 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 64 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END    \n\t\t\t\tWHEN [Projeto] = 'Sac'\t\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 70 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 65 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 58 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Cadastro Positivo' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 67 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 60 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 50 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Premium' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 84 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 78 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 73 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END END END,\n\t\t[QuartilxAgentexTriboSerasaxM\u00eas] =\t\tCASE WHEN (COUNT([ID da Opini\u00e3o]) OVER (PARTITION BY [Login],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])) <= 5 THEN 'Q N\u00c3O AVALIADO' ELSE CASE\n\t\t\t\tWHEN [Projeto] = 'Digital'\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 75 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 70 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 64 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END    \n\t\t\t\tWHEN [Projeto] = 'Sac'\t\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 70 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 65 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 58 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Cadastro Positivo' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 67 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 60 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 50 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Premium' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 84 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 78 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 73 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END END END,\n\t\t[quartil_simplesXDia] =                CASE WHEN [rank_nps_Dia] = -1 THEN 'Q N\u00c3O AVALIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [rank_nps_Dia]<= MAX([rank_nps_Dia]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada],[Data da Opini\u00e3o])/4*1 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t    WHEN [rank_nps_Dia]<= MAX([rank_nps_Dia]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada],[Data da Opini\u00e3o])/4*2 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t    WHEN [rank_nps_Dia]<= MAX([rank_nps_Dia]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada],[Data da Opini\u00e3o])/4*3 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t    ELSE 'Q4' END,\n\t\t[quartil_simplesXSemana] =             CASE WHEN [rank_nps_Semana] = -1 THEN 'Q N\u00c3O AVALIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [rank_nps_Semana]<= MAX([rank_nps_Semana]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])/4*1 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t                WHEN [rank_nps_Semana]<= MAX([rank_nps_Semana]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])/4*2 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t                WHEN [rank_nps_Semana]<= MAX([rank_nps_Semana]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])/4*3 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t                ELSE 'Q4' END,\n\t\t[quartil_simplesXMes] =                CASE WHEN [rank_nps_Mes] = -1 THEN 'Q N\u00c3O AVALIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [rank_nps_Mes]<= MAX([rank_nps_Mes]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])/4*1 THEN 'Q1'\n\t\t\t\t\t\t\t\t                    WHEN [rank_nps_Mes]<= MAX([rank_nps_Mes]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])/4*2 THEN 'Q2'\n\t\t\t\t\t\t\t\t                    WHEN [rank_nps_Mes]<= MAX([rank_nps_Mes]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])/4*3 THEN 'Q3'\n\t\t\t\t\t\t\t\t                    --WHEN [rank_nps_Mes]<= MAX([rank_nps_Mes]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])/4*4 THEN 'Q4'\n\t\t\t\t\t\t\t\t                    ELSE 'Q4' END\n\t\t\n\n\t\t\n\tFROM quartil_simples\n)\nSELECT * FROM faixas\n\n\n\nGO\n",
        "build_order": 180,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT * FROM f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT * FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT * FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[tb_nps]": [
                "UNKNOWN",
                "tb_nps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_nps]": [
                "SELECT",
                "SELECT * FROM dim_teste_tickets_nps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": [
                "CREATE",
                "CREATE        VIEW [dbo].[vw_nps_V2]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_nps_V2]": [
                "CREATE",
                "CREATE        VIEW [dbo].[vw_nps_V2]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_vidasatendidas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_vidasatendidas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mkt_mendi_vidasatendidas",
        "type": "View",
        "start": 102564,
        "end": 103107,
        "code": "/****** Object:  View [dbo].[vw_mkt_mendi_vidasatendidas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE     VIEW [dbo].[vw_mkt_mendi_vidasatendidas] AS\n\tSELECT [Vidas Atendidas]\t= (SELECT COUNT(DISTINCT [pess_id]) FROM dim_mendi_saudevianet_cod7 WHERE [agen_inicio_atendimento] <= GETDATE() AND [siag_situacao_agend] IN ('Atendido', 'Em atendimento'))\n\t\t\t\t\t\t\t\t+ (SELECT COUNT(DISTINCT [id_paciente]) FROM dim_you_gendo WHERE [Data] <= GETDATE() AND [status] IN ('Fechado e Faturado'))\n\nGO\n",
        "build_order": 181,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "SELECT",
                "SELECT COUNT(DISTINCT [id_paciente]) FROM dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]": [
                "SELECT",
                "SELECT [Vidas Atendidas]\t= (SELECT COUNT(DISTINCT [pess_id]) FROM dim_mendi_saudevianet_cod7"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_vidasatendidas]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_mkt_mendi_vidasatendidas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_vidasatendidas]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_mkt_mendi_vidasatendidas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys_manual]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys_manual]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_chamadas_genesys_manual",
        "type": "Table",
        "start": 103107,
        "end": 104285,
        "code": "/****** Object:  Table [dbo].[dim_chamadas_genesys_manual]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_chamadas_genesys_manual](\n\t[In\u00edcio do intervalo] [datetime] NOT NULL,\n\t[Fim do intervalo] [datetime] NOT NULL,\n\t[Intervalo conclu\u00eddo] [varchar](50) NOT NULL,\n\t[Filtros] [varchar](250) NULL,\n\t[Tipo de m\u00e9dia] [varchar](50) NOT NULL,\n\t[ID da fila] [varchar](100) NOT NULL,\n\t[Nome da fila] [varchar](100) NOT NULL,\n\t[Oferta] [int] NULL,\n\t[Resposta] [int] NULL,\n\t[% de resposta] [float] NULL,\n\t[Abandono] [int] NULL,\n\t[% de abandono] [float] NULL,\n\t[VMA] [decimal](16, 6) NULL,\n\t[% de n\u00ed\u00advel de servi\u00e7o] [float] NULL,\n\t[% de alvos do n\u00edvel de servi\u00e7o] [float] NULL,\n\t[Tempo m\u00e9dio de espera] [decimal](16, 6) NULL,\n\t[Tratamento m\u00e9dio] [decimal](16, 6) NULL,\n\t[Conversa\u00e7\u00e3o m\u00e9dia] [decimal](16, 6) NULL,\n\t[Espera m\u00e9dia] [decimal](16, 6) NULL,\n\t[TPC m\u00e9dio] [decimal](16, 6) NULL,\n\t[Em espera] [int] NULL,\n\t[Transferir] [int] NULL,\n\t[CONVERSA\u00c7\u00c3O TRATADO] [decimal](16, 6) NULL,\n\t[Espera m\u00e9dia_tratado] [decimal](16, 6) NULL,\n\t[Pondera\u00e7\u00e3o TMA] [decimal](16, 6) NULL,\n\t[NS Ajustado] [float] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 182,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys_manual]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_chamadas_genesys_manual]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_chamadas_genesys_manual"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_chamadas_genesys_manual"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys_manual]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_chamadas_genesys_manual]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_chamadas_genesys_manual]": [
                "UNKNOWN",
                "[dim_chamadas_genesys_manual]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys_manual]": [
                "INSERT",
                "INSERT INTO dim_chamadas_genesys_manual"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_chamadas_genesys_manual]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_chamadas_genesys_manual]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_chamadas_genesys_manual",
        "type": "View",
        "start": 104285,
        "end": 105491,
        "code": "/****** Object:  View [dbo].[vw_chamadas_genesys_manual]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE        VIEW [dbo].[vw_chamadas_genesys_manual] AS\n\nWITH\n\ninicio AS(\n\tSELECT\n\t\t\t [In\u00edcio do intervalo]\n\t\t\t,[data] = CAST([In\u00edcio do intervalo] AS DATE)\n\t\t\t,[Fim do intervalo]\t\t\t\t\n\t\t\t,[Intervalo conclu\u00eddo]\t\t\t\n\t\t\t,[Filtros]\t\t\t\t\t\t\n\t\t\t,[Tipo de m\u00e9dia]\t\t\t\t\n\t\t\t,[ID da fila]\t\t\t\t\t\n\t\t\t,[Nome da fila]\t\n\t\t\t,[Tribo] = CASE \n\t\t\t\t\t\t\tWHEN [Nome da fila] =  'S_CADASTRO_POSITIVO' THEN 'CADASTRO POSITIVO'\n\t\t\t\t\t\t\tWHEN [Nome da fila] =  'S_PREMIUM' THEN 'PREMIUM'\n\t\t\t\t\t\t\tWHEN [Nome da fila] =  'S_SAC' THEN 'SAC'\n\t\t\t\t\t\t\tELSE NULL\n                       END\n\t\t\t,[Oferta]\t\t\t\t\t\t\n\t\t\t,[Resposta]\t\t\t\t\t\t\n\t\t\t,[% de resposta]\t\t\t\t\n\t\t\t,[Abandono]\t\t\t\t\t\t\n\t\t\t,[% de abandono]\t\t\t\t\n\t\t\t,[VMA]\t\t\t\t\t\t\t\n\t\t\t,[% de n\u00ed\u00advel de servi\u00e7o]\t\t\n\t\t\t,[% de alvos do n\u00edvel de servi\u00e7o]\n\t\t\t,[Tempo m\u00e9dio de espera]\t\n\t\t\t,[Tratamento m\u00e9dio]\t\t\n\t\t\t,[Conversa\u00e7\u00e3o m\u00e9dia]\t\n\t\t\t,[Espera m\u00e9dia]\t\t\t\n\t\t\t,[TPC m\u00e9dio]\t\t\t\n\t\t\t,[Em espera]\t\t\t\n\t\t\t,[Transferir]\t\t\t\n\t\t\t,[CONVERSA\u00c7\u00c3O TRATADO]\t\n\t\t\t,[Espera m\u00e9dia_tratado]\n\t\t\t,[Pondera\u00e7\u00e3o TMA]\n\t\t\t,[NS Ajustado]\n\tFROM [dim_chamadas_genesys_manual]\n)\nSELECT * FROM inicio\n\nGO\n",
        "build_order": 183,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys_manual]": [
                "UNKNOWN",
                "[dim_chamadas_genesys_manual]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_chamadas_genesys_manual]": [
                "CREATE",
                "CREATE        VIEW [dbo].[vw_chamadas_genesys_manual]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_chamadas_genesys_manual]": [
                "CREATE",
                "CREATE        VIEW [dbo].[vw_chamadas_genesys_manual]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_colaboradorescadastrados]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_colaboradorescadastrados]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mkt_mendi_colaboradorescadastrados",
        "type": "View",
        "start": 105491,
        "end": 105958,
        "code": "/****** Object:  View [dbo].[vw_mkt_mendi_colaboradorescadastrados]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE       VIEW [dbo].[vw_mkt_mendi_colaboradorescadastrados] AS\n\tSELECT [Vidas Atendidas]\t= (SELECT COUNT(DISTINCT [pess_id]) FROM dim_mendi_saudevianet_cod7 WHERE [agen_inicio_atendimento] <= GETDATE())\n\t\t\t\t\t\t\t\t+ (SELECT COUNT(DISTINCT [id_paciente]) FROM dim_you_gendo WHERE [Data] <= GETDATE())\n\nGO\n",
        "build_order": 184,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "SELECT",
                "SELECT COUNT(DISTINCT [id_paciente]) FROM dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]": [
                "SELECT",
                "SELECT [Vidas Atendidas]\t= (SELECT COUNT(DISTINCT [pess_id]) FROM dim_mendi_saudevianet_cod7"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_colaboradorescadastrados]": [
                "CREATE",
                "CREATE       VIEW [dbo].[vw_mkt_mendi_colaboradorescadastrados]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mkt_mendi_colaboradorescadastrados]": [
                "CREATE",
                "CREATE       VIEW [dbo].[vw_mkt_mendi_colaboradorescadastrados]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_log_secullum_horarios",
        "type": "Table",
        "start": 105958,
        "end": 106387,
        "code": "/****** Object:  Table [dbo].[dim_log_secullum_horarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_log_secullum_horarios](\n\t[Id] [int] NOT NULL,\n\t[HorarioId] [bigint] NOT NULL,\n\t[DiaSemana] [int] NULL,\n\t[Entrada1] [time](0) NULL,\n\t[Saida1] [time](0) NULL,\n\t[Entrada2] [time](0) NULL,\n\t[Saida2] [time](0) NULL,\n\t[intervalo_S] [int] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 185,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_secullum_horarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horarios]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_secullum_horarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "UNKNOWN",
                "dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horarios]": [
                "INSERT",
                "INSERT INTO dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "dim_log_secullum_horarios"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horaextra]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horaextra]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_log_secullum_horaextra",
        "type": "Table",
        "start": 106387,
        "end": 107209,
        "code": "/****** Object:  Table [dbo].[dim_log_secullum_horaextra]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_log_secullum_horaextra](\n\t[id] [int] NOT NULL,\n\t[numero_pis] [bigint] NOT NULL,\n\t[demissao] [datetime] NULL,\n\t[data] [date] NOT NULL,\n\t[entrada_1] [time](0) NULL,\n\t[saida_1] [time](0) NULL,\n\t[entrada_2] [time](0) NULL,\n\t[saida_2] [time](0) NULL,\n\t[entrada_3] [time](0) NULL,\n\t[saida_3] [time](0) NULL,\n\t[entrada_4] [time](0) NULL,\n\t[saida_4] [time](0) NULL,\n\t[entrada_5] [time](0) NULL,\n\t[saida_5] [time](0) NULL,\n\t[normais] [time](0) NULL,\n\t[faltas] [time](0) NULL,\n\t[ex] [time](0) NULL,\n\t[ex_50%] [time](0) NULL,\n\t[ex_60%] [time](0) NULL,\n\t[ex_100%] [time](0) NULL,\n\t[ex_120%] [time](0) NULL,\n\t[observacoes] [varchar](50) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 186,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horaextra]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_secullum_horaextra]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_secullum_horaextra]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_secullum_horaextra"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horaextra]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_secullum_horaextra]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "UNKNOWN",
                "dim_log_secullum_horaextra"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horaextra]": [
                "SELECT",
                "SELECT * FROM [dim_log_secullum_horaextra]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horarios]": [
                "DROP",
                "DROP TABLE IF EXISTS dim_log_secullum_horaextra"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_secullum_funcionarios",
        "type": "Table",
        "start": 107209,
        "end": 107979,
        "code": "/****** Object:  Table [dbo].[dim_secullum_funcionarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_secullum_funcionarios](\n\t[ID_funcionario] [int] NOT NULL,\n\t[numero_folha] [varchar](50) NOT NULL,\n\t[nome] [varchar](150) NOT NULL,\n\t[cpf] [varchar](14) NULL,\n\t[nascimento] [date] NULL,\n\t[telefone] [varchar](50) NULL,\n\t[celular] [varchar](50) NULL,\n\t[email] [varchar](150) NULL,\n\t[admissao] [date] NOT NULL,\n\t[demissao] [date] NULL,\n\t[empresa_nome] [varchar](150) NULL,\n\t[empresa_cnpj] [varchar](18) NOT NULL,\n\t[departamento] [varchar](150) NOT NULL,\n\t[funcao] [varchar](150) NOT NULL,\n\t[estrutura] [varchar](150) NULL,\n\t[escala] [varchar](50) NOT NULL,\n\t[ID_Horario] [int] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 187,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_secullum_funcionarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_funcionarios]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_secullum_funcionarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_funcionarios]": [
                "INSERT",
                "INSERT INTO dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_unico_funcionarios]": [
                "SELECT",
                "SELECT * FROM dim_secullum_funcionarios"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_na_secullum_he",
        "type": "View",
        "start": 107979,
        "end": 111212,
        "code": "/****** Object:  View [dbo].[vw_na_secullum_he]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n--select * from vw_na_secullum_he\n\nCREATE   VIEW [dbo].[vw_na_secullum_he] AS\n\n\tSELECT \n\t t0.[id]\n\t,t1.[ID Selecionar]\n\t,t1.[Nome]\n\t,t1.[Tribo]\n\t,t1.[Supervis\u00e3o]\n\t,t1.[Projeto]\n\t,t1.[Cliente]\n\t,t1.[Status]\n\t,t1.[Cargo]\n\t,[Jornada]= CAST(t1.[Jornada] as time(0))\n\t,[Log] = t2.[Dura\u00e7\u00e3o]\n\t,t0.[data]\n\t,t0.[entrada_1]\n\t,t0.[saida_1]\n\t,t0.[entrada_2]\n\t,t0.[saida_2]\n\t,t0.[entrada_3]\n\t,t0.[saida_3]\n\t,t0.[entrada_4]\n\t,t0.[saida_4]\n\t,t0.[entrada_5]\n\t,t0.[saida_5]\n\t,t0.[normais]\n\t,t0.[faltas]\n\t,t0.[ex_50%]\n\t,t0.[ex_60%]\n\t,[ex50%_s] = DATEDIFF(s, 0, t0.[ex_50%])\n\t,[ex60%_s] = DATEDIFF(s, 0, t0.[ex_60%])\n\t,t0.[ex_100%]\n\t,t0.[ex_120%]\n\t,[ex100%_s] = DATEDIFF(s, 0, t0.[ex_100%])\n\t,[ex120%_s] = DATEDIFF(s, 0, t0.[ex_120%])\n\t,[normais_s] = DATEDIFF(s, 0, t0.[normais])\n\t,[Jornada_s] = CASE\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 36000 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S]--10:00\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 35280 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --09:48\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 32400 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --09:00\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 31600 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --08:48\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 30000 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --08:20\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 29520 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --08:12\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 28800 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --08:00\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 27600 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --07:30\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 22800 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --06:20\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 21600 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --06:00\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t1.[Jornada]) = 14400 THEN DATEDIFF(s, 0, t1.[Jornada])-t4.[intervalo_S] --04:00\n\t\t\t\t\tELSE 0\n\t\t\t\t   END\t\n\t,t0.[observacoes]\n\t,[HE_totais] = CASE \n\t\t\t\t\tWHEN DATEDIFF(s, 0, t0.[ex_50%]) > 0 THEN DATEDIFF(s, 0, t0.[ex_50%]) \n\t\t\t\t\tWHEN DATEDIFF(s, 0, t0.[ex_100%]) > 0 THEN DATEDIFF(s, 0, t0.[ex_100%])\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t0.[ex_60%]) > 0 THEN DATEDIFF(s, 0, t0.[ex_60%])\n\t\t\t\t\tWHEN DATEDIFF(s, 0, t0.[ex_120%]) > 0 THEN DATEDIFF(s, 0, t0.[ex_120%])\n\t\t\t\t\tELSE 0\n\t\t\t\t   END\n\t,t3.[ID_horario]\n\t,t4.[intervalo_S]\n\t,col1= DATEPART(dw,t0.data)\n\t,col11= DATEPART(dw,t0.data)-2\n\t,col2 = DATEname(dw,t0.data)\n\n\tFROM dim_log_secullum_horaextra as t0\n\tLEFT JOIN dim_secullum_funcionarios t3\n\tON t3.ID_funcionario = t0.id\n\n\tLEFT JOIN dim_log_secullum_horarios AS t4\n\tON t4.[HorarioId] = t3.[ID_horario]\n\tand\n\tt4.[DiaSemana] = DATEPART(dw,t0.data)-2\n\t\n\tLEFT JOIN f_mop_historico as t1\n\tON t0.data = t1.[Data da Atualiza\u00e7\u00e3o] \n\tAND t0.ID  = t1.[ID Secullum]\n\n\tLEFT JOIN (\n\t\tSELECT \n\t\t\t[ID Selecionar]\n\t\t\t,Data = CAST(In\u00edcio AS DATE)\n\t\t\t,Dura\u00e7\u00e3o = SUM([Dura\u00e7\u00e3o])\n\t\tFROM f_log\n\t\tWHERE fonte <> 'SECULLUM'\n\t\tGROUP BY [ID Selecionar], CAST(In\u00edcio AS DATE)\n\t)  as t2\n\tON t0.data = t2.Data\n\tAND t1.[ID Selecionar] = t2.[ID Selecionar]\n\nGO\n",
        "build_order": 188,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]": [
                "UNKNOWN",
                "dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horaextra]": [
                "UNKNOWN",
                "dim_log_secullum_horaextra"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_na_secullum_he]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_na_secullum_he]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_na_secullum_he]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mop_eventos_DMA",
        "type": "View",
        "start": 111212,
        "end": 113578,
        "code": "/****** Object:  View [dbo].[vw_mop_eventos_DMA]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n--SELECT * FROM vw_mop_eventos_DMA\n\nCREATE VIEW [dbo].[vw_mop_eventos_DMA] AS\nWITH\ninicio AS (\n\tSELECT \n\t [Data da Atualiza\u00e7\u00e3o]\n\t,[ID Selecionar]\n\t,[ID Serasa]\n\t,[Nome]\n\t,[tribo]\n\t,[dma]\n\t,[instrutor]\t\n\tFROM f_mop_eventos\n),\ngrude AS (\n \tSELECT \n\t t0.[Data da Atualiza\u00e7\u00e3o]\n\t,t1.[data_inicio]\n\t,t1.[data_fim]\n\t,t2.[inicio_treinamento_real]\n\t,t2.[fim_treinamento_real]\n\t,t2.[data_pa_real]\n\t,t0.[ID Selecionar]\n\t,t1.[id_avaliado]\n\t,t0.[Nome]\n\t,t0.[tribo]\n\t,t1.[titulo]\n\t,[movintacao] = CONCAT(t2.[operacao_origem], ' - ',t2.[operacao_destino])\n\t,t2.[id_movimento]\n\t,t0.[dma]\n\t,[DMA_qld] = t1.[DMA]\n\t,t0.[instrutor]\n\t,[instrutor_qld] = t1.[responsavel]\n\t,t2.tipo_pedido\n\t\n\tFROM vw_2clix_treinamentos AS t1\n\tLEFT JOIN dim_prognostico AS t2 ON t2.id_movimento = TRY_CAST(RIGHT(t1.dma,3) AS INT) \n\t\t\t\t\t\t\t\t\tOR t2.id_movimento = TRY_CAST(LEFT(t1.dma,3) AS INT)\n\tLEFT JOIN inicio AS t0 ON t0.[ID Selecionar] = t1.[id_avaliado] AND\n\t\t\t\t\t\t\t\t\t\t\t t0.[Data da Atualiza\u00e7\u00e3o]>=t1.[data_inicio] AND\n\t\t\t\t\t\t\t\t\t\t\t t0.[Data da Atualiza\u00e7\u00e3o]<=t2.[data_pa_real]\n\tWHERE COALESCE(T1.DMA, '-') <> 'Sem DMA'\n),\ngrude_2 AS(\n\tSELECT\n\t [PROGNOSTICO_ID_MOVIMENTO] = [id_movimento]\n \t,[MOP_DMA]                  = [dma]\n\t,[TREINAMENTO_DMA]          = [DMA_qld]\n\t,[PROGNOSTICO_INICIO_TRN]   = [inicio_treinamento_real]\n\t,[PROGNOSTICO_FIM_TRN]      = [fim_treinamento_real]\n\t,[PROGNOSTICO_DATA_PA_REAL] = [data_pa_real]\n\t,[MOP_DATA_ATUALIZACAO]     = [Data da Atualiza\u00e7\u00e3o]\n\t,[TREINAMENTO_DATA_INICIO]  = [data_inicio]\n\t,[TREINAMENTO_DATA_FIM]     = [data_fim]\n\t,[MOP_ID_SELECIONAR]        = [ID selecionar]\n\t,[TREINAMENTO_ID_AVALIADO]  = [id_avaliado]\n\t,[MOP_NOME]                 = [Nome]\n\t,[MOP_TRIBO]                = [tribo]\n\t,[TREINAMENTO_TITULO]       = [titulo]\n\t,[PROGNOSTICO_MOVINENTACAO] = [movintacao]\n\t,[MOP_INSTRUTOR]            = [instrutor]\n\t,[TREINAMENTO]              = [instrutor_qld]\n\t,[PROGNOSTICO_DMA_PEDIDO]   = [tipo_pedido]\n\t--,[dma_preenchido] = MAX(DMA_qld) OVER (PARTITION BY [ID SELECIONAR] ORDER BY [Data da Atualiza\u00e7\u00e3o] ROWS UNBOUNDED PRECEDING)\n\t--,[trinador_preenchido] = MAX([instrutor_qld]) OVER (PARTITION BY [ID SELECIONAR] ORDER BY [Data da Atualiza\u00e7\u00e3o] ROWS UNBOUNDED PRECEDING)\n\tFROM grude\n)\nSELECT * FROM grude_2\n\nGO\n",
        "build_order": 189,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_treinamentos]": [
                "UNKNOWN",
                "vw_2clix_treinamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]": [
                "UNKNOWN",
                "dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_mop_eventos_DMA]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_mop_eventos_DMA]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_forecast_30min",
        "type": "Table",
        "start": 113578,
        "end": 114232,
        "code": "/****** Object:  Table [dbo].[dim_forecast_30min]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_forecast_30min](\n\t[tribo] [varchar](50) NOT NULL,\n\t[datahora] [datetime] NOT NULL,\n\t[volume] [float] NOT NULL,\n\t[tmt] [float] NOT NULL,\n\t[tma] [float] NOT NULL,\n\t[ns] [float] NULL,\n\t[sla] [float] NULL,\n\t[hc_tx1] [int] NOT NULL,\n\t[hc_tx2] [int] NOT NULL,\n\t[pausas_tx1] [float] NOT NULL,\n\t[pausas_tx2] [float] NOT NULL,\n\t[Agentes em Pausa (VOZ)] [float] NULL,\n\t[PA Liquida (VOZ)] [float] NULL,\n\t[Pausa Almo\u00e7o (VOZ)] [time](7) NULL,\n\t[Pausa Almo\u00e7o (%) (VOZ)] [float] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 190,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_forecast_30min]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_30min]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_forecast_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_forecast_30min]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_mensal]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_diario]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_forecast_30min]": [
                "INSERT",
                "INSERT INTO dim_forecast_30min"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_mensal]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_mensal]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_forecast_mensal",
        "type": "View",
        "start": 114232,
        "end": 115880,
        "code": "/****** Object:  View [dbo].[dim_forecast_mensal]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[dim_forecast_mensal] AS\nSELECT \n\t [tribo_serasa]\t\t\t=\t[tribo]\n\t,[tribo_zendesk]\t\t=\t[tribo]\n\t,[tribo_selecionar]\t\t=\t[tribo]\n\t,[data]\t\t\t\t\t=\tDATEFROMPARTS(DATEPART(YEAR, datahora), DATEPART(MONTH, datahora), DATEPART(DAY, datahora))\n\t,[volume_projetado]\t\t=\tSUM(ISNULL([volume],0))\n\t,[tmt_segundos]\t\t\t=\tISNULL(SUM(NULLIF([tmt],0)*NULLIF([volume],0))/SUM([volume]),0)\n\t,[tmt_minutos]\t\t\t=\tCAST(DATEADD(s, ISNULL(SUM(NULLIF([tmt],0)*NULLIF([volume],0))/SUM([volume]),0), 0) as time(7))\n\t,[tma_segundos]\t\t\t=\tISNULL(SUM(NULLIF([tma],0)*NULLIF([volume],0))/SUM([volume]),0)\n\t,[tma_minutos]\t\t\t=\tCAST(DATEADD(s, ISNULL(SUM(NULLIF([tma],0)*NULLIF([volume],0))/SUM([volume]),0), 0) as time(7))\n\t,[hc_geral]\t\t\t\t=\tISNULL(MAX(MAX([hc_tx1])) OVER (PARTITION BY [tribo], DATEFROMPARTS(DATEPART(YEAR, datahora), DATEPART(MONTH, datahora), DATEPART(DAY, datahora))),0) + ISNULL(MAX(MAX([hc_tx2])) OVER (PARTITION BY [tribo], DATEFROMPARTS(DATEPART(YEAR, datahora), DATEPART(MONTH, datahora), DATEPART(DAY, datahora))),0)\n\t,[hc_tx1]\t\t\t\t=\tISNULL(MAX(MAX([hc_tx1])) OVER (PARTITION BY [tribo], DATEFROMPARTS(DATEPART(YEAR, datahora), DATEPART(MONTH, datahora), DATEPART(DAY, datahora))),0)\n\t,[hc_tx2]\t\t\t\t=\tISNULL(MAX(MAX([hc_tx2])) OVER (PARTITION BY [tribo], DATEFROMPARTS(DATEPART(YEAR, datahora), DATEPART(MONTH, datahora), DATEPART(DAY, datahora))),0)\n\t,[hc_tx3]\t\t\t\t=\t0\nFROM dim_forecast_30min\nGROUP BY tribo, DATEFROMPARTS(DATEPART(YEAR, datahora), DATEPART(MONTH, datahora), DATEPART(DAY, datahora))\n\nGO\n",
        "build_order": 191,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_mensal]": [
                "CREATE",
                "CREATE VIEW [dbo].[dim_forecast_mensal]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_mensal]": [
                "CREATE",
                "CREATE VIEW [dbo].[dim_forecast_mensal]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_prognostico",
        "type": "View",
        "start": 115880,
        "end": 119959,
        "code": "/****** Object:  View [dbo].[vw_prognostico]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE           VIEW [dbo].[vw_prognostico] AS\n\nWITH base AS\n(\t\n\tSELECT *,\n\t\tmesma_tribo =\tCASE\n\t\t\t\t\t\t\tWHEN operacao_origem = operacao_destino THEN 1\n\t\t\t\t\t\t\tELSE 0\n\t\t\t\t\t\tEND\n\n\tFROM dim_prognostico\n),\ntext_edit AS\n(\n\tSELECT *,\n\t\t[operacao_origem_rev] =\t\tCASE\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-C.A.'                     THEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-SCORE'                    THEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-D\u00cdVIDAS'                  THEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-CREDITO'                  THEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-LOJAS'                    THEN 'Facebook e Lojas'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-OCR'                      THEN 'OCR'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-FACEBOOK'                 THEN 'Facebook e Lojas'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-RA'                       THEN 'Reclame Aqui'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'MERCADO'                         THEN 'Mercado'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-GOV'                      THEN 'GOV'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-SAC'                      THEN 'SAC'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-CADASTRO_POSITIVO'        THEN 'Cadastro Positivo'   \n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'VIACREDI-PROGRID'                THEN 'Progrid'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-WHATSAPP'                 THEN 'WhatsApp'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-QUALIDADE'                THEN 'Qualidade'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-SELF_SETUP'               THEN 'Self Setup'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-PREMIUM'                  THEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA_BKO_SAC'                  THEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'SERASA-FACEBOOK E LOJAS'         THEN 'Facebook e Lojas'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_origem] = 'VIACREDI-AGC'                    THEN 'Assembl\u00e9ia'\n\t\t\t\t\t\t\t\t\tEND,\n\n\t\t[operacao_destino_rev] =\tCASE\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-C.A.'                     THEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-SCORE'                    THEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-D\u00cdVIDAS'                  THEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-CREDITO'                  THEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-LOJAS'                    THEN 'Facebook e Lojas'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-OCR'                      THEN 'OCR'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-FACEBOOK'                 THEN 'Facebook e Lojas'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-RA'                       THEN 'Reclame Aqui'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'MERCADO'                         THEN 'Mercado'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-GOV'                      THEN 'GOV'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-SAC'                      THEN 'SAC'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-CADASTRO_POSITIVO'        THEN 'Cadastro Positivo'   \n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'VIACREDI-PROGRID'                THEN 'Progrid'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-WHATSAPP'                 THEN 'WhatsApp'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-QUALIDADE'                THEN 'Qualidade'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-SELF_SETUP'               THEN 'Self Setup'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-PREMIUM'                  THEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA_BKO_SAC'                  THEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'SERASA-FACEBOOK E LOJAS'         THEN 'Facebook e Lojas'\n\t\t\t\t\t\t\t\t\t\tWHEN [operacao_destino] = 'VIACREDI-AGC'                    THEN 'Assembl\u00e9ia'\n\t\t\t\t\t\t\t\t\tEND\n\n\tFROM base\n)\n\t\t\nSELECT * FROM text_edit \nWHERE mesma_tribo = 0\n\nGO\n",
        "build_order": 192,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]": [
                "UNKNOWN",
                "dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico]": [
                "CREATE",
                "CREATE           VIEW [dbo].[vw_prognostico]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico]": [
                "CREATE",
                "CREATE           VIEW [dbo].[vw_prognostico]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "SELECT",
                "SELECT * FROM vw_prognostico"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_ferias]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_ferias]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_prognostico_ferias",
        "type": "Table",
        "start": 119959,
        "end": 120352,
        "code": "/****** Object:  Table [dbo].[dim_prognostico_ferias]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_prognostico_ferias](\n\t[id_selecionar_saida] [varchar](max) NOT NULL,\n\t[tribo] [varchar](max) NOT NULL,\n\t[data_saida] [date] NULL,\n\t[data_retorno] [date] NULL,\n\t[hcs] [int] NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 193,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_ferias]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_prognostico_ferias]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_ferias]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_prognostico_ferias]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_ferias]": [
                "UNKNOWN",
                "dim_prognostico_ferias"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_ferias]": [
                "INSERT",
                "INSERT INTO dim_prognostico_ferias"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_to]": [
                "INSERT",
                "INSERT INTO dim_prognostico_ferias"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_ferias]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_ferias]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_prognostico_ferias",
        "type": "View",
        "start": 120352,
        "end": 122252,
        "code": "/****** Object:  View [dbo].[vw_prognostico_ferias]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE           VIEW [dbo].[vw_prognostico_ferias]\nAS\n\nWITH text_edit ([id_selecionar_saida], [tribo], [data_saida], [data_retorno], [hcs])\nAS\n(\n\tSELECT [id_selecionar_saida],\n\t\tCASE\n\t\t\tWHEN [tribo] = 'SERASA-C.A.'                     THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'SERASA-SCORE'                    THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'SERASA-D\u00cdVIDAS'                  THEN 'Central de Ajuda'\n\t        WHEN [tribo] = 'SERASA-CREDITO'                  THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'SERASA-LOJAS'                    THEN 'Facebook e Lojas'\n\t\t\tWHEN [tribo] = 'SERASA-OCR'                      THEN 'OCR'\n\t\t\tWHEN [tribo] = 'SERASA-FACEBOOK'                 THEN 'Facebook e Lojas'\n\t\t\tWHEN [tribo] = 'SERASA-RA'                       THEN 'Reclame Aqui'\n\t\t\tWHEN [tribo] = 'MERCADO'                         THEN 'Mercado'\n\t\t\tWHEN [tribo] = 'SERASA-GOV'                      THEN 'GOV'\n\t\t\tWHEN [tribo] = 'SERASA-SAC'                      THEN 'SAC'\n\t\t\tWHEN [tribo] = 'SERASA-CADASTRO_POSITIVO'        THEN 'Cadastro Positivo'   \n\t\t\tWHEN [tribo] = 'VIACREDI-PROGRID'                THEN 'Progrid'\n\t\t\tWHEN [tribo] = 'SERASA-WHATSAPP'                 THEN 'WhatsApp'\n\t\t\tWHEN [tribo] = 'SERASA-QUALIDADE'                THEN 'Qualidade'\n\t\t\tWHEN [tribo] = 'SERASA-SELF_SETUP'               THEN 'Self Setup'\n\t\t\tWHEN [tribo] = 'SERASA-PREMIUM'                  THEN '0800 Premium'\n\t\t\tWHEN [tribo] = 'SERASA_BKO_SAC'                  THEN 'BackOffice'\n\t\t\tWHEN [tribo] = 'SERASA-FACEBOOK E LOJAS'         THEN 'Facebook e Lojas'\n\t\t\tWHEN [tribo] = 'VIACREDI-AGC'                    THEN 'Assembl\u00e9ia'\n        END\n\t\t, [data_saida], [data_retorno], [hcs]\n\nFROM dim_prognostico_ferias\n)\n\t\t\nSELECT * FROM text_edit \n--WHERE mesma_tribo = 0\n\nGO\n",
        "build_order": 194,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_ferias]": [
                "UNKNOWN",
                "dim_prognostico_ferias"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_ferias]": [
                "CREATE",
                "CREATE           VIEW [dbo].[vw_prognostico_ferias]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_ferias]": [
                "CREATE",
                "CREATE           VIEW [dbo].[vw_prognostico_ferias]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "SELECT",
                "SELECT * FROM [vw_prognostico_ferias]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_excecoes]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_excecoes]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_prognostico_excecoes",
        "type": "Table",
        "start": 122252,
        "end": 122675,
        "code": "/****** Object:  Table [dbo].[dim_prognostico_excecoes]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_prognostico_excecoes](\n\t[id_selecionar] [varchar](max) NOT NULL,\n\t[data_inicio] [date] NULL,\n\t[data_fim] [date] NULL,\n\t[tribo] [varchar](max) NOT NULL,\n\t[hcs] [int] NOT NULL,\n\t[observacao] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 195,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_excecoes]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_prognostico_excecoes]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_excecoes]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_prognostico_excecoes]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_excecoes]": [
                "UNKNOWN",
                "dim_prognostico_excecoes"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_excecoes]": [
                "INSERT",
                "INSERT INTO dim_prognostico_excecoes"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_excecoes]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_excecoes]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_prognostico_excecoes",
        "type": "View",
        "start": 122675,
        "end": 126059,
        "code": "/****** Object:  View [dbo].[vw_prognostico_excecoes]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE      VIEW [dbo].[vw_prognostico_excecoes]\nAS\n\nWITH text_edit ([id_selecionar], [data_inicio], [data_fim], [tribo], [hcs], [observacao], [tipo])\nAS\n(\n\tSELECT [id_selecionar], [data_inicio], [data_fim],\n\t\tCASE\n\t\t\tWHEN [tribo] = 'SERASA-C.A.'                     THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'CA'                              THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'SERASA-SCORE'                    THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'SCORE'                           THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'SERASA-D\u00cdVIDAS'                  THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'D\u00cdVIDAS'                         THEN 'Central de Ajuda'\n\t        WHEN [tribo] = 'SERASA-CREDITO'                  THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'CREDITO'                         THEN 'Central de Ajuda'\n\t\t\tWHEN [tribo] = 'SERASA-LOJAS'                    THEN 'Facebook e Lojas'\n\t\t\tWHEN [tribo] = 'LOJAS'                           THEN 'Facebook e Lojas'\n\t\t\tWHEN [tribo] = 'SERASA-OCR'                      THEN 'OCR'\n\t\t\tWHEN [tribo] = 'OCR'                             THEN 'OCR'\n\t\t\tWHEN [tribo] = 'SERASA-FACEBOOK'                 THEN 'Facebook e Lojas'\n\t\t\tWHEN [tribo] = 'FACEBOOK E LOJAS'                THEN 'Facebook e Lojas'\n\t\t\tWHEN [tribo] = 'FACEBOOK'                        THEN 'Facebook e Lojas'\n\t\t\tWHEN [tribo] = 'SERASA-FACEBOOK E LOJAS'         THEN 'Facebook e Lojas'\n\t\t\tWHEN [tribo] = 'SERASA-RA'                       THEN 'Reclame Aqui'\n\t\t\tWHEN [tribo] = 'RECLAME AQUI'                    THEN 'Reclame Aqui'\n\t\t\tWHEN [tribo] = 'MERCADO'                         THEN 'Mercado'\n\t\t\tWHEN [tribo] = 'SERASA-GOV'                      THEN 'GOV'\n\t\t\tWHEN [tribo] = 'GOV'                             THEN 'GOV'\n\t\t\tWHEN [tribo] = 'SERASA-SAC'                      THEN 'SAC'\n\t\t\tWHEN [tribo] = 'SAC'                             THEN 'SAC'\n\t\t\tWHEN [tribo] = 'SERASA-CADASTRO_POSITIVO'        THEN 'Cadastro Positivo'  \n\t\t\tWHEN [tribo] = 'CADASTRO POSITIVO'               THEN 'Cadastro Positivo'\n\t\t\tWHEN [tribo] = 'VIACREDI-PROGRID'                THEN 'Progrid'\n\t\t\tWHEN [tribo] = 'PROGRID'                         THEN 'Progrid'\n\t\t\tWHEN [tribo] = 'SERASA-WHATSAPP'                 THEN 'WhatsApp'\n\t\t\tWHEN [tribo] = 'SERASA-QUALIDADE'                THEN 'Qualidade'\n\t\t\tWHEN [tribo] = 'SERASA-SELF_SETUP'               THEN 'Self Setup'\n\t\t\tWHEN [tribo] = 'SELF SETUP'                      THEN 'Self Setup'\n\t\t\tWHEN [tribo] = 'SERASA-PREMIUM'                  THEN '0800 Premium'\n\t\t\tWHEN [tribo] = 'PREMIUM'                         THEN '0800 Premium'\n\t\t\tWHEN [tribo] = 'SERASA_BKO_SAC'                  THEN 'BackOffice'\n\t\t\tWHEN [tribo] = 'BKO_SAC'                         THEN 'BackOffice'\n\t\t\tWHEN [tribo] = 'VIACREDI-AGC'                    THEN 'Assembl\u00e9ia'\n\t\t\tWHEN [tribo] = 'AGC'                             THEN 'Assembl\u00e9ia'\n        END\n\t\t , [hcs], [observacao], \n\t\t \n\t\t \n\t\tCASE \n\t\t\tWHEN LEFT([observacao],10) = '[TURNOVER]' THEN 'Turnover'\n\t\t\tWHEN LEFT([observacao],19) = '[AFASTAMENTO SA\u00cdDA]' THEN 'Afastado'\n\t\t\t--WHEN LEFT([observacao],21) = '[AFASTAMENTO RETORNO]' THEN 'Afastado'\n\t\t\tELSE NULL\n\t\tEND\n\t\t\t\n\n\nFROM dim_prognostico_excecoes\n)\nSELECT * FROM text_edit \nWHERE tribo IS NOT NULL\n\n\nGO\n",
        "build_order": 196,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_excecoes]": [
                "UNKNOWN",
                "dim_prognostico_excecoes"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_excecoes]": [
                "CREATE",
                "CREATE      VIEW [dbo].[vw_prognostico_excecoes]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_excecoes]": [
                "CREATE",
                "CREATE      VIEW [dbo].[vw_prognostico_excecoes]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "UNKNOWN",
                "vw_prognostico_excecoes"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_diario]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_diario]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_forecast_diario",
        "type": "View",
        "start": 126059,
        "end": 127598,
        "code": "/****** Object:  View [dbo].[dim_forecast_diario]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\t \nCREATE VIEW [dbo].[dim_forecast_diario] AS\nSELECT \n\t [tribo_serasa]\t\t\t=\t[tribo]\n\t,[tribo_zendesk]\t\t=\t[tribo]\n\t,[tribo_selecionar]\t\t=\t[tribo]\n\t,[data]\t\t\t\t\t=\tCAST([datahora] as date)\n\t,[criados]\t\t\t\t=\tSUM(ISNULL([volume],0))\n\t,[tmt_segundos]\t\t\t=\tISNULL(SUM(NULLIF([tmt],0)*NULLIF([volume],0))/SUM([volume]),0)\n\t,[tma_segundos]\t\t\t=\tISNULL(SUM(NULLIF([tma],0)*NULLIF([volume],0))/SUM([volume]),0)\n\t,[hc_geral]\t\t\t\t=\tISNULL(MAX(MAX([hc_tx1])) OVER (PARTITION BY [tribo], CAST([datahora] as date)),0) + ISNULL(MAX(MAX([hc_tx2])) OVER (PARTITION BY [tribo], CAST([datahora] as date)),0)\n\t,[hc_tx1]\t\t\t\t=\tISNULL(MAX(MAX([hc_tx1])) OVER (PARTITION BY [tribo], CAST([datahora] as date)),0)\n\t,[hc_tx2]\t\t\t\t=\tISNULL(MAX(MAX([hc_tx2])) OVER (PARTITION BY [tribo], CAST([datahora] as date)),0)\n\t,[pausa_programada_tx1]\t=\tISNULL(MAX(MAX(pausas_tx1)) OVER (PARTITION BY [tribo], CAST([datahora] as date)),0) -- Nathalia pediu pra agrupar usando o valor maximo do dia. Pouca paci\u00eancia pra discutir. --ISNULL(SUM(NULLIF([pausas_tx1],0)/NULLIF([hc_tx1],0))/SUM([hc_tx1]),0)\n\t,[pausa_programada_tx2]\t=\tISNULL(MAX(MAX(pausas_tx2)) OVER (PARTITION BY [tribo], CAST([datahora] as date)),0) -- Nathalia pediu pra agrupar usando o valor maximo do dia. Pouca paci\u00eancia pra discutir. --ISNULL(SUM(NULLIF([pausas_tx2],0)/NULLIF([hc_tx2],0))/SUM([hc_tx2]),0)\nFROM dim_forecast_30min\nGROUP BY tribo, CAST(datahora as date)\n\nGO\n",
        "build_order": 197,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_diario]": [
                "CREATE",
                "CREATE VIEW [dbo].[dim_forecast_diario]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_diario]": [
                "CREATE",
                "CREATE VIEW [dbo].[dim_forecast_diario]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "UNKNOWN",
                "dim_forecast_diario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "SELECT",
                "SELECT * FROM dim_forecast_diario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_forecast_diario"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_mop_quadrofuncionarios",
        "type": "View",
        "start": 127598,
        "end": 138068,
        "code": "/****** Object:  View [dbo].[f_mop_quadrofuncionarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\t\tCREATE VIEW [dbo].[f_mop_quadrofuncionarios] AS\n\t\t\t\tWITH\n\t\tpassado_atv_aft_fr_stf (data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT [Data da Atualiza\u00e7\u00e3o], Tribo, Status, COUNT(*)\n\t\t\tFROM f_mop_historico\n\t\t\tWHERE Situa\u00e7\u00e3o <> 'Em Treinamento'\n\t\t\tGROUP BY [Data da Atualiza\u00e7\u00e3o], Tribo, Status\n\n\t\t),\n\t\tpassado_to (data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT [\u00daltima Data Trabalhada (Turnover)], Tribo, 'Turnover', COUNT(*)\n\t\t\tFROM f_mop_vigente\n\t\t\tWHERE Status = 'Turnover'\n\t\t\tAND Situa\u00e7\u00e3o <> 'Em Treinamento'\n\t\t\tGROUP BY [\u00daltima Data Trabalhada (Turnover)], Tribo, Status\n\t\t),\n\t\tpassado_mercado_pos_neg ( Data, ID, tribo_pos, tribo_neg) AS\n\t\t(\n\t\t\tSELECT Data, [ID Selecionar], Tribo, [Tribo Anterior]\n\t\t\tFROM (\n\t\t\t\tSELECT Data, [ID Selecionar], Tribo, [Tribo Anterior], \n\t\t\t\t\tCASE \n\t\t\t\t\t\tWHEN LAG(CONCAT(Tribo, [Tribo Anterior])) OVER (PARTITION BY [ID Selecionar] ORDER BY Data ASC) IS NULL THEN 1\n\t\t\t\t\t\tWHEN LAG(CONCAT(Tribo, [Tribo Anterior])) OVER (PARTITION BY [ID Selecionar] ORDER BY Data ASC) <> CONCAT(Tribo, [Tribo Anterior]) THEN 1 \n\t\t\t\t\t\tELSE 0 \n\t\t\t\t\tEND AS mudou\n\t\t\t\tFROM (\n\t\t\t\t\tSELECT [Data da Atualiza\u00e7\u00e3o] as Data, [ID Selecionar], Tribo,\n\t\t\t\t\t\tLAG(Tribo) OVER (PARTITION BY [ID Selecionar] ORDER BY [Data da Atualiza\u00e7\u00e3o] ASC) AS [Tribo Anterior]\n\t\t\t\t\tFROM f_mop_eventos t0\n\t\t\t\t) as t0\n\t\t\t) as t1\n\t\t\tWHERE mudou = 1\n\t\t\tAND Tribo <> [Tribo Anterior]\n\t\t),\n\t\tcapacity (data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT [data], [tribo_selecionar], 'Capacity', hc_geral\n\t\t\tFROM dim_forecast_diario\n\t\n\t\t),\n\t\tfuturo_mig_pos (data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT [data_pa_real], operacao_destino_rev, 'Migra\u00e7\u00e3o (+)', sum(hcs_entregue_operacao)\n\t\t\tFROM vw_prognostico\n\t\t\tWHERE tipo_pedido = 'MIGRA\u00c7\u00c3O'\n\t\t\tAND operacao_origem_rev<>operacao_destino_rev\n\t\t\tGROUP BY [data_pa_real], operacao_destino_rev, tipo_pedido\n\t\t),\n\t\tfuturo_mig_neg (data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT [data_pa_real], operacao_origem_rev, 'Migra\u00e7\u00e3o (-)', sum(hcs_entregue_operacao)\n\t\t\tFROM vw_prognostico\n\t\t\tWHERE tipo_pedido = 'MIGRA\u00c7\u00c3O'\n\t\t\tAND operacao_origem_rev<>operacao_destino_rev\n\t\t\tGROUP BY [data_pa_real], operacao_origem_rev, tipo_pedido\n\t\t),\n\t\tfuturo_treinamento (data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT t0.Data, t0_tribos.tribo, 'Treinamento', t1.hcs_entregue_operacao\n\n\t\t\tFROM dim_calendario AS t0\n\n\t\t\tLEFT JOIN(\n\t\t\t\tSELECT DISTINCT operacao_destino_rev as tribo FROM vw_prognostico \n\t\t\t\tWHERE operacao_origem_rev = 'Mercado'\n\t\t\t)AS t0_tribos\n\t\t\tON 1=1\n\n\t\t\tLEFT JOIN(\n\t\t\t\tSELECT * FROM vw_prognostico\n\t\t\t\tWHERE operacao_origem_rev = 'Mercado'\n\t\t\t)AS t1\n\t\t\tON t0.Data >= t1.inicio_treinamento_real\n\t\t\tAND t0.Data < t1.data_pa_real\n\t\t\tAND t0_tribos.tribo = t1.operacao_destino_rev\n\n\t\t\tWHERE tribo IS NOT NULL\n\t\t),\n\t\tfuturo_ferias (data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT t0.Data,t1.tribo, 'F\u00e9rias', SUM(t1.hcs)\n\n\t\t\tFROM dim_calendario AS t0\n\t\t\tLEFT JOIN(\n\t\t\t\tSELECT * FROM [vw_prognostico_ferias]\n\t\t\t) AS t1\n\t\t\tON t0.Data >= t1.data_saida\n\t\t\tAND t0.Data < t1.data_retorno\n\t\t\tWHERE data_saida IS NOT NULL\n\t\t\tGROUP BY t0.Data, t1.tribo\n\t\t),\n\n\t\tfuturo_afast (data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT t0.Data,t1.tribo, 'Afastado', ABS(t1.hcs)\n\n\t\t\tFROM dim_calendario AS t0\n\t\t\tLEFT JOIN(\n\t\t\t\tSELECT * FROM vw_prognostico_excecoes\n\t\t\t\tWHERE tipo = 'Afastado'\n\t\t\t\tAND hcs <> 0\n\t\t\t\tAND hcs IS NOT NULL\n\t\t\t) AS t1\n\t\t\tON t0.Data >= t1.data_inicio\n\t\t\tAND t0.Data < ISNULL(t1.data_fim, (SELECT Data FROM (SELECT MAX(Data) as Data FROM dim_calendario) as subq))\n\t\t),\n\n\t\tfuturo_to (data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT data_inicio, tribo, tipo, SUM(ABS(hcs))\n\t\t\tFROM vw_prognostico_excecoes\n\t\t\tWHERE tipo = 'Turnover'\n\t\t\tAND hcs <> 0\n\t\t\tAND hcs IS NOT NULL\n\t\t\tGROUP BY data_inicio, tribo, tipo\n\t\t),\n\n\t\tjuncao_1 (fonte, data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT \n\t\t\t\t'Passado',\n\t\t\t\tdata, \n\t\t\t\ttribo, \n\t\t\t\ttipo, \n\t\t\t\tcont\n\t\t\tFROM passado_atv_aft_fr_stf -- Todo o resto\n\t\n\t\t\tUNION\n\t\t\tSELECT\n\t\t\t\t'Passado',\n\t\t\t\tdata,\n\t\t\t\ttribo_pos,\n\t\t\t\t'Entrada Mercado',\n\t\t\t\tCOUNT(1) \n\t\t\tFROM passado_mercado_pos_neg -- S\u00f3 entradas mercado\n\t\t\tWHERE tribo_neg IS NULL\n\t\t\tGROUP BY data, tribo_pos\n\t\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Passado',\n\t\t\t\tdata, \n\t\t\t\ttribo, \n\t\t\t\ttipo, \n\t\t\t\tcont \n\t\t\tFROM passado_to -- S\u00f3 TOs\n\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Passado',\n\t\t\t\tdata, \n\t\t\t\ttribo_pos, \n\t\t\t\t'Migra\u00e7\u00e3o (+)', \n\t\t\t\tCOUNT(1) \n\t\t\tFROM passado_mercado_pos_neg -- migra\u00e7\u00e3o (+)\n\t\t\tWHERE tribo_neg IS NOT NULL\n\t\t\tGROUP BY data, tribo_pos\n\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Passado',\n\t\t\t\tdata, \n\t\t\t\ttribo_neg, \n\t\t\t\t'Migra\u00e7\u00e3o (-)', \n\t\t\t\tCOUNT(1) \n\t\t\tFROM passado_mercado_pos_neg -- migra\u00e7\u00e3o (-)\n\t\t\tWHERE tribo_neg IS NOT NULL\n\t\t\tGROUP BY data, tribo_neg\n\n\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Capacity',\n\t\t\t\tdata, \n\t\t\t\ttribo, \n\t\t\t\ttipo, \n\t\t\t\tcont \n\t\t\tFROM capacity -- capacity\n\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Futuro',\n\t\t\t\tdata, \n\t\t\t\ttribo, \n\t\t\t\ttipo, \n\t\t\t\tcont \n\t\t\tFROM futuro_mig_pos -- prognostico +\n\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Futuro',\n\t\t\t\tdata, \n\t\t\t\ttribo, \n\t\t\t\ttipo, \n\t\t\t\tcont \n\t\t\tFROM futuro_mig_neg -- prognostico -\t\n\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Futuro',\n\t\t\t\tdata, \n\t\t\t\ttribo, \n\t\t\t\ttipo, \n\t\t\t\tcont \n\t\t\tFROM futuro_treinamento -- prognostico treinamento\n\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Futuro',\n\t\t\t\tdata, \n\t\t\t\ttribo, \n\t\t\t\ttipo, \n\t\t\t\tcont \n\t\t\tFROM futuro_ferias -- prognostico ferias\n\t\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Futuro',\n\t\t\t\tdata, \n\t\t\t\ttribo, \n\t\t\t\ttipo, \n\t\t\t\tcont \n\t\t\tFROM futuro_to -- prognostico turnovers\n\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Futuro',\n\t\t\t\tdata, \n\t\t\t\ttribo, \n\t\t\t\ttipo, \n\t\t\t\tcont \n\t\t\tFROM futuro_afast -- prognostico afastados\n\n\t\t\tUNION\n\t\t\tSELECT \n\t\t\t\t'Passado',\n\t\t\t\tt0.data,\n\t\t\t\tt0.tribo,\n\t\t\t\t'Gap/Sobra',\n\t\t\t\tt0.cont - t1.cont\n\t\t\tFROM passado_atv_aft_fr_stf AS t0\n\t\t\tleft join( \n\t\t\t\tSELECT * FROM capacity \n\t\t\t) AS t1\n\t\t\tON t0.[data] = t1.[data]\n\t\t\tAND t0.[tribo] = t1.[tribo] \n\t\t\tWHERE t0.tipo = 'Ativo'\n\t\t\n\t\t),\n\t\tfuturo_atv(fonte, data, tribo, tipo, cont) AS --, ativos, ferias, turnover, migr_pos, migr_neg, treinamento) AS\n\t\t(\n\n\t\t\tSELECT 'Futuro', base.data, base.tribo, 'Ativo', \n\n\t\t\t\tativos.cont\n\t\t\t\t- ISNULL(ferias.cont, 0)\n\t\t\t\t- SUM(ISNULL(turnover.cont, 0)) OVER(PARTITION BY base.tribo ORDER BY base.data ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\n\t\t\t\t- SUM(ISNULL(migr_neg.cont, 0)) OVER(PARTITION BY base.tribo ORDER BY base.data ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\n\t\t\t\t+ SUM(ISNULL(migr_pos.cont, 0)) OVER(PARTITION BY base.tribo ORDER BY base.data ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\n\t\t\t\t+ SUM(ISNULL(treinamento.cont, 0)) OVER(PARTITION BY base.tribo ORDER BY base.data ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\n\n\t\t\t\t--,ativos.cont,\n\t\t\t\t--ISNULL(ferias.cont, 0),\n\t\t\t\t--SUM(ISNULL(turnover.cont, 0)) OVER(PARTITION BY base.tribo ORDER BY base.data ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW),\n\t\t\t\t--SUM(ISNULL(migr_neg.cont, 0)) OVER(PARTITION BY base.tribo ORDER BY base.data ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW),\n\t\t\t\t--SUM(ISNULL(migr_pos.cont, 0)) OVER(PARTITION BY base.tribo ORDER BY base.data ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW),\n\t\t\t\t--SUM(ISNULL(treinamento.cont, 0)) OVER(PARTITION BY base.tribo ORDER BY base.data ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\n\n\n\t\t\tFROM\t  (\tSELECT data, tribo\t\t FROM juncao_1 WHERE data > CAST(GETDATE() AS DATE) GROUP BY data, tribo)\t\t\t\t\t\t\t\t\tas base\n\t\t\tLEFT JOIN (\tSELECT data, tribo, cont FROM juncao_1 WHERE data = CAST(GETDATE() AS DATE) AND fonte = 'Passado' AND tipo = 'Ativo')\t\t\t\tas ativos\t\tON base.tribo = ativos.tribo\n\t\t\tLEFT JOIN (\tSELECT data, tribo, cont FROM juncao_1 WHERE data > CAST(GETDATE() AS DATE) AND fonte = 'Futuro'  AND tipo = 'F\u00e9rias')\t\t\t\tas ferias\t\tON base.data = ferias.data\t\tAND base.tribo = ferias.tribo\n\t\t\tLEFT JOIN (\tSELECT data, tribo, cont FROM juncao_1 WHERE data > CAST(GETDATE() AS DATE) AND fonte = 'Futuro'  AND tipo = 'Turnover')\t\t\tas turnover\t\tON base.data = turnover.data\tAND base.tribo = turnover.tribo\n\t\t\tLEFT JOIN (\tSELECT data, tribo, cont FROM juncao_1 WHERE data > CAST(GETDATE() AS DATE) AND fonte = 'Futuro'  AND tipo = 'Migra\u00e7\u00e3o (-)')\t\tas migr_neg\t\tON base.data = migr_neg.data\tAND base.tribo = migr_neg.tribo\n\t\t\tLEFT JOIN (\tSELECT data, tribo, cont FROM juncao_1 WHERE data > CAST(GETDATE() AS DATE) AND fonte = 'Futuro'  AND tipo = 'Migra\u00e7\u00e3o (+)')\t\tas migr_pos\t\tON base.data = migr_pos.data\tAND base.tribo = migr_pos.tribo\n\t\t\tLEFT JOIN ( SELECT data, tribo, CASE\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN (cont IS NULL OR cont = 0)\n\t\t\t\t\t\t\t\t\t\t\t\tAND  LAG(cont) OVER(PARTITION BY tribo ORDER BY data ASC) IS NOT NULL\n\t\t\t\t\t\t\t\t\t\t\t\tTHEN LAG(ISNULL(cont, 0)) OVER(PARTITION BY tribo ORDER BY data ASC) \n\t\t\t\t\t\t\t\t\t\t\t\tELSE 0 \n\t\t\t\t\t\t\t\t\t\t\tEND as cont\n\t\t\t\t\t\t\t\t\t   FROM juncao_1 WHERE fonte = 'Futuro'  AND tipo = 'Treinamento')\t\t\t\t\tas treinamento\tON base.data = treinamento.data AND base.tribo = treinamento.tribo\n\t\n\n\t\t),\n\t\tjuncao_2 (fonte, data, tribo, tipo, cont) AS\n\t\t(\n\t\t\tSELECT * FROM juncao_1\n\t\t\tUNION ALL\n\t\t\tSELECT * FROM futuro_atv\n\t\t\tUNION ALL\n\t\t\tSELECT \n\t\t\t\t'Futuro',\n\t\t\t\tt0.data,\n\t\t\t\tt0.tribo,\n\t\t\t\t'Gap/Sobra',\n\t\t\t\tt0.cont - t1.cont\n\t\t\tFROM futuro_atv AS t0\n\t\t\tleft join( \n\t\t\t\tSELECT * FROM capacity \n\t\t\t) AS t1\n\t\t\tON t0.[data] = t1.[data]\n\t\t\tAND t0.[tribo] = t1.[tribo] \n\t\t),\n\t\tjuncao_3 (fonte, data, tribo, tipo, cont) AS\n\t\t(\t\n\t\t\tSELECT * FROM juncao_2\n\t\t\tUNION ALL\n\t\t\tSELECT t0.[fonte], t0.[data], t0.[tribo], [tipo] = '% Over', [cont] = CAST(SUM(IIF(t0.[tipo]='Gap/Sobra', t0.[cont], 0)) AS FLOAT)/CAST(NULLIF(SUM(IIF(t1.[tipo]='Capacity', t1.[cont], 0)),0) AS FLOAT) \n\t\t\tFROM (SELECT * FROM juncao_2 WHERE fonte <> 'Capacity') t0\n\t\t\tleft join(SELECT * FROM juncao_2 WHERE fonte = 'Capacity') AS t1\n\t\t\tON t0.[data] = t1.[data]\n\t\t\tAND t0.[tribo] = t1.[tribo] \n\t\t\tAND t0.[fonte] = 'Passado'\n\t\t\tGROUP BY t0.[fonte], t0.[data], t0.[tribo]\n\n\t\t),\n\t\tgrude (fonte, data, tribo, tipo, cont, ordem) AS\n\t\t(\n\t\t\tSELECT fonte, data, tribo, tipo, SUM(ISNULL(cont,0)),\n\t\t\t\tCASE tipo\n\t\t\t\t\tWHEN 'Capacity'          THEN 1\n\t\t\t\t\tWHEN 'Ativo'             THEN 2\n\t\t\t\t\tWHEN 'Gap/Sobra'         THEN 3\n\t\t\t\t\tWHEN '% Over'            THEN 4\n\t\t\t\t\tWHEN 'TurnOver'          THEN 5\n\t\t\t\t\tWHEN 'F\u00e9rias'            THEN 6\n\t\t\t\t\tWHEN 'Afastado'          THEN 7\n\t\t\t\t\tWHEN 'Treinamento'       THEN 8\n\t\t\t\t\tWHEN 'Entrada Mercado'   THEN 9\n\t\t\t\t\tWHEN 'Migra\u00e7\u00e3o (+)'      THEN 10\n\t\t\t\t\tWHEN 'Migra\u00e7\u00e3o (-)'      THEN 11\n\t\t\t\t\tWHEN 'Staff'             THEN 12\n\t\t\t\t\tELSE 999\n\t\t\t   END \n\t\t\tFROM juncao_3\n\t\t\tGROUP BY fonte, data, tribo, tipo\n\t\t)\n\t\tSELECT * FROM grude\n\nGO\n",
        "build_order": 198,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT Data FROM (SELECT MAX(Data) as Data FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico]": [
                "SELECT",
                "SELECT * FROM vw_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_ferias]": [
                "SELECT",
                "SELECT * FROM [vw_prognostico_ferias]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_excecoes]": [
                "UNKNOWN",
                "vw_prognostico_excecoes"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_diario]": [
                "UNKNOWN",
                "dim_forecast_diario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_mop_quadrofuncionarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_mop_quadrofuncionarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "f_mop_quadrofuncionarios"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_xl_qualidade_loteria_conexaodecontas",
        "type": "View",
        "start": 138068,
        "end": 139664,
        "code": "/****** Object:  View [dbo].[vw_xl_qualidade_loteria_conexaodecontas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\nCREATE     VIEW [dbo].[vw_xl_qualidade_loteria_conexaodecontas] AS\n\n\nWITH\nseed AS ( SELECT seed = 333 ),\nquery AS\n(\n\tSELECT\n\t\t --randid,\n\t\t [M\u00eas]\t\t\t\t\t\t=\tt.[M\u00eas]\n\t\t,[Ciclo]\t\t\t\t\t=\tt.[Ciclo]\n\t\t,[Tribo (ticket)]\t\t\t=\tt.[Tribo (ticket)]\n\t\t,[Tribo (mop)]\t\t\t\t=\tmh.[Tribo]\n\t\t,[ID Selecionar]\t\t\t=\tmh.[ID Selecionar]\n\t\t,[ID Serasa]\t\t\t\t=\tt.[ID Serasa]\n\t\t,[Status Atual]\t\t\t\t=\tmv.[Status]\n\t\t,[ID Ticket]\t\t\t\t=\tt.[ID Ticket]\n\t\t,[Data de Resolu\u00e7\u00e3o]\t\t=\tt.[Data de Resolu\u00e7\u00e3o]\n\t\t,[Motivos]\t\t\t\t\t=\tt.[Motivos]\n\tFROM (\n\t\tSELECT \n\t\t\t randid=ROW_NUMBER() OVER (PARTITION BY t.ID_serasa, c.Semana_Mes_For\u00e7ada_PrimeiroDia ORDER BY HASHBYTES('md5',cast(t.[ID_Ticket]+(SELECT [seed] FROM seed) as varchar)))\n\t\t\t,[M\u00eas]\t\t\t\t\t\t=\tc.M\u00easAno_Formatado\n\t\t\t,[Ciclo]\t\t\t\t\t=\tc.Semana_Mes_For\u00e7ada\n\t\t\t,[Tribo (ticket)]\t\t\t=\tt.tribo_serasa\n\t\t\t,[ID Serasa]\t\t\t\t=\tt.ID_serasa\n\t\t\t,[ID Ticket]\t\t\t\t=\tt.ID_ticket\n\t\t\t,[Data de Resolu\u00e7\u00e3o]\t\t=\tt.resolucao\n\t\t\t,[Motivos]\t\t\t\t\t=\tt.motivos\n\t\tFROM dim_tickets_zendesk t\n\t\tLEFT JOIN dim_calendario c ON CAST(t.resolucao as date) = c.Data\n\t\tWHERE t.motivos LIKE '%conex\u00e3o de dados%'\n\t) t\n\tLEFT JOIN f_mop_historico mh\n\tON\tt.[ID Serasa] = mh.[ID Serasa]\n\tAND CAST(t.[Data de Resolu\u00e7\u00e3o] as date) = mh.[Data da Atualiza\u00e7\u00e3o]\n\tLEFT JOIN f_mop_vigente mv ON mh.[ID Selecionar] = mv.[ID Selecionar]\n\tWHERE randid = 1 AND mh.[ID Selecionar] IS NOT NULL\n)\nSELECT * FROM query\n--ORDER BY [M\u00eas] DESC, [Ciclo] DESC, [Tribo (ticket)], [ID Selecionar]\n\nGO\n",
        "build_order": 199,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "UNKNOWN",
                "f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "UNKNOWN",
                "dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_zendesk]": [
                "UNKNOWN",
                "dim_tickets_zendesk"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_xl_qualidade_loteria_conexaodecontas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_xl_qualidade_loteria_conexaodecontas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON [vw_xl_qualidade_loteria_conexaodecontas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_mop_fechamento_m\u00eas",
        "type": "View",
        "start": 139664,
        "end": 144242,
        "code": "/****** Object:  View [dbo].[f_mop_fechamento_m\u00eas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\t\tCREATE   VIEW [dbo].[f_mop_fechamento_m\u00eas] AS \n\t\t\t\tWITH\n\t\tcalendario AS\n\t\t(\n\t\t\tSELECT DISTINCT fx.PriMaiuscula(FORMAT(Data, 'yyyy - MMMM')) AS [M\u00eas], DATEFROMPARTS(YEAR(Data),MONTH(Data),1) AS [Data In\u00edcio], EOMONTH(Data) AS [Data Fim] FROM dim_calendario\n\t\t),\n\t\tativos AS\n\t\t(\n\t\t\tSELECT DISTINCT [M\u00eas], [Data In\u00edcio], [Data Fim], mop.[Data da Atualiza\u00e7\u00e3o] as [Data Real], [ID Selecionar], [ID \u00danico], [ID Secullum], [ID Serasa], [ID Intelix], [ID EPBX],[ID Genesys], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [Cliente], [Projeto], [Cargo], [Tribo], [Sub Tribo], [Escala], [Jornada], [Taxa], [Pausa Manh\u00e3], [Pausa Almo\u00e7o], [Pausa Tarde], [Supervis\u00e3o], [Coordena\u00e7\u00e3o], [Ger\u00eancia], [Diretoria], [Email Selecionar],[Email Serasa],[Telefone],[CPF],[Data de Nascimento],[Nome de Registro],[Sexo Biol\u00f3gico], [REQ],[DMA] ,[DMA Inicial] ,[\u00daltima DMA Migra\u00e7\u00e3o] ,[\u00daltima DMA Geral] ,[Tipo de DMA] ,[Tipo da \u00daltima DMA] ,[Instrutor] ,[Instrutor Inicial] ,[Instrutor \u00daltima Migra\u00e7\u00e3o] ,[Instrutor \u00daltima DMA], [Data de Admiss\u00e3o], [Data de In\u00edcio em Opera\u00e7\u00e3o], [Tempo de Casa (Dias)], [Faixa Tempo de Casa],[Idade], [Faixa de Idade], [Data de Sa\u00edda (F\u00e9rias/Afastamento)], [Data de Retorno (F\u00e9rias/Afastamento)],[Data de Solicita\u00e7\u00e3o (Turnover)],[\u00daltima Data Trabalhada (Turnover)],[Per\u00edodo do Desligamento (Turnover)],[Motivo do Desligamento (Turnover)],[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)],[Custo da Rescis\u00e3o (Turnover)] \n\t\t\tFROM f_mop_historico as mop\n\t\t\tRIGHT JOIN (SELECT * FROM calendario) as c\n\t\t\tON c.[Data Fim] = mop.[Data da Atualiza\u00e7\u00e3o]\n\t\t),\n\t\tturnovers AS\n\t\t(\n\t\t\tSELECT DISTINCT [M\u00eas], [Data In\u00edcio], [Data Fim], mop.[Data da Atualiza\u00e7\u00e3o] as [Data Real], [ID Selecionar], [ID \u00danico], [ID Secullum], [ID Serasa], [ID Intelix], [ID EPBX],[ID Genesys], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [Cliente], [Projeto], [Cargo], [Tribo], [Sub Tribo], [Escala], [Jornada], [Taxa], [Pausa Manh\u00e3], [Pausa Almo\u00e7o], [Pausa Tarde], [Supervis\u00e3o], [Coordena\u00e7\u00e3o], [Ger\u00eancia], [Diretoria], [Email Selecionar],[Email Serasa],[Telefone],[CPF],[Data de Nascimento],[Nome de Registro],[Sexo Biol\u00f3gico], [REQ],[DMA] ,[DMA Inicial] ,[\u00daltima DMA Migra\u00e7\u00e3o] ,[\u00daltima DMA Geral] ,[Tipo de DMA] ,[Tipo da \u00daltima DMA] ,[Instrutor] ,[Instrutor Inicial] ,[Instrutor \u00daltima Migra\u00e7\u00e3o] ,[Instrutor \u00daltima DMA], [Data de Admiss\u00e3o], [Data de In\u00edcio em Opera\u00e7\u00e3o], [Tempo de Casa (Dias)], [Faixa Tempo de Casa],[Idade], [Faixa de Idade],[Data de Sa\u00edda (F\u00e9rias/Afastamento)], [Data de Retorno (F\u00e9rias/Afastamento)],[Data de Solicita\u00e7\u00e3o (Turnover)],[\u00daltima Data Trabalhada (Turnover)],[Per\u00edodo do Desligamento (Turnover)],[Motivo do Desligamento (Turnover)],[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)],[Custo da Rescis\u00e3o (Turnover)]\n\t\t\tFROM f_mop_eventos as mop\n\t\t\tRIGHT JOIN (SELECT * FROM calendario) as c\n\t\t\tON mop.[Data da Atualiza\u00e7\u00e3o] >= [Data In\u00edcio]\n\t\t\tAND mop.[Data da Atualiza\u00e7\u00e3o] <= [Data Fim]\n\t\t\tWHERE mop.Status = 'Turnover'\n\t\t),\n\t\tgrude AS\n\t\t(\n\t\t\tSELECT [M\u00eas], [Data In\u00edcio], [Data Fim], [Data da Atualiza\u00e7\u00e3o] = CASE WHEN [Data Real] > CAST(GETDATE() AS DATE) THEN CAST(GETDATE() AS DATE) ELSE [Data Real] END , [ID Selecionar], [ID \u00danico], [ID Secullum], [ID Serasa], [ID Intelix], [ID EPBX],[ID Genesys], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [Cliente], [Projeto], [Cargo], [Tribo], [Sub Tribo], [Escala], [Jornada], [Taxa], [Pausa Manh\u00e3], [Pausa Almo\u00e7o], [Pausa Tarde], [Supervis\u00e3o], [Coordena\u00e7\u00e3o], [Ger\u00eancia], [Diretoria], [Email Selecionar],[Email Serasa],[Telefone],[CPF],[Data de Nascimento],[Nome de Registro],[Sexo Biol\u00f3gico], [REQ],[DMA] ,[DMA Inicial] ,[\u00daltima DMA Migra\u00e7\u00e3o] ,[\u00daltima DMA Geral] ,[Tipo de DMA] ,[Tipo da \u00daltima DMA] ,[Instrutor] ,[Instrutor Inicial] ,[Instrutor \u00daltima Migra\u00e7\u00e3o] ,[Instrutor \u00daltima DMA], [Data de Admiss\u00e3o], [Data de In\u00edcio em Opera\u00e7\u00e3o], [Tempo de Casa (Dias)], [Faixa Tempo de Casa],[Idade], [Faixa de Idade], [Data de Sa\u00edda (F\u00e9rias/Afastamento)], [Data de Retorno (F\u00e9rias/Afastamento)],[Data de Solicita\u00e7\u00e3o (Turnover)],[\u00daltima Data Trabalhada (Turnover)],[Per\u00edodo do Desligamento (Turnover)],[Motivo do Desligamento (Turnover)],[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)], [Custo da Rescis\u00e3o (Turnover)]  FROM (\n\t\t\t\tSELECT  ROW_NUMBER() OVER (PARTITION BY [ID Selecionar], [Cliente], [Data In\u00edcio] ORDER BY [Data Real] DESC) AS n, * FROM (\n\t\t\t\t\tSELECT * FROM ativos\n\t\t\t\t\tUNION\n\t\t\t\t\tSELECT * FROM turnovers\n\t\t\t\t) as t0\n\t\t\t) as t1\n\t\t\tWHERE n = 1\n\t\t)\n\t\tSELECT * FROM grude\n\t\tWHERE [ID Selecionar] IS NOT NULL\n\t\n\nGO\n",
        "build_order": 200,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]": [
                "SELECT",
                "SELECT DISTINCT fx.PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT DISTINCT fx.PriMaiuscula(FORMAT(Data, 'yyyy - MMMM')) AS [M\u00eas], DATEFROMPARTS(YEAR(Data),MONTH(Data),1) AS [Data In\u00edcio], EOMONTH(Data) AS [Data Fim] FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": [
                "CREATE",
                "CREATE   VIEW [dbo].[f_mop_fechamento_m\u00eas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": [
                "CREATE",
                "CREATE   VIEW [dbo].[f_mop_fechamento_m\u00eas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "f_mop_fechamento_m\u00eas"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_you_gendo]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_you_gendo]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_you_gendo",
        "type": "View",
        "start": 144242,
        "end": 145489,
        "code": "/****** Object:  View [dbo].[vw_you_gendo]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\nCREATE VIEW [dbo].[vw_you_gendo] AS\n\nWITH\ncliente AS\n(\n\tSELECT \n\t [id_paciente] \n\t,[data]\n\t,[hora_inicio] = TIMEFROMPARTS(DATEPART(HOUR,[hora_inicio]),0,0,0,0)\n\t,[hora_fim]\n\t,[paciente] = FX.PriMaiuscula( CASE \n\t\t\t\t\tWHEN CHARINDEX('(',[paciente]) = 0 THEN \n\t\t\t\t\t\t[paciente] \n\t\t\t\t\tELSE\n\t\t\t\t\t\tTRIM(LEFT([paciente],CHARINDEX('(',[paciente])-1))\n                  END)\n\t,[telefone]\n\t,[responsavel] = TRIM(REPLACE(REPLACE(REPLACE(REPLACE([responsavel],'(',''),')',''),' - ',''),'  ',' '))\t\t\t\t\t\t\t\t \n\t,[status]\n\t,[cliente] = CASE \n\t\t\t\t\tWHEN CHARINDEX('(',[paciente]) = 0 THEN \n\t\t\t\t\t\tNULL\n\t\t\t\t\tELSE\n\t\t\t\t\t\tTRIM(REPLACE(RIGHT([paciente],LEN(paciente)-CHARINDEX('(',[paciente])),')',''))\n                    END\n\tFROM dim_you_gendo\n),\n\nid AS\n(\n\tSELECT *\n\t,[id] = REPLACE(REPLACE(REPLACE(REPLACE(CONCAT([data],[hora_inicio],[responsavel]),'-',''),':',''),'/',''),' ','')\n\t,[Paciente alternativo] = CONCAT([paciente],'-',RIGHT([telefone],LEN([telefone])-5))\n\t,[Agenda concat] = CONCAT([hora_inicio],' ',fx.PriMaiuscula(LEFT([responsavel],CHARINDEX(' ',[responsavel]))),' ',[status])\nFROM cliente\n)\nSELECT * FROM id\n\nGO\n",
        "build_order": 201,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]": [
                "UNKNOWN",
                "PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "UNKNOWN",
                "dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_you_gendo]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_you_gendo]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_you_gendo]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_you_gendo]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "SELECT",
                "SELECT * FROM vw_you_gendo"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_grupo]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_grupo]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_prognostico_grupo",
        "type": "Table",
        "start": 145489,
        "end": 145860,
        "code": "/****** Object:  Table [dbo].[dim_prognostico_grupo]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_prognostico_grupo](\n\t[ID SELECIONAR SAIDA] [varchar](max) NOT NULL,\n\t[GRUPO] [varchar](max) NOT NULL,\n\t[IN\u00cdCIO] [datetime] NOT NULL,\n\t[FIM] [datetime] NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 202,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_grupo]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_prognostico_grupo]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_grupo]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_prognostico_grupo]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_grupo]": [
                "UNKNOWN",
                "dim_prognostico_grupo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_grupo]": [
                "INSERT",
                "INSERT INTO dim_prognostico_grupo"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_grupo]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_grupo]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_prognostico_grupo",
        "type": "View",
        "start": 145860,
        "end": 147926,
        "code": "/****** Object:  View [dbo].[vw_prognostico_grupo]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n--select * from [vw_prognostico_grupo]\n\nCREATE  VIEW [dbo].[vw_prognostico_grupo] AS\n\nWITH base ([ID SELECIONAR SAIDA], [GRUPO], [IN\u00cdCIO], [FIM], [GRUPO_REV])\nAS\n(\n\tSELECT *,\n\t\t\tCASE\n\t\t\tWHEN [GRUPO] = 'SERASA-C.A.'                     THEN 'Central de Ajuda'\n\t\t\tWHEN [GRUPO] = 'SERASA-SCORE'                    THEN 'Central de Ajuda'\n\t\t\tWHEN [GRUPO] = 'SERASA-D\u00cdVIDAS'                  THEN 'Central de Ajuda'\n\t        WHEN [GRUPO] = 'SERASA-CREDITO'                  THEN 'Central de Ajuda'\n\t\t\tWHEN [GRUPO] = 'SERASA-LOJAS'                    THEN 'Facebook e Lojas'\n\t\t\tWHEN [GRUPO] = 'SERASA-OCR'                      THEN 'OCR'\n\t\t\tWHEN [GRUPO] = 'SERASA-FACEBOOK'                 THEN 'Facebook e Lojas'\n\t\t\tWHEN [GRUPO] = 'SERASA-RA'                       THEN 'Reclame Aqui'\n\t\t\tWHEN [GRUPO] = 'MERCADO'                         THEN 'Mercado'\n\t\t\tWHEN [GRUPO] = 'SERASA-GOV'                      THEN 'GOV'\n\t\t\tWHEN [GRUPO] = 'SERASA-SAC'                      THEN 'SAC'\n\t\t\tWHEN [GRUPO] = 'SERASA-CADASTRO_POSITIVO'        THEN 'Cadastro Positivo'   \n\t\t\tWHEN [GRUPO] = 'VIACREDI-PROGRID'                THEN 'Progrid'\n\t\t\tWHEN [GRUPO] = 'SERASA-WHATSAPP'                 THEN 'WhatsApp'\n\t\t\tWHEN [GRUPO] = 'SERASA-QUALIDADE'                THEN 'Qualidade'\n\t\t\tWHEN [GRUPO] = 'SERASA-SELF_SETUP'               THEN 'Self Setup'\n\t\t\tWHEN [GRUPO] = 'SERASA-PREMIUM'                  THEN '0800 Premium'\n\t\t\tWHEN [GRUPO] = 'SERASA_BKO_SAC'                  THEN 'BackOffice'\n\t\t\tWHEN [GRUPO] = 'SERASA-FACEBOOK E LOJAS'         THEN 'Facebook e Lojas'\n\t\t\tWHEN [GRUPO] = 'VIACREDI-AGC'                    THEN 'Assembl\u00e9ia'\n        END\n\nFROM dim_prognostico_grupo\n),\n\nagrupar([TEMPORADA], [GRUPO], [IN\u00cdCIO], [FIM], [GRUPO_REV])\nAS\n(\n\tSELECT \n\t\tCAST(ROW_NUMBER() over (partition by [ID SELECIONAR SAIDA] order by [IN\u00cdCIO]) AS VARCHAR(MAX)),\n\t\t[GRUPO], \n\t\t[IN\u00cdCIO], \n\t\t[FIM], \n\t\t[GRUPO_REV] \n\tFROM base \n)\n\nSELECT * FROM agrupar\n\nGO\n",
        "build_order": 203,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_grupo]": [
                "UNKNOWN",
                "dim_prognostico_grupo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_grupo]": [
                "CREATE",
                "CREATE  VIEW [dbo].[vw_prognostico_grupo]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_prognostico_grupo]": [
                "CREATE",
                "CREATE  VIEW [dbo].[vw_prognostico_grupo]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_unico_funcionarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_unico_funcionarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_unico_funcionarios",
        "type": "Table",
        "start": 147926,
        "end": 148398,
        "code": "/****** Object:  Table [dbo].[dim_unico_funcionarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_unico_funcionarios](\n\t[ID_funcionario] [int] NOT NULL,\n\t[empresa] [varchar](50) NOT NULL,\n\t[nome_registro] [varchar](150) NOT NULL,\n\t[nome_social] [varchar](150) NULL,\n\t[cpf] [varchar](14) NOT NULL,\n\t[nascimento] [date] NOT NULL,\n\t[admissao] [date] NOT NULL,\n\t[demissao] [date] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 204,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_unico_funcionarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_unico_funcionarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_unico_funcionarios]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_unico_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_unico_funcionarios]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_unico_funcionarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_unico_funcionarios]": [
                "UNKNOWN",
                "dim_unico_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "dim_unico_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_unico_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_unico_funcionarios]": [
                "SELECT",
                "SELECT * FROM dim_unico_funcionarios"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_unico_funcionarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_unico_funcionarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_bi_unico_funcionarios",
        "type": "View",
        "start": 148398,
        "end": 150319,
        "code": "/****** Object:  View [dbo].[vw_bi_unico_funcionarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE VIEW [dbo].[vw_bi_unico_funcionarios] AS\n\nWITH\n\ninicio AS(\n\tSELECT\n\t\t[ID_funcionario]\t\n\t   ,[empresa]\t\t\t\n\t   ,[nome_registro]\t\t\n\t   ,[nome_social]\t\t\n\t   ,[cpf]\t\t\t\t\n\t   ,[nascimento]\t\t\n\t   ,[admissao]\t\t\t\n\t   ,[demissao]\n\n\tFROM dim_unico_funcionarios\n),\nidade AS\n(\n\tSELECT * \n\t\t,[idade] = FLOOR(DATEDIFF(DAY,nascimento,GETDATE())/365.25)\n\t\t,[faixa de idade] = CASE\n\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,nascimento,GETDATE())/365.25) <= 20 THEN '18 a 20 Anos'\n\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,nascimento,GETDATE())/365.25) <= 24 THEN '21 a 24 Anos'\n\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,nascimento,GETDATE())/365.25) <= 29 THEN '25 a 29 Anos'\n\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,nascimento,GETDATE())/365.25) <= 34 THEN '30 a 34 Anos'\n\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,nascimento,GETDATE())/365.25) <= 39 THEN '35 a 39 Anos'\n\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,nascimento,GETDATE())/365.25) <= 59 THEN '40 a 59 Anos'\n\t\t\t\t\t\t\t\tELSE 'Acima de 60 anos'\n                            END\n\n\tFROM inicio\n),\ntempo_casa AS\n(\n\tSELECT *\n\t\t,[tempo de casa (dias)] = CASE\n\t\t\t\t\t\t\t\t\tWHEN [demissao] IS NOT NULL THEN DATEDIFF(DAY, [admissao],[demissao])\n\t\t\t\t\t\t\t\t\tELSE DATEDIFF(DAY, [admissao],GETDATE())\n\t\t\t\t\t\t\t\tEND\t\t\t \n\tFROM idade\n),\nfaixa_tempo_casa AS\n(\n\tSELECT *\n\t\t,[faixa tempo de casa] = CASE\n\t\t\t\t\t\t\t\t\tWHEN  [tempo de casa (dias)] <=30 THEN 'At\u00e9 30 Dias'\n\t\t\t\t\t\t\t\t\tWHEN  [tempo de casa (dias)] <=90 THEN '1 a 3 Meses'\n\t\t\t\t\t\t\t\t\tWHEN  [tempo de casa (dias)] <=180 THEN '3 a 6 Meses'\n\t\t\t\t\t\t\t\t\tWHEN  [tempo de casa (dias)] <=365 THEN '6 a 12 Meses'\n\t\t\t\t\t\t\t\t\tWHEN  [tempo de casa (dias)] <=712 THEN '1 a 2 Anos'\n\t\t\t\t\t\t\t\t\tELSE 'Acima de 2 Anos'\n\t\t\t\t\t\t\t\t END\n\t\t,[status] = CASE\n\t\t\t\t\t\tWHEN [demissao] IS NULL THEN 'Ativo'\n\t\t\t\t\t\tELSE 'Desligado'\n\t\t\t\t\tEND\n\tFROM tempo_casa\n)\nSELECT * FROM faixa_tempo_casa\n\n\nGO\n",
        "build_order": 205,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_unico_funcionarios]": [
                "UNKNOWN",
                "dim_unico_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_unico_funcionarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_bi_unico_funcionarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_unico_funcionarios]": [
                "CREATE",
                "CREATE VIEW [dbo].[vw_bi_unico_funcionarios]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_forecast_metas",
        "type": "Table",
        "start": 150319,
        "end": 151763,
        "code": "/****** Object:  Table [dbo].[dim_forecast_metas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_forecast_metas](\n\t[m\u00eas] [date] NOT NULL,\n\t[arquivo_fonte] [varchar](75) NOT NULL,\n\t[data_recebimento] [date] NOT NULL,\n\t[tribo] [varchar](50) NOT NULL,\n\t[volume_projetado] [float] NOT NULL,\n\t[tmt_segundos] [float] NOT NULL,\n\t[tmt_minutos] [time](7) NOT NULL,\n\t[hc_geral] [int] NOT NULL,\n\t[hc_tx1] [int] NOT NULL,\n\t[hc_tx2] [int] NOT NULL,\n\t[tempo_contratado_tx2] [time](7) NOT NULL,\n\t[pausas_nr_tx2] [float] NOT NULL,\n\t[treinamento_tx2] [float] NOT NULL,\n\t[tempo_produtivo_tx2] [time](7) NOT NULL,\n\t[tickets_PA_dia_tx2] [float] NOT NULL,\n\t[tempo_contratado_tx1] [time](7) NOT NULL,\n\t[pausas_nr_tx1] [float] NOT NULL,\n\t[outras_indisp] [float] NOT NULL,\n\t[tempo_produtivo_tx1] [time](7) NOT NULL,\n\t[tickets_PA_dia_tx1] [float] NOT NULL,\n\t[capacidade_tickets_mensal] [float] NOT NULL,\n\t[%capacidade_tickets_mensal] [float] NOT NULL,\n\t[custo_tx1] [float] NOT NULL,\n\t[custo_tx2] [float] NOT NULL,\n\t[custo_total_pa] [float] NOT NULL,\n\t[NS] [float] NOT NULL,\n\t[SLA] [float] NOT NULL,\n\t[abandono] [float] NOT NULL,\n\t[rechamada] [float] NOT NULL,\n\t[short_call] [float] NOT NULL,\n\t[NPS] [float] NOT NULL,\n\t[instabilidade] [float] NOT NULL,\n\t[casos_n\u00e3o_resolvidos] [float] NOT NULL,\n\t[phishing] [float] NOT NULL,\n\t[valor_pa] [float] NOT NULL,\n\t[obs] [varchar](500) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 206,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_forecast_metas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_metas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_forecast_metas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_forecast_metas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_forecast_metas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_forecast_metas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_quadro_funcionarios_dia]": [
                "UNKNOWN",
                "dim_forecast_metas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_metas]": [
                "INSERT",
                "INSERT INTO dim_forecast_metas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_penalidades]": [
                "DROP",
                "DROP TABLE IF EXISTS dim_forecast_metas"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_quadro_funcionarios_dia]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_quadro_funcionarios_dia]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mop_quadro_funcionarios_dia",
        "type": "View",
        "start": 151763,
        "end": 152669,
        "code": "/****** Object:  View [dbo].[vw_mop_quadro_funcionarios_dia]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n-- select * from dim_forecast_metas\n\n\n\nCREATE   VIEW [dbo].[vw_mop_quadro_funcionarios_dia] AS\nWITH\ninicio AS(\nSELECT\n\t[m\u00eas]\n   ,[tribo]\n   ,[capacity] = sum([hc_geral])\n   \nFROM dim_forecast_metas\nGROUP BY tribo, m\u00eas\n\n),\n\ncontagem AS(\nSELECT\n\t [Data da Atualiza\u00e7\u00e3o]\n    ,[tribo]\n    ,[ativos] = COUNT(*)  \nFROM \n    f_mop_historico\nWHERE \n    status = 'Ativo'\nGROUP BY  \n     [Data da Atualiza\u00e7\u00e3o]\n    ,[tribo]\n\n\n),\n\nativos AS(\n\tSELECT\n\tt0.[m\u00eas]\n   ,t0.[tribo]\n   ,t0.[capacity] \n   ,t1.[ativos]\n\nFROM inicio AS t0\n\nLEFT JOIN contagem AS t1\non t1.[Tribo] = t0.[tribo]\nAND CAST(t1.[Data da Atualiza\u00e7\u00e3o] AS DATE) = t0.[m\u00eas]\n),\n\npercnt_over AS(  \n\tSELECT \n\t*\n\t,[%_Over] = [ativos] / NULLIF([capacity],0) \n\t\n\tFROM ativos\n)\n\nselect * from percnt_over\n\nGO\n",
        "build_order": 207,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]": [
                "UNKNOWN",
                "dim_forecast_metas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_quadro_funcionarios_dia]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mop_quadro_funcionarios_dia]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_quadro_funcionarios_dia]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mop_quadro_funcionarios_dia]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_2clix_analiticosAvaliacoes_cod1",
        "type": "Table",
        "start": 152669,
        "end": 153603,
        "code": "/****** Object:  Table [dbo].[dim_2clix_analiticosAvaliacoes_cod1]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_2clix_analiticosAvaliacoes_cod1](\n\t[codigo] [int] NULL,\n\t[cliente] [varchar](max) NULL,\n\t[campanha] [varchar](max) NULL,\n\t[avaliado] [varchar](max) NULL,\n\t[avaliado_em] [datetime] NULL,\n\t[tempo_avaliacao] [time](7) NULL,\n\t[periodo] [varchar](max) NULL,\n\t[avaliador] [varchar](max) NULL,\n\t[avaliado_por] [varchar](max) NULL,\n\t[superior] [varchar](max) NULL,\n\t[nota] [float] NULL,\n\t[conceito] [varchar](max) NULL,\n\t[dt_fdbk] [datetime] NULL,\n\t[login_avaliado] [varchar](max) NULL,\n\t[status_feedback] [varchar](max) NULL,\n\t[auditor] [varchar](max) NULL,\n\t[ciclo_do_mes] [varchar](max) NULL,\n\t[status_usuario] [varchar](max) NULL,\n\t[segundo_superior] [varchar](max) NULL,\n\t[terceiro_superior] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 208,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_analiticosAvaliacoes_cod1]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_analiticosAvaliacoes_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod1]": [
                "UNKNOWN",
                "dim_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod1]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([avaliado_em]) from dim_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_2clix_analiticosAvaliacoes_cod1"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod1]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod1]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_2clix_analiticosAvaliacoes_cod1",
        "type": "View",
        "start": 153603,
        "end": 157264,
        "code": "/****** Object:  View [dbo].[vw_2clix_analiticosAvaliacoes_cod1]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n--select distinct campanha from [vw_2clix_analiticosAvaliacoes_cod1]\n\n\n\n\n\nCREATE   VIEW [dbo].[vw_2clix_analiticosAvaliacoes_cod1] AS\nWITH \ninicio(codigo, cliente, campanha, avaliado, avaliado_em, periodo, avaliador, avaliado_por, superior, nota, conceito, dt_fdbk, login_avaliado, status_feedback, auditor, ciclo_do_mes, status_usuario, segundo_superior, terceiro_superior, date)\nAs\n(\nSELECT codigo, cliente\n\t  ,campanha = REPLACE(campanha,'  ',' ')\n\t  ,avaliado, avaliado_em, periodo, avaliador, avaliado_por, superior, nota, conceito, dt_fdbk, login_avaliado, status_feedback, auditor, ciclo_do_mes, status_usuario, segundo_superior, terceiro_superior,\n\n\tCAST(avaliado_em AS DATE)\n\n\tFROM dim_2clix_analiticosAvaliacoes_cod1\n\tWHERE campanha <> 'SDR' AND campanha <> 'PME' AND campanha <> 'SAC N1' \n),\n\nadd_projeto(codigo, cliente, campanha, avaliado, avaliado_em, periodo, avaliador, avaliado_por, superior, nota, conceito, dt_fdbk, login_avaliado, status_feedback, auditor, ciclo_do_mes, status_usuario, segundo_superior, terceiro_superior, date, projeto)\nAS\n(\nSELECT codigo, cliente, campanha, avaliado, avaliado_em, periodo, avaliador, avaliado_por, superior, nota, conceito, dt_fdbk, login_avaliado, status_feedback, auditor, ciclo_do_mes, status_usuario, segundo_superior, terceiro_superior, date,\n\tCASE\n\t\tWHEN campanha IN ('0800 - Premium', '') THEN 'Premium'\n\t\tWHEN campanha =\t'Cadastro Positivo' THEN 'Cadastro Positivo'\n\t\tWHEN campanha = 'SAC' THEN 'SAC'\n\t\tWHEN campanha = 'Progrid 2022' THEN 'Progrid'\n\t\tWHEN campanha IN ('Progrid','') THEN 'Progrid'\n\t\tWHEN campanha IN ('Viacredi','') THEN 'Viacredi'\n\t\tWHEN campanha IN ('VIACREDI AGC 2023','') THEN 'Viacredi'\n\t\tELSE 'Digital'\n\n\tEND\n\nFROM  inicio\n),\n\nadd_tribo_mop(codigo, cliente, campanha, avaliado, avaliado_em, periodo, avaliador, avaliado_por, superior, nota, conceito, dt_fdbk, login_avaliado, status_feedback, auditor, ciclo_do_mes, status_usuario, segundo_superior, terceiro_superior, date, projeto, Tribo_mop)\nAS\n(\n\tSELECT codigo, cliente, campanha, avaliado, avaliado_em, periodo, avaliador, avaliado_por, superior, nota, conceito, dt_fdbk, login_avaliado, status_feedback, auditor, ciclo_do_mes, status_usuario, segundo_superior, terceiro_superior, date, projeto,\n\tCASE\n\t\tWHEN campanha = '0800 - Premium'             THEN '0800 Premium'\n\t\tWHEN campanha = 'BKO'                        THEN 'BackOffice'\n\t\tWHEN campanha = 'Cadastro Positivo'          THEN 'Cadastro Positivo'\n\t\tWHEN campanha = 'C\u00e9lula  Baby'               THEN 'C\u00e9lula Baby'\n\t\tWHEN campanha = 'Central de Ajuda'           THEN 'Central de Ajuda'\n\t\tWHEN campanha = 'Consumidor.GOV'             THEN 'GOV'\n\t\tWHEN campanha = 'Cr\u00e9dito'                    THEN 'Cr\u00e9dito'\n\t\tWHEN campanha = 'D\u00edvidas'                    THEN 'D\u00edvidas'\n\t\tWHEN campanha = 'Facebook'                   THEN 'Facebook'\n\t\tWHEN campanha = 'Google Play'                THEN 'Lojas'\n\t\tWHEN campanha = 'OCR'                        THEN 'OCR'\n\t\tWHEN campanha = 'Portal Parceiros'           THEN 'Self Setup'\n\t\tWHEN campanha = 'PROGRID 2023'               THEN 'Progrid'\n\t\tWHEN campanha = 'Reclame Aqui'               THEN 'Reclame Aqui'\n\t\tWHEN campanha = 'SAC'                        THEN 'SAC'\n\t\tWHEN campanha = 'Score'                      THEN 'Score'\n\t\tWHEN campanha = 'VIACREDI AGC 2023'          THEN 'Assembl\u00e9ias'\n\t\tELSE campanha\n\n\tEND\n\nFROM add_projeto\n)\n\nSELECT * FROM add_tribo_mop\n--SELECT * FROM vw_2clix_analiticosAvaliacoes_cod1\n\n--WHERE faixa_hora = 'Fora de Escala'   \t\n\nGO\n",
        "build_order": 209,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]": [
                "UNKNOWN",
                "dim_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT * FROM vw_2clix_analiticosAvaliacoes_cod1"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT * FROM vw_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * FROM vw_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod1]": [
                "INSERT",
                "INSERT INTO f_2clix_analiticosAvaliacoes_cod1 SELECT * FROM vw_2clix_analiticosAvaliacoes_cod1"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_extracaoBaseResumida_cod1]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_extracaoBaseResumida_cod1]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_2clix_extracaoBaseResumida_cod1",
        "type": "Table",
        "start": 157264,
        "end": 157972,
        "code": "/****** Object:  Table [dbo].[dim_2clix_extracaoBaseResumida_cod1]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_2clix_extracaoBaseResumida_cod1](\n\t[codigo] [int] NULL,\n\t[data_avaliacao] [datetime] NULL,\n\t[periodo] [varchar](max) NULL,\n\t[avaliado_por] [varchar](max) NULL,\n\t[agente] [varchar](max) NULL,\n\t[superior] [varchar](max) NULL,\n\t[cliente] [varchar](max) NULL,\n\t[campanha] [varchar](max) NULL,\n\t[grupo] [varchar](max) NULL,\n\t[pergunta] [varchar](max) NULL,\n\t[resposta] [varchar](max) NULL,\n\t[detalhe_da_resposta] [varchar](max) NULL,\n\t[situacao] [varchar](max) NULL,\n\t[nota] [float] NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 210,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_extracaoBaseResumida_cod1]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_extracaoBaseResumida_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_extracaoBaseResumida_cod1]": [
                "UNKNOWN",
                "dim_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_extracaoBaseResumida_cod1]": [
                "UNKNOWN",
                "dim_2clix_extracaoBaseResumida_cod1"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_extracaoBaseResumida_cod1]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_extracaoBaseResumida_cod1]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_2clix_extracaoBaseResumida_cod1",
        "type": "View",
        "start": 157972,
        "end": 161052,
        "code": "/****** Object:  View [dbo].[vw_2clix_extracaoBaseResumida_cod1]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\n\nCREATE    VIEW [dbo].[vw_2clix_extracaoBaseResumida_cod1] AS\nWITH \ninicio(codigo, data_avaliacao, periodo, avaliado_por, superior, agente, cliente, campanha, grupo, pergunta, resposta, detalhe_da_resposta, situacao, nota, date)\nAs\n(\nSELECT codigo, data_avaliacao, periodo, avaliado_por, superior, agente, cliente, campanha, grupo, pergunta, resposta, detalhe_da_resposta, situacao, nota,\n\n\tCAST(data_avaliacao AS DATE)\n\n\tFROM dim_2clix_extracaoBaseResumida_cod1\n\tWHERE campanha <> 'SDR' AND campanha <> 'PME' AND campanha <> 'SAC N1' \n),\n\nadd_projetos(codigo, data_avaliacao, periodo, avaliado_por, superior, agente, cliente, campanha, grupo, pergunta, resposta, detalhe_da_resposta, situacao, nota, date, projeto)\nAS\n(\nSELECT codigo, data_avaliacao, periodo, avaliado_por, superior, agente, cliente, campanha, grupo, pergunta, resposta, detalhe_da_resposta, situacao, nota, date,\n\tCASE\n\t\tWHEN campanha IN ('0800 - Premium', '') THEN 'Premium'\n\t\tWHEN campanha =\t'Cadastro Positivo' THEN 'Cadastro Positivo'\n\t\tWHEN campanha = 'SAC' THEN 'SAC'\n\t\tWHEN campanha = 'Progrid 2022' THEN 'Progrid'\n\t\tWHEN campanha IN ('Progrid','') THEN 'Progrid'\n\t\tWHEN campanha IN ('Viacredi','') THEN 'Viacredi'\n\t\tWHEN campanha IN ('VIACREDI AGC 2023','') THEN 'Viacredi'\n\t\tELSE 'Digital'\n\n\tEND\n\nFROM  inicio\n),\n\nadd_tribo_mop(codigo, data_avaliacao, periodo, avaliado_por, superior, agente, cliente, campanha, grupo, pergunta, resposta, detalhe_da_resposta, situacao, nota, date, projeto, Tribo_mop)\nAS\n(\n\tSELECT codigo, data_avaliacao, periodo, avaliado_por, superior, agente, cliente, campanha, grupo, pergunta, resposta, detalhe_da_resposta, situacao, nota, date, projeto,\n\tCASE\n\t\tWHEN campanha = '0800 - Premium'             THEN '0800 Premium'\n\t\tWHEN campanha = 'BKO'                        THEN 'BackOffice'\n\t\tWHEN campanha = 'Cadastro Positivo'          THEN 'Cadastro Positivo'\n\t\tWHEN campanha = 'C\u00e9lula  Baby'               THEN 'C\u00e9lula Baby'\n\t\tWHEN campanha = 'Central de Ajuda'           THEN 'Central de Ajuda'\n\t\tWHEN campanha = 'Consumidor.GOV'             THEN 'GOV'\n\t\tWHEN campanha = 'Cr\u00e9dito'                    THEN 'Cr\u00e9dito'\n\t\tWHEN campanha = 'D\u00edvidas'                    THEN 'D\u00edvidas'\n\t\tWHEN campanha = 'Facebook'                   THEN 'Facebook'\n\t\tWHEN campanha = 'Google Play'                THEN 'Lojas'\n\t\tWHEN campanha = 'OCR'                        THEN 'OCR'\n\t\tWHEN campanha = 'Portal Parceiros'           THEN 'Self Setup'\n\t\tWHEN campanha = 'PROGRID 2023'               THEN 'Progrid'\n\t\tWHEN campanha = 'Reclame Aqui'               THEN 'Reclame Aqui'\n\t\tWHEN campanha = 'SAC'                        THEN 'SAC'\n\t\tWHEN campanha = 'Score'                      THEN 'Score'\n\t\tWHEN campanha = 'VIACREDI AGC 2023'          THEN 'Assembl\u00e9ias'\n\t\tELSE campanha\n\n\tEND\n\nFROM add_projetos\n)\n\nSELECT * FROM add_tribo_mop\n--SELECT * FROM vw_2clix_extracaoBaseResumida_cod1\n\n--WHERE faixa_hora = 'Fora de Escala'   \t\n\nGO\n",
        "build_order": 211,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_extracaoBaseResumida_cod1]": [
                "UNKNOWN",
                "dim_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * FROM vw_2clix_extracaoBaseResumida_cod1"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * FROM vw_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_extracaoBaseResumida_cod1]": [
                "DROP",
                "DROP TABLE f_2clix_extracaoBaseResumida_cod1; SELECT * INTO f_2clix_extracaoBaseResumida_cod1 FROM vw_2clix_extracaoBaseResumida_cod1"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_usuarioReuniao]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_usuarioReuniao]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_2clix_usuarioReuniao",
        "type": "Table",
        "start": 161052,
        "end": 161578,
        "code": "/****** Object:  Table [dbo].[dim_2clix_usuarioReuniao]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_2clix_usuarioReuniao](\n\t[id] [varchar](500) NOT NULL,\n\t[usuario] [varchar](100) NOT NULL,\n\t[login] [varchar](20) NOT NULL,\n\t[nome da reuniao] [varchar](250) NOT NULL,\n\t[data] [datetime] NOT NULL,\n\t[instrutor responsavel] [varchar](100) NOT NULL,\n\t[tipo reuniao] [varchar](50) NOT NULL,\n\t[faltas] [int] NOT NULL,\n\t[nota] [int] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 212,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_usuarioReuniao]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_usuarioReuniao]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_usuarioReuniao]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_usuarioReuniao"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_usuarioReuniao]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_usuarioReuniao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA_usuarioreuniao]": [
                "UNKNOWN",
                "[dim_2clix_usuarioReuniao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_usuarioReuniao]": [
                "SELECT",
                "SELECT * FROM [dim_2clix_usuarioReuniao]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA_usuarioreuniao]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA_usuarioreuniao]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mop_eventos_DMA_usuarioreuniao",
        "type": "View",
        "start": 161578,
        "end": 163384,
        "code": "/****** Object:  View [dbo].[vw_mop_eventos_DMA_usuarioreuniao]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\nCREATE      VIEW [dbo].[vw_mop_eventos_DMA_usuarioreuniao] AS\nWITH\ninicio AS (\n\tSELECT\n\t\t\t [id]                       \n\t\t\t,[usuario]\t\t\t\t\t\n\t\t\t,[login]\t\t\t\t\t\n\t\t\t,[nome da reuniao]\t\t\t\n\t\t\t,[data]                     = CAST([data] as date) \t\n\t\t\t,[prox_data]                = DATEADD(DAY,-1,ISNULL(LEAD(data) OVER (PARTITION BY [login] order by [data]),(select MAX(data) from dim_calendario)))\n\t\t\t,[instrutor responsavel]\t\n\t\t\t,[tipo reuniao]\t\t\t\t\n\t\t\t,[faltas]\t\t\t\t\t\n\t\t\t,[nota] \n\t\t\t,[DMA]                      = TRY_CAST(LEFT(REPLACE(REPLACE(RIGHT([nome da reuniao],LEN([nome da reuniao])-CHARINDEX('DMA',[nome da reuniao])-2),' ',''),' ',''),3) AS INT)\n\tFROM [dim_2clix_usuarioReuniao]\t\n\tWHERE TRY_CAST(LEFT(REPLACE(REPLACE(RIGHT([nome da reuniao],LEN([nome da reuniao])-CHARINDEX('DMA',[nome da reuniao])-2),' ',''),' ',''),3) AS INT) IS NOT NULL\n),\n\netapa_2 AS (\n\n\tSELECT\n\t\t\t [id]                       \n\t\t\t,[usuario]\t\t\t\t\t\n\t\t\t,[login]\t\t\t\t\t\n\t\t\t,[nome da reuniao]\t\t\t\n\t\t\t,[data] \t\n\t\t\t,[prox_data] \n\t\t\t,[inicio_treinamento]            = MIN([data]) OVER (PARTITION BY [DMA])\n\t\t\t,[mes_inicio_treinamento]       = LEFT(DATENAME(MONTH, MIN([data]) OVER (PARTITION BY [DMA])), 3) + '-' + CAST(DATEPART(YEAR, MIN([data]) OVER (PARTITION BY [DMA])) AS VARCHAR)\n\t\t\t,[fim_treinamento]              = MAX([data]) OVER (PARTITION BY [DMA])\n\t\t\t,[M\u00easAno_FormatadoClassific]\t\t= CAST(CAST(DATEPART(YEAR, MIN([data]) OVER (PARTITION BY [DMA])) AS VARCHAR) + FORMAT(DATEPART(MONTH, MIN([data]) OVER (PARTITION BY [DMA])), '00') AS INT)\n\t\t\t,[instrutor responsavel]\t\n\t\t\t,[tipo reuniao]\t\t\t\t\n\t\t\t,[faltas]\t\t\t\t\t\n\t\t\t,[nota] \n\t\t\t,[DMA]\n\n\tFROM inicio\n)\n\tSELECT * FROM etapa_2\n\nGO\n",
        "build_order": 213,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "UNKNOWN",
                "select MAX(data) from dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_usuarioReuniao]": [
                "UNKNOWN",
                "[dim_2clix_usuarioReuniao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA_usuarioreuniao]": [
                "CREATE",
                "CREATE      VIEW [dbo].[vw_mop_eventos_DMA_usuarioreuniao]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mop_eventos_DMA_usuarioreuniao]": [
                "CREATE",
                "CREATE      VIEW [dbo].[vw_mop_eventos_DMA_usuarioreuniao]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_ExtracaoUsuariosCampanha]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_ExtracaoUsuariosCampanha]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_2clix_ExtracaoUsuariosCampanha",
        "type": "Table",
        "start": 163384,
        "end": 164036,
        "code": "/****** Object:  Table [dbo].[dim_2clix_ExtracaoUsuariosCampanha]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_2clix_ExtracaoUsuariosCampanha](\n\t[cod_usuario] [int] NULL,\n\t[cliente] [varchar](max) NULL,\n\t[campanha] [varchar](max) NULL,\n\t[superior] [varchar](max) NULL,\n\t[usuario] [varchar](max) NULL,\n\t[login] [varchar](max) NULL,\n\t[tipo_usuario] [varchar](max) NULL,\n\t[ultimo_acesso] [datetime] NULL,\n\t[status] [varchar](max) NULL,\n\t[logon_serasa] [varchar](max) NULL,\n\t[turno] [varchar](max) NULL,\n\t[data_inicio_produto] [datetime] NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 214,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_ExtracaoUsuariosCampanha]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_2clix_ExtracaoUsuariosCampanha]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_ExtracaoUsuariosCampanha]": [
                "UNKNOWN",
                "dim_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_ExtracaoUsuariosCampanha]": [
                "UNKNOWN",
                "dim_2clix_ExtracaoUsuariosCampanha"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_ExtracaoUsuariosCampanha]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_ExtracaoUsuariosCampanha]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_2clix_ExtracaoUsuariosCampanha",
        "type": "View",
        "start": 164036,
        "end": 167041,
        "code": "/****** Object:  View [dbo].[vw_2clix_ExtracaoUsuariosCampanha]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE   VIEW [dbo].[vw_2clix_ExtracaoUsuariosCampanha] AS\nWITH \ninicio (cod_usuario, cliente, campanha, superior, usuario, login, tipo_usuario, ultimo_acesso, status, logon_serasa, turno, data_inicio_produto, date)\nAs\n(\nSELECT cod_usuario, cliente, campanha, superior, usuario, login, tipo_usuario, ultimo_acesso, status, logon_serasa, turno, data_inicio_produto,\n\n\tCAST(ultimo_acesso AS DATE)\n\n\tFROM dim_2clix_ExtracaoUsuariosCampanha\n\tWHERE campanha <> 'SDR' AND campanha <> 'PME' AND campanha <> 'SAC N1' \n),\n\nadd_projetos(cod_usuario, cliente, campanha, superior, usuario, login, tipo_usuario, ultimo_acesso, status, logon_serasa, turno, data_inicio_produto, date, projeto)\nAS\n(\nSELECT cod_usuario, cliente, campanha, superior, usuario, login, tipo_usuario, ultimo_acesso, status, logon_serasa, turno, data_inicio_produto, date,\n\tCASE\n\t\tWHEN campanha IN ('0800 - Premium', '') THEN 'Premium'\n\t\tWHEN campanha =\t'Cadastro Positivo' THEN 'Cadastro Positivo'\n\t\tWHEN campanha = 'SAC' THEN 'SAC'\n\t\tWHEN campanha = 'Progrid 2022' THEN 'Progrid'\n\t\tWHEN campanha IN ('Progrid','') THEN 'Progrid'\n\t\tWHEN campanha IN ('Viacredi','') THEN 'Viacredi'\n\t\tWHEN campanha IN ('VIACREDI AGC 2023','') THEN 'Viacredi'\n\t\tELSE 'Digital'\n\n\tEND\n\nFROM  inicio\n),\n\nadd_tribo_mop(cod_usuario, cliente, campanha, superior, usuario, login, tipo_usuario, ultimo_acesso, status, logon_serasa, turno, data_inicio_produto, date, projeto, Tribo_mop)\nAS\n(\n\tSELECT cod_usuario, cliente, campanha, superior, usuario, login, tipo_usuario, ultimo_acesso, status, logon_serasa, turno, data_inicio_produto, date, projeto,\n\tCASE\n\t\tWHEN campanha = '0800 - Premium'             THEN '0800 Premium'\n\t\tWHEN campanha = 'BKO'                        THEN 'BackOffice'\n\t\tWHEN campanha = 'Cadastro Positivo'          THEN 'Cadastro Positivo'\n\t\tWHEN campanha = 'C\u00e9lula  Baby'               THEN 'C\u00e9lula Baby'\n\t\tWHEN campanha = 'Central de Ajuda'           THEN 'Central de Ajuda'\n\t\tWHEN campanha = 'Consumidor.GOV'             THEN 'GOV'\n\t\tWHEN campanha = 'Cr\u00e9dito'                    THEN 'Cr\u00e9dito'\n\t\tWHEN campanha = 'D\u00edvidas'                    THEN 'D\u00edvidas'\n\t\tWHEN campanha = 'Facebook'                   THEN 'Facebook'\n\t\tWHEN campanha = 'Google Play'                THEN 'Lojas'\n\t\tWHEN campanha = 'OCR'                        THEN 'OCR'\n\t\tWHEN campanha = 'Portal Parceiros'           THEN 'Self Setup'\n\t\tWHEN campanha = 'PROGRID 2023'               THEN 'Progrid'\n\t\tWHEN campanha = 'Reclame Aqui'               THEN 'Reclame Aqui'\n\t\tWHEN campanha = 'SAC'                        THEN 'SAC'\n\t\tWHEN campanha = 'Score'                      THEN 'Score'\n\t\tWHEN campanha = 'VIACREDI AGC 2023'          THEN 'Assembl\u00e9ias'\n\t\tELSE campanha\n\n\tEND\n\nFROM add_projetos\n)\n\nSELECT * FROM add_tribo_mop\n--SELECT * FROM vw_2clix_analiticosAvaliacoes_cod1\n\n--WHERE faixa_hora = 'Fora de Escala'   \t\n\nGO\n",
        "build_order": 215,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT * FROM vw_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_ExtracaoUsuariosCampanha]": [
                "UNKNOWN",
                "dim_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_2clix_ExtracaoUsuariosCampanha]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_2clix_ExtracaoUsuariosCampanha]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_ExtracaoUsuariosCampanha]": [
                "DROP",
                "DROP TABLE f_2clix_ExtracaoUsuariosCampanha; SELECT * INTO f_2clix_ExtracaoUsuariosCampanha FROM vw_2clix_ExtracaoUsuariosCampanha"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_enps]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_enps]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_enps",
        "type": "Table",
        "start": 167041,
        "end": 167507,
        "code": "/****** Object:  Table [dbo].[dim_enps]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_enps](\n\t[titulo_pesquisa] [varchar](max) NOT NULL,\n\t[respostas] [varchar](max) NULL,\n\t[weight] [int] NULL,\n\t[perguntas] [varchar](max) NOT NULL,\n\t[id] [bigint] NULL,\n\t[duracao] [bigint] NULL,\n\t[datahora_inicio] [datetime] NOT NULL,\n\t[datahora_fim] [datetime] NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 216,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_enps]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_enps]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_enps]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_enps]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_enps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_enps]": [
                "UNKNOWN",
                "dim_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_enps]": [
                "INSERT",
                "INSERT INTO dim_enps"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_enps]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_enps]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_enps",
        "type": "View",
        "start": 167507,
        "end": 168748,
        "code": "/****** Object:  View [dbo].[vw_enps]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\n\nCREATE       VIEW [dbo].[vw_enps] AS\n\nWITH\n\nperguntas AS(\n\tSELECT\n\t\t[titulo_pesquisa]\n\t   --,[respostas]\n\t   ,[weight]          = MAX([weight])\n\t   --,[perguntas]\n\t   ,[id]\n\t   ,[duracao]         = MAX([duracao])\n\t   ,[data]            = MAX(CAST([datahora_inicio] AS DATE))\n\t   ,[datahora_inicio] = MAX([datahora_inicio])\n\t   ,[datahora_fim]    = MAX([datahora_fim])\n\t   ,[nota]        = MAX(CASE\n\t\t\t\t\t\tWHEN [perguntas] in ('Qual \u00e9 a probabilidade de voc\u00ea recomendar o Grupo Selecionar a um(a) amigo(a) ou colega?') \n\t\t\t\t\t\tTHEN RIGHT(respostas,2)\n\t\t\t\t\t    ELSE NULL\n\t\t\t\t\t\tEND)\n\t   ,[setor/tribo]   = MAX(CASE\n\t\t\t\t\t\tWHEN [perguntas] in ('Qual seu time/setor?') \n\t\t\t\t\t\tTHEN respostas\n\t\t\t\t\t    ELSE NULL\n\t\t\t\t\t\tEND )  \n\t   ,[comentario]   = MAX(CASE\n\t\t\t\t\t\tWHEN [perguntas] in ('Comente sobre sua nota') \n\t\t\t\t\t\tTHEN respostas\n\t\t\t\t\t    ELSE NULL\n\t\t\t\t\t\tEND)\n\tFROM dim_enps\n\tgroup by id, titulo_pesquisa\n),\nclass AS(\n\tSELECT *\n\n\t,[classifica\u00e7\u00e3o] = CASE WHEN [nota] >= 9 THEN 'Promotores'\n\t\t\t\t\t\t\tWHEN [nota] <= 6 THEN 'Detratores'\n\t\t\t\t\t\t\tELSE 'Neutros'\n\t\t\t\t\t\t\tEND\n  FROM perguntas\n)\n\nSELECT * FROM class\n\n\nGO\n",
        "build_order": 217,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_enps]": [
                "UNKNOWN",
                "dim_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_enps]": [
                "CREATE",
                "CREATE       VIEW [dbo].[vw_enps]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_enps]": [
                "CREATE",
                "CREATE       VIEW [dbo].[vw_enps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_enps]": [
                "SELECT",
                "SELECT * INTO f_enps FROM vw_enps"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_turnover]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_turnover]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_bi_turnover",
        "type": "View",
        "start": 168748,
        "end": 169889,
        "code": "/****** Object:  View [dbo].[vw_bi_turnover]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE    VIEW [dbo].[vw_bi_turnover] AS\n\nWITH\nmop AS\n(\n\tSELECT\t \n\t\t [Data]\t= [Data da Atualiza\u00e7\u00e3o]\n\t\t,[ID Selecionar]\n\t\t,[Nome]\n\t\t,[Status]\n\t\t,[Situa\u00e7\u00e3o]\n\t\t,[Condi\u00e7\u00e3o]\n\t\t,[Cliente]\n\t\t,[Projeto]\n\t\t,[Tribo]\n\t\t,[Supervis\u00e3o]\n\t\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\n\t\t,[\u00daltima Data Trabalhada (Turnover)]\n\t\t,[Per\u00edodo do Desligamento (Turnover)]\n\t\t,[Motivo do Desligamento (Turnover)]\n\t\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)] \n\tFROM f_mop_eventos WHERE [Status] = 'Turnover'\n\tUNION\n\tSELECT\t \n\t\t [Data]\t= [Data da Atualiza\u00e7\u00e3o]\n\t\t,[ID Selecionar]\n\t\t,[Nome]\n\t\t,[Status]\t= 'Ativo'\n\t\t,[Situa\u00e7\u00e3o]\t= 'Ativo'\n\t\t,[Condi\u00e7\u00e3o]\t= 'Ativo'\n\t\t,[Cliente]\n\t\t,[Projeto]\n\t\t,[Tribo]\n\t\t,[Supervis\u00e3o]\n\t\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\t\t\t= NULL\n\t\t,[\u00daltima Data Trabalhada (Turnover)]\t\t= NULL\n\t\t,[Per\u00edodo do Desligamento (Turnover)]\t\t= NULL\n\t\t,[Motivo do Desligamento (Turnover)]\t\t=NULL\n\t\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)]\t= NULL \n\tFROM f_mop_historico\n),\ngrude AS\n(\n\tSELECT * FROM mop\n)\nSELECT * FROM  grude  \t\n\n\n\n\nGO\n",
        "build_order": 218,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_turnover]": [
                "CREATE",
                "CREATE    VIEW [dbo].[vw_bi_turnover]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_turnover]": [
                "CREATE",
                "CREATE    VIEW [dbo].[vw_bi_turnover]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_oneaone]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_oneaone]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_oneaone",
        "type": "Table",
        "start": 169889,
        "end": 170376,
        "code": "/****** Object:  Table [dbo].[dim_mendi_oneaone]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_oneaone](\n\t[titulo_pesquisa] [varchar](max) NOT NULL,\n\t[respostas] [varchar](max) NOT NULL,\n\t[score] [int] NULL,\n\t[perguntas] [varchar](max) NOT NULL,\n\t[id] [bigint] NULL,\n\t[duracao] [bigint] NULL,\n\t[datahora_inicio] [datetime] NOT NULL,\n\t[datahora_fim] [datetime] NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 219,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_oneaone]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_oneaone]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_oneaone]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_oneaone]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_oneaone]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_oneaone]": [
                "UNKNOWN",
                "dim_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mendi_oneaone]": [
                "INSERT",
                "INSERT INTO dim_mendi_oneaone"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_oneaone]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_oneaone]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_oneaone",
        "type": "View",
        "start": 170376,
        "end": 175323,
        "code": "/****** Object:  View [dbo].[vw_mendi_oneaone]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n--select * from [vw_mendi_oneaone]\n\nCREATE   VIEW [dbo].[vw_mendi_oneaone] AS\n\nWITH\n\nperguntas AS(\n\tSELECT\n\t\t[titulo_pesquisa]\n\t   ,[respostas]\n\t   ,[score]\n\t   ,[perguntas]\n\t   ,[id]\n\t   ,[duracao]\n\t   ,[data]=CAST([datahora_inicio] AS DATE)\n\t   ,[datahora_inicio]\n\t   ,[datahora_fim]\n\t   ,[pilares] = CASE\n\t\t\t\t\t\tWHEN [perguntas] in ('Voc\u00ea sabe identificar as emo\u00e7\u00f5es que sente?',\n\t\t\t\t\t\t\t\t\t\t     'Voc\u00ea sabe suas qualidades e defeitos?',\n\t\t\t\t\t\t\t\t\t\t     'Voc\u00ea utiliza as cr\u00edticas para crescer?',\n\t\t\t\t\t\t\t\t\t\t     'Voc\u00ea reconhece como seu comportamento afeta os outros?') THEN 'Autoconsci\u00eancia'\n                        WHEN [perguntas] in ('Voc\u00ea sabe se acalmar quando se sente inquieto ou chateado?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea consegue admitir facilmente que cometeu um erro?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea consegue pensar claramente quando est\u00e1 sob press\u00e3o?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea supera facilmente o sentimento de frustra\u00e7\u00e3o?') THEN 'Autorregula\u00e7\u00e3o'\n                        WHEN [perguntas] in ('Voc\u00ea define metas a longo prazo?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea persiste na busca por seus objetivos, apesar dos obst\u00e1culos?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea tem \u00e2nimo para atingir seus objetivos?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea se orienta pelos seus valores e objetivos?') THEN 'Automotiva\u00e7\u00e3o'\n                        WHEN [perguntas] in ('Voc\u00ea procura entendimento m\u00fatuo nas quest\u00f5es?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea tenta enxergar as situa\u00e7\u00f5es pela perspectiva dos outros?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea acha f\u00e1cil ler as emo\u00e7\u00f5es dos outros?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea consegue ouvir sem julgar?') THEN 'Empatia'\n\t\t\t\t\t\tWHEN [perguntas] in ('Voc\u00ea \u00e9 um bom ouvinte?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea promove conversas dif\u00edceis para resolver problemas?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea lida com pessoas e situa\u00e7\u00f5es dif\u00edceis com delicadeza?',\n\t\t\t\t\t\t\t\t\t\t\t 'Voc\u00ea presta aten\u00e7\u00e3o aos seus relacionamentos?') THEN 'Habilidades sociais'\n\t\t\t\t\t    ELSE 'N\u00c3O SE APLICA'\n\t\t\t\t\t\tEND\n\tFROM dim_mendi_oneaone\n\tWHERE perguntas NOT IN ('Primeiramente, como devemos te chamar?', 'Qual o seu email corporativo?','Por \u00faltimo, antes de come\u00e7ar', 'qual o seu telefone?')\n),\ncadastros AS(\n\tSELECT\n\t\t [id]\t    = CONCAT(id,[titulo_pesquisa])\n\t\t,[nome]     = STRING_AGG(CASE\n\t\t\t\t\t\t\t\t\t WHEN perguntas = 'Primeiramente, como devemos te chamar?' THEN respostas\n\t\t\t\t\t\t\t\t\t ELSE NULL\n\t\t\t\t\t\t\t\t END,' ')\t\t \n\t\t,[email]    = STRING_AGG(CASE\n\t\t\t\t\t\t\t\t\t WHEN perguntas = 'Qual o seu email corporativo?' THEN respostas\n\t\t\t\t\t\t\t\t\t ELSE NULL\n\t\t\t\t\t\t\t\t END, ' ')\n\t\t,[telefone] = STRING_AGG(CASE\n\t\t\t\t\t\t\t\t\t WHEN perguntas = 'Por \u00faltimo, antes de come\u00e7ar, qual o seu telefone?' THEN respostas\n\t\t\t\t\t\t\t\t\t ELSE NULL\n\t\t\t\t\t\t\t\t END, ' ')\n        ,[empresa_email] = STRING_AGG(CASE\n\t\t\t\t\t\t\t\t\t WHEN perguntas = 'Qual o seu email corporativo?' THEN LEFT(RIGHT([respostas],CHARINDEX('@',reverse([respostas]))-1),CHARINDEX('.',RIGHT([respostas],CHARINDEX('@',reverse([respostas]))-2)))\n\t\t\t\t\t\t\t\t\t ELSE NULL\n\t\t\t\t\t\t\t\t END, ' ') \n\t\t,[idade]     = STRING_AGG(CASE\n\t\t\t\t\t\t\t\t\t WHEN perguntas = 'Qual \u00e9 sua idade?' THEN respostas\n\t\t\t\t\t\t\t\t\t ELSE NULL\n\t\t\t\t\t\t\t\t END,' ')\n\t\t,[genero]     = STRING_AGG(CASE\n\t\t\t\t\t\t\t\t\t WHEN perguntas = 'Como voc\u00ea se identifica?' THEN respostas\n\t\t\t\t\t\t\t\t\t ELSE NULL\n\t\t\t\t\t\t\t\t END,' ')\n\t\t,[escolaridade]     = STRING_AGG(CASE\n\t\t\t\t\t\t\t\t\t WHEN perguntas = 'Qual \u00e9 o seu grau de escolaridade?' THEN respostas\n\t\t\t\t\t\t\t\t\t ELSE NULL\n\t\t\t\t\t\t\t\t END,' ')\n\t\t,[funcao/cargo]     = STRING_AGG(CASE\n\t\t\t\t\t\t\t\t\t WHEN perguntas = 'Qual o seu cargo/fun\u00e7\u00e3o?' THEN respostas\n\t\t\t\t\t\t\t\t\t ELSE NULL\n\t\t\t\t\t\t\t\t END,' ')\n\n         \n\tFROM dim_mendi_oneaone\n\tWHERE perguntas IN ('Primeiramente, como devemos te chamar?', 'Qual o seu email corporativo?','Por \u00faltimo, antes de come\u00e7ar, qual o seu telefone?', 'Qual o seu cargo/fun\u00e7\u00e3o?','Qual \u00e9 o seu grau de escolaridade?','Como voc\u00ea se identifica?','Qual \u00e9 sua idade?')\n\tGROUP BY id,[titulo_pesquisa]\n),\ngrude AS(\n\tSELECT \n\t\t [titulo_pesquisa] \n\t\t,[nome] = FX.PriMaiuscula(TRIM(t1.[nome]))\n\t\t,t1.[email]\n\t\t,t1.[telefone]\n\t\t,t0.[respostas]\n\t\t,t0.[score]\n\t\t,t0.[perguntas] \n\t\t,[pilares]\n\t\t,t0.[id]\n\t\t,t0.[duracao]\n\t\t,t0.[data]\n\t\t,t1.[idade]\n\t\t,t1.[genero]\n\t\t,t1.[escolaridade]\n\t\t,t1.[funcao/cargo]\n\t\t,t1.[empresa_email]\n\t\t,[empresa_titulo] = IIF(titulo_pesquisa = 'Teste a sua Intelig\u00eancia Emocional com a Mendi!', 'Comercial', LEFT([titulo_pesquisa],IIF(CHARINDEX('-',[titulo_pesquisa])<1,1,CHARINDEX('-',[titulo_pesquisa]))-1))\n\t\t,[nota_1] = CASE WHEN SCORE > 1 THEN '-' WHEN SCORE = 1 THEN '1' ELSE '.' END\n\t\t,[nota_2] = CASE WHEN SCORE > 2 THEN '-' WHEN SCORE = 2 THEN '2' ELSE '.' END\n\t\t,[nota_3] = CASE WHEN SCORE > 3 THEN '-' WHEN SCORE = 3 THEN '3' ELSE '.' END\n\t\t,[nota_4] = CASE WHEN SCORE > 4 THEN '-' WHEN SCORE = 4 THEN '4' ELSE '.' END\n\t\t,[nota_5] = CASE WHEN SCORE > 5 THEN '-' WHEN SCORE = 5 THEN '5' ELSE '.' END\n\tFROM perguntas AS t0\n\tINNER JOIN cadastros AS t1 ON CONCAT(t0.id,t0.[titulo_pesquisa]) = t1.id\n)\n\t\t\nSELECT * FROM grude\n\nGO\n",
        "build_order": 220,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]": [
                "UNKNOWN",
                "PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_oneaone]": [
                "UNKNOWN",
                "dim_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_oneaone]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_oneaone]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_oneaone]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_oneaone]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mendi_oneaone]": [
                "UNKNOWN",
                "vw_mendi_oneaone"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_feriados_nacionais]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_feriados_nacionais]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_feriados_nacionais",
        "type": "Table",
        "start": 175323,
        "end": 175646,
        "code": "/****** Object:  Table [dbo].[dim_feriados_nacionais]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_feriados_nacionais](\n\t[Data] [date] NULL,\n\t[Dia da Semana] [varchar](max) NULL,\n\t[Feriado] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 221,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_feriados_nacionais]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_feriados_nacionais]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_feriados_nacionais]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_feriados_nacionais"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_feriados_nacionais]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_feriados_nacionais]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_calendario_you]": [
                "SELECT",
                "SELECT Data, 1 AS Feriados, Feriado AS Feriado_Nome FROM dim_feriados_nacionais"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_calendario]": [
                "SELECT",
                "SELECT Data, 1 AS Feriados, Feriado AS Feriado_Nome FROM dim_feriados_nacionais"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_calendario_you]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_calendario_you]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_bi_calendario_you",
        "type": "View",
        "start": 175646,
        "end": 178243,
        "code": "/****** Object:  View [dbo].[vw_bi_calendario_you]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   VIEW [dbo].[vw_bi_calendario_you] AS\n\n--DECLARE @limite_hist  date = '01/01/2022' --(SELECT DATEFROMPARTS(YEAR(DATEADD(MONTH, (SELECT limite_historico_meses FROM vars), GETDATE())), MONTH(DATEADD(MONTH, (SELECT limite_historico_meses FROM vars), GETDATE())), 01));\n--DECLARE @limite_futuro date = DATEADD(MONTH, 1, GETDATE());\n\nWITH seq(n) AS \n(\n  SELECT 0 UNION ALL SELECT n + 1 FROM seq\n  WHERE n < DATEDIFF(DAY, '01/01/2022', DATEADD(MONTH, 1, GETDATE()))\n),\nd(d) AS \n(\n  SELECT DATEADD(DAY, n, '01/01/2022') FROM seq\n),\nsrc AS\n(\n  SELECT\n    [Data]\t\t\t\t\t\t\t= CONVERT(DATE, d),\n    [Ano]\t\t\t\t\t\t\t= DATEPART(YEAR, d),\n\n    [M\u00eas]\t\t\t\t\t\t\t= DATEPART(MONTH, d),\n\t[M\u00eas Abreviado]\t\t\t\t\t= LEFT(DATEPART(MONTH, d),3),\n    [Nome do M\u00eas]\t\t\t\t\t= DATENAME(MONTH, d),\n\t[M\u00eas-Ano]\t\t\t\t        = DATENAME(MONTH, d) + '-' + CAST(DATEPART(YEAR, d) AS VARCHAR),\n\t[Competencia]\t\t            = LEFT(DATENAME(MONTH, d), 3) + '-' + CAST(DATEPART(YEAR, d) AS VARCHAR),\n\t[MesAnoClassificacao]\t\t    = CAST(CAST(DATEPART(YEAR, d) AS VARCHAR) + FORMAT(DATEPART(MONTH, d), '00') AS INT),\n\n    [Dia]\t\t\t\t\t\t\t= DATEPART(DAY, d),\n    [Dia da Semana]\t\t\t\t\t= DATEPART(WEEKDAY, d),\n    [Nome do Dia]\t\t\t\t\t= DATENAME(WEEKDAY, d),\n\t[DiaUtil]\t\t\t\t\t\t\t= CASE WHEN (DATEPART(WEEKDAY, d) = 1 OR DATEPART(WEEKDAY, d) = 7) THEN 0 ELSE 1 END,\n\t[DiaUtil_ComSabado]\t\t\t\t= CASE WHEN (DATEPART(WEEKDAY, d) = 1) THEN 0 ELSE 1 END,\n\t[DiaUtil_N\u00e3oFeriados]\t\t\t= (CASE WHEN (DATEPART(WEEKDAY, d) = 1 OR DATEPART(WEEKDAY, d) = 7) THEN 0 ELSE 1 END) * ISNULL(t1.feriados,0),\n\t[DiaUtil_ComSabado_N\u00e3oFeriados]\t= (CASE WHEN (DATEPART(WEEKDAY, d) = 1) THEN 0 ELSE 1 END) * ISNULL(t1.feriados,0),\n\n    \n\t[Semana do M\u00eas]\t\t\t\t\t= DATEPART(WEEK, d) - DATEPART(WEEK, DATEADD(MONTH, DATEDIFF(MONTH, 0, d), 0)) + 1,\n\t[Semana 7 dias]\t\t\t\t    = CASE WHEN (DATEPART(DAY, d) > 21) THEN 4 ELSE ((DATEPART(DAY, d)-1)/7)+1 END,\n\t[Semanas]\t\t= CONCAT(CAST((CASE WHEN (DATEPART(DAY, d) > 21) THEN 4 ELSE ((DATEPART(DAY, d)-1)/7)+1 END)As varchar),'\u00ba Semana'),\n\n\t[Trimestre]\t\t\t\t\t\t= DATEPART(QUARTER, d),\n\tTrimestre_Texto\t\t\t\t\t= CONCAT(CAST(DATEPART(QUARTER, d)As varchar),'\u00ba Trimestre'),\n\t[Semestre]\t\t\t\t\t\t= (DATEPART(MONTH, d)-1)/6 +1,\n\tFeriados\t\t\t\t\t\t= ISNULL(t1.Feriados, 0),\n\tFeriado_Nome\t\t\t\t\t= t1.Feriado_Nome  \n  FROM d AS t0\n  \tLEFT JOIN(\n\t SELECT Data, 1 AS Feriados, Feriado AS Feriado_Nome FROM dim_feriados_nacionais) AS t1\n\t ON\n\t CONVERT(DATE, t0.d) = t1.Data \n)\nSELECT * FROM src\n--ORDER BY Data\n--OPTION (MAXRECURSION 0);\n\nGO\n",
        "build_order": 222,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_feriados_nacionais]": [
                "SELECT",
                "SELECT Data, 1 AS Feriados, Feriado AS Feriado_Nome FROM dim_feriados_nacionais"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_calendario_you]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_bi_calendario_you]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_bi_calendario_you]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_bi_calendario_you]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_creditos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_creditos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_creditos",
        "type": "Table",
        "start": 178243,
        "end": 178836,
        "code": "/****** Object:  Table [dbo].[dim_mendi_creditos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_creditos](\n\t[Cliente] [varchar](max) NULL,\n\t[Plano] [varchar](max) NULL,\n\t[Qtd Sess\u00f5es M\u00eas] [bigint] NULL,\n\t[R$ p/ sess\u00e3o] [float] NULL,\n\t[R$ Subtotal] [float] NULL,\n\t[R$ p/ sess\u00e3o extra] [float] NULL,\n\t[Qtd sess\u00e3o extra] [float] NULL,\n\t[Data inicio Plano] [datetime] NULL,\n\t[Data fim Plano] [datetime] NULL,\n\t[M\u00eas Referencia] [datetime] NULL,\n\t[Observa\u00e7\u00f5es] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 223,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_creditos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_creditos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_creditos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_creditos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_creditos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_creditos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_creditos]": [
                "UNKNOWN",
                "[dim_mendi_creditos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_creditos]": [
                "SELECT",
                "SELECT * INTO dim_mendi_creditos"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_creditos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_creditos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_creditos",
        "type": "View",
        "start": 178836,
        "end": 180695,
        "code": "/****** Object:  View [dbo].[vw_mendi_creditos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n--SELECT * FROM dim_mendi_creditos\n\nCREATE   VIEW [dbo].[vw_mendi_creditos] AS\n\nWITH\n\ninicio AS(\n\tSELECT\n\t\t [Cliente]\n\t\t,[Plano]\n\t\t,[Qtd Sess\u00f5es M\u00eas]\n\t\t,[R$ p/ sess\u00e3o]\n\t\t,[R$ Subtotal]\n\t\t,[R$ p/ sess\u00e3o extra]\n\t\t,[Data inicio Plano]\n\t\t,[Data fim Plano] = TRY_CAST(CAST([Data fim Plano] AS VARCHAR(MAX)) AS date)\n\t\t,[Observa\u00e7\u00f5es]\n\t    ,[data] = TRY_CAST([Data inicio Plano] AS DATE)\n\t    ,[mes_inicio] = DATEFROMPARTS(YEAR(TRY_CAST([Data inicio Plano] AS DATE)),MONTH(TRY_CAST([Data inicio Plano] AS DATE)),1)\n\t\t,[mes_fim] = ISNULL(DATEFROMPARTS(YEAR(TRY_CAST(CAST([Data fim Plano]AS VARCHAR(MAX)) AS DATE)),MONTH(TRY_CAST(CAST([Data fim Plano] AS VARCHAR(MAX)) AS DATE)),1),(SELECT MAX([M\u00eas_PrimeroDia]) FROM dim_calendario)) \n\t\t\n\t\tFROM [dim_mendi_creditos]\n),\n\ngrude AS\n(\n\tSELECT\n\t\tn = ROW_NUMBER() OVER (PARTITION BY t1.[M\u00eas_PrimeroDia],t0.[Cliente] ORDER BY t0.[data] desc)\n\t\t,t0.[Cliente]\n\t\t,t0.[Plano]\n\t\t,t0.[Qtd Sess\u00f5es M\u00eas]\n\t\t,t0.[R$ p/ sess\u00e3o]\n\t\t,t0.[R$ Subtotal]\n\t\t,t0.[R$ p/ sess\u00e3o extra]\n\t\t,t0.[Data inicio Plano]\n\t\t,t0.[Data fim Plano]\n\t\t,t0.[Observa\u00e7\u00f5es]\n\t\t,t0.[data]\n\t\t,t0.[mes_inicio]\n\t\t,t0.[mes_fim]\n\t\t,t1.[M\u00easAno_FormatadoAbreviado]\n\t\t,t1.[M\u00eas_PrimeroDia]\n\nFROM inicio AS t0\nRIGHT JOIN (\n\n\nSELECT DISTINCT [M\u00easAno_FormatadoAbreviado],[M\u00eas_PrimeroDia] FROM dim_calendario \nWHERE Data >= '01/01/2024'\n)\n\n\nAS t1\nON t0.[mes_inicio] <= t1.[M\u00eas_PrimeroDia]\nand t0.[mes_fim] >= t1.[M\u00eas_PrimeroDia]\n),\n\ntb_final AS\n(\n\tSELECT\n\t\t [Cliente]\n\t\t,[Plano]\n\t\t,[Qtd Sess\u00f5es M\u00eas]\n\t\t,[R$ p/ sess\u00e3o]\n\t\t,[R$ Subtotal]\n\t\t,[R$ p/ sess\u00e3o extra]\n\t\t,[Data inicio Plano]\n\t\t,[Data fim Plano]\n\t\t,[Observa\u00e7\u00f5es]\n\t\t,[data]\n\t\t,[M\u00easAno_FormatadoAbreviado]\n\t\t,[M\u00eas_PrimeroDia]\n\t\tFROM grude\n\t\twhere n=1\n)\nSELECT * FROM tb_final\n\n\n\n\n\n\nGO\n",
        "build_order": 224,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT DISTINCT [M\u00easAno_FormatadoAbreviado],[M\u00eas_PrimeroDia] FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_creditos]": [
                "UNKNOWN",
                "[dim_mendi_creditos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_creditos]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_creditos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_creditos]": [
                "CREATE",
                "CREATE   VIEW [dbo].[vw_mendi_creditos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "UNKNOWN",
                "vw_mendi_creditos"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod301]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod301]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod301",
        "type": "Table",
        "start": 180695,
        "end": 181865,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod301]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod301](\n\t[id] [varchar](150) NOT NULL,\n\t[nome_instituicao] [varchar](100) NULL,\n\t[pess_id] [varchar](40) NULL,\n\t[nome] [varchar](100) NULL,\n\t[dt_nascimento] [date] NULL,\n\t[cpf] [varchar](25) NULL,\n\t[rg] [varchar](50) NULL,\n\t[etiquetas] [varchar](100) NULL,\n\t[sexo] [varchar](10) NULL,\n\t[profissao] [varchar](100) NULL,\n\t[num_prontuario] [varchar](25) NULL,\n\t[indicado_por] [varchar](100) NULL,\n\t[logradouro] [varchar](100) NULL,\n\t[num_endereco] [int] NULL,\n\t[complemento] [varchar](100) NULL,\n\t[bairro] [varchar](100) NULL,\n\t[cep] [int] NULL,\n\t[cidade] [varchar](100) NULL,\n\t[estado] [varchar](50) NULL,\n\t[telefones] [varchar](250) NULL,\n\t[emails] [varchar](250) NULL,\n\t[dt_cadastro] [datetime] NULL,\n\t[resp_cadastro] [varchar](100) NULL,\n\t[ultimo_atendimento] [datetime] NULL,\n\t[planos_saude] [varchar](100) NULL,\n\t[numero_cateira] [varchar](100) NULL,\n\t[nome_mae] [varchar](100) NULL,\n\t[nome_pai] [varchar](100) NULL,\n\t[estado_civil] [varchar](100) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 225,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod301]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod301]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod301]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod301"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod301]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod301]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod301]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod301]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod301]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod301]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod807]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod807]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod807",
        "type": "Table",
        "start": 181865,
        "end": 182483,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod807]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod807](\n\t[Unnamed: 0] [bigint] NULL,\n\t[pess_id] [varchar](max) NULL,\n\t[inst_id] [varchar](max) NULL,\n\t[pess_tx_nome] [varchar](max) NULL,\n\t[pess_nr_cpf] [float] NULL,\n\t[pess_dt_nascimento] [varchar](max) NULL,\n\t[pess_dt_cadastro] [varchar](max) NULL,\n\t[pess_dt_alteracao] [varchar](max) NULL,\n\t[pein_tx_codigo_prontuario] [varchar](max) NULL,\n\t[resp_alteracao] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 226,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod807]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod807]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod807]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod807"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod807]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod807]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod301]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod807]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod807]": [
                "SELECT",
                "SELECT * INTO dim_mendi_saudevianet_cod807"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod301]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod301]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod301",
        "type": "View",
        "start": 182483,
        "end": 183632,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod301]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE    VIEW [dbo].[vw_mendi_saudevianet_cod301] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t t0.[id]\t\t\t\t\t\t\n\t\t\t,t0.[nome_instituicao]\t\t\n\t\t\t,t0.[pess_id]\t\t\t\t\n\t\t\t,t0.[nome]\t\t\t\t\t\n\t\t\t,t0.[dt_nascimento]\t\t\n\t\t\t,t0.[cpf]\t\t\t\t\t\n\t\t\t,t0.[rg]\t\t\t\t\t\n\t\t\t,t0.[etiquetas]\t\t\t\n\t\t\t,t0.[sexo]\t\t\t\t\t\n\t\t\t,t0.[profissao]\t\t\t\n\t\t\t,t0.[num_prontuario]\t\t\n\t\t\t,t0.[indicado_por]\t\t\t\n\t\t\t,t0.[logradouro]\t\t\t\n\t\t\t,t0.[num_endereco]\t\t\t\n\t\t\t,t0.[complemento]\t\t\t\n\t\t\t,t0.[bairro]\t\t\t\t\n\t\t\t,t0.[cep]\t\t\t\t\t\n\t\t\t,t0.[cidade]\t\t\t\t\n\t\t\t,t0.[estado]\t\t\t\t\n\t\t\t,t0.[telefones]\t\t\t\n\t\t\t,t0.[emails]\t\t\t\t\n\t\t\t,t0.[dt_cadastro]\t\t\t\n\t\t\t,t0.[resp_cadastro]\t\t\n\t\t\t,t0.[ultimo_atendimento]\t\n\t\t\t,t0.[planos_saude]\t\t\t\n\t\t\t,t0.[numero_cateira]\t\t\n\t\t\t,t0.[nome_mae]\t\t\t\t\n\t\t\t,t0.[nome_pai]\t\t\t\t\n\t\t\t,t0.[estado_civil]\n\t\t\t,t1.[pess_dt_alteracao]\n\tFROM [dim_mendi_saudevianet_cod301] as t0\n\tLEFT JOIN [dim_mendi_saudevianet_cod807] AS t1\n\tON t0.[pess_id] = t1.[pess_id]\n),\n\ninsert_data AS\n(\n\tSELECT *\n\t,[data] = CAST([dt_cadastro] AS DATE)\n\n\tFROM inicio\n)\n\nSELECT * FROM insert_data\n\nGO\n",
        "build_order": 227,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod301]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod301]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod807]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod807]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod301]": [
                "CREATE",
                "CREATE    VIEW [dbo].[vw_mendi_saudevianet_cod301]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod301]": [
                "CREATE",
                "CREATE    VIEW [dbo].[vw_mendi_saudevianet_cod301]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "UNKNOWN",
                "vw_mendi_saudevianet_cod301"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_faltas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_faltas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_faltas",
        "type": "Table",
        "start": 183632,
        "end": 183926,
        "code": "/****** Object:  Table [dbo].[dim_mendi_faltas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_faltas](\n\t[id] [varchar](max) NULL,\n\t[Justificativa de Falta] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 228,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_faltas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_faltas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_faltas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_faltas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_faltas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_faltas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "UNKNOWN",
                "dim_mendi_faltas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_faltas]": [
                "SELECT",
                "SELECT * INTO dim_mendi_faltas"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_municipios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_municipios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_municipios",
        "type": "Table",
        "start": 183926,
        "end": 184697,
        "code": "/****** Object:  Table [dbo].[dim_municipios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_municipios](\n\t[GEOCODIGO] [int] NOT NULL,\n\t[MUNICIPIO] [nvarchar](50) NOT NULL,\n\t[ESTADO] [nvarchar](50) NOT NULL,\n\t[UF] [nvarchar](50) NOT NULL,\n\t[REGIAO] [nvarchar](50) NOT NULL,\n\t[GEOCUF] [tinyint] NOT NULL,\n\t[MESO] [nvarchar](50) NOT NULL,\n\t[GEOCMES] [smallint] NOT NULL,\n\t[MICRO] [nvarchar](50) NOT NULL,\n\t[GEOCMIC] [int] NOT NULL,\n\t[CATEGORIA] [nvarchar](50) NOT NULL,\n\t[POP2010] [int] NOT NULL,\n\t[POPURBANA] [int] NOT NULL,\n\t[POPRURAL] [int] NOT NULL,\n\t[HOMENS] [int] NOT NULL,\n\t[MULHERES] [int] NOT NULL,\n\t[POP2000] [int] NOT NULL,\n\t[Long] [float] NOT NULL,\n\t[Lat] [float] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 229,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_municipios]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_municipios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_municipios]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_municipios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_municipios]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_municipios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "UNKNOWN",
                "dim_municipios"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod7",
        "type": "View",
        "start": 184697,
        "end": 197375,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod7]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCREATE            VIEW [dbo].[vw_mendi_saudevianet_cod7] AS\n\nWITH\n\ninicio AS(\n\tSELECT\t\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[inst_nome]\t\t\t\t\n\t\t\t,[agen_motivo_cancelamento]\t\n\t\t\t,[agda_rotulo]\t\t\t\t\n\t\t\t,[pess_id]\t\t\t\t\t\n\t\t\t,[pess_nome]\t\t\t\t\n\t\t\t,[agen_inicio]\t\t\t\t\n\t\t\t,[agen_chegada]\t\t\t\t\n\t\t\t,[agen_intervalo]\t\t\t\n\t\t\t,[agen_inicio_atendimento]\t\n\t\t\t,[agen_fim_atendimento]\t\t\n\t\t\t,[siag_situacao_agend]\t\t\n\t\t\t,[agen_encaixe]\t\t\t\t\n\t\t\t,[agen_antecipar]\t\t\t\n\t\t\t,[agen_online]\t\t\t\t\n\t\t\t,[nome_profissional]\t\t\n\t\t\t,[nome_operadora]                           = FX.PriMaiuscula([nome_operadora])\t\t\t\n\t\t\t,[tabela_preco]\t\t\t\t\n\t\t\t,[procedimento]\t\t\t\t\n\t\t\t,[etiqueta_paciente]\t\t\n\t\t\t,[etiqueta_agendamento]\t\t\n\t\t\t,[agen_alteracao]\t\t\t\n\t\t\t,[agen_cadastro]\t\t\t\n\t\t\t,[nome_responsavel]\t\t\t\n\t\t\t,[ultimo_atend_inst]\t\t\n\t\t\t,[qtd_dias_sem_retorno]\t\t\n\t\t\t,[orca_id]\t\t\t\t\t\n\t\t\t,[inma_motivo]\t\t\t\t\n\t\t\t,[prox_agendamento]\t\n\tFROM [dim_mendi_saudevianet_cod7]\n\n--/*\n\t\n\tUNION ALL -- SELECT * FROM vw_you_gendo\n\t\tSELECT\n\t\t [id]                           = REPLACE(REPLACE(REPLACE(REPLACE(CONCAT([data],[hora_inicio],[responsavel]),'-',''),':',''),'/',''),' ','') -- CONCAT([hora_inicio],' ',fx.PriMaiuscula(LEFT([responsavel],CHARINDEX(' ',[responsavel]))),' ',[status]) ??  -- talvez precise padronizar pra manter o historico dos pacientes que v\u00e3o migrar pra Mendi?\n\t\t,[inst_id]                      = '01'\n\t\t,[inst_nome]                    = 'YOU'\n\t\t,[agen_motivo_cancelamento]     = NULL\n\t\t,[agda_rotulo]                  =  fx.PriMaiuscula( lEFT([responsavel], CHARINDEX(' CRP',[responsavel])))\n\t\t,[pess_id]                      = CONCAT([paciente],'-',RIGHT([telefone],LEN([telefone])-5)) --VERIFICAR\n\t\t,[pess_nome]                    = [paciente]\n\t\t,[agen_inicio]                  = DATEADD(minute, DATEDIFF(minute, '00:00:00', [hora_inicio]), CAST([data] AS DATETIME))\n\t\t,[agen_chegada]                 = DATEADD(minute, DATEDIFF(minute, '00:00:00', [hora_inicio]), CAST([data] AS DATETIME))\n\t\t,[agen_intervalo]               = DATEADD(minute, DATEDIFF(minute, [hora_inicio], [hora_fim]), '00:00:00')\n\t\t,[agen_inicio_atendimento]      = DATEADD(minute, DATEDIFF(minute, '00:00:00', [hora_inicio]), CAST([data] AS DATETIME))\n\t\t,[agen_fim_atendimento]         = DATEADD(minute, DATEDIFF(minute, '00:00:00', [hora_fim]), CAST([data] AS DATETIME))\n\t\t,[siag_situacao_agend]\t\t\t= CASE \n\t\t\t\t\t\t\t\t\t\t\tWHEN [status] = 'Confirmado'         THEN 'Confirmado'\n\t\t\t\t\t\t\t\t\t\t\tWHEN [status] = 'Cancelado'          THEN 'Desmarcado'\n\t\t\t\t\t\t\t\t\t\t\tWHEN [status] = 'Cliente Chegou'     THEN 'Problema na Conex\u00e3o'  \n\t\t\t\t\t\t\t\t\t\t\tWHEN [status] = 'Novo Agendamento'   THEN 'Confirmado'  \n\t\t\t\t\t\t\t\t\t\t\tWHEN [status] = 'Fechado e Faturado' THEN 'Atendido'\n\t\t\t\t\t\t\t\t\t\t\tWHEN [status] = 'Cliente Ausente'    THEN 'Faltou'\n\t\t\t\t\t\t\t\t\t\t\tELSE NULL\n\t\t\t\t\t\t\t\t\t\t  END\t\n\t\t,[agen_encaixe]                = 'N\u00e3o'\n\t\t,[agen_antecipar]              = 'N\u00e3o'\n\t\t,[agen_online]                 = 'Sim'\n\t\t,[nome_profissional]           =  fx.PriMaiuscula( lEFT([responsavel], CHARINDEX(' CRP',[responsavel]))) \n\t\t,[nome_operadora]              = [cliente] \n\t\t,[tabela_preco]                = [cliente] \n\t\t,[procedimento]                = 'Psicoterapia Online'\n\t\t,[etiqueta_paciente]           = NULL\n\t\t,[etiqueta_agendamento]        = NULL\n\t\t,[agen_alteracao]              = NULL\n\t\t,[agen_cadastro]               = NULL\n\t\t,[nome_responsavel]            = NULL\n\t\t,[ultimo_atend_inst]           = MAX(DATEADD(minute, DATEDIFF(minute, '00:00:00', [hora_inicio]), CAST([data] AS DATETIME))) OVER (PARTITION BY CONCAT([paciente],'-',RIGHT([telefone],LEN([telefone])-5)))\n\t\t,[qtd_dias_sem_retorno]        = DATEDIFF(D,LAG([data]) over (Partition by CONCAT([paciente],'-',RIGHT([telefone],LEN([telefone])-5)) order by [data] asc),data)\n\t\t,[orca_id]                     = ''\n\t\t,[inma_motivo]                 = null\n\t\t,[prox_agendamento]            = lead([data]) over (Partition by CONCAT([paciente],'-',RIGHT([telefone],LEN([telefone])-5)) order by [data] asc)\n\t\n\tFROM (\n\t\tSELECT \n\t\t [id_paciente] \n\t\t,[data]\n\t\t,[hora_inicio]\n\t\t,[hora_fim]\n\t\t,[paciente] = FX.PriMaiuscula( CASE \n\t\t\t\t\t\tWHEN CHARINDEX('(',[paciente]) = 0 THEN \n\t\t\t\t\t\t\t[paciente] \n\t\t\t\t\t\tELSE\n\t\t\t\t\t\t\tTRIM(LEFT([paciente],CHARINDEX('(',[paciente])-1))\n\t\t\t\t\t  END)\n\t\t,[telefone]\n\t\t,[responsavel] = TRIM(REPLACE(REPLACE(REPLACE(REPLACE([responsavel],'(',''),')',''),' - ',''),'  ',' '))\t\t\t\t\t\t\t\t \n\t\t,[status]\n\t\t,[cliente] = CASE \n\t\t\t\t\t\tWHEN CHARINDEX('(',[paciente]) = 0 THEN \n\t\t\t\t\t\t\tNULL\n\t\t\t\t\t\tELSE\n\t\t\t\t\t\t\tTRIM(REPLACE(RIGHT([paciente],LEN(paciente)-CHARINDEX('(',[paciente])),')',''))\n\t\t\t\t\t\tEND\n\t\tFROM dim_you_gendo\n\t) a\n--*/\n\n),\n\ninsert_data AS\n(\n\tSELECT *\n\t,[data]                   = CAST([agen_inicio] AS DATE)\n\t,[primeira_devolutiva]    =\t CASE WHEN\n\t\t\t\t\t\t\t\t\tMIN( CASE \n\t\t\t\t\t\t\t\t\tWHEN [procedimento] = 'Devolutiva Teste Intelig\u00eancia Emocional'and [siag_situacao_agend] = 'Atendido' \t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tTHEN CAST([agen_inicio] AS DATE) \n\t\t\t\t\t\t\t\t\telse null \n\t\t\t\t\t\t\t\t\t end) over(Partition by [pess_id])=CAST([agen_inicio] AS DATE) and [procedimento] = 'Devolutiva Teste Intelig\u00eancia Emocional' and [siag_situacao_agend] = 'Atendido' THEN 1\n\t\t\t\t\t\t\t\t\t ELSE 0\n\t\t\t\t\t\t\t\t\t END\n\n\tFROM inicio\n),\ngrude AS\n(\n\tSELECT\n\t t0.[id]\n\t,t0.[inst_id]\n\t,t0.[inst_nome]\n\t,[agen_motivo_cancelamento] = CASE WHEN t3.[Justificativa de Falta] IS NOT NULL THEN t3.[Justificativa de Falta] ELSE t0.[agen_motivo_cancelamento] END\n\t,t0.[agda_rotulo]\n\t,t0.[pess_id]\n\t,t0.[pess_nome]\n\t,t0.[agen_inicio]\n\t,t0.[agen_chegada]\n\t,t0.[agen_intervalo]\n\t,t0.[agen_inicio_atendimento]\n\t,t0.[agen_fim_atendimento]\n\t,t0.[siag_situacao_agend]\n\t,t0.[agen_encaixe]\n\t,t0.[agen_antecipar]\n\t,t0.[agen_online]\n\t,t0.[nome_profissional]\n\t,t0.[nome_operadora]\n\t,t0.[tabela_preco]\n\t,t0.[procedimento]\n\t,t0.[etiqueta_paciente]\n\t,t0.[etiqueta_agendamento]\n\t,t0.[agen_alteracao]\n\t,t0.[agen_cadastro]\n\t,t0.[nome_responsavel]\n\t,t0.[ultimo_atend_inst]\n\t,t0.[qtd_dias_sem_retorno]\n\t,t0.[orca_id]\n\t,t0.[inma_motivo]\n\t,t0.[prox_agendamento]\n\t,t0.[data]\n\t,t0.[primeira_devolutiva]\n\t,[hora_agenda]                = cast( t0.[agen_inicio] as time(0))\n\t,[hora_completa]              = TRIM(left(cast( t0.[agen_inicio] as time(0)),CHARINDEX(':',cast( t0.[agen_inicio] as time(0)))-1))\n\t,t1.[dt_nascimento]\n\t,t1.[sexo]\n\t,t1.[cidade]\n\t,t2.[Lat]\n\t,t2.[Long]\n\t,Ordem = ROW_NUMBER() over (partition by datepart(year,[agen_inicio]),\n\t\t\t\t\t\t\t\t\tdatepart(month,[agen_inicio]),[nome_operadora], \n\t\t\t\t\t\t\t\t\tIIF([siag_situacao_agend] IN  ('Atendido', 'Faltou') \n\t\t\t\t\t\t\t\t\tAND NOT(coalesce(nome_operadora,'-') = 'Viacredi Alto Vale'\n\t\t\t\t\t\t\t\t\tand coalesce(procedimento,'-') = 'Devolutiva Teste Intelig\u00eancia Emocional'\n\t\t\t\t\t\t\t\t\tand \n\t\t\t\t\t\t\t\t\tt0.[primeira_devolutiva]=1)\n\t\t\t\t\t\t\t\t\t--t0.data < '30/06/2024')\n\t\t\t\t\t\t\t\t\t\t,1,0) \n\t\t\t\t\t\torder by [agen_inicio] asc)\n\n\n\t,[valor_por_sessao] = IIF([siag_situacao_agend] IN  ('Atendido', 'Faltou') \n\t\t\t\t\t\t\t\t\tAND NOT(coalesce(nome_operadora,'-') = 'Viacredi Alto Vale'\n\t\t\t\t\t\t\t\t\tand coalesce(procedimento,'-') = 'Devolutiva Teste Intelig\u00eancia Emocional'\n\t\t\t\t\t\t\t\t\tand t0.[primeira_devolutiva]=1\n\t\t\t\t\t\t\t\t\t--t0.data < '30/06/2024'\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t,\n\t\t\t\t\t\t\t\t\t\tIIF(ROW_NUMBER() over (partition by datepart(year,[agen_inicio]),\n\t\t\t\t\t\t\t\t\tdatepart(month,[agen_inicio]), [nome_operadora], \n\t\t\t\t\t\t\t\t\tIIF([siag_situacao_agend] IN  ('Atendido', 'Faltou') \n\t\t\t\t\t\t\t\t\tAND NOT(coalesce(nome_operadora,'-') = 'Viacredi Alto Vale'\n\t\t\t\t\t\t\t\t\tand coalesce(procedimento,'-') = 'Devolutiva Teste Intelig\u00eancia Emocional'\n\t\t\t\t\t\t\t\t\tand t0.[primeira_devolutiva]=1\n\t\t\t\t\t\t\t\t\t--t0.data < '30/06/2024'\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t,1,0) \n\t\t\t\t\t\t\t\t\torder by [agen_inicio] asc) <= t4.[Qtd Sess\u00f5es M\u00eas], t4.[R$ p/ sess\u00e3o],t4.[R$ p/ sess\u00e3o extra])\n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t,0)\n\t,t4.[Qtd Sess\u00f5es M\u00eas]\n\t,[Tipo de Cr\u00e9dito] = iif(t4.[Qtd Sess\u00f5es M\u00eas]=0 OR NOT\n\t\t\t\t\t\t\t\t([siag_situacao_agend] IN  ('Atendido', 'Faltou') \n\t\t\t\t\t\t\t\t\tAND NOT(coalesce(nome_operadora,'-') = 'Viacredi Alto Vale'\n\t\t\t\t\t\t\t\t\tand coalesce(procedimento,'-') = 'Devolutiva Teste Intelig\u00eancia Emocional'\n\t\t\t\t\t\t\t\t\tand t0.[primeira_devolutiva]=1 \n\t\t\t\t\t\t\t\t\t--t0.data < '30/06/2024'\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t) \n\t\t\t\t\t\t\t\t\t,null, IIF(ROW_NUMBER() over (partition by datepart(year,[agen_inicio]),\n\t\t\t\t\t\t\t\t\tdatepart(month,[agen_inicio]), \n\t\t\t\t\t\t\t\t\t[nome_operadora], \n\t\t\t\t\t\t\t\t\tIIF([siag_situacao_agend] IN  ('Atendido', 'Faltou') \n\t\t\t\t\t\t\t\t\tAND NOT(coalesce(nome_operadora,'-') = 'Viacredi Alto Vale'\n\t\t\t\t\t\t\t\t\tand coalesce(procedimento,'-') = 'Devolutiva Teste Intelig\u00eancia Emocional'\n\t\t\t\t\t\t\t\t\tand t0.[primeira_devolutiva]=1 \n\t\t\t\t\t\t\t\t\t--t0.data < '30/06/2024'\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t,1,0)\n\t\t\t\t\t\torder by [agen_inicio] asc) <= t4.[Qtd Sess\u00f5es M\u00eas], 'Contratado','Extra'))\n\n \t\n FROM insert_data AS t0\n LEFT JOIN vw_mendi_saudevianet_cod301 AS t1\n ON t0.[pess_id] = t1.[pess_id]\n LEFT JOIN dim_municipios AS t2\n ON t1.[cidade] = t2.MUNICIPIO and t1.[estado] = t2.[UF]\n LEFT JOIN dim_mendi_faltas AS t3\n ON t0.id = t3.id\nleft join vw_mendi_creditos as t4\non datefromparts(datepart(year,t0.[agen_inicio]),datepart(month,t0.[agen_inicio]),1) = t4.M\u00eas_PrimeroDia\nand t0.nome_operadora = t4.Cliente\n\n),\n\nausencia_dias AS\n(\n\tSELECT\n\t [id]\n\t,[inst_id]\n\t,[inst_nome]\n\t,[agen_motivo_cancelamento] \n\t,[agda_rotulo]\n\t,[pess_id]\n\t,[pess_nome]\n\t,[agen_inicio]\n\t,[agen_chegada]\n\t,[agen_intervalo]\n\t,[agen_inicio_atendimento]\n\t,[agen_fim_atendimento]\n\t,[siag_situacao_agend]\n\t,[agen_encaixe]\n\t,[agen_antecipar]\n\t,[agen_online]\n\t,[nome_profissional]\n\t,[nome_operadora]\n\t,[tabela_preco]\n\t,[procedimento]\n\t,[etiqueta_paciente]\n\t,[etiqueta_agendamento]\n\t,[agen_alteracao]\n\t,[agen_cadastro]\n\t,[nome_responsavel]\n\t,[ultimo_atend_inst]\n\t,[qtd_dias_sem_retorno]\n\t,[orca_id]\n\t,[inma_motivo]\n\t,[prox_agendamento]\n\t,[data]\n\t,[primeira_devolutiva]\n\t,[hora_agenda]\n\t,[hora_completa]\n\t,[dt_nascimento]\n\t,[sexo]\n\t,[cidade]\n\t,[Lat]\n\t,[Long]\n\t,[Ordem]\n\t,[valor_por_sessao]\t\t\t\t\t\t\t\t \n\t,[Qtd Sess\u00f5es M\u00eas]\n\t,[Tipo de Cr\u00e9dito] \n\t,[Ausencia>30D] = DATEDIFF(d,\n\t\t\t\t\t\t\t\tMAX( CASE \n\t\t\t\t\t\t\t\t\tWHEN [siag_situacao_agend] = 'Atendido' \n\t\t\t\t\t\t\t\t\tTHEN [data] \n\t\t\t\t\t\t\t\t\telse null \n\t\t\t\t\t\t\t\t\t end)\n\t\t\t\t\t\t\t\t\tover(Partition by [pess_id])\n\t\t\t\t\t\t\t\t\t\t\t,GETDATE())\n\nFROM grude\n),\n\ncancelado AS\n(\n\tSELECT\n\t [id]\n\t,[inst_id]\n\t,[inst_nome]\n\t,[agen_motivo_cancelamento] \n\t,[agda_rotulo]\n\t,[pess_id]\n\t,[pess_nome]\n\t,[agen_inicio]\n\t,[agen_chegada]\n\t,[agen_intervalo]\n\t,[agen_inicio_atendimento]\n\t,[agen_fim_atendimento]\n\t,[siag_situacao_agend]\n\t,[agen_encaixe]\n\t,[agen_antecipar]\n\t,[agen_online]\n\t,[nome_profissional]\n\t,[nome_operadora]\n\t,[tabela_preco]\n\t,[procedimento]\n\t,[etiqueta_paciente]\n\t,[etiqueta_agendamento]\n\t,[agen_alteracao]\n\t,[agen_cadastro]\n\t,[nome_responsavel]\n\t,[ultimo_atend_inst]\n\t,[qtd_dias_sem_retorno]\n\t,[orca_id]\n\t,[inma_motivo]\n\t,[prox_agendamento]\n\t,[data]\n\t,[primeira_devolutiva]\n\t,[hora_agenda]\n\t,[hora_completa]\n\t,[dt_nascimento]\n\t,[sexo]\n\t,[cidade]\n\t,[Lat]\n\t,[Long]\n\t,[Ordem]\n\t,[valor_por_sessao]\t\t\t\t\t\t\t\t \n\t,[Qtd Sess\u00f5es M\u00eas]\n\t,[Tipo de Cr\u00e9dito] \n\t,[primeiro_acesso_DT]    =\t MIN( CASE \n\t\t\t\t\t\t\t\t\tWHEN [siag_situacao_agend] = 'Atendido' \n\t\t\t\t\t\t\t\t\tTHEN [data] \n\t\t\t\t\t\t\t\t\telse null \n\t\t\t\t\t\t\t\t\t end) over(Partition by [pess_id])\n\t,[primeiro_acesso_QTD]    =\t CASE WHEN\n\t\t\t\t\t\t\t\t\tMIN( CASE \n\t\t\t\t\t\t\t\t\tWHEN [siag_situacao_agend] = 'Atendido' \n\t\t\t\t\t\t\t\t\tTHEN [data] \n\t\t\t\t\t\t\t\t\telse null \n\t\t\t\t\t\t\t\t\t end) over(Partition by [pess_id])=[data] THEN 1\n\t\t\t\t\t\t\t\t\t ELSE 0\n\t\t\t\t\t\t\t\t\t END\n\t,[Ausencia>30D]\n\n\t,[cancelado>24h] = CASE WHEN [data] >='01/01/2024'then\n\t\t\t\t\t\t\tIIF( siag_situacao_agend = 'Desmarcado', (SELECT TOP(1) ISNULL(MIN(t1.[data]), CAST('01-01-1900' AS DATE)) FROM ausencia_dias t1 WHERE t1.pess_id = t0.pess_id AND t1.data > t0.data AND t1.siag_situacao_agend in ('Atendido','Confirmado')), NULL)\n\t\t\t\t\t\t\tELSE NULL\n\t\t\t\t\t\t\tEND\nFROM ausencia_dias t0\n),\n\nfrequecia AS\n(\n\tSELECT\n\t [id]\n\t,[inst_id]\n\t,[inst_nome]\n\t,[agen_motivo_cancelamento] \n\t,[agda_rotulo]\n\t,[pess_id]\n\t,[pess_nome]\n\t,[agen_inicio]\n\t,[agen_chegada]\n\t,[agen_intervalo]\n\t,[agen_inicio_atendimento]\n\t,[agen_fim_atendimento]\n\t,[siag_situacao_agend]\n\t,[agen_encaixe]\n\t,[agen_antecipar]\n\t,[agen_online]\n\t,[nome_profissional]\n\t,[nome_operadora]\n\t,[tabela_preco]\n\t,[procedimento]\n\t,[etiqueta_paciente]\n\t,[etiqueta_agendamento]\n\t,[agen_alteracao]\n\t,[agen_cadastro]\n\t,[nome_responsavel]\n\t,[ultimo_atend_inst]\n\t,[qtd_dias_sem_retorno]\n\t,[orca_id]\n\t,[inma_motivo]\n\t,[prox_agendamento]\n\t,[data]\n\t,[primeira_devolutiva]\n\t,[hora_agenda]\n\t,[hora_completa]\n\t,[dt_nascimento]\n\t,[sexo]\n\t,[cidade]\n\t,[Lat]\n\t,[Long]\n\t,[Ordem]\n\t,[valor_por_sessao]\t\t\t\t\t\t\t\t \n\t,[Qtd Sess\u00f5es M\u00eas]\n\t,[Tipo de Cr\u00e9dito] \n\t,[primeiro_acesso_DT]\n\t,[primeiro_acesso_QTD]\n\t,[Ausencia>30D]\n\t,[cancelado>24h]\n\nFROM cancelado\n)\n\n\nSELECT * FROM frequecia\n\nGO\n",
        "build_order": 230,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]": [
                "UNKNOWN",
                "PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "UNKNOWN",
                "dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod7]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_you_gendo]": [
                "SELECT",
                "SELECT * FROM vw_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_creditos]": [
                "UNKNOWN",
                "vw_mendi_creditos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod301]": [
                "UNKNOWN",
                "vw_mendi_saudevianet_cod301"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_faltas]": [
                "UNKNOWN",
                "dim_mendi_faltas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_municipios]": [
                "UNKNOWN",
                "dim_municipios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "CREATE",
                "CREATE            VIEW [dbo].[vw_mendi_saudevianet_cod7]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "CREATE",
                "CREATE            VIEW [dbo].[vw_mendi_saudevianet_cod7]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod613]": [
                "UNKNOWN",
                "vw_mendi_saudevianet_cod7"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod613]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod613]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_saudevianet_cod613",
        "type": "Table",
        "start": 197375,
        "end": 197884,
        "code": "/****** Object:  Table [dbo].[dim_mendi_saudevianet_cod613]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_saudevianet_cod613](\n\t[id] [varchar](500) NOT NULL,\n\t[qtd_respostas] [int] NULL,\n\t[data_resposta] [date] NULL,\n\t[perg_id] [int] NULL,\n\t[perg_tx_descricao] [varchar](250) NULL,\n\t[resp_id] [int] NULL,\n\t[resp_tx_descricao] [varchar](250) NULL,\n\t[inst_id] [varchar](50) NULL,\n\t[pess_tx_nome] [varchar](100) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 231,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod613]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod613]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_saudevianet_cod613]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_saudevianet_cod613"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod613]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_saudevianet_cod613]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod613]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod613]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod613]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod613]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod613]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod613]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "vw_mendi_saudevianet_cod613",
        "type": "View",
        "start": 197884,
        "end": 198962,
        "code": "/****** Object:  View [dbo].[vw_mendi_saudevianet_cod613]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE     VIEW [dbo].[vw_mendi_saudevianet_cod613] AS\n\nWITH\n\ninicio AS(\n\n\tSELECT\t\n\t\t [id]\n\t\t,[qtd_respostas]\n\t\t,[data_resposta]\n\t\t,[perg_id]\n\t\t,[perg_tx_descricao]\n\t\t,[resp_id]\n\t\t,[resp_tx_descricao]\n\t\t,[inst_id]\n\t\t,[pess_tx_nome]\n\n\t\tFROM [dim_mendi_saudevianet_cod613]\n),\n\ninsert_data AS\n(\n\tSELECT *\n\t,[data] = CAST([data_resposta] AS DATE)\n\t,[avaliacoes] = TRIM(RIGHT([resp_tx_descricao],CHARINDEX('>i',REVERSE([resp_tx_descricao]))-1))\n\n\tFROM inicio\n),\n\ngrude AS\n(\n\tSELECT\n\t\t t0.[id]\n\t\t,t0.[qtd_respostas]\n\t\t,t0.[data_resposta]\n\t\t,t0.[perg_id]\n\t\t,t0.[perg_tx_descricao]\n\t\t,t0.[resp_id]\n\t\t,t0.[resp_tx_descricao]\n\t\t,t0.[inst_id]\n\t\t,t0.[pess_tx_nome]\n\t\t,t0.[data]\n\t\t,t0.[avaliacoes]\n\t\t,t1.[tabela_preco]\n\t\t,t1.[agda_rotulo]\n\t\n\tFROM insert_data AS t0\n\tLEFT JOIN vw_mendi_saudevianet_cod7 AS t1\n\tON t0.[pess_tx_nome] = t1.[pess_nome]\n\tAND t0.data = t1.data\n\twhere t1.[tabela_preco] is not null\n)\n\nSELECT * FROM grude\n\n\n\nGO\n",
        "build_order": 232,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod7]": [
                "UNKNOWN",
                "vw_mendi_saudevianet_cod7"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod613]": [
                "UNKNOWN",
                "[dim_mendi_saudevianet_cod613]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod613]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_mendi_saudevianet_cod613]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_saudevianet_cod613]": [
                "CREATE",
                "CREATE     VIEW [dbo].[vw_mendi_saudevianet_cod613]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_produtividade_V2",
        "type": "View",
        "start": 198962,
        "end": 202643,
        "code": "/****** Object:  View [dbo].[f_produtividade_V2]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\tCREATE VIEW [dbo].[f_produtividade_V2] AS\n\n\tWITH chaves (data, id_selecionar, id_serasa, tribo_zendesk, subtribo_zendesk, data_mop)  \n\tAS\n\t(\n\t\tSELECT t2.resolucao, t1.[ID Selecionar], t2.ID_serasa, t2.tribo_serasa, t2.subtribo_serasa, MAX([Data da Atualiza\u00e7\u00e3o]) FROM f_mop_historico AS t1\n\t\tRIGHT JOIN (\n\t\t\tSELECT DISTINCT ID_serasa=[ID Serasa], CAST([Resolu\u00e7\u00e3o] AS DATE) as resolucao, tribo_serasa=[Tribo], subtribo_serasa=[Tribo] FROM f_tickets\n\t\t\tWHERE [Resolu\u00e7\u00e3o] >= DATEFROMPARTS(YEAR(DATEADD(MONTH, -12, GETDATE())), MONTH(DATEADD(MONTH, -12, GETDATE())), 01)\n\t\t) AS t2\n\t\tON t2.ID_serasa = t1.[ID Serasa]\n\t\tAND  t2.resolucao = t1.[Data da Atualiza\u00e7\u00e3o]\n\t\tGROUP BY t1.[ID Selecionar], t2.ID_serasa, t2.resolucao, t2.tribo_serasa, t2.subtribo_serasa\n\t),\n\ttmt_tratados_rein (id_serasa, data_resolucao, tribo_zendesk, subtribo_zendesk, tempo_total_tratativas, total_tratados, tratados_tmt, reps, nr, reincidentes_48h, reincidentes_30d)\n\tAS\n\t(\n\t\tSELECT ID_serasa=[ID Serasa], CAST([Resolu\u00e7\u00e3o] AS DATE), tribo_serasa=[Tribo], subtribo_serasa=[Tribo], SUM(TMT), COUNT(1), SUM(CASE WHEN TMT>0 THEN 1 ELSE 0 END), SUM(R\u00e9plicas), SUM(CASE [Resolvido?] WHEN 0 THEN 1 ELSE 0 END), SUM(CAST([Reincidente 48h?] AS INT)), SUM(CAST([Reincidente 30d?] AS INT)) \n\t\tFROM f_tickets \n\t\tWHERE Resolu\u00e7\u00e3o >= DATEFROMPARTS(YEAR(DATEADD(MONTH, -12, GETDATE())), MONTH(DATEADD(MONTH, -12, GETDATE())), 01)\n\t\tGROUP BY [ID Serasa], CAST(Resolu\u00e7\u00e3o AS DATE), Tribo, Tribo\n\t),\n\tgrude (data, id_selecionar, id_serasa, nome, status, tribo_zendesk, subtribo_zendesk, tribo_selecionar, subtribo_selecionar, supervisao, tempo_total_tratativas, tmt, tratados, tratados_tmt, naoResolvidos, porcentagem_naoResolvidos, replicas, tratados_mes, reincidentes_48h, reincidentes_30d)\n\tAS\n\t(\n\t\tSELECT t1.data, t1.id_selecionar, t1.id_serasa, t2.nome, t2.status, t1.tribo_zendesk, t1.subtribo_zendesk, t2.tribo, t2.subtribo, t2.supervisao, t3.tempo_total_tratativas, (t3.tempo_total_tratativas/t3.total_tratados), t3.total_tratados, t3.tratados_tmt, t3.nr, (CAST(t3.nr AS FLOAT)/CAST(t3.total_tratados AS FLOAT)), t3.reps, (SUM(t3.total_tratados) OVER (PARTITION BY t1.id_selecionar, t1.tribo_zendesk, DATEFROMPARTS(YEAR(t1.data), MONTH(t1.data), 01))), t3.reincidentes_48h, t3.reincidentes_30d FROM chaves AS t1\n\t\tLEFT JOIN (\n\t\t\tSELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Selecionar] as ID_selecionar, nome, tribo, [Sub Tribo] as subtribo, [Supervis\u00e3o] as supervisao, status FROM f_mop_historico\n\t\t) AS t2\n\t\tON\tt1.data_mop\t = t2.data_atualizacao\n\t\tAND\tt1.id_selecionar = t2.ID_selecionar\n\t\tLEFT JOIN (\n\t\t\tSELECT * FROM tmt_tratados_rein\n\t\t) AS t3\n\t\tON\tt1.data\t\t\t = t3.data_resolucao\n\t\tAND\tt1.id_serasa\t = t3.id_serasa \n\t\tAND\tt1.tribo_zendesk = t3.tribo_zendesk   \n\t\tAND\tt1.subtribo_zendesk = t3.subtribo_zendesk   \n\t),\n\tfinal([Data], [ID Selecionar], [ID Serasa], [Nome], [Status], [Tribo Zendesk], [SubTribo Zendesk], [Tribo Selecionar], [Subtribo Selecionar], [Supervis\u00e3o], [Tratados], [Tratados Com TMT], [Tempo Total de Tratativa], [TMT], [N\u00e3o Resolvidos], [%N\u00e3o Resolvidos], [Replicas], [Reincidentes 48h], [Reincidentes 30d], contingencia)\n\tAS\n\t(\n\t\tSELECT data, id_selecionar, id_serasa, nome, status,  tribo_zendesk, subtribo_zendesk, tribo_selecionar, subtribo_selecionar, supervisao, tratados, tratados_tmt, tempo_total_tratativas, tmt, naoResolvidos, porcentagem_naoResolvidos, replicas, reincidentes_48h, reincidentes_30d, contingencia = IIF([tribo_zendesk] = [tribo_selecionar], 0,1) FROM grude AS t1\n\t)\n\tSELECT * FROM final\n\tWHERE Data >= '01/01/2023'\n\nGO\n",
        "build_order": 233,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Selecionar] as ID_selecionar, nome, tribo, [Sub Tribo] as subtribo, [Supervis\u00e3o] as supervisao, status FROM f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Selecionar] as ID_selecionar, nome, tribo, [Sub Tribo] as subtribo, [Supervis\u00e3o] as supervisao, status FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_produtividade_V2]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]": [
                "CREATE",
                "CREATE VIEW [dbo].[f_produtividade_V2]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "UNKNOWN",
                "f_produtividade_V2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_produtividade_V2"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_aux_horarios_30min]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_aux_horarios_30min]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_aux_horarios_30min",
        "type": "Table",
        "start": 202643,
        "end": 202883,
        "code": "/****** Object:  Table [dbo].[dim_aux_horarios_30min]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_aux_horarios_30min](\n\t[horario] [time](7) NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 234,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_aux_horarios_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_aux_horarios_30min]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_aux_horarios_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_aux_horarios_30min]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_calendario]": [
                "SELECT",
                "SELECT horario as Hor\u00e1rio FROM dim_aux_horarios_30min"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_calendario_30min",
        "type": "Table",
        "start": 202883,
        "end": 204074,
        "code": "/****** Object:  Table [dbo].[dim_calendario_30min]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_calendario_30min](\n\t[DataHora] [datetime] NULL,\n\t[Data] [date] NULL,\n\t[Ano] [int] NULL,\n\t[M\u00eas] [int] NULL,\n\t[M\u00eas_Nome] [nvarchar](30) NULL,\n\t[M\u00eas_PrimeroDia] [date] NULL,\n\t[M\u00eas_Passado] [nvarchar](30) NULL,\n\t[M\u00easAno_Formatado] [nvarchar](61) NULL,\n\t[M\u00easAno_FormatadoAbreviado] [nvarchar](34) NULL,\n\t[M\u00easAno_FormatadoClassific] [int] NULL,\n\t[Dia] [int] NULL,\n\t[DiaSemana] [int] NULL,\n\t[DiaSemana_Nome] [nvarchar](30) NULL,\n\t[DiaSemana_NomeCurto] [nvarchar](3) NULL,\n\t[DiaUtil] [int] NOT NULL,\n\t[DiaUtil_ComSabado] [int] NOT NULL,\n\t[DiaUtil_N\u00e3oFeriados] [int] NULL,\n\t[DiaUtil_ComSabado_N\u00e3oFeriados] [int] NULL,\n\t[Semana_Ano] [int] NULL,\n\t[Semana_Mes] [int] NULL,\n\t[Semana_Mes_For\u00e7ada] [int] NULL,\n\t[Semana_Mes_For\u00e7ada_PrimeiroDia] [date] NULL,\n\t[Semana_Mes_For\u00e7ada_Texto] [varchar](38) NOT NULL,\n\t[Trimestre] [int] NULL,\n\t[Trimestre_Texto] [varchar](41) NOT NULL,\n\t[Semestre] [int] NULL,\n\t[Feriados] [int] NOT NULL,\n\t[Feriado_Nome] [varchar](max) NULL,\n\t[Hor\u00e1rio] [time](7) NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 235,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_calendario_30min]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario_30min]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_calendario_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "SELECT",
                "SELECT MAX([Data]) FROM [db_serasa_producao].[dbo].dim_calendario_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "SELECT",
                "SELECT MAX([Data]) FROM [db_serasa_producao].[dbo].dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_calendario_30min]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": [
                "UNKNOWN",
                "dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_calendario]": [
                "SELECT",
                "SELECT [DataHora] = cast(Data as datetime) + cast(Hor\u00e1rio as datetime), * INTO dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_calendario_30min"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_epbx]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_epbx]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_chamadas_epbx",
        "type": "Table",
        "start": 204074,
        "end": 204827,
        "code": "/****** Object:  Table [dbo].[dim_chamadas_epbx]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_chamadas_epbx](\n\t[id] [varchar](100) NOT NULL,\n\t[datahora] [datetime] NOT NULL,\n\t[id_global_epbx] [varchar](50) NOT NULL,\n\t[ramal_atendente] [int] NOT NULL,\n\t[id_atendente] [int] NULL,\n\t[nome_atendente] [varchar](100) NULL,\n\t[status] [varchar](50) NOT NULL,\n\t[status_detalhe] [varchar](50) NOT NULL,\n\t[grupo] [varchar](50) NULL,\n\t[servico] [varchar](50) NULL,\n\t[campanha] [varchar](50) NULL,\n\t[categoria] [varchar](50) NULL,\n\t[telefone] [bigint] NULL,\n\t[duracao_total] [time](0) NOT NULL,\n\t[duracao_atendimento] [time](0) NOT NULL,\n\t[duracao_espera] [time](0) NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 236,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_epbx]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_chamadas_epbx]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_epbx]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_chamadas_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_epbx]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_chamadas_epbx]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "UNKNOWN",
                "dim_chamadas_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_epbx]": [
                "SELECT",
                "SELECT * FROM dim_chamadas_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_chamadas_epbx"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_chamadas_genesys",
        "type": "Table",
        "start": 204827,
        "end": 205837,
        "code": "/****** Object:  Table [dbo].[dim_chamadas_genesys]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_chamadas_genesys](\n\t[id] [varchar](100) NOT NULL,\n\t[id_conversa] [varchar](100) NOT NULL,\n\t[direcao] [varchar](25) NOT NULL,\n\t[id_participante] [varchar](100) NOT NULL,\n\t[tipo_participante] [varchar](100) NOT NULL,\n\t[nome_participante] [varchar](100) NULL,\n\t[id_usuario] [varchar](100) NULL,\n\t[nome_usuario] [varchar](100) NULL,\n\t[email_usuario] [varchar](100) NULL,\n\t[divisao_usuario] [varchar](100) NULL,\n\t[departamento_usuario] [varchar](100) NULL,\n\t[titulo_usuario] [varchar](100) NULL,\n\t[inicio_chamada] [datetime] NOT NULL,\n\t[fim_chamada] [datetime] NULL,\n\t[duracao_total_chamada] [time](0) NOT NULL,\n\t[inicio] [datetime] NOT NULL,\n\t[fim] [datetime] NULL,\n\t[duracao_total] [time](0) NOT NULL,\n\t[duracao_espera] [time](0) NOT NULL,\n\t[duracao_atendimento] [time](0) NOT NULL,\n\t[duracao_encerramento] [time](0) NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 237,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_chamadas_genesys]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_chamadas_genesys]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_chamadas_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_chamadas_genesys]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "SELECT",
                "SELECT *, [Transferida Por] = LAG(IIF(DATEDIFF(s, '00:00:00.000', [duracao_total])=0 AND DATEDIFF(s, '00:00:00.000', [duracao_espera]) = 0 AND DATEDIFF(s, '00:00:00.000', [duracao_atendimento]) = 0  AND DATEDIFF(s, '00:00:00.000', [duracao_encerramento]) = 0 ,NULL,[id_usuario])) OVER (PARTITION BY [id_conversa], [tipo_participante] ORDER BY [inicio] ASC) FROM dim_chamadas_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys]": [
                "SELECT",
                "SELECT * FROM dim_chamadas_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "SELECT",
                "SELECT TOP(3) 'GENESYS', 'CHA',[inicio] FROM [db_Serasa_producao].[dbo].[dim_chamadas_genesys]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_chamadas_genesys"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_data_atualizacao",
        "type": "Table",
        "start": 205837,
        "end": 206176,
        "code": "/****** Object:  Table [dbo].[dim_data_atualizacao]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_data_atualizacao](\n\t[table] [varchar](max) NOT NULL,\n\t[last_update] [datetime] NOT NULL,\n\t[last_update_data] [datetime] NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 238,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_data_atualizacao]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod1]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod3]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_extracaoBaseResumida_cod1]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_ExtracaoUsuariosCampanha]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_analise_turnover]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_bilhetes]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mendi_oneaone]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_penalidades]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_penalidades]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_forecast_penalidades",
        "type": "Table",
        "start": 206176,
        "end": 206563,
        "code": "/****** Object:  Table [dbo].[dim_forecast_penalidades]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_forecast_penalidades](\n\t[data_inicio] [date] NOT NULL,\n\t[data_fim] [date] NOT NULL,\n\t[faixa] [int] NOT NULL,\n\t[minimo] [float] NOT NULL,\n\t[maximo] [float] NOT NULL,\n\t[penalidade] [float] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 239,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_penalidades]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_forecast_penalidades]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_forecast_penalidades]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_forecast_penalidades"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "SELECT",
                "SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "SELECT",
                "SELECT TOP(1) [penalidade] FROM [db_serasa_producao].[dbo].dim_forecast_penalidades"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_penalidades]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_forecast_penalidades]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_penalidades]": [
                "INSERT",
                "INSERT INTO dim_forecast_penalidades"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_detalhado]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_detalhado]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_historico_faturamento_detalhado",
        "type": "Table",
        "start": 206563,
        "end": 207882,
        "code": "/****** Object:  Table [dbo].[dim_historico_faturamento_detalhado]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_historico_faturamento_detalhado](\n\t[M\u00eas] [date] NOT NULL,\n\t[Tipo Atendimento] [varchar](max) NOT NULL,\n\t[Tribo] [varchar](max) NOT NULL,\n\t[Fat Forecast] [float] NOT NULL,\n\t[Fat LOG Real] [float] NOT NULL,\n\t[% Fat LOG Real] [float] NOT NULL,\n\t[Diferen\u00e7a Fat LOG] [float] NOT NULL,\n\t[Penalidades] [float] NOT NULL,\n\t[Faturamento sem expurgos] [float] NOT NULL,\n\t[Penalidades com expurgo] [float] NOT NULL,\n\t[Faturamento Final (Realizado)] [float] NOT NULL,\n\t[TMT Forecast] [int] NOT NULL,\n\t[TMT Real] [int] NOT NULL,\n\t[Penalidade TMT] [float] NOT NULL,\n\t[SLA Forecast] [int] NOT NULL,\n\t[SLA Real] [float] NOT NULL,\n\t[Penalidade SLA] [float] NOT NULL,\n\t[NPS Forecast] [float] NOT NULL,\n\t[NPS Real] [float] NOT NULL,\n\t[Penalidade NPS] [float] NOT NULL,\n\t[TMA Forecast] [int] NOT NULL,\n\t[TMA Real] [int] NOT NULL,\n\t[Penalidade TMA] [float] NOT NULL,\n\t[NS Forecast] [float] NOT NULL,\n\t[NS Real] [float] NOT NULL,\n\t[Penalidade NS] [float] NOT NULL,\n\t[Abandono Forecast] [float] NOT NULL,\n\t[Abandono Real] [float] NOT NULL,\n\t[Penalidade Abandono] [float] NOT NULL,\n\t[Penalidade Total] [float] NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 240,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_detalhado]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_historico_faturamento_detalhado]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_detalhado]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_historico_faturamento_detalhado]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_detalhado]": [
                "INSERT",
                "INSERT INTO dim_historico_faturamento_detalhado"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_resumido]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_resumido]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_historico_faturamento_resumido",
        "type": "Table",
        "start": 207882,
        "end": 208647,
        "code": "/****** Object:  Table [dbo].[dim_historico_faturamento_resumido]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_historico_faturamento_resumido](\n\t[Modelo] [varchar](max) NOT NULL,\n\t[M\u00eas] [date] NOT NULL,\n\t[NF] [int] NOT NULL,\n\t[Valor] [float] NOT NULL,\n\t[Considera\u00e7\u00f5es] [varchar](max) NOT NULL,\n\t[Capacity] [float] NOT NULL,\n\t[Hist\u00f3rico Plan] [float] NOT NULL,\n\t[Diferen\u00e7a Log] [float] NOT NULL,\n\t[Penalty] [float] NOT NULL,\n\t[Total Descontos] [float] NOT NULL,\n\t[Diferen\u00e7a Nota faturada] [float] NOT NULL,\n\t[Considera\u00e7\u00e3o] [varchar](max) NOT NULL,\n\t[Obseva\u00e7\u00e3o (Operacionais)] [varchar](max) NOT NULL,\n\t[Obseva\u00e7\u00e3o (Planejamento)] [varchar](max) NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 241,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_resumido]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_historico_faturamento_resumido]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_resumido]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_historico_faturamento_resumido]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_resumido]": [
                "INSERT",
                "INSERT INTO dim_historico_faturamento_resumido"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_ajustes]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_ajustes]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_log_ajustes",
        "type": "Table",
        "start": 208647,
        "end": 209091,
        "code": "/****** Object:  Table [dbo].[dim_log_ajustes]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_log_ajustes](\n\t[Fonte_Original] [varchar](10) NOT NULL,\n\t[ID Selecionar_Original] [varchar](10) NULL,\n\t[Evento_Original] [varchar](100) NOT NULL,\n\t[In\u00edcio_Original] [datetime] NOT NULL,\n\t[In\u00edcio_Ajustado] [datetime] NOT NULL,\n\t[Fim_Ajustado] [datetime] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 242,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_ajustes]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_ajustes]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_ajustes]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_ajustes"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_ajustes]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_ajustes]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "SELECT",
                "SELECT * FROM [dim_log_ajustes]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON dim_log_ajustes"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_epbx]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_epbx]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_log_epbx",
        "type": "Table",
        "start": 209091,
        "end": 209540,
        "code": "/****** Object:  Table [dbo].[dim_log_epbx]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_log_epbx](\n\t[id_atendente] [int] NOT NULL,\n\t[ramal_atendente] [int] NOT NULL,\n\t[nome_atendente] [varchar](100) NOT NULL,\n\t[evento] [varchar](50) NOT NULL,\n\t[inicio] [datetime] NOT NULL,\n\t[fim] [datetime] NOT NULL,\n\t[duracao] [time](7) NOT NULL,\n\t[logoff] [bit] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 243,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_epbx]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_epbx]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_epbx]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_epbx]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_epbx]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "UNKNOWN",
                "dim_log_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_epbx]": [
                "SELECT",
                "SELECT * FROM dim_log_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_log_epbx"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_genesys]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_genesys]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_log_genesys",
        "type": "Table",
        "start": 209540,
        "end": 210223,
        "code": "/****** Object:  Table [dbo].[dim_log_genesys]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_log_genesys](\n\t[id] [varchar](100) NOT NULL,\n\t[id_usuario] [varchar](100) NOT NULL,\n\t[nome_usuario] [varchar](100) NOT NULL,\n\t[email_usuario] [varchar](100) NOT NULL,\n\t[divisao_usuario] [varchar](100) NOT NULL,\n\t[departamento_usuario] [varchar](100) NULL,\n\t[titulo_usuario] [varchar](100) NULL,\n\t[tipo_evento] [varchar](25) NOT NULL,\n\t[sistema_evento] [varchar](25) NOT NULL,\n\t[descricao_evento] [varchar](25) NOT NULL,\n\t[inicio] [datetime] NOT NULL,\n\t[fim] [datetime] NULL,\n\t[duracao] [time](0) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 244,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_genesys]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_genesys]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_genesys]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_genesys]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_genesys]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "UNKNOWN",
                "dim_log_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_genesys]": [
                "SELECT",
                "SELECT * FROM dim_log_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "SELECT",
                "SELECT TOP(3) 'GENESYS', 'LOG',[inicio] FROM [db_Serasa_producao].[dbo].[dim_log_genesys]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_log_genesys"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_intelix]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_intelix]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_log_intelix",
        "type": "Table",
        "start": 210223,
        "end": 210641,
        "code": "/****** Object:  Table [dbo].[dim_log_intelix]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_log_intelix](\n\t[id_atendente] [int] NOT NULL,\n\t[nome_atendente] [varchar](100) NOT NULL,\n\t[evento] [varchar](100) NULL,\n\t[inicio] [datetime] NOT NULL,\n\t[fim] [datetime] NULL,\n\t[duracao] [time](7) NULL,\n\t[complemento] [varchar](25) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 245,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_intelix]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_intelix]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_log_intelix]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_log_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_intelix]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_log_intelix]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "UNKNOWN",
                "dim_log_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_intelix]": [
                "SELECT",
                "SELECT * FROM dim_log_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "SELECT",
                "SELECT TOP(3) 'INTELIX', 'LOG',[inicio] FROM [db_Serasa_producao].[dbo].[dim_log_intelix]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON dim_log_intelix"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_contas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_contas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mendi_contas",
        "type": "Table",
        "start": 210641,
        "end": 210954,
        "code": "/****** Object:  Table [dbo].[dim_mendi_contas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mendi_contas](\n\t[Cliente] [varchar](max) NULL,\n\t[E-mail] [varchar](max) NULL,\n\t[senha] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 246,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_contas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_contas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mendi_contas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mendi_contas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_contas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mendi_contas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_contas]": [
                "SELECT",
                "SELECT * INTO dim_mendi_contas"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_cadastros]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_cadastros]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mop_cadastros",
        "type": "Table",
        "start": 210954,
        "end": 211380,
        "code": "/****** Object:  Table [dbo].[dim_mop_cadastros]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mop_cadastros](\n\t[ID_selecionar] [varchar](30) NOT NULL,\n\t[nome_social] [varchar](100) NOT NULL,\n\t[nome_registro] [varchar](100) NOT NULL,\n\t[cpf] [varchar](15) NOT NULL,\n\t[data_nascimento] [date] NOT NULL,\n\t[sexo_biologico] [varchar](1) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 247,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_cadastros]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_cadastros]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_cadastros]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mop_cadastros"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_cadastros]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_cadastros]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "SELECT",
                "SELECT * FROM dim_mop_cadastros"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON dim_mop_cadastros"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_contatos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_contatos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mop_contatos",
        "type": "Table",
        "start": 211380,
        "end": 211768,
        "code": "/****** Object:  Table [dbo].[dim_mop_contatos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mop_contatos](\n\t[ID_selecionar] [varchar](30) NOT NULL,\n\t[email_selecionar] [varchar](100) NULL,\n\t[email_experian] [varchar](100) NULL,\n\t[email_pessoal] [varchar](100) NULL,\n\t[telefone] [varchar](20) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 248,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_contatos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_contatos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_contatos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mop_contatos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_contatos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_contatos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "[dim_mop_contatos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON dim_mop_contatos"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_sinalizacoes]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_sinalizacoes]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mop_sinalizacoes",
        "type": "Table",
        "start": 211768,
        "end": 212176,
        "code": "/****** Object:  Table [dbo].[dim_mop_sinalizacoes]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mop_sinalizacoes](\n\t[DataHora da Checkagem] [datetime] NULL,\n\t[Inicio do Periodo de Checkagem] [datetime] NULL,\n\t[ID] [nvarchar](6) NULL,\n\t[Problema] [nvarchar](max) NULL,\n\t[Ocorr\u00eancias] [int] NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 249,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_sinalizacoes]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_sinalizacoes]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_mop_sinalizacoes]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_mop_sinalizacoes"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_sinalizacoes]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_sinalizacoes]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "INSERT",
                "INSERT INTO dim_mop_sinalizacoes"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_turnovers]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_turnovers]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_mop_turnovers",
        "type": "Table",
        "start": 212176,
        "end": 212678,
        "code": "/****** Object:  Table [dbo].[dim_mop_turnovers]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_mop_turnovers](\n\t[ID_selecionar] [varchar](30) NOT NULL,\n\t[data_solicitacao] [date] NOT NULL,\n\t[data_rescisao] [date] NOT NULL,\n\t[periodo_do_desligamento] [varchar](100) NOT NULL,\n\t[tipo] [varchar](30) NOT NULL,\n\t[motivo] [varchar](100) NOT NULL,\n\t[indicado_recontratacao] [varchar](3) NOT NULL,\n\t[custo] [float] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 250,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_turnovers]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_turnovers]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_turnovers]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_mop_turnovers]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mop_turnovers]": [
                "INSERT",
                "INSERT INTO dim_mop_turnovers"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "UNKNOWN",
                "dim_mop_turnovers"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_planejamento_estrategico_24]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_planejamento_estrategico_24]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_planejamento_estrategico_24",
        "type": "Table",
        "start": 212678,
        "end": 212980,
        "code": "/****** Object:  Table [dbo].[dim_planejamento_estrategico_24]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_planejamento_estrategico_24](\n\t[M\u00eas] [date] NOT NULL,\n\t[Meta Planejamento estrat\u00e9gico] [float] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 251,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_planejamento_estrategico_24]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_planejamento_estrategico_24]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_planejamento_estrategico_24]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_planejamento_estrategico_24]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_planejamento_estrategico_24]": [
                "INSERT",
                "INSERT INTO dim_planejamento_estrategico_24"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_afastamentos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_afastamentos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_secullum_afastamentos",
        "type": "Table",
        "start": 212980,
        "end": 213338,
        "code": "/****** Object:  Table [dbo].[dim_secullum_afastamentos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_secullum_afastamentos](\n\t[data_inclusao] [date] NOT NULL,\n\t[ID_funcionario] [int] NOT NULL,\n\t[inicio] [date] NOT NULL,\n\t[fim] [date] NULL,\n\t[tipo] [varchar](15) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 252,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_afastamentos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_secullum_afastamentos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_afastamentos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_secullum_afastamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_afastamentos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_secullum_afastamentos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_afastamentos]": [
                "INSERT",
                "INSERT INTO dim_secullum_afastamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_secullum_afastamentos"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_secullum_batidas",
        "type": "Table",
        "start": 213338,
        "end": 213704,
        "code": "/****** Object:  Table [dbo].[dim_secullum_batidas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_secullum_batidas](\n\t[ID_batida] [int] NULL,\n\t[ID_funcionario] [int] NULL,\n\t[inicio] [datetime] NULL,\n\t[fim] [datetime] NULL,\n\t[duracao] [time](7) NULL,\n\t[obs] [varchar](150) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 253,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_secullum_batidas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_secullum_batidas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_secullum_batidas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_secullum_batidas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_secullum_batidas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "UNKNOWN",
                "dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_batidas]": [
                "INSERT",
                "INSERT INTO dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_secullum_batidas"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_criados]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_criados]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_teste_criados",
        "type": "Table",
        "start": 213704,
        "end": 214074,
        "code": "/****** Object:  Table [dbo].[dim_teste_criados]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_teste_criados](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[subtribo_serasa] [varchar](50) NOT NULL,\n\t[ID_ticket] [int] NULL,\n\t[status] [varchar](150) NULL,\n\t[criacao] [datetime] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 254,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_criados]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_criados]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_criados]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_criados"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_criados]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_criados]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "UNKNOWN",
                "dim_teste_criados"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_criados]": [
                "INSERT",
                "INSERT INTO dim_teste_criados"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_resolvidos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_resolvidos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_teste_resolvidos",
        "type": "Table",
        "start": 214074,
        "end": 214416,
        "code": "/****** Object:  Table [dbo].[dim_teste_resolvidos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_teste_resolvidos](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[subtribo_serasa] [varchar](50) NOT NULL,\n\t[ID_ticket] [int] NOT NULL,\n\t[resolvido] [bit] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 255,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_resolvidos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_resolvidos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_resolvidos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_resolvidos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_resolvidos]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_resolvidos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "UNKNOWN",
                "dim_teste_resolvidos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_resolvidos]": [
                "INSERT",
                "INSERT INTO dim_teste_resolvidos"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_sla]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_sla]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_teste_sla",
        "type": "Table",
        "start": 214416,
        "end": 214828,
        "code": "/****** Object:  Table [dbo].[dim_teste_sla]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_teste_sla](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[subtribo_serasa] [varchar](50) NOT NULL,\n\t[data] [date] NOT NULL,\n\t[primeira_resposta_s] [bigint] NULL,\n\t[espera_solicitante_s] [bigint] NULL,\n\t[total_resolucao_s] [bigint] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 256,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_sla]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_sla]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_teste_sla]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_sla"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_teste_sla"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "dim_teste_sla"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_sla]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_sla]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "UNKNOWN",
                "dim_teste_sla"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_sla]": [
                "INSERT",
                "INSERT INTO dim_teste_sla"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein30d]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein30d]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_teste_tickets_rein30d",
        "type": "Table",
        "start": 214828,
        "end": 215190,
        "code": "/****** Object:  Table [dbo].[dim_teste_tickets_rein30d]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_teste_tickets_rein30d](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[subtribo_serasa] [varchar](50) NOT NULL,\n\t[ID_ticket] [int] NOT NULL,\n\t[reincidente_30d] [bit] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 257,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein30d]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tickets_rein30d]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein30d]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tickets_rein30d"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein30d]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tickets_rein30d]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "UNKNOWN",
                "dim_teste_tickets_rein30d"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein30d]": [
                "INSERT",
                "INSERT INTO dim_teste_tickets_rein30d"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein48h]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein48h]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_teste_tickets_rein48h",
        "type": "Table",
        "start": 215190,
        "end": 215552,
        "code": "/****** Object:  Table [dbo].[dim_teste_tickets_rein48h]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_teste_tickets_rein48h](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[subtribo_serasa] [varchar](50) NOT NULL,\n\t[ID_ticket] [int] NOT NULL,\n\t[reincidente_48h] [bit] NOT NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 258,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein48h]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tickets_rein48h]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_rein48h]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tickets_rein48h"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein48h]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tickets_rein48h]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "UNKNOWN",
                "dim_teste_tickets_rein48h"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein48h]": [
                "INSERT",
                "INSERT INTO dim_teste_tickets_rein48h"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tmt]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tmt]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_teste_tmt",
        "type": "Table",
        "start": 215552,
        "end": 215874,
        "code": "/****** Object:  Table [dbo].[dim_teste_tmt]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_teste_tmt](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[subtribo_serasa] [varchar](50) NOT NULL,\n\t[ID_ticket] [int] NOT NULL,\n\t[tmt] [int] NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 259,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tmt]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tmt]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tmt]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tmt"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tmt]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tmt]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "UNKNOWN",
                "dim_teste_tmt"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tmt]": [
                "INSERT",
                "INSERT INTO dim_teste_tmt"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tratados]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tratados]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_teste_tratados",
        "type": "Table",
        "start": 215874,
        "end": 216375,
        "code": "/****** Object:  Table [dbo].[dim_teste_tratados]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_teste_tratados](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[subtribo_serasa] [varchar](50) NOT NULL,\n\t[ID_ticket] [int] NULL,\n\t[formulario] [varchar](max) NULL,\n\t[motivos] [varchar](max) NULL,\n\t[criacao] [datetime] NOT NULL,\n\t[resolucao] [datetime] NOT NULL,\n\t[login_agente] [varchar](10) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 260,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tratados]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tratados]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_tratados]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_teste_tratados"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tratados]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_teste_tratados]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "SELECT",
                "SELECT[tribo_serasa], [subtribo_serasa],\t[ID_ticket], [formulario],\t[motivos],\t[criacao], [resolucao], [login_agente],\tp=1 FROM dim_teste_tratados"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tratados]": [
                "INSERT",
                "INSERT INTO dim_teste_tratados"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_replicas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_replicas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "dim_tickets_replicas",
        "type": "Table",
        "start": 216375,
        "end": 216921,
        "code": "/****** Object:  Table [dbo].[dim_tickets_replicas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[dim_tickets_replicas](\n\t[tribo_serasa] [varchar](50) NOT NULL,\n\t[criacao] [date] NOT NULL,\n\t[atribuicao] [date] NULL,\n\t[resolucao] [date] NULL,\n\t[motivos] [varchar](max) NULL,\n\t[produtos] [varchar](max) NOT NULL,\n\t[ID_serasa] [varchar](10) NULL,\n\t[ID_ticket] [varchar](10) NULL,\n\t[replicas] [int] NULL,\n\t[porcentagem_replicas] [float] NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 261,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_replicas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_tickets_replicas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_tickets_replicas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].dim_tickets_replicas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_replicas]": [
                "CREATE",
                "CREATE TABLE [dbo].[dim_tickets_replicas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "UNKNOWN",
                "dim_tickets_replicas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_replicas]": [
                "INSERT",
                "INSERT INTO dim_tickets_replicas"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod1]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_2clix_analiticosAvaliacoes_cod1",
        "type": "Table",
        "start": 216921,
        "end": 217906,
        "code": "/****** Object:  Table [dbo].[f_2clix_analiticosAvaliacoes_cod1]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod1](\n\t[codigo] [int] NULL,\n\t[cliente] [varchar](max) NULL,\n\t[campanha] [varchar](max) NULL,\n\t[avaliado] [varchar](max) NULL,\n\t[avaliado_em] [datetime] NULL,\n\t[periodo] [varchar](max) NULL,\n\t[avaliador] [varchar](max) NULL,\n\t[avaliado_por] [varchar](max) NULL,\n\t[superior] [varchar](max) NULL,\n\t[nota] [float] NULL,\n\t[conceito] [varchar](max) NULL,\n\t[dt_fdbk] [datetime] NULL,\n\t[login_avaliado] [varchar](max) NULL,\n\t[status_feedback] [varchar](max) NULL,\n\t[auditor] [varchar](max) NULL,\n\t[ciclo_do_mes] [varchar](max) NULL,\n\t[status_usuario] [varchar](max) NULL,\n\t[segundo_superior] [varchar](max) NULL,\n\t[terceiro_superior] [varchar](max) NULL,\n\t[date] [date] NULL,\n\t[projeto] [varchar](17) NOT NULL,\n\t[Tribo_mop] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 262,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod1]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod1]": [
                "UNKNOWN",
                "f_2clix_analiticosAvaliacoes_cod1"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod3]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_2clix_analiticosAvaliacoes_cod3",
        "type": "Table",
        "start": 217906,
        "end": 220558,
        "code": "/****** Object:  Table [dbo].[f_2clix_analiticosAvaliacoes_cod3]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod3](\n\t[codigo] [int] NULL,\n\t[cliente] [varchar](max) NULL,\n\t[campanha] [varchar](max) NULL,\n\t[avaliado] [varchar](max) NULL,\n\t[superior] [varchar](max) NULL,\n\t[data_avaliacao] [datetime] NULL,\n\t[tipo_avaliacao] [varchar](max) NULL,\n\t[departamento] [varchar](max) NULL,\n\t[avaliador] [varchar](max) NULL,\n\t[processo] [varchar](max) NULL,\n\t[codigo_gravacao] [varchar](max) NULL,\n\t[tempo_avaliacao] [varchar](max) NULL,\n\t[nota] [int] NULL,\n\t[data_feedback] [datetime] NULL,\n\t[resultado_feedback] [varchar](max) NULL,\n\t[responsavel_feedback] [varchar](max) NULL,\n\t[obs_responsavel_feedback] [varchar](max) NULL,\n\t[obs_avaliado] [varchar](max) NULL,\n\t[tabulacao] [varchar](max) NULL,\n\t[nota_sem_ncg] [varchar](max) NULL,\n\t[visualizacao_avaliado] [int] NULL,\n\t[pesquisa_avaliado] [varchar](max) NULL,\n\t[login_avaliado] [varchar](max) NULL,\n\t[data_admissao_avaliado] [datetime] NULL,\n\t[data_inicio_setor] [datetime] NULL,\n\t[codigo_externo] [int] NULL,\n\t[status_feedback] [varchar](max) NULL,\n\t[tempo_feedback] [varchar](max) NULL,\n\t[formulario] [varchar](max) NULL,\n\t[codigo_gravador] [varchar](max) NULL,\n\t[codigo_integracao] [int] NULL,\n\t[data_contato] [datetime] NULL,\n\t[atendimento realizado dentro do sla] [varchar](max) NULL,\n\t[causa raiz] [varchar](max) NULL,\n\t[classificacao da tratativa] [varchar](max) NULL,\n\t[comentario] [varchar](max) NULL,\n\t[data/hora da opiniao] [datetime] NULL,\n\t[ilha] [varchar](max) NULL,\n\t[nota avaliacao] [float] NULL,\n\t[n\u00famero do ticket] [bigint] NULL,\n\t[parceiros] [varchar](max) NULL,\n\t[ponto de oportunidade] [varchar](max) NULL,\n\t[produto identificado] [varchar](max) NULL,\n\t[tema pedido] [varchar](max) NULL,\n\t[tema resposta] [varchar](max) NULL,\n\t[periodo] [varchar](max) NULL,\n\t[pontos_positivos] [varchar](max) NULL,\n\t[pontos_melhorar] [varchar](max) NULL,\n\t[qtd_arquivos] [int] NULL,\n\t[matricula] [varchar](max) NULL,\n\t[observacao] [varchar](max) NULL,\n\t[email_avaliado] [varchar](max) NULL,\n\t[ticket] [bigint] NULL,\n\t[acima_meta] [varchar](max) NULL,\n\t[unidade] [varchar](max) NULL,\n\t[status_usuario] [varchar](max) NULL,\n\t[segundo_superior] [varchar](max) NULL,\n\t[terceiro_superior] [varchar](max) NULL,\n\t[date] [date] NULL,\n\t[projeto] [varchar](17) NOT NULL,\n\t[Tribo_mop] [varchar](max) NULL,\n\t[Tribo_padronizada] [varchar](17) NOT NULL,\n\t[tipo_auditoria] [varchar](max) NULL,\n\t[analise_auditoria] [varchar](max) NULL,\n\t[Supervisor_vigente] [varchar](100) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 263,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod3]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod3]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_analiticosAvaliacoes_cod3]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod3]": [
                "UNKNOWN",
                "f_2clix_analiticosAvaliacoes_cod3"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_extracaoBaseResumida_cod1]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_extracaoBaseResumida_cod1]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_2clix_extracaoBaseResumida_cod1",
        "type": "Table",
        "start": 220558,
        "end": 221352,
        "code": "/****** Object:  Table [dbo].[f_2clix_extracaoBaseResumida_cod1]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_2clix_extracaoBaseResumida_cod1](\n\t[codigo] [int] NULL,\n\t[data_avaliacao] [datetime] NULL,\n\t[periodo] [varchar](max) NULL,\n\t[avaliado_por] [varchar](max) NULL,\n\t[superior] [varchar](max) NULL,\n\t[agente] [varchar](max) NULL,\n\t[cliente] [varchar](max) NULL,\n\t[campanha] [varchar](max) NULL,\n\t[grupo] [varchar](max) NULL,\n\t[pergunta] [varchar](max) NULL,\n\t[resposta] [varchar](max) NULL,\n\t[detalhe_da_resposta] [varchar](max) NULL,\n\t[situacao] [varchar](max) NULL,\n\t[nota] [float] NULL,\n\t[date] [date] NULL,\n\t[projeto] [varchar](17) NOT NULL,\n\t[Tribo_mop] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 264,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_extracaoBaseResumida_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_extracaoBaseResumida_cod1]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_extracaoBaseResumida_cod1]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * INTO f_2clix_extracaoBaseResumida_cod1"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_ExtracaoUsuariosCampanha]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_2clix_ExtracaoUsuariosCampanha",
        "type": "Table",
        "start": 221352,
        "end": 222090,
        "code": "/****** Object:  Table [dbo].[f_2clix_ExtracaoUsuariosCampanha]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_2clix_ExtracaoUsuariosCampanha](\n\t[cod_usuario] [int] NULL,\n\t[cliente] [varchar](max) NULL,\n\t[campanha] [varchar](max) NULL,\n\t[superior] [varchar](max) NULL,\n\t[usuario] [varchar](max) NULL,\n\t[login] [varchar](max) NULL,\n\t[tipo_usuario] [varchar](max) NULL,\n\t[ultimo_acesso] [datetime] NULL,\n\t[status] [varchar](max) NULL,\n\t[logon_serasa] [varchar](max) NULL,\n\t[turno] [varchar](max) NULL,\n\t[data_inicio_produto] [datetime] NULL,\n\t[date] [date] NULL,\n\t[projeto] [varchar](17) NOT NULL,\n\t[Tribo_mop] [varchar](max) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 265,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_ExtracaoUsuariosCampanha]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_ExtracaoUsuariosCampanha]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_2clix_ExtracaoUsuariosCampanha]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * INTO f_2clix_ExtracaoUsuariosCampanha"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_chamadas",
        "type": "Table",
        "start": 222090,
        "end": 222773,
        "code": "/****** Object:  Table [dbo].[f_chamadas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_chamadas](\n\t[Fonte] [varchar](50) NOT NULL,\n\t[ID] [varchar](100) NOT NULL,\n\t[DataHora] [datetime] NOT NULL,\n\t[ID Selecionar] [varchar](10) NULL,\n\t[ID Intelix] [int] NULL,\n\t[ID EPBX] [int] NULL,\n\t[ID Genesys] [varchar](100) NULL,\n\t[Dire\u00e7\u00e3o] [varchar](10) NOT NULL,\n\t[Grupo] [varchar](50) NULL,\n\t[Status] [varchar](50) NULL,\n\t[Dura\u00e7\u00e3o Total] [int] NOT NULL,\n\t[Dura\u00e7\u00e3o Espera] [int] NOT NULL,\n\t[Dura\u00e7\u00e3o Atendimento] [int] NOT NULL,\n\t[Dura\u00e7\u00e3o Encerramento] [int] NOT NULL,\n\t[Transferida Por] [varchar](100) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 266,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_chamadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_chamadas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_chamadas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_chamadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "SELECT",
                "SELECT * FROM [f_chamadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_chamadas"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_enps]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_enps]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_enps",
        "type": "Table",
        "start": 222773,
        "end": 223317,
        "code": "/****** Object:  Table [dbo].[f_enps]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_enps](\n\t[titulo_pesquisa] [varchar](max) NOT NULL,\n\t[weight] [int] NULL,\n\t[id] [bigint] NULL,\n\t[duracao] [bigint] NULL,\n\t[data] [date] NULL,\n\t[datahora_inicio] [datetime] NULL,\n\t[datahora_fim] [datetime] NULL,\n\t[nota] [varchar](max) NULL,\n\t[setor/tribo] [varchar](max) NULL,\n\t[comentario] [varchar](max) NULL,\n\t[classifica\u00e7\u00e3o] [varchar](10) NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 267,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_enps]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_enps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_enps]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_enps]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_enps]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_enps]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_enps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_enps]": [
                "SELECT",
                "SELECT * INTO f_enps"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_mendi_oneaone]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_mendi_oneaone]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_mendi_oneaone",
        "type": "Table",
        "start": 223317,
        "end": 224248,
        "code": "/****** Object:  Table [dbo].[f_mendi_oneaone]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_mendi_oneaone](\n\t[titulo_pesquisa] [varchar](max) NOT NULL,\n\t[nome] [varchar](max) NULL,\n\t[email] [varchar](max) NULL,\n\t[telefone] [varchar](max) NULL,\n\t[respostas] [varchar](max) NOT NULL,\n\t[score] [int] NULL,\n\t[perguntas] [varchar](max) NOT NULL,\n\t[pilares] [varchar](19) NOT NULL,\n\t[id] [bigint] NULL,\n\t[duracao] [bigint] NULL,\n\t[data] [date] NULL,\n\t[idade] [varchar](max) NULL,\n\t[genero] [varchar](max) NULL,\n\t[escolaridade] [varchar](max) NULL,\n\t[funcao/cargo] [varchar](max) NULL,\n\t[empresa_email] [varchar](max) NULL,\n\t[empresa_titulo] [varchar](max) NULL,\n\t[nota_1] [varchar](1) NOT NULL,\n\t[nota_2] [varchar](1) NOT NULL,\n\t[nota_3] [varchar](1) NOT NULL,\n\t[nota_4] [varchar](1) NOT NULL,\n\t[nota_5] [varchar](1) NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 268,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mendi_oneaone]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mendi_oneaone]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mendi_oneaone]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mendi_oneaone]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mendi_oneaone]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mendi_oneaone]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_mendi_oneaone]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mendi_oneaone]": [
                "SELECT",
                "SELECT * INTO f_mendi_oneaone"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "f_nps_V2",
        "type": "Table",
        "start": 224248,
        "end": 226397,
        "code": "/****** Object:  Table [dbo].[f_nps_V2]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[f_nps_V2](\n\t[data_atualizacao_nps] [datetime] NULL,\n\t[data_atualizacao_mop] [date] NULL,\n\t[DataHora da Opini\u00e3o] [datetime] NOT NULL,\n\t[Hora da Opini\u00e3o] [time](7) NULL,\n\t[Data da Opini\u00e3o] [date] NULL,\n\t[Semana da Opini\u00e3o] [int] NULL,\n\t[M\u00eas da Opini\u00e3o] [date] NULL,\n\t[ID do Ticket/Protocolo] [int] NULL,\n\t[ID da Opini\u00e3o] [int] NOT NULL,\n\t[Tribo Serasa Original] [varchar](max) NULL,\n\t[Tribo Serasa Padronizada] [varchar](31) NOT NULL,\n\t[Tribo Completa Padronizada] [varchar](48) NOT NULL,\n\t[Login] [varchar](10) NULL,\n\t[ID Selecionar] [varchar](30) NULL,\n\t[Campanha] [varchar](max) NULL,\n\t[Motivos de Contato] [varchar](max) NULL,\n\t[Produto] [varchar](max) NULL,\n\t[Nota] [int] NULL,\n\t[Classifica\u00e7\u00e3o] [varchar](10) NOT NULL,\n\t[Coment\u00e1rio] [varchar](max) NULL,\n\t[DataHora de Resolu\u00e7\u00e3o do Ticket] [datetime] NULL,\n\t[Status] [varchar](25) NULL,\n\t[Status Vigente] [varchar](25) NULL,\n\t[Nome] [varchar](100) NULL,\n\t[Projeto] [varchar](17) NOT NULL,\n\t[Tribo Selecionar] [varchar](50) NULL,\n\t[Subtribo Selecionar] [varchar](50) NULL,\n\t[Escala] [varchar](15) NULL,\n\t[Supervis\u00e3o] [varchar](100) NULL,\n\t[Supervis\u00e3o Vigente] [varchar](100) NULL,\n\t[Coordena\u00e7\u00e3o] [varchar](100) NULL,\n\t[tribo_2clix] [varchar](17) NOT NULL,\n\t[Tempo de Resposta] [int] NULL,\n\t[AvaliacoesXAgentesXtriboXDia] [int] NULL,\n\t[AvaliacoesXAgentesXtriboXSemana] [int] NULL,\n\t[AvaliacoesXAgentesXtriboXMes] [int] NULL,\n\t[Grupo Tempo de Resposta] [varchar](16) NULL,\n\t[NPSxAgentexTriboSerasaxDia] [int] NULL,\n\t[NPSxAgentexTriboSerasaxSemana] [int] NULL,\n\t[NPSxAgentexTriboSerasaxM\u00eas] [int] NULL,\n\t[rank_nps_Dia] [bigint] NULL,\n\t[rank_nps_Semana] [bigint] NULL,\n\t[rank_nps_Mes] [bigint] NULL,\n\t[QuartilxAgentexTriboSerasaxDia] [varchar](14) NULL,\n\t[QuartilxAgentexTriboSerasaxSemana] [varchar](14) NULL,\n\t[QuartilxAgentexTriboSerasaxM\u00eas] [varchar](14) NULL,\n\t[quartil_simplesXDia] [varchar](14) NOT NULL,\n\t[quartil_simplesXSemana] [varchar](14) NOT NULL,\n\t[quartil_simplesXMes] [varchar](14) NOT NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 269,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_nps_V2]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_nps]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].f_nps_V2"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_nps_v2"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "UNKNOWN",
                "f_nps_v2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": [
                "CREATE",
                "CREATE TABLE [dbo].[f_nps_V2]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "UNKNOWN",
                "f_nps_v2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "SELECT",
                "SELECT * INTO f_nps_V2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[SP_NPS_LUCAS]": [
                "UNKNOWN",
                "f_nps_v2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT ON f_nps_v2"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_contatos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_contatos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "hist_dim_mop_contatos",
        "type": "Table",
        "start": 226397,
        "end": 227008,
        "code": "/****** Object:  Table [dbo].[hist_dim_mop_contatos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[hist_dim_mop_contatos](\n\t[id_alteracao] [int] NOT NULL,\n\t[datahora_alteracao] [datetime] NOT NULL,\n\t[usuario_responsavel] [varchar](100) NOT NULL,\n\t[resultado_alteracao] [varchar](500) NOT NULL,\n\t[tipo_alteracao] [varchar](10) NOT NULL,\n\t[ID_selecionar] [varchar](30) NOT NULL,\n\t[email_selecionar] [varchar](100) NULL,\n\t[email_experian] [varchar](100) NULL,\n\t[email_pessoal] [varchar](100) NULL,\n\t[telefone] [varchar](20) NULL\n) ON [PRIMARY]\nGO\n",
        "build_order": 270,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_contatos]": [
                "CREATE",
                "CREATE TABLE [dbo].[hist_dim_mop_contatos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_contatos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].hist_dim_mop_contatos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_contatos]": [
                "CREATE",
                "CREATE TABLE [dbo].[hist_dim_mop_contatos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_eventos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_eventos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "hist_dim_mop_eventos",
        "type": "Table",
        "start": 227008,
        "end": 228447,
        "code": "/****** Object:  Table [dbo].[hist_dim_mop_eventos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[hist_dim_mop_eventos](\n\t[alteracao_id] [int] NOT NULL,\n\t[alteracao_datahora] [datetime] NOT NULL,\n\t[alteracao_tipo] [varchar](10) NOT NULL,\n\t[alteracao_usuario] [varchar](50) NOT NULL,\n\t[alteracao_comando] [varchar](max) NOT NULL,\n\t[data_atualizacao] [datetime] NOT NULL,\n\t[ID_selecionar] [varchar](30) NOT NULL,\n\t[ID_unico] [varchar](30) NULL,\n\t[ID_secullum] [int] NULL,\n\t[ID_serasa] [varchar](10) NULL,\n\t[ID_intelix] [int] NULL,\n\t[ID_epbx] [int] NULL,\n\t[ID_genesys] [varchar](100) NULL,\n\t[status] [varchar](25) NOT NULL,\n\t[situacao] [varchar](25) NOT NULL,\n\t[condicao] [varchar](25) NOT NULL,\n\t[cliente] [varchar](50) NOT NULL,\n\t[projeto] [varchar](50) NOT NULL,\n\t[cargo] [varchar](50) NOT NULL,\n\t[tribo] [varchar](50) NOT NULL,\n\t[subtribo] [varchar](50) NOT NULL,\n\t[escala] [varchar](15) NOT NULL,\n\t[jornada] [time](7) NOT NULL,\n\t[taxa] [int] NOT NULL,\n\t[pausa_manha] [time](7) NULL,\n\t[pausa_almoco] [time](7) NULL,\n\t[pausa_tarde] [time](7) NULL,\n\t[supervisao] [varchar](100) NULL,\n\t[coordenacao] [varchar](100) NULL,\n\t[gerencia] [varchar](100) NULL,\n\t[diretoria] [varchar](100) NULL,\n\t[req] [varchar](100) NULL,\n\t[dma] [int] NULL,\n\t[instrutor] [varchar](100) NULL,\n\t[tipo_dma] [varchar](50) NULL,\n\t[fonte_log] [varchar](10) NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n",
        "build_order": 271,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[hist_dim_mop_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[h_d_mop_eventos]": [
                "SELECT",
                "SELECT * FROM [db_Serasa_producao].[dbo].hist_dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_eventos]": [
                "CREATE",
                "CREATE TABLE [dbo].[hist_dim_mop_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "DELETE",
                "DELETE FROM hist_dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON hist_dim_mop_eventos"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "s_att_genesys_eventos",
        "type": "StoredProcedure",
        "start": 228447,
        "end": 230040,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_genesys_eventos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_genesys_eventos] @genesys_usuario_id [VARCHAR](100), @genesys_pausa_id [VARCHAR](100), @datahora_inicio [DATETIMEOFFSET], @datahora_fim  [DATETIMEOFFSET] AS\n    MERGE d_genesys_eventos AS destino\n    USING (\n        SELECT\n             [genesys_usuario_id]   = @genesys_usuario_id\n            ,[genesys_pausa_id]     = @genesys_pausa_id\n            ,[datahora_inicio]      = CONVERT([DATETIME], @datahora_inicio AT TIME ZONE 'UTC' AT TIME ZONE 'Central Brazilian Standard Time')\n            ,[datahora_fim]         = IIF(@datahora_fim = CAST('1900-01-01 00:00:00' AS [DATETIMEOFFSET]), NULL, CONVERT([DATETIME], @datahora_fim AT TIME ZONE 'UTC' AT TIME ZONE 'Central Brazilian Standard Time'))\n    ) AS fonte\n    ON  destino.[genesys_usuario_id]    = fonte.[genesys_usuario_id]\n    AND destino.[genesys_pausa_id]      = fonte.[genesys_pausa_id]\n    AND destino.[datahora_inicio]       = fonte.[datahora_inicio]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([genesys_usuario_id], [genesys_pausa_id], [datahora_inicio], [datahora_fim])\n        VALUES(fonte.[genesys_usuario_id], fonte.[genesys_pausa_id], fonte.[datahora_inicio], fonte.[datahora_fim])\n    WHEN MATCHED AND (\n            COALESCE(destino.[datahora_fim], '1900-01-01 00:00:00')  <> COALESCE(fonte.[datahora_fim], '1900-01-01 00:00:00')\n    )\n    THEN\n        UPDATE SET\n            destino.[datahora_fim]      = fonte.[datahora_fim]\n    ;\n\nGO\n",
        "build_order": 272,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "s_att_genesys_pausas",
        "type": "StoredProcedure",
        "start": 230040,
        "end": 231218,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_genesys_pausas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_genesys_pausas] @genesys_pausa_id [VARCHAR](100), @tipo [VARCHAR](MAX), @presenca [VARCHAR](MAX), @nome [VARCHAR](MAX) AS\n    MERGE d_genesys_pausas AS destino\n    USING (\n        SELECT\n             [genesys_pausa_id]   = @genesys_pausa_id\n            ,[tipo]               = @tipo\n            ,[presenca]           = @presenca\n            ,[nome]               = @nome\n    ) AS fonte\n    ON  destino.[genesys_pausa_id] = fonte.[genesys_pausa_id]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([genesys_pausa_id], [tipo], [presenca], [nome])\n        VALUES(fonte.[genesys_pausa_id], fonte.[tipo], fonte.[presenca], fonte.[nome])\n    WHEN MATCHED AND (\n            destino.[tipo]      <> fonte.[tipo]\n        OR  destino.[presenca]  <> fonte.[presenca]\n        OR  destino.[nome]      <> fonte.[nome]\n    )\n    THEN\n        UPDATE SET\n             destino.[tipo]      = fonte.[tipo]\n            ,destino.[presenca]  = fonte.[presenca]\n            ,destino.[nome]      = fonte.[nome]\n    ;\n\nGO\n",
        "build_order": 273,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_pausas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_pausas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "s_att_genesys_usuarios",
        "type": "StoredProcedure",
        "start": 231218,
        "end": 232970,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_genesys_usuarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_genesys_usuarios] @genesys_usuario_id [VARCHAR](100), @nome [VARCHAR](MAX), @email [VARCHAR](MAX), @divisao [VARCHAR](MAX), @departamento [VARCHAR](MAX), @titulo [VARCHAR](MAX) AS\n    MERGE d_genesys_usuarios AS destino\n    USING (\n        SELECT\n             [genesys_usuario_id]   = @genesys_usuario_id\n            ,[nome]                 = @nome\n            ,[email]                = @email\n            ,[divisao]              = @divisao\n            ,[departamento]         = @departamento\n            ,[titulo]               = @titulo\n    ) AS fonte\n    ON  destino.[genesys_usuario_id] = fonte.[genesys_usuario_id]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([genesys_usuario_id], [nome], [email], [divisao], [departamento], [titulo])\n        VALUES(fonte.[genesys_usuario_id], fonte.[nome], fonte.[email], fonte.[divisao], fonte.[departamento], fonte.[titulo])\n    WHEN MATCHED AND (\n            destino.[nome]                   <> fonte.[nome]\n        OR  destino.[email]                  <> fonte.[email]\n        OR  destino.[divisao]                <> fonte.[divisao]\n        OR  COALESCE(destino.[departamento], '-') <> COALESCE(fonte.[departamento], '-')\n        OR  COALESCE(destino.[titulo], '-')       <> COALESCE(fonte.[titulo], '-')\n    )\n    THEN\n        UPDATE SET\n             destino.[nome]         = fonte.[nome]\n            ,destino.[email]        = fonte.[email]\n            ,destino.[divisao]      = fonte.[divisao]\n            ,destino.[departamento] = fonte.[departamento]\n            ,destino.[titulo]       = fonte.[titulo]\n    ;\n\nGO\n",
        "build_order": 274,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_genesys_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_genesys_usuarios]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "s_att_intelix_eventos",
        "type": "StoredProcedure",
        "start": 232970,
        "end": 234730,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_intelix_eventos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_intelix_eventos] @intelix_usuario_id [INT], @datahora_inicio [DATETIME], @datahora_fim [DATETIME], @nome_pausa[VARCHAR](MAX), @evento[VARCHAR](MAX), @complemento[VARCHAR](MAX) AS\n    MERGE d_intelix_eventos AS destino\n    USING (\n        SELECT\n             [intelix_usuario_id]   = @intelix_usuario_id\n            ,[evento]               = @evento\n            ,[nome_pausa]           = @nome_pausa\n            ,[datahora_inicio]      = @datahora_inicio\n            ,[datahora_fim]         = IIF(@datahora_fim = CAST('1900-01-01 00:00:00' AS [DATETIME]), NULL, @datahora_fim)\n            ,[complemento]          = @complemento\n    ) AS fonte\n    ON  destino.[intelix_usuario_id] = fonte.[intelix_usuario_id]\n    AND destino.[evento]             = fonte.[evento]\n    AND destino.[nome_pausa]         = fonte.[nome_pausa]\n    AND destino.[datahora_inicio]    = fonte.[datahora_inicio]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([intelix_usuario_id], [evento], [nome_pausa], [datahora_inicio], [datahora_fim], [complemento])\n        VALUES(fonte.[intelix_usuario_id], fonte.[evento], fonte.[nome_pausa], fonte.[datahora_inicio], fonte.[datahora_fim], fonte.[complemento])\n    WHEN MATCHED AND (\n            COALESCE(destino.[datahora_fim], '1900-01-01 00:00:00')  <> COALESCE(fonte.[datahora_fim], '1900-01-01 00:00:00')\n        OR  COALESCE(destino.[complemento], '-')   <> COALESCE(fonte.[complemento], '-')\n    )\n    THEN\n        UPDATE SET\n             destino.[datahora_fim]  = fonte.[datahora_fim]\n            ,destino.[complemento]   = fonte.[complemento]\n    ;\n\nGO\n",
        "build_order": 275,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_eventos]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_eventos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "s_att_intelix_usuarios",
        "type": "StoredProcedure",
        "start": 234730,
        "end": 235491,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_intelix_usuarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_intelix_usuarios] @intelix_usuario_id [INT], @nome [VARCHAR](MAX) AS\n    MERGE d_intelix_usuarios AS destino\n    USING (\n        SELECT\n             [intelix_usuario_id] = @intelix_usuario_id\n            ,[nome] = @nome\n    ) AS fonte\n    ON destino.[intelix_usuario_id] = fonte.[intelix_usuario_id]\n    WHEN NOT MATCHED\n    THEN\n        INSERT([intelix_usuario_id], [nome])\n        VALUES(fonte.[intelix_usuario_id], fonte.[nome])\n    WHEN MATCHED\n        AND destino.[nome] <> fonte.[nome]\n    THEN\n        UPDATE SET\n            destino.[nome] = fonte.[nome]\n    ;\n\nGO\n",
        "build_order": 276,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_usuarios]": [
                "UNKNOWN",
                "d_intelix_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_intelix_usuarios]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_intelix_usuarios]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "s_att_log",
        "type": "StoredProcedure",
        "start": 235491,
        "end": 241547,
        "code": "/****** Object:  StoredProcedure [dbo].[s_att_log]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_att_log] @fonte [VARCHAR](50) = NULL AS\n    DECLARE @null_logoff DATETIME = GETDATE()\n\n\tIF @fonte IS NULL OR @fonte='INTELIX' BEGIN\n\t\tPRINT 'INTELIX';\n\t\tWITH destino AS (\n\t\t\tSELECT * FROM [f_log]\n\t\t\tWHERE\t[Fonte]\t = 'INTELIX'\n\t\t)\n\t\tMERGE INTO destino USING (\n\t\t\tSELECT\n\t\t\t\t [Fonte]\t\t\t= 'INTELIX'\n\t\t\t\t,[ID Selecionar]\t= MAX([ID Selecionar])\n\t\t\t\t,[ID Intelix]\t\t= [intelix_usuario_id]\n\t\t\t\t,[ID Genesys]\t\t= NULL\n\t\t\t\t,[Evento]\t\t\t= [evento]\n\t\t\t\t,[In\u00edcio]\t\t\t= [datahora_inicio]\n\t\t\t\t,[Fim]\t\t\t\t= MAX([datahora_fim])\n\t\t\t\t,[Dura\u00e7\u00e3o]\t\t\t= DATEDIFF_BIG(s, [datahora_inicio], MAX([datahora_fim]))\n\t\t\tFROM (\n\t\t\t\tSELECT\n\t\t\t\t\t [intelix_usuario_id]\n\t\t\t\t\t,[evento] = IIF([evento] = 'Pausa', CONCAT('Pausa (',[nome_pausa],')'), [evento])\n\t\t\t\t\t,[datahora_inicio]\n\t\t\t\t\t,[datahora_fim] = CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END\n\t\t\t\tFROM d_intelix_eventos\n\t\t\t\tWHERE evento <> 'Login'\n\t\t\t\tUNION ALL\n\t\t\t\tSELECT [intelix_usuario_id] = p.[intelix_usuario_id]\n\t\t\t\t\t  ,[evento]\t= 'Login'\n\t\t\t\t\t  ,[inicio]\t= CASE WHEN LAG(p.[datahora_inicio]) OVER (PARTITION BY loginid ORDER BY p.rowid) IS NULL THEN l.[datahora_inicio] ELSE p.[datahora_fim] END\n\t\t\t\t\t  ,[fim]\t= CASE WHEN LEAD(p.[datahora_inicio]) OVER (PARTITION BY loginid ORDER BY p.rowid) IS NULL\n\t\t\t\t\t\t\t\t\t\tTHEN MAX(p.[datahora_fim]) OVER (PARTITION BY loginid)\n\t\t\t\t\t\t\t\t\t\tELSE LEAD(p.[datahora_inicio]) OVER (PARTITION BY loginid ORDER BY p.rowid) END\n\t\t\t\tFROM (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t [intelix_usuario_id]\n\t\t\t\t\t\t,[evento] = IIF([evento] = 'Pausa', CONCAT('Pausa (',[nome_pausa],')'), [evento])\n\t\t\t\t\t\t,[datahora_inicio]\n\t\t\t\t\t\t,[datahora_fim]   = CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END\n\t\t\t\t\t\t,[rowid] = ROW_NUMBER() OVER (ORDER BY [intelix_usuario_id], [datahora_inicio], CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END DESC)\n\t\t\t\t\tFROM d_intelix_eventos\n\t\t\t\t) p\n\t\t\t\tRIGHT JOIN (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t [intelix_usuario_id]\n\t\t\t\t\t\t,[datahora_inicio]\n\t\t\t\t\t\t,[datahora_fim] = CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END\n\t\t\t\t\t\t,[loginid] =  ROW_NUMBER() OVER (ORDER BY [intelix_usuario_id], [datahora_inicio], CASE WHEN [datahora_fim] IS NULL THEN @null_logoff ELSE [datahora_fim] END)\n\t\t\t\t\tFROM d_intelix_eventos\n\t\t\t\t\tWHERE\tevento = 'Login'\n\t\t\t\t) l\n\t\t\t\tON p.[intelix_usuario_id] = l.[intelix_usuario_id]\n\t\t\t\tAND p.[datahora_inicio] >= l.[datahora_inicio]\n\t\t\t\tAND (p.[datahora_fim] <= l.[datahora_fim]\n\t\t\t\t\tOR (l.[datahora_fim] IS NULL\n\t\t\t\t\t\tAND CAST(p.[datahora_inicio] as date) = CAST(l.[datahora_inicio] as date)))\n\t\t\t) _\n\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].f_mop_historico\n\t\t\tON\t[intelix_usuario_id] = [ID Intelix]\n\t\t\tAND\t[Data da Atualiza\u00e7\u00e3o] = CAST([datahora_inicio] AS date)\n\t\t\tWHERE DATEDIFF_BIG(s, [datahora_inicio], [datahora_fim]) <> 0\n            GROUP BY [intelix_usuario_id],[Evento],[datahora_inicio]\n\t\t) AS fonte\n\t\tON  destino.[Fonte]\t\t\t=\tfonte.[Fonte]\n\t\tAND destino.[ID Intelix]\t=\tfonte.[ID Intelix]\n\t\tAND destino.[ID Genesys]\tIS\tNULL\n\t\tAND destino.[Evento]\t\t=\tfonte.[Evento]\n\t\tAND destino.[In\u00edcio]\t\t=\tfonte.[In\u00edcio]\n\n\t\tWHEN NOT MATCHED BY TARGET\n\t\tTHEN\n\t\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID Genesys], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o])\n\t\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID Genesys], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o])\n\n\t\tWHEN MATCHED AND(\n\t\t\t\tCOALESCE(destino.[ID Selecionar], '-')\t<>\tCOALESCE(fonte.[ID Selecionar], '-')\n\t\t\tOR\tCOALESCE(destino.[Fim], '1900-01-01')\t<>\tCOALESCE(fonte.[Fim], '1900-01-01')\n\t\t)\n\t\tTHEN UPDATE SET\n\t\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t\t,destino.[Fim]\t\t\t\t=\tfonte.[Fim]\n\t\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n\t\t;\n\t\t--OUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\tEND\n\n\tIF @fonte IS NULL OR @fonte='GENESYS' BEGIN\n\t\tPRINT 'GENESYS';\n\t\tWITH destino AS (\n\t\t\tSELECT * FROM [f_log]\n\t\t\tWHERE\t[Fonte]\t = 'GENESYS'\n\t\t)\n\t\tMERGE INTO destino USING (\n\t\t\tSELECT DISTINCT\n\t\t\t\t [Fonte]\t\t\t=\t'GENESYS'\n\t\t\t\t,[ID Selecionar]\t=\tm.[ID Selecionar]\n\t\t\t\t,[ID Intelix]\t\t=\tNULL\n\t\t\t\t,[ID Genesys]\t\t=\te.[genesys_usuario_id]\n\t\t\t\t,[Evento]\t\t\t=\tp.[nome]\n\t\t\t\t,[In\u00edcio]\t\t\t=\te.[datahora_inicio]\n\t\t\t\t,[Fim]\t\t\t\t=\tIIF(e.[datahora_fim] IS NULL, @null_logoff, e.[datahora_fim])\n\t\t\t\t,[Dura\u00e7\u00e3o]\t\t\t=\tDATEDIFF_BIG(ms, e.[datahora_inicio], IIF(e.[datahora_fim] IS NULL, @null_logoff, e.[datahora_fim])) / 1000.0\n\t\t\tFROM d_genesys_eventos e\n\t\t\tLEFT JOIN d_genesys_usuarios u\n\t\t\t\tON e.[genesys_usuario_id] = u.[genesys_usuario_id]\n\t\t\tLEFT JOIN d_genesys_pausas p\n\t\t\t\tON e.[genesys_pausa_id] = p.[genesys_pausa_id]\n\t\t\tLEFT JOIN [db_Serasa_producao].[dbo].f_mop_historico m\n\t\t\t\tON e.[genesys_usuario_id] = m.[ID Genesys]\n\t\t\t\tAND CAST(e.[datahora_inicio] AS date) = m.[Data da Atualiza\u00e7\u00e3o]\n\t\t\tWHERE p.[nome] <> 'Offline'\n\n\n\t\t) AS fonte\n\t\tON  destino.[Fonte]\t\t\t=\tfonte.[Fonte]\n\t\tAND destino.[ID Intelix]\tIS\tNULL\n\t\tAND destino.[ID Genesys]\t=\tfonte.[ID Genesys]\n\t\tAND destino.[Evento]\t\t=\tfonte.[Evento]\n\t\tAND destino.[In\u00edcio]\t\t=\tfonte.[In\u00edcio]\n\n\t\tWHEN NOT MATCHED BY TARGET\n\t\tTHEN\n\t\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID Genesys], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o])\n\t\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID Genesys], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o])\n\n\t\tWHEN MATCHED AND(\n\t\t\t\tCOALESCE(destino.[ID Selecionar], '-')\t<>\tCOALESCE(fonte.[ID Selecionar], '-')\n\t\t\tOR\tCOALESCE(destino.[Fim], '1900-01-01')\t<>\tCOALESCE(fonte.[Fim], '1900-01-01')\n\t\t)\n\t\tTHEN UPDATE SET\n\t\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t\t,destino.[Fim]\t\t\t\t=\tfonte.[Fim]\n\t\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n\t\t;\n\t\t--OUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\tEND\n\nGO\n",
        "build_order": 277,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "UNKNOWN",
                "d_genesys_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_pausas]": [
                "UNKNOWN",
                "d_genesys_pausas"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_usuarios]": [
                "UNKNOWN",
                "d_genesys_usuarios"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "UNKNOWN",
                "d_intelix_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM [f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_att_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_att_log]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[s_log]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[s_log]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "s_log",
        "type": "StoredProcedure",
        "start": 241547,
        "end": 241749,
        "code": "/****** Object:  StoredProcedure [dbo].[s_log]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[s_log] AS\n\nSELECT * FROM f_log\n\n\nGO\n",
        "build_order": 278,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM f_log"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "SELECT",
                "SELECT * FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_log]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_log]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_log]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[s_log_fontea]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[s_log_fontea]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "s_log_fontea",
        "type": "StoredProcedure",
        "start": 241749,
        "end": 243364,
        "code": "/****** Object:  StoredProcedure [dbo].[s_log_fontea]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   PROCEDURE [dbo].[s_log_fontea] AS\n\nDECLARE @contador INT = 1;\nDECLARE @minimo VARCHAR(10);\nDECLARE @id_brother VARCHAR(10);\nDECLARE @data_inicio DATETIME \nDECLARE @data_fim DATETIME  \nDECLARE @data_limite DATETIME = '20/07/2024 23:59';\nDECLARE @duracao INT;\n\n\nWHILE @contador <= 250\nBEGIN\n\tSET @minimo = CAST(FLOOR(RAND() * 1000) AS VARCHAR(10))\n\tSET @id_brother = CONCAT('C', LEFT('000000',6-LEN(@minimo)),@minimo, 'A')\n\tSET @data_inicio = '01/07/2024 08:00'\n\n\n\tWHILE @data_inicio <= @data_limite\n\tBEGIN\n\n\t\tSET @duracao = (ABS(CHECKSUM(NEWID())) % 300) + 0\n\t\tSET @data_fim = DATEADD(MINUTE,@duracao, @data_inicio)\n\n\t\tINSERT INTO d_log_fontea VALUES (@id_brother,'log',@data_inicio, @data_fim)\n\n\t\tSET @duracao = (ABS(CHECKSUM(NEWID())) % 60) + 0\n\t\tSET @data_inicio = @data_fim\n\t\tSET @data_fim = DATEADD(MINUTE,@duracao, @data_inicio)\n\n\t\tINSERT INTO d_log_fontea VALUES (@id_brother,'pausa almo\u00e7o', @data_inicio, @data_fim)\n\n\t\tSET @duracao = (ABS(CHECKSUM(NEWID())) % 300) + 0\n\t\tSET @data_inicio = @data_fim\n\t\tSET @data_fim = DATEADD(MINUTE,@duracao, @data_inicio)\n\n\t\tINSERT INTO d_log_fontea VALUES (@id_brother,'log', @data_inicio, @data_fim)\n\t\n\t\n\tSET @data_inicio = DATETIMEFROMPARTS ( YEAR(@data_fim) , month(@data_fim) , day(@data_fim) , 8 , 0 , 0 , 0 ) \n\n\tIF DATEPART(WEEKDAY, @data_inicio) = 6  SET @data_inicio = DATEADD(DAY, 3, @data_inicio); \n\t\tELSE  SET @data_inicio = DATEADD(DAY, 1, @data_inicio);\n\n\tEND\n\n\n\nSET @contador = @contador +1\nEND\n\n\n\nGO\n",
        "build_order": 279,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_log_fontea]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_log_fontea]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_log_fontea]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_log_fontea]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[s_log_fonteb]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[s_log_fonteb]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "s_log_fonteb",
        "type": "StoredProcedure",
        "start": 243364,
        "end": 244979,
        "code": "/****** Object:  StoredProcedure [dbo].[s_log_fonteb]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   PROCEDURE [dbo].[s_log_fonteb] AS\n\nDECLARE @contador INT = 1;\nDECLARE @minimo VARCHAR(10);\nDECLARE @id_brother VARCHAR(10);\nDECLARE @data_inicio DATETIME \nDECLARE @data_fim DATETIME  \nDECLARE @data_limite DATETIME = '20/07/2024 23:59';\nDECLARE @duracao INT;\n\n\nWHILE @contador <= 250\nBEGIN\n\tSET @minimo = CAST(FLOOR(RAND() * 1000) AS VARCHAR(10))\n\tSET @id_brother = CONCAT('C', LEFT('000000',6-LEN(@minimo)),@minimo, 'A')\n\tSET @data_inicio = '01/07/2024 08:00'\n\n\n\tWHILE @data_inicio <= @data_limite\n\tBEGIN\n\n\t\tSET @duracao = (ABS(CHECKSUM(NEWID())) % 180) + 0\n\t\tSET @data_fim = DATEADD(MINUTE,@duracao, @data_inicio)\n\n\t\tINSERT INTO d_log_fonteb VALUES (@id_brother,'log',@data_inicio, @data_fim)\n\n\t\tSET @duracao = (ABS(CHECKSUM(NEWID())) % 20) + 0\n\t\tSET @data_inicio = @data_fim\n\t\tSET @data_fim = DATEADD(MINUTE,@duracao, @data_inicio)\n\n\t\tINSERT INTO d_log_fonteb VALUES (@id_brother,'pausa lanche', @data_inicio, @data_fim)\n\n\t\tSET @duracao = (ABS(CHECKSUM(NEWID())) % 180) + 0\n\t\tSET @data_inicio = @data_fim\n\t\tSET @data_fim = DATEADD(MINUTE,@duracao, @data_inicio)\n\n\t\tINSERT INTO d_log_fonteb VALUES (@id_brother,'log', @data_inicio, @data_fim)\n\t\n\t\n\tSET @data_inicio = DATETIMEFROMPARTS ( YEAR(@data_fim) , month(@data_fim) , day(@data_fim) , 8 , 0 , 0 , 0 ) \n\n\tIF DATEPART(WEEKDAY, @data_inicio) = 6  SET @data_inicio = DATEADD(DAY, 3, @data_inicio); \n\t\tELSE  SET @data_inicio = DATEADD(DAY, 1, @data_inicio);\n\n\tEND\n\n\n\nSET @contador = @contador +1\nEND\n\n\n\nGO\n",
        "build_order": 280,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_log_fonteb]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_log_fonteb]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[s_log_fonteb]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[s_log_fonteb]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod1]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod1]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_2clix_analiticosAvaliacoes_cod1",
        "type": "StoredProcedure",
        "start": 244979,
        "end": 245976,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_2clix_analiticosAvaliacoes_cod1]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\nCREATE             PROCEDURE [dbo].[sp_2clix_analiticosAvaliacoes_cod1] AS\n\nset dateformat dmy;\n\n\nDELETE FROM dim_2clix_analiticosAvaliacoes_cod1\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tCAST(dim_2clix_analiticosAvaliacoes_cod1.[codigo] AS INT) = CAST(#temp0.[CODIGO_AVALIACAO] AS INT)\n\tOR dim_2clix_analiticosAvaliacoes_cod1.[codigo] IS NULL\n\t\n)\n\n\n\nINSERT INTO dim_2clix_analiticosAvaliacoes_cod1 \nSELECT * FROM #temp0\nWHERE #temp0.[CODIGO_AVALIACAO] IS NOT NULL\n\n\n\nDELETE FROM f_2clix_analiticosAvaliacoes_cod1\nINSERT INTO f_2clix_analiticosAvaliacoes_cod1 SELECT * FROM vw_2clix_analiticosAvaliacoes_cod1\n\n\nUPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([avaliado_em]) from dim_2clix_analiticosAvaliacoes_cod1) \nWHERE [table] = 'f_2clix_analiticosAvaliacoes_cod1'\n\n\n\n\nGO\n",
        "build_order": 281,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "UNKNOWN",
                "f_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([avaliado_em]) from dim_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod1]": [
                "INSERT",
                "INSERT INTO f_2clix_analiticosAvaliacoes_cod1 SELECT * FROM vw_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod1]": [
                "UNKNOWN",
                "f_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_2clix_analiticosAvaliacoes_cod1]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod1]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_2clix_analiticosAvaliacoes_cod1]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod3]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod3]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_2clix_analiticosAvaliacoes_cod3",
        "type": "StoredProcedure",
        "start": 245976,
        "end": 248449,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_2clix_analiticosAvaliacoes_cod3]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\n\n\n\nCREATE           PROCEDURE [dbo].[sp_2clix_analiticosAvaliacoes_cod3] AS\n\nset dateformat dmy;\n\n\n\nDELETE FROM dim_2clix_analiticosAvaliacoes_cod3\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tCAST(dim_2clix_analiticosAvaliacoes_cod3.[codigo] AS INT) = CAST(#temp0.[CODIGO_AVALIACAO] AS INT)\n\tOR dim_2clix_analiticosAvaliacoes_cod3.[codigo] IS NULL\n)\n\n\n\nINSERT INTO dim_2clix_analiticosAvaliacoes_cod3 \nSELECT \n\t[CODIGO_AVALIACAO],\n\t[NEGOCIO],\n\t[CAMPANHA],\n\t[AVALIADO],\n\t[SUPERIOR],\n\t[DATA_AVALIACAO],\n\t[TIPO_AVALIACAO],\n\t[DEPARTAMENTO],\n\t[AVALIADOR],\n\t[PROCESSO],\n\t[CODIGO_GRAVACAO],\n\t[TEMPO_AVALIACAO],\n\t[NOTA],\n\t[DATA_FEEDBACK],\n\t[RESULTADO_FEEDBACK],\n\t[RESPONSAVEL_FEEDBACK],\n\t[OBS_RESPONSAVEL_FEEDBACK],\n\t[OBS_AVALIADO],\n\t[TABULACAO],\n\t[NOTA_SEM_NCG],\n\t[VISUALIZACAO_AVALIADO],\n\t[PESQUISA_AVALIADO],\n\t[LOGIN_AVALIADO],\n\t[DATA_ADMISSAO_AVALIADO],\n\t[DATA_INICIO_SETOR],\n\t[CODIGO_EXTERNO],\n\t[STATUS_FEEDBACK],\n\t[TEMPO_FEEDBACK],\n\t[FORMULARIO],\n\t[CODIGO_GRAVADOR],\n\t[CODIGO_INTEGRACAO],\n\t[DATA_CONTATO],\n\t[Atendimento Realizado dentro do SLA],\n\t[Causa Raiz],\n\t[Classifica\u00e7\u00e3o da Tratativa],\n\t[Coment\u00e1rio],\n\t[Data/Hora da Opini\u00e3o],\n\t[Ilha],\n\tTRY_CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([Nota Avalia\u00e7\u00e3o], '.', ''), '#', ''), '-', ''), '*', ''), ' ', '') AS bigint),\n\tTRY_CAST(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE([N\u00famero do Ticket], '.', ''), '#', ''), '-', ''), '*', ''), ' ', '') AS bigint),\n\t[Parceiros],\n\t[Ponto de Oportunidade],\n\t[Produto Identificado],\n\t[Tema Pedido],\n\t[Tema Resposta],\n\t[PERIODO],\n\t[PONTOS_POSITIVOS],\n\t[PONTOS_MELHORAR],\n\t[QTD_ARQUIVOS],\n\t[MATRICULA],\n\t[OBSERVACAO],\n\t[EMAIL_AVALIADO],\n\t[TICKET],\n\t[ACIMA_META],\n\t[UNIDADE],\n\t[STATUS_USUARIO],\n\t[SEGUNDO_SUPERIOR],\n\t[TERCEIRO_SUPERIOR],\n\t[Tipo de auditoria],\n\t[An\u00e1lise]\n\nFROM #temp0\nWHERE #temp0.[CODIGO_AVALIACAO] IS NOT NULL\n\n\n\n\nDELETE FROM f_2clix_analiticosAvaliacoes_cod3\nINSERT INTO f_2clix_analiticosAvaliacoes_cod3 SELECT * FROM vw_2clix_analiticosAvaliacoes_cod3\n--DROP TABLE f_2clix_analiticosAvaliacoes_cod3; SELECT * INTO f_2clix_analiticosAvaliacoes_cod3 FROM vw_2clix_analiticosAvaliacoes_cod3\n\n\nUPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([data_avaliacao]) from f_2clix_analiticosAvaliacoes_cod3) \nWHERE [table] = 'f_2clix_analiticosAvaliacoes_cod3'\n\n\n\nGO\n",
        "build_order": 282,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "UNKNOWN",
                "f_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod3]": [
                "INSERT",
                "INSERT INTO dim_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_analiticosAvaliacoes_cod3]": [
                "DROP",
                "DROP TABLE f_2clix_analiticosAvaliacoes_cod3; SELECT * INTO f_2clix_analiticosAvaliacoes_cod3 FROM vw_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_analiticosAvaliacoes_cod3]": [
                "UNKNOWN",
                "f_2clix_analiticosAvaliacoes_cod3"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_2clix_analiticosAvaliacoes_cod3]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_analiticosAvaliacoes_cod3]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_2clix_analiticosAvaliacoes_cod3]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_extracaoBaseResumida_cod1]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_extracaoBaseResumida_cod1]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_2clix_extracaoBaseResumida_cod1",
        "type": "StoredProcedure",
        "start": 248449,
        "end": 249586,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_2clix_extracaoBaseResumida_cod1]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\nCREATE             PROCEDURE [dbo].[sp_2clix_extracaoBaseResumida_cod1] AS\n\nset dateformat dmy;\n\n\nDELETE FROM dim_2clix_extracaoBaseResumida_cod1\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tCAST(dim_2clix_extracaoBaseResumida_cod1.[codigo] AS INT) = CAST(#temp0.[CODIGO_AVALIACAO] AS INT)\n\tOR dim_2clix_extracaoBaseResumida_cod1.[codigo] IS NULL\n\n\t\n)\n\n\nINSERT INTO dim_2clix_extracaoBaseResumida_cod1\nSELECT * FROM #temp0\nWHERE #temp0.[CODIGO_AVALIACAO] IS NOT NULL\n\n\n\n\nDELETE FROM f_2clix_extracaoBaseResumida_cod1\nINSERT INTO f_2clix_extracaoBaseResumida_cod1 SELECT * FROM vw_2clix_extracaoBaseResumida_cod1\n--DROP TABLE f_2clix_extracaoBaseResumida_cod1; SELECT * INTO f_2clix_extracaoBaseResumida_cod1 FROM vw_2clix_extracaoBaseResumida_cod1\n\n\nUPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([data_avaliacao]) from dim_2clix_extracaoBaseResumida_cod1) \nWHERE [table] = 'dim_2clix_extracaoBaseResumida_cod1'\n\n\n\nGO\n",
        "build_order": 283,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * INTO f_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_extracaoBaseResumida_cod1]": [
                "UNKNOWN",
                "dim_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_extracaoBaseResumida_cod1]": [
                "DROP",
                "DROP TABLE f_2clix_extracaoBaseResumida_cod1; SELECT * INTO f_2clix_extracaoBaseResumida_cod1 FROM vw_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_extracaoBaseResumida_cod1]": [
                "SELECT",
                "SELECT * INTO f_2clix_extracaoBaseResumida_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_2clix_extracaoBaseResumida_cod1]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_extracaoBaseResumida_cod1]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_2clix_extracaoBaseResumida_cod1]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_ExtracaoUsuariosCampanha]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_ExtracaoUsuariosCampanha]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_2clix_ExtracaoUsuariosCampanha",
        "type": "StoredProcedure",
        "start": 249586,
        "end": 250604,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_2clix_ExtracaoUsuariosCampanha]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\nCREATE            PROCEDURE [dbo].[sp_2clix_ExtracaoUsuariosCampanha] AS\n\nset dateformat dmy;\n\nDELETE FROM dim_2clix_ExtracaoUsuariosCampanha\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tCAST(dim_2clix_ExtracaoUsuariosCampanha.[cod_usuario] AS INT) = CAST(#temp0.[cod_usuario] AS INT)\n\t\n)\n\nINSERT INTO dim_2clix_ExtracaoUsuariosCampanha\nSELECT * FROM #temp0\n\n\n\nDELETE FROM f_2clix_ExtracaoUsuariosCampanha\nINSERT INTO f_2clix_ExtracaoUsuariosCampanha SELECT * FROM vw_2clix_ExtracaoUsuariosCampanha\n--DROP TABLE f_2clix_ExtracaoUsuariosCampanha; SELECT * INTO f_2clix_ExtracaoUsuariosCampanha FROM vw_2clix_ExtracaoUsuariosCampanha\n\n\n\nUPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([ultimo_acesso]) from dim_2clix_ExtracaoUsuariosCampanha) \nWHERE [table] = 'dim_2clix_ExtracaoUsuariosCampanha'\n\n\n\nGO\n",
        "build_order": 284,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * INTO f_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_ExtracaoUsuariosCampanha]": [
                "UNKNOWN",
                "dim_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_2clix_ExtracaoUsuariosCampanha]": [
                "DROP",
                "DROP TABLE f_2clix_ExtracaoUsuariosCampanha; SELECT * INTO f_2clix_ExtracaoUsuariosCampanha FROM vw_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_2clix_ExtracaoUsuariosCampanha]": [
                "SELECT",
                "SELECT * INTO f_2clix_ExtracaoUsuariosCampanha"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE            PROCEDURE [dbo].[sp_2clix_ExtracaoUsuariosCampanha]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_ExtracaoUsuariosCampanha]": [
                "CREATE",
                "CREATE            PROCEDURE [dbo].[sp_2clix_ExtracaoUsuariosCampanha]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_treinamentos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_treinamentos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_2clix_treinamentos",
        "type": "StoredProcedure",
        "start": 250604,
        "end": 254583,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_2clix_treinamentos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE         PROCEDURE [dbo].[sp_2clix_treinamentos] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\t\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_2clix_treinamentos' and xtype='U')\n\tBEGIN\t \n\t\tCREATE TABLE [dbo].[dim_2clix_treinamentos] (\n\t\t\t [codigo]\t\t\t\tINT\t\t\t\tNOT NULL\n\t\t\t,[avaliado]\t\t\t\tVARCHAR(100)\tNOT NULL\n\t\t\t,[id_avaliado]\t\t\tVARCHAR(25)\t\tNOT NULL\n\t\t\t,[campanhas]\t\t\tVARCHAR(500)\tNOT NULL\n\t\t\t,[status]\t\t\t\tVARCHAR(50)\t\tNOT NULL\n\t\t\t,[responsavel]\t\t\tVARCHAR(100)\tNOT NULL\n\t\t\t,[motivo]\t\t\t\tVARCHAR(50)\t\tNOT NULL\n\t\t\t,[formato]\t\t\t\tVARCHAR(50)\t\tNOT NULL\n\t\t\t,[tipo]\t\t\t\t\tVARCHAR(50)\t\tNOT NULL\n\t\t\t,[periodo]\t\t\t\tVARCHAR(50)\t\tNOT NULL\n\t\t\t,[superior]\t\t\t\tVARCHAR(100)\tNOT NULL\n\t\t\t,[titulo]\t\t\t\tVARCHAR(250)\tNOT NULL\n\t\t\t,[reunioes_previstas]\tINT\t\t\t\tNOT NULL\n\t\t\t,[reunioes_realizadas]\tINT\t\t\t\tNOT NULL\n\t\t\t,[presencas]\t\t\tINT\t\t\t\tNOT NULL\n\t\t\t,[absenteismo]\t\t\tFLOAT\t\t\tNULL\n\t\t\t,[questionarios]\t\tINT\t\t\t\tNOT NULL\n\t\t\t,[pontuacao]\t\t\tFLOAT\t\t\tNULL\n\t\t\t,[duracao_estimada]\t\tTIME\t\t\tNOT NULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_2clix_treinamentos]\n\t\tWHERE codigo IN (SELECT DISTINCT [C\u00d3DIGO] FROM #temp0)\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\n\t\t\t [codigo]\t\t\t\t= [C\u00d3DIGO]\n\t\t\t,[avaliado]\t\t\t\t= [AVALIADO]\n\t\t\t,[id_avaliado]\t\t\t= [LOGIN]\n\t\t\t,[campanhas]\t\t\t= [CLIENTE E CAMPANHAS]\n\t\t\t,[status]\t\t\t\t= [STATUS]\n\t\t\t,[responsavel]\t\t\t= [RESPONS\u00c1VEL]\n\t\t\t,[motivo]\t\t\t\t= [MOTIVO]\n\t\t\t,[formato]\t\t\t\t= [FORMATO]\n\t\t\t,[tipo]\t\t\t\t\t= [TIPO DE REUNI\u00c3O]\n\t\t\t,[periodo]\t\t\t\t= [PER\u00cdODO DE REUNI\u00d5ES]\n\t\t\t,[superior]\t\t\t\t= [SUPERIOR]\n\t\t\t,[titulo]\t\t\t\t= [REUNI\u00d5ES]\n\t\t\t,[reunioes_previstas]\t= [REUNI\u00d5ES PREVISTAS]\n\t\t\t,[reunioes_realizadas]\t= [REUNI\u00d5ES REALIZADAS]\n\t\t\t,[presencas]\t\t\t= [PRESEN\u00c7AS]\n\t\t\t,[absenteismo]\t\t\t= TRY_CAST(REPLACE([ABSENTE\u00cdSMO],',','.') AS float)\n\t\t\t,[questionarios]\t\t= [QUESTION\u00c1RIOS P\u00d3S-REUNI\u00d5ES]\n\t\t\t,[pontuacao]\t\t\t= TRY_CAST(REPLACE([PONTUA\u00c7\u00c3O],',','.') AS float)\n\t\t\t,[duracao_estimada]\t\t= [DURA\u00c7\u00c3O ESTIMADA]\n\t\tFROM #temp0\n\t\tWHERE [LOGIN] IS NOT NULL\n\t)AS fonte\n\tON  fonte.[codigo] = destino.[codigo]\n\tAND fonte.[titulo] = destino.[titulo]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ( \n\t\t\t [codigo]\n\t\t\t,[avaliado]\n\t\t\t,[id_avaliado]\n\t\t\t,[campanhas]\n\t\t\t,[status]\n\t\t\t,[responsavel]\n\t\t\t,[motivo]\n\t\t\t,[formato]\n\t\t\t,[tipo]\n\t\t\t,[periodo]\n\t\t\t,[superior]\n\t\t\t,[titulo]\n\t\t\t,[reunioes_previstas]\n\t\t\t,[reunioes_realizadas]\n\t\t\t,[presencas]\n\t\t\t,[absenteismo]\n\t\t\t,[questionarios]\n\t\t\t,[pontuacao]\n\t\t\t,[duracao_estimada]) \n\t\tVALUES (\n\t\t\t fonte.[codigo]\n\t\t\t,fonte.[avaliado]\n\t\t\t,fonte.[id_avaliado]\n\t\t\t,fonte.[campanhas]\n\t\t\t,fonte.[status]\n\t\t\t,fonte.[responsavel]\n\t\t\t,fonte.[motivo]\n\t\t\t,fonte.[formato]\n\t\t\t,fonte.[tipo]\n\t\t\t,fonte.[periodo]\n\t\t\t,fonte.[superior]\n\t\t\t,fonte.[titulo]\n\t\t\t,fonte.[reunioes_previstas]\n\t\t\t,fonte.[reunioes_realizadas]\n\t\t\t,fonte.[presencas]\n\t\t\t,fonte.[absenteismo]\n\t\t\t,fonte.[questionarios]\n\t\t\t,fonte.[pontuacao]\n\t\t\t,fonte.[duracao_estimada])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t destino.[codigo]\t\t\t\t= fonte.[codigo]\n\t\t\t,destino.[avaliado]\t\t\t\t= fonte.[avaliado]\n\t\t\t,destino.[id_avaliado]\t\t\t= fonte.[id_avaliado]\n\t\t\t,destino.[campanhas]\t\t\t= fonte.[campanhas]\n\t\t\t,destino.[status]\t\t\t\t= fonte.[status]\n\t\t\t,destino.[responsavel]\t\t\t= fonte.[responsavel]\n\t\t\t,destino.[motivo]\t\t\t\t= fonte.[motivo]\n\t\t\t,destino.[formato]\t\t\t\t= fonte.[formato]\n\t\t\t,destino.[tipo]\t\t\t\t\t= fonte.[tipo]\n\t\t\t,destino.[periodo]\t\t\t\t= fonte.[periodo]\n\t\t\t,destino.[superior]\t\t\t\t= fonte.[superior]\n\t\t\t,destino.[titulo]\t\t\t\t= fonte.[titulo]\n\t\t\t,destino.[reunioes_previstas]\t= fonte.[reunioes_previstas]\n\t\t\t,destino.[reunioes_realizadas]\t= fonte.[reunioes_realizadas]\n\t\t\t,destino.[presencas]\t\t\t= fonte.[presencas]\n\t\t\t,destino.[absenteismo]\t\t\t= fonte.[absenteismo]\n\t\t\t,destino.[questionarios]\t\t= fonte.[questionarios]\n\t\t\t,destino.[pontuacao]\t\t\t= fonte.[pontuacao]\n\t\t\t,destino.[duracao_estimada]\t\t= fonte.[duracao_estimada]\n    ;\n\nGO\n",
        "build_order": 285,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos]": [
                "SELECT",
                "SELECT * FROM [dim_2clix_treinamentos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_treinamentos]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_2clix_treinamentos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_treinamentos]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_2clix_treinamentos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_usuarioReuniao]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_usuarioReuniao]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_2clix_usuarioReuniao",
        "type": "StoredProcedure",
        "start": 254583,
        "end": 257168,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_2clix_usuarioReuniao]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\n\nCREATE             PROCEDURE [dbo].[sp_2clix_usuarioReuniao] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\t\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_2clix_usuarioReuniao' and xtype='U')\n\tBEGIN\t \n\t\tCREATE TABLE [dbo].[dim_2clix_usuarioReuniao] (\n\t\t\t [id]                       VARCHAR(500)    NOT NULL\n\t\t\t,[usuario]\t\t\t\t\tVARCHAR(100)    NOT NULL\n\t\t\t,[login]\t\t\t\t\tVARCHAR(20) \tNOT NULL\n\t\t\t,[nome da reuniao]\t\t\tVARCHAR(250)\tNOT NULL\n\t\t\t,[data]   \t\t\t\t\tDATETIME    \tNOT NULL\n\t\t\t,[instrutor responsavel]\tVARCHAR(100)\tNOT NULL\n\t\t\t,[tipo reuniao]\t\t\t\tVARCHAR(50) \tNOT NULL\n\t\t\t,[faltas]\t\t\t\t\tINT     \t\tNOT NULL\n\t\t\t,[nota] \t\t\t\t\tINT\t\t        NOT NULL\n\t\t) ON [PRIMARY]\n\tEND\n\t\t\n\n\t--SELECT * INTO TESTE2 FROM #temp0\n\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_2clix_usuarioReuniao]\n\t\tWHERE [data] IN (SELECT DISTINCT [DATA DA REUNI\u00c3O] FROM #temp0)\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\n\t\t\t [id]                       =REPLACE(CONCAT(CAST([DATA DA REUNI\u00c3O] AS VARCHAR(19)),[LOGIN],[NOME DA REUNI\u00c3O]),' ','')\n\t\t\t,[usuario]\t\t\t\t\t=[USUARIO]\n\t\t\t,[login]\t\t\t\t\t=[LOGIN]\n\t\t\t,[nome da reuniao]\t\t\t=[NOME DA REUNI\u00c3O]\n\t\t\t,[data]   \t\t\t\t\t=[DATA DA REUNI\u00c3O]\n\t\t\t,[instrutor responsavel]\t=[INSTRUTOR RESPONS\u00c1VEL]\n\t\t\t,[tipo reuniao]\t\t\t\t=[TIPO DE REUNI\u00c3O]\n\t\t\t,[faltas]\t\t\t\t\t=[FALTAS]\n\t\t\t,[nota]                     =[NOTA]  \n\t\tFROM #temp0\n\t\tWHERE [LOGIN] IS NOT NULL\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ( \n\t\t\t [id]                       \n\t\t\t,[usuario]\t\t\t\t\t\n\t\t\t,[login]\t\t\t\t\t\n\t\t\t,[nome da reuniao]\t\t\t\n\t\t\t,[data]   \t\t\t\t\t\n\t\t\t,[instrutor responsavel]\t\n\t\t\t,[tipo reuniao]\t\t\t\t\n\t\t\t,[faltas]\t\t\t\t\t\n\t\t\t,[nota]                     \n\t\t\t) \n\t\tVALUES (\n\t\t\t fonte.[id]\n\t\t\t,fonte.[usuario]\n\t\t\t,fonte.[login]\n\t\t\t,fonte.[nome da reuniao]\n\t\t\t,fonte.[data]\n\t\t\t,fonte.[instrutor responsavel]\n\t\t\t,fonte.[tipo reuniao]\n\t\t\t,fonte.[faltas]\n\t\t\t,fonte.[nota]\n\t\t\t)\t\t\t\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t destino.[id]\t\t\t\t        = fonte.[id]\n\t\t\t,destino.[usuario]\t\t\t\t    = fonte.[usuario]\n\t\t\t,destino.[login]\t\t\t        = fonte.[login]\n\t\t\t,destino.[nome da reuniao]\t\t\t= fonte.[nome da reuniao]\n\t\t\t,destino.[data]\t\t\t\t        = fonte.[data]\n\t\t\t,destino.[instrutor responsavel]\t= fonte.[instrutor responsavel]\n\t\t\t,destino.[tipo reuniao]\t\t\t\t= fonte.[tipo reuniao]\n\t\t\t,destino.[faltas]\t\t\t\t    = fonte.[faltas]\n\t\t\t,destino.[nota]\t\t\t\t\t    = fonte.[nota]\n\tWHEN NOT MATCHED BY SOURCE THEN \n\t\tDELETE\n    ;\n\n\nGO\n",
        "build_order": 286,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_usuarioReuniao]": [
                "SELECT",
                "SELECT * FROM [dim_2clix_usuarioReuniao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_usuarioReuniao]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_2clix_usuarioReuniao]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_2clix_usuarioReuniao]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_2clix_usuarioReuniao]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_analise_turnover]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_analise_turnover]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_analise_turnover",
        "type": "StoredProcedure",
        "start": 257168,
        "end": 257717,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_analise_turnover]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE      PROCEDURE [dbo].[sp_analise_turnover]\nAS\n\nset dateformat dmy;\n\nDELETE FROM dim_analise_turnover\n\nINSERT INTO dim_analise_turnover SELECT * FROM #temp0 WHERE [Data M\u00eas] IS NOT NUll and [An\u00e1lise] IS NOT NUll\n\n\nUPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([data]) from dim_analise_turnover) \nWHERE [table] = 'dim_analise_turnover'\n\n\n\n\nGO\n",
        "build_order": 287,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_analise_turnover]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[sp_analise_turnover]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_analise_turnover]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[sp_analise_turnover]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_cemiterio",
        "type": "StoredProcedure",
        "start": 257717,
        "end": 301483,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_cemiterio]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   PROCEDURE [dbo].[sp_att_cemiterio] AS\n \nSET LANGUAGE 'Portugu\u00eas (Brasil)';\nSET DATEFORMAT dmy;\n\n/*\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM f_loginlogout_30min ORDER BY DATAHORA DESC\n\n\tDELETE FROM f_loginlogout_30min; \n\tINSERT INTO f_loginlogout_30min\n\tSELECT * FROM (\n\t\tSELECT [DataHora],[Data],[Hor\u00e1rio],[ID Selecionar],[Tribo],[Log],[Log Produtivo],[Tempo Livre],[Pausas Produtivas],[Pausas Improdutivas],[Pausa Break],[Pausa Outbound],[Pausa Lanche],[Pausa R\u00e1pida],[Pausa Almo\u00e7o],[Pausa Feedback],[Pausa Sistema Externo],[Pausa Treinamento],[Pausa Banheiro],[Pausa Sistema Interno],[Pausa Reuni\u00e3o],[Pausa Ambulat\u00f3rio],[Carga Hor\u00e1ria],[Escala],[Login],[Logout],[Supervis\u00e3o],[Nome],[Turno],[Tipo],[Status]\n\t\tFROM (\n\t\t\tSELECT\n\t\t\t\t [n]\t\t\t\t\t\t=\tROW_NUMBER() OVER (PARTITION BY r.[ID Selecionar], r.[DataHora] ORDER BY [Log] DESC)\n\t\t\t\t,[DataHora]\t\t\t\t\t=\tr.[DataHora]\n\t\t\t\t,[Data]\t\t\t\t\t\t=\tr.[Data] \n\t\t\t\t,[Hor\u00e1rio]\t\t\t\t\t= \tr.[Intervalo]\n\t\t\t\t,[ID Selecionar]\t\t\t= \tr.[ID Selecionar]\n\t\t\t\t,[Tribo]\t\t\t\t\t=\tr.[Tribo]\n\t\t\t\t,[Log]\t\t\t\t\t\t= \tr.[Log]\n\t\t\t\t,[Log Produtivo]\t\t\t=\tr.[Log Produtivo]\n\t\t\t\t,[Tempo Livre]\t\t\t\t=\tr.[Tempo Livre]\n\t\t\t\t,[Pausas Produtivas]\t\t= \tr.[Log Produtivo] - r.[Tempo Livre]\n\t\t\t\t,[Pausas Improdutivas]\t\t= \tr.[Log Improdutivo]\n\t\t\t\t,[Pausa Break]\t\t\t\t= \tr.[Pausa Break (Intelix)]\n\t\t\t\t,[Pausa Outbound]\t\t\t= \tr.[Pausa Outbound (Intelix)]\n\t\t\t\t,[Pausa Lanche]\t\t\t\t=  \tr.[Pausa Lanche (Intelix)]\n\t\t\t\t,[Pausa R\u00e1pida]\t\t\t\t=  \tr.[Pausa R\u00e1pida (Intelix)]\n\t\t\t\t,[Pausa Almo\u00e7o]\t\t\t\t=  \tr.[Pausa Almo\u00e7o (Intelix)]\n\t\t\t\t,[Pausa Feedback]\t\t\t=  \tr.[Pausa Feedback (Intelix)]\n\t\t\t\t,[Pausa Sistema Externo]\t=  \tr.[Pausa Sistema Externo (Intelix)]\n\t\t\t\t,[Pausa Treinamento]\t\t=  \tr.[Pausa Treinamento (Intelix)]\n\t\t\t\t,[Pausa Banheiro]\t\t\t=  \tr.[Pausa Banheiro (Intelix)]\n\t\t\t\t,[Pausa Sistema Interno]\t=  \tr.[Pausa Sistema Interno (Intelix)]\n\t\t\t\t,[Pausa Reuni\u00e3o]\t\t\t= \tr.[Pausa Reuni\u00e3o (Intelix)]\n\t\t\t\t,[Pausa Ambulat\u00f3rio]\t\t= \tr.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t\t\t,[Carga Hor\u00e1ria]\t\t\t= \tDATEADD(s, r.[Jornada (Log)], '00:00:00')\n\t\t\t\t,[Escala]\t\t\t\t\t=  \tr.[Escala (MOP)]\n\t\t\t\t,[Login]\t\t\t\t\t=  \tr.[Login]\n\t\t\t\t,[Logout]\t\t\t\t\t=  \tr.[Logout]\n\t\t\t\t,[Supervis\u00e3o]\t\t\t\t=  \tr.[Supervis\u00e3o]\n\t\t\t\t,[Nome]\t\t\t\t\t\t=  \tr.[Nome]\n\t\t\t\t,[Turno]\t\t\t\t\t=  \tr.[Turno]\n\t\t\t\t,[Tipo]\t\t\t\t\t\t= \tCASE WHEN r.[Login] IS NULL THEN 'Falta' WHEN r.[Logout] = '23:59:59'\tTHEN 'Projetado' ELSE 'Realizado' END\n\t\t\t\t,[Status]\t\t\t\t\t= \tr.[Status]\n\t\t\tFROM r_individuo_30min r\n\t\t\tWHERE\tr.[ID Selecionar] IS NOT NULL\n\t\t\tAND\t\tr.[Data] < CAST(GETDATE() AS date)\n\t\t\tAND\t\t(r.[Log] > 0 OR r.[Jornada (Log)] > 0)\n\t\t\tAND\t\tr.[Projeto]\tIN\t('Chat','Digital', 'BackOffice','Serasa na Estrada', 'SDR', 'Selecionar - SP', 'Assembl\u00e9ia')\n\t\t\tAND\t\tr.[Status]\t<>\t'Treinamento'\n\t\t\tAND\t\tr.[Status]\t<>\t'Afastado'\n\t\t\tAND\t\tr.[Status]\t<>\t'F\u00e9rias'\n\t\t\tAND\t\tr.[Status]\t<>\t'Staff'\n\t\t\tAND\t\t(r.[Status]\t<>\t'Turnover' OR (r.[Login] IS NOT NULL AND r.[Status] = 'Turnover'))\n\t\t\tAND\t\tr.[Folga] IS NULL\n\t\t\tAND\t\tr.Data >= '01/01/2023'\n\t\t\t--AND\t\tr.[Feriado] IS NULL\n\t\t) _ WHERE [n] = 1\n\t) _\n\n\t--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX(CAST([Data] as datetime) + CAST([Logout] as datetime)) from f_loginlogout_30min) WHERE [table] = 'f_loginlogout_30min'\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM f_loginlogout_dia \n\n\tDELETE FROM f_loginlogout_dia; \n\tINSERT INTO f_loginlogout_dia\n\tSELECT * FROM (\n\t\tSELECT *\n\t\t\t,[Entrada Ok]\t\t\t\t=\tCASE WHEN [Log] = 0 THEN 0 WHEN [Entrada Antecipada] = 0 AND [Entrada Atrasada] = 0 THEN 1 ELSE 0 END\n\t\t\t,[Sa\u00edda Ok]\t\t\t\t\t=\tCASE WHEN [Log] = 0 THEN 0 WHEN [Sa\u00edda Antecipada] = 0 AND [Sa\u00edda Atrasada] = 0 THEN 1 ELSE 0 END\n\t\t\t,[Filtro TX]  \t\t\t\t=\tCASE WHEN [HC 06:20h] > 0 THEN 1 ELSE 0 END\n\t\tFROM (\n\t\t\tSELECT *\n\t\t\t\t,[Entrada Antecipada]\t\t=\tCASE WHEN [DIF Login Entrada] >= 301 THEN 1 ELSE 0 END\n\t\t\t\t,[Entrada Atrasada]\t\t\t=\tCASE WHEN [DIF Login Entrada] <= (-300) THEN 1 ELSE 0 END\n\t\t\t\t,[Sa\u00edda Antecipada]\t\t\t=\tCASE WHEN [DIF Logout Sa\u00edda] <= (-300) THEN 1 ELSE 0 END\n\t\t\t\t,[Sa\u00edda Atrasada]\t\t\t=\tCASE WHEN [DIF Logout Sa\u00edda] > 301 THEN 1 ELSE 0 END\n\t\t\tFROM (\n\t\t\t\tSELECT *\n\t\t\t\t\t,[CH Incompleta Horas (s)]\t=\tCASE WHEN [Carga Hor\u00e1ria] - [Log] < 0 THEN 0 ELSE [Carga Hor\u00e1ria] - [Log] END\n\t\t\t\t\t,[Entrada Escala]\t\t\t=\tCAST(LEFT(Escala,5) AS TIME)\n\t\t\t\t\t,[Sa\u00edda Escala]\t\t\t\t=\tCAST(RIGHT(Escala,5) AS TIME)\n\t\t\t\t\t,[HE]\t\t\t\t\t\t=\tCASE WHEN [Log] - [Carga Hor\u00e1ria]<=0 THEN NULL ELSE [Log] - [Carga Hor\u00e1ria] END\n\t\t\t\t\t,[HE_Custo]\t\t\t\t\t=\tCASE WHEN [Log] - [Carga Hor\u00e1ria]<=600 THEN NULL ELSE [Log] - [Carga Hor\u00e1ria] END\n\t\t\t\t\t,[Acima de 2 HE]\t\t\t=\tCASE WHEN CASE WHEN [Log] - [Carga Hor\u00e1ria]<=600 THEN NULL ELSE [Log] - [Carga Hor\u00e1ria] END >= 7200 THEN 1 ELSE 0 END\n\t\t\t\t\t,[HC 06:20h]\t\t\t\t=\tCASE WHEN [Carga Hor\u00e1ria] = 22800 THEN 1 ELSE 0 END\n\t\t\t\t\t,[HC 08:12h]\t\t\t\t=\tCASE WHEN [Carga Hor\u00e1ria] = 29520 THEN 1 ELSE 0 END\n\t\t\t\t\t,[HC 10:00h]\t\t\t\t=\tCASE WHEN [Carga Hor\u00e1ria] = 36000 THEN 1 ELSE 0 END\n\t\t\t\t\t,[DIF Login Entrada]\t\t=\tCASE WHEN [Log] = 0 THEN 0 ELSE DATEDIFF(s, [Login], CAST(LEFT(Escala,5) AS TIME)) END\n\t\t\t\t\t,[DIF Logout Sa\u00edda]\t\t\t=\tCASE WHEN [Log] = 0 THEN 0 ELSE DATEDIFF(s, CAST(RIGHT(Escala,5) AS TIME), [Logout]) END\n\t\t\t\tFROM (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t [Data]\t\t\t\t\t\t=\t[Data]\n\t\t\t\t\t\t,[ID Selecionar]\t\t\t=\t[ID Selecionar]\n\t\t\t\t\t\t,[Tribo]\t\t\t\t\t=\t[Tribo]\n\t\t\t\t\t\t,[Log]\t\t\t\t\t\t=\tSUM([Log])\n\t\t\t\t\t\t,[Log Produtivo]\t\t\t=\tSUM([Log Produtivo])\n\t\t\t\t\t\t,[Tempo Livre]\t\t\t\t=\tSUM([Tempo Livre])\n\t\t\t\t\t\t,[Pausas Produtivas]\t\t=\tSUM([Pausas Produtivas])\n\t\t\t\t\t\t,[Pausas Improdutivas]\t\t=\tSUM([Pausas Improdutivas])\n\t\t\t\t\t\t,[Pausa Break]\t\t\t\t=\tSUM([Pausa Break])\n\t\t\t\t\t\t,[Pausa Outbound]\t\t\t=\tSUM([Pausa Outbound])\n\t\t\t\t\t\t,[Pausa Lanche]\t\t\t\t=\tSUM([Pausa Lanche])\n\t\t\t\t\t\t,[Pausa R\u00e1pida]\t\t\t\t=\tSUM([Pausa R\u00e1pida])\n\t\t\t\t\t\t,[Pausa Almo\u00e7o]\t\t\t\t=\tSUM([Pausa Almo\u00e7o])\n\t\t\t\t\t\t,[Pausa Feedback]\t\t\t=\tSUM([Pausa Feedback])\n\t\t\t\t\t\t,[Pausa Sistema Externo]\t=\tSUM([Pausa Sistema Externo])\n\t\t\t\t\t\t,[Pausa Treinamento]\t\t=\tSUM([Pausa Treinamento])\n\t\t\t\t\t\t,[Pausa Banheiro]\t\t\t=\tSUM([Pausa Banheiro])\n\t\t\t\t\t\t,[Pausa Sistema Interno]\t=\tSUM([Pausa Sistema Interno])\n\t\t\t\t\t\t,[Pausa Reuni\u00e3o]\t\t\t=\tSUM([Pausa Reuni\u00e3o])\n\t\t\t\t\t\t,[Carga Hor\u00e1ria]\t\t\t=\tDATEDIFF(s, '00:00:00', MAX([Carga Hor\u00e1ria]))\n\t\t\t\t\t\t,[Escala]\t\t\t\t\t=\tMAX([Escala])\n\t\t\t\t\t\t,[Login]\t\t\t\t\t=\tMIN([Login])\n\t\t\t\t\t\t,[Logout]\t\t\t\t\t=\tMAX([Logout])\n\t\t\t\t\t\t,[Supervis\u00e3o]\t\t\t\t=\tMAX([Supervis\u00e3o])\n\t\t\t\t\t\t,[Nome]\t\t\t\t\t\t=\tMAX([Nome])\n\t\t\t\t\t\t,[Turno]\t\t\t\t\t=\tMAX([Turno])\n\t\t\t\t\t\t,[Tipo]\t\t\t\t\t\t=\tMAX([Tipo])\n\t\t\t\t\tFROM f_loginlogout_30min\n\t\t\t\t\tGROUP BY [Data], [ID Selecionar], [Tribo]\n\t\t\t\t) _\n\t\t\t) _\n\t\t) _\n\t) _\n\tWHERE Data >= '01/01/2023'\n\n\t--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX(CAST([Data] as datetime) + CAST([Logout] as datetime)) from f_loginlogout_dia) WHERE [table] = 'f_loginlogout_dia' \n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM f_loginlogout_V2 \n\n\tDELETE FROM f_loginlogout_V2; \n\tINSERT INTO f_loginlogout_V2 \n\n\tSELECT * FROM (\n\t\tSELECT [Atendente]\t\t\t\t\t=\tm.[ID Intelix]\n\t\t\t  ,[Nome]\t\t\t\t\t\t=\tl.[Nome]\n\t\t\t  ,[In\u00edcio]\t\t\t\t\t\t=\tCAST(l.[Data] as datetime) + CAST(l.[Login] as datetime)\n\t\t\t  ,[Fim]\t\t\t\t\t\t=\tCAST(l.[Data] as datetime) + CAST(l.[Logout] as datetime)\n\t\t\t  ,[Dura\u00e7\u00e3o]\t\t\t\t\t=\tl.[Log]\n\t\t\t  ,[Dura\u00e7\u00e3o Produtiva]\t\t\t=\tl.[Log Produtivo]\n\t\t\t  ,[Tipo]\t\t\t\t\t\t=\tl.[Tipo]\n\t\t\t  ,[HE]\t\t\t\t\t\t\t=\tl.[HE]\n\t\t\t  ,[HE_Custo]\t\t\t\t\t=\tl.[HE_Custo]\n\t\t\t  ,[Pausa Break]\t\t\t\t=\tl.[Pausa Break]\n\t\t\t  ,[Pausa Outbound]\t\t\t\t=\tl.[Pausa Outbound]\n\t\t\t  ,[Pausa Lanche]\t\t\t\t=\tl.[Pausa Lanche]\n\t\t\t  ,[Pausa Rapida]\t\t\t\t=\tl.[Pausa R\u00e1pida]\n\t\t\t  ,[Pausa Almoco]\t\t\t\t=\tl.[Pausa Almo\u00e7o]\n\t\t\t  ,[Pausa Feedback]\t\t\t\t=\tl.[Pausa Feedback]\n\t\t\t  ,[Pausa Sistema Externo]\t\t=\tl.[Pausa Sistema Externo]\n\t\t\t  ,[Pausa Treinamento]\t\t\t=\tl.[Pausa Treinamento]\n\t\t\t  ,[Pausa Banheiro]\t\t\t\t=\tl.[Pausa Banheiro]\n\t\t\t  ,[Pausa Sistema Interno]\t\t=\tl.[Pausa Sistema Interno]\n\t\t\t  ,[Pausa Reuniao]\t\t\t\t=\tl.[Pausa Reuni\u00e3o]\n\t\t\t  ,[Ilha]\t\t\t\t\t\t=\tl.[Tribo]\n\t\t\t  ,[Subilha]\t\t\t\t\t=\tl.[Tribo]\n\t\t\t  ,[Escala]\t\t\t\t\t\t=\tl.[Escala]\n\t\t\t  ,[Carga]\t\t\t\t\t\t=\tl.[Carga Hor\u00e1ria]\n\t\t\t  ,[Carga Ajustada]\t\t\t\t=\tl.[Carga Hor\u00e1ria]\n\t\t\t  ,[Supervisor]\t\t\t\t\t=\tl.[Supervis\u00e3o]\n\t\t\t  ,[Coordenador]\t\t\t\t=\tm.[Coordena\u00e7\u00e3o]\n\t\t\t  ,[Status]\t\t\t\t\t\t=\tCASE WHEN l.[Log] > 0 THEN 'Ativo' ELSE 'Falta' END\n\t\t\t  ,[Status_MOP]\t\t\t\t\t=\tm.[Status]\n\t\t\t  ,[Projeto]\t\t\t\t\t=\tm.[Projeto]\n\t\t\t  ,[ID_Selecionar]\t\t\t\t=\tl.[ID Selecionar]\n\t\t\t  ,[Data de Atualiza\u00e7\u00e3o do MOP]\t=\tm.[Data da Atualiza\u00e7\u00e3o]\n\t\t\t  ,[taxa]\t\t\t\t\t\t=\tm.[Taxa]\n\t\t\t  ,[Dia \u00e9 Divergente da Taxa?]\t=\tCASE m.[Taxa]\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 1 THEN CASE DATENAME(WEEKDAY, l.[Data]) WHEN 'S\u00e1bado' THEN 1  WHEN 'Domingo' THEN 1 ELSE 0 END \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 2 THEN CASE DATENAME(WEEKDAY, l.[Data]) WHEN 'Domingo' THEN 1 ELSE 0 END\n\t\t\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t  ,[Turno_MOP]\t\t\t\t\t=\tl.[Turno]\n\t\t\t  ,[CH Incompleta Horas (s)]\t=\tl.[CH Incompleta Horas (s)]\n\t\t\t  ,[Data]\t\t\t\t\t\t=\tl.[Data]\n\t\t\t  ,[Login]\t\t\t\t\t\t=\tl.[Login]\n\t\t\t  ,[Logout]\t\t\t\t\t\t=\tl.[Logout]\n\t\t\t  ,[Entrada Escala]\t\t\t\t=\tl.[Entrada Escala]\n\t\t\t  ,[Sa\u00edda Escala]\t\t\t\t=\tl.[Sa\u00edda Escala]\n\t\t\t  ,[Acima de 2 HE]\t\t\t\t=\tl.[Acima de 2 HE]\n\t\t\t  ,[HC 06:20h]\t\t\t\t\t=\tl.[HC 06:20h]\n\t\t\t  ,[HC 08:12h]\t\t\t\t\t=\tl.[HC 08:12h]\n\t\t\t  ,[HC 10:00h]\t\t\t\t\t=\tl.[HC 10:00h]\n\t\t\t  ,[DIF Login Entrada]\t\t\t=\tl.[DIF Login Entrada]\n\t\t\t  ,[Entrada Antecipada]\t\t\t=\tl.[Entrada Antecipada]\n\t\t\t  ,[Entrada Atrasada]\t\t\t=\tl.[Entrada Atrasada]\n\t\t\t  ,[DIF Logout Sa\u00edda]\t\t\t=\tl.[DIF Logout Sa\u00edda]\n\t\t\t  ,[Sa\u00edda Antecipada]\t\t\t=\tl.[Sa\u00edda Antecipada]\n\t\t\t  ,[Sa\u00edda Atrasada]\t\t\t\t=\tl.[Sa\u00edda Atrasada]\n\t\t\t  ,[Entrada Ok]\t\t\t\t\t=\tl.[Entrada Ok]\n\t\t\t  ,[Sa\u00edda Ok]\t\t\t\t\t=\tl.[Sa\u00edda Ok]\n\t\t\t  ,[Filtro TX]\t\t\t\t\t=\tl.[Filtro TX]\n\t\t\t  ,[Dura\u00e7\u00e3o (T)]\t\t\t\t=\tCAST(DATEADD(s, l.[Log], 0) as time(0))\n\t\t\t  ,[Dura\u00e7\u00e3o Produtiva (T)]\t\t=\tCAST(DATEADD(s, l.[Log Produtivo], 0) as time(0))\n\t\t  FROM [f_loginlogout_dia] l\t\n\t\t  LEFT JOIN [f_mop_historico] m\t\n\t\t  ON l.[ID Selecionar] = m.[ID Selecionar]\n\t\t  AND l.[Data] = m.[Data da Atualiza\u00e7\u00e3o]\n\t\t  WHERE m.[ID Intelix] IS NOT NULL\n\n\t) _\n\tWHERE Data >= '01/01/2023'\n\n\t--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([Fim]) from f_loginlogout_V2) WHERE [table] = 'f_loginlogout_V2'\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM f_produtividade_V2 \n\n\tDELETE FROM f_produtividade_V2;\n\tWITH chaves (data, id_selecionar, id_serasa, tribo_zendesk, subtribo_zendesk, data_mop)  \n\tAS\n\t(\n\t\tSELECT t2.resolucao, t1.[ID Selecionar], t2.ID_serasa, t2.tribo_serasa, t2.subtribo_serasa, MAX([Data da Atualiza\u00e7\u00e3o]) FROM f_mop_historico AS t1\n\t\tRIGHT JOIN (\n\t\t\tSELECT DISTINCT ID_serasa=[ID Serasa], CAST([Resolu\u00e7\u00e3o] AS DATE) as resolucao, tribo_serasa=[Tribo], subtribo_serasa=[Tribo] FROM f_tickets\n\t\t\tWHERE [Resolu\u00e7\u00e3o] >= DATEFROMPARTS(YEAR(DATEADD(MONTH, -12, GETDATE())), MONTH(DATEADD(MONTH, -12, GETDATE())), 01)\n\t\t) AS t2\n\t\tON t2.ID_serasa = t1.[ID Serasa]\n\t\tAND  t2.resolucao = t1.[Data da Atualiza\u00e7\u00e3o]\n\t\tGROUP BY t1.[ID Selecionar], t2.ID_serasa, t2.resolucao, t2.tribo_serasa, t2.subtribo_serasa\n\t),\n\ttmt_tratados_rein (id_serasa, data_resolucao, tribo_zendesk, subtribo_zendesk, tempo_total_tratativas, total_tratados, tratados_tmt, reps, nr, reincidentes_48h, reincidentes_30d)\n\tAS\n\t(\n\t\tSELECT ID_serasa=[ID Serasa], CAST([Resolu\u00e7\u00e3o] AS DATE), tribo_serasa=[Tribo], subtribo_serasa=[Tribo], SUM(TMT), COUNT(1), SUM(CASE WHEN TMT>0 THEN 1 ELSE 0 END), SUM(R\u00e9plicas), SUM(CASE [Resolvido?] WHEN 0 THEN 1 ELSE 0 END), SUM(CAST([Reincidente 48h?] AS INT)), SUM(CAST([Reincidente 30d?] AS INT)) \n\t\tFROM f_tickets \n\t\tWHERE Resolu\u00e7\u00e3o >= DATEFROMPARTS(YEAR(DATEADD(MONTH, -12, GETDATE())), MONTH(DATEADD(MONTH, -12, GETDATE())), 01)\n\t\tGROUP BY [ID Serasa], CAST(Resolu\u00e7\u00e3o AS DATE), Tribo, Tribo\n\t),\n\tgrude (data, id_selecionar, id_serasa, nome, status, tribo_zendesk, subtribo_zendesk, tribo_selecionar, subtribo_selecionar, supervisao, tempo_total_tratativas, tmt, tratados, tratados_tmt, naoResolvidos, porcentagem_naoResolvidos, replicas, tratados_mes, reincidentes_48h, reincidentes_30d)\n\tAS\n\t(\n\t\tSELECT t1.data, t1.id_selecionar, t1.id_serasa, t2.nome, t2.status, t1.tribo_zendesk, t1.subtribo_zendesk, t2.tribo, t2.subtribo, t2.supervisao, t3.tempo_total_tratativas, (t3.tempo_total_tratativas/t3.total_tratados), t3.total_tratados, t3.tratados_tmt, t3.nr, (CAST(t3.nr AS FLOAT)/CAST(t3.total_tratados AS FLOAT)), t3.reps, (SUM(t3.total_tratados) OVER (PARTITION BY t1.id_selecionar, t1.tribo_zendesk, DATEFROMPARTS(YEAR(t1.data), MONTH(t1.data), 01))), t3.reincidentes_48h, t3.reincidentes_30d FROM chaves AS t1\n\t\tLEFT JOIN (\n\t\t\tSELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Selecionar] as ID_selecionar, nome, tribo, [Sub Tribo] as subtribo, [Supervis\u00e3o] as supervisao, status FROM f_mop_historico\n\t\t) AS t2\n\t\tON\tt1.data_mop\t = t2.data_atualizacao\n\t\tAND\tt1.id_selecionar = t2.ID_selecionar\n\t\tLEFT JOIN (\n\t\t\tSELECT * FROM tmt_tratados_rein\n\t\t) AS t3\n\t\tON\tt1.data\t\t\t = t3.data_resolucao\n\t\tAND\tt1.id_serasa\t = t3.id_serasa \n\t\tAND\tt1.tribo_zendesk = t3.tribo_zendesk   \n\t\tAND\tt1.subtribo_zendesk = t3.subtribo_zendesk   \n\t),\n\tfinal([Data], [ID Selecionar], [ID Serasa], [Nome], [Status], [Tribo Zendesk], [SubTribo Zendesk], [Tribo Selecionar], [Subtribo Selecionar], [Supervis\u00e3o], [Tratados], [Tratados Com TMT], [Tempo Total de Tratativa], [TMT], [N\u00e3o Resolvidos], [%N\u00e3o Resolvidos], [Replicas], [Reincidentes 48h], [Reincidentes 30d], contingencia)\n\tAS\n\t(\n\t\tSELECT data, id_selecionar, id_serasa, nome, status,  tribo_zendesk, subtribo_zendesk, tribo_selecionar, subtribo_selecionar, supervisao, tratados, tratados_tmt, tempo_total_tratativas, tmt, naoResolvidos, porcentagem_naoResolvidos, replicas, reincidentes_48h, reincidentes_30d, contingencia = IIF([tribo_zendesk] = [tribo_selecionar], 0,1) FROM grude AS t1\n\t)\n\tINSERT INTO f_produtividade_V2 SELECT * FROM final\n\t--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([Data]) from f_produtividade_V2) WHERE [table] = 'f_produtividade_V2'\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM f_dimensionamento_30min ORDER BY DATAHORA DESC\n\tDELETE FROM f_dimensionamento_30min; \n\tWITH\n\tinicio AS\n\t(\n\t\tSELECT \n\t\t\tDataHora\t\t\t\t\t\t=\tt0.DataHora,\n\t\t\tData\t\t\t\t\t\t\t=\tt0.Data,\n\t\t\tHor\u00e1rio\t\t\t\t\t\t\t=\tt0.Hor\u00e1rio, \n\t\t\t[Tribo]\t\t\t\t\t\t\t=\tt0.[Tribo], \n\t\t\t[F_HC Produtivo TX2]\t\t\t=\tISNULL(MAX(t1.hc_tx2)*(1-MAX(t1.pausas_tx2)),0),\n\t\t\t[F_HC Produtivo TX1]            =\tISNULL(MAX(t1.hc_tx1)*(1-MAX(t1.pausas_tx1)),0),\n\t\t\t[F_HC Produtivo Geral]          =\t(ISNULL(MAX(t1.hc_tx2)*(1-MAX(t1.pausas_tx2)),0)) + (ISNULL(MAX(t1.hc_tx1)*(1-MAX(t1.pausas_tx1)),0)),\n\t\t\t[F_HC em Horas Produtivo]\t\t=\tISNULL((MAX(t1.hc_tx2)*(1-MAX(t1.pausas_tx2))+MAX(t1.hc_tx1)*(1-MAX(t1.pausas_tx1))),0)*1800,\n\t\t\t[F_HC TX2]\t\t\t\t\t\t=\tISNULL(MAX(t1.hc_tx2),0),\n\t\t\t[F_HC TX1]\t\t\t\t\t\t=\tISNULL(MAX(t1.hc_tx1),0),\n\t\t\t[F_HC Geral]\t\t\t\t\t=\tISNULL(MAX(t1.hc_tx2) + MAX(t1.hc_tx1),0),\n\t\t\t[F_HC em Horas]\t\t\t\t\t=\tISNULL((MAX(t1.hc_tx2)+MAX(t1.hc_tx1)),0)*1800,\n\t\t\t[Log]\t\t\t\t\t\t\t=\tSUM([Log]),\n\t\t\t[Log Produtivo]\t\t\t\t\t=\tSUM([Log Produtivo]),\n\t\t\t[Log at\u00e9 102%]\t\t\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Log]) > ((MAX(t1.hc_tx2)+MAX(t1.hc_tx1))*1800 * 1.02)\n\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN (MAX(t1.hc_tx2)+MAX(t1.hc_tx1))*1800 * 1.02\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE SUM([Log])\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t\t[Log Produtivo at\u00e9 102%]\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Log Produtivo]) > (((MAX(t1.hc_tx2))*(1-MAX(t1.pausas_tx2))+MAX(t1.hc_tx1)*(1-MAX(t1.pausas_tx1)))*1800 * 1.02)\n\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN ((MAX(t1.hc_tx2))*(1-MAX(t1.pausas_tx2))+MAX(t1.hc_tx1)*(1-MAX(t1.pausas_tx1)))*1800 * 1.02\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE SUM([Log Produtivo])\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t\t[HC Logado]\t\t\t\t\t\t=\tSUM([Log])/1800.0,\n\t\t\t[HC Logado Produtivo]\t\t\t=\tSUM([Log Produtivo])/1800.0,\n\t\t\t[HC Logado at\u00e9 102%]\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Log]) > ((MAX(t1.hc_tx2)+MAX(t1.hc_tx1))*1800 * 1.02)\n\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN (MAX(t1.hc_tx2)+MAX(t1.hc_tx1))*1800 * 1.02\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE SUM([Log])\n\t\t\t\t\t\t\t\t\t\t\t\tEND/1800,\n\t\t\t[HC Logado Produtivo at\u00e9 102%]\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Log Produtivo]) > (((MAX(t1.hc_tx2))*(1-MAX(t1.pausas_tx2))+MAX(t1.hc_tx1)*(1-MAX(t1.pausas_tx1)))*1800 * 1.02)\n\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN ((MAX(t1.hc_tx2))*(1-MAX(t1.pausas_tx2))+MAX(t1.hc_tx1)*(1-MAX(t1.pausas_tx1)))*1800 * 1.02\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE SUM([Log Produtivo])\n\t\t\t\t\t\t\t\t\t\t\t\tEND/1800,\n\t\t\t[Tempo Livre]\t\t\t\t\t=\tSUM([Tempo Livre]), \n\t\t\t[Pausas Produtivas]\t\t\t\t=\tSUM([Pausas Produtivas]), \n\t\t\t[Pausas Improdutivas]\t\t\t=\tSUM([Pausas Improdutivas]), \n\t\t\t[Pausa Break]\t\t\t\t\t=\tSUM([Pausa Break]), \n\t\t\t[Pausa Outbound]\t\t\t\t=\tSUM([Pausa Outbound]), \n\t\t\t[Pausa Lanche]\t\t\t\t\t=\tSUM([Pausa Lanche]), \n\t\t\t[Pausa R\u00e1pida]\t\t\t\t\t=\tSUM([Pausa R\u00e1pida]), \n\t\t\t[Pausa Almo\u00e7o]\t\t\t\t\t=\tSUM([Pausa Almo\u00e7o]), \n\t\t\t[Pausa Feedback]\t\t\t\t=\tSUM([Pausa Feedback]), \n\t\t\t[Pausa Sistema Externo]\t\t\t=\tSUM([Pausa Sistema Externo]), \n\t\t\t[Pausa Treinamento]\t\t\t\t=\tSUM([Pausa Treinamento]), \n\t\t\t[Pausa Banheiro]\t\t\t\t=\tSUM([Pausa Banheiro]), \n\t\t\t[Pausa Sistema Interno]\t\t\t=\tSUM([Pausa Sistema Interno]), \n\t\t\t[Pausa Reuni\u00e3o]\t\t\t\t\t=\tSUM([Pausa Reuni\u00e3o])\n\t\tFrom f_loginlogout_30min AS t0\n\t\tLEFT JOIN dim_forecast_30min AS t1 ON t0.tribo = t1.tribo AND t0.DataHora = t1.datahora\n\t\tGROUP BY t0.DataHora, t0.Data, t0.Hor\u00e1rio, t0.[Tribo]\n\t)\n\tINSERT INTO f_dimensionamento_30min SELECT * FROM inicio\n\t--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX(CAST([Data] as datetime) + CAST([Hor\u00e1rio] as datetime)) from f_dimensionamento_30min) WHERE [table] = 'f_dimensionamento_30min'\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM f_dimensionamento_dia order by data desc \n\n\tDELETE FROM f_dimensionamento_dia; \n\tWITH \n\tinicio AS\n\t(\n\n\tSELECT \n\t\t\t\tData\t\t\t\t\t\t\t=\tt0.Data,\n\t\t\t\t[Tribo]\t\t\t\t\t\t\t=\tt0.[Tribo], \n\t\t\t\t[F_HC Produtivo TX2]\t\t\t,\n\t\t\t\t[F_HC Produtivo TX1]            ,\n\t\t\t\t[F_HC TX2]\t\t\t\t\t\t,\n\t\t\t\t[F_HC TX1]\t\t\t\t\t\t,\n\t\t\t\t[F_HC Geral]\t\t\t\t\t,\n\t\t\t\t[F_HC em Horas Produtivo]\t\t,\n\t\t\t\t[F_HC em Horas]\t\t\t\t\t,\n\t\t\t\t[HE]\t\t\t\t\t\t    =\tt1.[HE],\n\t\t\t\t[HE_Custo]\t\t\t\t\t    =\tt1.[HE_Custo],\n\t\t\t\t[Log]\t\t\t\t\t\t\t,\n\t\t\t\t[Log Produtivo]\t\t\t\t\t,\n\t\t\t\t[Log at\u00e9 102%]\t\t\t\t\t,\n\t\t\t\t[Log Produtivo at\u00e9 102%]\t\t,\n\t\t\t\t[HC Logado]\t\t\t\t\t\t,\n\t\t\t\t[HC Logado Produtivo]\t\t\t,\n\t\t\t\t[HC Logado at\u00e9 102%]\t\t\t,\n\t\t\t\t[HC Logado Produtivo at\u00e9 102%]\t,\n\t\t\t\t[Tempo Livre]\t\t\t\t\t, \n\t\t\t\t[Pausas Produtivas]\t\t\t\t, \n\t\t\t\t[Pausas Improdutivas]\t\t\t, \n\t\t\t\t[Pausa Break]\t\t\t\t\t, \n\t\t\t\t[Pausa Outbound]\t\t\t\t, \n\t\t\t\t[Pausa Lanche]\t\t\t\t\t, \n\t\t\t\t[Pausa R\u00e1pida]\t\t\t\t\t, \n\t\t\t\t[Pausa Almo\u00e7o]\t\t\t\t\t, \n\t\t\t\t[Pausa Feedback]\t\t\t\t, \n\t\t\t\t[Pausa Sistema Externo]\t\t\t, \n\t\t\t\t[Pausa Treinamento]\t\t\t\t, \n\t\t\t\t[Pausa Banheiro]\t\t\t\t, \n\t\t\t\t[Pausa Sistema Interno]\t\t\t, \n\t\t\t\t[Pausa Reuni\u00e3o]\t\t\t\t\t\n\n\t\t\tFrom \n\t\t\t(\n\n\t\t\tSelect \n\t\t\t\tData\t\t\t\t\t\t\t=\tData,\n\t\t\t\t[Tribo]\t\t\t\t\t\t\t=\t[Tribo], \n\t\t\t\t[F_HC Produtivo TX2]\t\t\t=\tMAX(ISNULL([F_HC Produtivo TX2],0)),\n\t\t\t\t[F_HC Produtivo TX1]            =\tMAX(ISNULL([F_HC Produtivo TX1],0)),\n\t\t\t\t[F_HC TX2]\t\t\t\t\t\t=\tMAX(ISNULL([F_HC TX2],0)),\n\t\t\t\t[F_HC TX1]\t\t\t\t\t\t=\tMAX(ISNULL([F_HC TX1],0)),\n\t\t\t\t[F_HC Geral]\t\t\t\t\t=\tMAX(ISNULL([F_HC TX2],0)) + MAX(ISNULL([F_HC TX1],0)),\n\t\t\t\t[F_HC em Horas Produtivo]\t\t=\tSUM([F_HC em Horas Produtivo]),\n\t\t\t\t[F_HC em Horas]\t\t\t\t\t=\tSUM([F_HC em Horas]),\n\t\t\t\t[Log]\t\t\t\t\t\t\t=\tSUM([Log]),\n\t\t\t\t[Log Produtivo]\t\t\t\t\t=\tSUM([Log Produtivo]),\n\t\t\t\t[Log at\u00e9 102%]\t\t\t\t\t=\tSUM([Log at\u00e9 102%]),\n\t\t\t\t[Log Produtivo at\u00e9 102%]\t\t=\tSUM([Log Produtivo at\u00e9 102%]),\n\t\t\t\t[HC Logado]\t\t\t\t\t\t=\tSUM([Log])/IIF(SUM([F_HC TX1])>0,36000.0,22800.0),\n\t\t\t\t[HC Logado Produtivo]\t\t\t=\tSUM([Log Produtivo])/IIF(SUM([F_HC TX1])>0,36000.0*(MAX(NULLIF([F_HC Produtivo TX1],0)))/(MAX(NULLIF([F_HC TX1],0))),22800.0*(MAX(NULLIF([F_HC Produtivo TX2],0)))/(MAX(NULLIF([F_HC TX2],0)))),\n\t\t\t\t[HC Logado at\u00e9 102%]\t\t\t=\tSUM([Log at\u00e9 102%])/IIF(SUM([F_HC TX1])>0,36000.0,22800.0),\n\t\t\t\t[HC Logado Produtivo at\u00e9 102%]\t=\tSUM([Log Produtivo at\u00e9 102%])/IIF(SUM([F_HC TX1])>0,36000.0*(MAX(NULLIF([F_HC Produtivo TX1],0)))/(MAX(NULLIF([F_HC TX1],0))),22800.0*(MAX(NULLIF([F_HC Produtivo TX2],0)))/(MAX(NULLIF([F_HC TX2],0)))),\n\t\t\t\t[Tempo Livre]\t\t\t\t\t=\tSUM([Tempo Livre]), \n\t\t\t\t[Pausas Produtivas]\t\t\t\t=\tSUM([Pausas Produtivas]), \n\t\t\t\t[Pausas Improdutivas]\t\t\t=\tSUM([Pausas Improdutivas]), \n\t\t\t\t[Pausa Break]\t\t\t\t\t=\tSUM([Pausa Break]), \n\t\t\t\t[Pausa Outbound]\t\t\t\t=\tSUM([Pausa Outbound]), \n\t\t\t\t[Pausa Lanche]\t\t\t\t\t=\tSUM([Pausa Lanche]), \n\t\t\t\t[Pausa R\u00e1pida]\t\t\t\t\t=\tSUM([Pausa R\u00e1pida]), \n\t\t\t\t[Pausa Almo\u00e7o]\t\t\t\t\t=\tSUM([Pausa Almo\u00e7o]), \n\t\t\t\t[Pausa Feedback]\t\t\t\t=\tSUM([Pausa Feedback]), \n\t\t\t\t[Pausa Sistema Externo]\t\t\t=\tSUM([Pausa Sistema Externo]), \n\t\t\t\t[Pausa Treinamento]\t\t\t\t=\tSUM([Pausa Treinamento]), \n\t\t\t\t[Pausa Banheiro]\t\t\t\t=\tSUM([Pausa Banheiro]), \n\t\t\t\t[Pausa Sistema Interno]\t\t\t=\tSUM([Pausa Sistema Interno]), \n\t\t\t\t[Pausa Reuni\u00e3o]\t\t\t\t\t=\tSUM([Pausa Reuni\u00e3o]) \n\n\t\t\tfrom f_dimensionamento_30min\n\t\t\tGROUP BY Data, [Tribo]\n\t\t\t) AS t0\n\t\t\tLEFT JOIN(SELECT  [Data],Tribo, HE = SUM(HE), HE_Custo = SUM(HE_Custo) FROM f_loginlogout_dia GROUP BY Data,Tribo) AS t1\n\t\t\tON t0.Data = t1.[Data] and t0.Tribo = t1.Tribo\n\t\t\n\t\t\n\t\t\n\n\t),\n\tetapa_1 as\n\t(\n\tSELECT *,\n\t\t\t\t[%_HC Logado]\t\t\t\t\t=\t[HC Logado] / NULLIF([F_HC Geral],0),\n\t\t\t\t[%_HC Logado Produtivo]\t\t\t=\t[HC Logado Produtivo] / NULLIF([F_HC Geral],0),\n\t\t\t\t[%_HC Logado at\u00e9 102%]\t\t\t=\t[HC Logado at\u00e9 102%] / NULLIF([F_HC Geral],0),\n\t\t\t\t[%_HC Logado Produtivo at\u00e9 102%]=\t[HC Logado Produtivo at\u00e9 102%] / NULLIF([F_HC Geral],0)\n\t\t\t\n\n\tFrom inicio\n\t)\n\tINSERT INTO f_dimensionamento_dia SELECT * FROM etapa_1\n\n\n\n\n\t--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([Data]) from f_dimensionamento_dia) WHERE [table] = 'f_dimensionamento_dia'\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM f_dimensionamento_produtividade \n\n\tDELETE FROM f_dimensionamento_produtividade; \n\tWITH loginlogout_preenchido (Atendente, Nome, In\u00edcio, Fim, Dura\u00e7\u00e3o, [Dura\u00e7\u00e3o Produtiva], [Tipo], HE, HE_Custo, [Pausa Break], [Pausa Outbound], [Pausa Lanche], [Pausa Rapida], [Pausa Almoco], [Pausa Feedback], [Pausa Sistema Externo], [Pausa Treinamento], [Pausa Banheiro], [Pausa Sistema Interno], [Pausa Reuniao], Ilha, Subilha, Escala, Carga, [Carga Ajustada], Supervisor, Coordenador, Status, Status_MOP, Projeto, ID_Selecionar, [Data de Atualiza\u00e7\u00e3o do MOP], taxa, [Dia \u00e9 Divergente da Taxa?], [Turno_MOP], [CH Incompleta Horas (s)], [Data], [Login], [Logout],[Entrada Escala], [Sa\u00edda Escala], [Acima de 2 HE], [HC 06:20h], [HC 08:12h], [HC 10:00h], [DIF Login Entrada], [Entrada Antecipada], [Entrada Atrasada], [DIF Logout Sa\u00edda], [Sa\u00edda Antecipada], [Sa\u00edda Atrasada], [Entrada Ok], [Sa\u00edda Ok], [Filtro TX],[Dura\u00e7\u00e3o (T)],[Dura\u00e7\u00e3o Produtiva (T)])  \n\tAS\n\t(\n\t\tSELECT Atendente, Nome,  CAST(In\u00edcio AS DATE), Fim, Dura\u00e7\u00e3o, [Dura\u00e7\u00e3o Produtiva], [Tipo], HE, HE_Custo, [Pausa Break], [Pausa Outbound], [Pausa Lanche], [Pausa Rapida], [Pausa Almoco], [Pausa Feedback], [Pausa Sistema Externo], [Pausa Treinamento], [Pausa Banheiro], [Pausa Sistema Interno], [Pausa Reuniao], Ilha, Subilha, Escala, Carga, [Carga Ajustada], Supervisor, Coordenador, Status, Status_MOP, Projeto, ID_Selecionar, [Data de Atualiza\u00e7\u00e3o do MOP], taxa, [Dia \u00e9 Divergente da Taxa?], [Turno_MOP], [CH Incompleta Horas (s)], [Data], [Login], [Logout],[Entrada Escala], [Sa\u00edda Escala], [Acima de 2 HE], [HC 06:20h], [HC 08:12h], [HC 10:00h], [DIF Login Entrada], [Entrada Antecipada], [Entrada Atrasada], [DIF Logout Sa\u00edda], [Sa\u00edda Antecipada], [Sa\u00edda Atrasada], [Entrada Ok], [Sa\u00edda Ok], [Filtro TX],[Dura\u00e7\u00e3o (T)],[Dura\u00e7\u00e3o Produtiva (T)] FROM f_loginlogout_v2\n\t\tUNION\n\t\tSELECT DISTINCT NULL, NULL, Data, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, t0.Tribo, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL FROM f_dimensionamento_dia as t0\n\t),\n\tkeys (tribo, data_forecast, data, [HC 10:00h], [HC 06:20h], [HC 08:12h], horas_contratadas, horas_contratadas_produtivas, dura\u00e7\u00e3o, dura\u00e7\u00e3o_produtiva, [Pausa Break], [Pausa Outbound], [Pausa Lanche], [Pausa Rapida], [Pausa Almoco], [Pausa Feedback], [Pausa Sistema Externo], [Pausa Treinamento], [Pausa Banheiro], [Pausa Sistema Interno], [Pausa Reuniao], HE, [HE Custo], [aderente_ao_capacity])  \n\tAS\n\t(\n\t\tSELECT\n\t\t\tt1.Tribo,\n\t\t\tt1.data,\n\t\t\tCAST(t2.In\u00edcio AS DATE),\n\t\t\thc_tx1 = CASE WHEN DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'S\u00e1bado' OR DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'Domingo' THEN 0 ELSE t1.hc_tx1 END,\n\t\t\thc_tx2 = CASE WHEN DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'Domingo' THEN 0 ELSE t1.hc_tx2 END,\n\t\t\thc_tx3 = CASE WHEN DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'S\u00e1bado' OR DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'Domingo' THEN 0 ELSE t1.hc_tx3 END,\n\n\t\t\tCASE WHEN SUM(t1.hc_tx2) = 0 AND (DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'S\u00e1bado' OR DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'Domingo')\n\t\t\t\t THEN 0\n\t\t\t\t ELSE CAST((ISNULL(t1.hc_tx1, 0)*36000) + (ISNULL(t1.hc_tx2, 0)*22800) + (ISNULL(t1.hc_tx3, 0)*29520) AS BIGINT)\n\t\t\tEND,\n\t\t\n\t\t\tCASE WHEN SUM(t1.hc_tx2) = 0 AND (DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'S\u00e1bado' OR DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'Domingo')\n\t\t\t\t THEN 0\n\t\t\t\t ELSE CASE WHEN t1.data >= DATEFROMPARTS(2023,04,01)\n\t\t\t\t\t\t   THEN CAST((ISNULL(t1.hc_tx1, 0)*36000*(1-0.152333333333333)) + (ISNULL(t1.hc_tx2, 0)*22800*(1-0.131578947368421)) + (ISNULL(t1.hc_tx3, 0)*29520*(1-0.158983739837398)) AS BIGINT)\n\t\t\t\t\t\t   ELSE CAST((ISNULL(t1.hc_tx1, 0)*36000*(1-0.165078947368421)) + (ISNULL(t1.hc_tx2, 0)*22800*(1-0.165078947368421)) + (ISNULL(t1.hc_tx3, 0)*29520*(1-0.165078947368421)) AS BIGINT)\n\t\t\t\t END\n\t\t\tEND,\n\t\t\n\t\t\tSUM(t2.Dura\u00e7\u00e3o),\n\t\t\tSUM(CAST(t2.Dura\u00e7\u00e3o - ISNULL(t2.[Pausa Break], 0) - ISNULL(t2.[Pausa Lanche], 0) - ISNULL(t2.[Pausa Rapida], 0) - ISNULL(t2.[Pausa Almoco], 0) - ISNULL(t2.[Pausa Feedback], 0) - ISNULL(t2.[Pausa Treinamento], 0) - ISNULL(t2.[Pausa Banheiro], 0) - ISNULL(t2.[Pausa Sistema Interno], 0) - ISNULL(t2.[Pausa Reuniao], 0) AS BIGINT)),\n\t\t\tSUM(CAST(t2.[Pausa Break] AS BIGINT)),\n\t\t\tSUM(CAST(t2.[Pausa Outbound] AS BIGINT)), ---------------------------\n\t\t\tSUM(CAST(t2.[Pausa Lanche] AS BIGINT)),\n\t\t\tSUM(CAST(t2.[Pausa Rapida] AS BIGINT)),\n\t\t\tSUM(CAST(t2.[Pausa Almoco] AS BIGINT)),\n\t\t\tSUM(CAST(t2.[Pausa Feedback] AS BIGINT)),\n\t\t\tSUM(CAST(t2.[Pausa Sistema Externo] AS BIGINT)),  -------------------------------\n\t\t\tSUM(CAST(t2.[Pausa Treinamento] AS BIGINT)),\n\t\t\tSUM(CAST(t2.[Pausa Banheiro] AS BIGINT)),\n\t\t\tSUM(CAST(t2.[Pausa Sistema Interno] AS BIGINT)),\n\t\t\tSUM(CAST(t2.[Pausa Reuniao] AS BIGINT)),\n\t\t\tSUM(CAST(t2.HE AS BIGINT)),\n\t\t\tSUM(CAST(t2.HE_Custo AS BIGINT)),\n\n\t\t\tCASE WHEN SUM(t1.hc_tx2) = 0 \n\t\t\t\t AND SUM(t2.Dura\u00e7\u00e3o) > 0 \n\t\t\t\t AND (DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'S\u00e1bado' OR DATENAME(WEEKDAY, CAST(t2.In\u00edcio AS DATE)) = 'Domingo')\n\t\t\t\t THEN 0\n\t\t\t\t ELSE 1\n\t\t\tEND AS [aderente_ao_capacity]\n\n\t\t\tFROM loginlogout_preenchido AS t2\n\n\t\tRIGHT JOIN (\n\t\t\tSELECT *, hc_tx1 = [F_HC TX1], hc_tx2 = [F_HC TX2] / IIF(DATENAME(WEEKDAY, CAST(data AS DATE)) = 'S\u00e1bado',2,1), hc_tx3 = NULL FROM f_dimensionamento_dia\n\t\t) AS t1\n\t\tON t1.Tribo = t2.Ilha\n\t\tAND t1.data = CAST(t2.In\u00edcio AS DATE)\n\t\tGROUP BY t1.Tribo, t1.data, CAST(t2.In\u00edcio AS DATE), t1.hc_tx1, t1.hc_tx2, t1.hc_tx3\n\n\t),\n\tforecast_diario (tribo_zendesk, tribo_selecionar, data, criados, tmt_segundos, hc_geral) --SELECT * FROM dim_forecast_diario\n\tAS\n\t(\n\t\tSELECT tribo, tribo, CAST(datahora AS DATE), SUM(volume), AVG([tmt]), hc_geral = ISNULL(MAX(NULLIF(hc_tx1,0)),0) + ISNULL(MAX(NULLIF(hc_tx2,0)) / IIF(DATENAME(WEEKDAY, CAST(datahora AS DATE)) = 'S\u00e1bado',2,1),0)\n\t\tFROM dim_forecast_30min\n\t\tGROUP BY CAST(datahora AS DATE), tribo\n\t),\n\tresult (Tribo, [Data Forecast], Data, [HC 10:00h], [HC 06:20h], [HC 08:12h], [Total Contratado], [Produtivo Contratado], [Total Realizado], [Produtivo Realizado], [Pausa Break], [Pausa Outbound], [Pausa Lanche], [Pausa Rapida], [Pausa Almoco], [Pausa Feedback], [Pausa Sistema Externo], [Pausa Treinamento], [Pausa Banheiro], [Pausa Sistema Interno], [Pausa Reuniao], [Logado Real], [Logado at\u00e9 102%], [Logado Produtivo], [Logado Produtivo at\u00e9 102%], [HE], [HE Custo], [aderente_ao_capacity],[Forecast Criados], [Forecast TMT Segundos], [Forecast HC], [Tickets Entrantes], [Tempo Primeira Resposta], [Tempo Espera Solicitante], [Tempo Total Resolu\u00e7\u00e3o])  \n\tAS  \n\t(  \n\t\tSELECT\n\t\t\tCOALESCE(t1.tribo,t2.tribo_selecionar,t3.tribo_serasa,t4.tribo_serasa), COALESCE(t1.data_forecast, t2.data), COALESCE(t1.Data,t2.Data,t3.Data,t4.Data),\n\t\t\tISNULL(t1.[HC 10:00h],0), \n\t\t\tISNULL(t1.[HC 06:20h],0), \n\t\t\tISNULL(t1.[HC 08:12h],0), \n\t\t\tISNULL(t1.horas_contratadas,0), \n\t\t\tISNULL(t1.horas_contratadas_produtivas,0),\n\t\t\tISNULL(t1.dura\u00e7\u00e3o,0), \n\t\t\tISNULL(t1.dura\u00e7\u00e3o_produtiva,0), \n\t\t\tISNULL(t1.[Pausa Break],0), \n\t\t\tISNULL(t1.[Pausa Outbound],0), \n\t\t\tISNULL(t1.[Pausa Lanche],0), \n\t\t\tISNULL(t1.[Pausa Rapida],0), \n\t\t\tISNULL(t1.[Pausa Almoco],0), \n\t\t\tISNULL(t1.[Pausa Feedback],0), \n\t\t\tISNULL(t1.[Pausa Sistema Externo],0), \n\t\t\tISNULL(t1.[Pausa Treinamento],0), \n\t\t\tISNULL(t1.[Pausa Banheiro],0), \n\t\t\tISNULL(t1.[Pausa Sistema Interno],0), \n\t\t\tISNULL(t1.[Pausa Reuniao],0), \n\t\t\tCASE\t\n\t\t\t\t\tWHEN\tCAST(t1.horas_contratadas AS FLOAT) = 0 THEN 1.00\t\t\t-- Prote\u00e7\u00e3o contra erros de 'divis\u00e3o por zero'\n\t\t\t\t\tELSE\tCAST(t1.dura\u00e7\u00e3o AS FLOAT) / CAST(t1.horas_contratadas AS FLOAT)\n\t\t\t\tEND,\n\t\t\tCASE\t\n\t\t\t\t\tWHEN\tCAST(t1.horas_contratadas AS FLOAT) = 0 THEN 1.02\t\t-- Prote\u00e7\u00e3o contra erros de 'divis\u00e3o por zero'\n\t\t\t\t\tELSE\tCASE WHEN CAST(t1.dura\u00e7\u00e3o AS FLOAT) / CAST(t1.horas_contratadas AS FLOAT)> CAST(1.02 AS FLOAT) THEN 1.02 ELSE CAST(t1.dura\u00e7\u00e3o AS FLOAT) / CAST(t1.horas_contratadas AS FLOAT) END\n\t\t\t\tEND,\n\t\t\tCASE\t\n\t\t\t\t\tWHEN\tCAST(t1.horas_contratadas AS FLOAT) = 0 THEN 1.00\t\t\t-- Prote\u00e7\u00e3o contra erros de 'divis\u00e3o por zero'\n\t\t\t\t\tELSE\tCAST(t1.dura\u00e7\u00e3o_produtiva AS FLOAT) / CAST(t1.horas_contratadas_produtivas AS FLOAT)\n\t\t\t\tEND,\n\t\t\tCASE\t\n\t\t\t\t\tWHEN\tCAST(t1.horas_contratadas AS FLOAT) = 0 THEN 1.02\t\t-- Prote\u00e7\u00e3o contra erros de 'divis\u00e3o por zero'\n\t\t\t\t\tELSE\tCASE WHEN CAST(t1.dura\u00e7\u00e3o_produtiva AS FLOAT) / CAST(t1.horas_contratadas_produtivas AS FLOAT)> CAST(1.02 AS FLOAT) THEN 1.02 ELSE CAST(t1.dura\u00e7\u00e3o_produtiva AS FLOAT) / CAST(t1.horas_contratadas_produtivas AS FLOAT) END\n\t\t\t\tEND,\n\t\t\tISNULL(t1.HE,0), \n\t\t\tISNULL(t1.[HE Custo],0), \n\t\t\tISNULL(t1.[aderente_ao_capacity],0), \n\t\t\tISNULL(t2.criados,0), \n\t\t\tISNULL(t2.tmt_segundos,0), \n\t\t\tISNULL(t2.hc_geral,0), \n\t\t\tISNULL(t3.criados,0), \n\t\t\tISNULL(t4.primeira_resposta_s,0), \n\t\t\tISNULL(t4.espera_solicitante_s,0), \n\t\t\tISNULL(t4.total_resolucao_s,0) \n\t\tFROM keys AS t1\n\t\tFULL JOIN (\n\t\t\tSELECT tribo_zendesk, tribo_selecionar, data, criados, tmt_segundos, hc_geral FROM forecast_diario\n\t\t) AS t2\n\t\tON\tt1.data\t = t2.data\n\t\tAND\tt1.tribo = t2.tribo_selecionar\n\t\n\t\tLEFT JOIN (\n\t\t\tSELECT tribo_serasa=[tribo], CAST(Cria\u00e7\u00e3o AS DATE) as data, COUNT(1) as criados FROM f_tickets\n\t\t\tGROUP BY [tribo], CAST(Cria\u00e7\u00e3o AS DATE)\n\t\t) AS t3\n\t\tON\tCOALESCE(t1.Data,t2.Data) = t3.data\n\t\tAND\tCOALESCE(t1.tribo,t2.tribo_selecionar) = t3.tribo_serasa \n\t\n\t\tLEFT JOIN (\n\t\t\tSELECT t0.data, t0.tribo_serasa,\n\t\t\tAVG(t0.primeira_resposta_s) as primeira_resposta_s, \n\t\t\tAVG(t0.espera_solicitante_s) as espera_solicitante_s, \n\t\t\tAVG(t0.total_resolucao_s) as total_resolucao_s,\n\t\t\tAVG(t_tribo.tratados) as tratados\n\t\t\tFROM dim_teste_sla as t0\n\n\t\t\tLEFT JOIN( \n\t\t\t\tSELECT tribo_serasa=[tribo], CAST(Resolu\u00e7\u00e3o AS DATE) as data, COUNT([Resolvido?]) as tratados FROM f_tickets\n\t\t\t\tGROUP BY [tribo], CAST(resolu\u00e7\u00e3o AS DATE)\n\t\t\t) as t_tribo\n\t\t\tON t0.data = t_tribo.data\n\t\t\tAND t0.tribo_serasa = t_tribo.tribo_serasa\n\n\t\t\tLEFT JOIN( \n\t\t\t\tSELECT subtribo_serasa=[tribo], CAST(Resolu\u00e7\u00e3o AS DATE) as data, COUNT([Resolvido?]) as tratados FROM f_tickets\n\t\t\t\tGROUP BY [tribo], CAST(Resolu\u00e7\u00e3o AS DATE)\n\t\t\t) as t_subtribos\n\t\t\tON t0.data = t_subtribos.data\n\t\t\tAND t0.subtribo_serasa = t_subtribos.subtribo_serasa\n\t\t\tGROUP BY t0.data, t0.tribo_serasa\n\t\t) AS t4\n\t\tON\tCOALESCE(t1.Data,t2.Data) = t4.data\n\t\tAND\tCOALESCE(t1.tribo,t2.tribo_selecionar) = t4.tribo_serasa \n\t\tWHERE COALESCE(t1.Data,t2.Data) IS NOT NULL\n\t\tAND COALESCE(t1.tribo,t2.tribo_selecionar) IS NOT NULL \n\t)\n\tINSERT INTO f_dimensionamento_produtividade SELECT * FROM result\n\n\t--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([Data]) from f_dimensionamento_produtividade) WHERE [table] = 'f_dimensionamento_produtividade'\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM f_chamadas_V2 \n\n\tDELETE FROM f_chamadas_V2; \n\n\tWITH chaves (data, atendente, data_mop)\n\tAS\n\t(\n\t\tSELECT data, atendente, data_mop FROM\n\t\t(\n\t\t\tSELECT\n\t\t\t\tt2.data,\n\t\t\t\tt2.atendente,\n\t\t\t\tMAX(t1.data_atualizacao) as data_mop\n\t\t\tFROM dim_mop_eventos AS t1\n\t\t\tRIGHT JOIN (\n\t\t\t\tSELECT CAST(datahora as DATE) as data, atendente FROM dim_chamadas_intelix\n\t\t\t\tWHERE datahora >= DATEFROMPARTS(YEAR(DATEADD(MONTH, -12, GETDATE())), MONTH(DATEADD(MONTH, -12, GETDATE())), 01)\n\t\t\t) AS t2\n\t\t\tON t2.atendente = ID_intelix\n\t\t\tAND data >= data_atualizacao\n\t\t\tGROUP BY t2.data, t2.atendente\n\t\t) AS t1\n\t\tLEFT JOIN (\n\t\t\tSELECT data_atualizacao, ID_intelix, projeto FROM dim_mop_eventos \n\t\t) AS t2\n\t\tON t1.atendente = t2.ID_intelix\n\t\tAND t1.data_mop = t2.data_atualizacao\n\t\t--WHERE projeto = 'Digital'\n\t\tGROUP BY data, atendente, data_mop\n\t),\n\tcaixa AS\n\t(\n\t\tSELECT datahora, ramal, ramal_nome, atendente, atendente_nome, tipo_chamada, duracao_atendimento, duracao_espera, duracao_total, \t\n\t\tCASE\n\t\t\tWHEN status = 'Atendida' AND DATEDIFF(s, '00:00:00', duracao_total) <= 60 THEN 'Caixa postal'\n\t\t\tELSE Status\n\t\tEND AS status\n\t\tFROM dim_chamadas_intelix\n\n\t),\n\tgrude ([Data],[ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], [Duracao Total], [Duracao Atendimento], [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status])  \n\tAS  \n\t(  \n\t\tSELECT t0.data,t0.atendente,t2.ID_selecionar,t2.ID_serasa,t2.nome,t1.status,SUM(DATEDIFF(s, '00:00:00.000', t1.duracao_total)),SUM(DATEDIFF(s, '00:00:00.000', t1.duracao_atendimento)),count(*) as chamadas,t2.tribo,t2.subtribo,t2.escala,t2.jornada,t2.supervisao,t2.coordenacao,t2.status\n\t\tFROM chaves AS t0\n\t\tLEFT JOIN (\n\t\t\tSELECT * FROM caixa\n\t\t\tWHERE datahora >= DATEFROMPARTS(YEAR(DATEADD(MONTH, -12, GETDATE())), MONTH(DATEADD(MONTH, -12, GETDATE())), 01)\n\t\t) AS t1\n\t\tON t0.atendente = t1.atendente\n\t\tAND t0.data = CAST(t1.datahora AS DATE)\n\t\tLEFT JOIN (\n\t\t\tSELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos\n\t\t) AS t2\n\t\tON t0.atendente = t2.ID_intelix\n\t\tAND t0.data_mop = t2.data_atualizacao\n\t\tGROUP BY \n\t\t\tt0.data,\n\t\t\tt0.atendente,\n\t\t\tt2.ID_selecionar,\n\t\t\tt2.ID_serasa,\n\t\t\tt2.nome,\n\t\t\tt1.status,\n\t\t\tt2.tribo,\n\t\t\tt2.subtribo,\n\t\t\tt2.escala,\n\t\t\tt2.jornada,\n\t\t\tt2.supervisao,\n\t\t\tt2.coordenacao,\n\t\t\tt2.status\n\t),\n\tquartis (mes, atendente, quartil_chamadas, quartil_tma_total, quartil_tma_atendimento)\n\tAS\n\t(\n\t\tSELECT DATEFROMPARTS(YEAR(data), MONTH(data), 01), ID_intelix,\n\n\t\tCONCAT('Q',1+(RANK() OVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01) ORDER BY count(*)\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDESC)-1) * 4 /COUNT(1)\tOVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01))),\n\t\tCONCAT('Q',1+(RANK() OVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01) ORDER BY SUM([Duracao Total])/SUM([Chamadas])\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tASC)-1) * 4 /COUNT(1)\tOVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01))),\n\t\tCONCAT('Q',1+(RANK() OVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01) ORDER BY SUM([Duracao Atendimento])/NULLIF(SUM(CASE WHEN [Status Chamada]='Atendida' THEN [Chamadas] ELSE 0 END),0)\tASC)-1) * 4 /COUNT(1)\tOVER (PARTITION BY DATEFROMPARTS(YEAR(data), MONTH(data), 01)))\n\n\t\tFROM grude\n\t\tGROUP BY DATEFROMPARTS(YEAR(data), MONTH(data), 01), ID_intelix\n\n\t),\n\tfinal([Data], [ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], [Duracao Total], [Duracao Atendimento], [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status], [Quartil Chamadas], [Quartil TMA Total], [Quartil TMA Atendidas])  \n\tAS  \n\t(\n\t\tSELECT t1.[Data], [ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], fx.ToHHMMSS([Duracao Total], 'ss'), fx.ToHHMMSS([Duracao Atendimento], 'ss'), [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status], quartil_chamadas, quartil_tma_total, quartil_tma_atendimento\n\t\tFROM grude AS t1\n\t\tLEFT JOIN (\n\t\t\tSELECT * FROM quartis\n\t\t) AS t2\n\t\tON\tDATEFROMPARTS(YEAR(t1.data), MONTH(t1.data), 01) = t2.mes\n\t\tAND\tt1.ID_intelix = t2.atendente\n\t),\n\n\tconverter_tempo([Data], [ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], [Duracao Total], [Duracao Atendimento], [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status], [Quartil Chamadas], [Quartil TMA Total], [Quartil TMA Atendidas], [Duracao Total (s)], [Duracao Atendimento (s)])  \n\tAS  \n\t(\n\t\tSELECT [Data], [ID_intelix], [ID_Selecionar], [ID_Serasa], [Nome Atendente], [Status Chamada], [Duracao Total], [Duracao Atendimento], [Chamadas], [Ilha], [Subilha], [Escala], [Carga], [Supervisor], [Coordenador], [Status], [Quartil Chamadas], [Quartil TMA Total], [Quartil TMA Atendidas],\n\t\n\t\tDATEDIFF(s, '00:00:00.000', [Duracao Total]) AS [Duracao Total (s)],\n\t\n\t\tDATEDIFF(s, '00:00:00.000', [Duracao Atendimento]) AS [Duracao Atendimento (s)]\n\t\tFROM final\n\n\t)\n\tINSERT INTO f_chamadas_V2 SELECT * FROM converter_tempo\n\t--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT CAST(MAX([datahora]) AS datetime) from dim_chamadas_intelix) WHERE [table] = 'f_chamadas_V2'\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM f_chamadas_h_detalhadas \n\n\tDELETE FROM f_chamadas_h_detalhadas; \n\n\tWITH inicio(data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, duracao_total, duracao_atendimento, telefone)\n\tAs\n\t(\n\t\tSELECT CAST( t0.datahora AS DATE) as data, CAST(t0.datahora as TIME)as hora, t0.atendente, t1.Tribo, t1.[Sub Tribo], t1.Projeto, t1.Cliente, t0.Status, t0.duracao_total, t0.duracao_atendimento, t0.telefone FROM dim_chamadas_intelix\n\t\tAS t0\n\n\t\tLEFT JOIN( SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico )\n\t\tAS t1\n\t\tON CAST(t0.datahora AS DATE)= t1.[Data da Atualiza\u00e7\u00e3o]\n\t\tAND t0.atendente = t1.[ID Intelix]\n\t),\n\n\tfaixa_hora (data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, duracao_total, duracao_atendimento, telefone, faixa_hora) \n\tAS\n\t(\n\t\tSELECT data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, duracao_total, duracao_atendimento, telefone,\n\t\t\tCASE\n\t\t\t\tWHEN hora < CAST('08:00:00' AS TIME) THEN 'Fora de Escala'\n\t\t\t\tWHEN hora < CAST('09:00:00' AS TIME) THEN '08h'\n\t\t\t\tWHEN hora < CAST('10:00:00' AS TIME) THEN '09h'\n\t\t\t\tWHEN hora < CAST('11:00:00' AS TIME) THEN '10h'\n\t\t\t\tWHEN hora < CAST('12:00:00' AS TIME) THEN '11h'\n\t\t\t\tWHEN hora < CAST('13:00:00' AS TIME) THEN '12h'\n\t\t\t\tWHEN hora < CAST('14:00:00' AS TIME) THEN '13h'\n\t\t\t\tWHEN hora < CAST('15:00:00' AS TIME) THEN '14h'\n\t\t\t\tWHEN hora < CAST('16:00:00' AS TIME) THEN '15h'\n\t\t\t\tWHEN hora < CAST('17:00:00' AS TIME) THEN '16h'\n\t\t\t\tWHEN hora < CAST('18:00:00' AS TIME) THEN '17h'\n\t\t\t\tWHEN hora < CAST('19:00:00' AS TIME) THEN '18h'\n\t\t\t\tWHEN hora < CAST('20:00:00' AS TIME) THEN '19h'\n\t\t\t\tWHEN hora < CAST('21:00:00' AS TIME) THEN '20h'\t\t\n\t\t\t\tELSE 'Fora de Escala'\n\t\t\tEND \n\t\n\t\t\tFROM inicio\n\t),\n\n\tconverter_tempo(data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, [Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)])\n\tAS\n\t(\n\n\t\tSELECT [Data], [hora], [atendente], [Tribo], [Sub Tribo], Projeto, Cliente, [Status],[duracao_total], [duracao_atendimento], telefone, [faixa_hora], \n\t\n\t\tDATEDIFF(s, '00:00:00.000', [duracao_total]) AS [Duracao Total (s)],\n\t\n\t\tDATEDIFF(s, '00:00:00.000', [duracao_atendimento]) AS [Duracao Atendimento (s)]\n\t\tFROM faixa_hora\n\n\t),\n\n\tajuste_texto (data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, [Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)])\n\tAS\n\t(\tSELECT data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente,\n\t\t\n\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\tREPLACE(\n\t\t\t\t[Status], 'Numero','N\u00famero'),\n\t\t\t\t\t\t  'Nao','N\u00e3o'),\n\t\t\t\t\t\t  'Autenticacao','Autentica\u00e7\u00e3o'),\n\t\t\t\t\t\t  'Endereco','Endere\u00e7o'),\n\t\t\t\t\t\t  'Proibido','Pro\u00edbido'),\n\t\t\t\t\t\t  'Servico','Servi\u00e7o'),\n\t\t\t\t\t\t  'indisponivel','indispon\u00edvel'), \n\t\t\t\t\t\t   [Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)]\n\t\n\t\tFROM converter_tempo\n\t),\n\n\tajuste_status (data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente, Status, [Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)])\n\tAS\n\t(\tSELECT data, hora, atendente, Tribo, [Sub Tribo], Projeto, Cliente,\n\t\t\n\t\tCASE\n\t\t\tWHEN status = 'Atendida' AND [Duracao Total (s)] <= 60 THEN 'Caixa postal'\n\t\t\tELSE Status\n\t\tEND,\n\t\t\t[Duracao Total], [Duracao Atendimento], telefone, faixa_hora, [Duracao Total (s)], [Duracao Atendimento (s)]\n\t\n\t\tFROM ajuste_texto\n\t)\n\tINSERT INTO f_chamadas_h_detalhadas SELECT * FROM ajuste_status\n\n\t--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT CAST(MAX([datahora]) AS datetime) from dim_chamadas_intelix) WHERE [table] = 'f_chamadas_h_detalhadas'\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=0 BEGIN -- SELECT * FROM r_individuo_30m_mili \n\n\tDROP TABLE r_individuo_30m_mili; \n\tSELECT * INTO r_individuo_30m_mili FROM r_individuo_30min WHERE [Data] >= '01/12/2023';\n\nEND\n\n*/\n\n;EXEC sp_sys_perms;\n\n\n\n\n\nGO\n",
        "build_order": 288,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT subtribo_serasa=[tribo], CAST(Resolu\u00e7\u00e3o AS DATE) as data, COUNT([Resolvido?]) as tratados FROM f_tickets"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "SELECT",
                "SELECT * INTO r_individuo_30m_mili FROM r_individuo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "SELECT",
                "SELECT * INTO r_individuo_30m_mili FROM r_individuo_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[ToHHMMSS]": [
                "UNKNOWN",
                "ToHHMMSS"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": [
                "SELECT",
                "SELECT data_atualizacao, ID_intelix, projeto FROM dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT CAST(MAX([datahora]) AS datetime) from dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o] as data_atualizacao, [ID Intelix] as ID_intelix, [ID Selecionar] as ID_selecionar, [ID Serasa] as ID_serasa, nome, tribo, [Sub tribo] as subtribo, escala, jornada, supervis\u00e3o as supervisao, coordena\u00e7\u00e3o as coordenacao, status FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT CAST(MAX([datahora]) AS datetime) from dim_chamadas_intelix) WHERE [table] = 'f_chamadas_V2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT Tribo, [Sub Tribo], Projeto, Cliente, [Data da Atualiza\u00e7\u00e3o], [ID Intelix] FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_h_detalhadas]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT CAST(MAX([datahora]) AS datetime) from dim_chamadas_intelix) WHERE [table] = 'f_chamadas_h_detalhadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT subtribo_serasa=[tribo], CAST(Resolu\u00e7\u00e3o AS DATE) as data, COUNT([Resolvido?]) as tratados FROM f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": [
                "UNKNOWN",
                "dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_diario]": [
                "SELECT",
                "SELECT * FROM dim_forecast_diario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]": [
                "UNKNOWN",
                "f_produtividade_V2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_sla]": [
                "UNKNOWN",
                "dim_teste_sla"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_att_cemiterio]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "EXEC",
                "EXEC sp_sys_perms"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_att_cemiterio]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_cemiterio]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_chamadas",
        "type": "StoredProcedure",
        "start": 301483,
        "end": 317472,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_chamadas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[sp_att_chamadas] \n\t@datahora_inicio_forcada datetime = NULL,\n\t@datahora_fim_forcada datetime = NULL,\n\t@fonte varchar(50) ='todas'\nAS\n\nDECLARE @t_inicio datetime = GETDATE();\n\n\t\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Prepara\u00e7\u00e3o (Chaves, tabelas, variaveis, etc) \n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'f_chamadas' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[f_chamadas](\n\t\t\t [Fonte]\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[ID]\t\t\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[DataHora]\t\t\t\t[datetime]\t\tNOT\tNULL\n\t\t\t,[ID Selecionar]\t\t[varchar](10)\tNULL\t\tDEFAULT NULL\n\t\t\t,[ID Intelix]\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[ID EPBX]\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[ID Genesys]\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Dire\u00e7\u00e3o]\t\t\t\t[varchar](10)\tNOT NULL\n\t\t\t,[Grupo]\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Status]\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Dura\u00e7\u00e3o Total]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Transferida Por]\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\tDECLARE @data_min date;\n\tDECLARE @data_max date;\n\tDECLARE @datahoras_afetadas TABLE (tipo varchar(10) NOT NULL, dh_min datetime2(0) NOT NULL, dh_max datetime2(0) NOT NULL);\n\nEND\n\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @fonte='intelix'\t\tOR @fonte='todas' BEGIN\n\n\tSET @data_min = (SELECT MIN([datahora]) FROM dim_chamadas_intelix);\n\tSET @data_max = (SELECT MAX([datahora]) FROM dim_chamadas_intelix);\n\t\n\tWITH destino AS \n\t(\n\t\tSELECT * FROM [f_chamadas]\n\t\tWHERE [Fonte]\t\t\t\t  = 'Intelix'\n\t\tAND\t  [DataHora]\t\t\t\t>= @data_min\n\t\tAND\t  CAST([DataHora] as date)\t<= @data_max\n\t)\n\tMERGE INTO destino USING (\n\t\tSELECT\n\t\t\t [Fonte]\t\t\t\t=\t'Intelix'\n\t\t\t,[ID]\t\t\t\t\t=\tch.id\n\t\t\t,[DataHora]\t\t\t\t=\tch.[datahora] \n\t\t\t,[ID Selecionar]\t\t=\tmop.[ID Selecionar]\n\t\t\t,[ID Intelix]\t\t\t=\tch.[atendente]\n\t\t\t,[Dire\u00e7\u00e3o]\t\t\t\t=\tIIF(ch.[tipo_chamada] IN ('Sa\u00edda', 'Saida'), 'Outbound', 'Inbound')\n\t\t\t,[Grupo]\t\t\t\t=\tNULL\n\t\t\t,[Status]\t\t\t\t=\tCASE WHEN ch.[status] = 'Atendida' AND DATEDIFF(s, '00:00:00.000', ch.[duracao_total])<= 60 THEN 'Caixa postal'\n\t\t\t\t\t\t\t\t\t\t\t ELSE REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(ch.[Status],\t'Numero','N\u00famero'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Nao','N\u00e3o'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Autenticacao','Autentica\u00e7\u00e3o'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Endereco','Endere\u00e7o'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Proibido','Pro\u00edbido'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Servico','Servi\u00e7o'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'indisponivel','indispon\u00edvel')\n\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t,[Dura\u00e7\u00e3o Total]\t\t=\tISNULL(DATEDIFF(s, '00:00:00.000', ch.[duracao_total]), 0)\n\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t=\tISNULL(DATEDIFF(s, '00:00:00.000', ch.[duracao_total]), 0) - ISNULL(DATEDIFF(s, '00:00:00.000', ch.[duracao_atendimento]), 0)\n\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t=\tISNULL(DATEDIFF(s, '00:00:00.000', ch.[duracao_atendimento]), 0)\n\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t=\t0\n\t\t\t,[Transferida Por]\t\t=\tNULL\n\t\tFROM dim_chamadas_intelix ch\n\t\tLEFT JOIN f_mop_historico mop\n\t\tON CAST(ch.[datahora] AS DATE)= mop.[Data da Atualiza\u00e7\u00e3o]\n\t\tAND ch.[atendente] = mop.[ID Intelix]\n\n\t) AS fonte\n\tON  fonte.[ID]\t=\tdestino.[ID]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([Fonte], [ID], [DataHora], [ID Selecionar], [ID Intelix], [Dire\u00e7\u00e3o], [Status], [Grupo], [Dura\u00e7\u00e3o Total], [Dura\u00e7\u00e3o Espera], [Dura\u00e7\u00e3o Atendimento], [Dura\u00e7\u00e3o Encerramento], [Transferida Por])\n\t\tVALUES (fonte.[Fonte], fonte.[ID], fonte.[DataHora], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[Dire\u00e7\u00e3o], fonte.[Status], fonte.[Grupo], fonte.[Dura\u00e7\u00e3o Total], fonte.[Dura\u00e7\u00e3o Espera], fonte.[Dura\u00e7\u00e3o Atendimento], fonte.[Dura\u00e7\u00e3o Encerramento], fonte.[Transferida Por])\n\t\t\n\tWHEN MATCHED \n\t\tAND(\tdestino.[DataHora]\t\t\t\t\t\t\t<> fonte.[DataHora]\n\t\t\tOR\tCOALESCE(destino.[ID Selecionar], '-')\t\t<> COALESCE(fonte.[ID Selecionar], '-')\t\n\t\t\tOR\tCOALESCE(destino.[ID Intelix], '-')\t\t\t<> COALESCE(fonte.[ID Intelix], '-')\t\n\t\t\tOR\tdestino.[Dire\u00e7\u00e3o]\t\t\t\t\t\t\t<> fonte.[Dire\u00e7\u00e3o]\n\t\t\tOR\tCOALESCE(destino.[Status], '-')\t\t\t\t<> COALESCE(fonte.[Status], '-')\t\n\t\t\tOR\tCOALESCE(destino.[Grupo], '-')\t\t\t\t<> COALESCE(fonte.[Grupo], '-')\t\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Total]\t\t\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Total]\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Espera]\t\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Espera]\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Atendimento]\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Atendimento]\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Encerramento]\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Encerramento]\n\t\t\tOR\tCOALESCE(destino.[Transferida Por], '-')\t<> COALESCE(fonte.[Transferida Por], '-')\t\n\t\t\t)\n\tTHEN UPDATE SET\n\t\t \t destino.[DataHora]\t\t\t\t= fonte.[DataHora]\n\t\t\t,destino.[ID Selecionar]\t\t= fonte.[ID Selecionar]\n\t\t\t,destino.[ID Intelix]\t\t\t= fonte.[ID Intelix]\n\t\t\t,destino.[Dire\u00e7\u00e3o]\t\t\t\t= fonte.[Dire\u00e7\u00e3o]\n\t\t\t,destino.[Status]\t\t\t\t= fonte.[Status]\n\t\t\t,destino.[Grupo]\t\t\t\t= fonte.[Grupo]\n\t\t\t,destino.[Dura\u00e7\u00e3o Total]\t\t= fonte.[Dura\u00e7\u00e3o Total]\n\t\t\t,destino.[Dura\u00e7\u00e3o Espera]\t\t= fonte.[Dura\u00e7\u00e3o Espera]\n\t\t\t,destino.[Dura\u00e7\u00e3o Atendimento]\t= fonte.[Dura\u00e7\u00e3o Atendimento]\n\t\t\t,destino.[Dura\u00e7\u00e3o Encerramento]\t= fonte.[Dura\u00e7\u00e3o Encerramento]\n\t\t\t,destino.[Transferida Por]\t\t= fonte.[Transferida Por]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE\n\n\tOUTPUT $action, COALESCE(deleted.[DataHora], inserted.[DataHora]), COALESCE(deleted.[DataHora], inserted.[DataHora]) INTO @datahoras_afetadas;\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @fonte='epbx'\t\tOR @fonte='todas' BEGIN\n\n\n\tSET @data_min = (SELECT MIN([datahora]) FROM dim_chamadas_epbx);\n\tSET @data_max = (SELECT MAX([datahora]) FROM dim_chamadas_epbx);\n\n\tWITH destino AS \n\t(\n\t\tSELECT * FROM [f_chamadas]\n\t\tWHERE [Fonte]\t\t\t\t  = 'EPBX'\n\t\tAND\t  [DataHora]\t\t\t\t>= @data_min\n\t\tAND\t  CAST([DataHora] as date)\t<= @data_max\n\t)\n\tMERGE INTO destino USING (\n\t\tSELECT\n\t\t\t [Fonte]\t\t\t\t=\t'EPBX'\n\t\t\t,[ID]\t\t\t\t\t=\tch.id\n\t\t\t,[DataHora]\t\t\t\t=\tch.[datahora] \n\t\t\t,[ID Selecionar]\t\t=\tmop.[ID Selecionar]\n\t\t\t,[ID EPBX]\t\t\t\t=\tch.[ramal_atendente]\n\t\t\t,[Dire\u00e7\u00e3o]\t\t\t\t=\tCASE ch.[Grupo]\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SAC' THEN 'Inbound'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'Cadastro Positivo' THEN 'Inbound'\n\t\t\t\t\t\t\t\t\t\t\tELSE 'Outbound'\n\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t,[Status]\t\t\t\t=\tREPLACE(REPLACE(ch.[status_detalhe], 'Numero Invalido','N\u00famero Inv\u00e1lido'), 'Atendido', 'Atendida')\n\t\t\t,[Grupo]\t\t\t\t=\tNULL\n\t\t\t,[Dura\u00e7\u00e3o Total]\t\t=\tISNULL(DATEDIFF(s, '00:00:00.000', ch.[duracao_total]), 0)\n\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t=\tISNULL(DATEDIFF(s, '00:00:00.000', ch.[duracao_total]), 0) - ISNULL(DATEDIFF(s, '00:00:00.000', ch.[duracao_atendimento]), 0)\n\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t=\tISNULL(DATEDIFF(s, '00:00:00.000', ch.[duracao_atendimento]), 0)\n\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t=\t0\n\t\t\t,[Transferida Por]\t\t=\tNULL\n\t\tFROM dim_chamadas_epbx ch \n\t\tLEFT JOIN f_mop_historico mop\n\t\tON CAST(ch.[datahora] AS DATE)= mop.[Data da Atualiza\u00e7\u00e3o]\n\t\tAND ch.[ramal_atendente] = mop.[ID EPBX]\n\t) AS fonte\n\tON  fonte.[ID]\t=\tdestino.[ID]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([Fonte], [ID], [DataHora], [ID Selecionar], [ID EPBX], [Dire\u00e7\u00e3o], [Status], [Grupo], [Dura\u00e7\u00e3o Total], [Dura\u00e7\u00e3o Espera], [Dura\u00e7\u00e3o Atendimento], [Dura\u00e7\u00e3o Encerramento], [Transferida Por])\n\t\tVALUES (fonte.[Fonte], fonte.[ID], fonte.[DataHora], fonte.[ID Selecionar], fonte.[ID EPBX], fonte.[Dire\u00e7\u00e3o], fonte.[Status], fonte.[Grupo], fonte.[Dura\u00e7\u00e3o Total], fonte.[Dura\u00e7\u00e3o Espera], fonte.[Dura\u00e7\u00e3o Atendimento], fonte.[Dura\u00e7\u00e3o Encerramento], fonte.[Transferida Por])\n\t\t\n\tWHEN MATCHED \n\t\tAND(\tdestino.[DataHora]\t\t\t\t\t\t\t<> fonte.[DataHora]\n\t\t\tOR\tCOALESCE(destino.[ID Selecionar], '-')\t\t<> COALESCE(fonte.[ID Selecionar], '-')\t\n\t\t\tOR\tCOALESCE(destino.[ID EPBX], '-')\t\t\t<> COALESCE(fonte.[ID EPBX], '-')\t\n\t\t\tOR\tdestino.[Dire\u00e7\u00e3o]\t\t\t\t\t\t\t<> fonte.[Dire\u00e7\u00e3o]\n\t\t\tOR\tCOALESCE(destino.[Status], '-')\t\t\t\t<> COALESCE(fonte.[Status], '-')\t\n\t\t\tOR\tCOALESCE(destino.[Grupo], '-')\t\t\t\t<> COALESCE(fonte.[Grupo], '-')\t\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Total]\t\t\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Total]\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Espera]\t\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Espera]\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Atendimento]\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Atendimento]\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Encerramento]\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Encerramento]\n\t\t\tOR\tCOALESCE(destino.[Transferida Por], '-')\t<> COALESCE(fonte.[Transferida Por], '-')\t\n\t\t\t)\n\tTHEN UPDATE SET\n\t\t \t destino.[DataHora]\t\t\t\t= fonte.[DataHora]\n\t\t\t,destino.[ID Selecionar]\t\t= fonte.[ID Selecionar]\n\t\t\t,destino.[ID EPBX]\t\t\t\t= fonte.[ID EPBX]\n\t\t\t,destino.[Dire\u00e7\u00e3o]\t\t\t\t= fonte.[Dire\u00e7\u00e3o]\n\t\t\t,destino.[Status]\t\t\t\t= fonte.[Status]\n\t\t\t,destino.[Grupo]\t\t\t\t= fonte.[Grupo]\n\t\t\t,destino.[Dura\u00e7\u00e3o Total]\t\t= fonte.[Dura\u00e7\u00e3o Total]\n\t\t\t,destino.[Dura\u00e7\u00e3o Espera]\t\t= fonte.[Dura\u00e7\u00e3o Espera]\n\t\t\t,destino.[Dura\u00e7\u00e3o Atendimento]\t= fonte.[Dura\u00e7\u00e3o Atendimento]\n\t\t\t,destino.[Dura\u00e7\u00e3o Encerramento]\t= fonte.[Dura\u00e7\u00e3o Encerramento]\n\t\t\t,destino.[Transferida Por]\t\t= fonte.[Transferida Por]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE\n\n\tOUTPUT $action, COALESCE(deleted.[DataHora], inserted.[DataHora]), COALESCE(deleted.[DataHora], inserted.[DataHora]) INTO @datahoras_afetadas;\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @fonte='genesys'\t\tOR @fonte='todas' BEGIN\n\n\n\tSET @data_min = (SELECT MIN([inicio]) FROM dim_chamadas_genesys);\n\tSET @data_max = (SELECT MAX([inicio]) FROM dim_chamadas_genesys);\n\t\n\t\n\t\n\tWITH destino AS \n\t(\n\t\tSELECT * FROM [f_chamadas]\n\t\tWHERE [Fonte]\t\t\t\t  = 'GENESYS'\n\t\tAND\t  [DataHora]\t\t\t\t>= @data_min\n\t\tAND\t  CAST([DataHora] as date)\t<= @data_max\n\t)\n\tMERGE INTO destino USING (\n\t\tSELECT\n\t\t\t [Fonte]\t\t\t\t=\t'GENESYS'\n\t\t\t,[ID]\t\t\t\t\t=\tch.[ID]\n\t\t\t,[DataHora]\t\t\t\t=\tch.[DataHora]\n\t\t\t,[ID Selecionar]\t\t=\tmop.[ID Selecionar]\n\t\t\t,[ID Genesys]\t\t\t=\tch.[ID Genesys]\n\t\t\t,[Dire\u00e7\u00e3o]\t\t\t\t=\tIIF(ch.[Dire\u00e7\u00e3o] = 'inbound', 'Inbound', 'Outbound')\n\t\t\t,[Status]\t\t\t\t=\tch.[Status]\n\t\t\t,[Grupo]\t\t\t\t=\tch.[Grupo]\n\t\t\t,[Dura\u00e7\u00e3o Total]\t\t=\tch.[Dura\u00e7\u00e3o Total]\n\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t=\tch.[Dura\u00e7\u00e3o Espera]\n\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t=\tch.[Dura\u00e7\u00e3o Atendimento]\n\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t=\tch.[Dura\u00e7\u00e3o Encerramento]\n\t\t\t,[Transferida Por]\t\t=\tch.[Transferida Por]\n\t\tFROM\n\t\t(\n\t\t\tSELECT\n\t\t\t\t [ID]\t\t\t\t\t= CONCAT('GENESYS-', [id_conversa])\n\t\t\t\t,[Dire\u00e7\u00e3o]\t\t\t\t= [direcao]\n\t\t\t\t,[DataHora]\t\t\t\t= COALESCE(MIN(IIF([tipo_participante] = 'acd', [inicio], NULL)), MIN([inicio]))\n\t\t\t\t,[ID Genesys]\t\t\t= MIN([id_usuario])\n\t\t\t\t--,[Grupo]\t\t\t\t= MAX(IIF([tipo_participante] = 'acd', [nome_participante], NULL))\n\t\t\t\t,[Grupo]\t\t\t\t= COALESCE(MAX(IIF([tipo_participante] = 'acd', [nome_participante], NULL)), MAX(IIF([tipo_participante] = 'agent', [departamento_usuario], NULL)))\n\t\t\t\t,[Status]\t\t\t\t= IIF(MIN([id_usuario]) IS NOT NULL AND (SUM(ISNULL(DATEDIFF(ms, '00:00:00.000', [duracao_encerramento]), 0)) > 0 OR SUM(ISNULL(DATEDIFF(ms, '00:00:00.000', [duracao_atendimento]), 0)) > 0), 'Atendida','N\u00e3o Atendida')\n\t\t\t\t--,[Status]\t\t\t\t= IIF(SUM(ISNULL(DATEDIFF(s, '00:00:00.000', [duracao_atendimento]), 0)) > 0, 'Atendida','N\u00e3o Atendida')\n\t\t\t\t,[Dura\u00e7\u00e3o Total]\t\t= SUM(ISNULL(DATEDIFF(s, '00:00:00.000', [duracao_total]), 0))\n\t\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t= SUM(ISNULL(DATEDIFF(s, '00:00:00.000', [duracao_espera]), 0))\n\t\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t= SUM(ISNULL(DATEDIFF(s, '00:00:00.000', [duracao_atendimento]), 0))\n\t\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t= SUM(ISNULL(DATEDIFF(s, '00:00:00.000', [duracao_encerramento]), 0))\n\t\t\t\t,[Transferida Por]\t\t= MAX([Transferida Por]) \n\t\t\tFROM (SELECT *, [Transferida Por] = LAG(IIF(DATEDIFF(s, '00:00:00.000', [duracao_total])=0 AND DATEDIFF(s, '00:00:00.000', [duracao_espera]) = 0 AND DATEDIFF(s, '00:00:00.000', [duracao_atendimento]) = 0  AND DATEDIFF(s, '00:00:00.000', [duracao_encerramento]) = 0 ,NULL,[id_usuario])) OVER (PARTITION BY [id_conversa], [tipo_participante] ORDER BY [inicio] ASC) FROM dim_chamadas_genesys) _\n\t\t\tGROUP BY id_conversa, [direcao]\n\t\t) ch\n\t\tLEFT JOIN f_mop_historico mop\n\t\tON CAST(ch.[DataHora] AS DATE)= mop.[Data da Atualiza\u00e7\u00e3o]\n\t\tAND ch.[ID Genesys] = mop.[ID Genesys]\n\t\tWHERE NOT ([Grupo] IS NULL AND [Dire\u00e7\u00e3o] = 'inbound') AND NOT ([Grupo] = 'S_ICOM') -- Ignorar casos inbound que ficaram na URA/N\u00e3o entraram em nenhuma fila/S\u00e3o do ICOM\n\t) AS fonte\n\tON  fonte.[ID]\t=\tdestino.[ID]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([Fonte], [ID], [DataHora], [ID Selecionar], [ID Genesys], [Dire\u00e7\u00e3o], [Status], [Grupo], [Dura\u00e7\u00e3o Total], [Dura\u00e7\u00e3o Espera], [Dura\u00e7\u00e3o Atendimento], [Dura\u00e7\u00e3o Encerramento], [Transferida Por])\n\t\tVALUES (fonte.[Fonte], fonte.[ID], fonte.[DataHora], fonte.[ID Selecionar], fonte.[ID Genesys], fonte.[Dire\u00e7\u00e3o], fonte.[Status], fonte.[Grupo], fonte.[Dura\u00e7\u00e3o Total], fonte.[Dura\u00e7\u00e3o Espera], fonte.[Dura\u00e7\u00e3o Atendimento], fonte.[Dura\u00e7\u00e3o Encerramento], fonte.[Transferida Por])\n\t\t\n\tWHEN MATCHED \n\t\tAND(\tdestino.[DataHora]\t\t\t\t\t\t\t<> fonte.[DataHora]\n\t\t\tOR\tCOALESCE(destino.[ID Selecionar], '-')\t\t<> COALESCE(fonte.[ID Selecionar], '-')\t\n\t\t\tOR\tCOALESCE(destino.[ID Genesys], '-')\t\t\t<> COALESCE(fonte.[ID Genesys], '-')\t\n\t\t\tOR\tdestino.[Dire\u00e7\u00e3o]\t\t\t\t\t\t\t<> fonte.[Dire\u00e7\u00e3o]\t\n\t\t\tOR\tCOALESCE(destino.[Status], '-')\t\t\t\t<> COALESCE(fonte.[Status], '-')\t\t\n\t\t\tOR\tCOALESCE(destino.[Grupo], '-')\t\t\t\t<> COALESCE(fonte.[Grupo], '-')\t\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Total]\t\t\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Total]\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Espera]\t\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Espera]\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Atendimento]\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Atendimento]\n\t\t\tOR\tdestino.[Dura\u00e7\u00e3o Encerramento]\t\t\t\t<> fonte.[Dura\u00e7\u00e3o Encerramento]\n\t\t\tOR\tCOALESCE(destino.[Transferida Por], '-')\t<> COALESCE(fonte.[Transferida Por], '-')\t\n\t\t\t)\n\tTHEN UPDATE SET\n\t\t \t destino.[DataHora]\t\t\t\t= fonte.[DataHora]\n\t\t\t,destino.[ID Selecionar]\t\t= fonte.[ID Selecionar]\n\t\t\t,destino.[ID Genesys]\t\t\t= fonte.[ID Genesys]\n\t\t\t,destino.[Dire\u00e7\u00e3o]\t\t\t\t= fonte.[Dire\u00e7\u00e3o]\n\t\t\t,destino.[Status]\t\t\t\t= fonte.[Status]\n\t\t\t,destino.[Grupo]\t\t\t\t= fonte.[Grupo]\n\t\t\t,destino.[Dura\u00e7\u00e3o Total]\t\t= fonte.[Dura\u00e7\u00e3o Total]\n\t\t\t,destino.[Dura\u00e7\u00e3o Espera]\t\t= fonte.[Dura\u00e7\u00e3o Espera]\n\t\t\t,destino.[Dura\u00e7\u00e3o Atendimento]\t= fonte.[Dura\u00e7\u00e3o Atendimento]\n\t\t\t,destino.[Dura\u00e7\u00e3o Encerramento]\t= fonte.[Dura\u00e7\u00e3o Encerramento]\n\t\t\t,destino.[Transferida Por]\t\t= fonte.[Transferida Por]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE\n\n\tOUTPUT $action, COALESCE(deleted.[DataHora], inserted.[DataHora]), COALESCE(deleted.[DataHora], inserted.[DataHora]) INTO @datahoras_afetadas;\n\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Finaliza\u00e7\u00e3o (Limpeza de nulos, c\u00e1lculos finais, etc)\n\n\n\tDECLARE @min datetime2(0) = COALESCE(@datahora_inicio_forcada, (SELECT MIN(dh_min) FROM @datahoras_afetadas))\n\tDECLARE @max datetime2(0) = COALESCE(@datahora_fim_forcada, (SELECT MAX(dh_max) FROM @datahoras_afetadas))\n\n\tSELECT [Retorno]=CONCAT('Chamadas atualizadas (fonte: ',@fonte,') ',@min,' - ',@max , ' (dura\u00e7\u00e3o: ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio, GETDATE()), 0) as time(0)),')')\n\t\n\tIF @min IS NOT NULL and @max IS NOT NULL\n\tBEGIN\n\t\tPRINT ''\n\t\tPRINT CONCAT('Periodo atualizado = ',@min, ' - ', @max) \n\t\tPRINT ''\n\n\t\t--EXEC sp_att_resumos @datahora_inicio = @min, @datahora_fim = @max, @metrica = 'chamadas'\n\n\tEND\n\tELSE\n\tBEGIN\n\t\tPRINT ''\n\t\tPRINT 'Nenhuma altera\u00e7\u00e3o na base de chamadas'\n\t\tPRINT ''\n\tEND\nEND\n\n\nGO\n",
        "build_order": 289,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": [
                "SELECT",
                "SELECT * FROM [f_chamadas]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "UNKNOWN",
                "dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_epbx]": [
                "UNKNOWN",
                "dim_chamadas_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys]": [
                "SELECT",
                "SELECT *, [Transferida Por] = LAG(IIF(DATEDIFF(s, '00:00:00.000', [duracao_total])=0 AND DATEDIFF(s, '00:00:00.000', [duracao_espera]) = 0 AND DATEDIFF(s, '00:00:00.000', [duracao_atendimento]) = 0  AND DATEDIFF(s, '00:00:00.000', [duracao_encerramento]) = 0 ,NULL,[id_usuario])) OVER (PARTITION BY [id_conversa], [tipo_participante] ORDER BY [inicio] ASC) FROM dim_chamadas_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": [
                "SELECT",
                "SELECT * FROM [f_chamadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_att_chamadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "EXEC",
                "EXEC sp_att_resumos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_att_chamadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_epbx]": [
                "EXEC",
                "EXEC sp_att_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys]": [
                "EXEC",
                "EXEC sp_att_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_intelix]": [
                "EXEC",
                "EXEC sp_att_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_chamadas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_epbx]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_epbx]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_chamadas_epbx",
        "type": "StoredProcedure",
        "start": 317472,
        "end": 323246,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_chamadas_epbx]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE         PROCEDURE [dbo].[sp_att_chamadas_epbx]\n\t@datahora_inicio_forcada datetime = NULL,\n\t@datahora_fim_forcada datetime = NULL \nAS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_chamadas_epbx' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_chamadas_epbx]( \n\t\t\t[id]\t\t\t\t\t[varchar](100)\tNOT NULL,\n\t\t\t[datahora]\t\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[id_global_epbx]\t\t[varchar](50)\tNOT NULL,\n\t\t\t[ramal_atendente]\t\t[int]\t\t\tNOT NULL,\n\t\t\t[id_atendente]\t\t\t[int]\t\t\tNULL,\n\t\t\t[nome_atendente]\t\t[varchar](100)\tNULL,\n\t\t\t[status]\t\t\t\t[varchar](50)\tNOT NULL,\n\t\t\t[status_detalhe]\t\t[varchar](50)\tNOT NULL,\n\t\t\t[grupo]\t\t\t\t\t[varchar](50)\tNULL,\n\t\t\t[servico]\t\t\t\t[varchar](50)\tNULL,\n\t\t\t[campanha]\t\t\t\t[varchar](50)\tNULL,\n\t\t\t[categoria]\t\t\t\t[varchar](50)\tNULL,\n\t\t\t[telefone]\t\t\t\t[bigint]\t\tNULL,\n\t\t\t[duracao_total]\t\t\t[time](0)\t\tNOT NULL,\n\t\t\t[duracao_atendimento]\t[time](0)\t\tNOT NULL,\n\t\t\t[duracao_espera]\t\t[time](0)\t\tNOT NULL,\n\t\t) ON [PRIMARY]\n\tEND\n\t\t \n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM dim_chamadas_epbx\n\t\tWHERE [datahora]\t\t\t\t>= @datahora_inicio_forcada\n\t\tAND\t  CAST([datahora] as date)\t<= @datahora_fim_forcada\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\n\t\t\t [id]\t\t\t\t\t= CONCAT('EPBX-', DATEDIFF(DAY,'1899-12-30',MIN([Data]))+(DATEDIFF(s,0,MIN([Inicio]))/86400.0),'-', [Ramal],'-', ROW_NUMBER() OVER (PARTITION BY [Ramal], MIN([Data]), MIN([Inicio]) ORDER BY MIN([Data]), MIN([Inicio])), '-', [GlobalId])\n\t\t\t,[datahora]\t\t\t\t= CAST(MIN([Data]) AS datetime) + CAST(MIN([Inicio]) AS datetime)\n\t\t\t,[id_global_epbx]\t\t= [GlobalId] \n\t\t\t,[ramal_atendente]\t\t= [Ramal]\n\t\t\t,[id_atendente]\t\t\t= [UsuarioId]\n\t\t\t,[nome_atendente]\t\t= [Usuario]\n\t\t\t,[status]\t\t\t\t= [Status]\n\t\t\t,[status_detalhe]\t\t= [StatusDetalhe]\n\t\t\t,[grupo]\t\t\t\t= [Grupo]\n\t\t\t,[servico]\t\t\t\t= [Servico]\n\t\t\t,[campanha]\t\t\t\t= [Campanha]\n\t\t\t,[categoria]\t\t\t= [Categoria]\n\t\t\t,[telefone]\t\t\t\t= TRY_CAST([Cliente] AS bigint)\n\t\t\t,[duracao_total]\t\t= CAST(DATEADD(s, SUM([DuracaoDetalhe]), 0) AS time(0))\n\t\t\t,[duracao_atendimento]\t= CAST(DATEADD(s, SUM(IIF([Evento] = 'Em Atendimento', [DuracaoDetalhe], 0)), 0) AS time(0))\n\t\t\t,[duracao_espera]\t\t= CAST(DATEADD(s, SUM(IIF([Evento] = 'Em Atendimento', 0, [DuracaoDetalhe])), 0) AS time(0))\n\t\tFROM (\n\t\t\tSELECT\n\t\t\t\t [GlobalId]\n\t\t\t\t,[Data]\n\t\t\t\t,[Inicio]\n\t\t\t\t,[Evento]\n\t\t\t\t,[DuracaoDetalhe]\n\t\t\t\t,[Cliente]\n\t\t\t\t,[UsuarioId]\t\t= LAST_VALUE([UsuarioID])\t\tOVER (PARTITION BY [GlobalId] ORDER BY [Ordem] ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n\t\t\t\t,[Usuario]\t\t\t= LAST_VALUE([Usuario])\t\t\tOVER (PARTITION BY [GlobalId] ORDER BY [Ordem] ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n\t\t\t\t,[Ramal]\t\t\t= LAST_VALUE([Ramal])\t\t\tOVER (PARTITION BY [GlobalId] ORDER BY [Ordem] ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n\t\t\t\t,[Status]\t\t\t= LAST_VALUE([Status])\t\t\tOVER (PARTITION BY [GlobalId] ORDER BY [Ordem] ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n\t\t\t\t,[StatusDetalhe]\t= LAST_VALUE([StatusDetalhe])\tOVER (PARTITION BY [GlobalId] ORDER BY [Ordem] ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n\t\t\t\t,[Grupo]\t\t\t= LAST_VALUE([Grupo])\t\t\tOVER (PARTITION BY [GlobalId] ORDER BY [Ordem] ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n\t\t\t\t,[Servico]\t\t\t= LAST_VAlUE([Servico])\t\t\tOVER (PARTITION BY [GlobalId] ORDER BY [Ordem] ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n\t\t\t\t,[Campanha]\t\t\t= LAST_VALUE([Campanha])\t\tOVER (PARTITION BY [GlobalId] ORDER BY [Ordem] ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n\t\t\t\t,[Categoria]\t\t= LAST_VALUE([Campanha])\t\tOVER (PARTITION BY [GlobalId] ORDER BY [Ordem] ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)\n\t\t\tFROM [Brboots_Serasa].[db_owner].[BilheteDetalhado]\n\t\t) _\n\t\tWHERE CAST([Data] AS datetime) + CAST([Inicio] AS datetime) >= @datahora_inicio_forcada AND CAST([Data] AS datetime) + CAST([Inicio] AS datetime) <= @datahora_fim_forcada\n\t\tGROUP BY [GlobalId], [UsuarioId], [Ramal], [Usuario], [Status], [StatusDetalhe], [Grupo], [Servico], [Campanha], [Categoria], [Cliente]\n\t) AS fonte\n\tON fonte.[id]\t= destino.[id]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([id], [datahora], [id_global_epbx], [ramal_atendente], [id_atendente], [nome_atendente], [status], [status_detalhe], [grupo], [servico], [campanha], [categoria], [telefone], [duracao_total], [duracao_atendimento], [duracao_espera]) \n\t\tVALUES (fonte.[id], fonte.[datahora], fonte.[id_global_epbx], fonte.[ramal_atendente], fonte.[id_atendente], fonte.[nome_atendente], fonte.[status], fonte.[status_detalhe], fonte.[grupo], fonte.[servico], fonte.[campanha], fonte.[categoria], fonte.[telefone], fonte.[duracao_total], fonte.[duracao_atendimento], fonte.[duracao_espera])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t destino.[id_global_epbx]\t\t= fonte.[id_global_epbx]\n\t\t\t,destino.[datahora]\t\t\t\t= fonte.[datahora]\n\t\t\t,destino.[ramal_atendente]\t\t= fonte.[ramal_atendente]\n\t\t\t,destino.[id_atendente]\t\t\t= fonte.[id_atendente]\n\t\t\t,destino.[nome_atendente]\t\t= fonte.[nome_atendente]\n\t\t\t,destino.[status]\t\t\t\t= fonte.[status]\n\t\t\t,destino.[status_detalhe]\t\t= fonte.[status_detalhe]\n\t\t\t,destino.[grupo]\t\t\t\t= fonte.[grupo]\n\t\t\t,destino.[servico]\t\t\t\t= fonte.[servico]\n\t\t\t,destino.[campanha]\t\t\t\t= fonte.[campanha]\n\t\t\t,destino.[categoria]\t\t\t= fonte.[categoria]\n\t\t\t,destino.[telefone]\t\t\t\t= fonte.[telefone]\n\t\t\t,destino.[duracao_total]\t\t= fonte.[duracao_total]\n\t\t\t,destino.[duracao_atendimento]\t= fonte.[duracao_atendimento]\n\t\t\t,destino.[duracao_espera]\t\t= fonte.[duracao_espera]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\n\n\tEXEC sp_att_chamadas @datahora_inicio_forcada, @datahora_fim_forcada, @fonte='epbx'\n\n\nGO\n",
        "build_order": 290,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_epbx]": [
                "SELECT",
                "SELECT * FROM dim_chamadas_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "EXEC",
                "EXEC sp_att_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_epbx]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_att_chamadas_epbx]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_epbx]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_att_chamadas_epbx]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_chamadas_genesys",
        "type": "StoredProcedure",
        "start": 323246,
        "end": 329720,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_chamadas_genesys]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE           PROCEDURE [dbo].[sp_att_chamadas_genesys] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t--SELECT * INTO teste_genesys FROM #temp0\n\t--DROP Table dim_chamadas_genesys\n\t--DROP Table teste_genesys\n\t--DROP Table #temp0\n\n\t\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_chamadas_genesys' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_chamadas_genesys]( \n\t\t\t[id]\t\t\t\t\t[varchar](100)\tNOT NULL,\n\t\t\t[id_conversa]\t\t\t[varchar](100)\tNOT NULL,\n\t\t\t[direcao]\t\t\t\t[varchar](25)\tNOT NULL,\n\t\t\t[id_participante]\t\t[varchar](100)\tNOT NULL,\n\t\t\t[tipo_participante]\t\t[varchar](100)\tNOT NULL,\n\t\t\t[nome_participante]\t\t[varchar](100)\tNULL,\n\t\t\t[id_usuario]\t\t\t[varchar](100)\tNULL,\n\t\t\t[nome_usuario]\t\t\t[varchar](100)\tNULL,\n\t\t\t[email_usuario]\t\t\t[varchar](100)\tNULL,\n\t\t\t[divisao_usuario]\t\t[varchar](100)\tNULL,\n\t\t\t[departamento_usuario]\t[varchar](100)\tNULL,\n\t\t\t[titulo_usuario]\t\t[varchar](100)\tNULL,\n\t\t\t[inicio_chamada]\t\t[datetime]\t\tNOT NULL,\n\t\t\t[fim_chamada]\t\t\t[datetime]\t\tNULL,\n\t\t\t[duracao_total_chamada]\t[time](3)\t\tNOT NULL,\n\t\t\t[inicio]\t\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[fim]\t\t\t\t\t[datetime]\t\tNULL,\n\t\t\t[duracao_total]\t\t\t[time](3)\t\tNOT NULL,\n\t\t\t[duracao_espera]\t\t[time](3)\t\tNOT NULL,\n\t\t\t[duracao_atendimento]\t[time](3)\t\tNOT NULL,\n\t\t\t[duracao_encerramento]\t[time](3)\t\tNOT NULL,\n\t\t) ON [PRIMARY]\n\tEND\n\t\n\tDECLARE @data_min date = (SELECT MIN(DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127))) FROM #temp0)\n\tDECLARE @data_max date = (SELECT MAX(DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127))) FROM #temp0)\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM dim_chamadas_genesys\n\t\tWHERE [inicio]\t\t\t\t >= @data_min\n\t\tAND\t  CAST([inicio] as date) <= @data_max\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\t\n\t\t\t\n\t\t\t [id]\t\t\t\t\t\t\t= CONCAT('GENESYS-', DATEDIFF(DAY,'1899-12-30',CAST(DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127)) as date))+(DATEDIFF(s,CAST(DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127)) as date),DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127)))/86400.0),'-', [conversationId],'-', [participantId],'-', ROW_NUMBER() OVER (PARTITION BY [conversationId], [participantId], DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127)) ORDER BY DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127))))\n\t\t\t,[id_conversa]\t\t\t\t\t= [conversationId]\n\t\t\t,[direcao]\t\t\t\t\t\t= [originatingDirection]\n\t\t\t,[id_participante]\t\t\t\t= [participantId]\n\t\t\t,[tipo_participante]\t\t\t= [purpose]\n\t\t\t,[nome_participante]\t\t\t= [participantName]\n\t\t\t,[id_usuario]\t\t\t\t\t= [userId]\n\t\t\t,[nome_usuario]\t\t\t\t\t= [name]\n\t\t\t,[email_usuario]\t\t\t\t= [email]\n\t\t\t,[divisao_usuario]\t\t\t\t= [division.name]\n\t\t\t,[departamento_usuario]\t\t\t= [department]\n\t\t\t,[titulo_usuario]\t\t\t\t= [title] \n\t\t\t,[inicio_chamada]\t\t\t\t= DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127))\n\t\t\t,[fim_chamada]\t\t\t\t\t= DATEADD(HOUR, -3, CONVERT(datetime, [conversationEnd], 127))\n\t\t\t,[duracao_total_chamada]\t\t= CASE\tWHEN DATEADD(HOUR, -3, CONVERT(datetime, [conversationEnd], 127)) IS NULL \n\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN CAST('00:00:00' AS time) \n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE CAST(DATEADD(SECOND, DATEDIFF_BIG(SECOND, DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127)), DATEADD(HOUR, -3, CONVERT(datetime, [conversationEnd], 127)))%60, \n\t\t\t\t\t\t \t\t\t\t\t\t\t\t\t  DATEADD(MINUTE, DATEDIFF_BIG(SECOND, DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127)), DATEADD(HOUR, -3, CONVERT(datetime, [conversationEnd], 127)))/60, \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t  '00:00:00')) AS time) END\n\t\t\t,[inicio]\t\t\t\t\t\t= DATEADD(HOUR, -3, [segmentStart])\n\t\t\t,[fim]\t\t\t\t\t\t\t= DATEADD(HOUR, -3, [segmentEnd])\n\t\t\t,[duracao_total]\t\t\t\t= DATEADD(MILLISECOND, ISNULL([tAnswered], 0) + ISNULL([tTalk], 0) + ISNULL([tAcw], 0), '00:00:00')\n\t\t\t,[duracao_espera]\t\t\t\t= DATEADD(MILLISECOND, ISNULL([tAnswered], 0), '00:00:00')\n\t\t\t,[duracao_atendimento]\t\t\t= DATEADD(MILLISECOND, ISNULL([tTalk], 0), '00:00:00')\n\t\t\t,[duracao_encerramento]\t\t\t= DATEADD(MILLISECOND, ISNULL([tAcw], 0), '00:00:00')\n\n\t\tFROM #temp0\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([id], [id_conversa], [direcao], [id_participante], [tipo_participante], [nome_participante], [id_usuario], [nome_usuario], [email_usuario], [divisao_usuario], [departamento_usuario], [titulo_usuario], [inicio_chamada], [fim_chamada], [duracao_total_chamada], [inicio], [fim], [duracao_total], [duracao_espera], [duracao_atendimento], [duracao_encerramento]) \n\t\tVALUES (fonte.[id], fonte.[id_conversa], fonte.[direcao], fonte.[id_participante], fonte.[tipo_participante], fonte.[nome_participante], fonte.[id_usuario], fonte.[nome_usuario], fonte.[email_usuario], fonte.[divisao_usuario], fonte.[departamento_usuario], fonte.[titulo_usuario], fonte.[inicio_chamada], fonte.[fim_chamada], fonte.[duracao_total_chamada], fonte.[inicio], fonte.[fim], fonte.[duracao_total], fonte.[duracao_espera], fonte.[duracao_atendimento], fonte.[duracao_encerramento])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\t destino.[id]\t\t\t\t\t\t= fonte.[id]\n\t\t,destino.[id_conversa]\t\t\t\t= fonte.[id_conversa]\n\t\t,destino.[direcao]\t\t\t\t\t= fonte.[direcao]\n\t\t,destino.[id_participante]\t\t\t= fonte.[id_participante]\n\t\t,destino.[tipo_participante]\t\t= fonte.[tipo_participante]\n\t\t,destino.[nome_participante]\t\t= fonte.[nome_participante]\n\t\t,destino.[id_usuario]\t\t\t\t= fonte.[id_usuario]\n\t\t,destino.[nome_usuario]\t\t\t\t= fonte.[nome_usuario]\n\t\t,destino.[email_usuario]\t\t\t= fonte.[email_usuario]\n\t\t,destino.[divisao_usuario]\t\t\t= fonte.[divisao_usuario]\n\t\t,destino.[departamento_usuario]\t\t= fonte.[departamento_usuario]\n\t\t,destino.[titulo_usuario]\t\t\t= fonte.[titulo_usuario]\n\t\t,destino.[inicio_chamada]\t\t\t= fonte.[inicio_chamada]\n\t\t,destino.[fim_chamada]\t\t\t\t= fonte.[fim_chamada]\n\t\t,destino.[duracao_total_chamada]\t= fonte.[duracao_total_chamada]\n\t\t,destino.[inicio]\t\t\t\t\t= fonte.[inicio]\n\t\t,destino.[fim]\t\t\t\t\t\t= fonte.[fim]\n\t\t,destino.[duracao_total]\t\t\t= fonte.[duracao_total]\n\t\t,destino.[duracao_espera]\t\t\t= fonte.[duracao_espera]\n\t\t,destino.[duracao_atendimento]\t\t= fonte.[duracao_atendimento]\n\t\t,destino.[duracao_encerramento]\t\t= fonte.[duracao_encerramento]\n\n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\n\n\tSET @data_max = CAST(CAST(@data_max as date) as datetime) + CAST(CAST('23:59:59' as time) as datetime) \n\t--EXEC sp_att_chamadas @datahora_inicio_forcada=@data_min, @datahora_fim_forcada=@data_max, @fonte='genesys'\n\n\n\nGO\n",
        "build_order": 291,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys]": [
                "SELECT",
                "SELECT * FROM dim_chamadas_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "EXEC",
                "EXEC sp_att_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_chamadas_genesys]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_chamadas_genesys]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys_manual]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys_manual]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_chamadas_genesys_manual",
        "type": "StoredProcedure",
        "start": 329720,
        "end": 333163,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_chamadas_genesys_manual]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   PROCEDURE [dbo].[sp_att_chamadas_genesys_manual] AS\n\n\n\t--DROP TABLE IF EXISTS dim_chamadas_genesys_manual\n\t--DROP TABLE IF EXISTS #temp0\n\t--DROP TABLE IF EXISTS #temp1\n\t--DROP TABLE IF EXISTS teste\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_chamadas_genesys_manual' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_chamadas_genesys_manual](\n\t\t\t [In\u00edcio do intervalo]\t\t\t\t[datetime]\t\tNOT NULL\n\t\t\t,[Fim do intervalo]\t\t\t\t\t[datetime]\t\tNOT NULL\n\t\t\t,[Intervalo conclu\u00eddo]\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[Filtros]\t\t\t\t\t\t\t[varchar](250)\tNULL\n\t\t\t,[Tipo de m\u00e9dia]\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[ID da fila]\t\t\t\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[Nome da fila]\t\t\t\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[Oferta]\t\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[Resposta]\t\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[% de resposta]\t\t\t\t\t[float]\t\t\tNULL\n\t\t\t,[Abandono]\t\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[% de abandono]\t\t\t\t\t[float]\t\t\tNULL\n\t\t\t,[VMA]\t\t\t\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[% de n\u00ed\u00advel de servi\u00e7o]\t\t\t[float]\t\t\tNULL\n\t\t\t,[% de alvos do n\u00edvel de servi\u00e7o]\t[float]\t\t\tNULL\n\t\t\t,[Tempo m\u00e9dio de espera]\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Tratamento m\u00e9dio]\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Conversa\u00e7\u00e3o m\u00e9dia]\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Espera m\u00e9dia]\t\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[TPC m\u00e9dio]\t\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Em espera]\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[Transferir]\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[CONVERSA\u00c7\u00c3O TRATADO]\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Espera m\u00e9dia_tratado]\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Pondera\u00e7\u00e3o TMA]\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[NS Ajustado]\t\t\t\t\t\t[float]     \tNULL\n\t\t) ON [PRIMARY]\n\tEND;\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = '#temp1' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [#temp1](\n\t\t\t [In\u00edcio do intervalo]\t\t\t\t[datetime]\t\tNULL\n\t\t\t,[Fim do intervalo]\t\t\t\t\t[datetime]\t\tNULL\n\t\t\t,[Intervalo conclu\u00eddo]\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[Filtros]\t\t\t\t\t\t\t[varchar](250)\tNULL\n\t\t\t,[Tipo de m\u00e9dia]\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[ID da fila]\t\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[Nome da fila]\t\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[Oferta]\t\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[Resposta]\t\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[% de resposta]\t\t\t\t\t[float]\t\t\tNULL\n\t\t\t,[Abandono]\t\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[% de abandono]\t\t\t\t\t[float]\t\t\tNULL\n\t\t\t,[VMA]\t\t\t\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[% de n\u00ed\u00advel de servi\u00e7o]\t\t\t[float]\t\t\tNULL\n\t\t\t,[% de alvos do n\u00edvel de servi\u00e7o]\t[float]\t\t\tNULL\n\t\t\t,[Tempo m\u00e9dio de espera]\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Tratamento m\u00e9dio]\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Conversa\u00e7\u00e3o m\u00e9dia]\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Espera m\u00e9dia]\t\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[TPC m\u00e9dio]\t\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Em espera]\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[Transferir]\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[CONVERSA\u00c7\u00c3O TRATADO]\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Espera m\u00e9dia_tratado]\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[Pondera\u00e7\u00e3o TMA]\t\t\t\t\t[decimal](16,6)\tNULL\n\t\t\t,[NS Ajustado]\t\t\t\t\t\t[float]     \tNULL\n\t\t) ON [PRIMARY]\n\tEND;\n\n\tINSERT INTO #temp1 SELECT * FROM #temp0;\n\n\t\n\t;DECLARE @min_periodo [datetime] = (SELECT MIN([In\u00edcio do intervalo]) FROM #temp1)\n\t;DECLARE @max_periodo [datetime] = (SELECT MAX([In\u00edcio do intervalo]) FROM #temp1)\n\n\t;DELETE FROM dim_chamadas_genesys_manual WHERE [In\u00edcio do intervalo] >= @min_periodo AND [In\u00edcio do intervalo] <= @max_periodo \n\t;INSERT INTO dim_chamadas_genesys_manual SELECT * FROM #temp1 WHERE [In\u00edcio do intervalo] IS NOT NULL AND [In\u00edcio do intervalo] IS NOT NULL ;\n\t\n\n\t\n\t\n\n\nGO\n",
        "build_order": 292,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys_manual]": [
                "INSERT",
                "INSERT INTO dim_chamadas_genesys_manual"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys_manual]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_att_chamadas_genesys_manual]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_genesys_manual]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_att_chamadas_genesys_manual]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_intelix]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_intelix]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_chamadas_intelix",
        "type": "StoredProcedure",
        "start": 333163,
        "end": 336438,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_chamadas_intelix]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   PROCEDURE [dbo].[sp_att_chamadas_intelix] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\tDECLARE @max_data datetime2(0) = (SELECT MAX([Data]) FROM dim_calendario) \n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_chamadas_intelix' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_chamadas_intelix](\n\t\t\t [id]\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[datahora]\t\t\t\t[datetime]\t\tNOT NULL\n\t\t\t,[ramal]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[ramal_nome]\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[atendente]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[atendente_nome]\t\t[varchar](150)\tNOT NULL\n\t\t\t,[telefone]\t\t\t\t[bigint]\t\tNULL\n\t\t\t,[tronco]\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[ddr]\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[destino_interno_tipo]\t[varchar](50)\tNULL\n\t\t\t,[destino_interno_nome]\t[varchar](50)\tNULL\n\t\t\t,[tipo_chamada]\t\t\t[varchar](50)\tNULL\n\t\t\t,[status]\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[duracao_total]\t\t[time](7)\t\tNULL\n\t\t\t,[duracao_atendimento]\t[time](7)\t\tNULL\n\t\t\t,[duracao_espera]\t\t[time](7)\t\tNULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\t\t\t \n\tDECLARE @data_min date = (SELECT MIN([Data]) FROM #temp0)\n\tDECLARE @data_max date = (SELECT MAX([Data]) FROM #temp0)\n\n\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM dim_chamadas_intelix\n\t\tWHERE [datahora]\t\t\t\t>= @data_min\n\t\tAND\t  CAST([datahora] as date)\t<= @data_max\n\t)\n\tMERGE INTO destino \n\tUSING\n\t(\n\t\tSELECT id=CONCAT('INTELIX-', DATEDIFF(DAY,'1899-12-30',[Data])+(DATEDIFF(s,CAST([Data] as date),[Data])/86400.0),'-', [Atendente],'-', ROW_NUMBER() OVER (PARTITION BY [Atendente], [Data] ORDER BY [Data])), * FROM #temp0\n\t)\n\tAS fonte\n\tON fonte.[id]\t= destino.[id]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([id], [datahora], [ramal], [ramal_nome], [atendente], [atendente_nome], [telefone], [tronco], [ddr], [destino_interno_tipo], [destino_interno_nome], [tipo_chamada], [status], [duracao_total], [duracao_atendimento], [duracao_espera]) \n\t\tVALUES (fonte.[id], fonte.[Data], fonte.[Ramal], fonte.[Nome Ramal], fonte.[Atendente], fonte.[Nome Atendente], fonte.[Numero], fonte.[Tronco], fonte.[DDR], fonte.[Tipo Destino Interno], fonte.[Nome Destino Interno], fonte.[Tipo Chamada], fonte.[Status], fonte.[Duracao Total], fonte.[Duracao Atendimento], fonte.[Duracao Espera])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\t destino.[datahora]\t\t\t\t= fonte.[Data]\n\t\t,destino.[ramal]\t\t\t\t= fonte.[Ramal]\n\t\t,destino.[ramal_nome]\t\t\t= fonte.[Nome Ramal]\n\t\t,destino.[atendente]\t\t\t= fonte.[Atendente]\n\t\t,destino.[atendente_nome]\t\t= fonte.[Nome Atendente]\n\t\t,destino.[telefone]\t\t\t\t= fonte.[Numero]\n\t\t,destino.[tronco]\t\t\t\t= fonte.[Tronco]\n\t\t,destino.[ddr]\t\t\t\t\t= fonte.[DDR]\n\t\t,destino.[destino_interno_tipo]\t= fonte.[Tipo Destino Interno]\n\t\t,destino.[destino_interno_nome]\t= fonte.[Nome Destino Interno]\n\t\t,destino.[tipo_chamada]\t\t\t= fonte.[Tipo Chamada]\n\t\t,destino.[status]\t\t\t\t= fonte.[Status]\n\t\t,destino.[duracao_total]\t\t= fonte.[Duracao Total]\n\t\t,destino.[duracao_atendimento]\t= fonte.[Duracao Atendimento]\n\t\t,destino.[duracao_espera]\t\t= fonte.[Duracao Espera]\n\n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\n\n\tDECLARE @max DATE = DATEADD(DAY, 1, @data_max) \n\n\tEXEC sp_att_chamadas @datahora_inicio_forcada=@data_min, @datahora_fim_forcada=@max, @fonte='intelix'\n\nGO\n",
        "build_order": 293,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "SELECT",
                "SELECT * FROM dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT MAX([Data]) FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "EXEC",
                "EXEC sp_att_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_intelix]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_att_chamadas_intelix]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas_intelix]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_att_chamadas_intelix]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_enps]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_enps]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_enps",
        "type": "StoredProcedure",
        "start": 336438,
        "end": 337148,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_enps]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\nCREATE      PROCEDURE [dbo].[sp_att_enps]\nAS\nset dateformat dmy;\n\n\nDELETE FROM dim_enps\nWHERE titulo_pesquisa = (SELECT TOP(1) [titulo_pesquisa] FROM #temp0) \nAND [id] in (SELECT DISTINCT [id] FROM #temp0) \n\nINSERT INTO dim_enps\nSELECT \n[titulo_pesquisa],\n[simple_text],\n[choice_metadata.weight], \n[pages.questions.heading], \n[id], \n[total_time],\nCONVERT(DATETIME,LEFT(CAST([date_modified] AS varchar),19),126),\nCONVERT(DATETIME,LEFT(CAST([date_created] AS varchar),19),126)\nFROM #temp0 \n\n\nDROP TABLE IF EXISTS f_enps\nSELECT * INTO f_enps FROM vw_enps  \n\n\nGO\n",
        "build_order": 294,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_enps]": [
                "SELECT",
                "SELECT * INTO f_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_enps]": [
                "INSERT",
                "INSERT INTO dim_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_enps]": [
                "SELECT",
                "SELECT * INTO f_enps FROM vw_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_enps]": [
                "SELECT",
                "SELECT * INTO f_enps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_enps]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[sp_att_enps]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_enps]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[sp_att_enps]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_metas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_metas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_forecast_metas",
        "type": "StoredProcedure",
        "start": 337148,
        "end": 342409,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_forecast_metas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n--EXEC [sp_att_forecast_metas]\n\nCREATE           PROCEDURE [dbo].[sp_att_forecast_metas] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n----------------------------------------------------------------------------------------------------------------------------\n\t-- DROP TABLE IF EXISTS dim_forecast_metas;\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_forecast_metas' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_forecast_metas](\n\t\t\t [m\u00eas]\t\t\t\t\t\t\t[date]\t\t\tNOT NULL\n\t\t\t,[arquivo_fonte]\t\t\t\t[varchar](75)\tNOT NULL\n\t\t\t,[data_recebimento]\t\t\t\t[date]\t\t\tNOT NULL\n\t\t\t,[tribo]\t\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[volume_projetado]\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[tmt_segundos]\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[tmt_minutos]\t\t\t\t\t[time]\t\t\tNOT NULL\n\t\t\t,[hc_geral]\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[hc_tx1]\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[hc_tx2]\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[tempo_contratado_tx2]\t\t\t[time]\t\t\tNOT NULL\n\t\t\t,[pausas_nr_tx2]\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[treinamento_tx2]\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[tempo_produtivo_tx2]\t\t\t[time]\t\t\tNOT NULL\n\t\t\t,[tickets_PA_dia_tx2]\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[tempo_contratado_tx1]\t\t\t[time]\t\t\tNOT NULL\n\t\t\t,[pausas_nr_tx1]\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[outras_indisp]\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[tempo_produtivo_tx1]\t\t\t[time]\t\t\tNOT NULL\n\t\t\t,[tickets_PA_dia_tx1]\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[capacidade_tickets_mensal]\t[float]\t\t\tNOT NULL\n\t\t\t,[%capacidade_tickets_mensal]\t[float]\t\t\tNOT NULL\n\t\t\t,[custo_tx1]\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[custo_tx2]\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[custo_total_pa]\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[NS]\t\t\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[SLA]\t\t\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[abandono]\t\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[rechamada]\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[short_call]\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[NPS]\t\t\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[instabilidade]\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[casos_n\u00e3o_resolvidos]\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[phishing]\t\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[valor_pa]\t\t\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[obs]\t\t\t\t\t\t\t[varchar](500)\tNULL\n\n\t\t) ON [PRIMARY]\n\tEND\n\n\t\n\tIF OBJECT_ID('tempdb..#temp0') IS NOT NULL\n\tBEGIN\t\n\t\tDELETE FROM dim_forecast_metas; \n\t\tINSERT INTO dim_forecast_metas \n\t\tSELECT \n\t\t\t [m\u00eas]\t\t\t\t\t\t\t= TRY_CAST([M\u00eas] AS DATE)\n\t\t\t,[arquivo_fonte]\t\t\t\t= ISNULL(TRY_CAST([Nome Arquivo Serasa (ex: Selecionar - FY23 Curvas (Janeiro-Fevereiro-Mar\u00e7o) v03)] AS VARCHAR(75)), '-')\n\t\t\t,[data_recebimento]\t\t\t\t= ISNULL(TRY_CAST([Data e-mail Serasa] AS DATE), '01/01/2000')\n\t\t\t,[tribo]\t\t\t\t\t\t= ISNULL(TRY_CAST([Tribe] AS VARCHAR(50)), '-')\n\t\t\t,[volume_projetado]\t\t\t\t= ISNULL(TRY_CAST([Volume Projetado] AS FLOAT), 0) \n\t\t\t,[tmt_segundos]\t\t\t\t\t= ISNULL(TRY_CAST([TMT em Segundos] AS FLOAT), 0)\n\t\t\t,[tmt_minutos]\t\t\t\t\t= ISNULL(TRY_CAST([TMT em Minutos] AS TIME), '00:00:00')\n\t\t\t,[hc_geral]\t\t\t\t\t\t= ISNULL(TRY_CAST([Hc\u00b4s] AS INT), 0)\n\t\t\t,[hc_tx1]\t\t\t\t\t\t= ISNULL(TRY_CAST([Taxa 1] AS INT), 0)\n\t\t\t,[hc_tx2]\t\t\t\t\t\t= ISNULL(TRY_CAST([Taxa 2] AS INT), 0)\n\t\t\t,[tempo_contratado_tx2]\t\t\t= ISNULL(TRY_CAST([Tempo Contratado Taxa 2] AS TIME), '00:00:00')\n\t\t\t,[pausas_nr_tx2]\t\t\t\t= ISNULL(TRY_CAST([Pausas NR Taxa 2] AS FLOAT), 0)\n\t\t\t,[treinamento_tx2]\t\t\t\t= ISNULL(TRY_CAST([Treinamento Taxa 2] AS FLOAT), 0)\n\t\t\t,[tempo_produtivo_tx2]\t\t\t= ISNULL(TRY_CAST([Tempo Produtivo Taxa 2] AS TIME), '00:00:00')\n\t\t\t,[tickets_PA_dia_tx2]\t\t\t= ISNULL(TRY_CAST([Ticket\u00b4s por PA Dia Taxa 2] AS FLOAT), 0)\n\t\t\t,[tempo_contratado_tx1]\t\t\t= ISNULL(TRY_CAST([Tempo Contratado Taxa 1] AS TIME), '00:00:00')\n\t\t\t,[pausas_nr_tx1]\t\t\t\t= ISNULL(TRY_CAST([Pausas NR Taxa 1] AS FLOAT), 0)\n\t\t\t,[outras_indisp]\t\t\t\t= ISNULL(TRY_CAST([Outras Indisp] AS FLOAT), 0)\n\t\t\t,[tempo_produtivo_tx1]\t\t\t= ISNULL(TRY_CAST([Tempo Produtivo Taxa 1] AS TIME), '00:00:00')\n\t\t\t,[tickets_PA_dia_tx1]\t\t\t= ISNULL(TRY_CAST([Ticket\u00b4s por PA Dia Taxa 1] AS FLOAT), 0)\n\t\t\t,[capacidade_tickets_mensal]\t= ISNULL(TRY_CAST([Capacidade Ticket\u00b4s Mensal] AS FLOAT), 0)\n\t\t\t,[%capacidade_tickets_mensal]\t= ISNULL(TRY_CAST([Capacidade Mensal%] AS FLOAT), 0)\n\t\t\t,[custo_tx1]\t\t\t\t\t= ISNULL(TRY_CAST([Custo Tx 1] AS FLOAT), 0)\n\t\t\t,[custo_tx2]\t\t\t\t\t= ISNULL(TRY_CAST([Custo Tx 2] AS FLOAT), 0)\n\t\t\t,[custo_total_pa]\t\t\t\t= ISNULL(TRY_CAST([Custo Total P.A.] AS FLOAT), 0)\n\t\t\t,[NS]\t\t\t\t\t\t\t= ISNULL(TRY_CAST(IIF(TRY_CAST([Tribe] AS VARCHAR(50))\t\tIN ('0800 Premium','SAC','Cadastro Positivo'), [NS (Voz) / SLA em horas (Digital)], 0) AS FLOAT), 0)\n\t\t\t,[SLA]\t\t\t\t\t\t\t= ISNULL(TRY_CAST(IIF(TRY_CAST([Tribe] AS VARCHAR(50))\tNOT IN ('0800 Premium','SAC','Cadastro Positivo'), [NS (Voz) / SLA em horas (Digital)], 0) AS FLOAT), 0)\n\t\t\t,[abandono]\t\t\t\t\t\t= ISNULL(TRY_CAST([Abandono] AS FLOAT), 0)\n\t\t\t,[rechamada]\t\t\t\t\t= ISNULL(TRY_CAST([Rechamada] AS FLOAT), 0)\n\t\t\t,[short_call]\t\t\t\t\t= ISNULL(TRY_CAST([Short Call] AS FLOAT), 0)\n\t\t\t,[NPS]\t\t\t\t\t\t\t= ISNULL(TRY_CAST([NPS] AS FLOAT), 0)\n\t\t\t,[instabilidade]\t\t\t\t= ISNULL(TRY_CAST([Instabilidade] AS FLOAT), 0)\n\t\t\t,[casos_n\u00e3o_resolvidos]\t\t\t= ISNULL(TRY_CAST([Casos N\u00e3o Resolvidos] AS FLOAT), 0)\n\t\t\t,[phishing]\t\t\t\t\t\t= ISNULL(TRY_CAST([Phishing] AS FLOAT), 0)\n\t\t\t,[valor_pa]\t\t\t\t\t\t= ISNULL(TRY_CAST([Valor PA] AS FLOAT), 0)\n\t\t\t,[obs]\t\t\t\t\t\t\t= ISNULL(TRY_CAST([OBS] AS VARCHAR(500)), '-')\n\t\tFROM #temp0\n\t\tWHERE TRY_CAST([M\u00eas] AS DATE) IS NOT NULL\n\tEND\n\n\n\n\n\nGO\n",
        "build_order": 295,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]": [
                "INSERT",
                "INSERT INTO dim_forecast_metas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_metas]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_forecast_metas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_metas]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_forecast_metas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_penalidades]": [
                "EXEC",
                "EXEC [sp_att_forecast_metas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_penalidades]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_penalidades]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_forecast_penalidades",
        "type": "StoredProcedure",
        "start": 342409,
        "end": 343915,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_forecast_penalidades]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n--EXEC [sp_att_forecast_metas]\n\nCREATE           PROCEDURE [dbo].[sp_att_forecast_penalidades] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n----------------------------------------------------------------------------------------------------------------------------\n\t-- DROP TABLE IF EXISTS dim_forecast_metas;\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_forecast_penalidades' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_forecast_penalidades](\n\t\t\t [data_inicio]\t[date]\tNOT NULL\n\t\t\t,[data_fim]\t\t[date]\tNOT NULL\n\t\t\t,[faixa]\t\t[int]\tNOT NULL\n\t\t\t,[minimo]\t\t[float]\tNOT NULL\n\t\t\t,[maximo]\t\t[float]\tNOT NULL\n\t\t\t,[penalidade]\t[float]\tNOT NULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\n\tIF OBJECT_ID('tempdb..#temp0') IS NOT NULL\n\tBEGIN\t\n\t\tDELETE FROM dim_forecast_penalidades; \n\t\tINSERT INTO dim_forecast_penalidades \n\t\tSELECT \n\t\t\t [data_inicio]\t= ISNULL(TRY_CAST([DATA INICIO] AS DATE), '01/01/2000')\n\t\t\t,[data_fim]\t\t= ISNULL(TRY_CAST([DATA FIM] AS DATE), '01/01/2000')\n\t\t\t,[faixa]\t\t= ISNULL(TRY_CAST([FAIXA] AS INT), 0)\n\t\t\t,[minimo]\t\t= ISNULL(TRY_CAST([M\u00cdNIMO] AS FLOAT), 0) \n\t\t\t,[maximo]\t\t= ISNULL(TRY_CAST([M\u00c1XIMO] AS FLOAT), 0) \n\t\t\t,[penalidade]\t= ISNULL(TRY_CAST([FAIXAS DE PENALTY] AS FLOAT), 0) \n\t\tFROM #temp0\n\t\tWHERE TRY_CAST([DATA INICIO] AS DATE) IS NOT NULL\n\t\tAND\t  TRY_CAST([DATA FIM] AS DATE) IS NOT NULL\n\tEND\n\n\n\n\n\nGO\n",
        "build_order": 296,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_metas]": [
                "DROP",
                "DROP TABLE IF EXISTS dim_forecast_metas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_penalidades]": [
                "INSERT",
                "INSERT INTO dim_forecast_penalidades"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_metas]": [
                "EXEC",
                "EXEC [sp_att_forecast_metas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_penalidades]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_forecast_penalidades]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_forecast_penalidades]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_forecast_penalidades]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_detalhado]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_detalhado]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_historico_faturamento_detalhado",
        "type": "StoredProcedure",
        "start": 343915,
        "end": 349951,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_historico_faturamento_detalhado]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE             PROCEDURE [dbo].[sp_att_historico_faturamento_detalhado] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n----------------------------------------------------------------------------------------------------------------------------\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_historico_faturamento_detalhado' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].dim_historico_faturamento_detalhado(\n\t\t [M\u00eas]                                        [date]          NOT NULL\n\t\t,[Tipo Atendimento]                           [varchar](MAX)  NOT NULL\n\t\t,[Tribo]                                      [varchar](MAX)  NOT NULL\n\t\t,[Fat Forecast]                               [float]         NOT NULL\n\t\t,[Fat LOG Real]                               [float]         NOT NULL\n\t\t,[% Fat LOG Real]                             [float]         NOT NULL\n\t\t,[Diferen\u00e7a Fat LOG]                          [float]         NOT NULL\n\t\t,[Penalidades]                                [float]         NOT NULL\n\t\t,[Faturamento sem expurgos]                   [float]         NOT NULL\n\t\t,[Penalidades com expurgo]                    [float]         NOT NULL\n\t\t,[Faturamento Final (Realizado)]              [float]         NOT NULL\n\t\t,[TMT Forecast]                               [int]           NOT NULL\n\t\t,[TMT Real]                                   [int]           NOT NULL\n\t\t,[Penalidade TMT]                             [float]         NOT NULL\n\t\t,[SLA Forecast]                               [int]           NOT NULL\n\t\t,[SLA Real]                                   [float]         NOT NULL\n\t\t,[Penalidade SLA]                             [float]         NOT NULL\n\t\t,[NPS Forecast]                               [float]         NOT NULL\n\t\t,[NPS Real]                                   [float]         NOT NULL    \n\t\t,[Penalidade NPS]                             [float]         NOT NULL\n\t\t,[TMA Forecast]                               [int]           NOT NULL\n\t\t,[TMA Real]                                   [int]           NOT NULL\n\t\t,[Penalidade TMA]                             [float]         NOT NULL\n\t\t,[NS Forecast]                                [float]         NOT NULL\n\t\t,[NS Real]                                    [float]         NOT NULL\n\t\t,[Penalidade NS]                              [float]         NOT NULL\n\t\t,[Abandono Forecast]                          [float]         NOT NULL\n\t\t,[Abandono Real]                              [float]         NOT NULL\n\t\t,[Penalidade Abandono]                        [float]         NOT NULL \n\t\t,[Penalidade Total]                           [float]         NOT NULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\n\tIF OBJECT_ID('tempdb..#temp0') IS NOT NULL\n\tBEGIN\t\n\t\tDELETE FROM dim_historico_faturamento_detalhado; \n\t\tINSERT INTO dim_historico_faturamento_detalhado \n\t\tSELECT\n\t\t [M\u00eas]                                        = ISNULL(TRY_CAST([M\u00eas] AS DATE), '01/01/2000')\n\t\t,[Tipo Atendimento]                           = ISNULL(TRY_CAST([Tipo Atendimento] AS VARCHAR(MAX)), '0')\n\t\t,[Tribo]                                      = ISNULL(TRY_CAST([Tribo] AS VARCHAR(MAX)), '0')\n\t\t,[Fat Forecast]                               = ISNULL(TRY_CAST([Fat Forecast] AS FLOAT), 0)\n\t\t,[Fat LOG Real]                               = ISNULL(TRY_CAST([Fat LOG Real] AS FLOAT), 0)\n\t\t,[% Fat LOG Real]                             = ISNULL(TRY_CAST([% Fat LOG Real] AS FLOAT), 0)\n\t\t,[Diferen\u00e7a Fat LOG]                          = ISNULL(TRY_CAST([Diferen\u00e7a Fat LOG] AS FLOAT), 0)\n\t\t,[Penalidades]                                = ISNULL(TRY_CAST([Penalidades] AS FLOAT), 0)\n\t\t,[Faturamento sem expurgos]                   = ISNULL(TRY_CAST([Faturamento sem expurgos] AS FLOAT), 0)\n\t\t,[Penalidades com expurgo]                    = ISNULL(TRY_CAST([Penalidades com expurgo ] AS FLOAT), 0)\n\t\t,[Faturamento Final (Realizado)]              = ISNULL(TRY_CAST([Faturamento Final (Realizado)] AS FLOAT), 0)\n\t\t,[TMT Forecast]                               = ISNULL(TRY_CAST([TMT Forecast] AS INT), 0)\n\t\t,[TMT Real]                                   = ISNULL(TRY_CAST([TMT Real] AS INT), 0)\n\t\t,[Penalidade TMT]                             = ISNULL(TRY_CAST([Penalidade TMT] AS FLOAT), 0)\n\t\t,[SLA Forecast]                               = ISNULL(TRY_CAST([SLA Forecast] AS INT), 0)\n\t\t,[SLA Real]                                   = ISNULL(TRY_CAST([SLA Real] AS FLOAT), 0)\n\t\t,[Penalidade SLA]                             = ISNULL(TRY_CAST([Penalidade SLA] AS FLOAT), 0)\n\t\t,[NPS Forecast]                               = ISNULL(TRY_CAST([NPS Forecast] AS FLOAT), 0)\n\t\t,[NPS Real]                                   = ISNULL(TRY_CAST([NPS Real] AS FLOAT), 0)    \n\t\t,[Penalidade NPS]                             = ISNULL(TRY_CAST([Penalidade NPS] AS FLOAT), 0)\n\t\t,[TMA Forecast]                               = ISNULL(TRY_CAST([TMA Forecast] AS INT), 0)\n\t\t,[TMA Real]                                   = ISNULL(TRY_CAST([TMA Real] AS INT), 0)\n\t\t,[Penalidade TMA]                             = ISNULL(TRY_CAST([Penalidade TMA] AS FLOAT), 0)\n\t\t,[NS Forecast]                                = ISNULL(TRY_CAST([NS Forecast] AS FLOAT), 0)\n\t\t,[NS Real]                                    = ISNULL(TRY_CAST([NS Real] AS FLOAT), 0)\n\t\t,[Penalidade NS]                              = ISNULL(TRY_CAST([Penalidade NS] AS FLOAT), 0)\n\t\t,[Abandono Forecast]                          = ISNULL(TRY_CAST([Abandono Forecast] AS FLOAT), 0)\n\t\t,[Abandono Real]                              = ISNULL(TRY_CAST([Abandono Real] AS FLOAT), 0)\n\t\t,[Penalidade Abandono]                        = ISNULL(TRY_CAST([Penalidade Abandono] AS FLOAT), 0) \n\t\t,[Penalidade Total]                           = ISNULL(TRY_CAST([Penalidade Total] AS FLOAT), 0)\n\n\t\tFROM #temp0\n\t\tWHERE TRY_CAST([M\u00eas] AS DATE) IS NOT NULL\n\t\tAND\t  TRY_CAST([Tribo] AS VARCHAR(MAX)) IS NOT NULL\n\tEND\n\n\n\n\n\nGO\n",
        "build_order": 297,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_detalhado]": [
                "INSERT",
                "INSERT INTO dim_historico_faturamento_detalhado"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_detalhado]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_att_historico_faturamento_detalhado]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_detalhado]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_att_historico_faturamento_detalhado]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_resumido]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_resumido]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_historico_faturamento_resumido",
        "type": "StoredProcedure",
        "start": 349951,
        "end": 353000,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_historico_faturamento_resumido]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE           PROCEDURE [dbo].[sp_att_historico_faturamento_resumido] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t--------------------------------------------------------------------------------------------------------------------------\n\n\t\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_historico_faturamento_resumido' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].dim_historico_faturamento_resumido(\n\t\t [Modelo]                           [varchar](MAX)  NOT NULL\n\t\t,[M\u00eas]                              [date]          NOT NULL\n\t\t,[NF]                               [int]           NOT NULL\n\t\t,[Valor]                            [float]         NOT NULL\n\t\t,[Considera\u00e7\u00f5es]                    [varchar](MAX)  NOT NULL\n\t\t,[Capacity]                         [float]         NOT NULL\n\t\t,[Hist\u00f3rico Plan]                   [float]         NOT NULL\n\t\t,[Diferen\u00e7a Log]                    [float]         NOT NULL\n\t\t,[Penalty]                          [float]         NOT NULL\n\t\t,[Total Descontos]                  [float]         NOT NULL\n\t\t,[Diferen\u00e7a Nota faturada]          [float]         NOT NULL\n\t\t,[Considera\u00e7\u00e3o]                    [varchar](MAX)  NOT NULL\n\t\t,[Obseva\u00e7\u00e3o (Operacionais)]         [varchar](MAX)  NOT NULL\n\t\t,[Obseva\u00e7\u00e3o (Planejamento)]         [varchar](MAX)  NOT NULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\n\tIF OBJECT_ID('tempdb..#temp0') IS NOT NULL\n\tBEGIN\t\n\t\tDELETE FROM dim_historico_faturamento_resumido; \n\t\tINSERT INTO dim_historico_faturamento_resumido \n\t\tSELECT \n\t\t [Modelo]                           = ISNULL(TRY_CAST([Modelo] AS VARCHAR(MAX)), '0')\n\t\t,[M\u00eas]                              = ISNULL(TRY_CAST([M\u00eas] AS DATE), '01/01/2000')\n\t\t,[NF]                               = ISNULL(TRY_CAST([NF] AS INT), 0)\n\t\t,[Valor]                            = ISNULL(TRY_CAST([Valor] AS FLOAT), 0)\n\t\t,[Considera\u00e7\u00f5es]                    = ISNULL(TRY_CAST([Considera\u00e7\u00f5es] AS VARCHAR(MAX)), '0')\n\t\t,[Capacity]                         = ISNULL(TRY_CAST([Capacity] AS FLOAT), 0)\n\t\t,[Hist\u00f3rico Plan]                   = ISNULL(TRY_CAST([Hist\u00f3rico Plan] AS FLOAT), 0)\n\t\t,[Diferen\u00e7a Log]                    = ISNULL(TRY_CAST([Diferen\u00e7a Log] AS FLOAT), 0)\n\t\t,[Penalty]                          = ISNULL(TRY_CAST([Penalty] AS FLOAT), 0)\n\t\t,[Total Descontos]                  = ISNULL(TRY_CAST([Total Descontos] AS FLOAT), 0)\n\t\t,[Diferen\u00e7a Nota faturada]          = ISNULL(TRY_CAST([Diferen\u00e7a Nota faturada] AS FLOAT), 0)\n\t\t,[Considera\u00e7\u00e3o]                    = ISNULL(TRY_CAST([Considera\u00e7\u00e3o ] AS VARCHAR(MAX)), '0')\n\t\t,[Obseva\u00e7\u00e3o (Operacionais)]         = ISNULL(TRY_CAST([Obseva\u00e7\u00e3o (Operacionais)] AS VARCHAR(MAX)), '0')\n\t\t,[Obseva\u00e7\u00e3o (Planejamento)]         = ISNULL(TRY_CAST([Obseva\u00e7\u00e3o (Planejamento)] AS VARCHAR(MAX)), '0')\n\n\t\tFROM #temp0\n\t\tWHERE TRY_CAST([M\u00eas] AS DATE) IS NOT NULL\n\t\tAND\t  TRY_CAST([Modelo] AS VARCHAR(MAX)) IS NOT NULL\n\tEND\n\n\n\n\n\nGO\n",
        "build_order": 298,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_historico_faturamento_resumido]": [
                "INSERT",
                "INSERT INTO dim_historico_faturamento_resumido"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_resumido]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_historico_faturamento_resumido]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_historico_faturamento_resumido]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_historico_faturamento_resumido]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_log",
        "type": "StoredProcedure",
        "start": 353000,
        "end": 371497,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_log]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE       PROCEDURE [dbo].[sp_att_log] \n\t@datahora_inicio_forcada datetime = NULL,\n\t@datahora_fim_forcada datetime = NULL, \n\t@fonte varchar(50) = 'todas'\nAS\n\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Prepara\u00e7\u00e3o (Chaves, tabelas, variaveis, etc) \n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\t\n\n\t-- DROP TABLE IF EXISTS [f_log];\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'f_log' and xtype='U')\n\tBEGIN\n\t\tCREATE TABLE [dbo].[f_log](\n\t\t\t[Fonte]\t\t\t\t[varchar](10)\tNOT NULL,\n\t\t\t[ID Selecionar]\t\t[varchar](10)\tNULL,\n\t\t\t[ID Intelix]\t\t[int]\t\t\tNULL,\n\t\t\t[ID EPBX]\t\t\t[int]\t\t\tNULL,\n\t\t\t[ID Genesys]\t\t[varchar](100)\tNULL,\n\t\t\t[ID Secullum]\t\t[int]\t\t\tNULL,\n\t\t\t[Evento]\t\t\t[varchar](100)\tNOT NULL,\n\t\t\t[In\u00edcio]\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[Fim]\t\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[Dura\u00e7\u00e3o]\t\t\t[bigint]\t\tNOT NULL,\n\t\t\t[Ajustado?]\t\t\t[varchar](10)\tNOT NULL,\n\t\t\t[In\u00edcio_Original]\t[datetime]\t\tNOT NULL,\n\t\t\t[Fim_Original]\t\t[datetime]\t\tNOT NULL,\n\t\t) ON [PRIMARY]\n\tEND\n\t\n\t-- DROP TABLE IF EXISTS [dim_log_ajustes];\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_log_ajustes' and xtype='U')\n\tBEGIN\n\t\tCREATE TABLE [dbo].[dim_log_ajustes](\n\t\t\t[Fonte_Original]\t\t\t[varchar](10)\tNOT NULL,\n\t\t\t[ID Selecionar_Original]\t[varchar](10)\tNULL,\n\t\t\t[Evento_Original]\t\t\t[varchar](50)\tNOT NULL,\n\t\t\t[In\u00edcio_Original]\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[In\u00edcio_Ajustado]\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[Fim_Ajustado]\t\t\t\t[datetime]\t\tNOT NULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\t\n\tDECLARE @data_min date;\n\tDECLARE @data_max date;\n\tDECLARE @datahoras_afetadas TABLE (tipo varchar(10) NOT NULL, dh_min datetime2(0) NOT NULL, dh_max datetime2(0) NOT NULL);\n\t\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @fonte='secullum'\t\tOR @fonte='todas' BEGIN\n\tPRINT 'secullum'\n\tSET @data_min = (SELECT MIN([Inicio]) FROM dim_secullum_batidas);\n\tSET @data_max = (SELECT MAX([Inicio]) FROM dim_secullum_batidas);\n\t\n\t--DELETE FROM f_log where fonte = 'genesys';delete from dim_log_genesys\n\t\n\n\tWITH destino AS \n\t(\n\t\tSELECT * FROM [f_log]\n\t\tWHERE [Fonte]\t\t\t\t  = 'SECULLUM'\n\t\tAND\t  [In\u00edcio]\t\t\t\t >= @data_min\n\t\tAND\t  CAST([In\u00edcio] as date) <= @data_max\n\t)\n\tMERGE INTO destino USING (\n\t\n\n\t\tSELECT DISTINCT\n\t\t\t [Fonte]\t\t\t=\t'SECULLUM'\t\n\t\t\t,[ID Selecionar]\t=\tm.[ID Selecionar]\t\n\t\t\t,[ID Intelix]\t\t=\tnull\n\t\t\t,[ID EPBX]\t\t\t=\tnull\n\t\t\t,[ID Genesys]\t\t=\tnull\n\t\t\t,[ID Secullum]\t\t=\ts.[ID_funcionario]\n\t\t\t,[Evento]\t\t\t=\t'Trabalhado'\n\t\t\t,[In\u00edcio]\t\t\t=\ts.[inicio]\n\t\t\t,[Fim]\t\t\t\t=\ts.[fim]\n\t\t\t,[Dura\u00e7\u00e3o]\t\t\t=\tDATEDIFF(s, '00:00:00', s.[duracao])\n\t\tFROM dim_secullum_batidas s\n\t\tLEFT JOIN f_mop_historico m\n\t\tON s.[ID_funcionario] = m.[ID Secullum]\n\t\tAND CAST(s.[inicio] AS date) = m.[Data da Atualiza\u00e7\u00e3o]\n\t\tWHERE s.[duracao] > '00:00:00'\n\t\n\t\n\t\n\t) AS fonte\n\tON  fonte.[Fonte]\t\t\t=\tdestino.[Fonte]\n\tAND fonte.[ID Selecionar]\t=\tdestino.[ID Selecionar] -- NULLs n\u00e3o encaixam intencionalmente.\n\tAND fonte.[Evento]\t\t\t=\tdestino.[Evento]\n\tAND fonte.[In\u00edcio]\t\t\t=\tdestino.[In\u00edcio_Original]\n\tAND COALESCE(fonte.[fim], '-')\t=\tCOALESCE(destino.[Fim_Original], '-')\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID EPBX], [ID Genesys], [ID Secullum], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o], [Ajustado?], [In\u00edcio_Original], [Fim_Original]) \n\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID EPBX], fonte.[ID Genesys], fonte.[ID Secullum], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o], 'N\u00e3o', fonte.[In\u00edcio], fonte.[Fim]) \n\n\tWHEN MATCHED \n\t\tAND(COALESCE(destino.[ID Intelix], '-')\t<>\tCOALESCE(fonte.[ID Intelix], '-')\n\t\tOR\tCOALESCE(destino.[ID EPBX], '-')\t<>\tCOALESCE(fonte.[ID EPBX], '-')\n\t\tOR\tCOALESCE(destino.[ID Genesys], '-')\t<>\tCOALESCE(fonte.[ID Genesys], '-')\n\t\tOR\tCOALESCE(destino.[ID Secullum], '-')<>\tCOALESCE(fonte.[ID Secullum], '-')\n\t\tOR\tdestino.[Evento]\t\t\t<>\tfonte.[Evento]\n\t\tOR\tdestino.[In\u00edcio_Original]\t<>\tfonte.[In\u00edcio]\n\t\tOR\tdestino.[Fim_Original]\t\t<>\tfonte.[Fim])\n\tTHEN UPDATE SET\n\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t,destino.[Fim_Original]\t\t=\tfonte.[Fim]\n\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE\n\n\tOUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\t\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @fonte='intelix'\t\tOR @fonte='todas' BEGIN\n\tPRINT 'intelix'\n\n\tSET @data_min = (SELECT MIN([Inicio]) FROM dim_log_intelix WHERE CAST([Inicio] AS date) <> '01/01/1900');\n\tSET @data_max = (SELECT MAX([Inicio]) FROM dim_log_intelix);\n\t\n\tWITH destino AS \n\t(\n\t\tSELECT * FROM [f_log]\n\t\tWHERE [Fonte]\t\t\t\t  = 'Intelix'\n\t\tAND\t  [In\u00edcio]\t\t\t\t >= @data_min\n\t\tAND\t  CAST([In\u00edcio] as date) <= @data_max\n\t)\n\tMERGE INTO destino USING (\n\t\tSELECT DISTINCT [Fonte]='Intelix', [ID Selecionar], [ID Intelix]=id_atendente, [ID EPBX]=null, [ID Genesys]=null, [ID Secullum]=null, [Evento], [In\u00edcio]=[inicio], [Fim], [Dura\u00e7\u00e3o]=DATEDIFF_BIG(s, inicio, fim) FROM (\n\t\t\tSELECT [id_atendente], [evento], [inicio], [fim] = CASE WHEN fim = '1900-01-01' THEN CAST(CAST(inicio AS date) AS datetime) + CAST('23:59:59' AS datetime) ELSE fim END FROM dim_log_intelix WHERE evento <> 'Login' AND inicio >= @data_min AND CAST(inicio as date) <= @data_max\n\t\t\tUNION ALL\n\t\t\tSELECT [id_atendente] = p.id_atendente\n\t\t\t\t  ,[evento]\t\t  = 'Login'\n\t\t\t\t  ,[inicio]\t\t  =\tCASE WHEN LAG(p.inicio)\t OVER (PARTITION BY loginid ORDER BY p.rowid) IS NULL THEN l.inicio ELSE p.fim END\t\n\t\t\t\t  ,[fim]\t\t  =\tCASE WHEN LEAD(p.inicio) OVER (PARTITION BY loginid ORDER BY p.rowid) IS NULL \n\t\t\t\t\t\t\t\t\t\t THEN MAX(p.fim)\t OVER (PARTITION BY loginid)\n\t\t\t\t\t\t\t\t\t\t ELSE LEAD(p.inicio) OVER (PARTITION BY loginid ORDER BY p.rowid) END\n\t\t\tFROM (SELECT [id_atendente], [evento], [inicio]\n\t\t\t\t\t\t,[fim]   = CASE WHEN fim = '1900-01-01' THEN CAST(CAST(inicio AS date) AS datetime) + CAST('23:59:59' AS datetime) ELSE fim END\n\t\t\t\t\t\t,[rowid] = ROW_NUMBER() OVER (ORDER BY id_atendente, inicio, CASE WHEN fim = '1900-01-01' THEN CAST(CAST(inicio AS date) AS datetime) + CAST('23:59:59' AS datetime) ELSE fim END DESC) \n\t\t\t\t\t\tFROM dim_log_intelix WHERE inicio >= @data_min AND CAST(inicio as date) <= @data_max) p\n\t\t\tRIGHT JOIN (SELECT\t [id_atendente], [inicio]\n\t\t\t\t\t\t\t\t,[fim] = CASE WHEN fim = '1900-01-01' THEN CAST(CAST(inicio AS date) AS datetime) + CAST('23:59:59' AS datetime) ELSE fim END\n\t\t\t\t\t\t\t\t,[loginid] =  ROW_NUMBER() OVER (ORDER BY id_atendente, inicio, CASE WHEN fim = '1900-01-01' THEN CAST(CAST(inicio AS date) AS datetime) + CAST('23:59:59' AS datetime) ELSE fim END) \n\t\t\t\t\t\t\t\tFROM dim_log_intelix WHERE evento = 'login' AND inicio >= @data_min AND CAST(inicio as date) <= @data_max) l\n\t\t\tON p.id_atendente = l.id_atendente AND p.inicio >= l.inicio AND (p.fim <= l.fim OR (l.fim IS NULL AND CAST(p.inicio as date) = CAST(l.inicio as date)))\n\t\t) as l\n\t\tLEFT JOIN f_mop_historico\n\t\tON\tid_atendente = [ID Intelix]\n\t\tAND\t[Data da Atualiza\u00e7\u00e3o] = CAST(inicio AS date)\n\t\tWHERE DATEDIFF_BIG(s, inicio, fim) <> 0\n\t) AS fonte\n\tON  fonte.[Fonte]\t\t\t=\tdestino.[Fonte]\n\tAND fonte.[ID Selecionar]\t=\tdestino.[ID Selecionar] -- NULLs n\u00e3o encaixam intencionalmente.\n\tAND fonte.[Evento]\t\t\t=\tdestino.[Evento]\n\tAND fonte.[In\u00edcio]\t\t\t=\tdestino.[In\u00edcio_Original]\n\tAND COALESCE(fonte.[fim], '-')\t=\tCOALESCE(destino.[Fim_Original], '-')\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID EPBX], [ID Genesys], [ID Secullum], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o], [Ajustado?], [In\u00edcio_Original], [Fim_Original]) \n\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID EPBX], fonte.[ID Genesys], fonte.[ID Secullum], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o], 'N\u00e3o', fonte.[In\u00edcio], fonte.[Fim]) \n\n\tWHEN MATCHED \n\t\tAND(COALESCE(destino.[ID Intelix], '-')\t<>\tCOALESCE(fonte.[ID Intelix], '-')\n\t\tOR\tCOALESCE(destino.[ID EPBX], '-')\t<>\tCOALESCE(fonte.[ID EPBX], '-')\n\t\tOR\tCOALESCE(destino.[ID Genesys], '-')\t<>\tCOALESCE(fonte.[ID Genesys], '-')\n\t\tOR\tCOALESCE(destino.[ID Secullum], '-')<>\tCOALESCE(fonte.[ID Secullum], '-')\n\t\tOR\tdestino.[Evento]\t\t\t<>\tfonte.[Evento]\n\t\tOR\tdestino.[In\u00edcio_Original]\t<>\tfonte.[In\u00edcio]\n\t\tOR\tdestino.[Fim_Original]\t\t<>\tfonte.[Fim])\n\tTHEN UPDATE SET\n\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t,destino.[Fim_Original]\t\t=\tfonte.[Fim]\n\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE\n\n\tOUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @fonte='epbx'\t\tOR @fonte='todas' BEGIN\n\tPRINT 'epbx'\n\t\n\tSET @data_min = (SELECT MIN([Inicio]) FROM dim_log_epbx);\n\tSET @data_max = (SELECT MAX([Inicio]) FROM dim_log_epbx);\n\t\n\n\t\n\tWITH destino AS \n\t(\n\t\tSELECT * FROM [f_log]\n\t\tWHERE [Fonte]\t\t\t\t  = 'EPBX'\n\t\tAND\t  [In\u00edcio]\t\t\t\t >= @data_min\n\t\tAND\t  CAST([In\u00edcio] as date) <= @data_max\n\t)\n\tMERGE INTO destino USING (\n\t\tSELECT DISTINCT\n\t\t\t [Fonte]\t\t\t=\t'EPBX'\t\n\t\t\t,[ID Selecionar]\t=\tm.[ID Selecionar]\t\n\t\t\t,[ID Intelix]\t\t=\tnull\n\t\t\t,[ID EPBX]\t\t\t=\tl.[ramal_atendente]\n\t\t\t,[ID Genesys]\t\t=\tnull\n\t\t\t,[ID Secullum]\t\t=\tnull\n\t\t\t,[Evento]\t\t\t=\tl.[evento]\n\t\t\t,[In\u00edcio]\t\t\t=\tl.[inicio]\n\t\t\t,[Fim]\t\t\t\t=\tl.[fim]\n\t\t\t,[Dura\u00e7\u00e3o]\t\t\t=\tDATEDIFF(s, 0, l.[duracao])\n\t\tFROM dim_log_epbx l\n\t\tLEFT JOIN f_mop_historico m\n\t\tON l.[ramal_atendente] = m.[ID EPBX]\n\t\tAND CAST(l.[inicio] AS date) = m.[Data da Atualiza\u00e7\u00e3o]\n\t) AS fonte\n\tON  fonte.[Fonte]\t\t\t=\tdestino.[Fonte]\n\tAND fonte.[ID Selecionar]\t=\tdestino.[ID Selecionar] -- NULLs n\u00e3o encaixam intencionalmente.\n\tAND fonte.[Evento]\t\t\t=\tdestino.[Evento]\n\tAND fonte.[In\u00edcio]\t\t\t=\tdestino.[In\u00edcio_Original]\n\tAND COALESCE(fonte.[fim], '-')\t=\tCOALESCE(destino.[Fim_Original], '-')\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID EPBX], [ID Genesys], [ID Secullum], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o], [Ajustado?], [In\u00edcio_Original], [Fim_Original]) \n\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID EPBX], fonte.[ID Genesys], fonte.[ID Secullum], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o], 'N\u00e3o', fonte.[In\u00edcio], fonte.[Fim]) \n\n\tWHEN MATCHED \n\t\tAND(COALESCE(destino.[ID Intelix], '-')\t<>\tCOALESCE(fonte.[ID Intelix], '-')\n\t\tOR\tCOALESCE(destino.[ID EPBX], '-')\t<>\tCOALESCE(fonte.[ID EPBX], '-')\n\t\tOR\tCOALESCE(destino.[ID Genesys], '-')\t<>\tCOALESCE(fonte.[ID Genesys], '-')\n\t\tOR\tCOALESCE(destino.[ID Secullum], '-')<>\tCOALESCE(fonte.[ID Secullum], '-')\n\t\tOR\tdestino.[Evento]\t\t\t<>\tfonte.[Evento]\n\t\tOR\tdestino.[In\u00edcio_Original]\t<>\tfonte.[In\u00edcio]\n\t\tOR\tdestino.[Fim_Original]\t\t<>\tfonte.[Fim])\n\tTHEN UPDATE SET\n\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t,destino.[Fim_Original]\t\t=\tfonte.[Fim]\n\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE\n\n\tOUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @fonte='genesys'\t\tOR @fonte='todas' BEGIN\n\tPRINT 'genesys'\n\t\n\tSET @data_min = (SELECT MIN([Inicio]) FROM dim_log_genesys);\n\tSET @data_max = (SELECT MAX([Inicio]) FROM dim_log_genesys);\n\t\n\t--DELETE FROM f_log where fonte = 'genesys';delete from dim_log_genesys\n\t\n\n\tWITH destino AS \n\t(\n\t\tSELECT * FROM [f_log]\n\t\tWHERE [Fonte]\t\t\t\t  = 'GENESYS'\n\t\tAND\t  [In\u00edcio]\t\t\t\t >= @data_min\n\t\tAND\t  CAST([In\u00edcio] as date) <= @data_max\n\t)\n\tMERGE INTO destino USING (\n\t\n\n\t\tSELECT DISTINCT\n\t\t\t [Fonte]\t\t\t=\t'GENESYS'\t\n\t\t\t,[ID Selecionar]\t=\tm.[ID Selecionar]\t\n\t\t\t,[ID Intelix]\t\t=\tnull\n\t\t\t,[ID EPBX]\t\t\t=\tnull\n\t\t\t,[ID Genesys]\t\t=\tl.[id_usuario]\n\t\t\t,[ID Secullum]\t\t=\tnull\n\t\t\t,[Evento]\t\t\t=\tl.[descricao_evento]\n\t\t\t,[In\u00edcio]\t\t\t=\tl.[inicio]\n\t\t\t,[Fim]\t\t\t\t=\tIIF(l.[fim] > null/*DATEADD(DAY, 1,CAST(l.[inicio] AS date))*/, DATEADD(DAY, 1,CAST(l.[inicio] AS date)), IIF(l.[fim] IS NULL, COALESCE( (SELECT MIN(o.[inicio]) FROM dim_log_genesys o WHERE o.[id_usuario] = l.[id_usuario] AND o.[inicio] >= l.[inicio] AND o.[inicio] <= DATEADD(DAY, 1,CAST(l.[inicio] AS date)) AND o.[descricao_evento] = 'Offline'), CAST(DATEADD(DAY, 1,CAST(l.[inicio] AS date)) AS datetime)), l.[fim]))\n\t\t\t,[Dura\u00e7\u00e3o]\t\t\t=\tIIF(l.[fim] > null/*DATEADD(DAY, 1,CAST(l.[inicio] AS date))*/, DATEDIFF(s, l.[inicio], DATEADD(DAY, 1,CAST(l.[inicio] AS date))), IIF(l.[fim] IS NULL, DATEDIFF(s, l.[inicio], COALESCE( (SELECT MIN(o.[inicio]) FROM dim_log_genesys o WHERE o.[id_usuario] = l.[id_usuario] AND o.[inicio] >= l.[inicio] AND o.[inicio] <= DATEADD(DAY, 1,CAST(l.[inicio] AS date)) AND o.[descricao_evento] = 'Offline'), CAST(DATEADD(DAY, 1,CAST(l.[inicio] AS date)) AS datetime))), DATEDIFF(s, 0, l.[duracao])))\n\t\tFROM dim_log_genesys l\n\t\tLEFT JOIN f_mop_historico m\n\t\tON l.[id_usuario] = m.[ID Genesys]\n\t\tAND CAST(l.[inicio] AS date) = m.[Data da Atualiza\u00e7\u00e3o]\n\t\tWHERE l.[descricao_evento] <> 'Offline'\n\t\n\t\n\t\n\t) AS fonte\n\tON  fonte.[Fonte]\t\t\t=\tdestino.[Fonte]\n\tAND fonte.[ID Selecionar]\t=\tdestino.[ID Selecionar] -- NULLs n\u00e3o encaixam intencionalmente.\n\tAND fonte.[Evento]\t\t\t=\tdestino.[Evento]\n\tAND fonte.[In\u00edcio]\t\t\t=\tdestino.[In\u00edcio_Original]\n\tAND COALESCE(fonte.[fim], '-')\t=\tCOALESCE(destino.[Fim_Original], '-')\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID EPBX], [ID Genesys], [ID Secullum], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o], [Ajustado?], [In\u00edcio_Original], [Fim_Original]) \n\t\tVALUES (fonte.[Fonte], fonte.[ID Selecionar], fonte.[ID Intelix], fonte.[ID EPBX], fonte.[ID Genesys], fonte.[ID Secullum], fonte.[Evento], fonte.[In\u00edcio], fonte.[Fim], fonte.[Dura\u00e7\u00e3o], 'N\u00e3o', fonte.[In\u00edcio], fonte.[Fim]) \n\n\tWHEN MATCHED \n\t\tAND(COALESCE(destino.[ID Intelix], '-')\t<>\tCOALESCE(fonte.[ID Intelix], '-')\n\t\tOR\tCOALESCE(destino.[ID EPBX], '-')\t<>\tCOALESCE(fonte.[ID EPBX], '-')\n\t\tOR\tCOALESCE(destino.[ID Genesys], '-')\t<>\tCOALESCE(fonte.[ID Genesys], '-')\n\t\tOR\tCOALESCE(destino.[ID Secullum], '-')<>\tCOALESCE(fonte.[ID Secullum], '-')\n\t\tOR\tdestino.[Evento]\t\t\t<>\tfonte.[Evento]\n\t\tOR\tdestino.[In\u00edcio_Original]\t<>\tfonte.[In\u00edcio]\n\t\tOR\tdestino.[Fim_Original]\t\t<>\tfonte.[Fim])\n\tTHEN UPDATE SET\n\t\t destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t,destino.[Fim_Original]\t\t=\tfonte.[Fim]\n\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tfonte.[Dura\u00e7\u00e3o]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE\n\n\tOUTPUT $action, COALESCE(deleted.[In\u00edcio_Original], inserted.[In\u00edcio]), COALESCE(deleted.[Fim_Original], inserted.[Fim]) INTO @datahoras_afetadas;\n\t\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Finaliza\u00e7\u00e3o (Limpeza de nulos, c\u00e1lculos finais, etc)\n\n\t--------------------------------------------------------------------------------------------------------\n\t-- Ajustes for\u00e7ados\n\n\t\tWITH destino AS \n\t\t(\n\t\t\tSELECT * FROM [f_log]\n\t\t)\n\t\tMERGE INTO destino USING (\n\t\t\tSELECT * FROM [dim_log_ajustes]\n\t\t) AS fonte\n\t\tON  fonte.[Fonte_Original]\t\t\t=\tdestino.[Fonte]\n\t\tAND fonte.[ID Selecionar_Original]\t=\tdestino.[ID Selecionar]\n\t\tAND fonte.[Evento_Original]\t\t\t=\tdestino.[Evento]\n\t\tAND fonte.[In\u00edcio_Original]\t\t\t=\tdestino.[In\u00edcio_Original]\n\n\t\tWHEN NOT MATCHED BY TARGET THEN\n\t\t\tINSERT ([Fonte], [ID Selecionar], [ID Intelix], [ID EPBX], [ID Genesys], [ID Secullum], [Evento], [In\u00edcio], [Fim], [Dura\u00e7\u00e3o], [Ajustado?], [In\u00edcio_Original], [Fim_Original]) \n\t\t\tVALUES (fonte.[Fonte_Original], fonte.[ID Selecionar_Original], null, null, null, null, fonte.[Evento_Original], fonte.[In\u00edcio_Ajustado], fonte.[Fim_Ajustado], DATEDIFF_BIG(s, fonte.[In\u00edcio_Ajustado], fonte.[Fim_Ajustado]), 'Inclu\u00eddo', fonte.[In\u00edcio_Original], fonte.[Fim_Ajustado]) \n\n\t\tWHEN MATCHED \n\t\t\tAND(destino.[In\u00edcio]\t<>\tfonte.[In\u00edcio_Ajustado]\n\t\t\tOR\tdestino.[Fim]\t\t<>\tfonte.[Fim_Ajustado])\n\t\tTHEN UPDATE SET\n\t\t\t destino.[Ajustado?]\t=\t'Sim'\n\t\t\t,destino.[In\u00edcio]\t\t=\tfonte.[In\u00edcio_Ajustado]\n\t\t\t,destino.[Fim]\t\t\t=\tfonte.[Fim_Ajustado]\n\t\t\t,destino.[Dura\u00e7\u00e3o]\t\t=\tDATEDIFF_BIG(s, fonte.[In\u00edcio_Ajustado], fonte.[Fim_Ajustado])\n    \n\t\tWHEN NOT MATCHED BY SOURCE AND destino.[Ajustado?] <> 'N\u00e3o'\n\t\t\tTHEN UPDATE SET\n\t\t\t destino.[Ajustado?]\t\t=\t'N\u00e3o'\n\t\t\t,destino.[In\u00edcio]\t\t\t=\tdestino.[In\u00edcio_Original]\n\t\t\t,destino.[Fim]\t\t\t\t=\tdestino.[Fim_Original]\n\t\t\t,destino.[Dura\u00e7\u00e3o]\t\t\t=\tDATEDIFF_BIG(s, destino.[In\u00edcio_Original], destino.[Fim_Original])\n\n\t\tOUTPUT $action, COALESCE(deleted.[In\u00edcio], inserted.[In\u00edcio]), COALESCE(deleted.[Fim], inserted.[Fim]) INTO @datahoras_afetadas;\n\n\t\n\t-- Atualizar tabelas dependentes\n\n\t\tDECLARE @min datetime2(0) = COALESCE(@datahora_inicio_forcada, (SELECT MIN(dh_min) FROM @datahoras_afetadas))\n\t\tDECLARE @max datetime2(0) = COALESCE(@datahora_fim_forcada, (SELECT MAX(dh_max) FROM @datahoras_afetadas))\n\n\t\tSELECT [Retorno]=CONCAT('f_log atualizada (fonte: ',@fonte,') ',@min,' - ',@max)\n\n\t\n\t\tIF @min IS NOT NULL and @max IS NOT NULL\n\t\tBEGIN\n\t\t\tPRINT ''\n\t\t\tPRINT CONCAT('Periodo atualizado = ',@min, ' - ', @max) \n\t\t\tPRINT ''\n\n\n\t\t\t--EXEC sp_att_resumos @datahora_inicio = @min, @datahora_fim = @max, @metrica = 'log'\n\n\t\tEND\n\t\tELSE\n\t\tBEGIN\n\t\t\tPRINT ''\n\t\t\tPRINT 'Nenhuma altera\u00e7\u00e3o na base de log'\n\t\t\tPRINT ''\n\t\tEND\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\n\n\n\n\n\n\nGO\n",
        "build_order": 299,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT [Retorno]=CONCAT('f_log"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "SELECT",
                "SELECT [Retorno]=CONCAT('f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "SELECT",
                "SELECT [Retorno]=CONCAT('f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_ajustes]": [
                "SELECT",
                "SELECT * FROM [dim_log_ajustes]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_epbx]": [
                "UNKNOWN",
                "dim_log_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_genesys]": [
                "UNKNOWN",
                "dim_log_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_intelix]": [
                "UNKNOWN",
                "dim_log_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": [
                "UNKNOWN",
                "dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_att_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "EXEC",
                "EXEC sp_att_resumos"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_att_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_epbx]": [
                "EXEC",
                "EXEC sp_att_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_genesys]": [
                "EXEC",
                "EXEC sp_att_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_intelix]": [
                "EXEC",
                "EXEC sp_att_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horaextra]": [
                "EXEC",
                "EXEC sp_att_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_log]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_epbx]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_epbx]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_log_epbx",
        "type": "StoredProcedure",
        "start": 371497,
        "end": 373779,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_log_epbx]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE       PROCEDURE [dbo].[sp_att_log_epbx]\n\t@datahora_inicio_forcada datetime = NULL,\n\t@datahora_fim_forcada datetime = NULL \nAS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_log_epbx' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_log_epbx]( \n\t\t\t[id_atendente]\t\t[int]\t\t\tNOT NULL,\n\t\t\t[ramal_atendente]\t[int]\t\t\tNOT NULL,\n\t\t\t[nome_atendente]\t[varchar](100)\tNOT NULL,\n\t\t\t[evento]\t\t\t[varchar](50)\tNOT NULL,\n\t\t\t[inicio]\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[fim]\t\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[duracao]\t\t\t[time](7)\t\tNOT NULL,\n\t\t\t[logoff]\t\t\t[bit]\t\t\tNOT NULL,\n\t\t) ON [PRIMARY]\n\tEND\n\t\t \n\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM dim_log_epbx\n\t\tWHERE [inicio]\t>= @datahora_inicio_forcada\n\t\tAND\t  [fim]\t\t<= @datahora_fim_forcada\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\t\n\t\tSELECT\n\t\t\t [id_atendente]\t\t= [UsuarioId] \n\t\t\t,[ramal_atendente]\t= [RamalNumero]\n\t\t\t,[nome_atendente]\t= [Usuario]\n\t\t\t,[evento]\t\t\t= [RamalStatusDetalhe]\n\t\t\t,[inicio]\t\t\t= [DataInicio]\n\t\t\t,[fim]\t\t\t\t= [DataTermino]\n\t\t\t,[duracao]\t\t\t= CAST(DATEADD(s, [Duracao], 0) AS time(7))\n\t\t\t,[logoff]\t\t\t= [Logoff]\n\t\tFROM [Brboots_Serasa].[db_owner].[UsuarioRamalHistorico]\n\t\tWHERE [DataInicio] >= @datahora_inicio_forcada AND [DataTermino] <= @datahora_fim_forcada\n\t\tAND [Duracao] > 0\n\t) AS fonte\n\tON  fonte.[id_atendente]\t= destino.[id_atendente]\n\tAND fonte.[evento]\t\t\t= destino.[evento]\n\tAND fonte.[inicio]\t\t\t= destino.[inicio]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([id_atendente], [ramal_atendente], [nome_atendente], [evento], [inicio], [fim], [duracao], [logoff]) \n\t\tVALUES (fonte.[id_atendente], fonte.[ramal_atendente], fonte.[nome_atendente], fonte.[evento], fonte.[inicio], fonte.[fim], fonte.[duracao], fonte.[logoff])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\t destino.[nome_atendente]\t=\tfonte.[nome_atendente]\n\t\t,destino.[ramal_atendente]\t=\tfonte.[ramal_atendente]\n\t\t,destino.[fim]\t\t\t\t=\tfonte.[fim]\n\t\t,destino.[duracao]\t\t\t=\tfonte.[duracao]\n\t\t,destino.[logoff]\t\t\t=\tfonte.[logoff]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\n\n\tEXEC sp_att_log @datahora_inicio_forcada, @datahora_fim_forcada, @fonte='epbx'\n\n\nGO\n",
        "build_order": 300,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_epbx]": [
                "SELECT",
                "SELECT * FROM dim_log_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "EXEC",
                "EXEC sp_att_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_epbx]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_att_log_epbx]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_epbx]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_att_log_epbx]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_genesys]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_genesys]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_log_genesys",
        "type": "StoredProcedure",
        "start": 373779,
        "end": 378483,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_log_genesys]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE         PROCEDURE [dbo].[sp_att_log_genesys] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t--SELECT * INTO teste_genesys FROM #temp0\n\t--DROP Table dim_log_genesys\n\t\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_log_genesys' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_log_genesys]( \n\t\t\t[id]\t\t\t\t\t[varchar](100)\tNOT NULL,\n\t\t\t[id_usuario]\t\t\t[varchar](100)\tNOT NULL,\n\t\t\t[nome_usuario]\t\t\t[varchar](100)\tNOT NULL,\n\t\t\t[email_usuario]\t\t\t[varchar](100)\tNOT NULL,\n\t\t\t[divisao_usuario]\t\t[varchar](100)\tNOT NULL,\n\t\t\t[departamento_usuario]\t[varchar](100)\tNULL,\n\t\t\t[titulo_usuario]\t\t[varchar](100)\tNULL,\n\t\t\t[tipo_evento]\t\t\t[varchar](25)\tNOT NULL,\n\t\t\t[sistema_evento]\t\t[varchar](25)\tNOT NULL,\n\t\t\t[descricao_evento]\t\t[varchar](25)\tNOT NULL,\n\t\t\t[inicio]\t\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[fim]\t\t\t\t\t[datetime]\t\tNULL,\n\t\t\t[duracao]\t\t\t\t[time](0)\t\tNULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\t--DELETE FROM #temp0 WHERE [languageLabels.pt_BR] = 'Offline'\n\n\tDECLARE @data_min date = (SELECT MIN(DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127))) FROM #temp0)\n\tDECLARE @data_max date = (SELECT MAX(DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127))) FROM #temp0)\n\n\tSELECT * FROM dim_log_genesys\n\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM dim_log_genesys\n\t\tWHERE [inicio]\t\t\t\t\t\t>= @data_min\n\t\tAND\t  CAST([inicio] as date)\t\t<= @data_max\n\t\tAND\t  CONCAT(id_usuario, inicio)\tIN (SELECT DISTINCT CONCAT([userId], DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127))) FROM #temp0)\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\t\t\t\t\n\t\t\t [id]\t\t\t\t\t= CONCAT('GENESYS-', DATEDIFF(DAY,'1899-12-30',CAST(DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127)) as date))+(DATEDIFF(s,CAST(DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127)) as DATE), DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127)))/86400.0),'-', [userId],'-', DATEPART(MILLISECOND, DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127))),'-', ROW_NUMBER() OVER (PARTITION BY [userId], DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127)) ORDER BY DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127)))) \n\t\t\t,[id_usuario]\t\t\t= [userId]\n\t\t\t,[nome_usuario]\t\t\t= [name]\n\t\t\t,[email_usuario]\t\t= [email]\n\t\t\t,[divisao_usuario]\t\t= [division.name]\n\t\t\t,[departamento_usuario]\t= [department]\n\t\t\t,[titulo_usuario]\t\t= [title]\n\t\t\t,[tipo_evento]\t\t\t= [type]\n\t\t\t,[sistema_evento]\t\t= [systemPresence_pausas]\n\t\t\t,[descricao_evento]\t\t= [languageLabels.pt_BR]\n\t\t\t,[inicio]\t\t\t\t= DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127))\n\t\t\t,[fim]\t\t\t\t\t= DATEADD(HOUR, -3, CONVERT(datetime, [endTime], 127))\n\t\t\t,[duracao]\t\t\t\t= CASE\tWHEN [endTime] IS NULL \n\t\t\t\t\t\t\t\t\t\t\tTHEN CAST('00:00:00' AS time) \n\t\t\t\t\t\t\t\t\t\t\tELSE CAST(DATEADD(SECOND, DATEDIFF_BIG(SECOND, DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127)), DATEADD(HOUR, -3, CONVERT(datetime, [endTime], 127)))%60, \n\t\t\t\t\t\t \t\t\t\t\t\t\t  DATEADD(MINUTE, DATEDIFF_BIG(SECOND, DATEADD(HOUR, -3, CONVERT(datetime, [startTime], 127)), DATEADD(HOUR, -3, CONVERT(datetime, [endTime], 127)))/60, \n\t\t\t\t\t\t\t\t\t\t\t\t\t  '00:00:00')) AS time) END\n\t\tFROM #temp0\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([id], [id_usuario], [nome_usuario], [email_usuario], [divisao_usuario], [departamento_usuario], [titulo_usuario], [tipo_evento], [sistema_evento], [descricao_evento], [inicio], [fim], [duracao]) \n\t\tVALUES (fonte.[id], fonte.[id_usuario], fonte.[nome_usuario], fonte.[email_usuario], fonte.[divisao_usuario], fonte.[departamento_usuario], fonte.[titulo_usuario], fonte.[tipo_evento], fonte.[sistema_evento], fonte.[descricao_evento], fonte.[inicio], fonte.[fim], fonte.[duracao])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\t  destino.[id]\t\t\t\t\t\t= fonte.[id]\n\t\t ,destino.[id_usuario]\t\t\t\t= fonte.[id_usuario]\n\t\t ,destino.[nome_usuario]\t\t\t= fonte.[nome_usuario]\n\t\t ,destino.[email_usuario]\t\t\t= fonte.[email_usuario]\n\t\t ,destino.[divisao_usuario]\t\t\t= fonte.[divisao_usuario]\n\t\t ,destino.[departamento_usuario]\t= fonte.[departamento_usuario]\n\t\t ,destino.[titulo_usuario]\t\t\t= fonte.[titulo_usuario]\n\t\t ,destino.[tipo_evento]\t\t\t\t= fonte.[tipo_evento]\n\t\t ,destino.[sistema_evento]\t\t\t= fonte.[sistema_evento]\n\t\t ,destino.[descricao_evento]\t\t= fonte.[descricao_evento]\n\t\t ,destino.[inicio]\t\t\t\t\t= fonte.[inicio]\n\t\t ,destino.[fim]\t\t\t\t\t\t= fonte.[fim]\n\t\t ,destino.[duracao]\t\t\t\t\t= fonte.[duracao]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\n\n\t--SET @data_max = CAST(CAST(@data_max as date) as datetime) + CAST(CAST('23:59:59' as time) as datetime) \n\t--EXEC sp_att_log @datahora_inicio_forcada=@data_min, @datahora_fim_forcada=@data_max, @fonte='genesys'\n\n\nGO\n",
        "build_order": 301,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_genesys]": [
                "SELECT",
                "SELECT * FROM dim_log_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "EXEC",
                "EXEC sp_att_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_genesys]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_att_log_genesys]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_genesys]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_att_log_genesys]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_intelix]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_intelix]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_log_intelix",
        "type": "StoredProcedure",
        "start": 378483,
        "end": 381811,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_log_intelix]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE       PROCEDURE [dbo].[sp_att_log_intelix] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\t\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_log_intelix' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_log_intelix]( \n\t\t\t[id_atendente]\t\t[int]\t\t\tNOT NULL,\n\t\t\t[nome_atendente]\t[varchar](100)\tNOT NULL,\n\t\t\t[evento]\t\t\t[varchar](100)\tNULL,\n\t\t\t[inicio]\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[fim]\t\t\t\t[datetime]\t\tNULL,\n\t\t\t[duracao]\t\t\t[time](7)\t\tNULL,\n\t\t\t[complemento]\t\t[varchar](25)\tNULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\tDECLARE @data_min date = (SELECT MIN(CONVERT(datetime, [dataInicio], 121)) FROM #temp0)\n\tDECLARE @data_max date = (SELECT MAX(CONVERT(datetime, [dataInicio], 121)) FROM #temp0)\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM dim_log_intelix\n\t\tWHERE [inicio]\t\t\t\t >= @data_min\n\t\tAND\t  CAST([inicio] as date) <= @data_max\n\t\tAND\t  CONCAT(id_atendente, inicio) IN (SELECT DISTINCT CONCAT([atendente], CONVERT(datetime, [dataInicio], 121)) FROM #temp0)\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT * FROM \n\t\t(\n\t\t\tSELECT\n\t\t\t\t [n]=COUNT(*) OVER (PARTITION BY [atendente], IIF([evento] = 'Pausa', CONCAT('Pausa (',[nomePausa],')'), [evento]), CONVERT(datetime, [dataInicio], 121))\n\t\t\t\t,[Atendente]\t=\t[atendente]\n\t\t\t\t,[Nome]\t\t\t=\t[nomeAtendente]\n\t\t\t\t,[Evento]\t\t=\tIIF([evento] = 'Pausa', CONCAT('Pausa (',[nomePausa],')'), [evento])\n\t\t\t\t,[Inicio]\t\t=\tCONVERT(datetime, [dataInicio], 121)\n\t\t\t\t,[Fim]\t\t\t=\tCONVERT(datetime, [dataFim], 121)\n\t\t\t\t,[Duracao]\t\t=\tCASE WHEN [dataFim] IS NULL \n\t\t\t\t\t\t\t\t\t\t THEN CAST('00:00:00' AS time) \n\t\t\t\t\t\t\t\t\t\t ELSE CAST(DATEADD(SECOND, DATEDIFF_BIG(SECOND, CONVERT(datetime, [dataInicio], 121), CONVERT(datetime, [dataFim], 121))%60, \n\t\t\t\t\t\t \t\t\t\t\t\t   DATEADD(MINUTE, DATEDIFF_BIG(SECOND, CONVERT(datetime, [dataInicio], 121), CONVERT(datetime, [dataFim], 121))/60, \n\t\t\t\t\t\t\t\t\t\t\t\t   '00:00:00')) AS time) \n\t\t\t\t\t\t\t\t\tEND\n\t\t\t\t,[Complemento]\t= [complemento]\n\t\t\tFROM #temp0\n\t\t\tWHERE CASE WHEN [dataFim] IS NULL THEN CAST('00:00:00' AS time) \n\t\t\t\t\t   ELSE CAST(DATEADD(SECOND, DATEDIFF_BIG(SECOND, CONVERT(datetime, [dataInicio], 121), CONVERT(datetime, [dataFim], 121))%60, DATEADD(MINUTE, DATEDIFF_BIG(SECOND, CONVERT(datetime, [dataInicio], 121), CONVERT(datetime, [dataFim], 121))/60, '00:00:00')) AS time) \n\t\t\t\t  END > '00:00:00' \n\t\t\tOR [dataFim] IS NULL\n\t\t) _ WHERE [n] = 1\n\t\t \n\t)AS fonte\n\tON  fonte.[Atendente] = destino.[id_atendente]\n\tAND fonte.[Evento]\t  = destino.[evento]\n\tAND fonte.[Inicio]\t  = destino.[inicio]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([id_atendente], [nome_atendente], [evento], [inicio], [fim], [duracao], [complemento]) \n\t\tVALUES (fonte.[Atendente], fonte.[Nome], fonte.[Evento], fonte.[Inicio], fonte.[Fim], fonte.[Duracao], fonte.[Complemento])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\t destino.[nome_atendente]\t=\tfonte.[Nome]\n\t\t,destino.[fim]\t\t\t\t=\tfonte.[Fim]\n\t\t,destino.[duracao]\t\t\t=\tfonte.[Duracao]\n\t\t,destino.[complemento]\t\t=\tfonte.[Complemento]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\n\n\t--SET @data_max = CAST(CAST(@data_max as date) as datetime) + CAST(CAST('23:59:59' as time) as datetime) \n\t--EXEC sp_att_log @datahora_inicio_forcada=@data_min, @datahora_fim_forcada=@data_max, @fonte='intelix'\n\n\nGO\n",
        "build_order": 302,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_intelix]": [
                "SELECT",
                "SELECT * FROM dim_log_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "EXEC",
                "EXEC sp_att_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_intelix]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_att_log_intelix]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_intelix]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_att_log_intelix]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horaextra]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horaextra]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_log_secullum_horaextra",
        "type": "StoredProcedure",
        "start": 381811,
        "end": 386517,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_log_secullum_horaextra]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE     PROCEDURE [dbo].[sp_att_log_secullum_horaextra] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t-- DROP TABLE IF EXISTS dim_log_secullum_horaextra;\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_log_secullum_horaextra' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_log_secullum_horaextra]( \n\t\t\t[id]\t\t        [int]\t\t\tNOT NULL,\n\t\t\t[numero_pis]\t    [bigint]       \tNOT NULL,\n\t\t\t[demissao]\t\t\t[datetime]   \tNULL,\n\t\t\t[data]\t\t    \t[date]\t\t\tNOT NULL,\n\t\t\t[entrada_1]\t\t\t[time](0)  \t\tNULL,\n\t\t\t[saida_1]\t\t\t[time](0)\t\tNULL,\n\t\t\t[entrada_2]\t\t\t[time](0)  \t\tNULL,\n\t\t\t[saida_2]\t\t\t[time](0)\t\tNULL,\n\t\t\t[entrada_3]\t\t\t[time](0)  \t\tNULL,\n\t\t\t[saida_3]\t\t\t[time](0)\t\tNULL,\n\t\t\t[entrada_4]\t\t\t[time](0)  \t\tNULL,\n\t\t\t[saida_4]\t\t\t[time](0)\t\tNULL,\n\t\t\t[entrada_5]\t\t\t[time](0)  \t\tNULL,\n\t\t\t[saida_5]\t\t\t[time](0)\t\tNULL,\n\t\t\t[normais]           [time](0)       NULL,\n\t\t\t[faltas]            [time](0)       NULL,\n\t\t\t[ex]\t\t\t\t[time](0)       NULL,\n\t\t\t[ex_50%]            [time](0)       NULL,\n\t\t\t[ex_60%]            [time](0)       NULL,\n\t\t\t[ex_100%]\t\t\t[time](0)       NULL,\n\t\t\t[ex_120%]\t\t\t[time](0)       NULL,\n\t\t\t[observacoes]       [varchar](50)   NULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\n\t--DROP TABLE teste_secullim_horaextra;\n\t--SELECT * INTO teste_secullim_horaextra FROM #temp0;\n\t--SELECT * FROM teste_secullim_horaextra;\n\n\tDECLARE @data_min date = (SELECT MIN(CAST(LEFT([Data],10) AS DATE)) FROM #temp0)\n\tDECLARE @data_max date = (SELECT MAX(CAST(LEFT([Data],10) AS DATE)) FROM #temp0)\n\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_log_secullum_horaextra]\n\t\tWHERE [data]  >= @data_min\n\t\tAND\t  [data]  <= @data_max\n\t\tAND\t  [id]\t  IN (SELECT DISTINCT [id] FROM #temp0)\n\t)\n\tMERGE INTO destino \n\tUSING (\n\n\t\tSELECT \n\t\t\t\t [id]\t\t    = [Id]\n\t\t\t\t,[numero_pis]\t= [NumeroPis]    \n\t\t\t\t,[demissao]\t\t= [Demissao]\t\n\t\t\t\t,[data]\t\t    = CAST(LEFT([Data],10) AS DATE)\t\n\t\t\t\t,[entrada_1]\t= TRY_CAST([Entrada 1] as time)\t\t\n\t\t\t\t,[saida_1]\t\t= TRY_CAST([Sa\u00edda 1] as time)\t\n\t\t\t\t,[entrada_2]\t= TRY_CAST([Entrada 2] as time)\t\t\n\t\t\t\t,[saida_2]\t\t= TRY_CAST([Sa\u00edda 2] as time)\t\n\t\t\t\t,[entrada_3]\t= TRY_CAST([Entrada 3] as time)\t\t\n\t\t\t\t,[saida_3]\t\t= TRY_CAST([Sa\u00edda 3] as time)\t\n\t\t\t\t,[entrada_4]\t= TRY_CAST([Entrada 4] as time)\t\t\n\t\t\t\t,[saida_4]\t\t= TRY_CAST([Sa\u00edda 4] as time)\t\n\t\t\t\t,[entrada_5]\t= TRY_CAST([Entrada 5] as time)\t\t\n\t\t\t\t,[saida_5]\t\t= TRY_CAST([Sa\u00edda 5] as time)\t\n\t\t\t\t,[normais]      = TRY_CAST([Normais] as time)     \n\t\t\t\t,[faltas]       = TRY_CAST([Faltas] as time)\n\t\t\t\t,[ex]\t\t\t= TRY_CAST([Extras] as time)\n\t\t\t\t,[ex_50%]       = TRY_CAST([Ex50%] as time)\n\t\t\t\t,[ex_60%]       = TRY_CAST([Ex60%] as time)\n\t\t\t\t,[ex_100%]      = TRY_CAST([Ex100%] as time)\n\t\t\t\t,[ex_120%]      = TRY_CAST([Ex120%] as time)\n\t\t\t\t,[observacoes]  = CASE WHEN TRY_CAST([Entrada 1] as time) IS NULL THEN [Entrada 1] ELSE null END\n\t\t\t\n\t\tFROM #temp0\n\n\t) AS fonte\n\tON  fonte.[id]        = destino.[id]\n\tAND fonte.[data]\t  = destino.[data]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([id], [numero_pis], [demissao], [data], [entrada_1], [saida_1], [entrada_2], [saida_2], [entrada_3], [saida_3], [entrada_4], [saida_4], [entrada_5], [saida_5], [normais], [faltas], [ex], [ex_50%], [ex_60%], [ex_100%], [ex_120%], [observacoes]) \n\t\tVALUES (fonte.[id], fonte.[numero_pis], fonte.[demissao], fonte.[data], fonte.[entrada_1], fonte.[saida_1], fonte.[entrada_2], fonte.[saida_2], fonte.[entrada_3], fonte.[saida_3], fonte.[entrada_4], fonte.[saida_4], fonte.[entrada_5], fonte.[saida_5], fonte.[normais], fonte.[faltas], fonte.[ex], fonte.[ex_50%], fonte.[ex_60%], fonte.[ex_100%], fonte.[ex_120%], fonte.[observacoes])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\t destino.[numero_pis]\t    =\tfonte.[numero_pis]\n\t\t,destino.[demissao]\t\t\t=\tfonte.[demissao]\n\t\t,destino.[entrada_1]\t\t=\tfonte.[entrada_1]\n\t\t,destino.[saida_1]\t\t    =\tfonte.[saida_1]\n\t\t,destino.[entrada_2]\t\t=\tfonte.[entrada_2]\n\t\t,destino.[saida_2]\t\t    =\tfonte.[saida_2]\n\t\t,destino.[entrada_3]\t\t=\tfonte.[entrada_3]\n\t\t,destino.[saida_3]\t\t    =\tfonte.[saida_3]\n\t\t,destino.[entrada_4]\t\t=\tfonte.[entrada_4]\n\t\t,destino.[saida_4]\t\t    =\tfonte.[saida_4]\n\t\t,destino.[entrada_5]\t\t=\tfonte.[entrada_5]\n\t\t,destino.[saida_5]\t\t    =\tfonte.[saida_5]\n\t\t,destino.[normais]\t\t    =\tfonte.[normais]\n\t\t,destino.[faltas]\t\t    =\tfonte.[faltas]\n\t\t,destino.[ex]\t\t\t\t=\tfonte.[ex]\n\t\t,destino.[ex_50%]\t\t    =\tfonte.[ex_50%]\n\t\t,destino.[ex_60%]\t\t    =\tfonte.[ex_60%]\n\t\t,destino.[ex_100%]\t\t    =\tfonte.[ex_100%]\n\t\t,destino.[ex_120%]\t\t    =\tfonte.[ex_120%]\n\t\t,destino.[observacoes]      =   fonte.[observacoes]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\n\n\t--EXEC sp_att_log\n\t\n\nGO\n",
        "build_order": 303,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horaextra]": [
                "SELECT",
                "SELECT * FROM [dim_log_secullum_horaextra]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "EXEC",
                "EXEC sp_att_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horaextra]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_att_log_secullum_horaextra]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horaextra]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_att_log_secullum_horaextra]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_log_secullum_horarios",
        "type": "StoredProcedure",
        "start": 386517,
        "end": 387684,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_log_secullum_horarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n--DROP TABLE [dim_log_secullum_horarios]\n\nCREATE    PROCEDURE [dbo].[sp_att_log_secullum_horarios] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t-- DROP TABLE IF EXISTS dim_log_secullum_horaextra;\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_log_secullum_horarios' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_log_secullum_horarios]( \n\t\t\t[Id]\t\t        [int]\t\t\tNOT NULL,\n\t\t\t[HorarioId]\t        [bigint]       \tNOT NULL,\n\t\t\t[DiaSemana]\t\t\t[int]        \tNULL,\n\t\t\t[Entrada1]\t\t\t[time](0)  \t\tNULL,\n\t\t\t[Saida1]\t\t\t[time](0)\t\tNULL,\n\t\t\t[Entrada2]\t\t\t[time](0)  \t\tNULL,\n\t\t\t[Saida2]\t\t\t[time](0)\t\tNULL,\n\t\t\t[intervalo_S]       [int]\t\t\tNULL,\n\t\t) ON [PRIMARY]\n\tEND\n\t\n\tDELETE FROM dim_log_secullum_horarios\n\tINSERT INTO dim_log_secullum_horarios \n\tSELECT \n\t [Id]\n\t,[HorarioId]\n\t,[DiaSemana]\n\t,[Entrada1]\n\t,[Saida1]\n\t,[Entrada2]\n\t,[Saida2]\n\t,[intervalo_S] = CASE WHEN [Entrada2] IS NOT NULL\n\t\t\t\t\t\tTHEN DATEDIFF(s, [Saida1], [Entrada2])\n\t\t\t\t\t\tELSE NULL \n\t\t\t\t\t\tEND\n\tFROM #temp0\n  \n  \n\nGO\n",
        "build_order": 304,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]": [
                "INSERT",
                "INSERT INTO dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horaextra]": [
                "DROP",
                "DROP TABLE IF EXISTS dim_log_secullum_horaextra"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horarios]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[sp_att_log_secullum_horarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log_secullum_horarios]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[sp_att_log_secullum_horarios]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_contas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_contas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_excel_contas",
        "type": "StoredProcedure",
        "start": 387684,
        "end": 388056,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_excel_contas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE           PROCEDURE [dbo].[sp_att_mendi_excel_contas]\nAS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\tDROP TABLE IF EXISTS dim_mendi_contas\n\tSELECT * INTO dim_mendi_contas FROM #temp0\n\n\n\nGO\n",
        "build_order": 305,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_contas]": [
                "SELECT",
                "SELECT * INTO dim_mendi_contas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_contas]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_mendi_excel_contas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_contas]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_mendi_excel_contas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_creditos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_creditos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_excel_creditos",
        "type": "StoredProcedure",
        "start": 388056,
        "end": 388436,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_excel_creditos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE           PROCEDURE [dbo].[sp_att_mendi_excel_creditos]\nAS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\tDROP TABLE IF EXISTS dim_mendi_creditos\n\tSELECT * INTO dim_mendi_creditos FROM #temp0\n\n\n\nGO\n",
        "build_order": 306,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_creditos]": [
                "SELECT",
                "SELECT * INTO dim_mendi_creditos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_creditos]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_mendi_excel_creditos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_creditos]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_mendi_excel_creditos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_faltas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_faltas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_excel_faltas",
        "type": "StoredProcedure",
        "start": 388436,
        "end": 388810,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_excel_faltas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE             PROCEDURE [dbo].[sp_att_mendi_excel_faltas]\nAS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\tDROP TABLE IF EXISTS dim_mendi_faltas\n\tSELECT * INTO dim_mendi_faltas FROM #temp0\n\n\n\nGO\n",
        "build_order": 307,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_faltas]": [
                "SELECT",
                "SELECT * INTO dim_mendi_faltas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_faltas]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_att_mendi_excel_faltas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_excel_faltas]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_att_mendi_excel_faltas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_forms]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_forms]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_forms",
        "type": "StoredProcedure",
        "start": 388810,
        "end": 389164,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_forms]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE         PROCEDURE [dbo].[sp_att_mendi_forms]\nAS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\tDROP TABLE IF EXISTS dim_mendi_forms\n\tSELECT * INTO dim_mendi_forms FROM #temp0\n\n\n\nGO\n",
        "build_order": 308,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_forms]": [
                "SELECT",
                "SELECT * INTO dim_mendi_forms"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_forms]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_att_mendi_forms]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_forms]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_att_mendi_forms]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod12]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod12]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod12",
        "type": "StoredProcedure",
        "start": 389164,
        "end": 395310,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod12]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod12] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\t--SELECT * FROM dim_mendi_saudevianet_cod12\n\t--DROP TABLE teste\n\t--SELECT * INTO teste_m FROM #temp0\n\t--SELECT * INTO  #temp0 FROM teste_m\n\t--SELECT * FROM teste_m\n\t--drop table dim_mendi_saudevianet_cod12\n\t--GO\n\t\n\t\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod12' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod12]( \n\t\t\t [id]\t\t\t\t\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[nome]\t\t\t\t\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[dt_nascimento]\t\t\t\t[date]\t\t\tNULL\n\t\t\t,[cpf]\t\t\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[rg]\t\t\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[sexo]\t\t\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[profissao]\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[num_prontuario]\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[indicado_por]\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[logradouro]\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[bairro]\t\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[cep]\t\t\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[cidade]\t\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[estado]\t\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[telefone]\t\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[emails]\t\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[dt_cadastro]\t\t\t\t\t[datetime]\t\tNULL\n\t\t\t,[resp_cadastro]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[dt_ultimo_atendimento]\t\t[datetime]\t\tNULL\n\t\t\t,[dt_primeiro_atendimento]\t\t[datetime]\t\tNULL\n\t\t\t,[qtd_agendamento]\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[etiqueta]\t\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[prof_primeiro_atendimento]\t[varchar](100)\tNULL\n\t\t\t,[prof_ultimo_atendimento]\t\t[varchar](100)\tNULL\n\t\t\t,[plano_saude]\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[mes_aniversario]\t\t\t\t[varchar](50)\tNULL\n\t\t) ON[PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod12]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT * FROM (\n\t\t\tSELECT\t \n\t\t\t\t [n]\t\t\t\t\t\t\t= ROW_NUMBER() OVER (PARTITION BY [pessoaid] ORDER BY [dt_cadastro] DESC) --pessoas vindo duplicadas/com dois endere\u00e7os (??)\t\n\t\t\t\t,[id]\t\t\t\t\t\t\t= [pessoaid]\n\t\t\t\t,[nome]\t\t\t\t\t\t\t= [nome]\n\t\t\t\t,[dt_nascimento]\t\t\t\t= TRY_CAST(TRY_CAST([dt_nascimento] AS VARCHAR(MAX)) AS DATE)\n\t\t\t\t,[cpf]\t\t\t\t\t\t\t= [cpf_cliente]\n\t\t\t\t,[rg]\t\t\t\t\t\t\t= [rg]\n\t\t\t\t,[sexo]\t\t\t\t\t\t\t= [sexo]\n\t\t\t\t,[profissao]\t\t\t\t\t= [profissao]\n\t\t\t\t,[num_prontuario]\t\t\t\t= [num_prontuario]\n\t\t\t\t,[indicado_por]\t\t\t\t\t= [indicado_por]\n\t\t\t\t,[logradouro]\t\t\t\t\t= [logradouro]\n\t\t\t\t,[bairro]\t\t\t\t\t\t= [bairro]\n\t\t\t\t,[cep]\t\t\t\t\t\t\t= [cep]\n\t\t\t\t,[cidade]\t\t\t\t\t\t= [cidade]\n\t\t\t\t,[estado]\t\t\t\t\t\t= [estado]\n\t\t\t\t,[telefone]\t\t\t\t\t\t= [telefone]\n\t\t\t\t,[emails]\t\t\t\t\t\t= [emails]\n\t\t\t\t,[dt_cadastro]\t\t\t\t\t= TRY_CAST(TRY_CAST([dt_cadastro] AS VARCHAR(MAX)) AS DATETIME)\n\t\t\t\t,[resp_cadastro]\t\t\t\t= [resp_cadastro]\n\t\t\t\t,[dt_ultimo_atendimento]\t\t= TRY_CAST(TRY_CAST([dt_ultimo_atendimento] AS VARCHAR(MAX)) AS DATETIME)\n\t\t\t\t,[dt_primeiro_atendimento]\t\t= TRY_CAST(TRY_CAST([dt_primeiro_atendimento] AS VARCHAR(MAX)) AS DATETIME)\n\t\t\t\t,[qtd_agendamento]\t\t\t\t= [qtd_agendamento]\n\t\t\t\t,[etiqueta]\t\t\t\t\t\t= [etiqueta]\n\t\t\t\t,[prof_primeiro_atendimento]\t= [prof_primeiro_atendimento]\n\t\t\t\t,[prof_ultimo_atendimento]\t\t= [prof_ultimo_atendimento]\n\t\t\t\t,[plano_saude]\t\t\t\t\t= [plano_saude]\n\t\t\t\t,[mes_aniversario]\t\t\t\t= [mes_aniversario]\n\t\t\tFROM #temp0\n\t\t) _ WHERE n = 1\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\t\t \n\t\t\t,[nome]\t\t\t\t\t\t\t \n\t\t\t,[dt_nascimento]\t\t\t\t \n\t\t\t,[cpf]\t\t\t\t\t\t\t \n\t\t\t,[rg]\t\t\t\t\t\t\t \n\t\t\t,[sexo]\t\t\t\t\t\t\t \n\t\t\t,[profissao]\t\t\t\t\t \n\t\t\t,[num_prontuario]\t\t\t\t \n\t\t\t,[indicado_por]\t\t\t\t\t \n\t\t\t,[logradouro]\t\t\t\t\t \n\t\t\t,[bairro]\t\t\t\t\t\t \n\t\t\t,[cep]\t\t\t\t\t\t\t \n\t\t\t,[cidade]\t\t\t\t\t\t \n\t\t\t,[estado]\t\t\t\t\t\t \n\t\t\t,[telefone]\t\t\t\t\t\t \n\t\t\t,[emails]\t\t\t\t\t\t \n\t\t\t,[dt_cadastro]\t\t\t\t\t \n\t\t\t,[resp_cadastro]\t\t\t\t \n\t\t\t,[dt_ultimo_atendimento]\t\t \n\t\t\t,[dt_primeiro_atendimento]\t\t \n\t\t\t,[qtd_agendamento]\t\t\t\t \n\t\t\t,[etiqueta]\t\t\t\t\t\t \n\t\t\t,[prof_primeiro_atendimento]\t \n\t\t\t,[prof_ultimo_atendimento]\t\t \n\t\t\t,[plano_saude]\t\t\t\t\t \n\t\t\t,[mes_aniversario]\t\t\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\t\t \n\t\t\t,fonte.[nome]\t\t\t\t\t\t\t \n\t\t\t,fonte.[dt_nascimento]\t\t\t\t \n\t\t\t,fonte.[cpf]\t\t\t\t\t\t\t \n\t\t\t,fonte.[rg]\t\t\t\t\t\t\t \n\t\t\t,fonte.[sexo]\t\t\t\t\t\t\t \n\t\t\t,fonte.[profissao]\t\t\t\t\t \n\t\t\t,fonte.[num_prontuario]\t\t\t\t \n\t\t\t,fonte.[indicado_por]\t\t\t\t\t \n\t\t\t,fonte.[logradouro]\t\t\t\t\t \n\t\t\t,fonte.[bairro]\t\t\t\t\t\t \n\t\t\t,fonte.[cep]\t\t\t\t\t\t\t \n\t\t\t,fonte.[cidade]\t\t\t\t\t\t \n\t\t\t,fonte.[estado]\t\t\t\t\t\t \n\t\t\t,fonte.[telefone]\t\t\t\t\t\t \n\t\t\t,fonte.[emails]\t\t\t\t\t\t \n\t\t\t,fonte.[dt_cadastro]\t\t\t\t\t \n\t\t\t,fonte.[resp_cadastro]\t\t\t\t \n\t\t\t,fonte.[dt_ultimo_atendimento]\t\t \n\t\t\t,fonte.[dt_primeiro_atendimento]\t\t \n\t\t\t,fonte.[qtd_agendamento]\t\t\t\t \n\t\t\t,fonte.[etiqueta]\t\t\t\t\t\t \n\t\t\t,fonte.[prof_primeiro_atendimento]\t \n\t\t\t,fonte.[prof_ultimo_atendimento]\t\t \n\t\t\t,fonte.[plano_saude]\t\t\t\t\t \n\t\t\t,fonte.[mes_aniversario]\t\t\t\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t \n\t\t\t destino.[nome]\t\t\t\t\t\t\t = fonte.[nome]\n\t\t\t,destino.[dt_nascimento]\t\t\t\t = fonte.[dt_nascimento]\n\t\t\t,destino.[cpf]\t\t\t\t\t\t\t = fonte.[cpf]\n\t\t\t,destino.[rg]\t\t\t\t\t\t\t = fonte.[rg]\n\t\t\t,destino.[sexo]\t\t\t\t\t\t\t = fonte.[sexo]\n\t\t\t,destino.[profissao]\t\t\t\t\t = fonte.[profissao]\n\t\t\t,destino.[num_prontuario]\t\t\t\t = fonte.[num_prontuario]\n\t\t\t,destino.[indicado_por]\t\t\t\t\t = fonte.[indicado_por]\n\t\t\t,destino.[logradouro]\t\t\t\t\t = fonte.[logradouro]\n\t\t\t,destino.[bairro]\t\t\t\t\t\t = fonte.[bairro]\n\t\t\t,destino.[cep]\t\t\t\t\t\t\t = fonte.[cep]\n\t\t\t,destino.[cidade]\t\t\t\t\t\t = fonte.[cidade]\n\t\t\t,destino.[estado]\t\t\t\t\t\t = fonte.[estado]\n\t\t\t,destino.[telefone]\t\t\t\t\t\t = fonte.[telefone]\n\t\t\t,destino.[emails]\t\t\t\t\t\t = fonte.[emails]\n\t\t\t,destino.[dt_cadastro]\t\t\t\t\t = fonte.[dt_cadastro]\n\t\t\t,destino.[resp_cadastro]\t\t\t\t = fonte.[resp_cadastro]\n\t\t\t,destino.[dt_ultimo_atendimento]\t\t = fonte.[dt_ultimo_atendimento]\n\t\t\t,destino.[dt_primeiro_atendimento]\t\t = fonte.[dt_primeiro_atendimento]\n\t\t\t,destino.[qtd_agendamento]\t\t\t\t = fonte.[qtd_agendamento]\n\t\t\t,destino.[etiqueta]\t\t\t\t\t\t = fonte.[etiqueta]\n\t\t\t,destino.[prof_primeiro_atendimento]\t = fonte.[prof_primeiro_atendimento]\n\t\t\t,destino.[prof_ultimo_atendimento]\t\t = fonte.[prof_ultimo_atendimento]\n\t\t\t,destino.[plano_saude]\t\t\t\t\t = fonte.[plano_saude]\n\t\t\t,destino.[mes_aniversario]\t\t\t\t = fonte.[mes_aniversario]\n\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 309,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod12]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod12]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod12]": [
                "CREATE",
                "CREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod12]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod12]": [
                "CREATE",
                "CREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod12]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod15]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod15]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod15",
        "type": "StoredProcedure",
        "start": 395310,
        "end": 399477,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod15]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod15] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\t\n\t--SELECT * FROM dim_mendi_saudevianet_cod12\n\t--DROP TABLE teste_m\n\t--SELECT * INTO teste_m FROM #temp0\n\t--SELECT * INTO #temp0 FROM teste_m\n\t--SELECT * FROM teste_m\n\t--drop table dim_mendi_saudevianet_cod15\n\t--GO\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod15' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod15]( \n\t\t\t [id]\t\t\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[nome_paciente]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[data_agendamento]\t\t\t\t[datetime]\t\tNULL\n\t\t\t,[nome_prof]\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[situacao_agendamento]\t\t\t[varchar](50)\tNULL\n\t\t\t,[email_contato]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[telefones]\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[procedimento]\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[plano_saude]\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[anotacao]\t\t\t\t\t\t[varchar](MAX)\tNULL\n\t\t\t,[agen_tx_observacao]\t\t\t[varchar](MAX)\tNULL\n\t\t\t,[resp_alteracao]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[agen_dt_alteracao]\t\t\t[datetime]\t\tNULL\n\t\t\t,[inma_tx_motivo]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[agen_tx_motivo_cancelamento]\t[varchar](MAX)\tNULL\n\t\t) ON[PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod15]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT * FROM (\n\t\t\tSELECT\t \n\t\t\t\t [n]\t\t\t\t\t\t\t= ROW_NUMBER() OVER (PARTITION BY [agen_id] ORDER BY [agen_dt_alteracao] DESC) --pessoas vindo duplicadas/com dois endere\u00e7os (??)\t\n\t\t\t\t,[id]\t\t\t\t\t\t\t= [agen_id]\n\t\t\t\t,[nome_paciente]\t\t\t\t= [nome_paciente]\n\t\t\t\t,[data_agendamento]\t\t\t\t= [data_agendamento]\n\t\t\t\t,[nome_prof]\t\t\t\t\t= [nome_prof]\n\t\t\t\t,[situacao_agendamento]\t\t\t= [situacao_agendamento]\n\t\t\t\t,[email_contato]\t\t\t\t= [email_contato]\n\t\t\t\t,[telefones]\t\t\t\t\t= [telefones]\n\t\t\t\t,[procedimento]\t\t\t\t\t= [procedimento]\n\t\t\t\t,[plano_saude]\t\t\t\t\t= [plano_saude]\n\t\t\t\t,[anotacao]\t\t\t\t\t\t= [anotacao]\n\t\t\t\t,[agen_tx_observacao]\t\t\t= [agen_tx_observacao]\n\t\t\t\t,[resp_alteracao]\t\t\t\t= [resp_alteracao]\n\t\t\t\t,[agen_dt_alteracao]\t\t\t= [agen_dt_alteracao]\n\t\t\t\t,[inma_tx_motivo]\t\t\t\t= [inma_tx_motivo]\n\t\t\t\t,[agen_tx_motivo_cancelamento]\t= [agen_tx_motivo_cancelamento]\n\t\t\tFROM #temp0\n\t\t) _ WHERE n = 1\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\t\t\n\t\t\t,[nome_paciente]\t\t\t\t\n\t\t\t,[data_agendamento]\t\t\t\t\n\t\t\t,[nome_prof]\t\t\t\t\t\n\t\t\t,[situacao_agendamento]\t\t\t\n\t\t\t,[email_contato]\t\t\t\t\n\t\t\t,[telefones]\t\t\t\t\t\n\t\t\t,[procedimento]\t\t\t\t\t\n\t\t\t,[plano_saude]\t\t\t\t\t\n\t\t\t,[anotacao]\t\t\t\t\t\t\n\t\t\t,[agen_tx_observacao]\t\t\t\n\t\t\t,[resp_alteracao]\t\t\t\t\n\t\t\t,[agen_dt_alteracao]\t\t\t\n\t\t\t,[inma_tx_motivo]\t\t\t\t\n\t\t\t,[agen_tx_motivo_cancelamento]\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\t\t\n\t\t\t,fonte.[nome_paciente]\t\t\t\t\n\t\t\t,fonte.[data_agendamento]\t\t\t\t\n\t\t\t,fonte.[nome_prof]\t\t\t\t\t\n\t\t\t,fonte.[situacao_agendamento]\t\t\t\n\t\t\t,fonte.[email_contato]\t\t\t\t\n\t\t\t,fonte.[telefones]\t\t\t\t\t\n\t\t\t,fonte.[procedimento]\t\t\t\t\t\n\t\t\t,fonte.[plano_saude]\t\t\t\t\t\n\t\t\t,fonte.[anotacao]\t\t\t\t\t\t\n\t\t\t,fonte.[agen_tx_observacao]\t\t\t\n\t\t\t,fonte.[resp_alteracao]\t\t\t\t\n\t\t\t,fonte.[agen_dt_alteracao]\t\t\t\n\t\t\t,fonte.[inma_tx_motivo]\t\t\t\t\n\t\t\t,fonte.[agen_tx_motivo_cancelamento]\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t destino.[nome_paciente]\t\t\t\t= fonte.[nome_paciente]\n\t\t\t,destino.[data_agendamento]\t\t\t\t= fonte.[data_agendamento]\n\t\t\t,destino.[nome_prof]\t\t\t\t\t= fonte.[nome_prof]\n\t\t\t,destino.[situacao_agendamento]\t\t\t= fonte.[situacao_agendamento]\n\t\t\t,destino.[email_contato]\t\t\t\t= fonte.[email_contato]\n\t\t\t,destino.[telefones]\t\t\t\t\t= fonte.[telefones]\n\t\t\t,destino.[procedimento]\t\t\t\t\t= fonte.[procedimento]\n\t\t\t,destino.[plano_saude]\t\t\t\t\t= fonte.[plano_saude]\n\t\t\t,destino.[anotacao]\t\t\t\t\t\t= fonte.[anotacao]\n\t\t\t,destino.[agen_tx_observacao]\t\t\t= fonte.[agen_tx_observacao]\n\t\t\t,destino.[resp_alteracao]\t\t\t\t= fonte.[resp_alteracao]\n\t\t\t,destino.[agen_dt_alteracao]\t\t\t= fonte.[agen_dt_alteracao]\n\t\t\t,destino.[inma_tx_motivo]\t\t\t\t= fonte.[inma_tx_motivo]\n\t\t\t,destino.[agen_tx_motivo_cancelamento]\t= fonte.[agen_tx_motivo_cancelamento]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 310,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod12]": [
                "SELECT",
                "SELECT * FROM dim_mendi_saudevianet_cod12"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod15]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod15]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod15]": [
                "CREATE",
                "CREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod15]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod15]": [
                "CREATE",
                "CREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod15]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod301]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod301]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod301",
        "type": "StoredProcedure",
        "start": 399477,
        "end": 405368,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod301]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE                   PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod301] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\t--SELECT * FROM dim_mendi_saudevianet_cod301\n\t--DROP TABLE teste\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * FROM teste\n\t--drop table dim_mendi_saudevianet_cod301\n\n\t\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod301' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod301]( \n\t\t\t [id]\t\t\t\t\t[varchar](150)\tNOT NULL\n\t\t\t,[nome_instituicao]\t\t[varchar](100)\tNULL\n\t\t\t,[pess_id]\t\t\t\t[varchar](40)\tNULL\n\t\t\t,[nome]\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[dt_nascimento]\t\t[date]\t\t\tNULL\n\t\t\t,[cpf]\t\t\t\t\t[varchar](25)\tNULL\n\t\t\t,[rg]\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[etiquetas]\t\t\t[varchar](100)\tNULL\n\t\t\t,[sexo]\t\t\t\t\t[varchar](10)\tNULL\n\t\t\t,[profissao]\t\t\t[varchar](100)\tNULL\n\t\t\t,[num_prontuario]\t\t[varchar](25)\tNULL\n\t\t\t,[indicado_por]\t\t\t[varchar](100)\tNULL\n\t\t\t,[logradouro]\t\t\t[varchar](100)\tNULL\n\t\t\t,[num_endereco]\t\t\t[int]\t\t\tNULL\n\t\t\t,[complemento]\t\t\t[varchar](100)\tNULL\n\t\t\t,[bairro]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[cep]\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[cidade]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[estado]\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[telefones]\t\t\t[varchar](250)\tNULL\n\t\t\t,[emails]\t\t\t\t[varchar](250)\tNULL\n\t\t\t,[dt_cadastro]\t\t\t[datetime]\t\tNULL\n\t\t\t,[resp_cadastro]\t\t[varchar](100)\tNULL\n\t\t\t,[ultimo_atendimento]\t[datetime]\t\tNULL\n\t\t\t,[planos_saude]\t\t\t[varchar](100)\tNULL\n\t\t\t,[numero_cateira]\t\t[varchar](100)\tNULL\n\t\t\t,[nome_mae]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[nome_pai]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[estado_civil]\t\t\t[varchar](100)\tNULL\n\n\t\t) ON[PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod301]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT * FROM (\n\t\t\tSELECT\t \n\t\t\t\t [n]\t\t\t\t\t= ROW_NUMBER() OVER (PARTITION BY [pess_id] ORDER BY CONVERT(datetime, [dt_cadastro], 120) DESC)\n\t\t\t\t,[id]\t\t\t\t\t= [pess_id]\n\t\t\t\t,[nome_instituicao]\t\t= [nome_instituicao]\n\t\t\t\t,[pess_id]\t\t\t\t= [pess_id]\n\t\t\t\t,[nome]\t\t\t\t\t= [nome]\n\t\t\t\t,[dt_nascimento]\t\t= CONVERT(date, [dt_nascimento], 23)\n\t\t\t\t,[cpf]\t\t\t\t\t= [cpf]\n\t\t\t\t,[rg]\t\t\t\t\t= [rg]\n\t\t\t\t,[etiquetas]\t\t\t= [etiquetas]\n\t\t\t\t,[sexo]\t\t\t\t\t= [sexo]\n\t\t\t\t,[profissao]\t\t\t= [profissao]\n\t\t\t\t,[num_prontuario]\t\t= [num_prontuario]\n\t\t\t\t,[indicado_por]\t\t\t= [indicado_por]\n\t\t\t\t,[logradouro]\t\t\t= [logradouro]\n\t\t\t\t,[num_endereco]\t\t\t= [num_endereco]\n\t\t\t\t,[complemento]\t\t\t= [complemento]\n\t\t\t\t,[bairro]\t\t\t\t= [bairro]\n\t\t\t\t,[cep]\t\t\t\t\t= [cep]\n\t\t\t\t,[cidade]\t\t\t\t= [cidade]\n\t\t\t\t,[estado]\t\t\t\t= [estado]\n\t\t\t\t,[telefones]\t\t\t= [telefones]\n\t\t\t\t,[emails]\t\t\t\t= [emails]\n\t\t\t\t,[dt_cadastro]\t\t\t= CONVERT(datetime, [dt_cadastro], 120)\n\t\t\t\t,[resp_cadastro]\t\t= [resp_cadastro]\n\t\t\t\t,[ultimo_atendimento]\t= CONVERT(datetime, [ultimo_atendimento], 120)\n\t\t\t\t,[planos_saude]\t\t\t= [planos_saude]\n\t\t\t\t,[numero_cateira]\t\t= [numero_cateira]\n\t\t\t\t,[nome_mae]\t\t\t\t= [nome_mae]\n\t\t\t\t,[nome_pai]\t\t\t\t= [nome_pai]\n\t\t\t\t,[estado_civil]\t\t\t= [estado_civil]\n\t\t\tFROM #temp0\n\t\t) _ WHERE n = 1\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[nome_instituicao]\t\t\n\t\t\t,[pess_id]\t\t\t\t\n\t\t\t,[nome]\t\t\t\t\t\n\t\t\t,[dt_nascimento]\t\t\n\t\t\t,[cpf]\t\t\t\t\t\n\t\t\t,[rg]\t\t\t\t\t\n\t\t\t,[etiquetas]\t\t\t\n\t\t\t,[sexo]\t\t\t\t\t\n\t\t\t,[profissao]\t\t\t\n\t\t\t,[num_prontuario]\t\t\n\t\t\t,[indicado_por]\t\t\t\n\t\t\t,[logradouro]\t\t\t\n\t\t\t,[num_endereco]\t\t\t\n\t\t\t,[complemento]\t\t\t\n\t\t\t,[bairro]\t\t\t\t\n\t\t\t,[cep]\t\t\t\t\t\n\t\t\t,[cidade]\t\t\t\t\n\t\t\t,[estado]\t\t\t\t\n\t\t\t,[telefones]\t\t\t\n\t\t\t,[emails]\t\t\t\t\n\t\t\t,[dt_cadastro]\t\t\t\n\t\t\t,[resp_cadastro]\t\t\n\t\t\t,[ultimo_atendimento]\t\n\t\t\t,[planos_saude]\t\t\t\n\t\t\t,[numero_cateira]\t\t\n\t\t\t,[nome_mae]\t\t\t\t\n\t\t\t,[nome_pai]\t\t\t\t\n\t\t\t,[estado_civil]\t\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\t\t\n\t\t\t,fonte.[nome_instituicao]\t\t\n\t\t\t,fonte.[pess_id]\t\t\t\t\n\t\t\t,fonte.[nome]\t\t\t\t\t\n\t\t\t,fonte.[dt_nascimento]\t\t\n\t\t\t,fonte.[cpf]\t\t\t\t\t\n\t\t\t,fonte.[rg]\t\t\t\t\t\n\t\t\t,fonte.[etiquetas]\t\t\t\n\t\t\t,fonte.[sexo]\t\t\t\t\t\n\t\t\t,fonte.[profissao]\t\t\t\n\t\t\t,fonte.[num_prontuario]\t\t\n\t\t\t,fonte.[indicado_por]\t\t\t\n\t\t\t,fonte.[logradouro]\t\t\t\n\t\t\t,fonte.[num_endereco]\t\t\t\n\t\t\t,fonte.[complemento]\t\t\t\n\t\t\t,fonte.[bairro]\t\t\t\t\n\t\t\t,fonte.[cep]\t\t\t\t\t\n\t\t\t,fonte.[cidade]\t\t\t\t\n\t\t\t,fonte.[estado]\t\t\t\t\n\t\t\t,fonte.[telefones]\t\t\t\n\t\t\t,fonte.[emails]\t\t\t\t\n\t\t\t,fonte.[dt_cadastro]\t\t\t\n\t\t\t,fonte.[resp_cadastro]\t\t\n\t\t\t,fonte.[ultimo_atendimento]\t\n\t\t\t,fonte.[planos_saude]\t\t\t\n\t\t\t,fonte.[numero_cateira]\t\t\n\t\t\t,fonte.[nome_mae]\t\t\t\t\n\t\t\t,fonte.[nome_pai]\t\t\t\t\n\t\t\t,fonte.[estado_civil]\t\t\t\t\t\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t\t\t\t\t\t\t\n\t\t\t destino.[nome_instituicao]\t\t= fonte.[nome_instituicao]\n\t\t\t,destino.[pess_id]\t\t\t\t= fonte.[pess_id]\n\t\t\t,destino.[nome]\t\t\t\t\t= fonte.[nome]\n\t\t\t,destino.[dt_nascimento]\t\t= fonte.[dt_nascimento]\n\t\t\t,destino.[cpf]\t\t\t\t\t= fonte.[cpf]\n\t\t\t,destino.[rg]\t\t\t\t\t= fonte.[rg]\n\t\t\t,destino.[etiquetas]\t\t\t= fonte.[etiquetas]\n\t\t\t,destino.[sexo]\t\t\t\t\t= fonte.[sexo]\n\t\t\t,destino.[profissao]\t\t\t= fonte.[profissao]\n\t\t\t,destino.[num_prontuario]\t\t= fonte.[num_prontuario]\n\t\t\t,destino.[indicado_por]\t\t\t= fonte.[indicado_por]\n\t\t\t,destino.[logradouro]\t\t\t= fonte.[logradouro]\n\t\t\t,destino.[num_endereco]\t\t\t= fonte.[num_endereco]\n\t\t\t,destino.[complemento]\t\t\t= fonte.[complemento]\n\t\t\t,destino.[bairro]\t\t\t\t= fonte.[bairro]\n\t\t\t,destino.[cep]\t\t\t\t\t= fonte.[cep]\n\t\t\t,destino.[cidade]\t\t\t\t= fonte.[cidade]\n\t\t\t,destino.[estado]\t\t\t\t= fonte.[estado]\n\t\t\t,destino.[telefones]\t\t\t= fonte.[telefones]\n\t\t\t,destino.[emails]\t\t\t\t= fonte.[emails]\n\t\t\t,destino.[dt_cadastro]\t\t\t= fonte.[dt_cadastro]\n\t\t\t,destino.[resp_cadastro]\t\t= fonte.[resp_cadastro]\n\t\t\t,destino.[ultimo_atendimento]\t= fonte.[ultimo_atendimento]\n\t\t\t,destino.[planos_saude]\t\t\t= fonte.[planos_saude]\n\t\t\t,destino.[numero_cateira]\t\t= fonte.[numero_cateira]\n\t\t\t,destino.[nome_mae]\t\t\t\t= fonte.[nome_mae]\n\t\t\t,destino.[nome_pai]\t\t\t\t= fonte.[nome_pai]\n\t\t\t,destino.[estado_civil]\t\t\t= fonte.[estado_civil]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 311,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod301]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod301]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod301]": [
                "CREATE",
                "CREATE                   PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod301]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod301]": [
                "CREATE",
                "CREATE                   PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod301]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod304]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod304]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod304",
        "type": "StoredProcedure",
        "start": 405368,
        "end": 407385,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod304]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE                   PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod304] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\t--SELECT * FROM dim_mendi_saudevianet_cod304\n\t--DROP TABLE teste\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * FROM teste\n\t--drop table dim_mendi_saudevianet_cod304\n\n\t\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod304' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod304]( \n\t\t\t [id]\t\t\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[nome_instituicao]\t\t[varchar](50)\tNULL\n\t\t\t,[mes_cadastro]\t\t\t[date]\t\t\tNULL\n\t\t\t,[sexo]\t\t\t\t\t[varchar](1)\tNULL\n\t\t\t,[idade]\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[qtd_pacientes]\t\t[int]\t\t\tNULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod304]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\t \n\t\t\t [id]\t\t\t\t\t= CONCAT([nome_instituicao], '-', [mes_cadastro], '-', [sexo], '-', [idade]) \n\t\t\t,[nome_instituicao]\t\t= [nome_instituicao]\n\t\t\t,[mes_cadastro]\t\t\t= [mes_cadastro]\t\n\t\t\t,[sexo]\t\t\t\t\t= [sexo]\n\t\t\t,[idade]\t\t\t\t= [idade]\n\t\t\t,[qtd_pacientes]\t\t= [qtd_pacientes]\n\t\tFROM #temp0\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t \n\t\t\t,[nome_instituicao]\t\t\n\t\t\t,[mes_cadastro]\n\t\t\t,[sexo]\t\t\t\t\t\n\t\t\t,[idade]\t\t\t\t\n\t\t\t,[qtd_pacientes]\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\t \n\t\t\t,fonte.[nome_instituicao]\t\t\n\t\t\t,fonte.[mes_cadastro]\t \n\t\t\t,fonte.[sexo]\t\t\t\t\t\n\t\t\t,fonte.[idade]\t\t\t\t\n\t\t\t,fonte.[qtd_pacientes]\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t\t\t\t\t\t\t\n\t\t\t destino.[id]\t\t\t\t\t= fonte.[id]\n\t\t\t,destino.[nome_instituicao]\t\t= fonte.[nome_instituicao]\n\t\t\t,destino.[mes_cadastro]\t\t\t= fonte.[mes_cadastro]\n\t\t\t,destino.[sexo]\t\t\t\t\t= fonte.[sexo]\n\t\t\t,destino.[idade]\t\t\t\t= fonte.[idade]\n\t\t\t,destino.[qtd_pacientes]\t\t= fonte.[qtd_pacientes]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 312,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod304]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod304]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod304]": [
                "CREATE",
                "CREATE                   PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod304]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod304]": [
                "CREATE",
                "CREATE                   PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod304]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod61]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod61]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod61",
        "type": "StoredProcedure",
        "start": 407385,
        "end": 411263,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod61]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE                 PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod61] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\t--SELECT * FROM dim_mendi_saudevianet_cod61\n\t--DROP TABLE teste\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * FROM teste\n\t--drop table dim_mendi_saudevianet_cod\n\t--GO\n\t\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod61' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod61]( \n\t\t\t [id]\t\t\t\t\t\t[varchar](150)\tNOT NULL\n\t\t\t,[inst_id]\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[inst_tx_nome]\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[mes_ref]\t\t\t\t\t[datetime]\t\tNOT NULL\n\t\t\t,[qtd_total]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_agendamentos]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_marcados]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_atendido]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_falta]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_desmarcados]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_remarcacao]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[perc_faltas]\t\t\t\t[float]\t\t\tNOT NULL\n\t\t\t,[qtd_retornos]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[valor_marcados]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[valor_atendido]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[valor_faltas]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[valor_desmarcados]\t\t[int]\t\t\tNOT NULL\n\t\t) ON[PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod61]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\t \n\t\t\t [id]\t\t\t\t\t\t= CONCAT([inst_id], '-', [mes_ref])\n\t\t\t,[inst_id]\t\t\t\t\t= [inst_id]\n\t\t\t,[inst_tx_nome]\t\t\t\t= [inst_tx_nome]\n\t\t\t,[mes_ref]\t\t\t\t\t= [mes_ref]\n\t\t\t,[qtd_total]\t\t\t\t= [qtd_total]\n\t\t\t,[qtd_agendamentos]\t\t\t= [qtd_agendamentos]\n\t\t\t,[qtd_marcados]\t\t\t\t= [qtd_marcados]\n\t\t\t,[qtd_atendido]\t\t\t\t= [qtd_atendido]\n\t\t\t,[qtd_falta]\t\t\t\t= [qtd_falta]\n\t\t\t,[qtd_desmarcados]\t\t\t= [qtd_desmarcados]\n\t\t\t,[qtd_remarcacao]\t\t\t= [qtd_remarcacao]\n\t\t\t,[perc_faltas]\t\t\t\t= [perc_faltas]\n\t\t\t,[qtd_retornos]\t\t\t\t= [qtd_retornos]\n\t\t\t,[valor_marcados]\t\t\t= [valor_marcados]\n\t\t\t,[valor_atendido]\t\t\t= [valor_atendido]\n\t\t\t,[valor_faltas]\t\t\t\t= [valor_faltas]\n\t\t\t,[valor_desmarcados]\t\t= [valor_desmarcados]\n\n\t\tFROM #temp0\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[inst_tx_nome]\t\t\t\t\n\t\t\t,[mes_ref]\t\t\t\t\t\n\t\t\t,[qtd_total]\t\t\t\t\n\t\t\t,[qtd_agendamentos]\t\t\t\n\t\t\t,[qtd_marcados]\t\t\t\t\n\t\t\t,[qtd_atendido]\t\t\t\t\n\t\t\t,[qtd_falta]\t\t\t\t\n\t\t\t,[qtd_desmarcados]\t\t\t\n\t\t\t,[qtd_remarcacao]\t\t\t\n\t\t\t,[perc_faltas]\t\t\t\t\n\t\t\t,[qtd_retornos]\t\t\t\t\n\t\t\t,[valor_marcados]\t\t\t\n\t\t\t,[valor_atendido]\t\t\t\n\t\t\t,[valor_faltas]\t\t\t\t\n\t\t\t,[valor_desmarcados]\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\t\n\t\t\t,fonte.[inst_id]\t\t\t\t\t\n\t\t\t,fonte.[inst_tx_nome]\t\t\t\t\n\t\t\t,fonte.[mes_ref]\t\t\t\t\t\n\t\t\t,fonte.[qtd_total]\t\t\t\t\n\t\t\t,fonte.[qtd_agendamentos]\t\t\t\n\t\t\t,fonte.[qtd_marcados]\t\t\t\t\n\t\t\t,fonte.[qtd_atendido]\t\t\t\t\n\t\t\t,fonte.[qtd_falta]\t\t\t\t\n\t\t\t,fonte.[qtd_desmarcados]\t\t\t\n\t\t\t,fonte.[qtd_remarcacao]\t\t\t\n\t\t\t,fonte.[perc_faltas]\t\t\t\t\n\t\t\t,fonte.[qtd_retornos]\t\t\t\t\n\t\t\t,fonte.[valor_marcados]\t\t\t\n\t\t\t,fonte.[valor_atendido]\t\t\t\n\t\t\t,fonte.[valor_faltas]\t\t\t\t\n\t\t\t,fonte.[valor_desmarcados]\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t [inst_id]\t\t\t\t\t= fonte.[inst_id]\n\t\t\t,[inst_tx_nome]\t\t\t\t= fonte.[inst_tx_nome]\n\t\t\t,[mes_ref]\t\t\t\t\t= fonte.[mes_ref]\n\t\t\t,[qtd_total]\t\t\t\t= fonte.[qtd_total]\n\t\t\t,[qtd_agendamentos]\t\t\t= fonte.[qtd_agendamentos]\n\t\t\t,[qtd_marcados]\t\t\t\t= fonte.[qtd_marcados]\n\t\t\t,[qtd_atendido]\t\t\t\t= fonte.[qtd_atendido]\n\t\t\t,[qtd_falta]\t\t\t\t= fonte.[qtd_falta]\n\t\t\t,[qtd_desmarcados]\t\t\t= fonte.[qtd_desmarcados]\n\t\t\t,[qtd_remarcacao]\t\t\t= fonte.[qtd_remarcacao]\n\t\t\t,[perc_faltas]\t\t\t\t= fonte.[perc_faltas]\n\t\t\t,[qtd_retornos]\t\t\t\t= fonte.[qtd_retornos]\n\t\t\t,[valor_marcados]\t\t\t= fonte.[valor_marcados]\n\t\t\t,[valor_atendido]\t\t\t= fonte.[valor_atendido]\n\t\t\t,[valor_desmarcados]\t\t= fonte.[valor_desmarcados]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 313,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod61]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod61]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod61]": [
                "CREATE",
                "CREATE                 PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod61]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod61]": [
                "CREATE",
                "CREATE                 PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod61]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod613]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod613]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod613",
        "type": "StoredProcedure",
        "start": 411263,
        "end": 413914,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod613]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n--SELECT * FROM dim_mendi_saudevianet_cod613\n\n\nCREATE                     PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod613] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\t--SELECT * FROM dim_mendi_saudevianet_cod613\n\t--DROP TABLE teste\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * FROM teste\n\t--drop table dim_mendi_saudevianet_cod613\n\n\t\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod613' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod613]( \n\t\t\t [id]\t\t\t\t\t[varchar](500)\tNOT NULL\n\t\t\t,[qtd_respostas]\t\t[int]\t\t\tNULL\n\t\t\t,[data_resposta]\t\t[date]\t\t\tNULL\n\t\t\t,[perg_id]\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[perg_tx_descricao]\t[varchar](250)\tNULL\n\t\t\t,[resp_id]\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[resp_tx_descricao]\t[varchar](250)\tNULL\n\t\t\t,[inst_id]\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[pess_tx_nome]\t\t\t[varchar](100)\tNULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod613]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\t \n\t\t\t [id]\t\t\t\t\t= CONCAT([data_resposta], '-', [perg_id], '-', [resp_id], '-', [inst_id], '-', [pess_tx_nome]) \n\t\t\t,[qtd_respostas]\t\t= [qtdrespostas]\n\t\t\t,[data_resposta]\t\t= [data_resposta]\n\t\t\t,[perg_id]\t\t\t\t= [perg_id]\n\t\t\t,[perg_tx_descricao]\t= [perg_tx_descricao]\n\t\t\t,[resp_id]\t\t\t\t= [resp_id]\n\t\t\t,[resp_tx_descricao]\t= [resp_tx_descricao]\n\t\t\t,[inst_id]\t\t\t\t= [inst_id]\n\t\t\t,[pess_tx_nome]\t\t\t= [pess_tx_nome]\n\t\tFROM #temp0\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\n\t\t\t,[qtd_respostas]\t\t\n\t\t\t,[data_resposta]\t\t\n\t\t\t,[perg_id]\t\t\t\t\n\t\t\t,[perg_tx_descricao]\t\n\t\t\t,[resp_id]\t\t\t\t\n\t\t\t,[resp_tx_descricao]\t\n\t\t\t,[inst_id]\t\t\t\t\n\t\t\t,[pess_tx_nome]\t\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\n\t\t\t,fonte.[qtd_respostas]\t\t\n\t\t\t,fonte.[data_resposta]\t\t\n\t\t\t,fonte.[perg_id]\t\t\t\t\n\t\t\t,fonte.[perg_tx_descricao]\t\n\t\t\t,fonte.[resp_id]\t\t\t\t\n\t\t\t,fonte.[resp_tx_descricao]\t\n\t\t\t,fonte.[inst_id]\t\t\t\t\n\t\t\t,fonte.[pess_tx_nome]\t\t\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t\t\t\t\t\t\t\n\t\t\t destino.[id]\t\t\t\t\t= fonte.[id]\n\t\t\t,destino.[qtd_respostas]\t\t= fonte.[qtd_respostas]\n\t\t\t,destino.[data_resposta]\t\t= fonte.[data_resposta]\n\t\t\t,destino.[perg_id]\t\t\t\t= fonte.[perg_id]\n\t\t\t,destino.[perg_tx_descricao]\t= fonte.[perg_tx_descricao]\n\t\t\t,destino.[resp_id]\t\t\t\t= fonte.[resp_id]\n\t\t\t,destino.[resp_tx_descricao]\t= fonte.[resp_tx_descricao]\n\t\t\t,destino.[inst_id]\t\t\t\t= fonte.[inst_id]\n\t\t\t,destino.[pess_tx_nome]\t\t\t= fonte.[pess_tx_nome]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 314,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod613]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod613]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod613]": [
                "CREATE",
                "CREATE                     PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod613]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod613]": [
                "CREATE",
                "CREATE                     PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod613]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod62]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod62]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod62",
        "type": "StoredProcedure",
        "start": 413914,
        "end": 417029,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod62]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE                 PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod62] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\t--SELECT * FROM dim_mendi_saudevianet_cod62\n\t--DROP TABLE teste\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * FROM teste\n\t--drop table dim_mendi_saudevianet_cod\n\t--GO\n\t\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod62' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod62]( \n\t\t\t [id]\t\t\t\t\t\t[varchar](150)\tNOT NULL\n\t\t\t,[inst_id]\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[inst_tx_nome]\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[agda_tx_rotulo]\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[nome_profissional]\t\t[varchar](100)\tNOT NULL\n\t\t\t,[qtd_agendamentos]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_marcados]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_atendido]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_falta]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_desmarcados]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_remarcacao]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[perc_faltas]\t\t\t\t[float]\t\t\tNOT NULL\n\t\t) ON[PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod62]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\t \n\t\t\t [id]\t\t\t\t\t\t= CONCAT([inst_id], '-', [agda_tx_rotulo])\n\t\t\t,[inst_id]\t\t\t\t\t= [inst_id]\n\t\t\t,[inst_tx_nome]\t\t\t\t= [inst_tx_nome]\n\t\t\t,[agda_tx_rotulo]\t\t\t= [agda_tx_rotulo]\n\t\t\t,[nome_profissional]\t\t= [nome_profissional]\n\t\t\t,[qtd_agendamentos]\t\t\t= [qtd_agendamentos]\n\t\t\t,[qtd_marcados]\t\t\t\t= [qtd_marcados]\n\t\t\t,[qtd_atendido]\t\t\t\t= [qtd_atendido]\n\t\t\t,[qtd_falta]\t\t\t\t= [qtd_falta]\n\t\t\t,[qtd_desmarcados]\t\t\t= [qtd_desmarcados]\n\t\t\t,[qtd_remarcacao]\t\t\t= [qtd_remarcacao]\n\t\t\t,[perc_faltas]\t\t\t\t= [perc_faltas]\n\n\t\tFROM #temp0\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[inst_tx_nome]\t\t\t\t\n\t\t\t,[agda_tx_rotulo]\t\t\t\t\t\n\t\t\t,[nome_profissional]\t\t\t\t\n\t\t\t,[qtd_agendamentos]\t\t\t\n\t\t\t,[qtd_marcados]\t\t\t\t\n\t\t\t,[qtd_atendido]\t\t\t\t\n\t\t\t,[qtd_falta]\t\t\t\t\n\t\t\t,[qtd_desmarcados]\t\t\t\n\t\t\t,[qtd_remarcacao]\t\t\t\n\t\t\t,[perc_faltas]\t\t\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\t\n\t\t\t,fonte.[inst_id]\t\t\t\t\t\n\t\t\t,fonte.[inst_tx_nome]\t\t\t\t\n\t\t\t,fonte.[agda_tx_rotulo]\t\t\t\t\t\n\t\t\t,fonte.[nome_profissional]\t\t\t\t\n\t\t\t,fonte.[qtd_agendamentos]\t\t\t\n\t\t\t,fonte.[qtd_marcados]\t\t\t\t\n\t\t\t,fonte.[qtd_atendido]\t\t\t\t\n\t\t\t,fonte.[qtd_falta]\t\t\t\t\n\t\t\t,fonte.[qtd_desmarcados]\t\t\t\n\t\t\t,fonte.[qtd_remarcacao]\t\t\t\n\t\t\t,fonte.[perc_faltas]\t\t\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t [inst_id]\t\t\t\t\t= fonte.[inst_id]\n\t\t\t,[inst_tx_nome]\t\t\t\t= fonte.[inst_tx_nome]\n\t\t\t,[agda_tx_rotulo]\t\t\t= fonte.[agda_tx_rotulo]\n\t\t\t,[nome_profissional]\t\t= fonte.[nome_profissional]\n\t\t\t,[qtd_agendamentos]\t\t\t= fonte.[qtd_agendamentos]\n\t\t\t,[qtd_marcados]\t\t\t\t= fonte.[qtd_marcados]\n\t\t\t,[qtd_atendido]\t\t\t\t= fonte.[qtd_atendido]\n\t\t\t,[qtd_falta]\t\t\t\t= fonte.[qtd_falta]\n\t\t\t,[qtd_desmarcados]\t\t\t= fonte.[qtd_desmarcados]\n\t\t\t,[qtd_remarcacao]\t\t\t= fonte.[qtd_remarcacao]\n\t\t\t,[perc_faltas]\t\t\t\t= fonte.[perc_faltas]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 315,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod62]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod62]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod62]": [
                "CREATE",
                "CREATE                 PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod62]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod62]": [
                "CREATE",
                "CREATE                 PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod62]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod7]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod7]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod7",
        "type": "StoredProcedure",
        "start": 417029,
        "end": 424357,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod7]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod7] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\n\t--SELECT * FROM teste WHERE pess_tx_nome like '%Dante%'\n\t\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * INTO #temp0 FROM teste\n\t--DROP table teste\n\t--DROP table dim_mendi_saudevianet_cod7\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod7' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod7]( \n\t\t\t [id]\t\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[inst_id]\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[inst_nome]\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[agen_motivo_cancelamento]\t[varchar](250)\tNULL\n\t\t\t,[agda_rotulo]\t\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[pess_id]\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[pess_nome]\t\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[agen_inicio]\t\t\t\t[datetime]\t\tNOT NULL\n\t\t\t,[agen_chegada]\t\t\t\t[datetime]\t\tNULL\n\t\t\t,[agen_intervalo]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[agen_inicio_atendimento]\t[datetime]\t\tNULL\n\t\t\t,[agen_fim_atendimento]\t\t[datetime]\t\tNULL\n\t\t\t,[siag_situacao_agend]\t\t[varchar](25)\tNOT NULL\n\t\t\t,[agen_encaixe]\t\t\t\t[varchar](3)\tNOT NULL\t\n\t\t\t,[agen_antecipar]\t\t\t[varchar](3)\tNOT NULL\n\t\t\t,[agen_online]\t\t\t\t[varchar](3)\tNOT NULL\n\t\t\t,[nome_profissional]\t\t[varchar](100)\tNOT NULL\n\t\t\t,[nome_operadora]\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[tabela_preco]\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[procedimento]\t\t\t\t[varchar](250)\tNULL\n\t\t\t,[etiqueta_paciente]\t\t[varchar](50)\tNULL\n\t\t\t,[etiqueta_agendamento]\t\t[varchar](50)\tNULL\n\t\t\t,[agen_alteracao]\t\t\t[datetime]\t\tNOT NULL\n\t\t\t,[agen_cadastro]\t\t\t[datetime]\t\tNOT NULL\n\t\t\t,[nome_responsavel]\t\t\t[varchar](100)\tNULL\n\t\t\t,[ultimo_atend_inst]\t\t[datetime]\t\tNULL\n\t\t\t,[qtd_dias_sem_retorno]\t\t[int]\t\t\tNULL\n\t\t\t,[orca_id]\t\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[inma_motivo]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[prox_agendamento]\t\t\t[datetime]\t\tNULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\n\t--DECLARE @data_min date = (SELECT MIN(DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127))) FROM #temp0)\n\t--DECLARE @data_max date = (SELECT MAX(DATEADD(HOUR, -3, CONVERT(datetime, [conversationStart], 127))) FROM #temp0)\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod7]\n\t\t--WHERE [inicio]\t\t\t\t >= @data_min\n\t\t--AND\t  CAST([inicio] as date) <= @data_max\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\t\n\t\tSELECT * FROM (\n\t\t\tSELECT\t\n\t\t\t\t [n]\t\t\t\t\t\t= ROW_NUMBER() OVER (PARTITION BY [agen_id] ORDER BY [nome_responsavel])\n\t\t\t\t,[id]\t\t\t\t\t\t= [agen_id]\n\t\t\t\t,[inst_id]\t\t\t\t\t= [inst_id]\n\t\t\t\t,[inst_nome]\t\t\t\t= [inst_tx_nome]\n\t\t\t\t,[agen_motivo_cancelamento]\t= [agen_tx_motivo_cancelamento]\n\t\t\t\t,[agda_rotulo]\t\t\t\t= [agda_tx_rotulo]\n\t\t\t\t,[pess_id]\t\t\t\t\t= [pess_id]\n\t\t\t\t,[pess_nome]\t\t\t\t= [pess_tx_nome]\n\t\t\t\t,[agen_inicio]\t\t\t\t= [agen_dt_inicio]\n\t\t\t\t,[agen_chegada]\t\t\t\t= [agen_dt_chegada]\n\t\t\t\t,[agen_intervalo]\t\t\t= [agen_nr_intervalo]\n\t\t\t\t,[agen_inicio_atendimento]\t= [agen_dt_inicio_atendimento]\n\t\t\t\t,[agen_fim_atendimento]\t\t= [agen_dt_fim_atendimento]\n\t\t\t\t,[siag_situacao_agend]\t\t= [siag_tx_situacao_agend]\n\t\t\t\t,[agen_encaixe]\t\t\t\t= [agen_in_encaixe]\n\t\t\t\t,[agen_antecipar]\t\t\t= [agen_in_antecipar]\n\t\t\t\t,[agen_online]\t\t\t\t= [agen_in_online]\n\t\t\t\t,[nome_profissional]\t\t= [nome_profissional]\n\t\t\t\t,[nome_operadora]\t\t\t= [nome_operadora]\n\t\t\t\t,[tabela_preco]\t\t\t\t= [tabela_preco]\n\t\t\t\t,[procedimento]\t\t\t\t= [procedimento]\n\t\t\t\t,[etiqueta_paciente]\t\t= [etiqueta_paciente]\n\t\t\t\t,[etiqueta_agendamento]\t\t= [etiqueta_agendamento]\n\t\t\t\t,[agen_alteracao]\t\t\t= [agen_dt_alteracao]\n\t\t\t\t,[agen_cadastro]\t\t\t= [agen_dt_cadastro]\n\t\t\t\t,[nome_responsavel]\t\t\t= [nome_responsavel]\n\t\t\t\t,[ultimo_atend_inst]\t\t= [ultimo_atend_inst]\n\t\t\t\t,[qtd_dias_sem_retorno]\t\t= [qtd_dias_sem_retorno]\n\t\t\t\t,[orca_id]\t\t\t\t\t= [orca_id]\n\t\t\t\t,[inma_motivo]\t\t\t\t= [inma_tx_motivo]\n\t\t\t\t,[prox_agendamento]\t\t\t= [prox_agendamento]\n\t\t\tFROM #temp0\n\t\t) _ WHERE [n] = 1\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[inst_nome]\t\t\t\t\n\t\t\t,[agen_motivo_cancelamento]\t\n\t\t\t,[agda_rotulo]\t\t\t\t\n\t\t\t,[pess_id]\t\t\t\t\t\n\t\t\t,[pess_nome]\t\t\t\t\n\t\t\t,[agen_inicio]\t\t\t\t\n\t\t\t,[agen_chegada]\t\t\t\t\n\t\t\t,[agen_intervalo]\t\t\t\n\t\t\t,[agen_inicio_atendimento]\t\n\t\t\t,[agen_fim_atendimento]\t\t\n\t\t\t,[siag_situacao_agend]\t\t\n\t\t\t,[agen_encaixe]\t\t\t\t\n\t\t\t,[agen_antecipar]\t\t\t\n\t\t\t,[agen_online]\t\t\t\t\n\t\t\t,[nome_profissional]\t\t\n\t\t\t,[nome_operadora]\t\t\t\n\t\t\t,[tabela_preco]\t\t\t\t\n\t\t\t,[procedimento]\t\t\t\t\n\t\t\t,[etiqueta_paciente]\t\t\n\t\t\t,[etiqueta_agendamento]\t\t\n\t\t\t,[agen_alteracao]\t\t\t\n\t\t\t,[agen_cadastro]\t\t\t\n\t\t\t,[nome_responsavel]\t\t\t\n\t\t\t,[ultimo_atend_inst]\t\t\n\t\t\t,[qtd_dias_sem_retorno]\t\t\n\t\t\t,[orca_id]\t\t\t\t\t\n\t\t\t,[inma_motivo]\t\t\t\t\n\t\t\t,[prox_agendamento]\t\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\t\n\t\t\t,fonte.[inst_id]\t\t\t\t\t\n\t\t\t,fonte.[inst_nome]\t\t\t\t\n\t\t\t,fonte.[agen_motivo_cancelamento]\t\n\t\t\t,fonte.[agda_rotulo]\t\t\t\t\n\t\t\t,fonte.[pess_id]\t\t\t\t\t\n\t\t\t,fonte.[pess_nome]\t\t\t\t\n\t\t\t,fonte.[agen_inicio]\t\t\t\t\n\t\t\t,fonte.[agen_chegada]\t\t\t\t\n\t\t\t,fonte.[agen_intervalo]\t\t\t\n\t\t\t,fonte.[agen_inicio_atendimento]\t\n\t\t\t,fonte.[agen_fim_atendimento]\t\t\n\t\t\t,fonte.[siag_situacao_agend]\t\t\n\t\t\t,fonte.[agen_encaixe]\t\t\t\t\n\t\t\t,fonte.[agen_antecipar]\t\t\t\n\t\t\t,fonte.[agen_online]\t\t\t\t\n\t\t\t,fonte.[nome_profissional]\t\t\n\t\t\t,fonte.[nome_operadora]\t\t\t\n\t\t\t,fonte.[tabela_preco]\t\t\t\t\n\t\t\t,fonte.[procedimento]\t\t\t\t\n\t\t\t,fonte.[etiqueta_paciente]\t\t\n\t\t\t,fonte.[etiqueta_agendamento]\t\t\n\t\t\t,fonte.[agen_alteracao]\t\t\t\n\t\t\t,fonte.[agen_cadastro]\t\t\t\n\t\t\t,fonte.[nome_responsavel]\t\t\t\n\t\t\t,fonte.[ultimo_atend_inst]\t\t\n\t\t\t,fonte.[qtd_dias_sem_retorno]\t\t\n\t\t\t,fonte.[orca_id]\t\t\t\t\t\n\t\t\t,fonte.[inma_motivo]\t\t\t\t\n\t\t\t,fonte.[prox_agendamento]\t\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t \n\t\t\t destino.[inst_id]\t\t\t\t\t= fonte.[inst_id]\n\t\t\t,destino.[inst_nome]\t\t\t\t= fonte.[inst_nome]\n\t\t\t,destino.[agen_motivo_cancelamento]\t= fonte.[agen_motivo_cancelamento]\n\t\t\t,destino.[agda_rotulo]\t\t\t\t= fonte.[agda_rotulo]\n\t\t\t,destino.[pess_id]\t\t\t\t\t= fonte.[pess_id]\n\t\t\t,destino.[pess_nome]\t\t\t\t= fonte.[pess_nome]\n\t\t\t,destino.[agen_inicio]\t\t\t\t= fonte.[agen_inicio]\n\t\t\t,destino.[agen_chegada]\t\t\t\t= fonte.[agen_chegada]\n\t\t\t,destino.[agen_intervalo]\t\t\t= fonte.[agen_intervalo]\n\t\t\t,destino.[agen_inicio_atendimento]\t= fonte.[agen_inicio_atendimento]\n\t\t\t,destino.[agen_fim_atendimento]\t\t= fonte.[agen_fim_atendimento]\n\t\t\t,destino.[siag_situacao_agend]\t\t= fonte.[siag_situacao_agend]\n\t\t\t,destino.[agen_encaixe]\t\t\t\t= fonte.[agen_encaixe]\n\t\t\t,destino.[agen_antecipar]\t\t\t= fonte.[agen_antecipar]\n\t\t\t,destino.[agen_online]\t\t\t\t= fonte.[agen_online]\n\t\t\t,destino.[nome_profissional]\t\t= fonte.[nome_profissional]\n\t\t\t,destino.[nome_operadora]\t\t\t= fonte.[nome_operadora]\n\t\t\t,destino.[tabela_preco]\t\t\t\t= fonte.[tabela_preco]\n\t\t\t,destino.[procedimento]\t\t\t\t= fonte.[procedimento]\n\t\t\t,destino.[etiqueta_paciente]\t\t= fonte.[etiqueta_paciente]\n\t\t\t,destino.[etiqueta_agendamento]\t\t= fonte.[etiqueta_agendamento]\n\t\t\t,destino.[agen_alteracao]\t\t\t= fonte.[agen_alteracao]\n\t\t\t,destino.[agen_cadastro]\t\t\t= fonte.[agen_cadastro]\n\t\t\t,destino.[nome_responsavel]\t\t\t= fonte.[nome_responsavel]\n\t\t\t,destino.[ultimo_atend_inst]\t\t= fonte.[ultimo_atend_inst]\n\t\t\t,destino.[qtd_dias_sem_retorno]\t\t= fonte.[qtd_dias_sem_retorno]\n\t\t\t,destino.[orca_id]\t\t\t\t\t= fonte.[orca_id]\n\t\t\t,destino.[inma_motivo]\t\t\t\t= fonte.[inma_motivo]\n\t\t\t,destino.[prox_agendamento]\t\t\t= fonte.[prox_agendamento]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 316,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod7]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod7]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod7]": [
                "CREATE",
                "CREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod7]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod7]": [
                "CREATE",
                "CREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod7]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod78]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod78]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod78",
        "type": "StoredProcedure",
        "start": 424357,
        "end": 427669,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod78]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE                 PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod78] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\t--SELECT * FROM dim_mendi_saudevianet_cod62\n\t--DROP TABLE teste\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * FROM teste\n\t--drop table dim_mendi_saudevianet_cod\n\t--GO\n\t\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod78' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod78]( \n\t\t\t [id]\t\t\t\t\t\t[varchar](150)\tNOT NULL\n\t\t\t,[inst_id]\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[agda_tx_rotulo]\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[agda_id]\t\t\t\t\t[varchar](50)\tNOT NULL\n\t\t\t,[data_ref]\t\t\t\t\t[date]\t\t\tNOT NULL\n\t\t\t,[qtd_ocupado]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_total]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_min_dia]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[perc_ocupacao_slot]\t\t[float]\t\t\tNOT NULL\n\t\t\t,[tempo_ocupado]\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[perc_ocupacao_tempo]\t\t[float]\t\t\tNOT NULL\n\t\t\t,[qtd_agend]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t\t,[qtd_agend_slot]\t\t\t[int]\t\t\tNOT NULL\n\t\t) ON[PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod78]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\t \n\t\t\t [id]\t\t\t\t\t\t= CONCAT([inst_id], '-', [agda_id], '-', [data_ref])\n\t\t\t,[inst_id]\t\t\t\t\t= [inst_id]\n\t\t\t,[agda_tx_rotulo]\t\t\t= [agda_tx_rotulo]\n\t\t\t,[agda_id]\t\t\t\t\t= [agda_id]\n\t\t\t,[data_ref]\t\t\t\t\t= [data_ref]\n\t\t\t,[qtd_ocupado]\t\t\t\t= [qtd_ocupado]\n\t\t\t,[qtd_total]\t\t\t\t= [qtd_total]\n\t\t\t,[qtd_min_dia]\t\t\t\t= [qtd_min_dia]\n\t\t\t,[perc_ocupacao_slot]\t\t= [perc_ocupacao_slot]\n\t\t\t,[tempo_ocupado]\t\t\t= [tempo_ocupado]\n\t\t\t,[perc_ocupacao_tempo]\t\t= [perc_ocupacao_tempo]\n\t\t\t,[qtd_agend]\t\t\t\t= [qtd_agend]\n\t\t\t,[qtd_agend_slot]\t\t\t= [qtd_agend_slot]\n\n\t\tFROM #temp0\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[agda_tx_rotulo]\t\t\t\n\t\t\t,[agda_id]\t\t\t\t\t\n\t\t\t,[data_ref]\t\t\t\t\t\n\t\t\t,[qtd_ocupado]\t\t\t\t\n\t\t\t,[qtd_total]\t\t\t\t\n\t\t\t,[qtd_min_dia]\t\t\t\t\n\t\t\t,[perc_ocupacao_slot]\t\t\n\t\t\t,[tempo_ocupado]\t\t\t\n\t\t\t,[perc_ocupacao_tempo]\t\t\n\t\t\t,[qtd_agend]\t\t\t\t\n\t\t\t,[qtd_agend_slot]\t\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\t\n\t\t\t,fonte.[inst_id]\t\t\t\t\t\n\t\t\t,fonte.[agda_tx_rotulo]\t\t\t\n\t\t\t,fonte.[agda_id]\t\t\t\t\t\n\t\t\t,fonte.[data_ref]\t\t\t\t\t\n\t\t\t,fonte.[qtd_ocupado]\t\t\t\t\n\t\t\t,fonte.[qtd_total]\t\t\t\t\n\t\t\t,fonte.[qtd_min_dia]\t\t\t\t\n\t\t\t,fonte.[perc_ocupacao_slot]\t\t\n\t\t\t,fonte.[tempo_ocupado]\t\t\t\n\t\t\t,fonte.[perc_ocupacao_tempo]\t\t\n\t\t\t,fonte.[qtd_agend]\t\t\t\t\n\t\t\t,fonte.[qtd_agend_slot]\t\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t destino.[inst_id]\t\t\t\t\t= fonte.[inst_id]\n\t\t\t,destino.[agda_tx_rotulo]\t\t\t= fonte.[agda_tx_rotulo]\n\t\t\t,destino.[agda_id]\t\t\t\t\t= fonte.[agda_id]\n\t\t\t,destino.[data_ref]\t\t\t\t\t= fonte.[data_ref]\n\t\t\t,destino.[qtd_ocupado]\t\t\t\t= fonte.[qtd_ocupado]\n\t\t\t,destino.[qtd_total]\t\t\t\t= fonte.[qtd_total]\n\t\t\t,destino.[qtd_min_dia]\t\t\t\t= fonte.[qtd_min_dia]\n\t\t\t,destino.[perc_ocupacao_slot]\t\t= fonte.[perc_ocupacao_slot]\n\t\t\t,destino.[tempo_ocupado]\t\t\t= fonte.[tempo_ocupado]\n\t\t\t,destino.[perc_ocupacao_tempo]\t\t= fonte.[perc_ocupacao_tempo]\n\t\t\t,destino.[qtd_agend]\t\t\t\t= fonte.[qtd_agend]\n\t\t\t,destino.[qtd_agend_slot]\t\t\t= fonte.[qtd_agend_slot]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 317,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod78]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod78]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod62]": [
                "SELECT",
                "SELECT * FROM dim_mendi_saudevianet_cod62"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod78]": [
                "CREATE",
                "CREATE                 PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod78]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod78]": [
                "CREATE",
                "CREATE                 PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod78]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod79]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod79]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod79",
        "type": "StoredProcedure",
        "start": 427669,
        "end": 430322,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod79]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE                   PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod79] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\t--SELECT * FROM dim_mendi_saudevianet_cod79\n\t--DROP TABLE teste\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * FROM teste\n\t--drop table dim_mendi_saudevianet_cod79\n\t--GO\n\t\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod79' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod79]( \n\t\t\t [id]\t\t\t\t\t[varchar](150)\tNOT NULL\n\t\t\t,[pess_tx_nome]\t\t\t[varchar](100)\tNOT NULL\n\t\t\t,[pess_nr_cpf]\t\t\t[varchar](25)\tNOT NULL\n\t\t\t,[ref_conselho]\t\t\t[varchar](25)\tNOT NULL\n\t\t\t,[pess_dt_nascimento]\t[date]\t\t\tNULL\n\t\t\t,[usua_tx_email]\t\t[varchar](100)\tNOT NULL\n\t\t\t,[especialidades]\t\t[varchar](250)\tNULL\n\t\t\t,[telefones]\t\t\t[varchar](50)\tNULL\n\t\t\t,[dt_cadastro]\t\t\t[datetime]\t\tNOT NULL\n\t\t) ON[PRIMARY]\n\tEND\n\n\t\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod79]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT\t \n\t\t\t [id]\t\t\t\t\t= CONCAT([ref_conselho], '-', [dt_cadastro])\n\t\t\t,[pess_tx_nome]\t\t\t= [pess_tx_nome]\n\t\t\t,[pess_nr_cpf]\t\t\t= [pess_nr_cpf]\n\t\t\t,[ref_conselho]\t\t\t= [ref_conselho]\n\t\t\t,[pess_dt_nascimento]\t= CAST(CAST([pess_dt_nascimento] as varchar(10)) as date)\n\t\t\t,[usua_tx_email]\t\t= [usua_tx_email]\n\t\t\t,[especialidades]\t\t= [especialidades]\n\t\t\t,[telefones]\t\t\t= [telefones]\n\t\t\t,[dt_cadastro]\t\t\t= CAST([dt_cadastro] as datetime)\n\t\tFROM #temp0\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\n\t\t\t,[pess_tx_nome]\t\t\t\n\t\t\t,[pess_nr_cpf]\t\t\t\n\t\t\t,[ref_conselho]\t\t\t\n\t\t\t,[pess_dt_nascimento]\t\n\t\t\t,[usua_tx_email]\t\t\n\t\t\t,[especialidades]\t\t\n\t\t\t,[telefones]\t\t\t\n\t\t\t,[dt_cadastro]\t\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\n\t\t\t,fonte.[pess_tx_nome]\t\t\t\n\t\t\t,fonte.[pess_nr_cpf]\t\t\t\n\t\t\t,fonte.[ref_conselho]\t\t\t\n\t\t\t,fonte.[pess_dt_nascimento]\t\n\t\t\t,fonte.[usua_tx_email]\t\t\n\t\t\t,fonte.[especialidades]\t\t\n\t\t\t,fonte.[telefones]\t\t\t\n\t\t\t,fonte.[dt_cadastro]\t\t\t\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t destino.[pess_tx_nome]\t\t\t= fonte.[pess_tx_nome]\t\t\n\t\t\t,destino.[pess_nr_cpf]\t\t\t= fonte.[pess_nr_cpf]\t\n\t\t\t,destino.[ref_conselho]\t\t\t= fonte.[ref_conselho]\n\t\t\t,destino.[pess_dt_nascimento]\t= fonte.[pess_dt_nascimento]\n\t\t\t,destino.[usua_tx_email]\t\t= fonte.[usua_tx_email]\n\t\t\t,destino.[especialidades]\t\t= fonte.[especialidades]\n\t\t\t,destino.[telefones]\t\t\t= fonte.[telefones]\n\t\t\t,destino.[dt_cadastro]\t\t\t= fonte.[dt_cadastro]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\n\n\n\nGO\n",
        "build_order": 318,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod79]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod79]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod79]": [
                "CREATE",
                "CREATE                   PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod79]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod79]": [
                "CREATE",
                "CREATE                   PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod79]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod8]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod8]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod8",
        "type": "StoredProcedure",
        "start": 430322,
        "end": 433302,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod8]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n--DROP TABLE dim_mendi_saudevianet_cod8\n--GO\nCREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod8] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\n\t--SELECT * FROM dim_mendi_saudevianet_cod8\n\t--DROP TABLE dim_mendi_saudevianet_cod8\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * FROM teste\n\t--GO\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod8' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod8]( \n\t\t\t [id]\t\t\t\t\t\t[varchar](250)\tNOT NULL\n\t\t\t,[inst_id]\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[inst_nome]\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[mes_ref]\t\t\t\t\t[date]\t\t\tNULL\n\t\t\t,[agda_rotulo]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[nome_operadora]\t\t\t[varchar](50)\tNULL\n\t\t\t,[proc_nome]\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[qtd_pessoas]\t\t\t\t[int]\t\t\tNULL\n\t\t\t,[qtd_procedimentos]\t\t[int]\t\t\tNULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod8]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT * FROM (\n\t\t\tSELECT\t \n\t\t\t\t [n]\t\t\t\t\t\t= ROW_NUMBER() OVER (PARTITION BY CONCAT([inst_id], '-', [mes_ref], '-', [nome_operadora], '-', [agda_tx_rotulo], '-', [proc_tx_nome]) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t ORDER BY CONCAT([inst_id], '-', [mes_ref], '-', [nome_operadora], '-', [agda_tx_rotulo], '-', [proc_tx_nome]) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t DESC) --pessoas vindo duplicadas/com dois endere\u00e7os (??)\n\t\t\t\t,[id]\t\t\t\t\t\t= CONCAT([inst_id], '-', [mes_ref], '-', [nome_operadora], '-', [agda_tx_rotulo], '-', [proc_tx_nome])\n\t\t\t\t,[inst_id]\t\t\t\t\t= [inst_id]\n\t\t\t\t,[inst_nome]\t\t\t\t= [inst_tx_nome]\n\t\t\t\t,[mes_ref]\t\t\t\t\t= [mes_ref]\n\t\t\t\t,[agda_rotulo]\t\t\t\t= [agda_tx_rotulo]\n\t\t\t\t,[nome_operadora]\t\t\t= [nome_operadora]\n\t\t\t\t,[proc_nome]\t\t\t\t= [proc_tx_nome]\n\t\t\t\t,[qtd_pessoas]\t\t\t\t= [qtd_pessoas]\n\t\t\t\t,[qtd_procedimentos]\t\t= [qtd_procedimentos]\n\t\t\tFROM #temp0\n\t\t) _ WHERE n = 1\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\t\n\t\t\t,[inst_nome]\t\t\t\t\n\t\t\t,[mes_ref]\t\t\t\t\t\n\t\t\t,[agda_rotulo]\t\t\t\t\n\t\t\t,[nome_operadora]\t\t\t\n\t\t\t,[proc_nome]\t\t\t\t\n\t\t\t,[qtd_pessoas]\t\t\t\t\n\t\t\t,[qtd_procedimentos]\t\t\n\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\t\n\t\t\t,fonte.[inst_id]\t\t\t\t\t\n\t\t\t,fonte.[inst_nome]\t\t\t\t\n\t\t\t,fonte.[mes_ref]\t\t\t\t\t\n\t\t\t,fonte.[agda_rotulo]\t\t\t\t\n\t\t\t,fonte.[nome_operadora]\t\t\t\n\t\t\t,fonte.[proc_nome]\t\t\t\t\n\t\t\t,fonte.[qtd_pessoas]\t\t\t\t\n\t\t\t,fonte.[qtd_procedimentos]\t\t\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t \n\t\t\t destino.[inst_id]\t\t\t = fonte.[inst_id]\n\t\t\t,destino.[inst_nome]\t\t = fonte.[inst_nome]\n\t\t\t,destino.[mes_ref]\t\t\t = fonte.[mes_ref]\n\t\t\t,destino.[agda_rotulo]\t\t = fonte.[agda_rotulo]\n\t\t\t,destino.[nome_operadora]\t = fonte.[nome_operadora]\n\t\t\t,destino.[proc_nome]\t\t = fonte.[proc_nome]\n\t\t\t,destino.[qtd_pessoas]\t\t = fonte.[qtd_pessoas]\n\t\t\t,destino.[qtd_procedimentos] = fonte.[qtd_procedimentos]\n\t;\n\t--WHEN NOT MATCHED BY SOURCE THEN\n\t--\tDELETE;\n\n\n\n\n\nGO\n",
        "build_order": 319,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod8]": [
                "SELECT",
                "SELECT * FROM [dim_mendi_saudevianet_cod8]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod8]": [
                "CREATE",
                "CREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod8]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod8]": [
                "CREATE",
                "CREATE               PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod8]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod807]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod807]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_mendi_saudevianet_cod807",
        "type": "StoredProcedure",
        "start": 433302,
        "end": 436137,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_mendi_saudevianet_cod807]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE                     PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod807] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\t/*\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_mendi_saudevianet_cod807' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_mendi_saudevianet_cod807]( \n\t\t\t [id]\t\t\t\t\t[varchar](150)\tNOT NULL\n\t\t\t,[pess_id]\t\t\t\t[varchar](150)\tNULL\n\t\t\t,[inst_id]\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[nome]\t\t\t\t\t[varchar](100)\tNULL\n\t\t\t,[cpf]\t\t\t\t\t[varchar](50)\tNULL\n\t\t\t,[dt_nascimento]\t\t[date]\t\t\tNULL\n\t\t\t,[dt_cadastro]\t\t\t[datetime]\t\tNULL\n\t\t\t,[dt_alteracao]\t\t\t[datetime]\t\tNULL\n\t\t\t,[num_prontuario]\t\t[varchar](50)\tNULL\n\t\t\t,[resp_alteracao]\t\t[varchar](100)\tNULL\n\t\t) ON[PRIMARY]\n\tEND\n\n\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM [dim_mendi_saudevianet_cod807]\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT * FROM (\n\t\t\tSELECT\t \n\t\t\t\t [n]\t\t\t\t\t= ROW_NUMBER() OVER (PARTITION BY [pess_id] ORDER BY CONVERT(datetime, [pess_dt_alteracao], 120) DESC)\t\t\n\t\t\t\t,[id]\t\t\t\t\t= [pess_id]\n\t\t\t\t,[pess_id]\t\t\t\t= [pess_id]\n\t\t\t\t,[inst_id]\t\t\t\t= [inst_id]\n\t\t\t\t,[nome]\t\t\t\t\t= [pess_tx_nome]\n\t\t\t\t,[cpf]\t\t\t\t\t= [pess_nr_cpf]\n\t\t\t\t,[dt_nascimento]\t\t= TRY_CAST([pess_dt_nascimento] AS DATE)\n\t\t\t\t,[dt_cadastro]\t\t\t= TRY_CAST([pess_dt_cadastro] AS DATETIME)\n\t\t\t\t,[dt_alteracao]\t\t\t= CONVERT(datetime, [pess_dt_alteracao], 120)\n\t\t\t\t,[num_prontuario]\t\t= [pein_tx_codigo_prontuario]\n\t\t\t\t,[resp_alteracao]\t\t= [resp_alteracao]\n\t\t\tFROM #temp0\n\t\t) _ WHERE n = 1\n\t)AS fonte\n\tON  fonte.[id] = destino.[id]\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [id]\t\t\t\t\t\n\t\t\t,[pess_id]\t\t\t\t\n\t\t\t,[inst_id]\t\t\t\t\n\t\t\t,[nome]\t\t\t\t\t\n\t\t\t,[cpf]\t\t\t\t\t\n\t\t\t,[dt_nascimento]\t\t\n\t\t\t,[dt_cadastro]\t\t\t\n\t\t\t,[dt_alteracao]\t\t\t\n\t\t\t,[num_prontuario]\t\t\n\t\t\t,[resp_alteracao]\t\t\n\t\t)\n\t\tVALUES (\n\t\t\t fonte.[id]\t\t\t\t\t\n\t\t\t,fonte.[pess_id]\t\t\t\t\n\t\t\t,fonte.[inst_id]\t\t\t\t\n\t\t\t,fonte.[nome]\t\t\t\t\t\n\t\t\t,fonte.[cpf]\t\t\t\t\t\n\t\t\t,fonte.[dt_nascimento]\t\t\n\t\t\t,fonte.[dt_cadastro]\t\t\t\n\t\t\t,fonte.[dt_alteracao]\t\t\t\n\t\t\t,fonte.[num_prontuario]\t\t\n\t\t\t,fonte.[resp_alteracao]\t\t\t\t\t\t\t\t\n\t\t)\n\tWHEN MATCHED THEN UPDATE SET\n\t\t\t destino.[id]\t\t\t\t= fonte.[id]\t\t\t\t\t\n\t\t\t,destino.[pess_id]\t\t\t= fonte.[pess_id]\t\t\t\t\n\t\t\t,destino.[inst_id]\t\t\t= fonte.[inst_id]\t\t\t\t\n\t\t\t,destino.[nome]\t\t\t\t= fonte.[nome]\t\t\t\t\t\n\t\t\t,destino.[cpf]\t\t\t\t= fonte.[cpf]\t\t\t\t\t\n\t\t\t,destino.[dt_nascimento]\t= fonte.[dt_nascimento]\t\t\n\t\t\t,destino.[dt_cadastro]\t\t= fonte.[dt_cadastro]\t\t\t\n\t\t\t,destino.[dt_alteracao]\t\t= fonte.[dt_alteracao]\t\t\t\n\t\t\t,destino.[num_prontuario]\t= fonte.[num_prontuario]\t\t\n\t\t\t,destino.[resp_alteracao]\t= fonte.[resp_alteracao]\t\t\t\n\t--;\n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\t*/\n\n\tDROP TABLE IF EXISTS dim_mendi_saudevianet_cod807\n\tSELECT * INTO dim_mendi_saudevianet_cod807 FROM #temp0\n\n\n\n\n\nGO\n",
        "build_order": 320,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_saudevianet_cod807]": [
                "SELECT",
                "SELECT * INTO dim_mendi_saudevianet_cod807"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod807]": [
                "CREATE",
                "CREATE                     PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod807]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_mendi_saudevianet_cod807]": [
                "CREATE",
                "CREATE                     PROCEDURE [dbo].[sp_att_mendi_saudevianet_cod807]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_planejamento_estrategico_24]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_planejamento_estrategico_24]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_planejamento_estrategico_24",
        "type": "StoredProcedure",
        "start": 436137,
        "end": 437312,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_planejamento_estrategico_24]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE              PROCEDURE [dbo].[sp_att_planejamento_estrategico_24] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n----------------------------------------------------------------------------------------------------------------------------\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_planejamento_estrategico_24' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].dim_planejamento_estrategico_24(\n\t\t[M\u00eas]                             [date]     NOT NULL\n\t   ,[Meta Planejamento estrat\u00e9gico]   [float]    NOT NULL\n\n\t\t) ON [PRIMARY]\n\tEND\n\n\n\tIF OBJECT_ID('tempdb..#temp0') IS NOT NULL\n\tBEGIN\t\n\t\tDELETE FROM dim_planejamento_estrategico_24; \n\t\tINSERT INTO dim_planejamento_estrategico_24 \n\t\tSELECT\n\t\t [M\u00eas]                                        = ISNULL(TRY_CAST([M\u00eas] AS DATE), '01/01/2000')\n\t\t,[Meta Planejamento estrat\u00e9gico]              = ISNULL(TRY_CAST([Meta Planejamento estrat\u00e9gico] AS FLOAT), 0)\n\n\t\tFROM #temp0\n\t\tWHERE TRY_CAST([M\u00eas] AS DATE) IS NOT NULL\n\tEND\n\n\n\n\n\nGO\n",
        "build_order": 321,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_planejamento_estrategico_24]": [
                "INSERT",
                "INSERT INTO dim_planejamento_estrategico_24"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_planejamento_estrategico_24]": [
                "CREATE",
                "CREATE              PROCEDURE [dbo].[sp_att_planejamento_estrategico_24]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_planejamento_estrategico_24]": [
                "CREATE",
                "CREATE              PROCEDURE [dbo].[sp_att_planejamento_estrategico_24]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_resumos",
        "type": "StoredProcedure",
        "start": 437312,
        "end": 629200,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_resumos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE       PROCEDURE [dbo].[sp_att_resumos] @datahora_inicio DATE,  @datahora_fim DATE, @metrica VARCHAR(50) AS\n\nSET LANGUAGE 'Portugu\u00eas (Brasil)';\nSET DATEFORMAT dmy;\n\n/*\t\nDECLARE @max_data datetime2(0) = (SELECT MAX([Data]) FROM dim_calendario) \nDECLARE @t_inicio datetime = GETDATE();\nDECLARE @t_inicio_etapa datetime;\nDECLARE @msg VARCHAR(MAX);\n\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Prepara\u00e7\u00e3o (Chaves, tabelas, variaveis, etc) \n\tPRINT '--- Prep';\n\tSELECT [Etapa]='prep';\n\t--DBCC SQLPERF('logspace');\n\tSET @t_inicio_etapa = GETDATE();\n\tBEGIN TRANSACTION tran_prep;\n\t--EXEC sp_sys_estrutura @limpar=1, @listar=0;\n\n\t--DROP TABLE [r_individuo_30min]\n\t--DROP TABLE [r_individuo_dia]\n\t--DECLARE @datahora_inicio DATE = '01/03/2024'; DECLARE  @datahora_fim DATE = '01/04/2024'; DECLARE @max_data datetime2(0) = (SELECT MAX([Data]) FROM dim_calendario);\n\t\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'r_individuo_30min' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[r_individuo_30min]( \n\t\t\t [DataHora]\t\t\t\t\t\t\t\t\t\t\t\t[datetime2](3)\t\tNOT NULL\n\t\t\t,[Intervalo]\t\t\t\t\t\t\t\t\t\t\t[time](3)\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Data]\t\t\t\t\t\t\t\t\t\t\t\t\t[date]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t\t\t\t[date]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t\t\t\t\t\t[date]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Feriado]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Folga]\t\t\t\t\t\t\t\t\t\t\t\t[bit]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Abono]\t\t\t\t\t\t\t\t\t\t\t\t[bit]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Compensa\u00e7\u00e3o de Horas]\t\t\t\t\t\t\t\t\t[bit]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Falta Justificada]\t\t\t\t\t\t\t\t\t[bit]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Falta Injustificada]\t\t\t\t\t\t\t\t\t[bit]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Suspens\u00e3o]\t\t\t\t\t\t\t\t\t\t\t[bit]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Atestado]\t\t\t\t\t\t\t\t\t\t\t\t[bit]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t\t\t\t\t\t[datetime2](0)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t\t\t\t[varchar](30)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Nome]\t\t\t\t\t\t\t\t\t\t\t\t\t[varchar](100)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Status]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](25)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](25)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](25)\t\tNULL\t\tDEFAULT NULL\n\n\t\t\t,[DMA Inicial]\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t\t\t\t\t\t[varchar](50)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor Inicial]\t\t\t\t\t\t\t\t\t[varchar](100)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t\t\t\t\t\t[varchar](100)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t\t\t\t\t\t[varchar](100)\t\tNULL\t\tDEFAULT NULL\n\n\t\t\t,[Cliente]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Projeto]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Cargo]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tribo]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tribo Completa]\t\t\t\t\t\t\t\t\t\t[varchar](150)\t\tNOT NULL\tDEFAULT '--'\n\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t\t\t\t\t\t[varchar](100)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Turno]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](10)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Escala (Ponto)]\t\t\t\t\t\t\t\t\t\t[varchar](15)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Jornada (Ponto)]\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Trabalhado (Ponto)]\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Escala (MOP)]\t\t\t\t\t\t\t\t\t\t\t[varchar](15)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Jornada (Log)]\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tipo de Jornada]\t\t\t\t\t\t\t\t\t\t[varchar](25)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Login]\t\t\t\t\t\t\t\t\t\t\t\t[time](3)\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Logout]\t\t\t\t\t\t\t\t\t\t\t\t[time](3)\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Log descartado (>2HE)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[HE]\t\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log]\t\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log Produtivo]\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log Improdutivo]\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tempo Livre]\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Particular (Intelix)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Break (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa 10 (Intelix)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Outbound (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Lanche (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Feedback (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Interno (Intelix)]\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Externo (Intelix)]\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (Intelix)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Banheiro (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa NR17 (Intelix)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Tratativa (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Discagem Manual (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Banheiro (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Intervalo (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Discagem Retorno (EPBX)]\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Feedback (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Login (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Interno (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Externo (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa BackOffice (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Banheiro (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Descanso (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Feedback (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Backoffice (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Discagem Manual (Genesys)]\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Discagem Retorno (Genesys)]\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Em Fila (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Sistema Externo (Genesys)]\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Sistema Interno (Genesys)]\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Tratativa (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\tNOT NULL\tDEFAULT 0\n\t\t\n\t\t\t,[Criados]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tratados]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tempo Total de Tratativa]\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[TMT]\t\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Replicas]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Reincidentes 48h]\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Reincidentes 30d]\t\t\t\t\t\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t[decimal](16,2)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t[decimal](16,2)\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t[decimal](16,2)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t[decimal](16,2)\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Promotoras]\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Neutras]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Detratoras]\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[NPS]\t\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t\n\t\t\t,[\u00c9 A Tribo do MOP?]\t\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de MOP?]\t\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de Tickets?]\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de Chamadas?]\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de NPS?]\t\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de Log?]\t\t[tinyint]\tNOT NULL\tDEFAULT 0\n\n\t\t) ON [PRIMARY]\n\tEND\n \n\tDROP TABLE IF EXISTS [#chaves];\n\tSELECT * INTO [#chaves] \n\tFROM (\n\t\t\tSELECT \n\t\t\t\t [DataHora]\t\t\t\t\t\t\t\t\t=\tc.[DataHora]\n\t\t\t\t,[Proxima_DataHora]\t\t\t\t\t\t\t=\tDATEADD(MINUTE, 30, c.[DataHora])\n\t\t\t\t,[Intervalo]\t\t\t\t\t\t\t\t=\tCAST(c.[DataHora] as time(0))\n\t\t\t\t,[Data]\t\t\t\t\t\t\t\t\t\t=\tc.[Data]\n\t\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t=\tc.[Semana_Mes_For\u00e7ada_PrimeiroDia]\n\t\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t\t\t=\tc.[M\u00eas_PrimeroDia]\n\t\t\t\t,[Feriado]\t\t\t\t\t\t\t\t\t=\tc.[Feriado_Nome]\n\t\t\t\t,[Folga]\t\t\t\t\t\t\t\t\t=\tsec_flags.[Folga]\n\t\t\t\t,[Abono]\t\t\t\t\t\t\t\t\t=\tsec_flags.[Abono]\n\t\t\t\t,[Compensa\u00e7\u00e3o de Horas]\t\t\t\t\t\t=\tsec_flags.[Compensa\u00e7\u00e3o de Horas]\n\t\t\t\t,[Falta Justificada]\t\t\t\t\t\t=\tsec_flags.[Falta Justificada]\n\t\t\t\t,[Falta Injustificada]\t\t\t\t\t\t=\tsec_flags.[Falta Injustificada]\n\t\t\t\t,[Suspens\u00e3o]\t\t\t\t\t\t\t\t=\tsec_flags.[Suspens\u00e3o]\n\t\t\t\t,[Atestado]\t\t\t\t\t\t\t\t\t=\tsec_flags.[Atestado]\n\t\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t\t\t=\tmop.[Data da Atualiza\u00e7\u00e3o]\n\t\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t=\tmop.[ID Selecionar]\n\t\t\t\t,[Nome]\t\t\t\t\t\t\t\t\t\t=\tmop.[Nome]\n\t\t\t\t,[Status]\t\t\t\t\t\t\t\t\t=\tmop.[Status]\n\t\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t=\tmop.[Situa\u00e7\u00e3o]\n\t\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t=\tmop.[Condi\u00e7\u00e3o]\n\n\t\t\t\t,[DMA Inicial]\t\t\t\t\t\t\t\t=\tmop.[DMA Inicial]\n\t\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t\t\t=\tmop.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t\t\t=\tmop.[\u00daltima DMA Geral]\n\t\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t\t\t=\tmop.[Tipo da \u00daltima DMA]\n\t\t\t\t,[Instrutor Inicial]\t\t\t\t\t\t=\tmop.[Instrutor Inicial]\n\t\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t\t\t=\tmop.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t\t\t=\tmop.[Instrutor \u00daltima DMA]\n\n\t\t\t\t,[Teve Evento de MOP?]\t\t\t\t\t\t=\t1\n\t\t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t\t\t=\t1\n\t\t\t\t,[Tribo Completa]\t\t\t\t\t\t\t=\t[Tribo Completa]\n\t\t\t\t,[Cliente]\t\t\t\t\t\t\t\t\t=\t[Cliente]\n\t\t\t\t,[Projeto]\t\t\t\t\t\t\t\t\t=\t[Projeto]\n\t\t\t\t,[Cargo]\t\t\t\t\t\t\t\t\t=\tmop.[Cargo]\n\t\t\t\t,[Tribo]\t\t\t\t\t\t\t\t\t=\t[Tribo]\n\t\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t\t\t=\tmop.[Supervis\u00e3o]\n\t\t\t\t,[Turno]\t\t\t\t\t\t\t\t\t=\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN DATEDIFF(s, '00:00:00', mop.[Jornada]) > 22800 THEN 'Integral'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(LEFT(mop.[Escala],5) AS TIME) <  CAST('12:00' AS TIME) THEN 'Manh\u00e3'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(LEFT(mop.[Escala],5) AS TIME) >= CAST('12:00' AS TIME) THEN 'Tarde'\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN sec_horarios.[Jornada] > 22800 THEN 'Integral'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(LEFT(sec_horarios.[Escala (Ponto)],5) AS TIME) <  CAST('12:00' AS TIME) THEN 'Manh\u00e3'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(LEFT(sec_horarios.[Escala (Ponto)],5) AS TIME) >= CAST('12:00' AS TIME) THEN 'Tarde'\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE NULL\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND\n\n\t\t\t\t,[Escala (Ponto)]\t\t\t\t\t\t\t=\tsec_horarios.[Escala (Ponto)]\n\t\t\t\t,[Jornada (Ponto)]\t\t\t\t\t\t\t=\tISNULL(ABS(CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Folga]\t\t\t\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Abono]\t\t\t\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN [Compensa\u00e7\u00e3o de Horas]\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN [Falta Justificada]\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN [Falta Injustificada]\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Suspens\u00e3o]\t\t\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Atestado]\t\t\t\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Feriado_Nome] IS NOT NULL\t\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE sec_horarios.[Jornada]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND), 0)\n\t\t\t\t,[Escala (MOP)]\t\t\t\t\t\t\t\t=\tmop.[Escala]\n\t\t\t\t,[Jornada (Log)]\t\t\t\t\t\t\t=\tISNULL(ABS(CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Folga]\t\t\t\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN [Abono]\t\t\t\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN [Compensa\u00e7\u00e3o de Horas]\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN [Falta Justificada]\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN [Falta Injustificada]\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN [Suspens\u00e3o]\t\t\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN [Atestado]\t\t\t\t= 1\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Feriado_Nome] IS NOT NULL\t\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Status] <> 'Ativo'\t\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN sec_horarios.[Jornada] = 0\t\t\tTHEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- \\/ PROVISORIO, ATE PLANEJAMENTO ARRUMAR ID SECULLUM \\/\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN sec_horarios.[Jornada] IS NULL\tTHEN \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Taxa] = 1 THEN CASE DATENAME(WEEKDAY, c.[Data]) WHEN 'S\u00e1bado' THEN 0  WHEN 'Domingo' THEN 0 ELSE DATEDIFF(s, 0, mop.[Jornada]) END \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Taxa] = 2 THEN CASE DATENAME(WEEKDAY, c.[Data]) WHEN 'Domingo' THEN 0 ELSE DATEDIFF(s, 0, mop.[Jornada]) END\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--END\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- /\\ PROVISORIO, ATE PLANEJAMENTO ARRUMAR ID SECULLUM /\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE DATEDIFF(s, 0, mop.[Jornada])\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND), 0)\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\tFROM dim_calendario_30min c \n\t\t\tLEFT JOIN ( SELECT [Data da Atualiza\u00e7\u00e3o], [Data da Proxima Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Intelix], [ID EPBX],[ID Secullum], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [DMA Inicial], [\u00daltima DMA Migra\u00e7\u00e3o], [\u00daltima DMA Geral], [Tipo da \u00daltima DMA], [Instrutor Inicial], [Instrutor \u00daltima Migra\u00e7\u00e3o], [Instrutor \u00daltima DMA], [Cliente], [Projeto], [Cargo], [Tribo], [Supervis\u00e3o], [Escala], [Jornada], [Taxa], [Tribo Completa] = CONCAT([Cliente], '-', [Projeto], '-', [Tribo])\n\t\t\t\t\t\tFROM f_mop_eventos \n\t\t\t\t\t\tWHERE [Data da Atualiza\u00e7\u00e3o] <= @datahora_fim \n\t\t\t\t\t\tAND ([Data da Proxima Atualiza\u00e7\u00e3o] >= @datahora_inicio OR [Data da Proxima Atualiza\u00e7\u00e3o] IS NULL)\n\t\t\t\t\t\tUNION ALL SELECT CAST('01/01/1900' AS datetime2(0)), CAST('01/01/2070' AS datetime2(0)), null, null, null, null, 'Colaborador n\u00e3o encontrado', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, '--'\n\t\t\t) as mop\n\t\t\tON  c.[Data] >= mop.[Data da Atualiza\u00e7\u00e3o]\n\t\t\tAND c.[Data] <  CASE  WHEN mop.[Data da Proxima Atualiza\u00e7\u00e3o] IS NULL AND [status] = 'Turnover' THEN DATEADD(DAY, 1, mop.[Data da Atualiza\u00e7\u00e3o])\n\t\t\t\t\t\t\t\t\tWHEN mop.[Data da Proxima Atualiza\u00e7\u00e3o] IS NULL THEN DATEADD(DAY, 1, @max_data)\n\t\t\t\t\t\t\t\t\tELSE mop.[Data da Proxima Atualiza\u00e7\u00e3o] END\n\t\t\t\n\t\t\tLEFT JOIN (\n\t\t\t\tSELECT DISTINCT \n\t\t\t\t\t [ID Secullum]\t\t\t= id_funcionario \n\t\t\t\t\t,[Data]\t\t\t\t\t= CAST(inicio AS DATE)\n\t\t\t\t\t,[Folga]\t\t\t\t= IIF([Obs] = 'Folga', 1, NULL)\n\t\t\t\t\t,[Abono]\t\t\t\t= IIF([Obs] = 'Abono', 1, NULL)\n\t\t\t\t\t,[Compensa\u00e7\u00e3o de Horas]\t= IIF([Obs] = 'ComHora', 1, NULL)\n\t\t\t\t\t,[Falta Justificada]\t= IIF([Obs] = 'FALTA J', 1, NULL)\n\t\t\t\t\t,[Falta Injustificada]\t= IIF([Obs] = 'FALTA', 1, NULL)\n\t\t\t\t\t,[Suspens\u00e3o]\t\t\t= IIF([Obs] = 'Sus/Adv', 1, NULL)\n\t\t\t\t\t,[Atestado]\t\t\t\t= IIF([Obs] = 'Atest', 1, NULL)\n\t\t\t\tFROM dim_secullum_batidas \n\t\t\t\tWHERE [Obs] IS NOT NULL\t\t\t\n\t\t\t) as sec_flags\n\t\t\tON\tmop.[ID Secullum] = sec_flags.[ID Secullum]\n\t\t\tAND c.[Data] = sec_flags.[Data]\n\t\t\tLEFT JOIN (\t\n\t\t\t\tSELECT \n\t\t\t\t\t [ID Secullum]\t\t= ID_funcionario\n\t\t\t\t\t,[DiaSemana]\t\t= (DATEPART(dw, [DiaSemana]) + @@DATEFIRST + 6 - 0) % 7 + 1\n\t\t\t\t\t,[Jornada]\t\t\t= ISNULL(DATEDIFF(s, Entrada1, Saida1), 0) + ISNULL(DATEDIFF(s, Entrada2, Saida2),0)\n\t\t\t\t\t,[Escala (Ponto)]\t= CONCAT(LEFT(COALESCE([Entrada1], [Entrada2]),5), ' - ',LEFT(COALESCE([Saida2], [Saida1]),5))\n\t\t\t\tFROM dim_secullum_funcionarios\n\t\t\t\tLEFT JOIN dim_log_secullum_horarios \n\t\t\t\tON id_horario = horarioid\n\t\t\t) as sec_horarios\n\t\t\tON mop.[ID Secullum] = sec_horarios.[ID Secullum]\n\t\t\tAND DATEPART(dw, c.[Data]) = sec_horarios.[DiaSemana]\n\t\tWHERE c.[Data] <= @datahora_fim \n\t\tAND c.[Data] >= @datahora_inicio\n\t) _\t\t\t\n\t--WHERE [Tribo Completa] IS NULL\n\t--SELECT * FROM [#chaves]\n\t\n\tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',@t_inicio_etapa,' a ',GETDATE(), ')')\n\tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n\tCOMMIT TRANSACTION tran_prep;\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @metrica='tickets'\tOR @metrica='todas' BEGIN\n\tPRINT '--- tickets';\n\tSELECT [Etapa]='tickets';\n\t--DBCC SQLPERF('logspace');\n\tSET @t_inicio_etapa = GETDATE();\n\tBEGIN TRANSACTION tran_tickets;\n\t--EXEC sp_sys_estrutura @limpar=1, @listar=0;\n\n\t;WITH destino AS\n\t(\n\t\tSELECT * FROM [r_individuo_30min]\n\t\tWHERE CAST([DataHora] AS DATE) >= @datahora_inicio \n\t\tAND\t  CAST([DataHora] AS DATE) <= @datahora_fim \n\t)\n\tMERGE INTO destino USING \n\t(\n\t\tSELECT \n\t\t\t [DataHora]\t\t\t\t\t\t\t=\tc.[DataHora]\n\t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n\t\t\t,[Cliente]\t\t\t\t\t\t\t=\t'Serasa'\n\t\t\t,[Projeto]\t\t\t\t\t\t\t=\tIIF(t.[Tribo] = '0800 Premium', 'Voz', 'Digital')\n\t\t\t,[Tribo]\t\t\t\t\t\t\t=\tt.[Tribo]\n\t\t\t,[Tribo Completa]\t\t\t\t\t=\tCONCAT('Serasa', '-',IIF(t.[Tribo] = '0800 Premium', 'Voz', 'Digital'), '-', t.[Tribo])\n\t\t\t,[Criados]\t\t\t\t\t\t\t=\tt.[Criados]\n\t\t\t,[Tratados]\t\t\t\t\t\t\t=\tt.[Tratados]\n\t\t\t,[Tempo Total de Tratativa]\t\t\t=\tt.[Tempo Total de Tratativa]\n\t\t\t,[TMT]\t\t\t\t\t\t\t\t=\tt.[TMT]\n\t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t=\tt.[N\u00e3o Resolvidos]\n\t\t\t,[Replicas]\t\t\t\t\t\t\t=\tt.[Replicas]\n\t\t\t,[Reincidentes 48h]\t\t\t\t\t=\tt.[Reincidentes 48h]\n\t\t\t,[Reincidentes 30d]\t\t\t\t\t=\tt.[Reincidentes 30d]\n\t\tFROM [#chaves] c\n\t\tRIGHT JOIN (\n\t\t\tSELECT \n\t\t\t\t [ID Selecionar]\t\t\t= tt.[ID Selecionar]\n\t\t\t\t,[Tribo]\t\t\t\t\t= COALESCE(tt.[Tribo], tc.[Tribo])\n\t\t\t\t,[DataHora]\t\t\t\t\t= COALESCE(tt.[DataHora], tc.[DataHora])\n\t\t\t\t,[Criados]\t\t\t\t\t= ISNULL(tc.[Criados], 0)\n\t\t\t\t,[Tratados]\t\t\t\t\t= ISNULL(tt.[Tratados], 0)\n\t\t\t\t,[Tempo Total de Tratativa]\t= ISNULL(tt.[Tempo Total de Tratativa], 0)\n\t\t\t\t,[TMT]\t\t\t\t\t\t= ISNULL(tt.[TMT], 0)\n\t\t\t\t,[N\u00e3o Resolvidos]\t\t\t= ISNULL(tt.[N\u00e3o Resolvidos], 0)\n\t\t\t\t,[Replicas]\t\t\t\t\t= ISNULL(tt.[Replicas], 0)\n\t\t\t\t,[Reincidentes 48h]\t\t\t= ISNULL(tt.[Reincidentes 48h], 0)\n\t\t\t\t,[Reincidentes 30d]\t\t\t= ISNULL(tt.[Reincidentes 30d], 0)\n\t\t\tFROM (\n\t\t\t\t\tSELECT \n\t\t\t\t\t\t [ID Selecionar]\n\t\t\t\t\t\t,[Tribo]\n\t\t\t\t\t\t,[DataHora]\t\t\t\t\t= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Resolu\u00e7\u00e3o]) / 30.0) * 30, 0)\n\t\t\t\t\t\t,[Tratados]\t\t\t\t\t= COUNT(*)\n\t\t\t\t\t\t,[Tempo Total de Tratativa]\t= SUM(TMT)\n\t\t\t\t\t\t,[TMT]\t\t\t\t\t\t= SUM(TMT)/COUNT(*)\n\t\t\t\t\t\t,[N\u00e3o Resolvidos]\t\t\t= SUM(CASE [Resolvido?] WHEN 0 THEN 1 ELSE 0 END)\n\t\t\t\t\t\t,[Replicas]\t\t\t\t\t= SUM(R\u00e9plicas)\n\t\t\t\t\t\t,[Reincidentes 48h]\t\t\t= SUM(CAST([Reincidente 48h?] AS INT))\n\t\t\t\t\t\t,[Reincidentes 30d]\t\t\t= SUM(CAST([Reincidente 30d?] AS INT))\n\t\t\t\t\tFROM f_tickets\n\t\t\t\t\tWHERE  [Resolu\u00e7\u00e3o] >= @datahora_inicio AND [Resolu\u00e7\u00e3o] <= @datahora_fim\n\t\t\t\t\tGROUP BY [ID Selecionar], [Tribo], DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Resolu\u00e7\u00e3o]) / 30.0) * 30, 0)\n\t\t\t) tt\n\t\t\tFULL OUTER JOIN (\n\t\t\t\tSELECT\n\t\t\t\t\t [Tribo]\n\t\t\t\t\t,[DataHora]\t\t\t= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Cria\u00e7\u00e3o]) / 30.0) * 30, 0)\n\t\t\t\t\t,[Criados]\t\t\t= COUNT(*)\n\t\t\t\tFROM f_tickets\n\t\t\t\tWHERE [Cria\u00e7\u00e3o] >= @datahora_inicio AND [Cria\u00e7\u00e3o] <= @datahora_fim \n\t\t\t\tGROUP BY [Tribo], DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Cria\u00e7\u00e3o]) / 30.0) * 30, 0)\n\t\t\t) tc\n\t\t\tON COALESCE(tt.[ID Selecionar], '-') = '-' AND tt.[Tribo] = tc.[Tribo] AND tt.[DataHora] = tc.[DataHora]\n\t\t) t\n\t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(t.[ID Selecionar], '-')\n\t\tAND c.[DataHora] = t.[DataHora]\n\t\tWHERE c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim \t\n\t) AS fonte\n\tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n\tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n\tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT \n\t\t(\n\t\t\t [Teve Evento de Tickets?]\n\t\t\t,[DataHora]\n\t\t\t,[ID Selecionar]\n\t\t\t,[Cliente]\n\t\t\t,[Projeto]\n\t\t\t,[Tribo]\n\t\t\t,[Tribo Completa]\n\t\t\t,[Criados]\n\t\t\t,[Tratados]\n\t\t\t,[Tempo Total de Tratativa]\n\t\t\t,[TMT]\n\t\t\t,[N\u00e3o Resolvidos]\n\t\t\t,[Replicas]\n\t\t\t,[Reincidentes 48h]\n\t\t\t,[Reincidentes 30d]\n\t\t)\n\t\tVALUES \n\t\t(\n\t\t\t1\n\t\t\t,fonte.[DataHora]\n\t\t\t,fonte.[ID Selecionar]\n\t\t\t,fonte.[Cliente]\n\t\t\t,fonte.[Projeto]\n\t\t\t,fonte.[Tribo]\n\t\t\t,fonte.[Tribo Completa]\n\t\t\t,fonte.[Criados]\n\t\t\t,fonte.[Tratados]\n\t\t\t,fonte.[Tempo Total de Tratativa]\n\t\t\t,fonte.[TMT]\n\t\t\t,fonte.[N\u00e3o Resolvidos]\n\t\t\t,fonte.[Replicas]\n\t\t\t,fonte.[Reincidentes 48h]\n\t\t\t,fonte.[Reincidentes 30d]\n\t\t)\n\n\tWHEN MATCHED THEN \n\t\tUPDATE SET\n\t\t\t destino.[Teve Evento de Tickets?]\t=\t1\n\t\t\t,destino.[Criados]\t\t\t\t\t=\tfonte.[Criados]\n\t\t\t,destino.[Tratados]\t\t\t\t\t=\tfonte.[Tratados]\n\t\t\t,destino.[Tempo Total de Tratativa]\t=\tfonte.[Tempo Total de Tratativa]\n\t\t\t,destino.[TMT]\t\t\t\t\t\t=\tfonte.[TMT]\n\t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t=\tfonte.[N\u00e3o Resolvidos]\n\t\t\t,destino.[Replicas]\t\t\t\t\t=\tfonte.[Replicas]\n\t\t\t,destino.[Reincidentes 48h]\t\t\t=\tfonte.[Reincidentes 48h]\n\t\t\t,destino.[Reincidentes 30d]\t\t\t=\tfonte.[Reincidentes 30d]\n\n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tUPDATE SET\n\t\t\t destino.[Teve Evento de Tickets?]\t=\t0\n\t\t\t,destino.[Criados]\t\t\t\t\t=\t0\n\t\t\t,destino.[Tratados]\t\t\t\t\t=\t0\n\t\t\t,destino.[Tempo Total de Tratativa]\t=\t0\n\t\t\t,destino.[TMT]\t\t\t\t\t\t=\t0\n\t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t=\t0\n\t\t\t,destino.[Replicas]\t\t\t\t\t=\t0\n\t\t\t,destino.[Reincidentes 48h]\t\t\t=\t0\n\t\t\t,destino.[Reincidentes 30d]\t\t\t=\t0\n\t;\n\t\n\n\tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n\tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n\tCOMMIT TRANSACTION tran_tickets;\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @metrica='chamadas'\tOR @metrica='todas' BEGIN\n\tPRINT '--- chamadas';\n\tSELECT [Etapa]='chamadas';\n\t--DBCC SQLPERF('logspace');\n\tSET @t_inicio_etapa = GETDATE();\n\tBEGIN TRANSACTION tran_chamadas;\n\t--EXEC sp_sys_estrutura @limpar=1, @listar=0;\n\n\t;WITH destino AS\n\t(\n\t\tSELECT * FROM [r_individuo_30min]\n\t\tWHERE CAST([DataHora] AS DATE) >= @datahora_inicio \n\t\tAND\t  CAST([DataHora] AS DATE) <= @datahora_fim \n\t)\n\tMERGE INTO destino USING \n\t(\n\n\t\tSELECT\n\t\t\t* \n\t\t\t,[Tribo Completa]\t\t\t\t\t=\tCONCAT([Cliente], '-', [Projeto], '-', [Tribo])\n\n\t\t\t,[Inbound - TMC]\t\t\t\t\t=\tISNULL([Inbound - Tempo Em Chamada (Independente do Intervalo)] / NULLIF([Inbound - Chamadas Finalizadas], 0), 0)\n\t\t\t,[Inbound - TMA]\t\t\t\t\t=\tISNULL([Inbound - Tempo Em Atendimento (Independente do Intervalo)] / NULLIF([Inbound - Chamadas Atendidas Finalizadas], 0), 0)\n\t\t\t,[Inbound - TME]\t\t\t\t\t=\tISNULL([Inbound - Tempo Em Espera (Independente do Intervalo)] / NULLIF([Inbound - Chamadas Finalizadas], 0), 0)\n\t\t\t,[Inbound - TMO]\t\t\t\t\t=\tISNULL(([Inbound - Tempo Em Atendimento (Independente do Intervalo)] + [Inbound - Tempo Em Encerramento (Independente do Intervalo)]) / NULLIF([Inbound - Chamadas Atendidas Finalizadas], 0), 0)\n\t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t=\tISNULL([Inbound - Chamadas Atendidas Em At\u00e9 20s] / CAST(NULLIF([Inbound - Chamadas Iniciadas], 0) AS [decimal](16,2)), 0)\n\t\t\t,[Inbound - Chamadas Abandonadas]\t=\t[Inbound - Chamadas Iniciadas] - [Inbound - Chamadas Atendidas]\n\t\t\t,[Inbound - % Abandono]\t\t\t\t=\tISNULL(([Inbound - Chamadas Iniciadas] - [Inbound - Chamadas Atendidas]) / CAST(NULLIF([Inbound - Chamadas Iniciadas], 0) AS [decimal](16,2)), 0)\n\t\t\t\n\t\t\t,[Outbound - TMC]\t\t\t\t\t=\tISNULL([Outbound - Tempo Em Chamada (Independente do Intervalo)] / NULLIF([Outbound - Chamadas Finalizadas], 0), 0)\n\t\t\t,[Outbound - TMA]\t\t\t\t\t=\tISNULL([Outbound - Tempo Em Atendimento (Independente do Intervalo)] / NULLIF([Outbound - Chamadas Atendidas Finalizadas], 0), 0)\n\t\t\t,[Outbound - TME]\t\t\t\t\t=\tISNULL([Outbound - Tempo Em Espera (Independente do Intervalo)] / NULLIF([Outbound - Chamadas Finalizadas], 0), 0)\n\t\t\t,[Outbound - TMO]\t\t\t\t\t=\tISNULL(([Outbound - Tempo Em Atendimento (Independente do Intervalo)] + [Outbound - Tempo Em Encerramento (Independente do Intervalo)]) / NULLIF([Outbound - Chamadas Atendidas Finalizadas], 0), 0)\n\t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t=\tISNULL([Outbound - Chamadas Atendidas Em At\u00e9 20s] / CAST(NULLIF([Outbound - Chamadas Iniciadas], 0) AS [decimal](16,2)), 0)\n\t\t\t,[Outbound - Chamadas Abandonadas]\t=\t[Outbound - Chamadas Iniciadas] - [Outbound - Chamadas Atendidas]\n\t\t\t,[Outbound - % Abandono]\t\t\t=\tISNULL(([Outbound - Chamadas Iniciadas] - [Outbound - Chamadas Atendidas]) / CAST(NULLIF([Outbound - Chamadas Iniciadas], 0) AS [decimal](16,2)), 0)\n\n\t\tFROM (\n\n\t\t\tSELECT\n\t\t\t\t [DataHora]\t\t\t\t\t\t\t\t\t\t\t\t=\tc.[DataHora]\n\t\t\t\t,[Cliente]\t\t\t\t\t\t\t\t\t\t\t\t=\tc.[Cliente]\n\t\t\t\t,[Projeto]\t\t\t\t\t\t\t\t\t\t\t\t=\tc.[Projeto]\n\t\t\t\t,[Tribo]\t\t\t\t\t\t\t\t\t\t\t\t=\t--COALESCE(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE COALESCE(ct.[Grupo],ce.[Grupo],ca.[Grupo],co.[Grupo],ctrans.[Grupo])\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'S_PREMIUM'\t\t\t\t\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'Atendimento_SELECIONAR_Premium'\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'S_CADASTRO_POSITIVO'\t\t\t\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'S_SAC'\t\t\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'Atendimento_SELECIONAR_SAC'\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN 'S_ICOM' THEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t END\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--,c.[Tribo])\n\t\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t\t\t\t=\tc.[ID Selecionar]\n\t\t\t\n\t\t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\t\t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\t\t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] = 'Atendida' AND ct.[Dura\u00e7\u00e3o Espera] <= 20000, CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\t\t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] IS NOT NULL, 1, 0))\n\t\t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\t\t\n\t\t\t\t,[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\t\t\n\t\t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', [Transferida?], 0)), 0) \n\t\t\t\t\n\t\t\t\t--,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', ct.[Dura\u00e7\u00e3o Total], 0)), 0)/1000.0\t \n\t\t\t\t--,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', ct.[Dura\u00e7\u00e3o Atendimento], 0)), 0)/1000.0\t\n\t\t\t\t--,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', ct.[Dura\u00e7\u00e3o Espera], 0)), 0)/1000.0\n\t\t\t\t--,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', ct.[Dura\u00e7\u00e3o Encerramento], 0)), 0)/1000.0\t\n\t\t\t\t\n\t\t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] ELSE 0 END, 0)), 0)/1000.0\t \n\t\t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] ELSE 0 END, 0)), 0)/1000.0\t\n\t\t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] ELSE 0 END, 0)), 0)/1000.0\n\t\t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] ELSE 0 END, 0)), 0)/1000.0\t\n\t\t\t\t\n\t\t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END, 0))/1000.0\n\t\t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Atendimento])\tWHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN DATEDIFF(ms, [In\u00edcio_Atendimento], [Proxima_DataHora]) WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Atendimento] < [Fim_Atendimento], DATEDIFF(ms, [In\u00edcio_Atendimento], [Fim_Atendimento]), 0) ELSE 1800000 END, 0))/1000.0\n\t\t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM(IIF(ce.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio_Espera] IS NULL OR [Fim_Espera] IS NULL\tTHEN 0 WHEN [Fim_Espera] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Espera] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Espera] <= [DataHora] AND [Fim_Espera] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Espera])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Espera], [Proxima_DataHora])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Espera] < [Fim_Espera], DATEDIFF(ms, [In\u00edcio_Espera], [Fim_Espera]), 0) ELSE 1800000 END, 0))/1000.0\n\t\t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM(IIF(co.[Dire\u00e7\u00e3o] = 'Inbound', CASE WHEN [In\u00edcio_Encerramento] IS NULL OR [Fim_Encerramento] IS NULL\tTHEN 0 WHEN [Fim_Encerramento] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Encerramento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Encerramento] <= [DataHora] AND [Fim_Encerramento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Encerramento])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Encerramento], [Proxima_DataHora])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Encerramento] < [Fim_Encerramento], DATEDIFF(ms, [In\u00edcio_Encerramento], [Fim_Encerramento]), 0) ELSE 1800000 END, 0))/1000.0\n\t\t\t\t\n\t\t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\t\t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', 1, 0))\n\t\t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Inbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\t\t\n\t\t\t\t\n\n\t\t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\t\t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\t\t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] = 'Atendida' AND ct.[Dura\u00e7\u00e3o Espera] <= 20, CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\t\t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] IS NOT NULL, 1, 0))\n\t\t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\t\t\n\t\t\t\t,[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound' AND ct.[Status] = 'Atendida', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\t\t\n\t\t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', [Transferida?], 0)), 0) \n\t\t\t\t\n\t\t\t\t--,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', ct.[Dura\u00e7\u00e3o Total], 0)), 0)/1000.0\n\t\t\t\t--,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', ct.[Dura\u00e7\u00e3o Atendimento], 0)), 0)/1000.0\n\t\t\t\t--,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', ct.[Dura\u00e7\u00e3o Espera], 0)), 0)/1000.0\n\t\t\t\t--,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', ct.[Dura\u00e7\u00e3o Encerramento], 0)), 0)/1000.0\t\n\t\t\t\t\n\t\t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Total] ELSE 0 END, 0)), 0)/1000.0\t \n\t\t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Atendimento] ELSE 0 END, 0)), 0)/1000.0\t\n\t\t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Espera] ELSE 0 END, 0)), 0)/1000.0\n\t\t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tISNULL(SUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] WHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN 0 WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN ct.[Dura\u00e7\u00e3o Encerramento] ELSE 0 END, 0)), 0)/1000.0\t\n\t\t\t\t\n\t\t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM(IIF(ct.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0 WHEN [Fim] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END, 0))/1000.0\t\t\n\t\t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Atendimento])\tWHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN DATEDIFF(ms, [In\u00edcio_Atendimento], [Proxima_DataHora]) WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Atendimento] < [Fim_Atendimento], DATEDIFF(ms, [In\u00edcio_Atendimento], [Fim_Atendimento]), 0) ELSE 1800000 END, 0))/1000.0\n\t\t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM(IIF(ce.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio_Espera] IS NULL OR [Fim_Espera] IS NULL\tTHEN 0 WHEN [Fim_Espera] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Espera] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Espera] <= [DataHora] AND [Fim_Espera] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Espera])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Espera], [Proxima_DataHora])\tWHEN [In\u00edcio_Espera] >  [DataHora] AND [Fim_Espera] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Espera] < [Fim_Espera], DATEDIFF(ms, [In\u00edcio_Espera], [Fim_Espera]), 0) ELSE 1800000 END, 0))/1000.0\n\t\t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM(IIF(co.[Dire\u00e7\u00e3o] = 'Outbound', CASE WHEN [In\u00edcio_Encerramento] IS NULL OR [Fim_Encerramento] IS NULL\tTHEN 0 WHEN [Fim_Encerramento] <= [DataHora]\tTHEN 0 WHEN [In\u00edcio_Encerramento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Encerramento] <= [DataHora] AND [Fim_Encerramento] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_Encerramento])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_Encerramento], [Proxima_DataHora])\tWHEN [In\u00edcio_Encerramento] >  [DataHora] AND [Fim_Encerramento] <= [Proxima_DataHora] THEN IIF([In\u00edcio_Encerramento] < [Fim_Encerramento], DATEDIFF(ms, [In\u00edcio_Encerramento], [Fim_Encerramento]), 0) ELSE 1800000 END, 0))/1000.0\t\n\t\t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\n\t\t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', 1, 0))\n\t\t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM(IIF(ca.[Dire\u00e7\u00e3o] = 'Outbound' AND ca.[Status] = 'Atendida', CASE WHEN [In\u00edcio_Atendimento] IS NULL OR [Fim_Atendimento] IS NULL THEN 0 WHEN [Fim_Atendimento] <= [DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] <= [DataHora] AND [Fim_Atendimento] <  [Proxima_DataHora] THEN 1 WHEN [In\u00edcio_Atendimento] > [DataHora] AND [Fim_Atendimento] > [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_Atendimento] >  [DataHora] AND [Fim_Atendimento] <= [Proxima_DataHora] THEN 1 ELSE 0 END, 0))\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\n\n\t\t\tFROM (\n\t\t\t\tSELECT \n\t\t\t\t\t [ID Selecionar]\n\t\t\t\t\t,[Grupo]\n\t\t\t\t\t,[Dire\u00e7\u00e3o]\n\t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n\t\t\t\t\t,[In\u00edcio]\t\t\t\t=\t[DataHora]\n\t\t\t\t\t,[Fim]\t\t\t\t\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Total] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\t\t,[Dura\u00e7\u00e3o Total]\t\t=\tCAST([Dura\u00e7\u00e3o Total] AS [decimal](16,6)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos. \n\t\t\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t=\tCAST([Dura\u00e7\u00e3o Espera] AS [decimal](16,6)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t=\tIIF([Status] = 'Atendida', CAST([Dura\u00e7\u00e3o Atendimento] AS [decimal](16,6)) * 1000, 0) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t=\tCAST([Dura\u00e7\u00e3o Encerramento] AS [decimal](16,6)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\tFROM f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim --AND [Dura\u00e7\u00e3o Total] > 0 --Economiza recursos mas acaba ignorando as abandonadas/n\u00e3o atendidas\n\n\t\t\t) ct\n\t\t\n\t\t\tFULL OUTER JOIN (\n\t\t\t\tSELECT \n\t\t\t\t\t [ID Selecionar]\n\t\t\t\t\t,[Grupo]\n\t\t\t\t\t,[Dire\u00e7\u00e3o]\n\t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n\t\t\t\t\t,[In\u00edcio_Espera]\t\t=\t[DataHora]\n\t\t\t\t\t,[Fim_Espera]\t\t\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Espera] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\t\t,[Dura\u00e7\u00e3o Espera]\t\t=\tCAST([Dura\u00e7\u00e3o Espera] AS [decimal](16,6)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\tFROM f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Dura\u00e7\u00e3o Espera] > 0\n\t\t\t) ce\n\t\t\tON 1=0\n\t\t\n\t\t\tFULL OUTER JOIN (\n\t\t\t\tSELECT \n\t\t\t\t\t [ID Selecionar]\n\t\t\t\t\t,[Grupo]\n\t\t\t\t\t,[Dire\u00e7\u00e3o]\n\t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n\t\t\t\t\t,[In\u00edcio_Atendimento]\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Espera] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\t\t,[Fim_Atendimento]\t\t=\tDATEADD(ms, ([Dura\u00e7\u00e3o Espera]+[Dura\u00e7\u00e3o Atendimento]) * 1000, [DataHora])  -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\t\t,[Dura\u00e7\u00e3o Atendimento]\t=\tCAST([Dura\u00e7\u00e3o Atendimento] AS [decimal](16,6)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\tFROM f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Dura\u00e7\u00e3o Atendimento] > 0\n\t\t\t) ca\n\t\t\tON 1=0\n\n\t\t\tFULL OUTER JOIN (\n\t\t\t\tSELECT \n\t\t\t\t\t [ID Selecionar]\n\t\t\t\t\t,[Grupo]\n\t\t\t\t\t,[Dire\u00e7\u00e3o]\n\t\t\t\t\t,[Status]\t\t\t\t=\t[Status]\n\t\t\t\t\t,[In\u00edcio_Encerramento]\t=\tDATEADD(ms, ([Dura\u00e7\u00e3o Espera]+[Dura\u00e7\u00e3o Atendimento]) *1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\t\t,[Fim_Encerramento]\t\t=\tDATEADD(ms, [Dura\u00e7\u00e3o Total] * 1000, [DataHora]) -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\t\t,[Dura\u00e7\u00e3o Encerramento]\t=\tCAST([Dura\u00e7\u00e3o Encerramento] AS [decimal](16,6)) * 1000 -- \" * 1000\" temporario. remover depois de converter a f_chamadas pra milisegundos.\n\t\t\t\tFROM f_chamadas WHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Dura\u00e7\u00e3o Encerramento] > 0\n\t\t\t) co\n\t\t\tON 1=0\n\n\t\t\tFULL OUTER JOIN (\n\t\t\t\tSELECT \n\t\t\t\t\t [ID Selecionar]\t\t=\tCOALESCE(mop.[ID Selecionar], ch.[ID Genesys])\n\t\t\t\t\t,[Grupo]\n\t\t\t\t\t,[Dire\u00e7\u00e3o]\n\t\t\t\t\t,[In\u00edcio_Transferencia]\t=\tch.[DataHora]\n\t\t\t\t\t,[Fim_Transferencia]\t=\tch.[DataHora]\n\t\t\t\t\t,[Transferida?]\t\t\t=\t1\n\t\t\t\tFROM f_chamadas ch\n\t\t\t\tLEFT JOIN f_mop_historico mop\n\t\t\t\tON CAST(ch.[DataHora] AS DATE)= mop.[Data da Atualiza\u00e7\u00e3o]\n\t\t\t\tAND ch.[ID Genesys] = mop.[ID Genesys]\n\t\t\t\tWHERE [DataHora] >= @datahora_inicio AND [DataHora] <= @datahora_fim AND [Transferida Por] IS NOT NULL\n\t\t\t) ctrans\n\t\t\tON 1=0\n\t\t\n\t\t\tLEFT JOIN [#chaves] c\n\t\t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(ct.[ID Selecionar],  COALESCE(ce.[ID Selecionar], COALESCE(ca.[ID Selecionar],  COALESCE(co.[ID Selecionar], '-'))))\n\t\t\tAND (\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio]) / 30.0) * 30, 0)\t\t\t\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim]) / 30.0) * 30, 0)) \n\t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Espera]) / 30.0) * 30, 0)\t\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Espera]) / 30.0) * 30, 0))\n\t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Atendimento]) / 30.0) * 30, 0)\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Atendimento]) / 30.0) * 30, 0))\n\t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Encerramento]) / 30.0) * 30, 0)\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Encerramento]) / 30.0) * 30, 0))\n\t\t\t\t OR\t(c.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio_Transferencia]) / 30.0) * 30, 0)\tAND c.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim_Transferencia]) / 30.0) * 30, 0))\n\t\t\t\t )\n\t\t\tWHERE  c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim\n\t\t\tGROUP BY c.[DataHora], c.[Cliente], c.[Projeto], c.[ID Selecionar],--COALESCE(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE COALESCE(ct.[Grupo],ce.[Grupo],ca.[Grupo],co.[Grupo],ctrans.[Grupo])\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'S_PREMIUM'\t\t\t\t\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'Atendimento_SELECIONAR_Premium'\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'S_CADASTRO_POSITIVO'\t\t\t\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'S_SAC'\t\t\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'Atendimento_SELECIONAR_SAC'\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--WHEN 'S_ICOM' THEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t END\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--,c.[Tribo])\n\n\t\t) _\n\n\t) AS fonte\n\tON  fonte.[DataHora] = destino.[DataHora]\n\tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n\tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t [Teve Evento de Chamadas?]\n\t\t,[DataHora]\n\t\t,[Cliente]\n\t\t,[Projeto]\n\t\t,[Tribo]\n\t\t,[Tribo Completa]\n\t\t,[ID Selecionar]\n\t\t\n\t\t,[Inbound - Chamadas Iniciadas]\n\t\t,[Inbound - Chamadas Atendidas]\n\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,[Inbound - Chamadas Em Andamento]\n\t\t,[Inbound - Chamadas Finalizadas]\n\t\t,[Inbound - Chamadas Atendidas Finalizadas]\n\t\t,[Inbound - Chamadas Transferidas]\n\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,[Inbound - Atendimentos Iniciados]\n\t\t,[Inbound - Atendimentos Em Andamento]\n\t\t,[Inbound - Atendimentos Finalizados]\n\t\t,[Inbound - TMC]\n\t\t,[Inbound - TMA]\n\t\t,[Inbound - TME]\n\t\t,[Inbound - TMO]\n\t\t,[Inbound - % Nivel de Servi\u00e7o]\n\t\t,[Inbound - Chamadas Abandonadas]\n\t\t,[Inbound - % Abandono]\n\n\t\t,[Outbound - Chamadas Iniciadas]\n\t\t,[Outbound - Chamadas Atendidas]\n\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,[Outbound - Chamadas Em Andamento]\n\t\t,[Outbound - Chamadas Finalizadas]\n\t\t,[Outbound - Chamadas Atendidas Finalizadas]\n\t\t,[Outbound - Chamadas Transferidas]\n\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,[Outbound - Atendimentos Iniciados]\n\t\t,[Outbound - Atendimentos Em Andamento]\n\t\t,[Outbound - Atendimentos Finalizados]\n\t\t,[Outbound - TMC]\n\t\t,[Outbound - TMA]\n\t\t,[Outbound - TME]\n\t\t,[Outbound - TMO]\n\t\t,[Outbound - % Nivel de Servi\u00e7o]\n\t\t,[Outbound - Chamadas Abandonadas]\n\t\t,[Outbound - % Abandono]\n\n\t\t)\n\t\tVALUES (\n\t\t 1\n\t\t,fonte.[DataHora]\n\t\t,fonte.[Cliente]\n\t\t,fonte.[Projeto]\n\t\t,fonte.[Tribo]\n\t\t,fonte.[Tribo Completa]\n\t\t,fonte.[ID Selecionar]\n\t\t\n\t\t,fonte.[Inbound - Chamadas Iniciadas]\n\t\t,fonte.[Inbound - Chamadas Atendidas]\n\t\t,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,fonte.[Inbound - Chamadas Em Andamento]\n\t\t,fonte.[Inbound - Chamadas Finalizadas]\n\t\t,fonte.[Inbound - Chamadas Atendidas Finalizadas]\n\t\t,fonte.[Inbound - Chamadas Transferidas]\n\t\t,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,fonte.[Inbound - Atendimentos Iniciados]\n\t\t,fonte.[Inbound - Atendimentos Em Andamento]\n\t\t,fonte.[Inbound - Atendimentos Finalizados]\n\t\t,fonte.[Inbound - TMC]\n\t\t,fonte.[Inbound - TMA]\n\t\t,fonte.[Inbound - TME]\n\t\t,fonte.[Inbound - TMO]\n\t\t,fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t,fonte.[Inbound - Chamadas Abandonadas]\n\t\t,fonte.[Inbound - % Abandono]\n\n\t\t,fonte.[Outbound - Chamadas Iniciadas]\n\t\t,fonte.[Outbound - Chamadas Atendidas]\n\t\t,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,fonte.[Outbound - Chamadas Em Andamento]\n\t\t,fonte.[Outbound - Chamadas Finalizadas]\n\t\t,fonte.[Outbound - Chamadas Atendidas Finalizadas]\n\t\t,fonte.[Outbound - Chamadas Transferidas]\n\t\t,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,fonte.[Outbound - Atendimentos Iniciados]\n\t\t,fonte.[Outbound - Atendimentos Em Andamento]\n\t\t,fonte.[Outbound - Atendimentos Finalizados]\n\t\t,fonte.[Outbound - TMC]\n\t\t,fonte.[Outbound - TMA]\n\t\t,fonte.[Outbound - TME]\n\t\t,fonte.[Outbound - TMO]\n\t\t,fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t,fonte.[Outbound - Chamadas Abandonadas]\n\t\t,fonte.[Outbound - % Abandono]\n\n\t\t)\n\tWHEN MATCHED THEN \n\t\tUPDATE SET\n\t\t\t destino.[Teve Evento de Chamadas?]\t\t\t\t\t\t\t\t= 1\n\t\t\t,destino.[DataHora]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[DataHora]\n\t\t\t,destino.[Cliente]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Cliente]\n\t\t\t,destino.[Projeto]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Projeto]\n\t\t\t,destino.[Tribo]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Tribo]\n\t\t\t,destino.[Tribo Completa]\t\t\t\t\t\t\t\t\t\t= fonte.[Tribo Completa]\n\t\t\t,destino.[ID Selecionar]\t\t\t\t\t\t\t\t\t\t= fonte.[ID Selecionar]\n\n\t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Iniciadas]\n\t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas]\n\t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Em Andamento]\n\t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Finalizadas]\n\t\t\t,destino.[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Finalizadas]\n\t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Transferidas]\n\t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Iniciados]\n\t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Em Andamento]\n\t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Finalizados]\n\t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMC]\n\t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMA]\n\t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TME]\n\t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMO]\n\t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Abandonadas]\n\t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Abandono]\n\t\t\t\n\t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Iniciadas]\n\t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas]\n\t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Em Andamento]\n\t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Finalizadas]\n\t\t\t,destino.[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Finalizadas]\n\t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Transferidas]\n\t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Iniciados]\n\t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Em Andamento]\n\t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Finalizados]\n\t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMC]\n\t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMA]\n\t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TME]\n\t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMO]\n\t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Abandonadas]\n\t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - % Abandono]\n\n\n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tUPDATE SET\n\t\t\t destino.[Teve Evento de Chamadas?]\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n\t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n\t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n\t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n\t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n\t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t\n\t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n\t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n\t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n\t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n\t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= 0\n\t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n\t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n\t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= 0\n\t;\n\t\n\t\n\tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n\tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n\tCOMMIT TRANSACTION tran_chamadas;\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @metrica='nps'\t\tOR @metrica='todas' BEGIN\n\tPRINT '--- nps';\n\tSELECT [Etapa]='nps';\n\t--DBCC SQLPERF('logspace');\n\tSET @t_inicio_etapa = GETDATE();\n\tBEGIN TRANSACTION tran_nps;\n\t--EXEC sp_sys_estrutura @limpar=1, @listar=0;\n\n\t;WITH destino AS\n\t(\n\t\tSELECT * FROM [r_individuo_30min]\n\t\tWHERE CAST([DataHora] AS DATE) >= @datahora_inicio \n\t\tAND\t  CAST([DataHora] AS DATE) <= @datahora_fim \n\t)\n\tMERGE INTO destino USING \n\t(\n\n\t\tSELECT *\n\t\t\t,[Tribo Completa] = CONCAT([Cliente], '-', [Projeto], '-', [Tribo]) \n\t\t\t,[NPS] = CAST((CAST(([Promotoras]-[Detratoras]) AS decimal(16,4))/CAST(NULLIF([Avalia\u00e7\u00f5es de NPS], 0) AS decimal(16,4)))*100 AS INT)\n\t\tFROM (\n\t\t\tSELECT\n\t\t\t\t [DataHora]\t\t\t\t= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [DataHora da Opini\u00e3o]) / 30.0) * 30, 0)  \n\t\t\t\t,[ID Selecionar]\t\t= c.[ID Selecionar]\n    \t\t\t,[Cliente]\t\t\t\t=\tPARSENAME(REPLACE([Tribo Completa Padronizada],'__','.'),3)\n    \t\t\t,[Projeto]\t\t\t\t=\tPARSENAME(REPLACE([Tribo Completa Padronizada],'__','.'),2)\n    \t\t\t,[Tribo]\t\t\t\t=\tPARSENAME(REPLACE([Tribo Completa Padronizada],'__','.'),1)\n\t\t\t\t,[Avalia\u00e7\u00f5es de NPS]\t= COUNT(*)\n\t\t\t\t,[Promotoras]\t\t\t= ISNULL(SUM(IIF([Classifica\u00e7\u00e3o] = 'Promotores', 1,0)),0)\n\t\t\t\t,[Neutras]\t\t\t\t= ISNULL(SUM(IIF([Classifica\u00e7\u00e3o] = 'Neutros', 1,0)),0)\n\t\t\t\t,[Detratoras]\t\t\t= ISNULL(SUM(IIF([Classifica\u00e7\u00e3o] = 'Detratores', 1,0)),0)\t\n\t\t\tFROM f_nps_v2 n\n\t\t\tLEFT JOIN [#chaves] c \n\t\t\tON c.[ID Selecionar] = n.[ID Selecionar]\n\t\t\tAND c.[DataHora] = DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [DataHora da Opini\u00e3o]) / 30.0) * 30, 0)\n\t\t\tWHERE n.[DataHora da Opini\u00e3o] >= @datahora_inicio AND n.[DataHora da Opini\u00e3o] <= @datahora_fim \t\n\t\t\tGROUP BY DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [DataHora da Opini\u00e3o]) / 30.0) * 30, 0), [Tribo Completa Padronizada], c.[ID Selecionar]\n\t\t) _\n\n\t) AS fonte\n\tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n\tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n\tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t\t [Teve Evento de NPS?]\n\t\t\t\t,[DataHora]  \n\t\t\t\t,[ID Selecionar]\n\t\t\t\t,[Cliente]\n\t\t\t\t,[Projeto]\n\t\t\t\t,[Tribo]\n\t\t\t\t,[Tribo Completa]\n\t\t\t\t,[Avalia\u00e7\u00f5es de NPS]\n\t\t\t\t,[Promotoras]\n\t\t\t\t,[Neutras]\n\t\t\t\t,[Detratoras]\n\t\t\t\t,[NPS]\n\t\t)\n\t\tVALUES (\n\t\t\t\t 1\n\t\t\t\t,fonte.[DataHora] \n\t\t\t\t,fonte.[ID Selecionar]\n\t\t\t\t,fonte.[Cliente]\n\t\t\t\t,fonte.[Projeto]\n\t\t\t\t,fonte.[Tribo]\n\t\t\t\t,fonte.[Tribo Completa]\n\t\t\t\t,fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t\t\t,fonte.[Promotoras]\n\t\t\t\t,fonte.[Neutras]\n\t\t\t\t,fonte.[Detratoras]\n\t\t\t\t,fonte.[NPS]\n\t\t)\n\n\tWHEN MATCHED THEN \n\t\tUPDATE SET\n\t\t\t\t destino.[Teve Evento de NPS?]\t= 1\n\t\t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t= fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t\t\t,destino.[Promotoras]\t\t\t= fonte.[Promotoras]\n\t\t\t\t,destino.[Neutras]\t\t\t\t= fonte.[Neutras]\n\t\t\t\t,destino.[Detratoras]\t\t\t= fonte.[Detratoras]\n\t\t\t\t,destino.[NPS]\t\t\t\t\t= fonte.[NPS]\n\n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tUPDATE SET\n\t\t\t\t destino.[Teve Evento de NPS?]\t= 0\n\t\t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t= 0\n\t\t\t\t,destino.[Promotoras]\t\t\t= 0\n\t\t\t\t,destino.[Neutras]\t\t\t\t= 0\n\t\t\t\t,destino.[Detratoras]\t\t\t= 0\n\t\t\t\t,destino.[NPS]\t\t\t\t\t= NULL\n\t;\n\n\t\n\tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n\tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n\tCOMMIT TRANSACTION tran_log;\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @metrica='log'\t\tOR @metrica='todas' BEGIN\n\tPRINT '--- log';\n\tSELECT [Etapa]='log';\n\t--DBCC SQLPERF('logspace');\n\tSET @t_inicio_etapa = GETDATE();\n\tBEGIN TRANSACTION tran_log;\n\t--EXEC sp_sys_estrutura @limpar=1, @listar=0;\n\t\n\t;WITH destino AS\n\t(\n\t\tSELECT * FROM [r_individuo_30min]\n\t\tWHERE CAST([DataHora] AS DATE) >= @datahora_inicio \n\t\tAND\t  CAST([DataHora] AS DATE) <= @datahora_fim \n\t)\n\t\tMERGE INTO destino USING \n\t\t(\n\t\t\tSELECT\n\t\t\t\t [DataHora]\t\t\t\t\t\t\t=\t[DataHora]\n\t\t\t\t,[ID Selecionar]\t\t\t\t\t=\t[ID Selecionar]\n\t\t\t\t,[Cliente]\t\t\t\t\t\t\t=\t[Cliente]\n\t\t\t\t,[Projeto]\t\t\t\t\t\t\t=\t[Projeto]\n\t\t\t\t,[Tribo]\t\t\t\t\t\t\t=\t[Tribo]\n\t\t\t\t,[Tribo Completa]\t\t\t\t\t=\tISNULL([Tribo Completa], '--')\n\t\t\t\t,[Trabalhado (Ponto)]\t\t\t\t=   ISNULL([Trabalhado (Ponto)], 0)/1000.0\n\t\t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=   ISNULL([Em Pausa (Ponto)], 0)/1000.0\n\t\t\t\t,[Login]\t\t\t\t\t\t\t=\tIIF([Tribo] IN ('Large N1', 'PME', 'SDR')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto]) AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Login] < [DataHora] , [DataHora], [Login]) AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\n\t\t\t\t,[Logout]\t\t\t\t\t\t\t=\tIIF([Tribo] IN ('Large N1', 'PME', 'SDR')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Logout_ponto] > [Proxima_DataHora] , [Proxima_DataHora], [Logout_ponto]) AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CAST(IIF([Logout] > [Proxima_DataHora] , [Proxima_DataHora], [Logout]) AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(DATEADD(ms, [Trabalhado (Ponto)], IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto]))  AS date) > CAST([DataHora] AS date) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN CAST([Proxima_DataHora] AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(DATEADD(ms, [Trabalhado (Ponto)], IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto]))  AS time(3)) > CAST([Proxima_DataHora] AS time(3)) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN DATEADD(ms,DATEDIFF(ms, \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCAST(DATEADD(ms, [Trabalhado (Ponto)], IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto])) AS time(3)), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCAST([Proxima_DataHora] AS time(3))),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t CAST(DATEADD(ms, [Trabalhado (Ponto)], IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto])) AS time(3)))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE CAST(DATEADD(ms, [Trabalhado (Ponto)], IIF([Login_ponto] < [DataHora] , [DataHora], [Login_ponto])) AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t END\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(DATEADD(ms, [Log], IIF([Login] < [DataHora] , [DataHora], [Login]))  AS date) > CAST([DataHora] AS date) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN CAST([Proxima_DataHora] AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(DATEADD(ms, [Log], IIF([Login] < [DataHora] , [DataHora], [Login]))  AS time(3)) > CAST([Proxima_DataHora] AS time(3)) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN DATEADD(ms,DATEDIFF(ms, \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCAST(DATEADD(ms, [Log], IIF([Login] < [DataHora] , [DataHora], [Login])) AS time(3)), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCAST([Proxima_DataHora] AS time(3))),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t CAST(DATEADD(ms, [Log], IIF([Login] < [DataHora] , [DataHora], [Login])) AS time(3)))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE CAST(DATEADD(ms, [Log], IIF([Login] < [DataHora] , [DataHora], [Login])) AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t END\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t )\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t */\n\n\t\t\t\t,[Log descartado (>2HE)]\t\t\t=\tIIF([Tribo] IN ('Large N1', 'PME', 'SDR')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado_ponto] > [Limite_HE_ponto]\tTHEN CASE WHEN [Log_Acumulado_ponto] - [Limite_HE_ponto] < 1800000\tTHEN\t [Log_Acumulado_ponto] - [Limite_HE_ponto]\tELSE [Trabalhado (Ponto)]\tEND\tELSE 0\tEND/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado] > [Limite_HE]\tTHEN CASE WHEN [Log_Acumulado] - [Limite_HE] < 1800000\tTHEN\t [Log_Acumulado] - [Limite_HE]\tELSE [Log]\tEND\tELSE 0\tEND/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t,[HE]\t\t\t\t\t\t\t\t=\tIIF([Tribo] IN ('Large N1', 'PME', 'SDR')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado_ponto] > [Limite_HE_ponto]  THEN CASE WHEN [Log_Acumulado_ponto] - [Limite_HE_ponto] < 1800000 THEN\t [Trabalhado_cortado_ponto]\t\t\t\t\tELSE 0\t\tEND ELSE  \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   CASE WHEN [Log_Acumulado_ponto] > [Inicio_HE_ponto]\tTHEN CASE WHEN [Log_Acumulado_ponto] - [Inicio_HE_ponto] < 1800000 THEN\t([Log_Acumulado_ponto] - [Inicio_HE_ponto]) ELSE [Trabalhado (Ponto)]\tEND\tELSE 0\tEND\tEND/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL(CASE WHEN [Log_Acumulado] > [Limite_HE]  THEN CASE WHEN [Log_Acumulado] - [Limite_HE] < 1800000 THEN\t [Log_cortado]\t\t\t\t\tELSE 0\t\tEND ELSE  \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t   CASE WHEN [Log_Acumulado] > [Inicio_HE]\tTHEN CASE WHEN [Log_Acumulado] - [Inicio_HE] < 1800000 THEN\t([Log_Acumulado] - [Inicio_HE]) ELSE [log]\tEND\tELSE 0\tEND\tEND/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tIIF([Tribo] IN ('Large N1', 'PME', 'SDR')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Trabalhado_cortado_ponto]/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Log_cortado]/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t,[Log Produtivo]\t\t\t\t\t=\tIIF([Tribo] IN ('Large N1', 'PME', 'SDR')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,ISNULL([Trabalhado_cortado_ponto]/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,\n\t\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Tempo Livre], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Sistema Externo], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Outbound], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tempo Livre], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Sistema (Externo)], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Discagem Manual], 0)\t\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Em Ligacao], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Transfer\u00eancia], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tratativa], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_WhatsApp], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Backoffice], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Discagem Manual], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Discagem Retorno], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Em Fila], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Sistema Externo], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Tratativa], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Whatsapp], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n\t\t\t\t,[Log Improdutivo]\t\t\t\t\t=\tIIF([Tribo] IN ('Large N1', 'PME', 'SDR')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t,\n\t\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Pausa Particular], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Break], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa 10], 0)\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Lanche], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa R\u00e1pida], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Almo\u00e7o], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Feedback], 0)\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Treinamento], 0)\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Banheiro], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Sistema Interno], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Reuni\u00e3o], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Ambulat\u00f3rio], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa NR17], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Almo\u00e7o], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Ambulat\u00f3rio], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Banheiro], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Feedback], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Intervalo], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_P\u00f3s Atendimento], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Reuni\u00e3o], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Sistema (interno)], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Treinamento], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_BackOffice], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Login], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_N\u00e3o Disponivel], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Almo\u00e7o], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Ambulat\u00f3rio], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Banheiro], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Descanso], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Feedback], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Dispon\u00edvel], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Sistema Interno], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Treinamento], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\t\t\t\n\n\t\t\t\t,[Tempo Livre]\t\t\t\t\t\t=\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Tempo Livre]/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tempo Livre]/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n\t\t\t\t,[Pausa Particular (Intelix)]\t\t=\tISNULL([Intelix_Pausa Particular]/1000.0, 0)\n\t\t\t\t,[Pausa Break (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Break]/1000.0, 0)\n\t\t\t\t,[Pausa 10 (Intelix)] \t\t\t\t=\tISNULL([Intelix_Pausa 10]/1000.0, 0)\t\t\n\t\t\t\t,[Pausa Outbound (Intelix)] \t\t=\tISNULL([Intelix_Pausa Outbound]/1000.0, 0)\t\t\t\n\t\t\t\t,[Pausa Lanche (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Lanche]/1000.0, 0)\t\t\t\t\n\t\t\t\t,[Pausa R\u00e1pida (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa R\u00e1pida]/1000.0, 0)\t\t\t\t\n\t\t\t\t,[Pausa Almo\u00e7o (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Almo\u00e7o]/1000.0, 0)\t\t\t\t\n\t\t\t\t,[Pausa Feedback (Intelix)] \t\t=\tISNULL([Intelix_Pausa Feedback]/1000.0, 0)\t\t\t\n\t\t\t\t,[Pausa Sistema Interno (Intelix)] \t=\tISNULL([Intelix_Pausa Sistema Interno]/1000.0, 0)\t\n\t\t\t\t,[Pausa Sistema Externo (Intelix)] \t=\tISNULL([Intelix_Pausa Sistema Externo]/1000.0, 0)\t\n\t\t\t\t,[Pausa Treinamento (Intelix)] \t\t=\tISNULL([Intelix_Pausa Treinamento]/1000.0, 0)\t\t\n\t\t\t\t,[Pausa Banheiro (Intelix)] \t\t=\tISNULL([Intelix_Pausa Banheiro]/1000.0, 0)\t\t\t\n\t\t\t\t,[Pausa Reuni\u00e3o (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Reuni\u00e3o]/1000.0, 0)\t\t\t\n\t\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)] \t\t=\tISNULL([Intelix_Pausa Ambulat\u00f3rio]/1000.0, 0)\t\t\n\t\t\t\t,[Pausa NR17 (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa NR17]/1000.0, 0)\t\t\n\n\t\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tISNULL([EPBX_Em Ligacao]/1000.0, 0)\t\t\t\t\t\n\t\t\t\t,[Pausa Almo\u00e7o (EPBX)] \t\t\t\t=\tISNULL([EPBX_Almo\u00e7o]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t\t,[Pausa Tratativa (EPBX)] \t\t\t=\tISNULL([EPBX_Tratativa]/1000.0, 0)\t\t\t\t\t\n\t\t\t\t,[Pausa Discagem Manual (EPBX)] \t=\tISNULL([EPBX_Discagem Manual]/1000.0, 0)\t\t\t\t\n\t\t\t\t,[Pausa Banheiro (EPBX)] \t\t\t=\tISNULL([EPBX_Banheiro]/1000.0, 0)\t\t\t\t\t\n\t\t\t\t,[Pausa WhatsApp (EPBX)] \t\t\t=\tISNULL([EPBX_WhatsApp]/1000.0, 0)\t\t\t\t\t\n\t\t\t\t,[Pausa Intervalo (EPBX)] \t\t\t=\tISNULL([EPBX_Intervalo]/1000.0, 0)\t\t\t\t\t\n\t\t\t\t,[Pausa Discagem Retorno (EPBX)] \t=\tISNULL([EPBX_Discagem Retorno]/1000.0, 0)\t\t\t\n\t\t\t\t,[Pausa Treinamento (EPBX)] \t\t=\tISNULL([EPBX_Treinamento]/1000.0, 0)\t\t\t\t\t\n\t\t\t\t,[Pausa Feedback (EPBX)] \t\t\t=\tISNULL([EPBX_Feedback]/1000.0, 0)\t\t\t\t\t\n\t\t\t\t,[Pausa Transfer\u00eancia (EPBX)] \t\t=\tISNULL([EPBX_Transfer\u00eancia]/1000.0, 0)\t\t\t\t\n\t\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)] \t\t=\tISNULL([EPBX_N\u00e3o Disponivel]/1000.0, 0)\t\t\t\t\n\t\t\t\t,[Pausa Login (EPBX)] \t\t\t\t=\tISNULL([EPBX_Login]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t\t,[Pausa Reuni\u00e3o (EPBX)] \t\t\t=\tISNULL([EPBX_Reuni\u00e3o]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t\t,[Pausa Sistema Interno (EPBX)] \t=\tISNULL([EPBX_Sistema (interno)]/1000.0, 0)\t\t\n\t\t\t\t,[Pausa Sistema Externo (EPBX)] \t=\tISNULL([EPBX_Sistema (Externo)]/1000.0, 0)\t\t\t\n\t\t\t\t,[Pausa NR17 (EPBX)] \t\t\t\t=\tISNULL([EPBX_NR17]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)] \t\t=\tISNULL([EPBX_Ambulat\u00f3rio]/1000.0, 0)\t\t\t\t\t\n\t\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)] \t=\tISNULL([EPBX_P\u00f3s Atendimento]/1000.0, 0)\t\t\t\t\n\t\t\t\t,[Pausa Lanche (EPBX)] \t\t\t\t=\tISNULL([EPBX_Lanche]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t\t,[Pausa BackOffice (EPBX)] \t\t\t=\tISNULL([EPBX_BackOffice]/1000.0, 0)\t\t\t\t\t\n\n\t\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tISNULL([Genesys_Almo\u00e7o]/1000.0, 0)\t\t\t\t-- Improd\n\t\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tISNULL([Genesys_Ambulat\u00f3rio]/1000.0, 0)\t\t\t-- Improd\n\t\t\t\t,[Pausa Banheiro (Genesys)]\t\t\t=\tISNULL([Genesys_Banheiro]/1000.0, 0)\t\t\t-- Improd\n\t\t\t\t,[Pausa Descanso (Genesys)]\t\t\t=\tISNULL([Genesys_Descanso]/1000.0, 0)\t\t\t-- Improd\n\t\t\t\t,[Pausa Feedback (Genesys)]\t\t\t=\tISNULL([Genesys_Feedback]/1000.0, 0)\t\t\t-- Improd\n\t\t\t\t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tISNULL([Genesys_Dispon\u00edvel]/1000.0, 0)\t\t\t-- Improd\n\t\t\t\n\t\t\t\t,[Pausa Backoffice (Genesys)]\t\t=\tISNULL([Genesys_Backoffice]/1000.0, 0)\t\t\t-- Prod\n\t\t\t\t,[Pausa Discagem Manual (Genesys)]\t=\tISNULL([Genesys_Discagem Manual]/1000.0, 0)\t\t-- Prod\n\t\t\t\t,[Pausa Discagem Retorno (Genesys)]\t=\tISNULL([Genesys_Discagem Retorno]/1000.0, 0)\t-- Prod\n\t\t\t\t,[Pausa Em Fila (Genesys)]\t\t\t=\tISNULL([Genesys_Em Fila]/1000.0, 0)\t\t\t\t-- Prod\n\t\t\t\t,[Pausa Sistema Externo (Genesys)]\t=\tISNULL([Genesys_Sistema Externo]/1000.0, 0)\t\t-- Prod\n\t\t\t\t,[Pausa Sistema Interno (Genesys)]\t=\tISNULL([Genesys_Sistema Interno]/1000.0, 0)\t\t-- Improd\n\t\t\t\t,[Pausa Tratativa (Genesys)]\t\t=\tISNULL([Genesys_Tratativa]/1000.0, 0)\t\t\t-- Prod\n\t\t\t\t,[Pausa Whatsapp (Genesys)]\t\t\t=\tISNULL([Genesys_Whatsapp]/1000.0, 0)\t\t\t-- Prod\n\t\t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tISNULL([Genesys_Treinamento]/1000.0, 0)\t\t\t-- Improd\n\n\t\t\tFROM (\n\t\t\t\tSELECT *\n\t\t\t\t\t,[Log_Acumulado]=\tSUM([Log]) OVER (PARTITION BY [ID Selecionar], [Data] ORDER BY [DataHora])\n\t\t\t\t\t,[Inicio_HE]\t=\t[Jornada (Log)]\n\t\t\t\t\t,[Limite_HE]\t=\t[Jornada (Log)]+7200000\n\n\t\t\t\t\t,[Log_Acumulado_ponto]\t=\tSUM([Trabalhado (Ponto)]) OVER (PARTITION BY [ID Selecionar], [Data] ORDER BY [DataHora])\n\t\t\t\t\t,[Inicio_HE_ponto]\t\t=\t[Jornada (Ponto)]\n\t\t\t\t\t,[Limite_HE_ponto]\t\t=\t[Jornada (Ponto)]+7200000\n\t\t\t\tFROM (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t [DataHora]\t\t\t\t\t\t\t=\t[DataHora]\n\t\t\t\t\t\t,[Proxima_DataHora]\t\t\t\t\t=\t[Proxima_DataHora]\n\t\t\t\t\t\t,[Data]\t\t\t\t\t\t\t\t=\t[Data]\n\t\t\t\t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n\t\t\t\t\t\t,[Cliente]\t\t\t\t\t\t\t=\tMAX([Cliente])\n\t\t\t\t\t\t,[Projeto]\t\t\t\t\t\t\t=\tMAX([Projeto])\n\t\t\t\t\t\t,[Tribo]\t\t\t\t\t\t\t=\tMAX([Tribo])\n\t\t\t\t\t\t,[Tribo Completa]\t\t\t\t\t=\tISNULL([Tribo Completa], '--')\n\n\t\t\t\t\t\t---\\/ponto\\/\n\t\t\t\t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tMAX([Jornada (Ponto)])*1000\n\t\t\t\t\t\t,[Login_ponto]\t\t\t\t\t\t=\tMIN(MIN(IIF(Fonte =  'SECULLUM',[In\u00edcio], NULL))) OVER (PARTITION BY c.[ID Selecionar], [Data])\n\t\t\t\t\t\t,[Logout_ponto]\t\t\t\t\t\t=\tMAX(MAX(IIF(Fonte =  'SECULLUM',[Fim], NULL)))\t OVER (PARTITION BY c.[ID Selecionar], [Data])\n\t\t\t\t\t\t\n\t\t\t\t\t\t,[Trabalhado (Ponto)]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'SECULLUM' AND Evento = ('Trabalhado'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Trabalhado_cortado_ponto]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'SECULLUM' AND Evento = ('Trabalhado'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'SECULLUM' AND Evento = ('Em Pausa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t---/\\ponto/\\\n\n\t\t\t\t\t\t,[Jornada (Log)]\t\t\t\t\t=\tMAX([Jornada (Log)])*1000\n\t\t\t\t\t\t,[Login]\t\t\t\t\t\t\t=\tMIN(MIN(IIF(Fonte = 'INTELIX' OR Fonte = 'EPBX' OR Fonte = 'GENESYS',[In\u00edcio], NULL))) OVER (PARTITION BY c.[ID Selecionar], [Data])\n\t\t\t\t\t\t,[Logout]\t\t\t\t\t\t\t=\tMAX(MAX(IIF(Fonte = 'INTELIX' OR Fonte = 'EPBX' OR Fonte = 'GENESYS',[Fim], NULL)))\t OVER (PARTITION BY c.[ID Selecionar], [Data])\n\n\t\t\t\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' OR Fonte = 'EPBX' OR Fonte = 'GENESYS'\t\t  THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Log_cortado]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' OR Fonte = 'EPBX' OR Fonte = 'GENESYS'\t\t  THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t\n\t\t\t\t\t\t,[Intelix_Tempo Livre]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Login'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Particular]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Particular (Break))'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Break]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Break)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa 10]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Pausa 10)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Outbound]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Outbound)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Lanche]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Lanche)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa R\u00e1pida]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Pausa Rapida)'\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Almo\u00e7o]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Almoco)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Feedback]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Feedback)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Sistema Externo]\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Sistema (Externo))'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Treinamento]\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Treinamento)'\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Banheiro]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Banheiro)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Sistema Interno]\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Sistema (Interno))'\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Reuni\u00e3o]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Reuniao)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Ambulat\u00f3rio]\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (Ambulatorio)'\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa NR17]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'INTELIX' AND Evento = ('Pausa (NR 17)'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t\n\t\t\t\t\t\t,[EPBX_Tempo Livre]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Livre'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Em Ligacao]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Em Ligacao'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Almo\u00e7o]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Almo\u00e7o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Tratativa]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Tratativa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Discagem Manual]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Discagem Manual'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Banheiro]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Banheiro'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_WhatsApp]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('WhatsApp'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Intervalo]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Intervalo'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Discagem Retorno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Discagem Retorno'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Treinamento]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Treinamento'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Feedback]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Feedback'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Transfer\u00eancia]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Transfer\u00eancia'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Sistema (Externo)]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Sistema (Externo)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_N\u00e3o Disponivel]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('N\u00e3o Disponivel'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Login]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Login'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Reuni\u00e3o]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Reuni\u00e3o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Sistema (interno)]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Sistema (interno)'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_NR17]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('NR17'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Ambulat\u00f3rio]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Ambulat\u00f3rio'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_P\u00f3s Atendimento]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('P\u00f3s Atendimento'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Lanche]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Lanche'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_BackOffice]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('BackOffice'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\n\t\t\t\t\t\t,[Genesys_Almo\u00e7o]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Almo\u00e7o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Ambulat\u00f3rio]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Ambulat\u00f3rio'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Backoffice]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Backoffice'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Banheiro]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Banheiro'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Descanso]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Descanso'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Discagem Manual]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Discagem Manual'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Discagem Retorno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Discagem Retorno'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Dispon\u00edvel]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Dispon\u00edvel'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Em Fila]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Em Fila'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Feedback]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Feedback'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Sistema Externo]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Sistema Externo'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Sistema Interno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Sistema Interno'\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Tratativa]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Tratativa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Whatsapp]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Whatsapp'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Treinamento]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Treinamento'\t\t\t\t) THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\n\n\t\t\t\t\tFROM f_log l\n\t\t\t\t\tRIGHT JOIN [#chaves] c\n\t\t\t\t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(l.[ID Selecionar], '-')\n\t\t\t\t\tAND\tc.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio]) / 30.0) * 30, 0)\n\t\t\t\t\tAND\tc.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim]) / 30.0) * 30, 0) \n\n\t\t\t\t\tWHERE c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim \n\t\t\t\t\tAND\t  In\u00edcio >= @datahora_inicio AND Fim <= @datahora_fim \n\t\t\t\t\tAND c.[\u00c9 A Tribo do MOP?] = 1\n\t\t\t\t\tGROUP BY [DataHora], [Proxima_DataHora], c.[ID Selecionar], [Data],\t[Tribo Completa]\n\t\t\t\t) c\n\t\t\t) c\n\n\n\t\t) AS fonte\n\t\t\n\t\tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n\t\tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n\t\tAND fonte.[Tribo Completa]\t=\tdestino.[Tribo Completa]\n\n\t\tWHEN NOT MATCHED BY TARGET THEN\n\t\t\tINSERT (\n\t\t\t\t [Teve Evento de Log?]\n\t\t\t\t,[DataHora]\n\t\t\t\t,[ID Selecionar]\n\t\t\t\t,[Cliente]\n\t\t\t\t,[Projeto]\n\t\t\t\t,[Tribo]\n\t\t\t\t,[Tribo Completa]\n\t\t\t\t,[Trabalhado (Ponto)]\n\t\t\t\t,[Em Pausa (Ponto)]\n\t\t\t\t,[Login]\n\t\t\t\t,[Logout]\n\t\t\t\t,[Log descartado (>2HE)]\n\t\t\t\t,[HE]\n\t\t\t\t,[Log]\n\t\t\t\t,[Log Produtivo]\n\t\t\t\t,[Log Improdutivo]\n\t\t\t\t,[Tempo Livre]\n\t\t\t\t,[Pausa Particular (Intelix)]\n\t\t\t\t,[Pausa Break (Intelix)]\n\t\t\t\t,[Pausa 10 (Intelix)]\n\t\t\t\t,[Pausa Outbound (Intelix)]\n\t\t\t\t,[Pausa Lanche (Intelix)]\n\t\t\t\t,[Pausa R\u00e1pida (Intelix)]\n\t\t\t\t,[Pausa Almo\u00e7o (Intelix)]\n\t\t\t\t,[Pausa Feedback (Intelix)]\n\t\t\t\t,[Pausa Sistema Interno (Intelix)]\n\t\t\t\t,[Pausa Sistema Externo (Intelix)]\n\t\t\t\t,[Pausa Treinamento (Intelix)]\n\t\t\t\t,[Pausa Banheiro (Intelix)]\n\t\t\t\t,[Pausa Reuni\u00e3o (Intelix)]\n\t\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t\t\t,[Pausa NR17 (Intelix)]\n\t\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t\t\t,[Pausa Almo\u00e7o (EPBX)]\n\t\t\t\t,[Pausa Tratativa (EPBX)]\n\t\t\t\t,[Pausa Discagem Manual (EPBX)]\n\t\t\t\t,[Pausa Banheiro (EPBX)]\n\t\t\t\t,[Pausa WhatsApp (EPBX)]\n\t\t\t\t,[Pausa Intervalo (EPBX)]\n\t\t\t\t,[Pausa Discagem Retorno (EPBX)]\n\t\t\t\t,[Pausa Treinamento (EPBX)]\n\t\t\t\t,[Pausa Feedback (EPBX)]\n\t\t\t\t,[Pausa Transfer\u00eancia (EPBX)]\n\t\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t\t\t,[Pausa Login (EPBX)]\n\t\t\t\t,[Pausa Reuni\u00e3o (EPBX)]\n\t\t\t\t,[Pausa Sistema Interno (EPBX)]\n\t\t\t\t,[Pausa Sistema Externo (EPBX)]\n\t\t\t\t,[Pausa NR17 (EPBX)]\n\t\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t\t\t,[Pausa Lanche (EPBX)]\n\t\t\t\t,[Pausa BackOffice (EPBX)]\n\t\t\t\t,[Pausa Almo\u00e7o (Genesys)]\n\t\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t\t\t,[Pausa Banheiro (Genesys)]\n\t\t\t\t,[Pausa Descanso (Genesys)]\n\t\t\t\t,[Pausa Feedback (Genesys)]\n\t\t\t\t,[Pausa Backoffice (Genesys)]\n\t\t\t\t,[Pausa Discagem Manual (Genesys)]\n\t\t\t\t,[Pausa Discagem Retorno (Genesys)]\n\t\t\t\t,[Pausa Dispon\u00edvel (Genesys)]\n\t\t\t\t,[Pausa Em Fila (Genesys)]\n\t\t\t\t,[Pausa Sistema Externo (Genesys)]\n\t\t\t\t,[Pausa Sistema Interno (Genesys)]\n\t\t\t\t,[Pausa Tratativa (Genesys)]\n\t\t\t\t,[Pausa Whatsapp (Genesys)]\n\t\t\t\t,[Pausa Treinamento (Genesys)]\n\t\t\t\t)\n\t\t\tVALUES (\n\t\t\t\t 1\n\t\t\t\t,fonte.[DataHora]\n\t\t\t\t,fonte.[ID Selecionar]\n\t\t\t\t,fonte.[Cliente]\n\t\t\t\t,fonte.[Projeto]\n\t\t\t\t,fonte.[Tribo]\n\t\t\t\t,fonte.[Tribo Completa]\n\t\t\t\t,fonte.[Trabalhado (Ponto)]\n\t\t\t\t,fonte.[Em Pausa (Ponto)]\n\t\t\t\t,fonte.[Login]\n\t\t\t\t,fonte.[Logout]\n\t\t\t\t,fonte.[Log descartado (>2HE)]\n\t\t\t\t,fonte.[HE]\n\t\t\t\t,fonte.[Log]\n\t\t\t\t,fonte.[Log Produtivo]\n\t\t\t\t,fonte.[Log Improdutivo]\n\t\t\t\t,fonte.[Tempo Livre]\n\t\t\t\t,fonte.[Pausa Particular (Intelix)]\n\t\t\t\t,fonte.[Pausa Break (Intelix)]\n\t\t\t\t,fonte.[Pausa 10 (Intelix)]\n\t\t\t\t,fonte.[Pausa Outbound (Intelix)]\n\t\t\t\t,fonte.[Pausa Lanche (Intelix)]\n\t\t\t\t,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t\t\t,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t\t\t,fonte.[Pausa Feedback (Intelix)]\n\t\t\t\t,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t\t\t,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t\t\t,fonte.[Pausa Treinamento (Intelix)]\n\t\t\t\t,fonte.[Pausa Banheiro (Intelix)]\n\t\t\t\t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t\t\t,fonte.[Pausa NR17 (Intelix)]\n\t\t\t\t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t\t\t,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t\t\t,fonte.[Pausa Tratativa (EPBX)]\n\t\t\t\t,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t\t\t,fonte.[Pausa Banheiro (EPBX)]\n\t\t\t\t,fonte.[Pausa WhatsApp (EPBX)]\n\t\t\t\t,fonte.[Pausa Intervalo (EPBX)]\n\t\t\t\t,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t\t\t,fonte.[Pausa Treinamento (EPBX)]\n\t\t\t\t,fonte.[Pausa Feedback (EPBX)]\n\t\t\t\t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t\t\t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t\t\t,fonte.[Pausa Login (EPBX)]\n\t\t\t\t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t\t\t,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t\t\t,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t\t\t,fonte.[Pausa NR17 (EPBX)]\n\t\t\t\t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t\t\t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t\t\t,fonte.[Pausa Lanche (EPBX)]\n\t\t\t\t,fonte.[Pausa BackOffice (EPBX)]\n\t\t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t\t\t,fonte.[Pausa Banheiro (Genesys)]\n\t\t\t\t,fonte.[Pausa Descanso (Genesys)]\n\t\t\t\t,fonte.[Pausa Feedback (Genesys)]\n\t\t\t\t,fonte.[Pausa Backoffice (Genesys)]\n\t\t\t\t,fonte.[Pausa Discagem Manual (Genesys)]\n\t\t\t\t,fonte.[Pausa Discagem Retorno (Genesys)]\n\t\t\t\t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t\t\t\t,fonte.[Pausa Em Fila (Genesys)]\n\t\t\t\t,fonte.[Pausa Sistema Externo (Genesys)]\n\t\t\t\t,fonte.[Pausa Sistema Interno (Genesys)]\n\t\t\t\t,fonte.[Pausa Tratativa (Genesys)]\n\t\t\t\t,fonte.[Pausa Whatsapp (Genesys)]\n\t\t\t\t,fonte.[Pausa Treinamento (Genesys)]\n\t\t\t\t)\n\t\tWHEN MATCHED THEN \n\t\t\tUPDATE SET\n\t\t\t\t destino.[Teve Evento de Log?]\t\t\t\t=\t1\n\t\t\t\t,destino.[DataHora]\t\t\t\t\t\t\t=\tfonte.[DataHora]\n\t\t\t\t,destino.[ID Selecionar]\t\t\t\t\t=\tfonte.[ID Selecionar]\n\t\t\t\t,destino.[Cliente]\t\t\t\t\t\t\t=\tfonte.[Cliente]\n\t\t\t\t,destino.[Projeto]\t\t\t\t\t\t\t=\tfonte.[Projeto]\n\t\t\t\t,destino.[Tribo]\t\t\t\t\t\t\t=\tfonte.[Tribo]\n\t\t\t\t,destino.[Tribo Completa]\t\t\t\t\t=\tfonte.[Tribo Completa]\n\t\t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t=\tfonte.[Trabalhado (Ponto)]\n\t\t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t=\tfonte.[Em Pausa (Ponto)]\n\t\t\t\t,destino.[Login]\t\t\t\t\t\t\t=\tfonte.[Login]\n\t\t\t\t,destino.[Logout]\t\t\t\t\t\t\t=\tfonte.[Logout]\n\t\t\t\t,destino.[Log descartado (>2HE)]\t\t\t=\tfonte.[Log descartado (>2HE)]\n\t\t\t\t,destino.[HE]\t\t\t\t\t\t\t\t=\tfonte.[HE]\n\t\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t=\tfonte.[Log]\n\t\t\t\t,destino.[Log Produtivo]\t\t\t\t\t=\tfonte.[Log Produtivo]\n\t\t\t\t,destino.[Log Improdutivo]\t\t\t\t\t=\tfonte.[Log Improdutivo]\n\t\t\t\t,destino.[Tempo Livre]\t\t\t\t\t\t=\tfonte.[Tempo Livre]\n\t\t\t\t,destino.[Pausa Particular (Intelix)]\t\t=\tfonte.[Pausa Particular (Intelix)]\n\t\t\t\t,destino.[Pausa Break (Intelix)]\t\t\t=\tfonte.[Pausa Break (Intelix)]\n\t\t\t\t,destino.[Pausa 10 (Intelix)]\t\t\t\t=\tfonte.[Pausa 10 (Intelix)]\n\t\t\t\t,destino.[Pausa Outbound (Intelix)]\t\t\t=\tfonte.[Pausa Outbound (Intelix)]\n\t\t\t\t,destino.[Pausa Lanche (Intelix)]\t\t\t=\tfonte.[Pausa Lanche (Intelix)]\n\t\t\t\t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\tfonte.[Pausa R\u00e1pida (Intelix)]\n\t\t\t\t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tfonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t\t\t,destino.[Pausa Feedback (Intelix)]\t\t\t=\tfonte.[Pausa Feedback (Intelix)]\n\t\t\t\t,destino.[Pausa Sistema Interno (Intelix)]\t=\tfonte.[Pausa Sistema Interno (Intelix)]\n\t\t\t\t,destino.[Pausa Sistema Externo (Intelix)]\t=\tfonte.[Pausa Sistema Externo (Intelix)]\n\t\t\t\t,destino.[Pausa Treinamento (Intelix)]\t\t=\tfonte.[Pausa Treinamento (Intelix)]\n\t\t\t\t,destino.[Pausa Banheiro (Intelix)]\t\t\t=\tfonte.[Pausa Banheiro (Intelix)]\n\t\t\t\t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tfonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tfonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t\t\t,destino.[Pausa NR17 (Intelix)]\t\t\t\t=\tfonte.[Pausa NR17 (Intelix)]\n\t\t\t\t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tfonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t\t\t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tfonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t\t\t,destino.[Pausa Tratativa (EPBX)]\t\t\t=\tfonte.[Pausa Tratativa (EPBX)]\n\t\t\t\t,destino.[Pausa Discagem Manual (EPBX)]\t\t=\tfonte.[Pausa Discagem Manual (EPBX)]\n\t\t\t\t,destino.[Pausa Banheiro (EPBX)]\t\t\t=\tfonte.[Pausa Banheiro (EPBX)]\n\t\t\t\t,destino.[Pausa WhatsApp (EPBX)]\t\t\t=\tfonte.[Pausa WhatsApp (EPBX)]\n\t\t\t\t,destino.[Pausa Intervalo (EPBX)]\t\t\t=\tfonte.[Pausa Intervalo (EPBX)]\n\t\t\t\t,destino.[Pausa Discagem Retorno (EPBX)]\t=\tfonte.[Pausa Discagem Retorno (EPBX)]\n\t\t\t\t,destino.[Pausa Treinamento (EPBX)]\t\t\t=\tfonte.[Pausa Treinamento (EPBX)]\n\t\t\t\t,destino.[Pausa Feedback (EPBX)]\t\t\t=\tfonte.[Pausa Feedback (EPBX)]\n\t\t\t\t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\tfonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t\t\t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tfonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t\t\t,destino.[Pausa Login (EPBX)]\t\t\t\t=\tfonte.[Pausa Login (EPBX)]\n\t\t\t\t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tfonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t\t\t,destino.[Pausa Sistema Interno (EPBX)]\t\t=\tfonte.[Pausa Sistema Interno (EPBX)]\n\t\t\t\t,destino.[Pausa Sistema Externo (EPBX)]\t\t=\tfonte.[Pausa Sistema Externo (EPBX)]\n\t\t\t\t,destino.[Pausa NR17 (EPBX)]\t\t\t\t=\tfonte.[Pausa NR17 (EPBX)]\n\t\t\t\t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tfonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t\t\t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tfonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t\t\t,destino.[Pausa Lanche (EPBX)]\t\t\t\t=\tfonte.[Pausa Lanche (EPBX)]\n\t\t\t\t,destino.[Pausa BackOffice (EPBX)]\t\t\t=\tfonte.[Pausa BackOffice (EPBX)]\n\t\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tfonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tfonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t=\tfonte.[Pausa Banheiro (Genesys)]\n\t\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t=\tfonte.[Pausa Descanso (Genesys)]\n\t\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t=\tfonte.[Pausa Feedback (Genesys)]\n\t\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t=\tfonte.[Pausa Backoffice (Genesys)]\n\t\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t=\tfonte.[Pausa Discagem Manual (Genesys)]\n\t\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t=\tfonte.[Pausa Discagem Retorno (Genesys)]\n\t\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\tfonte.[Pausa Dispon\u00edvel (Genesys)]\n\t\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t=\tfonte.[Pausa Em Fila (Genesys)]\n\t\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t=\tfonte.[Pausa Sistema Externo (Genesys)]\n\t\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t=\tfonte.[Pausa Sistema Interno (Genesys)]\n\t\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t=\tfonte.[Pausa Tratativa (Genesys)]\n\t\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t=\tfonte.[Pausa Whatsapp (Genesys)]\n\t\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t=\tfonte.[Pausa Treinamento (Genesys)]\n\t\t\t\n\n\t\tWHEN NOT MATCHED BY SOURCE THEN\n\t\t\tUPDATE SET\n\t\t\t\t destino.[Teve Evento de Log?]\t\t\t\t=\t0\n\t\t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t=\tNULL\n\t\t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t=\t0\n\t\t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t=\t0\n\t\t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t=\tNULL\n\t\t\t\t,destino.[Jornada (Log)]\t\t\t\t\t=\t0\n\t\t\t\t,destino.[Login]\t\t\t\t\t\t\t=\tNULL\n\t\t\t\t,destino.[Logout]\t\t\t\t\t\t\t=\tNULL\n\t\t\t\t,destino.[Log descartado (>2HE)]\t\t\t=\t0\n\t\t\t\t,destino.[HE]\t\t\t\t\t\t\t\t=\t0\n\t\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t=\t0\n\t\t\t\t,destino.[Log Produtivo]\t\t\t\t\t=\t0\n\t\t\t\t,destino.[Log Improdutivo]\t\t\t\t\t=\t0\n\t\t\t\t,destino.[Tempo Livre]\t\t\t\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Particular (Intelix)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Break (Intelix)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa 10 (Intelix)]\t\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Outbound (Intelix)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Lanche (Intelix)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Feedback (Intelix)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Sistema Interno (Intelix)]\t=\t0\n\t\t\t\t,destino.[Pausa Sistema Externo (Intelix)]\t=\t0\n\t\t\t\t,destino.[Pausa Treinamento (Intelix)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Banheiro (Intelix)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\t0\n\t\t\t\t,destino.[Pausa NR17 (Intelix)]\t\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Tratativa (EPBX)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Discagem Manual (EPBX)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Banheiro (EPBX)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa WhatsApp (EPBX)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Intervalo (EPBX)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Discagem Retorno (EPBX)]\t=\t0\n\t\t\t\t,destino.[Pausa Treinamento (EPBX)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Feedback (EPBX)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\t0\n\t\t\t\t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Login (EPBX)]\t\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Sistema Interno (EPBX)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Sistema Externo (EPBX)]\t\t=\t0\n\t\t\t\t,destino.[Pausa NR17 (EPBX)]\t\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Lanche (EPBX)]\t\t\t\t=\t0\n\t\t\t\t,destino.[Pausa BackOffice (EPBX)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t=\t0\n\t\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t=\t0\n\t\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t=\t0\n\t\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t=\t0\n\t\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t=\t0\n\t\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t=\t0\n\t\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t=\t0\n\t\t;\n\t\t\n\tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n\tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n\tCOMMIT TRANSACTION tran_log;\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Finaliza\u00e7\u00e3o (Limpeza de nulos, c\u00e1lculos finais, etc)\n\tPRINT '--- cleanup';\n\tSELECT [Etapa]='cleanup';\n\t--DBCC SQLPERF('logspace');\n\tSET @t_inicio_etapa = GETDATE();\n\tBEGIN TRANSACTION tran_cleanup;\n\t--EXEC sp_sys_estrutura @limpar=1, @listar=0;\n\t\n\n\t--/*\n\t;WITH destino AS\n\t(\n\t\tSELECT * FROM [r_individuo_30min]\n\t\tWHERE CAST([DataHora] AS DATE) >= @datahora_inicio \n\t\tAND\t  CAST([DataHora] AS DATE) <= @datahora_fim \n\t)\n\tMERGE INTO destino USING\n\t--*/\n\t--SELECT [n] = COUNT(*) OVER (PARTITION BY [DataHora], [ID Selecionar]), * FROM\n\t(\n\t\tSELECT DISTINCT\n\t\t\t [DataHora]\t\t\t\t\t\t\t=\tc.[DataHora]\n\t\t\t,[Intervalo]\t\t\t\t\t\t=\tMIN(c.[Intervalo])\n\t\t\t,[Data]\t\t\t\t\t\t\t\t=\tMIN(c.[Data])\n\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t=\tMIN(c.[Ciclo (Primeiro Dia)])\n\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t=\tMIN(c.[M\u00eas (Primeiro Dia)])\n\t\t\t,[Feriado]\t\t\t\t\t\t\t=\tMIN(c.[Feriado])\n\t\t\t,[Folga]\t\t\t\t\t\t\t=\tMIN(c.[Folga])\n\t\t\t,[Abono]\t\t\t\t\t\t\t=\tMIN(c.[Abono])\t\t\t\t\n\t\t\t,[Compensa\u00e7\u00e3o de Horas]\t\t\t\t=\tMIN(c.[Compensa\u00e7\u00e3o de Horas])\n\t\t\t,[Falta Justificada]\t\t\t\t=\tMIN(c.[Falta Justificada])\n\t\t\t,[Falta Injustificada]\t\t\t\t=\tMIN(c.[Falta Injustificada])\n\t\t\t,[Suspens\u00e3o]\t\t\t\t\t\t=\tMIN(c.[Suspens\u00e3o])\n\t\t\t,[Atestado]\t\t\t\t\t\t\t=\tMIN(c.[Atestado])\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tMIN(c.[DataHora da Atualiza\u00e7\u00e3o do MOP])\n\t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n\t\t\t,[Nome]\t\t\t\t\t\t\t\t=\tMIN(c.[Nome])\n\t\t\t,[Status]\t\t\t\t\t\t\t=\tMIN(c.[Status])\n\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN(c.[Situa\u00e7\u00e3o])\n\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN(c.[Condi\u00e7\u00e3o])\n\t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tMIN(c.[DMA Inicial])\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tMIN(c.[\u00daltima DMA Migra\u00e7\u00e3o])\n\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tMIN(c.[\u00daltima DMA Geral])\n\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tMIN(c.[Tipo da \u00daltima DMA])\n\t\t\t,[Instrutor Inicial]\t\t\t\t=\tMIN(c.[Instrutor Inicial])\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tMIN(c.[Instrutor \u00daltima Migra\u00e7\u00e3o])\n\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tMIN(c.[Instrutor \u00daltima DMA])\n\t\t\t,[Cliente]\t\t\t\t\t\t\t=\tMIN(COALESCE(r.[Cliente], c.[Cliente]))\n\t\t\t,[Projeto]\t\t\t\t\t\t\t=\tMIN(COALESCE(r.[Projeto], c.[Projeto]))\n\t\t\t,[Cargo]\t\t\t\t\t\t\t=\tMIN(c.[Cargo])\n\t\t\t,[Tribo]\t\t\t\t\t\t\t=\tMIN(COALESCE(r.[Tribo], c.[Tribo]))\n\t\t\t,[Tribo Completa]\t\t\t\t\t=\tCOALESCE(r.[Tribo Completa], c.[Tribo Completa])\n\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tMIN(c.[Supervis\u00e3o])\n\t\t\t,[Turno]\t\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Turno]), NULL)\n\t\t\t,[Escala (Ponto)]\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Escala (Ponto)]), NULL)\n\t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Jornada (Ponto)]), 0)\n\t\t\t,[Escala (MOP)]\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Escala (MOP)]), NULL)\n\t\t\t,[Jornada (Log)]\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], MIN(c.[Jornada (Log)]), 0)\n\t\t\t\n\t\t\t,[Teve Evento de MOP?]\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], 1, 0)\n\t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], 1, 0)\n\t\t\t\n\t\t\t,[log_dia]\t\t\t\t\t\t\t=\tIIF(COALESCE(r.[Tribo Completa], c.[Tribo Completa]) = c.[Tribo Completa], SUM(SUM(r.[Log])) OVER (PARTITION BY MIN(r.[Data]), MIN(r.[ID Selecionar]), MIN(r.[Tribo Completa])), 0)\n\n\t\tFROM [#chaves] c\n\t\tLEFT JOIN r_individuo_30min r\n\t\tON r.[DataHora] = c.[DataHora] \n\t\tAND COALESCE(r.[ID Selecionar], '-') = COALESCE(c.[ID Selecionar], '-')\n\t\t--WHERE  (r.[DataHora] <= @datahora_fim AND r.[DataHora] >= @datahora_inicio)\n\t\tGROUP BY c.[DataHora], c.[ID Selecionar], COALESCE(r.[Tribo Completa], c.[Tribo Completa]), c.[Tribo Completa]\n\t) AS fonte\n\n\n\t--/*\n\tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n\tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n\tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [DataHora]\n\t\t\t,[Intervalo]\n\t\t\t,[Data]\n\t\t\t,[Ciclo (Primeiro Dia)]\n\t\t\t,[M\u00eas (Primeiro Dia)]\n\t\t\t,[Feriado]\n\t\t\t,[Folga]\n\t\t\t,[Abono]\t\t\t\t\n\t\t\t,[Compensa\u00e7\u00e3o de Horas] \n\t\t\t,[Falta Justificada]\t\n\t\t\t,[Falta Injustificada] \n\t\t\t,[Suspens\u00e3o]\t\t\t\n\t\t\t,[Atestado]\t\t\t\t\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,[ID Selecionar]\n\t\t\t,[Nome]\n\t\t\t,[Status]\n\t\t\t,[Situa\u00e7\u00e3o]\n\t\t\t,[Condi\u00e7\u00e3o]\n\t\t\t,[DMA Inicial]\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,[\u00daltima DMA Geral]\n\t\t\t,[Tipo da \u00daltima DMA]\n\t\t\t,[Instrutor Inicial]\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,[Instrutor \u00daltima DMA]\n\t\t\t,[Cliente]\n\t\t\t,[Projeto]\n\t\t\t,[Cargo]\n\t\t\t,[Tribo]\n\t\t\t,[Tribo Completa]\n\t\t\t,[Supervis\u00e3o]\n\t\t\t,[Turno]\n\t\t\t,[Escala (Ponto)]\n\t\t\t,[Jornada (Ponto)]\n\t\t\t,[Escala (MOP)]\n\t\t\t,[Jornada (Log)]\n\t\t\t,[Tipo de Jornada]\n\t\t\t,[Teve Evento de MOP?]\n\t\t\t,[\u00c9 A Tribo do MOP?]\n\t\t) \n\t\tVALUES \n\t\t(\n\t\t\t fonte.[DataHora]\n\t\t\t,fonte.[Intervalo]\n\t\t\t,fonte.[Data]\n\t\t\t,fonte.[Ciclo (Primeiro Dia)]\n\t\t\t,fonte.[M\u00eas (Primeiro Dia)]\n\t\t\t,fonte.[Feriado]\n\t\t\t,fonte.[Folga]\n\t\t\t,fonte.[Abono]\t\t\t\t\n\t\t\t,fonte.[Compensa\u00e7\u00e3o de Horas] \n\t\t\t,fonte.[Falta Justificada]\t\n\t\t\t,fonte.[Falta Injustificada] \n\t\t\t,fonte.[Suspens\u00e3o]\t\t\t\n\t\t\t,fonte.[Atestado]\t\t\t\t\n\t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,fonte.[ID Selecionar]\n\t\t\t,fonte.[Nome]\n\t\t\t,fonte.[Status]\n\t\t\t,fonte.[Situa\u00e7\u00e3o]\n\t\t\t,fonte.[Condi\u00e7\u00e3o]\n\t\t\t,fonte.[DMA Inicial]\n\t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,fonte.[\u00daltima DMA Geral]\n\t\t\t,fonte.[Tipo da \u00daltima DMA]\n\t\t\t,fonte.[Instrutor Inicial]\n\t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,fonte.[Instrutor \u00daltima DMA]\n\t\t\t,fonte.[Cliente]\n\t\t\t,fonte.[Projeto]\n\t\t\t,fonte.[Cargo]\n\t\t\t,fonte.[Tribo]\n\t\t\t,fonte.[Tribo Completa]\n\t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t,fonte.[Turno]\n\t\t\t,fonte.[Escala (Ponto)]\n\t\t\t,fonte.[Jornada (Ponto)]\n\t\t\t,fonte.[Escala (MOP)]\n\t\t\t,fonte.[Jornada (Log)]\n\t\t\t,CASE \n\t\t\t\tWHEN fonte.[Folga]\t\t\t\t\t= 1 THEN 'FOLGA'\n\t\t\t\tWHEN fonte.[Feriado] IS NOT NULL\t\tTHEN 'FERIADO'\n\t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\tTHEN 'TREINAMENTO' \n\t\t\t\tWHEN fonte.[Jornada (Log)] = 0\t\t\tTHEN 'OK'\n\t\t\t\tWHEN fonte.[Jornada (Log)] > 0\t\t\tTHEN 'FALTA'\n\t\t\t END\n\t\t\t \n\t\t\t,fonte.[Teve Evento de MOP?]\n\t\t\t,fonte.[\u00c9 A Tribo do MOP?]\n\t\t)\n\n\tWHEN MATCHED \n\t\tAND ( \n\t\t\t\tfonte.[Teve Evento de MOP?]\t\t\t= 1\n\t\t\tOR\tdestino.[Teve Evento de Tickets?]\t= 1\n\t\t\tOR\tdestino.[Teve Evento de Chamadas?]\t= 1\n\t\t\tOR\tdestino.[Teve Evento de NPS?]\t\t= 1\n\t\t\tOR\tdestino.[Teve Evento de Log?]\t\t= 1\n\t\t)\n\t\tTHEN\n\t\tUPDATE SET\n\t\t\t destino.[\u00c9 A Tribo do MOP?]\t\t\t\t=\tfonte.[\u00c9 A Tribo do MOP?]\n\t\t\t,destino.[Teve Evento de MOP?]\t\t\t\t=\tfonte.[Teve Evento de MOP?]\n\n\t\t\t,destino.[Intervalo]\t\t\t\t\t\t=\tfonte.[Intervalo]\n\t\t\t,destino.[Data]\t\t\t\t\t\t\t\t=\tfonte.[Data]\n\t\t\t,destino.[Ciclo (Primeiro Dia)]\t\t\t\t=\tfonte.[Ciclo (Primeiro Dia)]\n\t\t\t,destino.[M\u00eas (Primeiro Dia)]\t\t\t\t=\tfonte.[M\u00eas (Primeiro Dia)]\n\t\t\t,destino.[Feriado]\t\t\t\t\t\t\t=\tfonte.[Feriado]\n\t\t\t,destino.[Folga]\t\t\t\t\t\t\t=\tfonte.[Folga]\n\t\t\t,destino.[Abono]\t\t\t\t\t\t\t=\tfonte.[Abono]\t\t\t\t\n\t\t\t,destino.[Compensa\u00e7\u00e3o de Horas]\t\t\t\t=\tfonte.[Compensa\u00e7\u00e3o de Horas] \n\t\t\t,destino.[Falta Justificada]\t\t\t\t=\tfonte.[Falta Justificada]\t\n\t\t\t,destino.[Falta Injustificada]\t\t\t\t=\tfonte.[Falta Injustificada] \n\t\t\t,destino.[Suspens\u00e3o]\t\t\t\t\t\t=\tfonte.[Suspens\u00e3o]\t\t\t\n\t\t\t,destino.[Atestado]\t\t\t\t\t\t\t=\tfonte.[Atestado]\t\t\t\t\n\t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tfonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,destino.[ID Selecionar]\t\t\t\t\t=\tfonte.[ID Selecionar]\n\t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t=\tfonte.[Nome]\n\t\t\t,destino.[Status]\t\t\t\t\t\t\t=\tfonte.[Status]\n\t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tfonte.[Situa\u00e7\u00e3o]\n\t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tfonte.[Condi\u00e7\u00e3o]\n\t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t=\tfonte.[DMA Inicial]\n\t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tfonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t=\tfonte.[\u00daltima DMA Geral]\n\t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t=\tfonte.[Tipo da \u00daltima DMA]\n\t\t\t,destino.[Instrutor Inicial]\t\t\t\t=\tfonte.[Instrutor Inicial]\n\t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tfonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t=\tfonte.[Instrutor \u00daltima DMA]\n\t\t\t,destino.[Cargo]\t\t\t\t\t\t\t=\tfonte.[Cargo]\n\t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t=\tfonte.[Supervis\u00e3o]\n\t\t\t,destino.[Turno]\t\t\t\t\t\t\t=\tfonte.[Turno]\n\t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t=\tfonte.[Escala (Ponto)]\n\t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t=\tfonte.[Jornada (Ponto)]\n\t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t=\tfonte.[Escala (MOP)]\n\t\t\t,destino.[Jornada (Log)]\t\t\t\t\t=\tfonte.[Jornada (Log)]\n\t\t\t,destino.[Tipo de Jornada]\t\t\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Folga] = 1\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FOLGA'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Feriado] IS NOT NULL\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FERIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'TREINAMENTO' \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Log)] = [log_dia]\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'OK'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [log_dia] = 0 AND fonte.[Jornada (Log)] > 0\t\t\t\t\t\t\t\t\t\t\tTHEN 'FALTA'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Log)] > [log_dia]\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'ABS'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Jornada (Log)] < [log_dia]\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'HE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t END\n\t\t\t\n\tWHEN MATCHED AND\t(\t \n\t\t\tfonte.[Teve Evento de MOP?]\t\t\t= 0\n\t\tAND\tdestino.[Teve Evento de Tickets?]\t= 0\n\t\tAND\tdestino.[Teve Evento de Chamadas?]\t= 0\n\t\tAND\tdestino.[Teve Evento de NPS?]\t\t= 0\n\t\tAND\tdestino.[Teve Evento de Log?]\t\t= 0\n\t\t)\n\tTHEN DELETE\n\n\tWHEN NOT MATCHED BY SOURCE AND\t(\t \n\t\t\tdestino.[Teve Evento de Tickets?]\t= 0\n\t\tAND\tdestino.[Teve Evento de Chamadas?]\t= 0\n\t\tAND\tdestino.[Teve Evento de NPS?]\t\t= 0\n\t\tAND\tdestino.[Teve Evento de Log?]\t\t= 0\n\t\t)\n\tTHEN DELETE;\n\t--*/\n\t\n\tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n\tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n\tCOMMIT TRANSACTION tran_cleanup;\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Agrupamento p/ individuo dia\n\tPRINT '--- agrupamento dia';\n\tSELECT [Etapa]='agrupamento dia';\n\t--DBCC SQLPERF('logspace');\n\tSET @t_inicio_etapa = GETDATE();\n\tBEGIN TRANSACTION tran_dia;\n\t--EXEC sp_sys_estrutura @limpar=1, @listar=0;\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'r_individuo_dia' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[r_individuo_dia](\n\t\t\t [Data]\t\t\t\t\t\t\t\t[date]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t[date]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t[date]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Feriado]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Folga]\t\t\t\t\t\t\t[bit]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Abono]\t\t\t\t\t\t\t[bit]\t\t\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[Compensa\u00e7\u00e3o de Horas]\t\t\t\t[bit]\t\t\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[Falta Justificada]\t\t\t\t[bit]\t\t\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[Falta Injustificada]\t\t\t\t[bit]\t\t\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[Suspens\u00e3o]\t\t\t\t\t\t[bit]\t\t\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[Atestado]\t\t\t\t\t\t\t[bit]\t\t\tNULL\t\tDEFAULT NULL --ADD\n\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t[datetime2](0)\tNULL\t\tDEFAULT NULL\n\t\t\t,[ID Selecionar]\t\t\t\t\t[varchar](30)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Nome]\t\t\t\t\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Status]\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL\n\t\t\t\n\t\t\t,[DMA Inicial]\t\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor Inicial]\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\n\t\t\t,[Cliente]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Projeto]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Cargo]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tribo]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tribo Completa]\t\t\t\t\t[varchar](150)\tNOT NULL\tDEFAULT '--'\n\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Turno]\t\t\t\t\t\t\t[varchar](10)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Escala (Ponto)]\t\t\t\t\t[varchar](15)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Jornada (Ponto)]\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Trabalhado (Ponto)]\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Escala (MOP)]\t\t\t\t\t\t[varchar](15)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Jornada (Log)]\t\t\t\t\t[int]\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tipo de Jornada]\t\t\t\t\t[varchar](25)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Login]\t\t\t\t\t\t\t[time](0)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Logout]\t\t\t\t\t\t\t[time](0)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Log descartado (>2HE)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[HE]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log Produtivo]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log Improdutivo]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tempo Livre]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Particular (Intelix)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Break (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa 10 (Intelix)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Outbound (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Lanche (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa R\u00e1pida (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Feedback (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Interno (Intelix)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Externo (Intelix)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (Intelix)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Banheiro (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa NR17 (Intelix)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Tratativa (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Discagem Manual (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Banheiro (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa WhatsApp (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Intervalo (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Discagem Retorno (EPBX)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Feedback (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Transfer\u00eancia (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Login (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Interno (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Externo (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa NR17 (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Lanche (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa BackOffice (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Banheiro (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Descanso (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Feedback (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Backoffice (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Discagem Manual (Genesys)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Discagem Retorno (Genesys)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Em Fila (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Sistema Externo (Genesys)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Sistema Interno (Genesys)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Tratativa (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Criados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tratados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tempo Total de Tratativa]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[TMT]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Replicas]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Reincidentes 48h]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Reincidentes 30d]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t[decimal](16,2)\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t[decimal](16,2)\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t[decimal](16,2)\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t[decimal](16,2)\tNOT NULL\tDEFAULT 0\n\n\n\t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Promotoras]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Neutras]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Detratoras]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[NPS]\t\t\t\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\n\t\t\t,[\u00c9 A Tribo do MOP?]\t\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de MOP?]\t\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de Tickets?]\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de Chamadas?]\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de NPS?]\t\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t\t,[Teve Evento de Log?]\t\t[tinyint]\tNOT NULL\tDEFAULT 0\n\t\t) ON [PRIMARY]\n\tEND\n\n\t;WITH destino AS\n\t(\n\t\tSELECT * FROM [r_individuo_dia]\n\t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n\t\tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n\t)\n\tMERGE INTO destino USING \n\t(\n\t\tSELECT\n\t\t\t [Data]\t\t\t\t\t\t\t\t=\t[Data]\n\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t=\tMIN([Ciclo (Primeiro Dia)])\n\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t=\tMIN([M\u00eas (Primeiro Dia)])\n\t\t\t,[Feriado]\t\t\t\t\t\t\t=\tMIN([Feriado])\n\t\t\t,[Folga]\t\t\t\t\t\t\t=\tMAX(CAST([Folga] AS INT))\n\t\t\t,[Abono]\t\t\t\t\t\t\t=\tMAX(CAST([Abono] AS INT))\n\t\t\t,[Compensa\u00e7\u00e3o de Horas]\t\t\t\t=\tMAX(CAST([Compensa\u00e7\u00e3o de Horas] AS INT))\n\t\t\t,[Falta Justificada]\t\t\t\t=\tMAX(CAST([Falta Justificada] AS INT))\n\t\t\t,[Falta Injustificada]\t\t\t\t=\tMAX(CAST([Falta Injustificada] AS INT))\n\t\t\t,[Suspens\u00e3o]\t\t\t\t\t\t=\tMAX(CAST([Suspens\u00e3o] AS INT))\n\t\t\t,[Atestado]\t\t\t\t\t\t\t=\tMAX(CAST([Atestado] AS INT))\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tMIN([DataHora da Atualiza\u00e7\u00e3o do MOP])\n\t\t\t,[ID Selecionar]\t\t\t\t\t=\tMIN([ID Selecionar])\n\t\t\t,[Nome]\t\t\t\t\t\t\t\t=\tMIN([Nome])\n\t\t\t,[Status]\t\t\t\t\t\t\t=\tMIN([Status])\n\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([Situa\u00e7\u00e3o])\n\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([Condi\u00e7\u00e3o])\n\t\t\t\n\t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tMIN([DMA Inicial])\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tMIN([\u00daltima DMA Migra\u00e7\u00e3o])\n\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tMIN([\u00daltima DMA Geral])\n\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tMIN([Tipo da \u00daltima DMA])\n\t\t\t,[Instrutor Inicial]\t\t\t\t=\tMIN([Instrutor Inicial])\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tMIN([Instrutor \u00daltima Migra\u00e7\u00e3o])\n\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tMIN([Instrutor \u00daltima DMA])\n\n\t\t\t,[Cliente]\t\t\t\t\t\t\t=\tMIN([Cliente])\n\t\t\t,[Projeto]\t\t\t\t\t\t\t=\tMIN([Projeto])\n\t\t\t,[Cargo]\t\t\t\t\t\t\t=\tMIN([Cargo])\n\t\t\t,[Tribo]\t\t\t\t\t\t\t=\tMIN([Tribo])\n\t\t\t,[Tribo Completa]\t\t\t\t\t=\t[Tribo Completa]\n\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tMIN([Supervis\u00e3o])\n\t\t\t,[Turno]\t\t\t\t\t\t\t=\tMIN([Turno])\n\t\t\t,[Escala (Ponto)]\t\t\t\t\t=\tMIN([Escala (Ponto)])\n\t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tMIN([Jornada (Ponto)])\n\t\t\t,[Trabalhado (Ponto)]\t\t\t\t=\tSUM([Trabalhado (Ponto)])\n\t\t\t,[Em Pausa (Ponto)]\t\t\t\t\t=\tSUM([Em Pausa (Ponto)])\n\t\t\t,[Escala (MOP)]\t\t\t\t\t\t=\tMIN([Escala (MOP)])\n\t\t\t,[Jornada (Log)]\t\t\t\t\t=\tMIN([Jornada (Log)])\n\t\t\t,[Tipo de Jornada]\t\t\t\t\t=\t CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN(CAST([Folga] AS INT))\t\t\t\t\t\t\t\t\t\t\t= 1 THEN 'FOLGA'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Feriado]) IS NOT NULL\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FERIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Status]) = 'Treinamento'\t\t\t\t\t\t\t\t\t\t\tTHEN 'TREINAMENTO' \n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) = SUM([Log])\t\t\tTHEN 'OK'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Log]) = 0 AND IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) > 0\tTHEN 'FALTA'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) > SUM([Log])\t\t\tTHEN 'ABS'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo Completa] = [Tribo Completa], MAX([Jornada (Log)]), 0) < SUM([Log])\t\t\tTHEN 'HE'\n\t\t\t\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t,[Login]\t\t\t\t\t\t\t=\tMIN([Login])\n\t\t\t,[Logout]\t\t\t\t\t\t\t=\tMAX([Logout])\n\t\t\t,[Log descartado (>2HE)]\t\t\t=\tSUM([Log descartado (>2HE)])\n\t\t\t,[HE]\t\t\t\t\t\t\t\t=\tSUM([HE])\n\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM([Log])\n\t\t\t,[Log Produtivo]\t\t\t\t\t=\tSUM([Log Produtivo])\n\t\t \t,[Log Improdutivo]\t\t\t\t\t=\tSUM([Log Improdutivo])\n\t\t \t,[Tempo Livre]\t\t\t\t\t\t=\tSUM([Tempo Livre])\n\t\t \t,[Pausa Particular (Intelix)]\t\t=\tSUM([Pausa Particular (Intelix)])\n\t\t \t,[Pausa Break (Intelix)]\t\t\t=\tSUM([Pausa Break (Intelix)])\n\t\t \t,[Pausa 10 (Intelix)]\t\t\t\t=\tSUM([Pausa 10 (Intelix)])\n\t\t \t,[Pausa Outbound (Intelix)]\t\t\t=\tSUM([Pausa Outbound (Intelix)])\n\t\t  \t,[Pausa Lanche (Intelix)]\t\t\t=\tSUM([Pausa Lanche (Intelix)])\n\t\t  \t,[Pausa R\u00e1pida (Intelix)]\t\t\t=\tSUM([Pausa R\u00e1pida (Intelix)])\n\t\t  \t,[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Intelix)])\n\t\t  \t,[Pausa Feedback (Intelix)]\t\t\t=\tSUM([Pausa Feedback (Intelix)])\n\t\t  \t,[Pausa Sistema Interno (Intelix)]\t=\tSUM([Pausa Sistema Interno (Intelix)])\n\t\t  \t,[Pausa Sistema Externo (Intelix)]\t=\tSUM([Pausa Sistema Externo (Intelix)])\n\t\t  \t,[Pausa Treinamento (Intelix)]\t\t=\tSUM([Pausa Treinamento (Intelix)])\n\t\t  \t,[Pausa Banheiro (Intelix)]\t\t\t=\tSUM([Pausa Banheiro (Intelix)])\n\t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tSUM([Pausa Reuni\u00e3o (Intelix)])\n\t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Intelix)])\n\t\t  \t,[Pausa NR17 (Intelix)]\t\t\t\t=\tSUM([Pausa NR17 (Intelix)])\n\t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Liga\u00e7\u00e3o (EPBX)])\n\t\t  \t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tSUM([Pausa Almo\u00e7o (EPBX)])\n\t\t  \t,[Pausa Tratativa (EPBX)]\t\t\t=\tSUM([Pausa Tratativa (EPBX)])\n\t\t  \t,[Pausa Discagem Manual (EPBX)]\t\t=\tSUM([Pausa Discagem Manual (EPBX)])\n\t\t  \t,[Pausa Banheiro (EPBX)]\t\t\t=\tSUM([Pausa Banheiro (EPBX)])\n\t\t  \t,[Pausa WhatsApp (EPBX)]\t\t\t=\tSUM([Pausa WhatsApp (EPBX)])\n\t\t  \t,[Pausa Intervalo (EPBX)]\t\t\t=\tSUM([Pausa Intervalo (EPBX)])\n\t\t  \t,[Pausa Discagem Retorno (EPBX)]\t=\tSUM([Pausa Discagem Retorno (EPBX)])\n\t\t  \t,[Pausa Treinamento (EPBX)]\t\t\t=\tSUM([Pausa Treinamento (EPBX)])\n\t\t  \t,[Pausa Feedback (EPBX)]\t\t\t=\tSUM([Pausa Feedback (EPBX)])\n\t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\t\t=\tSUM([Pausa Transfer\u00eancia (EPBX)])\n\t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tSUM([Pausa N\u00e3o Disponivel (EPBX)])\n\t\t  \t,[Pausa Login (EPBX)]\t\t\t\t=\tSUM([Pausa Login (EPBX)])\n\t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Reuni\u00e3o (EPBX)])\n\t\t  \t,[Pausa Sistema Interno (EPBX)]\t\t=\tSUM([Pausa Sistema Interno (EPBX)])\n\t\t  \t,[Pausa Sistema Externo (EPBX)]\t\t=\tSUM([Pausa Sistema Externo (EPBX)])\n\t\t  \t,[Pausa NR17 (EPBX)]\t\t\t\t=\tSUM([Pausa NR17 (EPBX)])\n\t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tSUM([Pausa Ambulat\u00f3rio (EPBX)])\n\t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tSUM([Pausa P\u00f3s Atendimento (EPBX)])\n\t\t  \t,[Pausa Lanche (EPBX)]\t\t\t\t=\tSUM([Pausa Lanche (EPBX)])\n\t\t  \t,[Pausa BackOffice (EPBX)]\t\t\t=\tSUM([Pausa BackOffice (EPBX)])\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Genesys)])\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Genesys)])\n\t\t \t,[Pausa Banheiro (Genesys)]\t\t\t=\tSUM([Pausa Banheiro (Genesys)])\n\t\t \t,[Pausa Descanso (Genesys)]\t\t\t=\tSUM([Pausa Descanso (Genesys)])\n\t\t \t,[Pausa Feedback (Genesys)]\t\t\t=\tSUM([Pausa Feedback (Genesys)])\n\t\t \t,[Pausa Backoffice (Genesys)]\t\t=\tSUM([Pausa Backoffice (Genesys)])\n\t\t \t,[Pausa Discagem Manual (Genesys)]\t=\tSUM([Pausa Discagem Manual (Genesys)])\n\t\t \t,[Pausa Discagem Retorno (Genesys)]\t=\tSUM([Pausa Discagem Retorno (Genesys)])\n\t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tSUM([Pausa Dispon\u00edvel (Genesys)])\n\t\t \t,[Pausa Em Fila (Genesys)]\t\t\t=\tSUM([Pausa Em Fila (Genesys)])\n\t\t \t,[Pausa Sistema Externo (Genesys)]\t=\tSUM([Pausa Sistema Externo (Genesys)])\n\t\t \t,[Pausa Sistema Interno (Genesys)]\t=\tSUM([Pausa Sistema Interno (Genesys)])\n\t\t \t,[Pausa Tratativa (Genesys)]\t\t=\tSUM([Pausa Tratativa (Genesys)])\n\t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t=\tSUM([Pausa Whatsapp (Genesys)])\n\t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tSUM([Pausa Treinamento (Genesys)])\n\t\t\t\n\t\t\t,[Criados]\t\t\t\t\t\t\t=\tSUM([Criados])\n\t\t\t,[Tratados]\t\t\t\t\t\t\t=\tSUM([Tratados])\n\t\t\t,[Tempo Total de Tratativa]\t\t\t=\tSUM([Tempo Total de Tratativa])\n\t\t\t,[TMT]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n\t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t=\tSUM([N\u00e3o Resolvidos])\n\t\t\t,[Replicas]\t\t\t\t\t\t\t=\tSUM([Replicas])\n\t\t\t,[Reincidentes 48h]\t\t\t\t\t=\tSUM([Reincidentes 48h])\n\t\t\t,[Reincidentes 30d]\t\t\t\t\t=\tSUM([Reincidentes 30d])\n\t\t\t\n\t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Iniciadas])\n\t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas])\n\t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])\n\t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Em Andamento])\n\t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Finalizadas])\n\t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Transferidas])\n\t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Chamada (Independente do Intervalo)])\n\t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)])\n\t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Espera (Independente do Intervalo)])\n\t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)])\n\t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Chamada (Neste Intervalo)])\n\t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM([Inbound - Tempo Em Atendimento (Neste Intervalo)])\n\t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Espera (Neste Intervalo)])\n\t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Inbound - Tempo Em Encerramento (Neste Intervalo)])\n\t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Iniciados])\n\t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Em Andamento])\n\t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Finalizados])\n\t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n\t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n\t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Abandonadas])\n\t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\t\t\t\n\t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Iniciadas])\n\t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas])\n\t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])\n\t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Em Andamento])\n\t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Finalizadas])\n\t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Transferidas])\n\t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Chamada (Independente do Intervalo)])\n\t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)])\n\t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Espera (Independente do Intervalo)])\n\t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)])\n\t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM([Outbound - Tempo Em Chamada (Neste Intervalo)])\n\t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Atendimento (Neste Intervalo)])\n\t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Outbound - Tempo Em Espera (Neste Intervalo)])\n\t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Encerramento (Neste Intervalo)])\n\t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Iniciados])\n\t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Em Andamento])\n\t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Finalizados])\n\t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n\t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n\t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Abandonadas])\n\t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\t\t\t\n\t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t=\tSUM([Avalia\u00e7\u00f5es de NPS])\n\t\t\t,[Promotoras]\t\t\t\t\t\t=\tSUM([Promotoras]) \n\t\t\t,[Neutras]\t\t\t\t\t\t\t= \tSUM([Neutras])\n\t\t\t,[Detratoras]\t\t\t\t\t\t= \tSUM([Detratoras])\n\t\t\t,[NPS]\t\t\t\t\t\t\t\t=\tCAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(16,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\t\t\t\t\t\n\t\t\t,[\u00c9 A Tribo do MOP?]\t\t\t\t= \tIIF(SUM([\u00c9 A Tribo do MOP?])=0,0,1)\n\t\t\t,[Teve Evento de MOP?]\t\t\t\t= \tIIF(SUM([Teve Evento de MOP?])=0,0,1)\n\t\t\t,[Teve Evento de Tickets?]\t\t\t= \tIIF(SUM([Teve Evento de Tickets?])=0,0,1)\n\t\t\t,[Teve Evento de Chamadas?]\t\t\t= \tIIF(SUM([Teve Evento de Chamadas?])=0,0,1)\n\t\t\t,[Teve Evento de NPS?]\t\t\t\t= \tIIF(SUM([Teve Evento de NPS?])=0,0,1)\n\t\t\t,[Teve Evento de Log?]\t\t\t\t= \tIIF(SUM([Teve Evento de Log?])=0,0,1)\n\n\t\tFROM r_individuo_30min\n\t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n\t\tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n\t\tGROUP BY [Data], [ID Selecionar], [Tribo Completa]\n\t) AS fonte\n\tON  fonte.[Data]  = destino.[Data]\n\tAND COALESCE(fonte.[ID Selecionar], '-')\t= COALESCE(destino.[ID Selecionar], '-')\n\tAND fonte.[Tribo Completa] = destino.[Tribo Completa]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT \n\t\t(\n\t\t\t [Data]\n\t\t\t,[Ciclo (Primeiro Dia)]\n\t\t\t,[M\u00eas (Primeiro Dia)]\n\t\t\t,[Feriado]\n\t\t\t,[Folga]\n\t\t\t,[Abono]\t\t\t\t\t\t\t\n\t\t\t,[Compensa\u00e7\u00e3o de Horas]\t\t\t\t\n\t\t\t,[Falta Justificada]\t\t\t\t\n\t\t\t,[Falta Injustificada]\t\t\t\t\n\t\t\t,[Suspens\u00e3o]\t\t\t\t\t\t\n\t\t\t,[Atestado]\t\t\t\t\t\t\t\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,[ID Selecionar]\n\t\t\t,[Nome]\n\t\t\t,[Status]\n\t\t\t,[Situa\u00e7\u00e3o]\n\t\t\t,[Condi\u00e7\u00e3o]\n\t\t\t\n\t\t\t,[DMA Inicial]\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,[\u00daltima DMA Geral]\n\t\t\t,[Tipo da \u00daltima DMA]\n\t\t\t,[Instrutor Inicial]\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,[Instrutor \u00daltima DMA]\n\n\t\t\t,[Cliente]\n\t\t\t,[Projeto]\n\t\t\t,[Cargo]\n\t\t\t,[Tribo]\n\t\t\t,[Tribo Completa]\n\t\t\t,[Supervis\u00e3o]\n\t\t\t,[Turno]\n\t\t\t,[Escala (Ponto)]\n\t\t\t,[Jornada (Ponto)]\n\t\t\t,[Trabalhado (Ponto)]\n\t\t\t,[Em Pausa (Ponto)]\n\t\t\t,[Escala (MOP)]\n\t\t\t,[Jornada (Log)]\n\t\t\t,[Tipo de Jornada]\n\t\t\t,[Login]\n\t\t\t,[Logout]\n\t\t\t,[Log descartado (>2HE)]\n\t\t\t,[HE]\n\t\t\t,[Log]\n\t\t\t,[Log Produtivo]\n\t\t \t,[Log Improdutivo]\n\t\t \t,[Tempo Livre]\n\t\t \t,[Pausa Particular (Intelix)]\n\t\t \t,[Pausa Break (Intelix)]\n\t\t \t,[Pausa 10 (Intelix)]\n\t\t \t,[Pausa Outbound (Intelix)]\n\t\t  \t,[Pausa Lanche (Intelix)]\n\t\t  \t,[Pausa R\u00e1pida (Intelix)]\n\t\t  \t,[Pausa Almo\u00e7o (Intelix)]\n\t\t  \t,[Pausa Feedback (Intelix)]\n\t\t  \t,[Pausa Sistema Interno (Intelix)]\n\t\t  \t,[Pausa Sistema Externo (Intelix)]\n\t\t  \t,[Pausa Treinamento (Intelix)]\n\t\t  \t,[Pausa Banheiro (Intelix)]\n\t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\n\t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t  \t,[Pausa NR17 (Intelix)]\n\t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t  \t,[Pausa Almo\u00e7o (EPBX)]\n\t\t  \t,[Pausa Tratativa (EPBX)]\n\t\t  \t,[Pausa Discagem Manual (EPBX)]\n\t\t  \t,[Pausa Banheiro (EPBX)]\n\t\t  \t,[Pausa WhatsApp (EPBX)]\n\t\t  \t,[Pausa Intervalo (EPBX)]\n\t\t  \t,[Pausa Discagem Retorno (EPBX)]\n\t\t  \t,[Pausa Treinamento (EPBX)]\n\t\t  \t,[Pausa Feedback (EPBX)]\n\t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\n\t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t  \t,[Pausa Login (EPBX)]\n\t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\n\t\t  \t,[Pausa Sistema Interno (EPBX)]\n\t\t  \t,[Pausa Sistema Externo (EPBX)]\n\t\t  \t,[Pausa NR17 (EPBX)]\n\t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t  \t,[Pausa Lanche (EPBX)]\n\t\t  \t,[Pausa BackOffice (EPBX)]\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t \t,[Pausa Banheiro (Genesys)]\n\t\t \t,[Pausa Descanso (Genesys)]\n\t\t \t,[Pausa Feedback (Genesys)]\n\t\t \t,[Pausa Backoffice (Genesys)]\n\t\t \t,[Pausa Discagem Manual (Genesys)]\n\t\t \t,[Pausa Discagem Retorno (Genesys)]\n\t\t \t,[Pausa Dispon\u00edvel (Genesys)]\n\t\t \t,[Pausa Em Fila (Genesys)]\n\t\t \t,[Pausa Sistema Externo (Genesys)]\n\t\t \t,[Pausa Sistema Interno (Genesys)]\n\t\t \t,[Pausa Tratativa (Genesys)]\n\t\t \t,[Pausa Whatsapp (Genesys)]\n\t\t\t,[Pausa Treinamento (Genesys)]\n\n\t\t\t,[Criados]\n\t\t\t,[Tratados]\n\t\t\t,[Tempo Total de Tratativa]\n\t\t\t,[TMT]\n\t\t\t,[N\u00e3o Resolvidos]\n\t\t\t,[Replicas]\n\t\t\t,[Reincidentes 48h]\n\t\t\t,[Reincidentes 30d]\n\t\t\t\n\t\t\t\n\t\t,[Inbound - Chamadas Iniciadas]\n\t\t,[Inbound - Chamadas Atendidas]\n\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,[Inbound - Chamadas Em Andamento]\n\t\t,[Inbound - Chamadas Finalizadas]\n\t\t,[Inbound - Chamadas Transferidas]\n\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,[Inbound - Atendimentos Iniciados]\n\t\t,[Inbound - Atendimentos Em Andamento]\n\t\t,[Inbound - Atendimentos Finalizados]\n\t\t,[Inbound - TMC]\n\t\t,[Inbound - TMA]\n\t\t,[Inbound - TME]\n\t\t,[Inbound - TMO]\n\t\t,[Inbound - % Nivel de Servi\u00e7o]\n\t\t,[Inbound - Chamadas Abandonadas]\n\t\t,[Inbound - % Abandono]\n\n\t\t,[Outbound - Chamadas Iniciadas]\n\t\t,[Outbound - Chamadas Atendidas]\n\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,[Outbound - Chamadas Em Andamento]\n\t\t,[Outbound - Chamadas Finalizadas]\n\t\t,[Outbound - Chamadas Transferidas]\n\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,[Outbound - Atendimentos Iniciados]\n\t\t,[Outbound - Atendimentos Em Andamento]\n\t\t,[Outbound - Atendimentos Finalizados]\n\t\t,[Outbound - TMC]\n\t\t,[Outbound - TMA]\n\t\t,[Outbound - TME]\n\t\t,[Outbound - TMO]\n\t\t,[Outbound - % Nivel de Servi\u00e7o]\n\t\t,[Outbound - Chamadas Abandonadas]\n\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\n\n\n\t\t\t,[Avalia\u00e7\u00f5es de NPS]\n\t\t\t,[Promotoras]\n\t\t\t,[Neutras]\n\t\t\t,[Detratoras]\n\t\t\t,[NPS]\n\n\t\t\t,[\u00c9 A Tribo do MOP?]\n\t\t\t,[Teve Evento de MOP?]\n\t\t\t,[Teve Evento de Tickets?]\n\t\t\t,[Teve Evento de Chamadas?]\n\t\t\t,[Teve Evento de NPS?]\n\t\t\t,[Teve Evento de Log?]\n\t\t)\n\t\tVALUES \n\t\t(\n\t\t\t fonte.[Data]\n\t\t\t,fonte.[Ciclo (Primeiro Dia)]\n\t\t\t,fonte.[M\u00eas (Primeiro Dia)]\n\t\t\t,fonte.[Feriado]\n\t\t\t,fonte.[Folga]\n\t\t\t,fonte.[Abono]\t\t\t\t\t\t\t\n\t\t\t,fonte.[Compensa\u00e7\u00e3o de Horas]\t\t\t\t\n\t\t\t,fonte.[Falta Justificada]\t\t\t\t\n\t\t\t,fonte.[Falta Injustificada]\t\t\t\t\n\t\t\t,fonte.[Suspens\u00e3o]\t\t\t\t\t\t\n\t\t\t,fonte.[Atestado]\t\t\t\t\t\t\t\n\t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,fonte.[ID Selecionar]\n\t\t\t,fonte.[Nome]\n\t\t\t,fonte.[Status]\n\t\t\t,fonte.[Situa\u00e7\u00e3o]\n\t\t\t,fonte.[Condi\u00e7\u00e3o]\n\t\t\t\n\t\t\t,fonte.[DMA Inicial]\n\t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,fonte.[\u00daltima DMA Geral]\n\t\t\t,fonte.[Tipo da \u00daltima DMA]\n\t\t\t,fonte.[Instrutor Inicial]\n\t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,fonte.[Instrutor \u00daltima DMA]\n\n\t\t\t,fonte.[Cliente]\n\t\t\t,fonte.[Projeto]\n\t\t\t,fonte.[Cargo]\n\t\t\t,fonte.[Tribo]\n\t\t\t,fonte.[Tribo Completa]\n\t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t,fonte.[Turno]\n\t\t\t,fonte.[Escala (Ponto)]\n\t\t\t,fonte.[Jornada (Ponto)]\n\t\t\t,fonte.[Trabalhado (Ponto)]\n\t\t\t,fonte.[Em Pausa (Ponto)]\n\t\t\t,fonte.[Escala (MOP)]\n\t\t\t,fonte.[Jornada (Log)]\n\t\t\t,fonte.[Tipo de Jornada]\n\t\t\t,fonte.[Login]\n\t\t\t,fonte.[Logout]\n\t\t\t,fonte.[Log descartado (>2HE)]\n\t\t\t,fonte.[HE]\n\t\t\t,fonte.[Log]\n\t\t\t,fonte.[Log Produtivo]\n\t\t \t,fonte.[Log Improdutivo]\n\t\t \t,fonte.[Tempo Livre]\n\t\t \t,fonte.[Pausa Particular (Intelix)]\n\t\t \t,fonte.[Pausa Break (Intelix)]\n\t\t \t,fonte.[Pausa 10 (Intelix)]\n\t\t \t,fonte.[Pausa Outbound (Intelix)]\n\t\t  \t,fonte.[Pausa Lanche (Intelix)]\n\t\t  \t,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t  \t,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t  \t,fonte.[Pausa Feedback (Intelix)]\n\t\t  \t,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t  \t,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t  \t,fonte.[Pausa Treinamento (Intelix)]\n\t\t  \t,fonte.[Pausa Banheiro (Intelix)]\n\t\t  \t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t  \t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t  \t,fonte.[Pausa NR17 (Intelix)]\n\t\t  \t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t  \t,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t  \t,fonte.[Pausa Tratativa (EPBX)]\n\t\t  \t,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t  \t,fonte.[Pausa Banheiro (EPBX)]\n\t\t  \t,fonte.[Pausa WhatsApp (EPBX)]\n\t\t  \t,fonte.[Pausa Intervalo (EPBX)]\n\t\t  \t,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t  \t,fonte.[Pausa Treinamento (EPBX)]\n\t\t  \t,fonte.[Pausa Feedback (EPBX)]\n\t\t  \t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t  \t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t  \t,fonte.[Pausa Login (EPBX)]\n\t\t  \t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t  \t,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t  \t,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t  \t,fonte.[Pausa NR17 (EPBX)]\n\t\t  \t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t  \t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t  \t,fonte.[Pausa Lanche (EPBX)]\n\t\t  \t,fonte.[Pausa BackOffice (EPBX)]\n\t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t \t,fonte.[Pausa Banheiro (Genesys)]\n\t\t \t,fonte.[Pausa Descanso (Genesys)]\n\t\t \t,fonte.[Pausa Feedback (Genesys)]\n\t\t \t,fonte.[Pausa Backoffice (Genesys)]\n\t\t \t,fonte.[Pausa Discagem Manual (Genesys)]\n\t\t \t,fonte.[Pausa Discagem Retorno (Genesys)]\n\t\t \t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t\t \t,fonte.[Pausa Em Fila (Genesys)]\n\t\t \t,fonte.[Pausa Sistema Externo (Genesys)]\n\t\t \t,fonte.[Pausa Sistema Interno (Genesys)]\n\t\t \t,fonte.[Pausa Tratativa (Genesys)]\n\t\t \t,fonte.[Pausa Whatsapp (Genesys)]\n\t\t\t,fonte.[Pausa Treinamento (Genesys)]\n\n\t\t\t,fonte.[Criados]\n\t\t\t,fonte.[Tratados]\n\t\t\t,fonte.[Tempo Total de Tratativa]\n\t\t\t,fonte.[TMT]\n\t\t\t,fonte.[N\u00e3o Resolvidos]\n\t\t\t,fonte.[Replicas]\n\t\t\t,fonte.[Reincidentes 48h]\n\t\t\t,fonte.[Reincidentes 30d]\n\t\t\t\t\t\n\t\t,fonte.[Inbound - Chamadas Iniciadas]\n\t\t,fonte.[Inbound - Chamadas Atendidas]\n\t\t,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,fonte.[Inbound - Chamadas Em Andamento]\n\t\t,fonte.[Inbound - Chamadas Finalizadas]\n\t\t,fonte.[Inbound - Chamadas Transferidas]\n\t\t,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,fonte.[Inbound - Atendimentos Iniciados]\n\t\t,fonte.[Inbound - Atendimentos Em Andamento]\n\t\t,fonte.[Inbound - Atendimentos Finalizados]\n\t\t,fonte.[Inbound - TMC]\n\t\t,fonte.[Inbound - TMA]\n\t\t,fonte.[Inbound - TME]\n\t\t,fonte.[Inbound - TMO]\n\t\t,fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t,fonte.[Inbound - Chamadas Abandonadas]\n\t\t,fonte.[Inbound - % Abandono]\n\n\t\t,fonte.[Outbound - Chamadas Iniciadas]\n\t\t,fonte.[Outbound - Chamadas Atendidas]\n\t\t,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,fonte.[Outbound - Chamadas Em Andamento]\n\t\t,fonte.[Outbound - Chamadas Finalizadas]\n\t\t,fonte.[Outbound - Chamadas Transferidas]\n\t\t,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,fonte.[Outbound - Atendimentos Iniciados]\n\t\t,fonte.[Outbound - Atendimentos Em Andamento]\n\t\t,fonte.[Outbound - Atendimentos Finalizados]\n\t\t,fonte.[Outbound - TMC]\n\t\t,fonte.[Outbound - TMA]\n\t\t,fonte.[Outbound - TME]\n\t\t,fonte.[Outbound - TMO]\n\t\t,fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t,fonte.[Outbound - Chamadas Abandonadas]\n\t\t,fonte.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\n\n\t\t,fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t,fonte.[Promotoras]\n\t\t,fonte.[Neutras]\n\t\t,fonte.[Detratoras]\n\t\t,fonte.[NPS]\n\t\t\t\n\t\t,fonte.[\u00c9 A Tribo do MOP?]\n\t\t,fonte.[Teve Evento de MOP?]\n\t\t,fonte.[Teve Evento de Tickets?]\n\t\t,fonte.[Teve Evento de Chamadas?]\n\t\t,fonte.[Teve Evento de NPS?]\n\t\t,fonte.[Teve Evento de Log?]\n\t\t)\n\n\tWHEN MATCHED THEN \n\t\tUPDATE SET\n\t\t\t destino.[Data]\t\t\t\t\t\t\t\t= fonte.[Data]\n\t\t\t,destino.[Ciclo (Primeiro Dia)]\t\t\t\t= fonte.[Ciclo (Primeiro Dia)]\n\t\t\t,destino.[M\u00eas (Primeiro Dia)]\t\t\t\t= fonte.[M\u00eas (Primeiro Dia)]\n\t\t\t,destino.[Feriado]\t\t\t\t\t\t\t= fonte.[Feriado]\n\t\t\t,destino.[Folga]\t\t\t\t\t\t\t= fonte.[Folga]\n\t\t\t,destino.[Abono]\t\t\t\t\t\t\t= fonte.[Abono]\n\t\t\t,destino.[Compensa\u00e7\u00e3o de Horas]\t\t\t\t= fonte.[Compensa\u00e7\u00e3o de Horas]\n\t\t\t,destino.[Falta Justificada]\t\t\t\t= fonte.[Falta Justificada]\n\t\t\t,destino.[Falta Injustificada]\t\t\t\t= fonte.[Falta Injustificada]\n\t\t\t,destino.[Suspens\u00e3o]\t\t\t\t\t\t= fonte.[Suspens\u00e3o]\n\t\t\t,destino.[Atestado]\t\t\t\t\t\t\t= fonte.[Atestado]\n\t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t= fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,destino.[ID Selecionar]\t\t\t\t\t= fonte.[ID Selecionar]\n\t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t= fonte.[Nome]\n\t\t\t,destino.[Status]\t\t\t\t\t\t\t= fonte.[Status]\n\t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Situa\u00e7\u00e3o]\n\t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Condi\u00e7\u00e3o]\n\t\t\t\n\t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t= fonte.[DMA Inicial]\n\t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t= fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t= fonte.[\u00daltima DMA Geral]\n\t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t= fonte.[Tipo da \u00daltima DMA]\n\t\t\t,destino.[Instrutor Inicial]\t\t\t\t= fonte.[Instrutor Inicial]\n\t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t= fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t= fonte.[Instrutor \u00daltima DMA]\n\n\t\t\t,destino.[Cliente]\t\t\t\t\t\t\t= fonte.[Cliente]\n\t\t\t,destino.[Projeto]\t\t\t\t\t\t\t= fonte.[Projeto]\n\t\t\t,destino.[Cargo]\t\t\t\t\t\t\t= fonte.[Cargo]\n\t\t\t,destino.[Tribo]\t\t\t\t\t\t\t= fonte.[Tribo]\n\t\t\t,destino.[Tribo Completa]\t\t\t\t\t= fonte.[Tribo Completa]\n\t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t= fonte.[Supervis\u00e3o]\n\t\t\t,destino.[Turno]\t\t\t\t\t\t\t= fonte.[Turno]\n\t\t\t,destino.[Escala (Ponto)]\t\t\t\t\t= fonte.[Escala (Ponto)]\n\t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t= fonte.[Jornada (Ponto)]\n\t\t\t,destino.[Trabalhado (Ponto)]\t\t\t\t= fonte.[Trabalhado (Ponto)]\n\t\t\t,destino.[Em Pausa (Ponto)]\t\t\t\t\t= fonte.[Em Pausa (Ponto)]\n\t\t\t,destino.[Escala (MOP)]\t\t\t\t\t\t= fonte.[Escala (MOP)]\n\t\t\t,destino.[Jornada (Log)]\t\t\t\t\t= fonte.[Jornada (Log)]\n\t\t\t,destino.[Tipo de Jornada]\t\t\t\t\t= fonte.[Tipo de Jornada]\n\t\t\t,destino.[Login]\t\t\t\t\t\t\t= fonte.[Login]\n\t\t\t,destino.[Logout]\t\t\t\t\t\t\t= fonte.[Logout]\n\t\t\t,destino.[Log descartado (>2HE)]\t\t\t= fonte.[Log descartado (>2HE)]\n\t\t\t,destino.[HE]\t\t\t\t\t\t\t\t= fonte.[HE]\n\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t= fonte.[Log]\n\t\t\t,destino.[Log Produtivo]\t\t\t\t\t= fonte.[Log Produtivo]\n\t\t \t,destino.[Log Improdutivo]\t\t\t\t\t= fonte.[Log Improdutivo]\n\t\t \t,destino.[Tempo Livre]\t\t\t\t\t\t= fonte.[Tempo Livre]\n\t\t \t,destino.[Pausa Particular (Intelix)]\t\t= fonte.[Pausa Particular (Intelix)]\n\t\t \t,destino.[Pausa Break (Intelix)]\t\t\t= fonte.[Pausa Break (Intelix)]\n\t\t \t,destino.[Pausa 10 (Intelix)]\t\t\t\t= fonte.[Pausa 10 (Intelix)]\n\t\t \t,destino.[Pausa Outbound (Intelix)]\t\t\t= fonte.[Pausa Outbound (Intelix)]\n\t\t  \t,destino.[Pausa Lanche (Intelix)]\t\t\t= fonte.[Pausa Lanche (Intelix)]\n\t\t  \t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t= fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t  \t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t= fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t  \t,destino.[Pausa Feedback (Intelix)]\t\t\t= fonte.[Pausa Feedback (Intelix)]\n\t\t  \t,destino.[Pausa Sistema Interno (Intelix)]\t= fonte.[Pausa Sistema Interno (Intelix)]\n\t\t  \t,destino.[Pausa Sistema Externo (Intelix)]\t= fonte.[Pausa Sistema Externo (Intelix)]\n\t\t  \t,destino.[Pausa Treinamento (Intelix)]\t\t= fonte.[Pausa Treinamento (Intelix)]\n\t\t  \t,destino.[Pausa Banheiro (Intelix)]\t\t\t= fonte.[Pausa Banheiro (Intelix)]\n\t\t  \t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t= fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t  \t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t  \t,destino.[Pausa NR17 (Intelix)]\t\t\t\t= fonte.[Pausa NR17 (Intelix)]\n\t\t  \t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t  \t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t= fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t  \t,destino.[Pausa Tratativa (EPBX)]\t\t\t= fonte.[Pausa Tratativa (EPBX)]\n\t\t  \t,destino.[Pausa Discagem Manual (EPBX)]\t\t= fonte.[Pausa Discagem Manual (EPBX)]\n\t\t  \t,destino.[Pausa Banheiro (EPBX)]\t\t\t= fonte.[Pausa Banheiro (EPBX)]\n\t\t  \t,destino.[Pausa WhatsApp (EPBX)]\t\t\t= fonte.[Pausa WhatsApp (EPBX)]\n\t\t  \t,destino.[Pausa Intervalo (EPBX)]\t\t\t= fonte.[Pausa Intervalo (EPBX)]\n\t\t  \t,destino.[Pausa Discagem Retorno (EPBX)]\t= fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t  \t,destino.[Pausa Treinamento (EPBX)]\t\t\t= fonte.[Pausa Treinamento (EPBX)]\n\t\t  \t,destino.[Pausa Feedback (EPBX)]\t\t\t= fonte.[Pausa Feedback (EPBX)]\n\t\t  \t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t= fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t  \t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t= fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t  \t,destino.[Pausa Login (EPBX)]\t\t\t\t= fonte.[Pausa Login (EPBX)]\n\t\t  \t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t  \t,destino.[Pausa Sistema Interno (EPBX)]\t\t= fonte.[Pausa Sistema Interno (EPBX)]\n\t\t  \t,destino.[Pausa Sistema Externo (EPBX)]\t\t= fonte.[Pausa Sistema Externo (EPBX)]\n\t\t  \t,destino.[Pausa NR17 (EPBX)]\t\t\t\t= fonte.[Pausa NR17 (EPBX)]\n\t\t  \t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t= fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t  \t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t= fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t  \t,destino.[Pausa Lanche (EPBX)]\t\t\t\t= fonte.[Pausa Lanche (EPBX)]\n\t\t  \t,destino.[Pausa BackOffice (EPBX)]\t\t\t= fonte.[Pausa BackOffice (EPBX)]\n\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t= fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t= fonte.[Pausa Banheiro (Genesys)]\n\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t= fonte.[Pausa Descanso (Genesys)]\n\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t= fonte.[Pausa Feedback (Genesys)]\n\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t= fonte.[Pausa Backoffice (Genesys)]\n\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t= fonte.[Pausa Discagem Manual (Genesys)]\n\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t= fonte.[Pausa Discagem Retorno (Genesys)]\n\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t= fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t= fonte.[Pausa Em Fila (Genesys)]\n\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t= fonte.[Pausa Sistema Externo (Genesys)]\n\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t= fonte.[Pausa Sistema Interno (Genesys)]\n\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t= fonte.[Pausa Tratativa (Genesys)]\n\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t= fonte.[Pausa Whatsapp (Genesys)]\n\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t= fonte.[Pausa Treinamento (Genesys)]\n\n\t\t\t,destino.[Criados]\t\t\t\t\t\t\t= fonte.[Criados]\n\t\t\t,destino.[Tratados]\t\t\t\t\t\t\t= fonte.[Tratados]\n\t\t\t,destino.[Tempo Total de Tratativa]\t\t\t= fonte.[Tempo Total de Tratativa]\n\t\t\t,destino.[TMT]\t\t\t\t\t\t\t\t= fonte.[TMT]\n\t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t\t\t= fonte.[N\u00e3o Resolvidos]\n\t\t\t,destino.[Replicas]\t\t\t\t\t\t\t= fonte.[Replicas]\n\t\t\t,destino.[Reincidentes 48h]\t\t\t\t\t= fonte.[Reincidentes 48h]\n\t\t\t,destino.[Reincidentes 30d]\t\t\t\t\t= fonte.[Reincidentes 30d]\n\t\t\t\n\t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Iniciadas]\n\t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas]\n\t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Em Andamento]\n\t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Finalizadas]\n\t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Transferidas]\n\t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Iniciados]\n\t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Em Andamento]\n\t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Finalizados]\n\t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMC]\n\t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMA]\n\t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TME]\n\t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMO]\n\t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Abandonadas]\n\t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Abandono]\n\t\t\t\n\t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Iniciadas]\n\t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas]\n\t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Em Andamento]\n\t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Finalizadas]\n\t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Transferidas]\n\t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Iniciados]\n\t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Em Andamento]\n\t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Finalizados]\n\t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMC]\n\t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMA]\n\t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TME]\n\t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMO]\n\t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Abandonadas]\n\t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - % Abandono]\n\n\n\t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t= fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t\t,destino.[Promotoras]\t\t\t\t\t\t= fonte.[Promotoras]\n\t\t\t,destino.[Neutras]\t\t\t\t\t\t\t= fonte.[Neutras]\n\t\t\t,destino.[Detratoras]\t\t\t\t\t\t= fonte.[Detratoras]\n\t\t\t,destino.[NPS]\t\t\t\t\t\t\t\t= fonte.[NPS]\n\t\t\t\n\t\t\t,destino.[\u00c9 A Tribo do MOP?]\t\t\t\t= fonte.[\u00c9 A Tribo do MOP?]\n\t\t\t,destino.[Teve Evento de MOP?]\t\t\t\t= fonte.[Teve Evento de MOP?]\n\t\t\t,destino.[Teve Evento de Tickets?]\t\t\t= fonte.[Teve Evento de Tickets?]\n\t\t\t,destino.[Teve Evento de Chamadas?]\t\t\t= fonte.[Teve Evento de Chamadas?]\n\t\t\t,destino.[Teve Evento de NPS?]\t\t\t\t= fonte.[Teve Evento de NPS?]\n\t\t\t,destino.[Teve Evento de Log?]\t\t\t\t= fonte.[Teve Evento de Log?]\n\t\t\t\n\n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\n\t\n\tSET @msg = CONCAT('#--> Etapa conclu\u00edda em ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio_etapa, GETDATE()), 0) as time(0)))--,' (',CAST(@t_inicio_etapa AS TIME),' a ',CAST(GETDATE() AS TIME), ')')\n\tRAISERROR(@msg, 0, 1) WITH NOWAIT;\n\tCOMMIT TRANSACTION tran_dia;\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nSELECT [Retorno]=CONCAT('Resumos atualizados (m\u00e9trica: ',@metrica,') ',@datahora_inicio,' - ',@datahora_fim, ' (dura\u00e7\u00e3o: ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio, GETDATE()), 0) as time(0)),')')\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\n\n\n\n*/\n\n\nGO\n",
        "build_order": 322,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "UNKNOWN",
                "r_individuo_30min"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": [
                "SELECT",
                "SELECT * FROM [r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "UNKNOWN",
                "r_individuo_30min"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": [
                "SELECT",
                "SELECT * FROM [r_individuo_dia]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "UNKNOWN",
                "f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT MAX([Data]) FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "UNKNOWN",
                "f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_secullum_horarios]": [
                "UNKNOWN",
                "dim_log_secullum_horarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": [
                "UNKNOWN",
                "dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": [
                "UNKNOWN",
                "dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": [
                "UNKNOWN",
                "f_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": [
                "UNKNOWN",
                "f_nps_v2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_att_resumos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_estrutura]": [
                "EXEC",
                "EXEC sp_sys_estrutura"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "EXEC",
                "EXEC sp_att_resumos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "EXEC",
                "EXEC sp_att_resumos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_att_resumos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": [
                "EXEC",
                "EXEC sp_att_resumos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_resumos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_resumos_teste",
        "type": "StoredProcedure",
        "start": 629200,
        "end": 773173,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_resumos_teste]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE         PROCEDURE [dbo].[sp_att_resumos_teste] @datahora_inicio DATE,  @datahora_fim DATE, @metrica VARCHAR(50) AS\n\nDECLARE @t_inicio datetime = GETDATE();\n\t\t\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Prepara\u00e7\u00e3o (Chaves, tabelas, variaveis, etc) \n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\t\n\tDECLARE @max_data datetime2(0) = (SELECT MAX([Data]) FROM dim_calendario) \n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'r_individuo_30min_teste' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[r_individuo_30min_teste]( \n\t\t\t [DataHora]\t\t\t\t\t\t\t\t\t\t\t\t[datetime2](3)\tNOT NULL\n\t\t\t,[Intervalo]\t\t\t\t\t\t\t\t\t\t\t[time](3)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Data]\t\t\t\t\t\t\t\t\t\t\t\t\t[date]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t\t\t\t[date]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t\t\t\t\t\t[date]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Feriado]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Folga]\t\t\t\t\t\t\t\t\t\t\t\t[bit]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t\t\t\t\t\t[datetime2](0)\tNULL\t\tDEFAULT NULL\n\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t\t\t\t[varchar](30)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Nome]\t\t\t\t\t\t\t\t\t\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Status]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL\n\n\t\t\t,[DMA Inicial]\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor Inicial]\t\t\t\t\t\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t\t\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t\t\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\n\t\t\t,[Cliente]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Projeto]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Cargo]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tribo]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t\t\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Turno]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](10)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Escala]\t\t\t\t\t\t\t\t\t\t\t\t[varchar](15)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Jornada (Ponto)]\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Jornada (Log)]\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tipo de Jornada]\t\t\t\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Login]\t\t\t\t\t\t\t\t\t\t\t\t[time](3)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Logout]\t\t\t\t\t\t\t\t\t\t\t\t[time](3)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Log descartado (>2HE)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[HE]\t\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log]\t\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log Produtivo]\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log Improdutivo]\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tempo Livre]\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Particular (Intelix)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Break (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa 10 (Intelix)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Outbound (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Lanche (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa R\u00e1pida (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Feedback (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Interno (Intelix)]\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Externo (Intelix)]\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (Intelix)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Banheiro (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Tratativa (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Discagem Manual (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Banheiro (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa WhatsApp (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Intervalo (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Discagem Retorno (EPBX)]\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Feedback (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Transfer\u00eancia (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Login (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Interno (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Externo (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa NR17 (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Lanche (EPBX)]\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa BackOffice (EPBX)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Banheiro (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Descanso (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Feedback (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Backoffice (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Discagem Manual (Genesys)]\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Discagem Retorno (Genesys)]\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Em Fila (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Sistema Externo (Genesys)]\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Sistema Interno (Genesys)]\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Tratativa (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (Genesys)]\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\n\t\t\t,[Criados]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tratados]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t--,[Tratados Com TMT]\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tempo Total de Tratativa]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[TMT]\t\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Replicas]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Reincidentes 48h]\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Reincidentes 30d]\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t[decimal](16,2)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t[decimal](16,2)\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas Finalizadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t[decimal](16,6)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t[decimal](16,2)\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t[int]\t\t\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t[decimal](16,2)\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Promotoras]\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Neutras]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Detratoras]\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[NPS]\t\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\n\n\t\t) ON [PRIMARY]\n\tEND\n\n\tDROP TABLE IF EXISTS #chaves; SELECT * INTO #chaves FROM (\n\t\tSELECT \n\t\t\t\t [DataHora]\t\t\t\t\t\t\t\t\t=\tc.[DataHora]\n\t\t\t\t,[Proxima_DataHora]\t\t\t\t\t\t\t=\tDATEADD(MINUTE, 30, c.[DataHora])\n\t\t\t\t,[Intervalo]\t\t\t\t\t\t\t\t=\tCAST(c.[DataHora] as time(0))\n\t\t\t\t,[Data]\t\t\t\t\t\t\t\t\t\t=\tc.[Data]\n\t\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t\t\t=\tc.[Semana_Mes_For\u00e7ada_PrimeiroDia]\n\t\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t\t\t=\tc.[M\u00eas_PrimeroDia]\n\t\t\t\t,[Feriado]\t\t\t\t\t\t\t\t\t=\tc.[Feriado_Nome]\n\t\t\t\t,[Folga]\t\t\t\t\t\t\t\t\t=\tflg.[Folga]\n\t\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t\t\t=\tmop.[Data da Atualiza\u00e7\u00e3o]\n\t\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t=\tmop.[ID Selecionar]\n\t\t\t\t,[Nome]\t\t\t\t\t\t\t\t\t\t=\tmop.[Nome]\n\t\t\t\t,[Status]\t\t\t\t\t\t\t\t\t=\tmop.[Status]\n\t\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t=\tmop.[Situa\u00e7\u00e3o]\n\t\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t=\tmop.[Condi\u00e7\u00e3o]\n\n\t\t\t\t,[DMA Inicial]\t\t\t\t\t\t\t\t=\tmop.[DMA Inicial]\n\t\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t\t\t=\tmop.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t\t\t=\tmop.[\u00daltima DMA Geral]\n\t\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t\t\t=\tmop.[Tipo da \u00daltima DMA]\n\t\t\t\t,[Instrutor Inicial]\t\t\t\t\t\t=\tmop.[Instrutor Inicial]\n\t\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t\t\t=\tmop.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t\t\t=\tmop.[Instrutor \u00daltima DMA]\n\n\t\t\t\t,[Cliente]\t\t\t\t\t\t\t\t\t=\tmop.[Cliente]\n\t\t\t\t,[Projeto]\t\t\t\t\t\t\t\t\t=\tmop.[Projeto]\n\t\t\t\t,[Cargo]\t\t\t\t\t\t\t\t\t=\tmop.[Cargo]\n\t\t\t\t,[Tribo]\t\t\t\t\t\t\t\t\t=\tmop.[Tribo]\n\t\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t\t\t=\tmop.[Supervis\u00e3o]\n\t\t\t\t,[Turno]\t\t\t\t\t\t\t\t\t=\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN DATEDIFF(s, '00:00:00', mop.[Jornada]) > 22800 THEN 'Integral'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(LEFT(mop.[Escala],5) AS TIME) <  CAST('12:00' AS TIME) THEN 'Manh\u00e3'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(LEFT(mop.[Escala],5) AS TIME) >= CAST('12:00' AS TIME) THEN 'Tarde'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE NULL\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t\t,[Escala]\t\t\t\t\t\t\t\t\t=\tmop.[Escala]\n\t\t\t\t,[Jornada (Ponto)]\t\t\t\t\t\t\t=\tISNULL(CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Taxa] = 1 AND (DATENAME(WEEKDAY, c.data) = 'S\u00e1bado' OR\tDATENAME(WEEKDAY, c.[Data]) = 'Domingo') THEN 0 \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Taxa] = 2 AND (\t\t\t\t\t\t\t\t\t\t\tDATENAME(WEEKDAY, c.[Data]) = 'Domingo') THEN 0 \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Taxa] = 3 AND (DATENAME(WEEKDAY, c.data) = 'S\u00e1bado' OR\tDATENAME(WEEKDAY, c.[Data]) = 'Domingo') THEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN c.[Feriado_Nome] IS NOT NULL THEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE DATEDIFF(s, 0, mop.[Jornada])\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND,0)\n\t\t\t\t,[Jornada (Log)]\t\t\t\t\t\t\t=\tISNULL(CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Taxa] = 1 AND (DATENAME(WEEKDAY, c.data) = 'S\u00e1bado' OR\tDATENAME(WEEKDAY, c.[Data]) = 'Domingo') THEN 0 \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Taxa] = 2 AND (\t\t\t\t\t\t\t\t\t\t\tDATENAME(WEEKDAY, c.[Data]) = 'Domingo') THEN 0 \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Taxa] = 3 AND (DATENAME(WEEKDAY, c.data) = 'S\u00e1bado' OR\tDATENAME(WEEKDAY, c.[Data]) = 'Domingo') THEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN c.[Feriado_Nome] IS NOT NULL THEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN mop.[Status] <> 'Ativo' THEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE DATEDIFF(s, 0, mop.[Jornada])\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND, 0)\n\n\t\t\tFROM dim_calendario_30min c \n\t\t\tLEFT JOIN ( SELECT [Data da Atualiza\u00e7\u00e3o], [Data da Proxima Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Intelix], [ID EPBX], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [DMA Inicial], [\u00daltima DMA Migra\u00e7\u00e3o], [\u00daltima DMA Geral], [Tipo da \u00daltima DMA], [Instrutor Inicial], [Instrutor \u00daltima Migra\u00e7\u00e3o], [Instrutor \u00daltima DMA], [Cliente], [Projeto], [Cargo], [Tribo], [Supervis\u00e3o], [Escala], [Jornada], [Taxa] FROM f_mop_eventos \n\t\t\t\t\t\tWHERE [Data da Atualiza\u00e7\u00e3o] <= @datahora_fim \n\t\t\t\t\t\tAND ([Data da Proxima Atualiza\u00e7\u00e3o] >= @datahora_inicio OR [Data da Proxima Atualiza\u00e7\u00e3o] IS NULL)\n\t\t\t\t\t\tUNION ALL SELECT CAST('01/01/1900' AS datetime2(0)), CAST('01/01/2070' AS datetime2(0)), null, null, null, 'Colaborador n\u00e3o encontrado', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null\n\t\t\t) as mop\n\t\t\t\tON  c.[Data] >= mop.[Data da Atualiza\u00e7\u00e3o]\n\t\t\t\tAND c.[Data] <  CASE  WHEN mop.[Data da Proxima Atualiza\u00e7\u00e3o] IS NULL AND [status] = 'Turnover' THEN DATEADD(DAY, 1, mop.[Data da Atualiza\u00e7\u00e3o])\n\t\t\t\t\t\t\t\t\t  WHEN mop.[Data da Proxima Atualiza\u00e7\u00e3o] IS NULL THEN DATEADD(DAY, 1, @max_data)\n\t\t\t\t\t\t\t\t\t  ELSE mop.[Data da Proxima Atualiza\u00e7\u00e3o] END\n\t\t\tLEFT JOIN (\tSELECT DISTINCT id_atendente, data_inicio, data_fim, [Folga] = 1 FROM dim_justificativas_abs WHERE justificativa_1 = 'Folga' \n\t\t\t) as flg \n\t\t\t\tON\t(mop.[ID Intelix] = flg.[id_atendente] OR mop.[ID EPBX] = flg.[id_atendente])\n\t\t\t\tAND c.[Data] >= flg.[data_inicio] \n\t\t\t\tAND c.[Data] <= flg.[data_fim]\n\t\t\tWHERE c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim \n\t\t) _\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF @metrica='log'\t\tOR @metrica='todas' BEGIN\n\n\t;WITH destino AS\n\t(\n\t\tSELECT * FROM [r_individuo_30min_teste]\n\t\tWHERE [DataHora] >= @datahora_inicio \n\t\tAND\t  [DataHora] <= @datahora_fim \n\t)\n\tMERGE INTO destino USING \n\t(\n\n\t\tSELECT\n\t\t\t [DataHora]\t\t\t\t\t\t\t=\tc.[DataHora]\n\t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n\t\t\t,[Cliente]\t\t\t\t\t\t\t=\tc.[Cliente]\n\t\t\t,[Projeto]\t\t\t\t\t\t\t=\tc.[Projeto]\n\t\t\t,[Tribo]\t\t\t\t\t\t\t=\tc.[Tribo]\n\t\t\t,[Login]\t\t\t\t\t\t\t=\tCAST(IIF([Login] < c.[DataHora] , c.[DataHora], [Login]) AS time(3))\n\t\t\t--,[Login]\t\t\t\t\t\t\t=\tCASE WHEN CAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login])) AS time(3)) > CAST(c.[Proxima_DataHora] AS time(3)) THEN  DATEADD(ms,DATEDIFF(ms, \n\t\t\t--\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login])) AS time(3)), \n\t\t\t--\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCAST(c.[Proxima_DataHora] AS time(3))),\n\t\t\t--\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCAST(IIF([Login] < c.[DataHora] , c.[DataHora], [Login]) AS time(3)))\n\t\t\t--\t\t\t\t\t\t\t\t\t\t\tELSE CAST(IIF([Login] < c.[DataHora] , c.[DataHora], [Login]) AS time(3))\n\t\t\t--\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t--,[Logout]\t\t\t\t\t\t\t=\tCAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login])) AS time(3))\n\t\t\t,[Logout]\t\t\t\t\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login]))  AS date) > CAST(c.[DataHora] AS date) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN CAST(c.[Proxima_DataHora] AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN CAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login]))  AS time(3)) > CAST(c.[Proxima_DataHora] AS time(3)) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tTHEN DATEADD(ms,DATEDIFF(ms, \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login])) AS time(3)), \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCAST(c.[Proxima_DataHora] AS time(3))),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t CAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login])) AS time(3)))\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE CAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login])) AS time(3))\n\t\t\t\t\t\t\t\t\t\t\t\t\tEND\n\n\t\t\t,[Log descartado (>2HE)]\t\t\t=\tISNULL(CASE WHEN [Log_Acumulado] > [Limite_HE]\tTHEN CASE WHEN [Log_Acumulado] - [Limite_HE] < 1800000\tTHEN\t [Log_Acumulado] - [Limite_HE]\tELSE [Log]\tEND\tELSE 0\tEND/1000.0, 0)\n\t\t\t,[HE]\t\t\t\t\t\t\t\t=\tISNULL(CASE WHEN [Log_Acumulado] > [Limite_HE]  THEN CASE WHEN [Log_Acumulado] - [Limite_HE] < 1800000 THEN\t [Log_cortado]\t\t\t\t\tELSE 0\t\tEND ELSE  \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   CASE WHEN [Log_Acumulado] > [Inicio_HE]\tTHEN CASE WHEN [Log_Acumulado] - [Inicio_HE] < 1800000 THEN\t([Log_Acumulado] - [Inicio_HE]) ELSE [log]\tEND\tELSE 0\tEND\tEND/1000.0, 0)\n\t\t\t\n\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tISNULL([Log_cortado]/1000.0, 0)\n\t\t\t--\t\t\t\t\t\t\t\t\t+\tCASE WHEN CAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login]))  AS time(3)) > CAST(c.[Proxima_DataHora] AS time(3)) AND ISNULL([Log_cortado]/1000.0, 0) > 0 \n\t\t\t--\t\t\t\t\t\t\t\t\t\t\tTHEN  -1\n\t\t\t--\t\t\t\t\t\t\t\t\t\t\tELSE 0\n\t\t\t--\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t,[Log Produtivo]\t\t\t\t\t=\n\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Tempo Livre], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Sistema Externo], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Outbound], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tempo Livre], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Sistema (Externo)], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Discagem Manual], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Em Ligacao], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Transfer\u00eancia], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tratativa], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_WhatsApp], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Backoffice], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Discagem Manual], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Discagem Retorno], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Em Fila], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Sistema Externo], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Tratativa], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Whatsapp], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n\n\t\t\t,[Log Improdutivo]\t\t\t\t\t=\t\n\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Pausa Particular], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Break], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa 10], 0)\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Lanche], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa R\u00e1pida], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Almo\u00e7o], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Feedback], 0)\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Treinamento], 0)\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Banheiro], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Sistema Interno], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Reuni\u00e3o], 0)\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Intelix_Pausa Ambulat\u00f3rio], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Almo\u00e7o], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Ambulat\u00f3rio], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Banheiro], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Feedback], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Intervalo], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_P\u00f3s Atendimento], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Reuni\u00e3o], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Sistema (interno)], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Treinamento], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_BackOffice], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Login], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_N\u00e3o Disponivel], 0)\t\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Almo\u00e7o], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Ambulat\u00f3rio], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Banheiro], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Descanso], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Feedback], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Dispon\u00edvel], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Sistema Interno], 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([Genesys_Treinamento], 0)\n\t\t\t--\t\t\t\t\t\t\t\t\t+\tCASE WHEN CAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login]))  AS time(3)) > CAST(c.[Proxima_DataHora] AS time(3)) AND ISNULL([Genesys_Dispon\u00edvel]/1000.0, 0) > 0 \n\t\t\t--\t\t\t\t\t\t\t\t\t\t\tTHEN  -1\n\t\t\t--\t\t\t\t\t\t\t\t\t\t\tELSE 0\n\t\t\t--\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\t\t\t\n\n\t\t\t,[Tempo Livre]\t\t\t\t\t\t=\t\n\t\t\t\t\t\t\t\t\t\t\t\t(\tISNULL([Intelix_Tempo Livre]/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t+\tISNULL([EPBX_Tempo Livre]/1000.0, 0)\n\t\t\t\t\t\t\t\t\t\t\t\t)/1000.0\n\n\t\t\t,[Pausa Particular (Intelix)]\t\t=\tISNULL([Intelix_Pausa Particular]/1000.0, 0)\n\t\t\t,[Pausa Break (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Break]/1000.0, 0)\n\t\t\t,[Pausa 10 (Intelix)] \t\t\t\t=\tISNULL([Intelix_Pausa 10]/1000.0, 0)\t\t\n\t\t\t,[Pausa Outbound (Intelix)] \t\t=\tISNULL([Intelix_Pausa Outbound]/1000.0, 0)\t\t\t\n\t\t\t,[Pausa Lanche (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Lanche]/1000.0, 0)\t\t\t\t\n\t\t\t,[Pausa R\u00e1pida (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa R\u00e1pida]/1000.0, 0)\t\t\t\t\n\t\t\t,[Pausa Almo\u00e7o (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Almo\u00e7o]/1000.0, 0)\t\t\t\t\n\t\t\t,[Pausa Feedback (Intelix)] \t\t=\tISNULL([Intelix_Pausa Feedback]/1000.0, 0)\t\t\t\n\t\t\t,[Pausa Sistema Interno (Intelix)] \t=\tISNULL([Intelix_Pausa Sistema Interno]/1000.0, 0)\t\n\t\t\t,[Pausa Sistema Externo (Intelix)] \t=\tISNULL([Intelix_Pausa Sistema Externo]/1000.0, 0)\t\n\t\t\t,[Pausa Treinamento (Intelix)] \t\t=\tISNULL([Intelix_Pausa Treinamento]/1000.0, 0)\t\t\n\t\t\t,[Pausa Banheiro (Intelix)] \t\t=\tISNULL([Intelix_Pausa Banheiro]/1000.0, 0)\t\t\t\n\t\t\t,[Pausa Reuni\u00e3o (Intelix)] \t\t\t=\tISNULL([Intelix_Pausa Reuni\u00e3o]/1000.0, 0)\t\t\t\n\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)] \t\t=\tISNULL([Intelix_Pausa Ambulat\u00f3rio]/1000.0, 0)\t\t\n\n\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tISNULL([EPBX_Em Ligacao]/1000.0, 0)\t\t\t\t\t\n\t\t\t,[Pausa Almo\u00e7o (EPBX)] \t\t\t\t=\tISNULL([EPBX_Almo\u00e7o]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t,[Pausa Tratativa (EPBX)] \t\t\t=\tISNULL([EPBX_Tratativa]/1000.0, 0)\t\t\t\t\t\n\t\t\t,[Pausa Discagem Manual (EPBX)] \t=\tISNULL([EPBX_Discagem Manual]/1000.0, 0)\t\t\t\t\n\t\t\t,[Pausa Banheiro (EPBX)] \t\t\t=\tISNULL([EPBX_Banheiro]/1000.0, 0)\t\t\t\t\t\n\t\t\t,[Pausa WhatsApp (EPBX)] \t\t\t=\tISNULL([EPBX_WhatsApp]/1000.0, 0)\t\t\t\t\t\n\t\t\t,[Pausa Intervalo (EPBX)] \t\t\t=\tISNULL([EPBX_Intervalo]/1000.0, 0)\t\t\t\t\t\n\t\t\t,[Pausa Discagem Retorno (EPBX)] \t=\tISNULL([EPBX_Discagem Retorno]/1000.0, 0)\t\t\t\n\t\t\t,[Pausa Treinamento (EPBX)] \t\t=\tISNULL([EPBX_Treinamento]/1000.0, 0)\t\t\t\t\t\n\t\t\t,[Pausa Feedback (EPBX)] \t\t\t=\tISNULL([EPBX_Feedback]/1000.0, 0)\t\t\t\t\t\n\t\t\t,[Pausa Transfer\u00eancia (EPBX)] \t\t=\tISNULL([EPBX_Transfer\u00eancia]/1000.0, 0)\t\t\t\t\n\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)] \t\t=\tISNULL([EPBX_N\u00e3o Disponivel]/1000.0, 0)\t\t\t\t\n\t\t\t,[Pausa Login (EPBX)] \t\t\t\t=\tISNULL([EPBX_Login]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t,[Pausa Reuni\u00e3o (EPBX)] \t\t\t=\tISNULL([EPBX_Reuni\u00e3o]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t,[Pausa Sistema Interno (EPBX)] \t=\tISNULL([EPBX_Sistema (interno)]/1000.0, 0)\t\t\n\t\t\t,[Pausa Sistema Externo (EPBX)] \t=\tISNULL([EPBX_Sistema (Externo)]/1000.0, 0)\t\t\t\n\t\t\t,[Pausa NR17 (EPBX)] \t\t\t\t=\tISNULL([EPBX_NR17]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)] \t\t=\tISNULL([EPBX_Ambulat\u00f3rio]/1000.0, 0)\t\t\t\t\t\n\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)] \t=\tISNULL([EPBX_P\u00f3s Atendimento]/1000.0, 0)\t\t\t\t\n\t\t\t,[Pausa Lanche (EPBX)] \t\t\t\t=\tISNULL([EPBX_Lanche]/1000.0, 0)\t\t\t\t\t\t\n\t\t\t,[Pausa BackOffice (EPBX)] \t\t\t=\tISNULL([EPBX_BackOffice]/1000.0, 0)\t\t\t\t\t\n\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tISNULL([Genesys_Almo\u00e7o]/1000.0, 0)\t\t\t\t-- Improd\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tISNULL([Genesys_Ambulat\u00f3rio]/1000.0, 0)\t\t-- Improd\n\t\t\t,[Pausa Banheiro (Genesys)]\t\t\t=\tISNULL([Genesys_Banheiro]/1000.0, 0)\t\t\t-- Improd\n\t\t\t,[Pausa Descanso (Genesys)]\t\t\t=\tISNULL([Genesys_Descanso]/1000.0, 0)\t\t\t-- Improd\n\t\t\t,[Pausa Feedback (Genesys)]\t\t\t=\tISNULL([Genesys_Feedback]/1000.0, 0)\t\t\t-- Improd\n\t\t\t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tISNULL([Genesys_Dispon\u00edvel]/1000.0, 0)\t\t\t-- Improd\n\t\t\t--\t\t\t\t\t\t\t\t\t+\tCASE WHEN CAST(DATEADD(ms, [Log], IIF([Login] < c.[DataHora] , c.[DataHora], [Login]))  AS time(3)) > CAST(c.[Proxima_DataHora] AS time(3))  AND ISNULL([Genesys_Dispon\u00edvel]/1000.0, 0) > 0 \n\t\t\t--\t\t\t\t\t\t\t\t\t\t\tTHEN  -1\n\t\t\t--\t\t\t\t\t\t\t\t\t\t\tELSE 0\n\t\t\t--\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t\n\t\t\t,[Pausa Backoffice (Genesys)]\t\t=\tISNULL([Genesys_Backoffice]/1000.0, 0)\t\t\t-- Prod\n\t\t\t,[Pausa Discagem Manual (Genesys)]\t=\tISNULL([Genesys_Discagem Manual]/1000.0, 0)\t-- Prod\n\t\t\t,[Pausa Discagem Retorno (Genesys)]\t=\tISNULL([Genesys_Discagem Retorno]/1000.0, 0)\t-- Prod\n\t\t\t,[Pausa Em Fila (Genesys)]\t\t\t=\tISNULL([Genesys_Em Fila]/1000.0, 0)\t\t\t-- Prod\n\t\t\t,[Pausa Sistema Externo (Genesys)]\t=\tISNULL([Genesys_Sistema Externo]/1000.0, 0)\t-- Prod\n\t\t\t,[Pausa Sistema Interno (Genesys)]\t=\tISNULL([Genesys_Sistema Interno]/1000.0, 0)\t-- Improd\n\t\t\t,[Pausa Tratativa (Genesys)]\t\t=\tISNULL([Genesys_Tratativa]/1000.0, 0)\t\t\t-- Prod\n\t\t\t,[Pausa Whatsapp (Genesys)]\t\t\t=\tISNULL([Genesys_Whatsapp]/1000.0, 0)\t\t\t-- Prod\n\t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tISNULL([Genesys_Treinamento]/1000.0, 0)\t\t-- Improd\n\n\n\t\tFROM #chaves c\n\t\tLEFT JOIN ( \n\t\t\t\tSELECT *\n\t\t\t\t\t,[Log_Acumulado]=\tSUM([Log]) OVER (PARTITION BY [ID Selecionar], [Data] ORDER BY [DataHora])\n\t\t\t\t\t,[Inicio_HE]\t=\t[Jornada (Log)]\n\t\t\t\t\t,[Limite_HE]\t=\t[Jornada (Log)]+7200000\n\t\t\t\tFROM (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\t [DataHora]\t\t\t\t\t\t\t=\t[DataHora]\n\t\t\t\t\t\t,[Data]\t\t\t\t\t\t\t\t=\t[Data]\n\t\t\t\t\t\t,[ID Selecionar]\t\t\t\t\t=\t[ID Selecionar]\n\t\t\t\t\t\t,[Jornada (Log)]\t\t\t\t\t=\t[Jornada (Log)]\n\t\t\t\t\t\t,[Login]\t\t\t\t\t\t\t=\tMIN(MIN([In\u00edcio])) OVER (PARTITION BY [ID Selecionar], [Data])\n\t\t\t\t\t\t,[Logout]\t\t\t\t\t\t\t=\tMAX(MAX([Fim]))\t OVER (PARTITION BY [ID Selecionar], [Data])\n\n\t\t\t\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' OR Fonte = 'EPBX' OR Fonte = 'GENESYS'\t\t  THEN CASE WHEN [In\u00edcio] IS NULL OR [Fim] IS NULL\tTHEN 0\tWHEN [Fim] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio] <= [DataHora] AND [Fim] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim])\tWHEN [In\u00edcio] >  [DataHora] AND [Fim] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio], [Proxima_DataHora]) WHEN [In\u00edcio] >  [DataHora] AND [Fim] <= [Proxima_DataHora] THEN IIF([In\u00edcio] < [Fim], DATEDIFF(ms, [In\u00edcio], [Fim]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Log_cortado]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' OR Fonte = 'EPBX' OR Fonte = 'GENESYS'\t\t  THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t\n\t\t\t\t\t\t,[Intelix_Tempo Livre]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Login'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Particular]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Particular (Break))'\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Break]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Break)'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa 10]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Pausa 10)'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Outbound]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Outbound)'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Lanche]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Lanche)'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa R\u00e1pida]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Pausa Rapida)'\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Almo\u00e7o]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Almoco)'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Feedback]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Feedback)'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Sistema Externo]\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Sistema (Externo))'\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Treinamento]\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Treinamento)'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Banheiro]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Banheiro)'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Sistema Interno]\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Sistema (Interno))'\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Reuni\u00e3o]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Reuniao)'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Intelix_Pausa Ambulat\u00f3rio]\t\t=\tSUM(CAST(CASE WHEN Fonte = 'Intelix' AND Evento = ('Pausa (Ambulatorio)'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t\n\t\t\t\t\t\t,[EPBX_Tempo Livre]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Livre'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Em Ligacao]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Em Ligacao'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Almo\u00e7o]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Almo\u00e7o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Tratativa]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Tratativa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Discagem Manual]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Discagem Manual'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Banheiro]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Banheiro'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_WhatsApp]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('WhatsApp'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Intervalo]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Intervalo'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Discagem Retorno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Discagem Retorno'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Treinamento]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Treinamento'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Feedback]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Feedback'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Transfer\u00eancia]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Transfer\u00eancia'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Sistema (Externo)]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Sistema (Externo)'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_N\u00e3o Disponivel]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('N\u00e3o Disponivel'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Login]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Login'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Reuni\u00e3o]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Reuni\u00e3o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Sistema (interno)]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Sistema (interno)'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_NR17]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('NR17'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Ambulat\u00f3rio]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Ambulat\u00f3rio'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_P\u00f3s Atendimento]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('P\u00f3s Atendimento'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_Lanche]\t\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('Lanche'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[EPBX_BackOffice]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'EPBX'\tAND Evento = ('BackOffice'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\n\t\t\t\t\t\t,[Genesys_Almo\u00e7o]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Almo\u00e7o'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Ambulat\u00f3rio]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Ambulat\u00f3rio'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Backoffice]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Backoffice'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Banheiro]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Banheiro'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Descanso]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Descanso'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Discagem Manual]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Discagem Manual'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Discagem Retorno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Discagem Retorno'\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Dispon\u00edvel]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Dispon\u00edvel'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Em Fila]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Em Fila'\t\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Feedback]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Feedback'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Sistema Externo]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Sistema Externo'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Sistema Interno]\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Sistema Interno'\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Tratativa]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Tratativa'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Whatsapp]\t\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Whatsapp'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\t\t\t\t\t\t,[Genesys_Treinamento]\t\t\t\t=\tSUM(CAST(CASE WHEN Fonte = 'GENESYS' AND Evento = ('Treinamento'\t\t\t\t\t) THEN CASE WHEN [In\u00edcio_cortado] IS NULL OR [Fim_cortado] IS NULL\tTHEN 0\tWHEN [Fim_cortado] <= [DataHora]\tTHEN 0\tWHEN [In\u00edcio_cortado] >= [Proxima_DataHora] THEN 0 WHEN [In\u00edcio_cortado] <= [DataHora] AND [Fim_cortado] <  [Proxima_DataHora] THEN DATEDIFF(ms, [DataHora] , [Fim_cortado])\tWHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] >  [Proxima_DataHora]\tTHEN DATEDIFF(ms, [In\u00edcio_cortado], [Proxima_DataHora]) WHEN [In\u00edcio_cortado] >  [DataHora] AND [Fim_cortado] <= [Proxima_DataHora] THEN IIF([In\u00edcio_cortado] < [Fim_cortado], DATEDIFF(ms, [In\u00edcio_cortado], [Fim_cortado]), 0) ELSE 1800000 END ELSE 0 END AS BIGINT))\n\n\t\t\t\t\t--SELECT DISTINCT evento FROM f_log WHERE fonte = 'GENESYS' --AND [ID Selecionar] is not NULL\n\t\t\t\t\t\n\t\t\t\t\tFROM (\n\t\t\t\t\t\tSELECT *\n\t\t\t\t\t\t\t,[HE_Descartado_Fim] = CASE WHEN DATEADD(ms, [HE>2H], [Ultimo_Fim]) > '20:02' THEN 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 0\n\t\t\t\t\t\t\t\t\t\t\t\t\tEND\n\n\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\t,[Fim_cortado]\t\t=\t(\tSELECT IIF(l.[Fim] < MAX([v]), l.[Fim], MAX([v])) FROM (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSELECT [v]=DATEADD(ms, MAX([v]) OVER (PARTITION BY c.[ID Selecionar], c.[Data]) * -1, MAX([Fim]) OVER (PARTITION BY c.[ID Selecionar], c.[Data])) FROM (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSELECT [v]=MAX([v]) FROM (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSELECT [v]=0  -- Ignorar valores abaixo de zero\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tUNION ALL\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSELECT SUM(sub.[Dura\u00e7\u00e3o]) - ([Jornada (Log)]+7200) FROM f_log sub WHERE sub.[ID Selecionar] = c.[ID Selecionar] AND sub.[In\u00edcio] >= c.[Data] AND sub.[In\u00edcio] <= l.[In\u00edcio]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)_\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)_\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)_\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t*/\n\t\t\t\t\t\t\n\t\t\t\t\t\tFROM (\n\t\t\t\t\t\t\tSELECT\n\t\t\t\t\t\t\t\t c.[DataHora]\n\t\t\t\t\t\t\t\t,c.[Proxima_DataHora]\n\t\t\t\t\t\t\t\t,c.[Data]\n\t\t\t\t\t\t\t\t,c.[ID Selecionar]\n\t\t\t\t\t\t\t\t,[Jornada (Log)] = c.[Jornada (Log)]*1000\n\t\t\t\t\t\t\t\t,l.[Fonte]\n\t\t\t\t\t\t\t\t,l.[Evento]\n\t\t\t\t\t\t\t\t,l.[In\u00edcio]\n\t\t\t\t\t\t\t\t,l.[Fim]\n\t\t\t\t\t\t\t\t,[In\u00edcio_cortado] = l.[In\u00edcio]\n\t\t\t\t\t\t\t\t,[Fim_cortado] = l.[Fim]\n\n\t\t\t\t\t\t\t\t,[Primeiro_In\u00edcio]\t=\tMIN([In\u00edcio]) OVER (PARTITION BY c.[ID Selecionar], c.[Data])\n\t\t\t\t\t\t\t\t,[Ultimo_Fim]\t\t=\tMAX([Fim]) OVER (PARTITION BY c.[ID Selecionar], c.[Data])\n\t\t\t\t\t\t\t\t,[HE>2H]\t\t\t=\t(SELECT MAX([v]) FROM ( SELECT [v]=0  -- Ignora valores abaixo de zero (sem HE > 2h)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tUNION ALL\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tSELECT SUM(sub.[Dura\u00e7\u00e3o]) - (c.[Jornada (Log)]+7200000) FROM f_log sub WHERE sub.[ID Selecionar] = c.[ID Selecionar] AND sub.[In\u00edcio] >= c.[Data] AND sub.[In\u00edcio] <= l.[In\u00edcio])_)\n\n\t\t\t\t\t\t\tFROM f_log_teste l\n\t\t\t\t\t\t\tRIGHT JOIN #chaves c\n\t\t\t\t\t\t\tON\tCOALESCE(c.[ID Selecionar], '-') = COALESCE(l.[ID Selecionar], '-')\n\t\t\t\t\t\t\tAND\tc.[DataHora]  >= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [In\u00edcio]) / 30.0) * 30, 0)\n\t\t\t\t\t\t\tAND\tc.[DataHora]  <= DATEADD(MINUTE, FLOOR(DATEDIFF(MINUTE, 0, [Fim]) / 30.0) * 30, 0) \n\n\t\t\t\t\t\t\tWHERE c.[DataHora] >= @datahora_inicio AND c.[DataHora] <= @datahora_fim \n\t\t\t\t\t\t\tAND\t  In\u00edcio >= @datahora_inicio AND Fim <= @datahora_fim \n\t\t\t\t\t\t) a \n\t\t\t\t\t) b GROUP BY [DataHora], [Proxima_DataHora], [ID Selecionar], [Data], [Jornada (Log)]\n\t\t\t\t) c\n\t\t) l ON c.[ID Selecionar] = l.[ID Selecionar] AND c.[DataHora] = l.[DataHora]\n\n\t) AS fonte\n\tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n\tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n\tAND COALESCE(fonte.[Tribo], '-')\t\t\t=\tCOALESCE(destino.[Tribo], '-')\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [DataHora]\n\t\t\t,[ID Selecionar]\n\t\t\t,[Cliente]\n\t\t\t,[Projeto]\n\t\t\t,[Tribo]\n\t\t\t,[Login]\n\t\t\t,[Logout]\n\t\t\t,[Log descartado (>2HE)]\n\t\t\t,[HE]\n\t\t\t,[Log]\n\t\t\t,[Log Produtivo]\n\t\t\t,[Log Improdutivo]\n\t\t\t,[Tempo Livre]\n\t\t\t,[Pausa Particular (Intelix)]\n\t\t\t,[Pausa Break (Intelix)]\n\t\t\t,[Pausa 10 (Intelix)]\n\t\t\t,[Pausa Outbound (Intelix)]\n\t\t\t,[Pausa Lanche (Intelix)]\n\t\t\t,[Pausa R\u00e1pida (Intelix)]\n\t\t\t,[Pausa Almo\u00e7o (Intelix)]\n\t\t\t,[Pausa Feedback (Intelix)]\n\t\t\t,[Pausa Sistema Interno (Intelix)]\n\t\t\t,[Pausa Sistema Externo (Intelix)]\n\t\t\t,[Pausa Treinamento (Intelix)]\n\t\t\t,[Pausa Banheiro (Intelix)]\n\t\t\t,[Pausa Reuni\u00e3o (Intelix)]\n\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t\t,[Pausa Almo\u00e7o (EPBX)]\n\t\t\t,[Pausa Tratativa (EPBX)]\n\t\t\t,[Pausa Discagem Manual (EPBX)]\n\t\t\t,[Pausa Banheiro (EPBX)]\n\t\t\t,[Pausa WhatsApp (EPBX)]\n\t\t\t,[Pausa Intervalo (EPBX)]\n\t\t\t,[Pausa Discagem Retorno (EPBX)]\n\t\t\t,[Pausa Treinamento (EPBX)]\n\t\t\t,[Pausa Feedback (EPBX)]\n\t\t\t,[Pausa Transfer\u00eancia (EPBX)]\n\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t\t,[Pausa Login (EPBX)]\n\t\t\t,[Pausa Reuni\u00e3o (EPBX)]\n\t\t\t,[Pausa Sistema Interno (EPBX)]\n\t\t\t,[Pausa Sistema Externo (EPBX)]\n\t\t\t,[Pausa NR17 (EPBX)]\n\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t\t,[Pausa Lanche (EPBX)]\n\t\t\t,[Pausa BackOffice (EPBX)]\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t\t,[Pausa Banheiro (Genesys)]\n\t\t\t,[Pausa Descanso (Genesys)]\n\t\t\t,[Pausa Feedback (Genesys)]\n\t\t\t,[Pausa Backoffice (Genesys)]\n\t\t\t,[Pausa Discagem Manual (Genesys)]\n\t\t\t,[Pausa Discagem Retorno (Genesys)]\n\t\t\t,[Pausa Dispon\u00edvel (Genesys)]\n\t\t\t,[Pausa Em Fila (Genesys)]\n\t\t\t,[Pausa Sistema Externo (Genesys)]\n\t\t\t,[Pausa Sistema Interno (Genesys)]\n\t\t\t,[Pausa Tratativa (Genesys)]\n\t\t\t,[Pausa Whatsapp (Genesys)]\n\t\t\t,[Pausa Treinamento (Genesys)]\n\t\t\t)\n\t\tVALUES (\n\t\t\t fonte.[DataHora]\n\t\t\t,fonte.[ID Selecionar]\n\t\t\t,fonte.[Cliente]\n\t\t\t,fonte.[Projeto]\n\t\t\t,fonte.[Tribo]\n\t\t\t,fonte.[Login]\n\t\t\t,fonte.[Logout]\n\t\t\t,fonte.[Log descartado (>2HE)]\n\t\t\t,fonte.[HE]\n\t\t\t,fonte.[Log]\n\t\t\t,fonte.[Log Produtivo]\n\t\t\t,fonte.[Log Improdutivo]\n\t\t\t,fonte.[Tempo Livre]\n\t\t\t,fonte.[Pausa Particular (Intelix)]\n\t\t\t,fonte.[Pausa Break (Intelix)]\n\t\t\t,fonte.[Pausa 10 (Intelix)]\n\t\t\t,fonte.[Pausa Outbound (Intelix)]\n\t\t\t,fonte.[Pausa Lanche (Intelix)]\n\t\t\t,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t\t,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t\t,fonte.[Pausa Feedback (Intelix)]\n\t\t\t,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t\t,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t\t,fonte.[Pausa Treinamento (Intelix)]\n\t\t\t,fonte.[Pausa Banheiro (Intelix)]\n\t\t\t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t\t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t\t,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t\t,fonte.[Pausa Tratativa (EPBX)]\n\t\t\t,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t\t,fonte.[Pausa Banheiro (EPBX)]\n\t\t\t,fonte.[Pausa WhatsApp (EPBX)]\n\t\t\t,fonte.[Pausa Intervalo (EPBX)]\n\t\t\t,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t\t,fonte.[Pausa Treinamento (EPBX)]\n\t\t\t,fonte.[Pausa Feedback (EPBX)]\n\t\t\t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t\t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t\t,fonte.[Pausa Login (EPBX)]\n\t\t\t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t\t,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t\t,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t\t,fonte.[Pausa NR17 (EPBX)]\n\t\t\t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t\t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t\t,fonte.[Pausa Lanche (EPBX)]\n\t\t\t,fonte.[Pausa BackOffice (EPBX)]\n\t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t\t,fonte.[Pausa Banheiro (Genesys)]\n\t\t\t,fonte.[Pausa Descanso (Genesys)]\n\t\t\t,fonte.[Pausa Feedback (Genesys)]\n\t\t\t,fonte.[Pausa Backoffice (Genesys)]\n\t\t\t,fonte.[Pausa Discagem Manual (Genesys)]\n\t\t\t,fonte.[Pausa Discagem Retorno (Genesys)]\n\t\t\t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t\t\t,fonte.[Pausa Em Fila (Genesys)]\n\t\t\t,fonte.[Pausa Sistema Externo (Genesys)]\n\t\t\t,fonte.[Pausa Sistema Interno (Genesys)]\n\t\t\t,fonte.[Pausa Tratativa (Genesys)]\n\t\t\t,fonte.[Pausa Whatsapp (Genesys)]\n\t\t\t,fonte.[Pausa Treinamento (Genesys)]\n\t\t\t)\n\tWHEN MATCHED THEN \n\t\tUPDATE SET\n\t\t\t destino.[DataHora]\t\t\t\t\t\t\t=\tfonte.[DataHora]\n\t\t\t,destino.[ID Selecionar]\t\t\t\t\t=\tfonte.[ID Selecionar]\n\t\t\t,destino.[Cliente]\t\t\t\t\t\t\t=\tfonte.[Cliente]\n\t\t\t,destino.[Projeto]\t\t\t\t\t\t\t=\tfonte.[Projeto]\n\t\t\t,destino.[Tribo]\t\t\t\t\t\t\t=\tfonte.[Tribo]\n\t\t\t,destino.[Login]\t\t\t\t\t\t\t=\tfonte.[Login]\n\t\t\t,destino.[Logout]\t\t\t\t\t\t\t=\tfonte.[Logout]\n\t\t\t,destino.[Log descartado (>2HE)]\t\t\t=\tfonte.[Log descartado (>2HE)]\n\t\t\t,destino.[HE]\t\t\t\t\t\t\t\t=\tfonte.[HE]\n\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t=\tfonte.[Log]\n\t\t\t,destino.[Log Produtivo]\t\t\t\t\t=\tfonte.[Log Produtivo]\n\t\t\t,destino.[Log Improdutivo]\t\t\t\t\t=\tfonte.[Log Improdutivo]\n\t\t\t,destino.[Tempo Livre]\t\t\t\t\t\t=\tfonte.[Tempo Livre]\n\t\t\t,destino.[Pausa Particular (Intelix)]\t\t=\tfonte.[Pausa Particular (Intelix)]\n\t\t\t,destino.[Pausa Break (Intelix)]\t\t\t=\tfonte.[Pausa Break (Intelix)]\n\t\t\t,destino.[Pausa 10 (Intelix)]\t\t\t\t=\tfonte.[Pausa 10 (Intelix)]\n\t\t\t,destino.[Pausa Outbound (Intelix)]\t\t\t=\tfonte.[Pausa Outbound (Intelix)]\n\t\t\t,destino.[Pausa Lanche (Intelix)]\t\t\t=\tfonte.[Pausa Lanche (Intelix)]\n\t\t\t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\tfonte.[Pausa R\u00e1pida (Intelix)]\n\t\t\t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tfonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t\t,destino.[Pausa Feedback (Intelix)]\t\t\t=\tfonte.[Pausa Feedback (Intelix)]\n\t\t\t,destino.[Pausa Sistema Interno (Intelix)]\t=\tfonte.[Pausa Sistema Interno (Intelix)]\n\t\t\t,destino.[Pausa Sistema Externo (Intelix)]\t=\tfonte.[Pausa Sistema Externo (Intelix)]\n\t\t\t,destino.[Pausa Treinamento (Intelix)]\t\t=\tfonte.[Pausa Treinamento (Intelix)]\n\t\t\t,destino.[Pausa Banheiro (Intelix)]\t\t\t=\tfonte.[Pausa Banheiro (Intelix)]\n\t\t\t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tfonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t\t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tfonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t\t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tfonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t\t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tfonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t\t,destino.[Pausa Tratativa (EPBX)]\t\t\t=\tfonte.[Pausa Tratativa (EPBX)]\n\t\t\t,destino.[Pausa Discagem Manual (EPBX)]\t\t=\tfonte.[Pausa Discagem Manual (EPBX)]\n\t\t\t,destino.[Pausa Banheiro (EPBX)]\t\t\t=\tfonte.[Pausa Banheiro (EPBX)]\n\t\t\t,destino.[Pausa WhatsApp (EPBX)]\t\t\t=\tfonte.[Pausa WhatsApp (EPBX)]\n\t\t\t,destino.[Pausa Intervalo (EPBX)]\t\t\t=\tfonte.[Pausa Intervalo (EPBX)]\n\t\t\t,destino.[Pausa Discagem Retorno (EPBX)]\t=\tfonte.[Pausa Discagem Retorno (EPBX)]\n\t\t\t,destino.[Pausa Treinamento (EPBX)]\t\t\t=\tfonte.[Pausa Treinamento (EPBX)]\n\t\t\t,destino.[Pausa Feedback (EPBX)]\t\t\t=\tfonte.[Pausa Feedback (EPBX)]\n\t\t\t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\tfonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t\t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tfonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t\t,destino.[Pausa Login (EPBX)]\t\t\t\t=\tfonte.[Pausa Login (EPBX)]\n\t\t\t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tfonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t\t,destino.[Pausa Sistema Interno (EPBX)]\t\t=\tfonte.[Pausa Sistema Interno (EPBX)]\n\t\t\t,destino.[Pausa Sistema Externo (EPBX)]\t\t=\tfonte.[Pausa Sistema Externo (EPBX)]\n\t\t\t,destino.[Pausa NR17 (EPBX)]\t\t\t\t=\tfonte.[Pausa NR17 (EPBX)]\n\t\t\t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tfonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t\t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tfonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t\t,destino.[Pausa Lanche (EPBX)]\t\t\t\t=\tfonte.[Pausa Lanche (EPBX)]\n\t\t\t,destino.[Pausa BackOffice (EPBX)]\t\t\t=\tfonte.[Pausa BackOffice (EPBX)]\n\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tfonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tfonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t=\tfonte.[Pausa Banheiro (Genesys)]\n\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t=\tfonte.[Pausa Descanso (Genesys)]\n\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t=\tfonte.[Pausa Feedback (Genesys)]\n\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t=\tfonte.[Pausa Backoffice (Genesys)]\n\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t=\tfonte.[Pausa Discagem Manual (Genesys)]\n\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t=\tfonte.[Pausa Discagem Retorno (Genesys)]\n\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\tfonte.[Pausa Dispon\u00edvel (Genesys)]\n\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t=\tfonte.[Pausa Em Fila (Genesys)]\n\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t=\tfonte.[Pausa Sistema Externo (Genesys)]\n\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t=\tfonte.[Pausa Sistema Interno (Genesys)]\n\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t=\tfonte.[Pausa Tratativa (Genesys)]\n\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t=\tfonte.[Pausa Whatsapp (Genesys)]\n\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t=\tfonte.[Pausa Treinamento (Genesys)]\n\t\t\t\n\n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tUPDATE SET\n\t\t\t destino.[Escala]\t\t\t\t\t\t\t=\tNULL\n\t\t\t,destino.[Jornada (Log)]\t\t\t\t\t=\t0\n\t\t\t,destino.[Login]\t\t\t\t\t\t\t=\tNULL\n\t\t\t,destino.[Logout]\t\t\t\t\t\t\t=\tNULL\n\t\t\t,destino.[Log descartado (>2HE)]\t\t\t=\t0\n\t\t\t,destino.[HE]\t\t\t\t\t\t\t\t=\t0\n\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t=\t0\n\t\t\t,destino.[Log Produtivo]\t\t\t\t\t=\t0\n\t\t\t,destino.[Log Improdutivo]\t\t\t\t\t=\t0\n\t\t\t,destino.[Tempo Livre]\t\t\t\t\t\t=\t0\n\t\t\t,destino.[Pausa Particular (Intelix)]\t\t=\t0\n\t\t\t,destino.[Pausa Break (Intelix)]\t\t\t=\t0\n\t\t\t,destino.[Pausa 10 (Intelix)]\t\t\t\t=\t0\n\t\t\t,destino.[Pausa Outbound (Intelix)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Lanche (Intelix)]\t\t\t=\t0\n\t\t\t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Feedback (Intelix)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Sistema Interno (Intelix)]\t=\t0\n\t\t\t,destino.[Pausa Sistema Externo (Intelix)]\t=\t0\n\t\t\t,destino.[Pausa Treinamento (Intelix)]\t\t=\t0\n\t\t\t,destino.[Pausa Banheiro (Intelix)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\t0\n\t\t\t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\t0\n\t\t\t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\t0\n\t\t\t,destino.[Pausa Tratativa (EPBX)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Discagem Manual (EPBX)]\t\t=\t0\n\t\t\t,destino.[Pausa Banheiro (EPBX)]\t\t\t=\t0\n\t\t\t,destino.[Pausa WhatsApp (EPBX)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Intervalo (EPBX)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Discagem Retorno (EPBX)]\t=\t0\n\t\t\t,destino.[Pausa Treinamento (EPBX)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Feedback (EPBX)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\t0\n\t\t\t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\t0\n\t\t\t,destino.[Pausa Login (EPBX)]\t\t\t\t=\t0\n\t\t\t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\t0\n\t\t\t,destino.[Pausa Sistema Interno (EPBX)]\t\t=\t0\n\t\t\t,destino.[Pausa Sistema Externo (EPBX)]\t\t=\t0\n\t\t\t,destino.[Pausa NR17 (EPBX)]\t\t\t\t=\t0\n\t\t\t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\t0\n\t\t\t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\t0\n\t\t\t,destino.[Pausa Lanche (EPBX)]\t\t\t\t=\t0\n\t\t\t,destino.[Pausa BackOffice (EPBX)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\t0\n\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t=\t0\n\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t=\t0\n\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t=\t0\n\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\t0\n\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t=\t0\n\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t=\t0\n\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t=\t0\n\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t=\t0\n\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t=\t0\n\t;\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Finaliza\u00e7\u00e3o (Limpeza de nulos, c\u00e1lculos finais, etc)\n\n\tWITH destino AS\n\t(\n\t\tSELECT * FROM [r_individuo_30min_teste]\n\t\tWHERE [DataHora] >= @datahora_inicio \n\t\tAND\t  [DataHora] <= @datahora_fim \n\t)\n\tMERGE INTO destino USING \n\t(\n\t\tSELECT\n\t\t\t [DataHora]\t\t\t\t\t\t\t=\tc.[DataHora]\n\t\t\t,[Intervalo]\t\t\t\t\t\t=\tc.[Intervalo]\n\t\t\t,[Data]\t\t\t\t\t\t\t\t=\tc.[Data]\n\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t=\tc.[Ciclo (Primeiro Dia)]\n\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t=\tc.[M\u00eas (Primeiro Dia)]\n\t\t\t,[Feriado]\t\t\t\t\t\t\t=\tc.[Feriado]\n\t\t\t,[Folga]\t\t\t\t\t\t\t=\tc.Folga\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tc.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,[ID Selecionar]\t\t\t\t\t=\tc.[ID Selecionar]\n\t\t\t,[Nome]\t\t\t\t\t\t\t\t=\tc.[Nome]\n\t\t\t,[Status]\t\t\t\t\t\t\t=\tc.[Status]\n\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tc.[Situa\u00e7\u00e3o]\n\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tc.[Condi\u00e7\u00e3o]\t\n\n\t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tc.[DMA Inicial]\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tc.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tc.[\u00daltima DMA Geral]\n\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tc.[Tipo da \u00daltima DMA]\n\t\t\t,[Instrutor Inicial]\t\t\t\t=\tc.[Instrutor Inicial]\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tc.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tc.[Instrutor \u00daltima DMA]\n\n\t\t\t,[Cliente]\t\t\t\t\t\t\t=\tc.[Cliente]\n\t\t\t,[Projeto]\t\t\t\t\t\t\t=\tc.[Projeto]\n\t\t\t,[Cargo]\t\t\t\t\t\t\t=\tc.[Cargo]\n\t\t\t,[Tribo]\t\t\t\t\t\t\t=\tc.[Tribo]\n\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tc.[Supervis\u00e3o]\n\t\t\t,[Turno]\t\t\t\t\t\t\t=\tc.[Turno]\n\t\t\t,[Escala]\t\t\t\t\t\t\t=\tc.[Escala]\n\t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tc.[Jornada (Ponto)]\n\t\t\t,[Jornada (Log)]\t\t\t\t\t=\tc.[Jornada (Log)]\n\n\t\t\t\n\t\t\t,[log_dia]\t\t\t\t\t\t\t=\t\tSUM(r.[Log]) OVER (PARTITION BY r.[Data], r.[ID Selecionar], r.[Cliente], r.[Projeto], r.[Tribo])\n\n\n\t\tFROM #chaves c\n\t\tLEFT JOIN r_individuo_30min_teste r\n\t\tON r.[DataHora] = c.[DataHora] \n\t\tAND COALESCE(r.[ID Selecionar], '-') = COALESCE(c.[ID Selecionar], '-') \n\t\tAND COALESCE(r.[Tribo], '-') = COALESCE(c.[Tribo], '-')\n\t\tWHERE c.[DataHora] >= @datahora_inicio \n\t\tAND\t  c.[DataHora] <= @datahora_fim \n\t) AS fonte\n\tON  fonte.[DataHora]\t\t=\tdestino.[DataHora]\n\tAND COALESCE(fonte.[ID Selecionar], '-')\t=\tCOALESCE(destino.[ID Selecionar], '-')\n\t--AND fonte.[Tribo]\t\t\t=\tdestino.[Tribo]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT (\n\t\t\t [DataHora]\n\t\t\t,[Intervalo]\n\t\t\t,[Data]\n\t\t\t,[Ciclo (Primeiro Dia)]\n\t\t\t,[M\u00eas (Primeiro Dia)]\n\t\t\t,[Feriado]\n\t\t\t,[Folga]\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,[ID Selecionar]\n\t\t\t,[Nome]\n\t\t\t,[Status]\n\t\t\t,[Situa\u00e7\u00e3o]\n\t\t\t,[Condi\u00e7\u00e3o]\n\t\t\t,[DMA Inicial]\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,[\u00daltima DMA Geral]\n\t\t\t,[Tipo da \u00daltima DMA]\n\t\t\t,[Instrutor Inicial]\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,[Instrutor \u00daltima DMA]\n\t\t\t,[Cliente]\n\t\t\t,[Projeto]\n\t\t\t,[Cargo]\n\t\t\t,[Tribo]\n\t\t\t,[Supervis\u00e3o]\n\t\t\t,[Turno]\n\t\t\t,[Escala]\n\t\t\t,[Jornada (Ponto)]\n\t\t\t,[Jornada (Log)]\n\t\t\t,[Tipo de Jornada]\n\t\t) \n\t\tVALUES \n\t\t(\n\t\t\t fonte.[DataHora]\n\t\t\t,fonte.[Intervalo]\n\t\t\t,fonte.[Data]\n\t\t\t,fonte.[Ciclo (Primeiro Dia)]\n\t\t\t,fonte.[M\u00eas (Primeiro Dia)]\n\t\t\t,fonte.[Feriado]\n\t\t\t,fonte.[Folga]\n\t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,fonte.[ID Selecionar]\n\t\t\t,fonte.[Nome]\n\t\t\t,fonte.[Status]\n\t\t\t,fonte.[Situa\u00e7\u00e3o]\n\t\t\t,fonte.[Condi\u00e7\u00e3o]\n\t\t\t,fonte.[DMA Inicial]\n\t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,fonte.[\u00daltima DMA Geral]\n\t\t\t,fonte.[Tipo da \u00daltima DMA]\n\t\t\t,fonte.[Instrutor Inicial]\n\t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,fonte.[Instrutor \u00daltima DMA]\n\t\t\t,fonte.[Cliente]\n\t\t\t,fonte.[Projeto]\n\t\t\t,fonte.[Cargo]\n\t\t\t,fonte.[Tribo]\n\t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t,fonte.[Turno]\n\t\t\t,fonte.[Escala]\n\t\t\t,fonte.[Jornada (Ponto)]\n\t\t\t,fonte.[Jornada (Log)]\n\t\t\t,CASE \n\t\t\t\tWHEN fonte.[Feriado] IS NOT NULL\t\tTHEN 'FERIADO'\n\t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\tTHEN 'TREINAMENTO' \n\t\t\t\tWHEN [Jornada (Log)] = 0\t\t\t\tTHEN 'OK'\n\t\t\t\tWHEN [Jornada (Log)] > 0\t\t\t\tTHEN 'FALTA'\n\t\t\t END\n\t\t)\t\n\n\tWHEN MATCHED AND\t(\t \n\t\t\t --destino.[Jornada (Ponto)]\t\t\t\t\t=\t0\n\t\t\t fonte.[Jornada (Log)]\t\t\t\t\t=\t0\n\n\t\t AND destino.[Login]\t\t\t\t\t\t\tIS\tNULL\n\t\t AND destino.[Logout]\t\t\t\t\t\t\tIS\tNULL\n\t\t AND destino.[Log descartado (>2HE)]\t\t\t=\t0\n\t\t AND destino.[HE]\t\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Log]\t\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Log Produtivo]\t\t\t\t\t=\t0\n\t\t AND destino.[Log Improdutivo]\t\t\t\t\t=\t0\n\t\t AND destino.[Tempo Livre]\t\t\t\t\t\t=\t0\n\t\t AND destino.[Pausa Particular (Intelix)]\t\t=\t0\n\t\t AND destino.[Pausa Break (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa 10 (Intelix)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Outbound (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Lanche (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Feedback (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Sistema Interno (Intelix)]\t=\t0\n\t\t AND destino.[Pausa Sistema Externo (Intelix)]\t=\t0\n\t\t AND destino.[Pausa Treinamento (Intelix)]\t\t=\t0\n\t\t AND destino.[Pausa Banheiro (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\t0\n\t\t AND destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Tratativa (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Discagem Manual (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa Banheiro (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa WhatsApp (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Intervalo (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Discagem Retorno (EPBX)]\t=\t0\n\t\t AND destino.[Pausa Treinamento (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Feedback (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa Login (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Sistema Interno (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa Sistema Externo (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa NR17 (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa Lanche (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa BackOffice (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\t0\n\t\t AND destino.[Pausa Banheiro (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Descanso (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Feedback (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Backoffice (Genesys)]\t\t=\t0\n\t\t AND destino.[Pausa Discagem Manual (Genesys)]\t=\t0\n\t\t AND destino.[Pausa Discagem Retorno (Genesys)]\t=\t0\n\t\t AND destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\t0\n\t\t AND destino.[Pausa Em Fila (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Sistema Externo (Genesys)]\t=\t0\n\t\t AND destino.[Pausa Sistema Interno (Genesys)]\t=\t0\n\t\t AND destino.[Pausa Tratativa (Genesys)]\t\t=\t0\n\t\t AND destino.[Pausa Whatsapp (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Treinamento (Genesys)]\t\t=\t0\n\n\t\t AND destino.[Criados]\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Tratados]\t\t\t\t\t\t\t=\t0\n\t\t --AND destino.[Tratados Com TMT]\t\t\t\t=\t0\n\t\t AND destino.[Tempo Total de Tratativa]\t\t\t=\t0\n\t\t AND destino.[TMT]\t\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[N\u00e3o Resolvidos]\t\t\t\t\t=\t0\n\t\t AND destino.[Replicas]\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Reincidentes 48h]\t\t\t\t\t=\t0\n\t\t AND destino.[Reincidentes 30d]\t\t\t\t\t=\t0\n\n\t\t AND destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n\t\t AND destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n\t\t AND destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n\t\t AND destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t\n\t\t AND destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n\t\t AND destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n\t\t AND destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n\t\t AND destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t\n\t\t AND destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t=\t0\n\t\t AND destino.[Promotoras]\t\t\t\t\t\t=\t0\n\t\t AND destino.[Neutras]\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Detratoras]\t\t\t\t\t\t=\t0\n\t\t AND destino.[NPS]\t\t\t\t\t\t\t\tIS\tNULL\n\t\t)\n\tTHEN DELETE\n\n\tWHEN MATCHED THEN \n\t\tUPDATE SET\n\t\t\t destino.[Intervalo]\t\t\t\t\t\t=\tfonte.[Intervalo]\n\t\t\t,destino.[Data]\t\t\t\t\t\t\t\t=\tfonte.[Data]\n\t\t\t,destino.[Ciclo (Primeiro Dia)]\t\t\t\t=\tfonte.[Ciclo (Primeiro Dia)]\n\t\t\t,destino.[M\u00eas (Primeiro Dia)]\t\t\t\t=\tfonte.[M\u00eas (Primeiro Dia)]\n\t\t\t,destino.[Feriado]\t\t\t\t\t\t\t=\tfonte.[Feriado]\n\t\t\t,destino.[Folga]\t\t\t\t\t\t\t=\tfonte.[Folga]\n\t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tfonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t=\tfonte.[Nome]\n\t\t\t,destino.[Status]\t\t\t\t\t\t\t=\tfonte.[Status]\n\t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tfonte.[Situa\u00e7\u00e3o]\n\t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tfonte.[Condi\u00e7\u00e3o]\n\t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t=\tfonte.[DMA Inicial]\n\t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tfonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t=\tfonte.[\u00daltima DMA Geral]\n\t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t=\tfonte.[Tipo da \u00daltima DMA]\n\t\t\t,destino.[Instrutor Inicial]\t\t\t\t=\tfonte.[Instrutor Inicial]\n\t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tfonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t=\tfonte.[Instrutor \u00daltima DMA]\n\t\t\t,destino.[Cliente]\t\t\t\t\t\t\t=\tISNULL(IIF(destino.[Tribo] = fonte.[Tribo], destino.[Cliente], fonte.[Cliente]), fonte.[Cliente])\n\t\t\t,destino.[Projeto]\t\t\t\t\t\t\t=\tISNULL(IIF(destino.[Tribo] = fonte.[Tribo], destino.[Projeto], fonte.[Projeto]), fonte.[Projeto])\n\t\t\t,destino.[Cargo]\t\t\t\t\t\t\t=\tfonte.[Cargo]\n\t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t=\tfonte.[Supervis\u00e3o]\n\t\t\t,destino.[Turno]\t\t\t\t\t\t\t=\tIIF(destino.[Tribo] = fonte.[Tribo], fonte.[Turno], null)\n\t\t\t,destino.[Escala]\t\t\t\t\t\t\t=\tIIF(destino.[Tribo] = fonte.[Tribo], fonte.[Escala], null)\n\t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t=\tIIF(destino.[Tribo] = fonte.[Tribo], fonte.[Jornada (Ponto)], 0)\n\t\t\t,destino.[Jornada (Log)]\t\t\t\t\t=\tIIF(destino.[Tribo] = fonte.[Tribo], fonte.[Jornada (Log)], 0)\n\t\t\t,destino.[Tipo de Jornada]\t\t\t\t\t= CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Feriado] IS NOT NULL\t\tTHEN 'FERIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN fonte.[Status] = 'Treinamento'\t\tTHEN 'TREINAMENTO' \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF(destino.[Tribo] = fonte.[Tribo], fonte.[Jornada (Log)], 0) = [log_dia]\t\t\t\tTHEN 'OK'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [log_dia] = 0 AND IIF(destino.[Tribo] = fonte.[Tribo], fonte.[Jornada (Log)], 0) > 0\t\tTHEN 'FALTA'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF(destino.[Tribo] = fonte.[Tribo], fonte.[Jornada (Log)], 0) > [log_dia]\t\t\t\tTHEN 'ABS'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF(destino.[Tribo] = fonte.[Tribo], fonte.[Jornada (Log)], 0) < [log_dia]\t\t\t\tTHEN 'HE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  END\n\n\tWHEN NOT MATCHED BY SOURCE \n\tAND\t(\t \n\t\t\t --destino.[Jornada (Ponto)]\t\t\t\t\t=\t0\n\t\t\t destino.[Jornada (Log)]\t\t\t\t\t=\t0\n\t\n\t\t AND destino.[Login]\t\t\t\t\t\t\tIS\tNULL\n\t\t AND destino.[Logout]\t\t\t\t\t\t\tIS\tNULL\n\t\t AND destino.[Log descartado (>2HE)]\t\t\t=\t0\n\t\t AND destino.[HE]\t\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Log]\t\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Log Produtivo]\t\t\t\t\t=\t0\n\t\t AND destino.[Log Improdutivo]\t\t\t\t\t=\t0\n\t\t AND destino.[Tempo Livre]\t\t\t\t\t\t=\t0\n\t\t AND destino.[Pausa Particular (Intelix)]\t\t=\t0\n\t\t AND destino.[Pausa Break (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa 10 (Intelix)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Outbound (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Lanche (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa R\u00e1pida (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Feedback (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Sistema Interno (Intelix)]\t=\t0\n\t\t AND destino.[Pausa Sistema Externo (Intelix)]\t=\t0\n\t\t AND destino.[Pausa Treinamento (Intelix)]\t\t=\t0\n\t\t AND destino.[Pausa Banheiro (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\t0\n\t\t AND destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\t0\n\t\t AND destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Tratativa (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Discagem Manual (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa Banheiro (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa WhatsApp (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Intervalo (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Discagem Retorno (EPBX)]\t=\t0\n\t\t AND destino.[Pausa Treinamento (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Feedback (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Transfer\u00eancia (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa Login (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Sistema Interno (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa Sistema Externo (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa NR17 (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\t0\n\t\t AND destino.[Pausa Lanche (EPBX)]\t\t\t\t=\t0\n\t\t AND destino.[Pausa BackOffice (EPBX)]\t\t\t=\t0\n\t\t AND destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\t0\n\t\t AND destino.[Pausa Banheiro (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Descanso (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Feedback (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Backoffice (Genesys)]\t\t=\t0\n\t\t AND destino.[Pausa Discagem Manual (Genesys)]\t=\t0\n\t\t AND destino.[Pausa Discagem Retorno (Genesys)]\t=\t0\n\t\t AND destino.[Pausa Dispon\u00edvel (Genesys)]\t\t=\t0\n\t\t AND destino.[Pausa Em Fila (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Sistema Externo (Genesys)]\t=\t0\n\t\t AND destino.[Pausa Sistema Interno (Genesys)]\t=\t0\n\t\t AND destino.[Pausa Tratativa (Genesys)]\t\t=\t0\n\t\t AND destino.[Pausa Whatsapp (Genesys)]\t\t\t=\t0\n\t\t AND destino.[Pausa Treinamento (Genesys)]\t\t=\t0\n\n\t\t AND destino.[Criados]\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Tratados]\t\t\t\t\t\t\t=\t0\n\t\t --AND destino.[Tratados Com TMT]\t\t\t\t=\t0\n\t\t AND destino.[Tempo Total de Tratativa]\t\t\t=\t0\n\t\t AND destino.[TMT]\t\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[N\u00e3o Resolvidos]\t\t\t\t\t=\t0\n\t\t AND destino.[Replicas]\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Reincidentes 48h]\t\t\t\t\t=\t0\n\t\t AND destino.[Reincidentes 30d]\t\t\t\t\t=\t0\n\n\t\t AND destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n\t\t AND destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n\t\t AND destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n\t\t AND destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t\t\n\t\t AND destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= 0\n\t\t AND destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= 0\n\t\t AND destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= 0\n\t\t AND destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= 0\n\t\t AND destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= 0\n\n\t\t AND destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t=\t0\n\t\t AND destino.[Promotoras]\t\t\t\t\t\t=\t0\n\t\t AND destino.[Neutras]\t\t\t\t\t\t\t=\t0\n\t\t AND destino.[Detratoras]\t\t\t\t\t\t=\t0\n\t\t AND destino.[NPS]\t\t\t\t\t\t\t\tIS\tNULL\n\n\t\t)\n\tTHEN DELETE;\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nIF 1=1 BEGIN -- Agrupamento p/ individuo dia\n\t\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'r_individuo_dia_teste' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[r_individuo_dia_teste](\n\t\t\t [Data]\t\t\t\t\t\t\t\t[date]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t[date]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t[date]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Feriado]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Folga]\t\t\t\t\t\t\t[bit]\t\t\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t[datetime2](0)\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[ID Selecionar]\t\t\t\t\t[varchar](30)\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[Nome]\t\t\t\t\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[Status]\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL --ADD\n\t\t\t\n\t\t\t,[DMA Inicial]\t\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor Inicial]\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\n\t\t\t,[Cliente]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Projeto]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Cargo]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Tribo]\t\t\t\t\t\t\t[varchar](50)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t[varchar](100)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Turno]\t\t\t\t\t\t\t[varchar](10)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Escala]\t\t\t\t\t\t\t[varchar](15)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Jornada (Ponto)]\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT 0\n\t\t\t,[Jornada (Log)]\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT 0\n\t\t\t,[Tipo de Jornada]\t\t\t\t\t[varchar](25)\tNULL\t\tDEFAULT NULL\n\t\t\t,[Login]\t\t\t\t\t\t\t[time](0)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Logout]\t\t\t\t\t\t\t[time](0)\t\tNULL\t\tDEFAULT NULL\n\t\t\t,[Log descartado (>2HE)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[HE]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log Produtivo]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Log Improdutivo]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tempo Livre]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Particular (Intelix)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Break (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa 10 (Intelix)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Outbound (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Lanche (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa R\u00e1pida (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Feedback (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Interno (Intelix)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Externo (Intelix)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (Intelix)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Banheiro (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Tratativa (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Discagem Manual (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Banheiro (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa WhatsApp (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Intervalo (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Discagem Retorno (EPBX)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Feedback (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Transfer\u00eancia (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Login (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Interno (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Sistema Externo (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa NR17 (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Lanche (EPBX)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa BackOffice (EPBX)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Banheiro (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Descanso (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Feedback (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Backoffice (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Discagem Manual (Genesys)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Discagem Retorno (Genesys)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Em Fila (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Sistema Externo (Genesys)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Sistema Interno (Genesys)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Tratativa (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Pausa Treinamento (Genesys)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Criados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tratados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Tempo Total de Tratativa]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[TMT]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Replicas]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Reincidentes 48h]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Reincidentes 30d]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t[decimal](16,2)\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t[decimal](16,2)\tNOT NULL\tDEFAULT 0\n\n\t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t[decimal](16,2)\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t[decimal](16,2)\tNOT NULL\tDEFAULT 0\n\n\n\t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Promotoras]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Neutras]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[Detratoras]\t\t\t\t\t\t[int]\t\t\tNOT NULL\tDEFAULT 0\n\t\t\t,[NPS]\t\t\t\t\t\t\t\t[int]\t\t\tNULL\t\tDEFAULT NULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\t;WITH destino AS\n\t(\n\t\tSELECT * FROM [r_individuo_dia_teste]\n\t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n\t\tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n\t)\n\tMERGE INTO destino USING \n\t(\n\t\tSELECT\n\t\t\t [Data]\t\t\t\t\t\t\t\t=\t[Data]\n\t\t\t,[Ciclo (Primeiro Dia)]\t\t\t\t=\tMIN([Ciclo (Primeiro Dia)])\n\t\t\t,[M\u00eas (Primeiro Dia)]\t\t\t\t=\tMIN([M\u00eas (Primeiro Dia)])\n\t\t\t,[Feriado]\t\t\t\t\t\t\t=\tMIN([Feriado])\n\t\t\t,[Folga]\t\t\t\t\t\t\t=\t[Folga]\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\t=\tMIN([DataHora da Atualiza\u00e7\u00e3o do MOP])\n\t\t\t,[ID Selecionar]\t\t\t\t\t=\tMIN([ID Selecionar])\n\t\t\t,[Nome]\t\t\t\t\t\t\t\t=\tMIN([Nome])\n\t\t\t,[Status]\t\t\t\t\t\t\t=\tMIN([Status])\n\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([Situa\u00e7\u00e3o])\n\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t=\tMIN([Condi\u00e7\u00e3o])\n\t\t\t\n\t\t\t,[DMA Inicial]\t\t\t\t\t\t=\tMIN([DMA Inicial])\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t=\tMIN([\u00daltima DMA Migra\u00e7\u00e3o])\n\t\t\t,[\u00daltima DMA Geral]\t\t\t\t\t=\tMIN([\u00daltima DMA Geral])\n\t\t\t,[Tipo da \u00daltima DMA]\t\t\t\t=\tMIN([Tipo da \u00daltima DMA])\n\t\t\t,[Instrutor Inicial]\t\t\t\t=\tMIN([Instrutor Inicial])\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t=\tMIN([Instrutor \u00daltima Migra\u00e7\u00e3o])\n\t\t\t,[Instrutor \u00daltima DMA]\t\t\t\t=\tMIN([Instrutor \u00daltima DMA])\n\n\t\t\t,[Cliente]\t\t\t\t\t\t\t=\t[Cliente]\n\t\t\t,[Projeto]\t\t\t\t\t\t\t=\t[Projeto]\n\t\t\t,[Cargo]\t\t\t\t\t\t\t=\tMIN([Cargo])\n\t\t\t,[Tribo]\t\t\t\t\t\t\t=\t[Tribo]\n\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t=\tMIN([Supervis\u00e3o])\n\t\t\t,[Turno]\t\t\t\t\t\t\t=\tMIN([Turno])\n\t\t\t,[Escala]\t\t\t\t\t\t\t=\tMIN([Escala])\n\t\t\t,[Jornada (Ponto)]\t\t\t\t\t=\tMIN([Jornada (Ponto)])\n\t\t\t,[Jornada (Log)]\t\t\t\t\t=\tMIN([Jornada (Log)])\n\t\t\t,[Tipo de Jornada]\t\t\t\t\t=\t CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Feriado]) IS NOT NULL\t\t\t\t\t\t\t\t\t\t\t\tTHEN 'FERIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN MIN([Status]) = 'Treinamento'\t\t\t\t\t\t\t\t\t\t\tTHEN 'TREINAMENTO' \n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo] = [Tribo], MAX([Jornada (Log)]), 0) = SUM([Log])\t\t\tTHEN 'OK'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN SUM([Log]) = 0 AND IIF([Tribo] = [Tribo], MAX([Jornada (Log)]), 0) > 0\tTHEN 'FALTA'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo] = [Tribo], MAX([Jornada (Log)]), 0) > SUM([Log])\t\t\tTHEN 'ABS'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN IIF([Tribo] = [Tribo], MAX([Jornada (Log)]), 0) < SUM([Log])\t\t\tTHEN 'HE'\n\t\t\t\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t,[Login]\t\t\t\t\t\t\t=\tMIN([Login])\n\t\t\t,[Logout]\t\t\t\t\t\t\t=\tMAX([Logout])\n\t\t\t,[Log descartado (>2HE)]\t\t\t=\tSUM([Log descartado (>2HE)])\n\t\t\t,[HE]\t\t\t\t\t\t\t\t=\tSUM([HE])\n\t\t\t,[Log]\t\t\t\t\t\t\t\t=\tSUM([Log])\n\t\t\t,[Log Produtivo]\t\t\t\t\t=\tSUM([Log Produtivo])\n\t\t \t,[Log Improdutivo]\t\t\t\t\t=\tSUM([Log Improdutivo])\n\t\t \t,[Tempo Livre]\t\t\t\t\t\t=\tSUM([Tempo Livre])\n\t\t \t,[Pausa Particular (Intelix)]\t\t=\tSUM([Pausa Particular (Intelix)])\n\t\t \t,[Pausa Break (Intelix)]\t\t\t=\tSUM([Pausa Break (Intelix)])\n\t\t \t,[Pausa 10 (Intelix)]\t\t\t\t=\tSUM([Pausa 10 (Intelix)])\n\t\t \t,[Pausa Outbound (Intelix)]\t\t\t=\tSUM([Pausa Outbound (Intelix)])\n\t\t  \t,[Pausa Lanche (Intelix)]\t\t\t=\tSUM([Pausa Lanche (Intelix)])\n\t\t  \t,[Pausa R\u00e1pida (Intelix)]\t\t\t=\tSUM([Pausa R\u00e1pida (Intelix)])\n\t\t  \t,[Pausa Almo\u00e7o (Intelix)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Intelix)])\n\t\t  \t,[Pausa Feedback (Intelix)]\t\t\t=\tSUM([Pausa Feedback (Intelix)])\n\t\t  \t,[Pausa Sistema Interno (Intelix)]\t=\tSUM([Pausa Sistema Interno (Intelix)])\n\t\t  \t,[Pausa Sistema Externo (Intelix)]\t=\tSUM([Pausa Sistema Externo (Intelix)])\n\t\t  \t,[Pausa Treinamento (Intelix)]\t\t=\tSUM([Pausa Treinamento (Intelix)])\n\t\t  \t,[Pausa Banheiro (Intelix)]\t\t\t=\tSUM([Pausa Banheiro (Intelix)])\n\t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\t\t\t=\tSUM([Pausa Reuni\u00e3o (Intelix)])\n\t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Intelix)])\n\t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Liga\u00e7\u00e3o (EPBX)])\n\t\t  \t,[Pausa Almo\u00e7o (EPBX)]\t\t\t\t=\tSUM([Pausa Almo\u00e7o (EPBX)])\n\t\t  \t,[Pausa Tratativa (EPBX)]\t\t\t=\tSUM([Pausa Tratativa (EPBX)])\n\t\t  \t,[Pausa Discagem Manual (EPBX)]\t\t=\tSUM([Pausa Discagem Manual (EPBX)])\n\t\t  \t,[Pausa Banheiro (EPBX)]\t\t\t=\tSUM([Pausa Banheiro (EPBX)])\n\t\t  \t,[Pausa WhatsApp (EPBX)]\t\t\t=\tSUM([Pausa WhatsApp (EPBX)])\n\t\t  \t,[Pausa Intervalo (EPBX)]\t\t\t=\tSUM([Pausa Intervalo (EPBX)])\n\t\t  \t,[Pausa Discagem Retorno (EPBX)]\t=\tSUM([Pausa Discagem Retorno (EPBX)])\n\t\t  \t,[Pausa Treinamento (EPBX)]\t\t\t=\tSUM([Pausa Treinamento (EPBX)])\n\t\t  \t,[Pausa Feedback (EPBX)]\t\t\t=\tSUM([Pausa Feedback (EPBX)])\n\t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\t\t=\tSUM([Pausa Transfer\u00eancia (EPBX)])\n\t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\t\t=\tSUM([Pausa N\u00e3o Disponivel (EPBX)])\n\t\t  \t,[Pausa Login (EPBX)]\t\t\t\t=\tSUM([Pausa Login (EPBX)])\n\t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t=\tSUM([Pausa Reuni\u00e3o (EPBX)])\n\t\t  \t,[Pausa Sistema Interno (EPBX)]\t\t=\tSUM([Pausa Sistema Interno (EPBX)])\n\t\t  \t,[Pausa Sistema Externo (EPBX)]\t\t=\tSUM([Pausa Sistema Externo (EPBX)])\n\t\t  \t,[Pausa NR17 (EPBX)]\t\t\t\t=\tSUM([Pausa NR17 (EPBX)])\n\t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t=\tSUM([Pausa Ambulat\u00f3rio (EPBX)])\n\t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\t\t=\tSUM([Pausa P\u00f3s Atendimento (EPBX)])\n\t\t  \t,[Pausa Lanche (EPBX)]\t\t\t\t=\tSUM([Pausa Lanche (EPBX)])\n\t\t  \t,[Pausa BackOffice (EPBX)]\t\t\t=\tSUM([Pausa BackOffice (EPBX)])\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\t\t\t=\tSUM([Pausa Almo\u00e7o (Genesys)])\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\t\t=\tSUM([Pausa Ambulat\u00f3rio (Genesys)])\n\t\t \t,[Pausa Banheiro (Genesys)]\t\t\t=\tSUM([Pausa Banheiro (Genesys)])\n\t\t \t,[Pausa Descanso (Genesys)]\t\t\t=\tSUM([Pausa Descanso (Genesys)])\n\t\t \t,[Pausa Feedback (Genesys)]\t\t\t=\tSUM([Pausa Feedback (Genesys)])\n\t\t \t,[Pausa Backoffice (Genesys)]\t\t=\tSUM([Pausa Backoffice (Genesys)])\n\t\t \t,[Pausa Discagem Manual (Genesys)]\t=\tSUM([Pausa Discagem Manual (Genesys)])\n\t\t \t,[Pausa Discagem Retorno (Genesys)]\t=\tSUM([Pausa Discagem Retorno (Genesys)])\n\t\t \t,[Pausa Dispon\u00edvel (Genesys)]\t\t=\tSUM([Pausa Dispon\u00edvel (Genesys)])\n\t\t \t,[Pausa Em Fila (Genesys)]\t\t\t=\tSUM([Pausa Em Fila (Genesys)])\n\t\t \t,[Pausa Sistema Externo (Genesys)]\t=\tSUM([Pausa Sistema Externo (Genesys)])\n\t\t \t,[Pausa Sistema Interno (Genesys)]\t=\tSUM([Pausa Sistema Interno (Genesys)])\n\t\t \t,[Pausa Tratativa (Genesys)]\t\t=\tSUM([Pausa Tratativa (Genesys)])\n\t\t \t,[Pausa Whatsapp (Genesys)]\t\t\t=\tSUM([Pausa Whatsapp (Genesys)])\n\t\t\t,[Pausa Treinamento (Genesys)]\t\t=\tSUM([Pausa Treinamento (Genesys)])\n\t\t\t\n\t\t\t,[Criados]\t\t\t\t\t\t\t=\tSUM([Criados])\n\t\t\t,[Tratados]\t\t\t\t\t\t\t=\tSUM([Tratados])\n\t\t\t,[Tempo Total de Tratativa]\t\t\t=\tSUM([Tempo Total de Tratativa])\n\t\t\t,[TMT]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Tempo Total de Tratativa])/NULLIF(SUM([Tratados]),0),0)\n\t\t\t,[N\u00e3o Resolvidos]\t\t\t\t\t=\tSUM([N\u00e3o Resolvidos])\n\t\t\t,[Replicas]\t\t\t\t\t\t\t=\tSUM([Replicas])\n\t\t\t,[Reincidentes 48h]\t\t\t\t\t=\tSUM([Reincidentes 48h])\n\t\t\t,[Reincidentes 30d]\t\t\t\t\t=\tSUM([Reincidentes 30d])\n\t\t\t\n\t\t\t,[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Iniciadas])\n\t\t\t,[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas])\n\t\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Atendidas Em At\u00e9 20s])\n\t\t\t,[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Em Andamento])\n\t\t\t,[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Finalizadas])\n\t\t\t,[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Transferidas])\n\t\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Chamada (Independente do Intervalo)])\n\t\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Atendimento (Independente do Intervalo)])\n\t\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Inbound - Tempo Em Espera (Independente do Intervalo)])\n\t\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Inbound - Tempo Em Encerramento (Independente do Intervalo)])\n\t\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Chamada (Neste Intervalo)])\n\t\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t=\tSUM([Inbound - Tempo Em Atendimento (Neste Intervalo)])\n\t\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Inbound - Tempo Em Espera (Neste Intervalo)])\n\t\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Inbound - Tempo Em Encerramento (Neste Intervalo)])\n\t\t\t,[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Iniciados])\n\t\t\t,[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Em Andamento])\n\t\t\t,[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Inbound - Atendimentos Finalizados])\n\t\t\t,[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMC]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMA]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n\t\t\t,[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TME]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - TMO]*[Inbound - Chamadas Atendidas])/NULLIF(SUM([Inbound - Chamadas Atendidas]),0),0)\n\t\t\t,[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Atendidas Em At\u00e9 20s]*[Inbound - Chamadas Iniciadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Inbound - Chamadas Abandonadas])\n\t\t\t,[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Inbound - Chamadas Abandonadas])/NULLIF(SUM([Inbound - Chamadas Iniciadas]),0),0)\n\t\t\t\n\t\t\t,[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Iniciadas])\n\t\t\t,[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas])\n\t\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Atendidas Em At\u00e9 20s])\n\t\t\t,[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Em Andamento])\n\t\t\t,[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Finalizadas])\n\t\t\t,[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Transferidas])\n\t\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Chamada (Independente do Intervalo)])\n\t\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Atendimento (Independente do Intervalo)])\n\t\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t=\tSUM([Outbound - Tempo Em Espera (Independente do Intervalo)])\n\t\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t=\tSUM([Outbound - Tempo Em Encerramento (Independente do Intervalo)])\n\t\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t=\tSUM([Outbound - Tempo Em Chamada (Neste Intervalo)])\n\t\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Atendimento (Neste Intervalo)])\n\t\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t=\tSUM([Outbound - Tempo Em Espera (Neste Intervalo)])\n\t\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t=\tSUM([Outbound - Tempo Em Encerramento (Neste Intervalo)])\n\t\t\t,[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Iniciados])\n\t\t\t,[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Em Andamento])\n\t\t\t,[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t=\tSUM([Outbound - Atendimentos Finalizados])\n\t\t\t,[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMC]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMA]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n\t\t\t,[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TME]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - TMO]*[Outbound - Chamadas Atendidas])/NULLIF(SUM([Outbound - Chamadas Atendidas]),0),0)\n\t\t\t,[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Atendidas Em At\u00e9 20s]*[Outbound - Chamadas Iniciadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\t\t\t,[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t=\tSUM([Outbound - Chamadas Abandonadas])\n\t\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t=\tISNULL(SUM([Outbound - Chamadas Abandonadas])/NULLIF(SUM([Outbound - Chamadas Iniciadas]),0),0)\n\t\t\t\n\t\t\t,[Avalia\u00e7\u00f5es de NPS]\t\t\t\t=\tSUM([Avalia\u00e7\u00f5es de NPS])\n\t\t\t,[Promotoras]\t\t\t\t\t\t=\tSUM([Promotoras]) \n\t\t\t,[Neutras]\t\t\t\t\t\t\t= \tSUM([Neutras])\n\t\t\t,[Detratoras]\t\t\t\t\t\t= \tSUM([Detratoras])\n\t\t\t,[NPS]\t\t\t\t\t\t\t\t=\tCAST((CAST((SUM([Promotoras])-SUM([Detratoras])) AS decimal(16,4))/CAST(NULLIF(SUM([Avalia\u00e7\u00f5es de NPS]), 0) AS decimal(16,4)))*100 AS INT)\n\t\t\n\n\t\tFROM r_individuo_30min_teste\n\t\tWHERE [Data] >= CAST(@datahora_inicio AS DATE)\n\t\tAND\t  [Data] <= CAST(@datahora_fim AS DATE)\n\t\tGROUP BY [Data], [Folga], [ID Selecionar], [Cliente], [Projeto], [Tribo]\n\t) AS fonte\n\tON  fonte.[Data]  = destino.[Data]\n\tAND COALESCE(fonte.[ID Selecionar], '-')\t= COALESCE(destino.[ID Selecionar], '-')\n\tAND COALESCE(fonte.[Cliente], '-')\t\t\t= COALESCE(destino.[Cliente], '-')\n\tAND COALESCE(fonte.[Projeto], '-')\t\t\t= COALESCE(destino.[Projeto], '-')\n\tAND COALESCE(fonte.[Tribo], '-')\t\t\t= COALESCE(destino.[Tribo], '-')\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT \n\t\t(\n\t\t\t [Data]\n\t\t\t,[Ciclo (Primeiro Dia)]\n\t\t\t,[M\u00eas (Primeiro Dia)]\n\t\t\t,[Feriado]\n\t\t\t,[Folga]\n\t\t\t,[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,[ID Selecionar]\n\t\t\t,[Nome]\n\t\t\t,[Status]\n\t\t\t,[Situa\u00e7\u00e3o]\n\t\t\t,[Condi\u00e7\u00e3o]\n\t\t\t\n\t\t\t,[DMA Inicial]\n\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,[\u00daltima DMA Geral]\n\t\t\t,[Tipo da \u00daltima DMA]\n\t\t\t,[Instrutor Inicial]\n\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,[Instrutor \u00daltima DMA]\n\n\t\t\t,[Cliente]\n\t\t\t,[Projeto]\n\t\t\t,[Cargo]\n\t\t\t,[Tribo]\n\t\t\t,[Supervis\u00e3o]\n\t\t\t,[Turno]\n\t\t\t,[Escala]\n\t\t\t,[Jornada (Ponto)]\n\t\t\t,[Jornada (Log)]\n\t\t\t,[Tipo de Jornada]\n\t\t\t,[Login]\n\t\t\t,[Logout]\n\t\t\t,[Log descartado (>2HE)]\n\t\t\t,[HE]\n\t\t\t,[Log]\n\t\t\t,[Log Produtivo]\n\t\t \t,[Log Improdutivo]\n\t\t \t,[Tempo Livre]\n\t\t \t,[Pausa Particular (Intelix)]\n\t\t \t,[Pausa Break (Intelix)]\n\t\t \t,[Pausa 10 (Intelix)]\n\t\t \t,[Pausa Outbound (Intelix)]\n\t\t  \t,[Pausa Lanche (Intelix)]\n\t\t  \t,[Pausa R\u00e1pida (Intelix)]\n\t\t  \t,[Pausa Almo\u00e7o (Intelix)]\n\t\t  \t,[Pausa Feedback (Intelix)]\n\t\t  \t,[Pausa Sistema Interno (Intelix)]\n\t\t  \t,[Pausa Sistema Externo (Intelix)]\n\t\t  \t,[Pausa Treinamento (Intelix)]\n\t\t  \t,[Pausa Banheiro (Intelix)]\n\t\t  \t,[Pausa Reuni\u00e3o (Intelix)]\n\t\t  \t,[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t  \t,[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t  \t,[Pausa Almo\u00e7o (EPBX)]\n\t\t  \t,[Pausa Tratativa (EPBX)]\n\t\t  \t,[Pausa Discagem Manual (EPBX)]\n\t\t  \t,[Pausa Banheiro (EPBX)]\n\t\t  \t,[Pausa WhatsApp (EPBX)]\n\t\t  \t,[Pausa Intervalo (EPBX)]\n\t\t  \t,[Pausa Discagem Retorno (EPBX)]\n\t\t  \t,[Pausa Treinamento (EPBX)]\n\t\t  \t,[Pausa Feedback (EPBX)]\n\t\t  \t,[Pausa Transfer\u00eancia (EPBX)]\n\t\t  \t,[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t  \t,[Pausa Login (EPBX)]\n\t\t  \t,[Pausa Reuni\u00e3o (EPBX)]\n\t\t  \t,[Pausa Sistema Interno (EPBX)]\n\t\t  \t,[Pausa Sistema Externo (EPBX)]\n\t\t  \t,[Pausa NR17 (EPBX)]\n\t\t  \t,[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t  \t,[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t  \t,[Pausa Lanche (EPBX)]\n\t\t  \t,[Pausa BackOffice (EPBX)]\n\t\t\t,[Pausa Almo\u00e7o (Genesys)]\n\t\t\t,[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t \t,[Pausa Banheiro (Genesys)]\n\t\t \t,[Pausa Descanso (Genesys)]\n\t\t \t,[Pausa Feedback (Genesys)]\n\t\t \t,[Pausa Backoffice (Genesys)]\n\t\t \t,[Pausa Discagem Manual (Genesys)]\n\t\t \t,[Pausa Discagem Retorno (Genesys)]\n\t\t \t,[Pausa Dispon\u00edvel (Genesys)]\n\t\t \t,[Pausa Em Fila (Genesys)]\n\t\t \t,[Pausa Sistema Externo (Genesys)]\n\t\t \t,[Pausa Sistema Interno (Genesys)]\n\t\t \t,[Pausa Tratativa (Genesys)]\n\t\t \t,[Pausa Whatsapp (Genesys)]\n\t\t\t,[Pausa Treinamento (Genesys)]\n\n\t\t\t,[Criados]\n\t\t\t,[Tratados]\n\t\t\t,[Tempo Total de Tratativa]\n\t\t\t,[TMT]\n\t\t\t,[N\u00e3o Resolvidos]\n\t\t\t,[Replicas]\n\t\t\t,[Reincidentes 48h]\n\t\t\t,[Reincidentes 30d]\n\t\t\t\n\t\t\t\n\t\t,[Inbound - Chamadas Iniciadas]\n\t\t,[Inbound - Chamadas Atendidas]\n\t\t,[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,[Inbound - Chamadas Em Andamento]\n\t\t,[Inbound - Chamadas Finalizadas]\n\t\t,[Inbound - Chamadas Transferidas]\n\t\t,[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,[Inbound - Atendimentos Iniciados]\n\t\t,[Inbound - Atendimentos Em Andamento]\n\t\t,[Inbound - Atendimentos Finalizados]\n\t\t,[Inbound - TMC]\n\t\t,[Inbound - TMA]\n\t\t,[Inbound - TME]\n\t\t,[Inbound - TMO]\n\t\t,[Inbound - % Nivel de Servi\u00e7o]\n\t\t,[Inbound - Chamadas Abandonadas]\n\t\t,[Inbound - % Abandono]\n\n\t\t,[Outbound - Chamadas Iniciadas]\n\t\t,[Outbound - Chamadas Atendidas]\n\t\t,[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,[Outbound - Chamadas Em Andamento]\n\t\t,[Outbound - Chamadas Finalizadas]\n\t\t,[Outbound - Chamadas Transferidas]\n\t\t,[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,[Outbound - Atendimentos Iniciados]\n\t\t,[Outbound - Atendimentos Em Andamento]\n\t\t,[Outbound - Atendimentos Finalizados]\n\t\t,[Outbound - TMC]\n\t\t,[Outbound - TMA]\n\t\t,[Outbound - TME]\n\t\t,[Outbound - TMO]\n\t\t,[Outbound - % Nivel de Servi\u00e7o]\n\t\t,[Outbound - Chamadas Abandonadas]\n\t\t,[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\n\n\n\t\t\t,[Avalia\u00e7\u00f5es de NPS]\n\t\t\t,[Promotoras]\n\t\t\t,[Neutras]\n\t\t\t,[Detratoras]\n\t\t\t,[NPS]\n\t\t)\n\t\tVALUES \n\t\t(\n\t\t\t fonte.[Data]\n\t\t\t,fonte.[Ciclo (Primeiro Dia)]\n\t\t\t,fonte.[M\u00eas (Primeiro Dia)]\n\t\t\t,fonte.[Feriado]\n\t\t\t,fonte.[Folga]\n\t\t\t,fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,fonte.[ID Selecionar]\n\t\t\t,fonte.[Nome]\n\t\t\t,fonte.[Status]\n\t\t\t,fonte.[Situa\u00e7\u00e3o]\n\t\t\t,fonte.[Condi\u00e7\u00e3o]\n\t\t\t\n\t\t\t,fonte.[DMA Inicial]\n\t\t\t,fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,fonte.[\u00daltima DMA Geral]\n\t\t\t,fonte.[Tipo da \u00daltima DMA]\n\t\t\t,fonte.[Instrutor Inicial]\n\t\t\t,fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,fonte.[Instrutor \u00daltima DMA]\n\n\t\t\t,fonte.[Cliente]\n\t\t\t,fonte.[Projeto]\n\t\t\t,fonte.[Cargo]\n\t\t\t,fonte.[Tribo]\n\t\t\t,fonte.[Supervis\u00e3o]\n\t\t\t,fonte.[Turno]\n\t\t\t,fonte.[Escala]\n\t\t\t,fonte.[Jornada (Ponto)]\n\t\t\t,fonte.[Jornada (Log)]\n\t\t\t,fonte.[Tipo de Jornada]\n\t\t\t,fonte.[Login]\n\t\t\t,fonte.[Logout]\n\t\t\t,fonte.[Log descartado (>2HE)]\n\t\t\t,fonte.[HE]\n\t\t\t,fonte.[Log]\n\t\t\t,fonte.[Log Produtivo]\n\t\t \t,fonte.[Log Improdutivo]\n\t\t \t,fonte.[Tempo Livre]\n\t\t \t,fonte.[Pausa Particular (Intelix)]\n\t\t \t,fonte.[Pausa Break (Intelix)]\n\t\t \t,fonte.[Pausa 10 (Intelix)]\n\t\t \t,fonte.[Pausa Outbound (Intelix)]\n\t\t  \t,fonte.[Pausa Lanche (Intelix)]\n\t\t  \t,fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t  \t,fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t  \t,fonte.[Pausa Feedback (Intelix)]\n\t\t  \t,fonte.[Pausa Sistema Interno (Intelix)]\n\t\t  \t,fonte.[Pausa Sistema Externo (Intelix)]\n\t\t  \t,fonte.[Pausa Treinamento (Intelix)]\n\t\t  \t,fonte.[Pausa Banheiro (Intelix)]\n\t\t  \t,fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t  \t,fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t  \t,fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t  \t,fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t  \t,fonte.[Pausa Tratativa (EPBX)]\n\t\t  \t,fonte.[Pausa Discagem Manual (EPBX)]\n\t\t  \t,fonte.[Pausa Banheiro (EPBX)]\n\t\t  \t,fonte.[Pausa WhatsApp (EPBX)]\n\t\t  \t,fonte.[Pausa Intervalo (EPBX)]\n\t\t  \t,fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t  \t,fonte.[Pausa Treinamento (EPBX)]\n\t\t  \t,fonte.[Pausa Feedback (EPBX)]\n\t\t  \t,fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t  \t,fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t  \t,fonte.[Pausa Login (EPBX)]\n\t\t  \t,fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t  \t,fonte.[Pausa Sistema Interno (EPBX)]\n\t\t  \t,fonte.[Pausa Sistema Externo (EPBX)]\n\t\t  \t,fonte.[Pausa NR17 (EPBX)]\n\t\t  \t,fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t  \t,fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t  \t,fonte.[Pausa Lanche (EPBX)]\n\t\t  \t,fonte.[Pausa BackOffice (EPBX)]\n\t\t\t,fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t\t,fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t \t,fonte.[Pausa Banheiro (Genesys)]\n\t\t \t,fonte.[Pausa Descanso (Genesys)]\n\t\t \t,fonte.[Pausa Feedback (Genesys)]\n\t\t \t,fonte.[Pausa Backoffice (Genesys)]\n\t\t \t,fonte.[Pausa Discagem Manual (Genesys)]\n\t\t \t,fonte.[Pausa Discagem Retorno (Genesys)]\n\t\t \t,fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t\t \t,fonte.[Pausa Em Fila (Genesys)]\n\t\t \t,fonte.[Pausa Sistema Externo (Genesys)]\n\t\t \t,fonte.[Pausa Sistema Interno (Genesys)]\n\t\t \t,fonte.[Pausa Tratativa (Genesys)]\n\t\t \t,fonte.[Pausa Whatsapp (Genesys)]\n\t\t\t,fonte.[Pausa Treinamento (Genesys)]\n\n\t\t\t,fonte.[Criados]\n\t\t\t,fonte.[Tratados]\n\t\t\t,fonte.[Tempo Total de Tratativa]\n\t\t\t,fonte.[TMT]\n\t\t\t,fonte.[N\u00e3o Resolvidos]\n\t\t\t,fonte.[Replicas]\n\t\t\t,fonte.[Reincidentes 48h]\n\t\t\t,fonte.[Reincidentes 30d]\n\t\t\t\t\t\n\t\t,fonte.[Inbound - Chamadas Iniciadas]\n\t\t,fonte.[Inbound - Chamadas Atendidas]\n\t\t,fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,fonte.[Inbound - Chamadas Em Andamento]\n\t\t,fonte.[Inbound - Chamadas Finalizadas]\n\t\t,fonte.[Inbound - Chamadas Transferidas]\n\t\t,fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,fonte.[Inbound - Atendimentos Iniciados]\n\t\t,fonte.[Inbound - Atendimentos Em Andamento]\n\t\t,fonte.[Inbound - Atendimentos Finalizados]\n\t\t,fonte.[Inbound - TMC]\n\t\t,fonte.[Inbound - TMA]\n\t\t,fonte.[Inbound - TME]\n\t\t,fonte.[Inbound - TMO]\n\t\t,fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t,fonte.[Inbound - Chamadas Abandonadas]\n\t\t,fonte.[Inbound - % Abandono]\n\n\t\t,fonte.[Outbound - Chamadas Iniciadas]\n\t\t,fonte.[Outbound - Chamadas Atendidas]\n\t\t,fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t,fonte.[Outbound - Chamadas Em Andamento]\n\t\t,fonte.[Outbound - Chamadas Finalizadas]\n\t\t,fonte.[Outbound - Chamadas Transferidas]\n\t\t,fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t,fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t,fonte.[Outbound - Atendimentos Iniciados]\n\t\t,fonte.[Outbound - Atendimentos Em Andamento]\n\t\t,fonte.[Outbound - Atendimentos Finalizados]\n\t\t,fonte.[Outbound - TMC]\n\t\t,fonte.[Outbound - TMA]\n\t\t,fonte.[Outbound - TME]\n\t\t,fonte.[Outbound - TMO]\n\t\t,fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t,fonte.[Outbound - Chamadas Abandonadas]\n\t\t,fonte.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\n\n\t\t\t,fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t\t,fonte.[Promotoras]\n\t\t\t,fonte.[Neutras]\n\t\t\t,fonte.[Detratoras]\n\t\t\t,fonte.[NPS]\n\t\t\t)\n\n\tWHEN MATCHED THEN \n\t\tUPDATE SET\n\t\t\t destino.[Data]\t\t\t\t\t\t\t\t= fonte.[Data]\n\t\t\t,destino.[Ciclo (Primeiro Dia)]\t\t\t\t= fonte.[Ciclo (Primeiro Dia)]\n\t\t\t,destino.[M\u00eas (Primeiro Dia)]\t\t\t\t= fonte.[M\u00eas (Primeiro Dia)]\n\t\t\t,destino.[Feriado]\t\t\t\t\t\t\t= fonte.[Feriado]\n\t\t\t,destino.[Folga]\t\t\t\t\t\t\t= fonte.[Folga]\n\t\t\t,destino.[DataHora da Atualiza\u00e7\u00e3o do MOP]\t= fonte.[DataHora da Atualiza\u00e7\u00e3o do MOP]\n\t\t\t,destino.[ID Selecionar]\t\t\t\t\t= fonte.[ID Selecionar]\n\t\t\t,destino.[Nome]\t\t\t\t\t\t\t\t= fonte.[Nome]\n\t\t\t,destino.[Status]\t\t\t\t\t\t\t= fonte.[Status]\n\t\t\t,destino.[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Situa\u00e7\u00e3o]\n\t\t\t,destino.[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t= fonte.[Condi\u00e7\u00e3o]\n\t\t\t\n\t\t\t,destino.[DMA Inicial]\t\t\t\t\t\t= fonte.[DMA Inicial]\n\t\t\t,destino.[\u00daltima DMA Migra\u00e7\u00e3o]\t\t\t\t= fonte.[\u00daltima DMA Migra\u00e7\u00e3o]\n\t\t\t,destino.[\u00daltima DMA Geral]\t\t\t\t\t= fonte.[\u00daltima DMA Geral]\n\t\t\t,destino.[Tipo da \u00daltima DMA]\t\t\t\t= fonte.[Tipo da \u00daltima DMA]\n\t\t\t,destino.[Instrutor Inicial]\t\t\t\t= fonte.[Instrutor Inicial]\n\t\t\t,destino.[Instrutor \u00daltima Migra\u00e7\u00e3o]\t\t= fonte.[Instrutor \u00daltima Migra\u00e7\u00e3o]\n\t\t\t,destino.[Instrutor \u00daltima DMA]\t\t\t\t= fonte.[Instrutor \u00daltima DMA]\n\n\t\t\t,destino.[Cliente]\t\t\t\t\t\t\t= fonte.[Cliente]\n\t\t\t,destino.[Projeto]\t\t\t\t\t\t\t= fonte.[Projeto]\n\t\t\t,destino.[Cargo]\t\t\t\t\t\t\t= fonte.[Cargo]\n\t\t\t,destino.[Tribo]\t\t\t\t\t\t\t= fonte.[Tribo]\n\t\t\t,destino.[Supervis\u00e3o]\t\t\t\t\t\t= fonte.[Supervis\u00e3o]\n\t\t\t,destino.[Turno]\t\t\t\t\t\t\t= fonte.[Turno]\n\t\t\t,destino.[Escala]\t\t\t\t\t\t\t= fonte.[Escala]\n\t\t\t,destino.[Jornada (Ponto)]\t\t\t\t\t= fonte.[Jornada (Ponto)]\n\t\t\t,destino.[Jornada (Log)]\t\t\t\t\t= fonte.[Jornada (Log)]\n\t\t\t,destino.[Tipo de Jornada]\t\t\t\t\t= fonte.[Tipo de Jornada]\n\t\t\t,destino.[Login]\t\t\t\t\t\t\t= fonte.[Login]\n\t\t\t,destino.[Logout]\t\t\t\t\t\t\t= fonte.[Logout]\n\t\t\t,destino.[Log descartado (>2HE)]\t\t\t= fonte.[Log descartado (>2HE)]\n\t\t\t,destino.[HE]\t\t\t\t\t\t\t\t= fonte.[HE]\n\t\t\t,destino.[Log]\t\t\t\t\t\t\t\t= fonte.[Log]\n\t\t\t,destino.[Log Produtivo]\t\t\t\t\t= fonte.[Log Produtivo]\n\t\t \t,destino.[Log Improdutivo]\t\t\t\t\t= fonte.[Log Improdutivo]\n\t\t \t,destino.[Tempo Livre]\t\t\t\t\t\t= fonte.[Tempo Livre]\n\t\t \t,destino.[Pausa Particular (Intelix)]\t\t= fonte.[Pausa Particular (Intelix)]\n\t\t \t,destino.[Pausa Break (Intelix)]\t\t\t= fonte.[Pausa Break (Intelix)]\n\t\t \t,destino.[Pausa 10 (Intelix)]\t\t\t\t= fonte.[Pausa 10 (Intelix)]\n\t\t \t,destino.[Pausa Outbound (Intelix)]\t\t\t= fonte.[Pausa Outbound (Intelix)]\n\t\t  \t,destino.[Pausa Lanche (Intelix)]\t\t\t= fonte.[Pausa Lanche (Intelix)]\n\t\t  \t,destino.[Pausa R\u00e1pida (Intelix)]\t\t\t= fonte.[Pausa R\u00e1pida (Intelix)]\n\t\t  \t,destino.[Pausa Almo\u00e7o (Intelix)]\t\t\t= fonte.[Pausa Almo\u00e7o (Intelix)]\n\t\t  \t,destino.[Pausa Feedback (Intelix)]\t\t\t= fonte.[Pausa Feedback (Intelix)]\n\t\t  \t,destino.[Pausa Sistema Interno (Intelix)]\t= fonte.[Pausa Sistema Interno (Intelix)]\n\t\t  \t,destino.[Pausa Sistema Externo (Intelix)]\t= fonte.[Pausa Sistema Externo (Intelix)]\n\t\t  \t,destino.[Pausa Treinamento (Intelix)]\t\t= fonte.[Pausa Treinamento (Intelix)]\n\t\t  \t,destino.[Pausa Banheiro (Intelix)]\t\t\t= fonte.[Pausa Banheiro (Intelix)]\n\t\t  \t,destino.[Pausa Reuni\u00e3o (Intelix)]\t\t\t= fonte.[Pausa Reuni\u00e3o (Intelix)]\n\t\t  \t,destino.[Pausa Ambulat\u00f3rio (Intelix)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Intelix)]\n\t\t  \t,destino.[Pausa Liga\u00e7\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Liga\u00e7\u00e3o (EPBX)]\n\t\t  \t,destino.[Pausa Almo\u00e7o (EPBX)]\t\t\t\t= fonte.[Pausa Almo\u00e7o (EPBX)]\n\t\t  \t,destino.[Pausa Tratativa (EPBX)]\t\t\t= fonte.[Pausa Tratativa (EPBX)]\n\t\t  \t,destino.[Pausa Discagem Manual (EPBX)]\t\t= fonte.[Pausa Discagem Manual (EPBX)]\n\t\t  \t,destino.[Pausa Banheiro (EPBX)]\t\t\t= fonte.[Pausa Banheiro (EPBX)]\n\t\t  \t,destino.[Pausa WhatsApp (EPBX)]\t\t\t= fonte.[Pausa WhatsApp (EPBX)]\n\t\t  \t,destino.[Pausa Intervalo (EPBX)]\t\t\t= fonte.[Pausa Intervalo (EPBX)]\n\t\t  \t,destino.[Pausa Discagem Retorno (EPBX)]\t= fonte.[Pausa Discagem Retorno (EPBX)]\n\t\t  \t,destino.[Pausa Treinamento (EPBX)]\t\t\t= fonte.[Pausa Treinamento (EPBX)]\n\t\t  \t,destino.[Pausa Feedback (EPBX)]\t\t\t= fonte.[Pausa Feedback (EPBX)]\n\t\t  \t,destino.[Pausa Transfer\u00eancia (EPBX)]\t\t= fonte.[Pausa Transfer\u00eancia (EPBX)]\n\t\t  \t,destino.[Pausa N\u00e3o Disponivel (EPBX)]\t\t= fonte.[Pausa N\u00e3o Disponivel (EPBX)]\n\t\t  \t,destino.[Pausa Login (EPBX)]\t\t\t\t= fonte.[Pausa Login (EPBX)]\n\t\t  \t,destino.[Pausa Reuni\u00e3o (EPBX)]\t\t\t\t= fonte.[Pausa Reuni\u00e3o (EPBX)]\n\t\t  \t,destino.[Pausa Sistema Interno (EPBX)]\t\t= fonte.[Pausa Sistema Interno (EPBX)]\n\t\t  \t,destino.[Pausa Sistema Externo (EPBX)]\t\t= fonte.[Pausa Sistema Externo (EPBX)]\n\t\t  \t,destino.[Pausa NR17 (EPBX)]\t\t\t\t= fonte.[Pausa NR17 (EPBX)]\n\t\t  \t,destino.[Pausa Ambulat\u00f3rio (EPBX)]\t\t\t= fonte.[Pausa Ambulat\u00f3rio (EPBX)]\n\t\t  \t,destino.[Pausa P\u00f3s Atendimento (EPBX)]\t\t= fonte.[Pausa P\u00f3s Atendimento (EPBX)]\n\t\t  \t,destino.[Pausa Lanche (EPBX)]\t\t\t\t= fonte.[Pausa Lanche (EPBX)]\n\t\t  \t,destino.[Pausa BackOffice (EPBX)]\t\t\t= fonte.[Pausa BackOffice (EPBX)]\n\t\t\t,destino.[Pausa Almo\u00e7o (Genesys)]\t\t\t= fonte.[Pausa Almo\u00e7o (Genesys)]\n\t\t\t,destino.[Pausa Ambulat\u00f3rio (Genesys)]\t\t= fonte.[Pausa Ambulat\u00f3rio (Genesys)]\n\t\t\t,destino.[Pausa Banheiro (Genesys)]\t\t\t= fonte.[Pausa Banheiro (Genesys)]\n\t\t\t,destino.[Pausa Descanso (Genesys)]\t\t\t= fonte.[Pausa Descanso (Genesys)]\n\t\t\t,destino.[Pausa Feedback (Genesys)]\t\t\t= fonte.[Pausa Feedback (Genesys)]\n\t\t\t,destino.[Pausa Backoffice (Genesys)]\t\t= fonte.[Pausa Backoffice (Genesys)]\n\t\t\t,destino.[Pausa Discagem Manual (Genesys)]\t= fonte.[Pausa Discagem Manual (Genesys)]\n\t\t\t,destino.[Pausa Discagem Retorno (Genesys)]\t= fonte.[Pausa Discagem Retorno (Genesys)]\n\t\t\t,destino.[Pausa Dispon\u00edvel (Genesys)]\t\t= fonte.[Pausa Dispon\u00edvel (Genesys)]\n\t\t\t,destino.[Pausa Em Fila (Genesys)]\t\t\t= fonte.[Pausa Em Fila (Genesys)]\n\t\t\t,destino.[Pausa Sistema Externo (Genesys)]\t= fonte.[Pausa Sistema Externo (Genesys)]\n\t\t\t,destino.[Pausa Sistema Interno (Genesys)]\t= fonte.[Pausa Sistema Interno (Genesys)]\n\t\t\t,destino.[Pausa Tratativa (Genesys)]\t\t= fonte.[Pausa Tratativa (Genesys)]\n\t\t\t,destino.[Pausa Whatsapp (Genesys)]\t\t\t= fonte.[Pausa Whatsapp (Genesys)]\n\t\t\t,destino.[Pausa Treinamento (Genesys)]\t\t= fonte.[Pausa Treinamento (Genesys)]\n\n\t\t\t,destino.[Criados]\t\t\t\t\t\t\t= fonte.[Criados]\n\t\t\t,destino.[Tratados]\t\t\t\t\t\t\t= fonte.[Tratados]\n\t\t\t,destino.[Tempo Total de Tratativa]\t\t\t= fonte.[Tempo Total de Tratativa]\n\t\t\t,destino.[TMT]\t\t\t\t\t\t\t\t= fonte.[TMT]\n\t\t\t,destino.[N\u00e3o Resolvidos]\t\t\t\t\t= fonte.[N\u00e3o Resolvidos]\n\t\t\t,destino.[Replicas]\t\t\t\t\t\t\t= fonte.[Replicas]\n\t\t\t,destino.[Reincidentes 48h]\t\t\t\t\t= fonte.[Reincidentes 48h]\n\t\t\t,destino.[Reincidentes 30d]\t\t\t\t\t= fonte.[Reincidentes 30d]\n\t\t\t\n\t\t\t,destino.[Inbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Iniciadas]\n\t\t\t,destino.[Inbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas]\n\t\t\t,destino.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Inbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t\t,destino.[Inbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Em Andamento]\n\t\t\t,destino.[Inbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Finalizadas]\n\t\t\t,destino.[Inbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Transferidas]\n\t\t\t,destino.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Inbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Inbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t\t= fonte.[Inbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Inbound - Tempo Em Espera (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Inbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t\t,destino.[Inbound - Atendimentos Iniciados]\t\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Iniciados]\n\t\t\t,destino.[Inbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Em Andamento]\n\t\t\t,destino.[Inbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Inbound - Atendimentos Finalizados]\n\t\t\t,destino.[Inbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMC]\n\t\t\t,destino.[Inbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMA]\n\t\t\t,destino.[Inbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TME]\n\t\t\t,destino.[Inbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - TMO]\n\t\t\t,destino.[Inbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Nivel de Servi\u00e7o]\n\t\t\t,destino.[Inbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Inbound - Chamadas Abandonadas]\n\t\t\t,destino.[Inbound - % Abandono]\t\t\t\t\t\t\t\t\t\t\t= fonte.[Inbound - % Abandono]\n\t\t\t\n\t\t\t,destino.[Outbound - Chamadas Iniciadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Iniciadas]\n\t\t\t,destino.[Outbound - Chamadas Atendidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas]\n\t\t\t,destino.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\t\t\t\t\t\t= fonte.[Outbound - Chamadas Atendidas Em At\u00e9 20s]\n\t\t\t,destino.[Outbound - Chamadas Em Andamento]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Em Andamento]\n\t\t\t,destino.[Outbound - Chamadas Finalizadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Finalizadas]\n\t\t\t,destino.[Outbound - Chamadas Transferidas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Transferidas]\n\t\t\t,destino.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Chamada (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Atendimento (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Espera (Independente do Intervalo)]\t\t= fonte.[Outbound - Tempo Em Espera (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\t= fonte.[Outbound - Tempo Em Encerramento (Independente do Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Chamada (Neste Intervalo)]\t\t\t\t= fonte.[Outbound - Tempo Em Chamada (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Atendimento (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Espera (Neste Intervalo)]\t\t\t\t\t= fonte.[Outbound - Tempo Em Espera (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\t\t\t= fonte.[Outbound - Tempo Em Encerramento (Neste Intervalo)]\n\t\t\t,destino.[Outbound - Atendimentos Iniciados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Iniciados]\n\t\t\t,destino.[Outbound - Atendimentos Em Andamento]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Em Andamento]\n\t\t\t,destino.[Outbound - Atendimentos Finalizados]\t\t\t\t\t\t\t= fonte.[Outbound - Atendimentos Finalizados]\n\t\t\t,destino.[Outbound - TMC]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMC]\n\t\t\t,destino.[Outbound - TMA]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMA]\n\t\t\t,destino.[Outbound - TME]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TME]\n\t\t\t,destino.[Outbound - TMO]\t\t\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - TMO]\n\t\t\t,destino.[Outbound - % Nivel de Servi\u00e7o]\t\t\t\t\t\t\t\t= fonte.[Outbound - % Nivel de Servi\u00e7o]\n\t\t\t,destino.[Outbound - Chamadas Abandonadas]\t\t\t\t\t\t\t\t= fonte.[Outbound - Chamadas Abandonadas]\n\t\t\t,destino.[Outbound - % Abandono]\t\t\t\t\t\t\t\t\t\t= fonte.[Outbound - % Abandono]\n\n\n\t\t\t,destino.[Avalia\u00e7\u00f5es de NPS]\t\t\t\t= fonte.[Avalia\u00e7\u00f5es de NPS]\n\t\t\t,destino.[Promotoras]\t\t\t\t\t\t= fonte.[Promotoras]\n\t\t\t,destino.[Neutras]\t\t\t\t\t\t\t= fonte.[Neutras]\n\t\t\t,destino.[Detratoras]\t\t\t\t\t\t= fonte.[Detratoras]\n\t\t\t,destino.[NPS]\t\t\t\t\t\t\t\t= fonte.[NPS]\n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE;\n\nEND\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\nSELECT [Retorno]=CONCAT('Resumos atualizados (m\u00e9trica: ',@metrica,') ',@datahora_inicio,' - ',@datahora_fim, ' (dura\u00e7\u00e3o: ', CAST(DATEADD(s, DATEDIFF(s, @t_inicio, GETDATE()), 0) as time(0)),')')\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\\/\n\n\n\nGO\n",
        "build_order": 323,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT SUM(sub.[Dura\u00e7\u00e3o]) - (c.[Jornada (Log)]+7200000) FROM f_log"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o], [Data da Proxima Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Intelix], [ID EPBX], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [DMA Inicial], [\u00daltima DMA Migra\u00e7\u00e3o], [\u00daltima DMA Geral], [Tipo da \u00daltima DMA], [Instrutor Inicial], [Instrutor \u00daltima Migra\u00e7\u00e3o], [Instrutor \u00daltima DMA], [Cliente], [Projeto], [Cargo], [Tribo], [Supervis\u00e3o], [Escala], [Jornada], [Taxa] FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "SELECT",
                "SELECT SUM(sub.[Dura\u00e7\u00e3o]) - (c.[Jornada (Log)]+7200000) FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT [Data da Atualiza\u00e7\u00e3o], [Data da Proxima Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Intelix], [ID EPBX], [Nome], [Status], [Situa\u00e7\u00e3o], [Condi\u00e7\u00e3o], [DMA Inicial], [\u00daltima DMA Migra\u00e7\u00e3o], [\u00daltima DMA Geral], [Tipo da \u00daltima DMA], [Instrutor Inicial], [Instrutor \u00daltima Migra\u00e7\u00e3o], [Instrutor \u00daltima DMA], [Cliente], [Projeto], [Cargo], [Tribo], [Supervis\u00e3o], [Escala], [Jornada], [Taxa] FROM f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT MAX([Data]) FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "SELECT",
                "SELECT SUM(sub.[Dura\u00e7\u00e3o]) - (c.[Jornada (Log)]+7200000) FROM f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": [
                "UNKNOWN",
                "dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_att_resumos_teste]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos_teste]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_att_resumos_teste]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_tickets",
        "type": "StoredProcedure",
        "start": 773173,
        "end": 778727,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_tickets]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n--##################################################################################################################################################################################\n--#################################################################################################################################################################\n--###############################################################################################################################################\n\nCREATE     PROCEDURE [dbo].[sp_att_tickets] \n\t@datahora_inicio_forcada datetime = NULL,\n\t@datahora_fim_forcada datetime = NULL \nAS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\t\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'f_tickets' and xtype='U')\n\tBEGIN\n\t\tCREATE TABLE [dbo].[f_tickets](\n\t\t\t[Tribo]\t\t\t\t[varchar](50)\tNOT NULL,\n\t\t\t[ID Selecionar]\t\t[varchar](10)\tNULL,\n\t\t\t[ID Serasa]\t\t\t[varchar](10)\tNULL,\n\t\t\t[ID Ticket]\t\t\t[int]\t\t\tNOT NULL,\n\t\t\t[Status]\t\t\t[varchar](150)\tNULL,\n\t\t\t[Cria\u00e7\u00e3o]\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[Resolu\u00e7\u00e3o]\t\t\t[datetime]\t\tNULL,\n\t\t\t[Formul\u00e1rio]\t\t[varchar](500)\tNOT NULL,\n\t\t\t[Motivos]\t\t\t[varchar](500)\tNULL,\n\t\t\t[TMT]\t\t\t\t[int]\t\t\tNULL,\n\t\t\t[R\u00e9plicas]\t\t\t[int]\t\t\tNOT NULL,\n\t\t\t[Resolvido?]\t\t[bit]\t\t\tNOT NULL,\n\t\t\t[Reincidente 48h?]\t[bit]\t\t\tNOT NULL,\n\t\t\t[Reincidente 30d?]\t[bit]\t\t\tNOT NULL,\n\t\t\t[Chatbot?]\t\t\t[bit]\t\t\tNOT NULL,\n\t\t) ON [PRIMARY]\n\tEND\n\n\n\tDECLARE @datahoras_afetadas TABLE (tipo varchar(10) NOT NULL, dh_min datetime2(0) NOT NULL, dh_max datetime2(0) NOT NULL);\n\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM f_tickets\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT DISTINCT\n\t\t\t [Tribo]\t\t\t=\tIIF(tkt.[tribo_serasa] = 'Chat' AND (tkt.[chatbot] = 1 OR [ID_serasa] IS NULL OR [ID_serasa] IN ('CNA','CNTEGRA')), 'Chatbot', tkt.[tribo_serasa])\n\t\t\t,[ID Selecionar]\t=\tmop.[ID Selecionar]\n\t\t\t,[ID Serasa]\t\t=\ttkt.[ID_serasa]\n\t\t\t,[ID Ticket]\t\t=\ttkt.[ID_ticket]\n\t\t\t,[Status]\t\t\t=\ttkt.[status]\n\t\t\t,[Cria\u00e7\u00e3o]\t\t\t=\ttkt.[criacao]\n\t\t\t,[Resolu\u00e7\u00e3o]\t\t=\ttkt.[resolucao]\n\t\t\t,[Formul\u00e1rio]\t\t=\tISNULL(tkt.[formulario], 0)\n\t\t\t,[Motivos]\t\t\t=\ttkt.[motivos]\n\t\t\t,[TMT]\t\t\t\t=\ttkt.[tmt]\n\t\t\t,[R\u00e9plicas]\t\t\t=\ttkt.[replicas]\n\t\t\t,[Resolvido?]\t\t=\ttkt.[resolvido]\n\t\t\t,[Reincidente 48h?]\t=\ttkt.[reincidente_48h]\n\t\t\t,[Reincidente 30d?]\t=\ttkt.[reincidente_30d]\n\t\t\t,[Chatbot?]\t\t\t=\ttkt.[chatbot]\n\t\tFROM dim_tickets_zendesk tkt\n\t\tLEFT JOIN f_mop_historico mop\n\t\tON CAST(tkt.[resolucao] as date) = mop.[Data da Atualiza\u00e7\u00e3o]\n\t\tAND tkt.[ID_Serasa] = mop.[ID Serasa]\n\n\t) AS fonte\n\tON  fonte.[ID Ticket] = destino.[ID Ticket]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([Tribo], [ID Selecionar], [ID Serasa], [ID Ticket], [Status], [Cria\u00e7\u00e3o], [Resolu\u00e7\u00e3o], [Formul\u00e1rio], [Motivos], [TMT], [R\u00e9plicas], [Resolvido?], [Reincidente 48h?], [Reincidente 30d?], [Chatbot?]) \n\t\tVALUES (fonte.[Tribo], fonte.[ID Selecionar], fonte.[ID Serasa], fonte.[ID Ticket], fonte.[Status], fonte.[Cria\u00e7\u00e3o], fonte.[Resolu\u00e7\u00e3o], fonte.[Formul\u00e1rio], fonte.[Motivos], fonte.[TMT], fonte.[R\u00e9plicas], fonte.[Resolvido?], fonte.[Reincidente 48h?], fonte.[Reincidente 30d?], fonte.[Chatbot?]) \n\n\tWHEN MATCHED \n\tAND (  destino.[Tribo]\t\t\t\t\t\t\t<>\tfonte.[Tribo] \n\t\tOR COALESCE(destino.[ID Selecionar], '-')\t<>\tCOALESCE(fonte.[ID Selecionar], '-')\n\t\tOR COALESCE(destino.[ID Serasa], '-')\t\t<>\tCOALESCE(fonte.[ID Serasa], '-')\n\t\tOR COALESCE(destino.[status], '-')\t\t\t<>\tCOALESCE(fonte.[status], '-')\n\t\tOR destino.[Cria\u00e7\u00e3o]\t\t\t\t\t\t<>\tfonte.[Cria\u00e7\u00e3o]\n\t\tOR COALESCE(destino.[Resolu\u00e7\u00e3o], '1999-01-01')\t\t<>\tCOALESCE(fonte.[Resolu\u00e7\u00e3o], '1999-01-01')\n\t\tOR COALESCE(destino.[Formul\u00e1rio], '-')\t\t<>\tCOALESCE(fonte.[Formul\u00e1rio], '-')\n\t\tOR COALESCE(destino.[Motivos], '-')\t\t\t<>\tCOALESCE(fonte.[Motivos], '-')\n\t\tOR COALESCE(destino.[TMT], '-')\t\t\t\t<>\tCOALESCE(fonte.[TMT], '-')\n\t\tOR destino.[R\u00e9plicas]\t\t\t\t\t\t<>\tfonte.[R\u00e9plicas]\n\t\tOR destino.[Resolvido?]\t\t\t\t\t\t<>\tfonte.[Resolvido?]\n\t\tOR destino.[Reincidente 48h?]\t\t\t\t<>\tfonte.[Reincidente 48h?]\n\t\tOR destino.[Reincidente 30d?]\t\t\t\t<>\tfonte.[Reincidente 30d?]\n\t\tOR destino.[Chatbot?]\t\t\t\t\t\t<>\tfonte.[Chatbot?]\n    )\n\t\n\tTHEN UPDATE SET\n\t\t destino.[Tribo]\t\t\t=\tfonte.[Tribo] \n\t\t,destino.[ID Selecionar]\t=\tfonte.[ID Selecionar]\n\t\t,destino.[ID Serasa]\t\t=\tfonte.[ID Serasa]\n\t\t,destino.[Status]\t\t\t=\tfonte.[Status]\n\t\t,destino.[Cria\u00e7\u00e3o]\t\t\t=\tfonte.[Cria\u00e7\u00e3o]\n\t\t,destino.[Resolu\u00e7\u00e3o]\t\t=\tfonte.[Resolu\u00e7\u00e3o]\n\t\t,destino.[Formul\u00e1rio]\t\t=\tfonte.[Formul\u00e1rio]\n\t\t,destino.[Motivos]\t\t\t=\tfonte.[Motivos]\n\t\t,destino.[TMT]\t\t\t\t=\tfonte.[TMT]\n\t\t,destino.[R\u00e9plicas]\t\t\t=\tfonte.[R\u00e9plicas]\n\t\t,destino.[Resolvido?]\t\t=\tfonte.[Resolvido?]\n\t\t,destino.[Reincidente 48h?]\t=\tfonte.[Reincidente 48h?]\n\t\t,destino.[Reincidente 30d?]\t=\tfonte.[Reincidente 30d?]\n\t\t,destino.[Chatbot?]\t\t\t=\tfonte.[Chatbot?]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE\n\t\n\tOUTPUT $action, COALESCE(deleted.[Cria\u00e7\u00e3o], inserted.[Cria\u00e7\u00e3o]), COALESCE(deleted.[Resolu\u00e7\u00e3o], inserted.[Resolu\u00e7\u00e3o], deleted.[Cria\u00e7\u00e3o], inserted.[Cria\u00e7\u00e3o]) INTO @datahoras_afetadas;\n\t\n\tDECLARE @min datetime2(0) = COALESCE(@datahora_inicio_forcada, (SELECT MIN(dh_min) FROM @datahoras_afetadas))\n\tDECLARE @max datetime2(0) = COALESCE(@datahora_fim_forcada, (SELECT MAX(dh_max) FROM @datahoras_afetadas))\n\t\n\tIF @min IS NOT NULL and @max IS NOT NULL\n\tBEGIN\n\t\tPRINT ''\n\t\tPRINT CONCAT('Periodo atualizado = ',@min, ' - ', @max) \n\t\tPRINT ''\n\n\t\t--EXEC sp_att_resumos @datahora_inicio = @min, @datahora_fim = @max, @metrica = 'tickets'\n\n\tEND\n\tELSE\n\tBEGIN\n\t\tPRINT ''\n\t\tPRINT 'Nenhuma altera\u00e7\u00e3o na base de tickets'\n\t\tPRINT ''\n\tEND\n\n\n\n\n\n\n\nGO\n",
        "build_order": 324,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT * FROM f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT * FROM f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_zendesk]": [
                "UNKNOWN",
                "dim_tickets_zendesk"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "EXEC",
                "EXEC sp_att_resumos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_att_tickets]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_att_tickets]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "EXEC",
                "EXEC sp_att_tickets"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_tickets_zendesk",
        "type": "StoredProcedure",
        "start": 778727,
        "end": 784953,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_tickets_zendesk]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE     PROCEDURE [dbo].[sp_att_tickets_zendesk]  \n\t@datahora_inicio_forcada datetime = NULL,\n\t@datahora_fim_forcada datetime = NULL\nAS\n\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_tickets_zendesk' and xtype='U')\n\tBEGIN\n\t\tCREATE TABLE [dbo].[dim_tickets_zendesk](\n\t\t\t[tribo_serasa]\t\t[varchar](50)\tNOT NULL,\n\t\t\t[subtribo_serasa]\t[varchar](50)\tNOT NULL,\n\t\t\t[ID_ticket]\t\t\t[int]\t\t\tNOT NULL,\n\t\t\t[status]\t\t\t[varchar](150)\tNULL,\n\t\t\t[ID_serasa]\t\t\t[varchar](10)\tNULL,\n\t\t\t[criacao]\t\t\t[datetime]\t\tNOT NULL,\n\t\t\t[resolucao]\t\t\t[datetime]\t\tNULL,\n\t\t\t[formulario]\t\t[varchar](500)\tNULL,\n\t\t\t[motivos]\t\t\t[varchar](500)\tNULL,\n\t\t\t[tmt]\t\t\t\t[int]\t\t\tNULL,\n\t\t\t[replicas]\t\t\t[int]\t\t\tNOT NULL,\n\t\t\t[resolvido]\t\t\t[bit]\t\t\tNOT NULL,\n\t\t\t[reincidente_48h]\t[bit]\t\t\tNOT NULL,\n\t\t\t[reincidente_30d]\t[bit]\t\t\tNOT NULL,\n\t\t\t[chatbot]\t\t\t[bit]\t\t\tNOT NULL,\n\t\t) ON [PRIMARY]\n\tEND\n\t\n\tDECLARE @datahoras_afetadas TABLE (tipo varchar(10) NOT NULL, dh_min datetime2(0) NOT NULL, dh_max datetime2(0) NOT NULL);\n\t\n\t;WITH destino AS \n\t(\n\t\tSELECT * FROM dim_tickets_zendesk\n\t)\n\tMERGE INTO destino \n\tUSING \n\t(\n\t\tSELECT \n\t\t\t [tribo_serasa]\t\t=\tt0.[tribo_serasa] \n\t\t\t,[subtribo_serasa]\t=\tt0.[subtribo_serasa]\n\t\t\t,[ID_ticket]\t\t=\tt0.[ID_ticket]\n\t\t\t,[status]\t\t\t=\tt7.[status]\n\t\t\t,[ID_serasa]\t\t=\tt0.[ID_serasa]\n\t\t\t,[criacao]\t\t\t=\tt0.[criacao]\n\t\t\t,[resolucao]\t\t=\tt0.[resolucao]\n\t\t\t,[formulario]\t\t=\tt0.[formulario]\n\t\t\t,[motivos]\t\t\t=\tt0.[motivos]\n\t\t\t,[tmt]\t\t\t\t=\tt2.[tmt]\n\t\t\t,[replicas]\t\t\t=\tISNULL(CASE WHEN t1.[replicas]  IS NULL AND t0.resolucao IS NOT NULL THEN 0 ELSE t1.[replicas]  END, 0)\n\t\t\t,[resolvido]\t\t=\tISNULL(CASE WHEN t3.[resolvido] IS NULL AND t0.resolucao IS NOT NULL THEN 1 ELSE t3.[resolvido] END, 0)\n\t\t\t,[reincidente_48h]\t=\tISNULL(t4.[reincidente_48h], 0)\n\t\t\t,[reincidente_30d]\t=\tISNULL(t5.[reincidente_30d], 0)\n\t\t\t,[chatbot]\t\t\t=\tISNULL(t6.[Chatbot?], 0)\n\t\tFROM (\n\t\t\tSELECT * FROM (\n\t\t\t\tSELECT\t\t\t\n\t\t\t\t\t [tribo_serasa]\n\t\t\t\t\t,[subtribo_serasa] = sb\n\t\t\t\t\t,[ID_ticket]\n\t\t\t\t\t,[formulario] = f\n\t\t\t\t\t,[motivos]\n\t\t\t\t\t,[criacao]\n\t\t\t\t\t,[resolucao]\n\t\t\t\t\t,[ID_serasa]\n\t\t\t\t\t,[n]=ROW_NUMBER() OVER (PARTITION BY [ID_ticket] ORDER BY [p], [resolucao] DESC) \n\t\t\t\tFROM (\n\t\t\t\t\tSELECT\t\t[tribo_serasa], sb=[tribo_serasa],\t[ID_ticket], f=null,\t\t[motivos],\t[criacao], [resolucao], [ID_serasa],\tp=0\tFROM dim_tickets_replicas\n\t\t\t\t\tUNION SELECT[tribo_serasa], [subtribo_serasa],\t[ID_ticket], [formulario],\t[motivos],\t[criacao], [resolucao], [login_agente],\tp=1 FROM dim_teste_tratados\n\t\t\t\t\tUNION SELECT[tribo_serasa], [subtribo_serasa],\t[ID_ticket], f=null,\t\tnull,\t\t[criacao], null,\t\tnull,\t\t\tp=2 FROM dim_teste_criados\n\t\t\t\t) _ \n\t\t\t) _ WHERE n=1\n\t\t\t\n\t\t) AS t0\n\t\tLEFT JOIN dim_tickets_replicas\t\tAS t1 ON t0.ID_ticket = t1.ID_ticket AND t0.resolucao = t1.resolucao\n\t\tLEFT JOIN dim_teste_tmt\t\t\t\tAS t2 ON t0.ID_ticket = t2.ID_ticket\n\t\tLEFT JOIN dim_teste_resolvidos\t\tAS t3 ON t0.ID_ticket = t3.ID_ticket\n\t\tLEFT JOIN dim_teste_tickets_rein48h\tAS t4 ON t0.ID_ticket = t4.ID_ticket\n\t\tLEFT JOIN dim_teste_tickets_rein30d\tAS t5 ON t0.ID_ticket = t5.ID_ticket\n\t\tLEFT JOIN (SELECT [ID_ticket], [Chatbot?] = IIF(SUM(IIF([tag] like '%chatbot%',1,0))=0,0,1) FROM dim_tickets_tags GROUP BY [ID_ticket]) AS t6 ON t0.ID_ticket = t6.ID_ticket\n\t\tLEFT JOIN dim_teste_criados\t\t\tAS t7 ON t0.ID_ticket = t7.ID_ticket\n\t) AS fonte\n\tON  fonte.[ID_ticket] = destino.[ID_ticket]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([tribo_serasa], [subtribo_serasa], [ID_ticket], [status], [ID_serasa], [criacao], [resolucao], [formulario], [motivos], [tmt], [replicas], [resolvido], [reincidente_48h], [reincidente_30d], [chatbot]) \n\t\tVALUES (fonte.[tribo_serasa], fonte.[subtribo_serasa], fonte.[ID_ticket], fonte.[status], fonte.[ID_serasa], fonte.[criacao], fonte.[resolucao], fonte.[formulario], fonte.[motivos], fonte.[tmt], fonte.[replicas], fonte.[resolvido], fonte.[reincidente_48h], fonte.[reincidente_30d], fonte.[chatbot]) \n\n\tWHEN MATCHED \n\t\tAND(destino.[tribo_serasa]\t\t\t\t<>\tfonte.[tribo_serasa] \n\t\tOR  destino.[subtribo_serasa]\t\t\t<>\tfonte.[subtribo_serasa]\n\t\tOR  COALESCE(destino.[status], '-')\t\t<>\tCOALESCE(fonte.[status], '-')\n\t\tOR  COALESCE(destino.[ID_serasa], '-')\t<>\tCOALESCE(fonte.[ID_serasa], '-')\n\t\tOR  destino.[criacao]\t\t\t\t\t<>\tfonte.[criacao]\n\t\tOR  COALESCE(destino.[resolucao], '1999-01-01')\t<>\tCOALESCE(fonte.[resolucao], '1999-01-01')\n\t\tOR  COALESCE(destino.[formulario], '-')\t<>\tCOALESCE(fonte.[formulario], '-')\n\t\tOR  COALESCE(destino.[motivos], '-')\t<>\tCOALESCE(fonte.[motivos], '-')\n\t\tOR  COALESCE(destino.[tmt], '-')\t\t<>\tCOALESCE(fonte.[tmt], '-')\n\t\tOR  destino.[replicas]\t\t\t\t\t<>\tfonte.[replicas]\n\t\tOR  destino.[resolvido]\t\t\t\t\t<>\tfonte.[resolvido]\n\t\tOR  destino.[reincidente_48h]\t\t\t<>\tfonte.[reincidente_48h]\n\t\tOR  destino.[reincidente_30d]\t\t\t<>\tfonte.[reincidente_30d]\n\t\tOR\tdestino.[chatbot]\t\t\t\t\t<>\tfonte.[chatbot])\n\tTHEN UPDATE SET\n\t\t destino.[tribo_serasa]\t\t=\tfonte.[tribo_serasa] \n\t\t,destino.[subtribo_serasa]\t=\tfonte.[subtribo_serasa]\n\t\t,destino.[status]\t\t\t=\tfonte.[status]\n\t\t,destino.[ID_serasa]\t\t=\tfonte.[ID_serasa]\n\t\t,destino.[criacao]\t\t\t=\tfonte.[criacao]\n\t\t,destino.[resolucao]\t\t=\tfonte.[resolucao]\n\t\t,destino.[formulario]\t\t=\tfonte.[formulario]\n\t\t,destino.[motivos]\t\t\t=\tfonte.[motivos]\n\t\t,destino.[tmt]\t\t\t\t=\tfonte.[tmt]\n\t\t,destino.[replicas]\t\t\t=\tfonte.[replicas]\n\t\t,destino.[resolvido]\t\t=\tfonte.[resolvido]\n\t\t,destino.[reincidente_48h]\t=\tfonte.[reincidente_48h]\n\t\t,destino.[reincidente_30d]\t=\tfonte.[reincidente_30d]\n\t\t,destino.[chatbot]\t\t\t=\tfonte.[chatbot]\n    \n\tWHEN NOT MATCHED BY SOURCE THEN\n\t\tDELETE\n\n\tOUTPUT $action, COALESCE(deleted.[resolucao], inserted.[resolucao], GETDATE()), COALESCE(deleted.[resolucao], inserted.[resolucao], GETDATE()) INTO @datahoras_afetadas;\n\n\tDECLARE @min datetime2(0) = COALESCE(@datahora_inicio_forcada, (SELECT MIN(dh_min) FROM @datahoras_afetadas))\n\tDECLARE @max datetime2(0) = COALESCE(@datahora_fim_forcada, (SELECT MAX(dh_max) FROM @datahoras_afetadas))\n\n\tSELECT [Retorno]=CONCAT('dim_tickets_zendesk atualizada ',@min,' - ',@max)\n\n\tEXEC sp_att_tickets  @datahora_inicio_forcada=@min, @datahora_fim_forcada=@max\n\t\n\n\n\n\n\nGO\n",
        "build_order": 325,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_tags]": [
                "SELECT",
                "SELECT [ID_ticket], [Chatbot?] = IIF(SUM(IIF([tag] like '%chatbot%',1,0))=0,0,1) FROM dim_tickets_tags"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_zendesk]": [
                "SELECT",
                "SELECT [Retorno]=CONCAT('dim_tickets_zendesk"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_criados]": [
                "UNKNOWN",
                "dim_teste_criados"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_resolvidos]": [
                "UNKNOWN",
                "dim_teste_resolvidos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein30d]": [
                "UNKNOWN",
                "dim_teste_tickets_rein30d"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein48h]": [
                "UNKNOWN",
                "dim_teste_tickets_rein48h"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tmt]": [
                "UNKNOWN",
                "dim_teste_tmt"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tratados]": [
                "SELECT",
                "SELECT[tribo_serasa], [subtribo_serasa],\t[ID_ticket], [formulario],\t[motivos],\t[criacao], [resolucao], [login_agente],\tp=1 FROM dim_teste_tratados"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_replicas]": [
                "UNKNOWN",
                "dim_tickets_replicas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets]": [
                "EXEC",
                "EXEC sp_att_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_att_tickets_zendesk]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_att_tickets_zendesk]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_you_forms]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_you_forms]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_att_you_forms",
        "type": "StoredProcedure",
        "start": 784953,
        "end": 785301,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_att_you_forms]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE           PROCEDURE [dbo].[sp_att_you_forms]\nAS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\tDROP TABLE IF EXISTS dim_you_forms\n\tSELECT * INTO dim_you_forms FROM #temp0\n\n\n\nGO\n",
        "build_order": 326,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_forms]": [
                "SELECT",
                "SELECT * INTO dim_you_forms"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_you_forms]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_you_forms]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_you_forms]": [
                "CREATE",
                "CREATE           PROCEDURE [dbo].[sp_att_you_forms]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_bilhetes]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_bilhetes]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_bilhetes",
        "type": "StoredProcedure",
        "start": 785301,
        "end": 786210,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_bilhetes]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\nCREATE PROCEDURE [dbo].[sp_bilhetes] AS\n\nSET LANGUAGE 'Portugu\u00eas (Brasil)';\nSET DATEFORMAT ymd;\n\nUPDATE #temp0 SET GrupoDescricao = REPLACE(GrupoDescricao,'Premium','0800 Premium')\n\nDELETE FROM #temp0 \nWHERE [GrupoDescricao] IS NULL\nOR [BilheteId] IS NULL\nOR [RamalNumero] IS NULL\nOR [DataInicio] IS NULL\nOR [DataFim] IS NULL\nOR [DuracaoReal] IS NULL\n\nDELETE FROM dim_bilhetes WHERE EXISTS (SELECT 1 FROM #temp0 WHERE dim_bilhetes.[ID_bilhete] = #temp0.[BilheteId])\n\nINSERT INTO dim_bilhetes SELECT [GrupoDescricao], [BilheteId], [RamalNumero], [DataInicio], [DataFim], [DuracaoReal] FROM #temp0\n\n\n--UPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([fim]) from dim_bilhetes) \n--WHERE [table] = 'dim_bilhetes'\n\n\n\n\nGO\n",
        "build_order": 327,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_bilhetes]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_bilhetes]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_bilhetes]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_bilhetes]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_calendario]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_calendario]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_calendario",
        "type": "StoredProcedure",
        "start": 786210,
        "end": 792256,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_calendario]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE PROCEDURE [dbo].[sp_calendario] AS\n\n\nSET LANGUAGE 'Portugu\u00eas (Brasil)';\nSET DATEFORMAT dmy;\n\n\nDROP TABLE IF EXISTS dim_calendario;\n\nDECLARE @limite_hist  date = '01/01/2020'; \nDECLARE @limite_futuro date = '01/01/2025'; -- DATEADD(MONTH, 1, GETDATE());\n\nWITH seq(n) AS \n(\n  SELECT 0 UNION ALL SELECT n + 1 FROM seq\n  WHERE n < DATEDIFF(DAY, @limite_hist, @limite_futuro)\n),\nd(d) AS \n(\n  SELECT DATEADD(DAY, n, @limite_hist) FROM seq\n),\nsrc AS\n(\n  SELECT\n    Data\t\t\t\t\t\t\t= CONVERT(DATE, d),\n    Ano\t\t\t\t\t\t\t\t= DATEPART(YEAR, d),\n\n    M\u00eas\t\t\t\t\t\t\t\t= DATEPART(MONTH, d),\n    M\u00eas_Nome\t\t\t\t\t\t= DATENAME(MONTH, d),\n    M\u00eas_PrimeroDia\t\t\t\t\t= DATEFROMPARTS(YEAR(d), MONTH(d), 1),\n\tM\u00eas_Passado\t\t\t\t\t\t= DATENAME(MONTH, DATEADD(MONTH, - 1, DATEFROMPARTS(YEAR(d), MONTH(d), 1))),\n\tM\u00easAno_Formatado\t\t\t\t= DATENAME(MONTH, d) + '-' + CAST(DATEPART(YEAR, d) AS VARCHAR),\n\tM\u00easAno_FormatadoAbreviado\t\t= LEFT(DATENAME(MONTH, d), 3) + '-' + CAST(DATEPART(YEAR, d) AS VARCHAR),\n\tM\u00easAno_FormatadoClassific\t\t= CAST(CAST(DATEPART(YEAR, d) AS VARCHAR) + FORMAT(DATEPART(MONTH, d), '00') AS INT),\n\n    Dia\t\t\t\t\t\t\t\t= DATEPART(DAY, d),\n    DiaSemana\t\t\t\t\t\t= DATEPART(WEEKDAY, d),\n    DiaSemana_Nome\t\t\t\t\t= DATENAME(WEEKDAY, d),\n    DiaSemana_NomeCurto\t\t\t\t= LOWER(LEFT(DATENAME(WEEKDAY, d), 3)),\n\tDiaUtil\t\t\t\t\t\t\t= CASE WHEN (DATEPART(WEEKDAY, d) = 1 OR DATEPART(WEEKDAY, d) = 7) THEN 0 ELSE 1 END,\n\tDiaUtil_ComSabado\t\t\t\t= CASE WHEN (DATEPART(WEEKDAY, d) = 1) THEN 0 ELSE 1 END,\n\tDiaUtil_N\u00e3oFeriados\t\t\t\t= (CASE WHEN (DATEPART(WEEKDAY, d) = 1 OR DATEPART(WEEKDAY, d) = 7) THEN 0 ELSE 1 END) * ISNULL(t1.feriados,0),\n\tDiaUtil_ComSabado_N\u00e3oFeriados\t= (CASE WHEN (DATEPART(WEEKDAY, d) = 1) THEN 0 ELSE 1 END) * ISNULL(t1.feriados,0),\n\n    Semana_Ano\t\t\t\t\t\t= DATEPART(WEEK, d),\n\tSemana_Mes\t\t\t\t\t\t= DATEPART(WEEK, d) - DATEPART(WEEK, DATEADD(MONTH, DATEDIFF(MONTH, 0, d), 0)) + 1,\n\tSemana_Mes_For\u00e7ada\t\t\t\t= CASE WHEN (DATEPART(DAY, d) > 21) THEN 4 ELSE ((DATEPART(DAY, d)-1)/7)+1 END,\n\tSemana_Mes_For\u00e7ada_PrimeiroDia\t= DATEADD(DAY, (CASE WHEN (DATEPART(DAY, d) > 21) THEN 4 ELSE ((DATEPART(DAY, d)-1)/7)+1 END-1)*7, DATEFROMPARTS(YEAR(d), MONTH(d), 1)),\n\tSemana_Mes_For\u00e7ada_Texto\t\t= CONCAT(CAST((CASE WHEN (DATEPART(DAY, d) > 21) THEN 4 ELSE ((DATEPART(DAY, d)-1)/7)+1 END)As varchar),'\u00ba Semana'),\n\n\tTrimestre\t\t\t\t\t\t= DATEPART(QUARTER, d),\n\tTrimestre_Texto\t\t\t\t\t= CONCAT(CAST(DATEPART(QUARTER, d)As varchar),'\u00ba Trimestre'),\n\tSemestre\t\t\t\t\t\t= (DATEPART(MONTH, d)-1)/6 +1,\n\tFeriados\t\t\t\t\t\t= ISNULL(t1.Feriados, 0),\n\tFeriado_Nome\t\t\t\t\t= t1.Feriado_Nome  \n  FROM d AS t0\n  \tLEFT JOIN(\n\t SELECT Data, 1 AS Feriados, Feriado AS Feriado_Nome FROM dim_feriados_nacionais) AS t1\n\t ON\n\t CONVERT(DATE, t0.d) = t1.Data \n)\nSELECT * INTO dim_calendario FROM src\nORDER BY Data\nOPTION (MAXRECURSION 0);\n\n\n--------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\nDROP TABLE IF EXISTS dim_calendario_30min;\nSELECT [DataHora] = cast(Data as datetime) + cast(Hor\u00e1rio as datetime), * INTO dim_calendario_30min FROM dim_calendario as t0\nCROSS JOIN (\n\tSELECT horario as Hor\u00e1rio FROM dim_aux_horarios_30min\n\tWHERE horario <= TIMEFROMPARTS(23,30,00,00,00)\n\tAND   horario >= TIMEFROMPARTS(00,00,00,00,00)\n) as t1\nORDER BY Data, Hor\u00e1rio \n\n--------------------------------------------------------------------------------------------------------------------------------------------------------\n/*\n--DROP TABLE dim_calendario_min\nIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_calendario_min' and xtype='U')\n\tCREATE TABLE [dim_calendario_min] (\n\t\t [DataHora]\t\t\t\t\t\t\t[datetime2](0)\tNOT NULL\n    \t,[Hora]\t\t\t\t\t\t\t\t[time](0)\t\tNOT NULL\n\t\t,[Intervalo]\t\t\t\t\t\t[time](0)\t\tNOT NULL\n\t\t,[Data]\t\t\t\t\t\t\t\t[date]\t\t\tNOT NULL\n\t\t,[Ano]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[M\u00eas]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[M\u00eas_Nome]\t\t\t\t\t\t\t[nvarchar](30)\tNOT NULL\n\t\t,[M\u00eas_PrimeiroDia]\t\t\t\t\t[date]\t\t\tNOT NULL\n\t\t,[M\u00eas_Passado]\t\t\t\t\t\t[nvarchar](30)\tNOT NULL\n\t\t,[M\u00easAno_Formatado]\t\t\t\t\t[nvarchar](61)\tNOT NULL\n\t\t,[M\u00easAno_FormatadoAbreviado]\t\t[nvarchar](34)\tNOT NULL\n\t\t,[M\u00easAno_FormatadoClassific]\t\t[int]\t\t\tNOT NULL\n\t\t,[Dia]\t\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[DiaSemana]\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[DiaSemana_Nome]\t\t\t\t\t[nvarchar](30)\tNOT NULL\n\t\t,[DiaSemana_NomeCurto]\t\t\t\t[nvarchar](3)\tNOT NULL\n\t\t,[DiaUtil]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[DiaUtil_ComSabado]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[DiaUtil_N\u00e3oFeriados]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[DiaUtil_ComSabado_N\u00e3oFeriados]\t[int]\t\t\tNOT NULL\n\t\t,[Semana_Ano]\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[Semana_Mes]\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[Semana_Mes_For\u00e7ada]\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[Semana_Mes_For\u00e7ada_PrimeiroDia]\t[date]\t\t\tNOT NULL\n\t\t,[Semana_Mes_For\u00e7ada_Texto]\t\t\t[varchar](38)\tNOT NULL\n\t\t,[Trimestre]\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[Trimestre_Texto]\t\t\t\t\t[varchar](41)\tNOT NULL\n\t\t,[Semestre]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[Feriados]\t\t\t\t\t\t\t[int]\t\t\tNOT NULL\n\t\t,[Feriado_Nome]\t\t\t\t\t\t[varchar](50)\tNULL\n\t)\n\n\nDECLARE @inicio_min\tdatetime2(0) = CAST(@limite_hist\tAS datetime2(0))\nDECLARE @fim_min\tdatetime2(0) = CAST(@limite_futuro\tAS datetime2(0))\n\nDELETE FROM [dim_calendario_min];\nWITH \nN AS \n(\n    SELECT N FROM (VALUES(NULL),(NULL),(NULL),(NULL),(NULL),(NULL),(NULL),(NULL),(NULL),(NULL)) N(N)\n),\nacumulo AS \n(\n    SELECT TOP (DATEDIFF_BIG(MINUTE,@inicio_min,@fim_min)+1)\n\t\t[DataHora] = DATEADD(MINUTE, ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) - 1, @inicio_min)\n    FROM N N1, N N2,  N N3,  N N4, N N5, N N6, N N7, N N8, N N9 -- Vai at\u00e9 1B de linhas (pouco menos de 32 anos)\n),\nadd_colunas AS\n(\n\tSELECT\n\t\t [DataHora]\n\t\t,[Hora]\t\t = CAST([DataHora] AS time)\n\t\t,[Intervalo] = DATETIME2FROMPARTS(YEAR([DataHora]), MONTH([DataHora]), DAY([DataHora]), DATEPART(HOUR, [DataHora]), FLOOR(DATEPART(MINUTE, [DataHora]) / 30.0) * 30, 00, 00, 00)\n\tFROM acumulo\n),\ngrude AS \n(\n\tSELECT * FROM add_colunas t0 \n\tLEFT JOIN dim_calendario t1 \n\tON CAST(t0.DataHora AS date) = t1.Data\n)\nINSERT INTO [dim_calendario_min] SELECT * FROM grude\n\n*/\n\nGO\n",
        "build_order": 328,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "UNKNOWN",
                "dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_feriados_nacionais]": [
                "SELECT",
                "SELECT Data, 1 AS Feriados, Feriado AS Feriado_Nome FROM dim_feriados_nacionais"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_aux_horarios_30min]": [
                "SELECT",
                "SELECT horario as Hor\u00e1rio FROM dim_aux_horarios_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": [
                "SELECT",
                "SELECT [DataHora] = cast(Data as datetime) + cast(Hor\u00e1rio as datetime), * INTO dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_calendario]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_calendario]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_calendario]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_calendario]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_Calendarioneitor]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_Calendarioneitor]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_Calendarioneitor",
        "type": "StoredProcedure",
        "start": 792256,
        "end": 792897,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_Calendarioneitor]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   PROCEDURE [dbo].[sp_Calendarioneitor] AS\n\nDECLARE @data_atual DATETIME = '01/06/2024 00:30'; \n\nWHILE @data_atual <= '31/07/2024'\nBEGIN \n    INSERT INTO d_calendario(datahora, data, intervalo)\n    VALUES \n    (\n          @data_atual\n\t\t ,CAST(@data_atual AS DATE)\n\t\t ,DATEADD(SECOND, DATEDIFF(SECOND, CAST(@data_atual AS DATE), @data_atual),'00:00')\n    );\n\n    --SET @data_atual = DATEADD(DAY, 1, @data_atual); \n\t  SET @data_atual = DATEADD(MINUTE, 30, @data_atual); \nEND;\n\n\nGO\n",
        "build_order": 329,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_calendario]": [
                "INSERT",
                "INSERT INTO d_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_Calendarioneitor]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_Calendarioneitor]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_Calendarioneitor]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_Calendarioneitor]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_contador]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_contador]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_contador",
        "type": "StoredProcedure",
        "start": 792897,
        "end": 793639,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_contador]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   PROCEDURE [dbo].[sp_contador] AS\n\nDECLARE @contador INT = 1;\nDECLARE @minimo VARCHAR(10);\nDECLARE @chara INT\nDECLARE @sobrenome VARCHAR(10)\n\nWHILE @contador <= 500\nBEGIN\n\tSET @chara = 1\n\tWHILE @chara <= 10\n\tBEGIN\n\t\tSET @sobrenome = CONCAT(@sobrenome , CHAR(RAND() * 11000 * @chara))  \n\tSET @chara = @chara + 1;\n\tEND\n\n\tSET @minimo = CAST(FLOOR(RAND() * 1000) AS VARCHAR(10));\n\tINSERT INTO d_usuarios(id_usuario, nome_usuario)\n\tVALUES\n\t(\n\tCONCAT('C', LEFT('000000',6-LEN(@minimo)),@minimo, 'A'),\n\tCONCAT('Jorge', CHAR(@contador),@sobrenome)\n\t);\n\nSET @contador = @contador + 1;\nEND;\n\n\n\nGO\n",
        "build_order": 330,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_contador]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_contador]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_contador]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_contador]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_distribuicao_hora]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_distribuicao_hora]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_distribuicao_hora",
        "type": "StoredProcedure",
        "start": 793639,
        "end": 793973,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_distribuicao_hora]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\nCREATE       PROCEDURE [dbo].[sp_distribuicao_hora]\nAS\n\nset dateformat dmy;\n\nDELETE FROM dim_distribuicao_hora\n\nINSERT INTO dim_distribuicao_hora\nSELECT *\nFROM #temp0\n\n\n\nGO\n",
        "build_order": 331,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_distribuicao_hora]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_distribuicao_hora]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_distribuicao_hora]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_distribuicao_hora]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_forecast_30min]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_forecast_30min]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_forecast_30min",
        "type": "StoredProcedure",
        "start": 793973,
        "end": 795580,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_forecast_30min]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE         PROCEDURE [dbo].[sp_forecast_30min] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_forecast_30min' and xtype='U')\n\tBEGIN\t\n\t\tCREATE TABLE [dbo].[dim_forecast_30min](\n\t\t\t [tribo]\t\t            [varchar](50)\tNOT NULL\n\t\t\t,[datahora]\t\t            [datetime]\t\tNOT NULL\n\t\t\t,[volume]\t\t            [float]\t\t\tNOT NULL\n\t\t\t,[tmt]\t\t\t            [float]\t\t\tNOT NULL\n\t\t\t,[tma]\t\t\t            [float]\t\t\tNOT NULL\n\t\t\t,[ns]\t\t\t            [float]\t\t\tNULL\n\t\t\t,[sla]\t\t\t            [float]\t\t\tNULL\n\t\t\t,[hc_tx1]\t\t            [int]\t\t\tNOT NULL\n\t\t\t,[hc_tx2]\t\t            [int]\t\t\tNOT NULL\n\t\t\t,[pausas_tx1]\t            [float]\t\t\tNOT NULL\n\t\t\t,[pausas_tx2]\t            [float]\t\t\tNOT NULL\n\t\t\t,[Agentes em Pausa (VOZ)]   [float]\t        NULL\n\t\t\t,[PA Liquida (VOZ)]         [float]\t        NULL\n\t\t\t,[Pausa Almo\u00e7o (VOZ)]       [time]          NULL\n\t\t\t,[Pausa Almo\u00e7o (%) (VOZ)]   [float]         NULL\n\t\t) ON [PRIMARY]\n\tEND\n\n\t\n\tIF OBJECT_ID('tempdb..#temp0') IS NOT NULL\n\tBEGIN\t\n\t\tDELETE FROM dim_forecast_30min WHERE [DataHora] >= '01/01/2024'; \n\t\tINSERT INTO dim_forecast_30min \n\t\tSELECT \n\t\t\t [Tribo]\n\t\t\t,[DataHora]\n\t\t\t,[Volume]\n\t\t\t,[TMT]\n\t\t\t,[TMA]\n\t\t\t,[NS]\n\t\t\t,[SLA (H)]\n\t\t\t,[PA tx1]\n\t\t\t,[PA tx2] * 2\n\t\t\t,[Pausas tx1]\n\t\t\t,[Pausas tx2]\n\t\t\t,[Agentes em Pausa (VOZ)]\n\t\t\t,[PA Liquida (VOZ)]\n\t\t\t,[Pausa Almo\u00e7o (VOZ)]\n\t\t\t,[Pausa Almo\u00e7o (%) (VOZ)]\n\t\tFROM #temp0\n\t\tWHERE [DataHora] >= '01/01/2024'\n\tEND\n\n\nGO\n",
        "build_order": 332,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_30min]": [
                "INSERT",
                "INSERT INTO dim_forecast_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_forecast_30min]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_forecast_30min]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_forecast_30min]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_forecast_30min]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_generator]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_generator]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_generator",
        "type": "StoredProcedure",
        "start": 795580,
        "end": 796097,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_generator]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[sp_generator] AS\n\ndelete from d_usuarios\n\t\nDECLARE @contador INT = 1;\nwhile @contador <= 10\nBEGIN\n\tINSERT INTO d_usuarios(id_usuario,nome_usuario)\n\tVALUES\n\t(\n        CONCAT('C', CAST(FLOOR(RAND() * 1000) AS VARCHAR(10)), 'A'),\n        CONCAT('Jorge', CAST(FLOOR(RAND() * 1000) AS VARCHAR(10)))\n    );\n\nSET @contador = @contador + 1;\nEND;\n\n\n\nGO\n",
        "build_order": 333,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_generator]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_generator]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_generator]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_generator]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_justificativas_abs]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_justificativas_abs]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_justificativas_abs",
        "type": "StoredProcedure",
        "start": 796097,
        "end": 797045,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_justificativas_abs]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE             PROCEDURE [dbo].[sp_justificativas_abs]\nAS\n\n\nSET LANGUAGE 'Portugu\u00eas (Brasil)';\nSET DATEFORMAT dmy;\n\n\n\n\t\n\t--SELECT * FROM dim_justificativas_abs\n\t--DROP TABLE teste\n\t--SELECT * INTO teste FROM #temp0\n\t--SELECT * FROM teste\n\t--drop table dim_justificativas_abs\n\n\t\n\n\n\nUPDATE #temp0 SET \n[Login Agente] = TRY_CAST([Login Agente] AS INT),\n[Data In\u00edcio] = TRY_CAST([Data In\u00edcio] AS DATE),\n[Data Fim] = TRY_CAST([Data Fim] AS DATE)\n\n\nDELETE FROM #temp0\nWHERE [Login Agente] IS NULL\nOR [Data In\u00edcio] IS NULL\nOR [Data Fim] IS NULL\nOR [Data Fim] < [Data In\u00edcio]\nOR [Supervisor Respons\u00e1vel] IS NULL\nOR [Atestado?] IS NULL\nOR [Justificativa 1] IS NULL\nOR [Justificativa 2] IS NULL\n\n\nDELETE FROM dim_justificativas_abs\nINSERT INTO dim_justificativas_abs\nSELECT * FROM #temp0\n\n\n\n\nGO\n",
        "build_order": 334,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_justificativas_abs]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_justificativas_abs]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_justificativas_abs]": [
                "CREATE",
                "CREATE             PROCEDURE [dbo].[sp_justificativas_abs]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_log_a]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_log_a]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_log_a",
        "type": "StoredProcedure",
        "start": 797045,
        "end": 797779,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_log_a]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   PROCEDURE [dbo].[sp_log_a] AS\n\nDECLARE @contador INT = 1;\nDECLARE @minimo VARCHAR(10);\nDECLARE @chara INT\nDECLARE @sobrenome VARCHAR(10)\n\nWHILE @contador <= 250\nBEGIN\n\tSET @chara = 1\n\tWHILE @chara <= 10\n\tBEGIN\n\t\tSET @sobrenome = CONCAT(@sobrenome , CHAR(RAND() * 1000 * @chara))  \n\tSET @chara = @chara + 1;\n\tEND\n\n\tSET @minimo = CAST(FLOOR(RAND() * 1000) AS VARCHAR(10));\n\tINSERT INTO d_usuarios(id_usuario, nome_usuario)\n\tVALUES\n\t(\n\tCONCAT('C', LEFT('000000',6-LEN(@minimo)),@minimo, 'A'),\n\tCONCAT('Jorge', CHAR(@contador),@sobrenome)\n\t);\n\nSET @contador = @contador + 1;\nEND;\n\n\nGO\n",
        "build_order": 335,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_log_a]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_log_a]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_log_a]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_log_a]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mendi_oneaone]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mendi_oneaone]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_mendi_oneaone",
        "type": "StoredProcedure",
        "start": 797779,
        "end": 798909,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_mendi_oneaone]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE      PROCEDURE [dbo].[sp_mendi_oneaone]\nAS\n--SELECT * INTO testemendi FROM #temp0  \n\nset dateformat dmy;\n\n\nDELETE FROM dim_mendi_oneaone \nWHERE titulo_pesquisa = (SELECT TOP(1) [titulo_pesquisa] FROM #temp0) \nAND [id] in (SELECT DISTINCT [id] FROM #temp0) \n\nINSERT INTO dim_mendi_oneaone \nSELECT \n--trim([simple_text]),\n--REPLACE([simple_text],' | ',''),\n[titulo_pesquisa],\nCASE \n\tWHEN CHARINDEX(' | ',[simple_text]) > 0 THEN right([simple_text],CHARINDEX(' | ',reverse([simple_text])))\n\tELSE [simple_text]\nEND,\n[score], \n[pages.questions.heading], \n[id], \n[total_time],\nCONVERT(DATETIME,LEFT(CAST([date_modified] AS varchar),19),126),\nCONVERT(DATETIME,LEFT(CAST([date_created] AS varchar),19),126)\nFROM #temp0 \n\nDROP TABLE IF EXISTS f_mendi_oneaone\nSELECT * INTO f_mendi_oneaone FROM vw_mendi_oneaone  \n\n\nUPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([data]) from vw_mendi_oneaone) \nWHERE [table] = 'vw_mendi_oneaone'\n\n\nGO\n",
        "build_order": 336,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mendi_oneaone]": [
                "SELECT",
                "SELECT * INTO f_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mendi_oneaone]": [
                "INSERT",
                "INSERT INTO dim_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_mendi_oneaone]": [
                "UNKNOWN",
                "vw_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mendi_oneaone]": [
                "SELECT",
                "SELECT * INTO f_mendi_oneaone"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mendi_oneaone]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[sp_mendi_oneaone]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mendi_oneaone]": [
                "CREATE",
                "CREATE      PROCEDURE [dbo].[sp_mendi_oneaone]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mop_turnovers]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mop_turnovers]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_mop_turnovers",
        "type": "StoredProcedure",
        "start": 798909,
        "end": 800214,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_mop_turnovers]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE       PROCEDURE [dbo].[sp_mop_turnovers] AS\n\nSET LANGUAGE 'Portugu\u00eas (Brasil)';\nSET DATEFORMAT dmy;\n\nSELECT * INTO #input FROM (SELECT n=ROW_NUMBER() OVER(PARTITION BY [Usu\u00e1rio ] ORDER BY [Solicita\u00e7\u00e3o do desligamento] DESC), * FROM #temp0) as t0\nWHERE n=1\nAND [Usu\u00e1rio ] IS NOT NULL\nAND [Solicita\u00e7\u00e3o do desligamento] IS NOT NULL\nAND [Data da Rescis\u00e3o] IS NOT NULL\nAND [Em qual etapa da jornada o profissional est\u00e1 saindo?] IS NOT NULL\nAND COALESCE([Tipo de desligamento - volunt\u00e1rio], [Tipo de desligamento - involunt\u00e1rio]) IS NOT NULL\nAND [Profissional \u00e9 indicado para recontra\u00e7\u00e3o?] IS NOT NULL\n\nDELETE FROM dim_mop_turnovers\nINSERT INTO dim_mop_turnovers \nSELECT\n\tTRIM([Usu\u00e1rio ]),\n\t[Solicita\u00e7\u00e3o do desligamento],\n\t[Data da Rescis\u00e3o],\n\tTRIM([Em qual etapa da jornada o profissional est\u00e1 saindo?]),\n\tCASE \n\t\tWHEN [Tipo de desligamento - volunt\u00e1rio] IS NOT NULL THEN 'Volunt\u00e1rio'\n\t\tWHEN [Tipo de desligamento - involunt\u00e1rio] IS NOT NULL THEN 'Involunt\u00e1rio'\n\tEND,\n\tTRIM(COALESCE([Tipo de desligamento - volunt\u00e1rio], [Tipo de desligamento - involunt\u00e1rio])),\n\tTRIM([Profissional \u00e9 indicado para recontra\u00e7\u00e3o?]),\n\t[Custos Rescis\u00e3o]\nFROM #input\n\nGO\n",
        "build_order": 337,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_turnovers]": [
                "INSERT",
                "INSERT INTO dim_mop_turnovers"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mop_turnovers]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_mop_turnovers]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_mop_turnovers]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_mop_turnovers]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_nps",
        "type": "StoredProcedure",
        "start": 800214,
        "end": 820497,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_nps]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE     PROCEDURE [dbo].[sp_nps] AS\n\t\t\nset dateformat dmy;\n\nDELETE FROM #temp0  \nWHERE TRY_CAST([ID] AS INT) IS NULL\n\nUPDATE #temp0 SET [Login] = 'S/INFO' WHERE [Login] IS NULL\n\nDELETE FROM tb_nps \nWHERE [ID_avaliacao] IN (SELECT DISTINCT [ID] FROM #temp0 WHERE [ID] IS NOT NULL)\n\nINSERT INTO tb_nps SELECT * FROM #temp0\n\nDROP TABLE IF EXISTS f_nps_V2; \nWITH\nnps_base AS\n(\n\tSELECT \n\t\t[data_atualizacao_nps]\t\t\t\t=\tnps.data_atualizacao,\n\t\t[data_atualizacao_mop]\t\t\t\t=\tmop.[Data da Atualiza\u00e7\u00e3o],\n\t\t[DataHora da Opini\u00e3o]\t\t\t\t=\tnps.data_avaliacao,\n\t\t[Hora da Opini\u00e3o]\t\t\t\t\t=\tCAST(nps.data_avaliacao AS TIME),\n\t\t[Data da Opini\u00e3o]\t\t\t\t\t=\tcal.Data,\n\t\t[Semana da Opini\u00e3o]\t\t\t\t\t=\tcal.Semana_Mes_For\u00e7ada,\n\t\t[M\u00eas da Opini\u00e3o]\t\t\t\t\t=\tcal.M\u00eas_PrimeroDia,\n\t\t[ID do Ticket/Protocolo]\t\t\t=\tnps.ID_ticket,\n\t\t[ID da Opini\u00e3o]\t\t\t\t\t\t=\tnps.ID_avaliacao,\n\t\t[Tribo Serasa Original]\t\t\t\t=\tnps.tribo,\n\t\t[Tribo Serasa Padronizada]\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.data_avaliacao < '01/06/2023' THEN\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - 0800 Premium'\t\t\t\t\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'NPS - Atendimento Premium (0800)'\t\tTHEN '0800 Premium'\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - Produto Autentica\u00e7\u00e3o - Desbloqueio' THEN 'OCR - IDWALL'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cadastro Positivo'\t\t\t\t\t\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'SAC'\t\t\t\t\t\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'BackOffice'\t\t\t\t\t\t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'OCR'\t\t\t\t\t\t\t\t\t\tTHEN 'OCR - IDWALL'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'OCR - IDWALL'\t\t\t\t\t\t\tTHEN 'OCR - IDWALL'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda'\t\t\t\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cr\u00e9dito'\t\t\t\t\t\t\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'D\u00edvidas'\t\t\t\t\t\t\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Score'\t\t\t\t\t\t\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Outros' END\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.data_avaliacao < '01/06/2024' THEN\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Premium - 0800'\t\t\t\t\t\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= '0800 Premium'\t\t\t\t\t\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cadastro Positivo'\t\t\t\t\t\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Sac'\t\t\t\t\t\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Backoffice'\t\t\t\t\t\t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Autentica\u00e7\u00e3o'\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Produto'\t\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda'\t\t\t\t\t\tTHEN 'Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Outros' END\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Premium - 0800'\t\t\t\t\t\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= '0800 Premium'\t\t\t\t\t\t\tTHEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cadastro Positivo'\t\t\t\t\t\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Sac'\t\t\t\t\t\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Backoffice'\t\t\t\t\t\t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Autentica\u00e7\u00e3o'\t\t\tTHEN 'Central de Ajuda - Autentica\u00e7\u00e3o'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Produto'\t\t\t\tTHEN 'Central de Ajuda - Produtos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda'\t\t\t\t\t\tTHEN 'Central de Ajuda - Produtos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Chat Humano'\t\t\tTHEN 'Chat'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Chat - Ath'      \t\t\t\t\t\tTHEN 'Chat'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Outros' END\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[Tribo Completa Padronizada]\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.data_avaliacao < '01/06/2023' THEN\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - 0800 Premium'\t\t\t\t\t\tTHEN 'Serasa__Premium__0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'NPS - Atendimento Premium (0800)'\t\tTHEN 'Serasa__Premium__0800 Premium'\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - Produto Autentica\u00e7\u00e3o - Desbloqueio' THEN 'Serasa__Digital__OCR'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cadastro Positivo'\t\t\t\t\t\tTHEN 'Serasa__Cadastro Positivo__Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'SAC'\t\t\t\t\t\t\t\t\t\tTHEN 'Serasa__SAC__SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'BackOffice'\t\t\t\t\t\t\t\tTHEN 'Serasa__BackOffice__BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'OCR'\t\t\t\t\t\t\t\t\t\tTHEN 'Serasa__Digital__OCR'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'OCR - IDWALL'\t\t\t\t\t\t\tTHEN 'Serasa__Digital__OCR'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda'\t\t\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cr\u00e9dito'\t\t\t\t\t\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'D\u00edvidas'\t\t\t\t\t\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Score'\t\t\t\t\t\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE '____' END\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.data_avaliacao < '01/01/2024' THEN\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Premium - 0800'\t\t\t\t\t\t\tTHEN 'Serasa__Premium__0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= '0800 Premium'\t\t\t\t\t\t\tTHEN 'Serasa__Premium__0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cadastro Positivo'\t\t\t\t\t\tTHEN 'Serasa__Cadastro Positivo__Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Sac'\t\t\t\t\t\t\t\t\t\tTHEN 'Serasa__SAC__SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Backoffice'\t\t\t\t\t\t\t\tTHEN 'Serasa__BackOffice__BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Autentica\u00e7\u00e3o'\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Produto'\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda'\t\t\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE '____' END\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.data_avaliacao < '01/06/2024' THEN\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Premium - 0800'\t\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= '0800 Premium'\t\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cadastro Positivo'\t\t\t\t\t\tTHEN 'Serasa__Voz__Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Sac'\t\t\t\t\t\t\t\t\t\tTHEN 'Serasa__Voz__SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Backoffice'\t\t\t\t\t\t\t\tTHEN 'Serasa__Voz__BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Autentica\u00e7\u00e3o'\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Produto'\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda'\t\t\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE '____' END\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Premium - 0800'\t\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= '0800 Premium'\t\t\t\t\t\t\tTHEN 'Serasa__Voz__0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Cadastro Positivo'\t\t\t\t\t\tTHEN 'Serasa__Voz__Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Sac'\t\t\t\t\t\t\t\t\t\tTHEN 'Serasa__Voz__SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Backoffice'\t\t\t\t\t\t\t\tTHEN 'Serasa__Voz__BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Autentica\u00e7\u00e3o'\t\t\tTHEN 'Serasa__Digital__Central de Ajuda - Autentica\u00e7\u00e3o'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Produto'\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda - Produtos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda'\t\t\t\t\t\tTHEN 'Serasa__Digital__Central de Ajuda - Produtos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Central de Ajuda - Chat Humano'\t\t\tTHEN 'Serasa__Digital__Chat'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Chat - Ath'      \t\t\t\t\t\tTHEN 'Serasa__Digital__Chat'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE '____' END\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[Login]\t\t\t\t\t\t\t\t=\tmop.[ID Serasa],\n\t\t[ID Selecionar]\t\t\t\t\t\t=\tmop.[ID Selecionar],\n\t\t[Campanha]\t\t\t\t\t\t\t=\tnps.campanha,\n\t\t[Motivos de Contato]\t\t\t\t=\tmotivo_contato,\n\t\t[Produto]\t\t\t\t\t\t\t=\tTRIM(nps.produto),\n\t\t[Nota]\t\t\t\t\t\t\t\t=\tnps.nota,\n\t\t[Classifica\u00e7\u00e3o]\t\t\t\t\t\t=\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.nota<7 THEN 'Detratores'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.nota>8 THEN 'Promotores'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Neutros'\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[Coment\u00e1rio]\t\t\t\t\t\t=\tnps.comentario,\n\t\t[DataHora de Resolu\u00e7\u00e3o do Ticket]\t=\ttkt.resolucao,\n\t\t[Status]\t\t\t\t\t\t\t=\tmop.status,\n\t\t[Status Vigente]\t\t\t\t\t=\tmop_v.Status,\n\t\t[Nome]\t\t\t\t\t\t\t\t=\tmop.nome,\n\t\t[Projeto]\t\t\t\t\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'NPS - Atendimento Premium (0800)'\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - 0800 Premium'\t\t\t\t\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.campanha\t= 'RV - 0800 Premium'\t\t\t\t\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'Premium - 0800'\t\t\t\t\t\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= '0800 Premium'\t\t\t\t\t\tTHEN 'Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'CADASTRO POSITIVO'\t\t\t\t\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo\t\t= 'SAC'\t\t\t\t\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Digital'\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[Tribo Selecionar]\t\t\t\t\t=\tmop.tribo,\n\t\t[Subtribo Selecionar]\t\t\t\t=\tmop.[Sub Tribo],\n\t\t[Escala]\t\t\t\t\t\t\t=\tmop.escala,\n\t\t[Supervis\u00e3o]\t\t\t\t\t\t=\tmop.Supervis\u00e3o,\n\t\t[Supervis\u00e3o Vigente]\t\t\t\t=\tmop_v.Supervis\u00e3o,\n\t\t[Coordena\u00e7\u00e3o]\t\t\t\t\t\t=\tmop.Coordena\u00e7\u00e3o,\n\t\t[tribo_2clix]\t\t\t\t\t\t=\tCASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = '0800 - Premium'       THEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'PREMIUM - 0800'       THEN '0800 Premium'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'OCR'\t\t\t\t\tTHEN 'OCR'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'OCR - IDWALL'\t\t\tTHEN 'OCR'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Cadastro Positivo'\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'CADASTRO POSITIVO'\tTHEN 'Cadastro Positivo'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'SAC'\t\t\t\t\tTHEN 'SAC'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'BACKOFFICE'\t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'BackOffice'\t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'BKO'       \t\t\tTHEN 'BackOffice'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'RA'\t\t\t\t\tTHEN 'Reclame Aqui'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Reclame Aqui'\t\t\tTHEN 'Reclame Aqui'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Central de Ajuda'\t\tTHEN 'Central De Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'CENTRAL DE AJUDA'\t\tTHEN 'Central De Ajuda'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Cr\u00e9dito'\t\t\t\tTHEN 'Cr\u00e9dito'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'D\u00edvidas'\t\t\t\tTHEN 'D\u00edvidas'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'D\u00cdVIDAS'\t\t\t\tTHEN 'D\u00edvidas'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Score'\t\t\t\tTHEN 'Score'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'SCORE'\t\t\t\tTHEN 'Score'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'GOV'\t\t\t\t\tTHEN 'GOV'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'Facebook e Lojas'\t\tTHEN 'Facebook'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN nps.tribo = 'FACEBOOK E LOJAS'\t\tTHEN 'Facebook'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Outros'\n\t\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[Tempo de Resposta]\t\t\t\t\t=\tDATEDIFF(DAY, tkt.resolucao, nps.data_avaliacao)\n\n\tFROM tb_nps as nps\n\tLEFT JOIN ( SELECT * FROM dim_calendario\t\t) as cal ON CAST(nps.data_avaliacao AS DATE) = cal.Data\n\tLEFT JOIN ( SELECT * FROM dim_teste_tickets_nps\t) as tkt ON nps.ID_ticket = tkt.[ID_ticket]\n\tLEFT JOIN ( SELECT * FROM f_mop_historico\t\t) as mop ON cal.Data = mop.[Data da Atualiza\u00e7\u00e3o] AND nps.ID_serasa = mop.[ID Serasa]\n\tLEFT JOIN ( SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente) as mop_v ON  nps.ID_serasa = mop_v.[ID Serasa] AND n = 1\n\tWHERE cal.Data IS NOT NULL\n),\n\nqtd_avaliacoes AS\n(\n\tSELECT *,\n\t\t[AvaliacoesXAgentesXtriboXDia] =    COUNT(*) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [Data da Opini\u00e3o]),\n\t\t[AvaliacoesXAgentesXtriboXSemana] = COUNT(*) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o]),\n\t\t[AvaliacoesXAgentesXtriboXMes] =    COUNT(*) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])\n\tFROM nps_base\n),\n\nnps_calculado AS\n(\n\tSELECT *,\n\t\t[Grupo Tempo de Resposta]\t\t=\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] < 0\tTHEN 'Neg'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] <= 1\tTHEN 'At\u00e9 24h'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] <= 2\tTHEN 'At\u00e9 48h'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] <=\t15\tTHEN 'At\u00e9 15 Dias'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] <=\t30\tTHEN 'At\u00e9 30 Dias'\n\t\t\t\t\t\t\t\t\t\t\t\tWHEN [Tempo de Resposta] >\t30\tTHEN 'Acima de 30 Dias'\n\t\t\t\t\t\t\t\t\t\t\t\tELSE NULL\n\t\t\t\t\t\t\t\t\t\t\tEND,\n\t\t[NPSxAgentexTriboSerasaxDia]\t= CAST(( SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Promotores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [Data da Opini\u00e3o])\n\t\t\t\t\t\t\t\t\t\t\t\t-SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Detratores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto], [Tribo Serasa Padronizada], [Data da Opini\u00e3o]))\n\t\t\t\t\t\t\t\t\t\t\t\t/CAST([AvaliacoesXAgentesXtriboXDia] AS FLOAT)*100 AS INT),\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t[NPSxAgentexTriboSerasaxSemana]\t= CAST(( SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Promotores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])\n\t\t\t\t\t\t\t\t\t\t\t\t-SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Detratores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o]))\n\t\t\t\t\t\t\t\t\t\t\t\t/CAST([AvaliacoesXAgentesXtriboXSemana] AS FLOAT)*100 AS INT),\n\n\t\t[NPSxAgentexTriboSerasaxM\u00eas]\t= CAST(( SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Promotores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])\n\t\t\t\t\t\t\t\t\t\t\t\t-SUM(CASE WHEN [Classifica\u00e7\u00e3o] = 'Detratores' THEN 1 ELSE 0 END) OVER (PARTITION BY [Login], [Projeto],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o]))\n\t\t\t\t\t\t\t\t\t\t\t\t/CAST([AvaliacoesXAgentesXtriboXMes] AS FLOAT)*100 AS INT)\nFROM qtd_avaliacoes\n),\nquartil_simples AS\n(\n\tSELECT *,\n\t\t[rank_nps_Dia] =          CASE WHEN [AvaliacoesXAgentesXtriboXDia]<=0 THEN -1 ELSE RANK() OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada],[Data da Opini\u00e3o]\t\t\t\t\t\t\tORDER BY [NPSxAgentexTriboSerasaxDia] DESC,[AvaliacoesXAgentesXtriboXDia] DESC)END,\n\t\t[rank_nps_Semana] =       CASE WHEN [AvaliacoesXAgentesXtriboXSemana]<=5 THEN -1 ELSE RANK() OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o]  ORDER BY [NPSxAgentexTriboSerasaxSemana] DESC,[AvaliacoesXAgentesXtriboXSemana] DESC)END,\n\t\t[rank_nps_Mes] =          CASE WHEN [AvaliacoesXAgentesXtriboXMes]<=5 THEN -1 ELSE RANK() OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o]\t\t\t\t\t\t\tORDER BY [NPSxAgentexTriboSerasaxM\u00eas] DESC,[AvaliacoesXAgentesXtriboXMes] DESC)END\n\n\n\tFROM nps_calculado\n),\nfaixas AS\n(\n\tSELECT *,\n\t\t[QuartilxAgentexTriboSerasaxDia] =\tCASE WHEN (COUNT([ID da Opini\u00e3o]) OVER (PARTITION BY [Login],  [Tribo Serasa Padronizada], [Data da Opini\u00e3o])) <= 0 THEN 'Q N\u00c3O AVALIADO' ELSE CASE \n\t\t\t\tWHEN [Projeto] = 'Digital'\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 75 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 70 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 64 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END    \n\t\t\t\tWHEN [Projeto] = 'Sac'\t\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 70 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 65 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 58 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Cadastro Positivo' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 67 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 60 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 50 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Premium' THEN  CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 84 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 78 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxDia] >= 73 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END END END,\n\t\t[QuartilxAgentexTriboSerasaxSemana] =\t\tCASE WHEN (COUNT([ID da Opini\u00e3o]) OVER (PARTITION BY [Login],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])) <= 5 THEN 'Q N\u00c3O AVALIADO' ELSE CASE\n\t\t\t\tWHEN [Projeto] = 'Digital'\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 75 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 70 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 64 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END    \n\t\t\t\tWHEN [Projeto] = 'Sac'\t\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 70 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 65 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 58 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Cadastro Positivo' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 67 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 60 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 50 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Premium' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 84 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 78 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxSemana] >= 73 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END END END,\n\t\t[QuartilxAgentexTriboSerasaxM\u00eas] =\t\tCASE WHEN (COUNT([ID da Opini\u00e3o]) OVER (PARTITION BY [Login],  [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])) <= 5 THEN 'Q N\u00c3O AVALIADO' ELSE CASE\n\t\t\t\tWHEN [Projeto] = 'Digital'\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 75 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 70 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 64 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END    \n\t\t\t\tWHEN [Projeto] = 'Sac'\t\tTHEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 70 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 65 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 58 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Cadastro Positivo' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 67 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 60 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 50 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END\n\t\t\t\tWHEN [Projeto] = 'Premium' THEN CASE \n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 84 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 78 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [NPSxAgentexTriboSerasaxM\u00eas] >= 73 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Q4' END END END,\n\t\t[quartil_simplesXDia] =                CASE WHEN [rank_nps_Dia] = -1 THEN 'Q N\u00c3O AVALIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [rank_nps_Dia]<= MAX([rank_nps_Dia]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada],[Data da Opini\u00e3o])/4*1 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t\t\t\t    WHEN [rank_nps_Dia]<= MAX([rank_nps_Dia]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada],[Data da Opini\u00e3o])/4*2 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t\t\t\t    WHEN [rank_nps_Dia]<= MAX([rank_nps_Dia]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada],[Data da Opini\u00e3o])/4*3 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t\t\t\t    ELSE 'Q4' END,\n\t\t[quartil_simplesXSemana] =             CASE WHEN [rank_nps_Semana] = -1 THEN 'Q N\u00c3O AVALIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [rank_nps_Semana]<= MAX([rank_nps_Semana]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])/4*1 THEN 'Q1'\n\t\t\t\t\t\t\t\t\t                WHEN [rank_nps_Semana]<= MAX([rank_nps_Semana]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])/4*2 THEN 'Q2'\n\t\t\t\t\t\t\t\t\t                WHEN [rank_nps_Semana]<= MAX([rank_nps_Semana]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o], [Semana da Opini\u00e3o])/4*3 THEN 'Q3'\n\t\t\t\t\t\t\t\t\t                ELSE 'Q4' END,\n\t\t[quartil_simplesXMes] =                CASE WHEN [rank_nps_Mes] = -1 THEN 'Q N\u00c3O AVALIADO'\n\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN [rank_nps_Mes]<= MAX([rank_nps_Mes]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])/4*1 THEN 'Q1'\n\t\t\t\t\t\t\t\t                    WHEN [rank_nps_Mes]<= MAX([rank_nps_Mes]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])/4*2 THEN 'Q2'\n\t\t\t\t\t\t\t\t                    WHEN [rank_nps_Mes]<= MAX([rank_nps_Mes]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])/4*3 THEN 'Q3'\n\t\t\t\t\t\t\t\t                    --WHEN [rank_nps_Mes]<= MAX([rank_nps_Mes]) OVER (PARTITION BY [Projeto], [Tribo Serasa Padronizada], [M\u00eas da Opini\u00e3o])/4*4 THEN 'Q4'\n\t\t\t\t\t\t\t\t                    ELSE 'Q4' END\n\t\t\n\n\t\t\n\tFROM quartil_simples\n)\nSELECT * INTO f_nps_V2 FROM faixas\n\n\n\nEXEC sp_sys_perms\n\n\n\nGO\n",
        "build_order": 338,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT * FROM f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT * FROM f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT n = ROW_NUMBER() OVER (PARTITION BY [ID Serasa] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC), * FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT * FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[tb_nps]": [
                "UNKNOWN",
                "tb_nps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_nps]": [
                "SELECT",
                "SELECT * FROM dim_teste_tickets_nps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": [
                "SELECT",
                "SELECT * INTO f_nps_V2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_nps]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "EXEC",
                "EXEC sp_sys_perms"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_nps]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[SP_NPS_LUCAS]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[SP_NPS_LUCAS]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "SP_NPS_LUCAS",
        "type": "StoredProcedure",
        "start": 820497,
        "end": 821252,
        "code": "/****** Object:  StoredProcedure [dbo].[SP_NPS_LUCAS]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[SP_NPS_LUCAS] \n\t @nome varchar(50) = NULL\n\t,@id_selecionar varchar(50) = NULL\nAS \n\t\n\n\nSELECT \n\t [nome]\n\t,[id selecionar]\n\t,[nota_media] = AVG(nota)\n\t,[promotores] = SUM( iif(classifica\u00e7\u00e3o = 'Promotores',1,0))\n\t,[detratores] = SUM( IIF(classifica\u00e7\u00e3o = 'Detratores',1,0))\n\t,[avalia\u00e7\u00f5es] = COUNT(*) \n\t,[NPS] = CAST(CAST(SUM( iif(classifica\u00e7\u00e3o = 'Promotores',1,0)) - SUM( IIF(classifica\u00e7\u00e3o = 'Detratores',1,0)) AS DECIMAL) / CAST(COUNT(*)AS DECIMAL) * 100 AS INT)\n--select *\nfrom f_nps_v2\nWHERE NOME LIKE @nome\nOR [id selecionar] like @id_selecionar\nGROUP BY nome, [id selecionar]\n\n\nGO\n",
        "build_order": 339,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": [
                "UNKNOWN",
                "f_nps_v2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[SP_NPS_LUCAS]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[SP_NPS_LUCAS]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[SP_NPS_LUCAS]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[SP_NPS_LUCAS]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_prognostico",
        "type": "StoredProcedure",
        "start": 821252,
        "end": 822182,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_prognostico]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE     PROCEDURE [dbo].[sp_prognostico]\nAS\n\n\nset dateformat dmy;\n\n\n--SELECT * INTO teste_prog FROM #temp0\n--SELECT * FROm teste_prog ORDER BY [TIPO PEDIDO]\n\nDELETE FROM dim_prognostico\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_prognostico.[id_movimento] = #temp0.[ID MOVIMENTO]\n\n)\n\n\nINSERT INTO dim_prognostico\nSELECT \n\tCAST([ID MOVIMENTO] AS INT),\n\t[TIPO PEDIDO],\n\t[STATUS],\n\t[OPERACAO ORIGEM],\n\t[OPERACAO DESTINO],\n\tCAST([ADMISS\u00c3O] AS DATE),\n\tCAST([IN\u00cdCIO TREIN. REAL] AS DATE),\n\tCAST([FIM TREIN. REAL] AS DATE),\n\tCAST([DATA PA REAL] AS DATE),\n\tCAST(ISNULL([HCS PEDIDO], 0) AS INT),\n\tCAST(ISNULL([HCS ENTREGUE P/ TREINAMENTO], 0) AS INT),\n\tCAST(ISNULL([HCS ENTREGUE P/ OPERA\u00c7\u00c3O], 0) AS INT)\nFROM #temp0\nWHERE [ID MOVIMENTO] IS NOT NULL AND [ID MOVIMENTO] <> '0'\n\n\n\nGO\n",
        "build_order": 340,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]": [
                "INSERT",
                "INSERT INTO dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_prognostico]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_prognostico]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_excecoes]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_excecoes]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_prognostico_excecoes",
        "type": "StoredProcedure",
        "start": 822182,
        "end": 822769,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_prognostico_excecoes]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE    PROCEDURE [dbo].[sp_prognostico_excecoes]\nAS\n\n\nset dateformat dmy;\n\nDELETE FROM dim_prognostico_excecoes\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_prognostico_excecoes.[id_selecionar] = #temp0.[ID SELECIONAR]\n)\n\nINSERT INTO dim_prognostico_excecoes\nSELECT \n\t[ID SELECIONAR],\n\t[INICIO EVENTO],\n\t[FIM EVENTO],\n\t[OPERACAO],\n\tISNULL([QTD HCS],0),\n\t[OBSERVA\u00c7\u00c3O]\n\n\tFROM #temp0\n\n\tWHERE [ID SELECIONAR] IS NOT NULL\n\n\nGO\n",
        "build_order": 341,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_excecoes]": [
                "INSERT",
                "INSERT INTO dim_prognostico_excecoes"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_excecoes]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[sp_prognostico_excecoes]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_excecoes]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[sp_prognostico_excecoes]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_ferias]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_ferias]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_prognostico_ferias",
        "type": "StoredProcedure",
        "start": 822769,
        "end": 823396,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_prognostico_ferias]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE     PROCEDURE [dbo].[sp_prognostico_ferias]\nAS\n\n\nset dateformat dmy;\n\nDELETE FROM dim_prognostico_ferias\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_prognostico_ferias.[id_selecionar_saida] = #temp0.[ID SELECIONAR SAIDA]\n)\n\nINSERT INTO dim_prognostico_ferias\nSELECT \n\t[ID SELECIONAR SAIDA],\n\t[OPERACAO SAIDA],\n\t[DATA SAIDA],\n\t[DATA RETORNO],\n\t[QTD HCS]\nFROM #temp0\nWHERE [DATA SAIDA] IS NOT NULL\nAND [DATA RETORNO] IS NOT NULL\nAND [QTD HCS] IS NOT NULL\n\n\n\n\nGO\n",
        "build_order": 342,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_ferias]": [
                "INSERT",
                "INSERT INTO dim_prognostico_ferias"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_ferias]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_prognostico_ferias]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_ferias]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_prognostico_ferias]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_grupo]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_grupo]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_prognostico_grupo",
        "type": "StoredProcedure",
        "start": 823396,
        "end": 823900,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_prognostico_grupo]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE     PROCEDURE [dbo].[sp_prognostico_grupo]\nAS\n\n\nset dateformat dmy;\n\nDELETE FROM dim_prognostico_grupo\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_prognostico_grupo.[ID SELECIONAR SAIDA] = #temp0.[ID SELECIONAR SAIDA]\n)\n\nINSERT INTO dim_prognostico_grupo\nSELECT \n\t[ID SELECIONAR SAIDA],\n\t[GRUPO],\n\t[IN\u00cdCIO],\n\t[FIM]\n\nFROM #temp0\n\n\n\n\nGO\n",
        "build_order": 343,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_grupo]": [
                "INSERT",
                "INSERT INTO dim_prognostico_grupo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_grupo]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_prognostico_grupo]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_grupo]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_prognostico_grupo]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_to]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_to]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_prognostico_to",
        "type": "StoredProcedure",
        "start": 823900,
        "end": 824393,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_prognostico_to]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE     PROCEDURE [dbo].[sp_prognostico_to]\nAS\n\n\nset dateformat dmy;\n\nDELETE FROM dim_prognostico_to\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_prognostico_to.[id_selecionar] = #temp0.[ID SELECIONAR]\n)\n\nINSERT INTO dim_prognostico_ferias\nSELECT \n\t[ID SELECIONAR SAIDA],\n\t[INICIO EVENTO],\n\t[OPERACAO],\n\t[QTD HCS]\n\n\tFROM #temp0\n\n\n\n\nGO\n",
        "build_order": 344,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico_ferias]": [
                "INSERT",
                "INSERT INTO dim_prognostico_ferias"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_to]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_prognostico_to]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_prognostico_to]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_prognostico_to]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_rotina",
        "type": "StoredProcedure",
        "start": 824393,
        "end": 831134,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_rotina]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE     PROCEDURE [dbo].[sp_rotina] \nWITH EXECUTE AS OWNER\nAS \n\n\t---------------------------------------- Iniciar extrator da Zendesk\n\t--\t[ ] Pra cada uma das contas Experian:\n\t--\t\t[ ] Abrir VDI\n\t--\t\t[ ] Rodar starter.bat\n\t--\t\t[ ] Enviar \"allow pasting\" ou \"permitir colagem\" no console do Chrome do dashboard da Zendesk (Consumer Care 1.1)\n\t--\t\t[ ] Colar conte\u00fado do crawler.js no console do Chrome do dashboard da Zendesk (Consumer Care 1.1)\n\t--\t\t[ ] Aguardar a conclus\u00e3o de dois downloads e clicar em \"Permitir\" no popup de \"Permitir Multiplos Downloads\"\n\t--\t\t[ ] Verificar se o sender.bat enviou os dois downloads sem nenhuma mensagem de erro\n\t--\t\n\t--\t\t *\tSe o processo n\u00e3o concluir antes das 8h, sinalizar qual foi o \u00faltimo arquivo conclu\u00eddo\n\t--\t\t *\tSe algum erro acontecer, me sinalizar\n\t--\n\t--\t[ ] Nas tribos Reclame Aqui e Consumidor.GOV (separadamente):\n\t--\t\t[ ] Fazer a extra\u00e7\u00e3o detalhada da \u00faltima coluna do gr\u00e1fico 'R\u00e9plicas - RA e GOV (m\u00eas)'\n\t--\t\t\t -  Colunas: [ID do ticket], [Cria\u00e7\u00e3o do ticket - Data], [Resolu\u00e7\u00e3o do ticket - Data], [(New) \u00c1rvore Motivos V2.0], [Login dos Agentes], [Formul\u00e1rio de ticket]\n\t--\t\t[ ] Ap\u00f3s conlus\u00e3o do download, copiar o seguinte texto para que o sender identifique o arquivo: \n\t--\t\t\t -  @*@ - REP_GOV_0\n\t--\t\t\t -  @*@ - REP_RA_0\n\n\n\t--GO \n\t---------------------------------------- Validar se os dados que atualizam de madrugada subiram corretamente\n\t--SELECT TOP(3) 'INTELIX', 'LOG',[inicio] FROM [db_Serasa_producao].[dbo].[dim_log_intelix] ORDER BY inicio DESC\t\t\t--> Precisa ter dados do final do \u00faltimo dia \u00fatil do Digital\n\t--SELECT TOP(3) 'INTELIX', 'CHA',[datahora] FROM [db_Serasa_producao].[dbo].[dim_chamadas_intelix] ORDER BY datahora DESC\t--> Precisa ter dados do final do \u00faltimo dia \u00fatil do Digital\n\t--SELECT TOP(3) 'GENESYS', 'LOG',[inicio] FROM [db_Serasa_producao].[dbo].[dim_log_genesys] ORDER BY inicio DESC\t\t\t--> Precisa ter dados do final do \u00faltimo dia \u00fatil do Voz\n\t--SELECT TOP(3) 'GENESYS', 'CHA',[inicio] FROM [db_Serasa_producao].[dbo].[dim_chamadas_genesys] ORDER BY inicio DESC\t\t--> Precisa ter dados do final do \u00faltimo dia \u00fatil do Voz\n\n\n\n\t--GO\n\t---------------------------------------- Revogar permiss\u00e3o de atualiza\u00e7\u00e3o do MOP pro Planejamento\n\t--USE [db_Serasa_producao];\n\tREVOKE EXECUTE ON sp_sys_chk_mop TO [planejamento]\n\n\n\n\t--GO \n\t---------------------------------------- Remover linhas duplicadas do MOP\n\tDELETE t0 FROM [db_Serasa_Producao].[dbo].[dim_mop_eventos] t0\n\tWHERE EXISTS (\n\t\tSELECT * FROM (\n\t\t\tSELECT  \n\t\t\t\t [data_atualizacao]\n\t\t\t\t,[ID_selecionar]\n\t\t\t\t,[Duplicado] =\tCASE\n\t\t\t\t\t\t\t\t\tWHEN \n\t\t\t\t\t\t\t\t\t\tLEAD(CONCAT([ID_unico], [ID_secullum], [ID_serasa], [ID_intelix], [ID_epbx], [ID_genesys], [status], [situacao], [condicao], [cliente], [projeto], [cargo], [tribo], [subtribo], [escala], [jornada], [taxa], [pausa_manha], [pausa_almoco], [pausa_tarde], [supervisao], [coordenacao], [gerencia], [diretoria], [req], [dma], [instrutor], [tipo_dma])) OVER (PARTITION BY [ID_selecionar] ORDER BY [data_atualizacao] DESC)\n\t\t\t\t\t\t\t\t\t\t=\t CONCAT([ID_unico], [ID_secullum], [ID_serasa], [ID_intelix], [ID_epbx], [ID_genesys], [status], [situacao], [condicao], [cliente], [projeto], [cargo], [tribo], [subtribo], [escala], [jornada], [taxa], [pausa_manha], [pausa_almoco], [pausa_tarde], [supervisao], [coordenacao], [gerencia], [diretoria], [req], [dma], [instrutor], [tipo_dma]) \n\t\t\t\t\t\t\t\t\tTHEN 1\n\t\t\t\t\t\t\t\t\tELSE 0\n\t\t\t\t\t\t\t\tEND\n\t\t\tFROM [db_Serasa_Producao].[dbo].[dim_mop_eventos]\n\t\t) t1 \n\t\tWHERE [Duplicado] = 1\n\t\tAND t0.[ID_selecionar] = t1.[ID_selecionar]\n\t\tAND t0.[data_atualizacao] = t1.[data_atualizacao]\n\t)\n\n\n\n\t--GO \n\t---------------------------------------- Cortar historico de altera\u00e7\u00f5es do MOP\n\tDECLARE @limite INT = (SELECT COUNT(*) FROM dim_mop_eventos)*10\n\tDECLARE @atual INT = (SELECT COUNT(*) FROM hist_dim_mop_eventos)\n\tDECLARE @transbordo INT = IIF( @atual > @limite, @atual - @limite,0)\n\tDECLARE @transbordo_data DATETIME = (SELECT MAX(alteracao_datahora) FROM (SELECT TOP(@transbordo) alteracao_datahora FROM hist_dim_mop_eventos ORDER BY alteracao_datahora ASC)_)\n\tPRINT CONCAT('limite: ',@limite,' | atual: ',@atual,' | transbordo: ',@transbordo,' | data de corte do transbordo: ',@transbordo_data)\n\tIF @transbordo > 0 BEGIN\n\t\tDELETE FROM hist_dim_mop_eventos WHERE alteracao_datahora <= @transbordo_data\n\tEND\n\n\n\n\t--GO \n\t---------------------------------------- Rodar atualiza\u00e7\u00e3o do MOP e das bases de conceito (f's)\n\tREVOKE EXECUTE ON sp_sys_chk_mop TO [planejamento]\n\tDECLARE @inicio DATE = (SELECT DATEADD(DAY, -90, GETDATE()))\n\tEXECUTE [db_Serasa_producao].[dbo].[sp_sys_chk_mop] @data_limite=@inicio, @registrar=1\n\tREVOKE EXECUTE ON sp_sys_chk_mop TO [planejamento]\n\tEXECUTE [db_Serasa_producao].[dbo].[sp_att_log]\n\tEXECUTE [db_Serasa_producao].[dbo].[sp_att_chamadas]\n\n\n\n\t--GO \n\t----------------------------------------  Limpar dados da [db_prod_d0]\n\tDELETE FROM [db_prod_d0].[dbo].[d_genesys_eventos]\n\tDELETE FROM [db_prod_d0].[dbo].[d_intelix_eventos]\n\tDELETE FROM [db_prod_d0].[dbo].[f_log]\n\tDELETE FROM [db_prod_d0].[dbo].[r_individuo_30min]\n\tDELETE FROM [db_prod_d0].[dbo].[r_individuo_dia]\n\tDELETE FROM [db_prod_d0].[dbo].[r_tribo_30min]\n\tDELETE FROM [db_prod_d0].[dbo].[r_tribo_dia]\n\n\n\n\t--GO \n\t---------------------------------------- Liberar espa\u00e7o de disco\n\tEXECUTE [db_Serasa_producao].[dbo].[sp_sys_faxina]\n\tEXECUTE [db_prod_d-1].[dbo].[sp_sys_faxina]\n\tEXECUTE [db_prod_d0].[dbo].[sp_sys_faxina]\n\tEXECUTE [db_app].[dbo].[sp_sys_faxina]\n\n\n\n\t--GO\n\t---------------------------------------- Atualizar bases da Zendesk \n\t-- ** Aguardar conclus\u00e3o das extra\u00e7\u00f5es da Zendesk\n\tEXECUTE [db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]\n\n\n\n\t--GO\n\t---------------------------------------- Rodar atualiza\u00e7\u00e3o dos relat\u00f3rios/resumos\n\tEXECUTE [db_prod_d-1].[dbo].[s_att_resumos] @datahora_inicio = '01/08/2024 00:00:00', @datahora_fim = '01/09/2024 00:00:00'\t\t\t\t--> Banco novo\n\tEXECUTE [db_Serasa_producao].[dbo].[sp_att_resumos] @datahora_inicio = '01/08/2024', @datahora_fim = '01/09/2024' , @metrica='todas'\t--> Banco legado\n\tEXECUTE [db_Serasa_producao].[dbo].[sp_att_cemiterio]\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--> Bases em processo de deprecia\u00e7\u00e3o\n\n\n\n\t--GO\n\t---------------------------------------- Liberar espa\u00e7o de disco\n\tEXECUTE [db_Serasa_producao].[dbo].[sp_sys_faxina]\n\tEXECUTE [db_prod_d-1].[dbo].[sp_sys_faxina]\n\tEXECUTE [db_prod_d0].[dbo].[sp_sys_faxina]\n\tEXECUTE [db_app].[dbo].[sp_sys_faxina]\n\n\n\n\t--GO \n\t---------------------------------------- Resetar permiss\u00f5es\n\t--USE [db_Serasa_producao]\n\tGRANT EXECUTE ON sp_sys_chk_mop TO [planejamento]\n\tEXECUTE [db_Serasa_producao].[dbo].[sp_sys_perms]\n\n\n\nGO\n",
        "build_order": 345,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "EXEC",
                "EXECUTE [db_app].[dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_30min]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_tribo_30min]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_tribo_dia]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_tribo_dia]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_genesys_eventos]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[d_intelix_eventos]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[s_att_resumos]": [
                "EXEC",
                "EXECUTE [db_prod_d-1].[dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": [
                "EXEC",
                "EXECUTE [db_app].[dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_genesys_eventos]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[d_genesys_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[d_intelix_eventos]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[d_intelix_eventos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[f_log]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_30min]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_tribo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_tribo_dia]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[r_tribo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[s_att_resumos]": [
                "EXEC",
                "EXECUTE [db_prod_d-1].[dbo].[s_att_resumos]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": [
                "EXEC",
                "EXECUTE [db_app].[dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": [
                "SELECT",
                "SELECT COUNT(*) FROM dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "SELECT",
                "SELECT TOP(3) 'INTELIX', 'CHA',[datahora] FROM [db_Serasa_producao].[dbo].[dim_chamadas_intelix]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "DELETE",
                "DELETE FROM [db_prod_d0].[dbo].[f_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys]": [
                "SELECT",
                "SELECT TOP(3) 'GENESYS', 'CHA',[inicio] FROM [db_Serasa_producao].[dbo].[dim_chamadas_genesys]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_genesys]": [
                "SELECT",
                "SELECT TOP(3) 'GENESYS', 'LOG',[inicio] FROM [db_Serasa_producao].[dbo].[dim_log_genesys]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_intelix]": [
                "SELECT",
                "SELECT TOP(3) 'INTELIX', 'LOG',[inicio] FROM [db_Serasa_producao].[dbo].[dim_log_intelix]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_eventos]": [
                "DELETE",
                "DELETE FROM hist_dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_cemiterio]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_chamadas]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_chamadas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_log]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_log]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_resumos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_att_tickets_zendesk]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_rotina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "EXEC",
                "EXECUTE ON sp_sys_chk_mop"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": [
                "EXEC",
                "EXECUTE [db_app].[dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_sys_perms]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_rotina]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_afastamentos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_afastamentos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_secullum_afastamentos",
        "type": "StoredProcedure",
        "start": 831134,
        "end": 831607,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_secullum_afastamentos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE         PROCEDURE [dbo].[sp_secullum_afastamentos] AS\n\nSET LANGUAGE 'Portugu\u00eas (Brasil)';\nSET DATEFORMAT ymd;\n\nDELETE FROM dim_secullum_afastamentos\nINSERT INTO dim_secullum_afastamentos \nSELECT\n\tCAST(DataInclusao AS DATE),\n\tId,\n\tCAST(Inicio AS DATE),\n\tCAST(Fim AS DATE),\n\tJustificativaNome\nFROM #temp0\n\nGO\n",
        "build_order": 346,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_afastamentos]": [
                "INSERT",
                "INSERT INTO dim_secullum_afastamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_afastamentos]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_secullum_afastamentos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_afastamentos]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_secullum_afastamentos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_batidas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_batidas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_secullum_batidas",
        "type": "StoredProcedure",
        "start": 831607,
        "end": 834883,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_secullum_batidas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE         PROCEDURE [dbo].[sp_secullum_batidas] AS\n\nSET LANGUAGE 'Portugu\u00eas (Brasil)';\nSET DATEFORMAT ymd;\n\nWITH\nponto1 AS\n(\n\tSELECT \n\t\tID_batida\t\t= Id,\n\t\tID_funcionario\t= FuncionarioId,\n\t\tinicio\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Entrada1 as time)),0), CAST(Data as datetime)),\n\t\tfim\t\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Saida1 as time)),0), CAST(Data as datetime)),\n\t\tduracao\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, TRY_CAST(Entrada1 as time), TRY_CAST(Saida1 as time)),0), '00:00:00'),\n\t\tobs\t\t\t\t= CASE WHEN TRY_CAST(Entrada1 as time) IS NULL THEN Entrada1 ELSE null END\n\tFROM #temp0\n),\nponto2 AS\n(\n\tSELECT \n\t\tID_batida\t\t= Id,\n\t\tID_funcionario\t= FuncionarioId,\n\t\tinicio\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Entrada2 as time)),0), CAST(Data as datetime)),\n\t\tfim\t\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Saida2 as time)),0), CAST(Data as datetime)),\n\t\tduracao\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, TRY_CAST(Entrada2 as time), TRY_CAST(Saida2 as time)),0), '00:00:00'),\n\t\tobs\t\t\t\t= CASE WHEN TRY_CAST(Entrada2 as time) IS NULL THEN Entrada2 ELSE null END\n\tFROM #temp0\n),\nponto3 AS\n(\n\tSELECT \n\t\tID_batida\t\t= Id,\n\t\tID_funcionario\t= FuncionarioId,\n\t\tinicio\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Entrada3 as time)),0), CAST(Data as datetime)),\n\t\tfim\t\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Saida3 as time)),0), CAST(Data as datetime)),\n\t\tduracao\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, TRY_CAST(Entrada3 as time), TRY_CAST(Saida3 as time)),0), '00:00:00'),\n\t\tobs\t\t\t\t= CASE WHEN TRY_CAST(Entrada3 as time) IS NULL THEN Entrada3 ELSE null END\n\tFROM #temp0\n),\nponto4 AS\n(\n\tSELECT \n\t\tID_batida\t\t= Id,\n\t\tID_funcionario\t= FuncionarioId,\n\t\tinicio\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Entrada4 as time)),0), CAST(Data as datetime)),\n\t\tfim\t\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Saida4 as time)),0), CAST(Data as datetime)),\n\t\tduracao\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, TRY_CAST(Entrada4 as time), TRY_CAST(Saida4 as time)),0), '00:00:00'),\n\t\tobs\t\t\t\t= CASE WHEN TRY_CAST(Entrada4 as time) IS NULL THEN Entrada4 ELSE null END\n\tFROM #temp0\n),\nponto5 AS\n(\n\tSELECT \n\t\tID_batida\t\t= Id,\n\t\tID_funcionario\t= FuncionarioId,\n\t\tinicio\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Entrada5 as time)),0), CAST(Data as datetime)),\n\t\tfim\t\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, '00:00:00', TRY_CAST(Saida5 as time)),0), CAST(Data as datetime)),\n\t\tduracao\t\t\t= DATEADD(s, ISNULL(DATEDIFF(s, TRY_CAST(Entrada5 as time), TRY_CAST(Saida5 as time)),0), '00:00:00'),\n\t\tobs\t\t\t\t= CASE WHEN TRY_CAST(Entrada5 as time) IS NULL THEN Entrada5 ELSE null END\n\tFROM #temp0\n),\ngrude AS\n(\t\n\tSELECT * FROM (\n\t\tSELECT * FROM ponto1 UNION ALL\n\t\tSELECT * FROM ponto2 UNION ALL\n\t\tSELECT * FROM ponto3 UNION ALL\n\t\tSELECT * FROM ponto4 UNION ALL\n\t\tSELECT * FROM ponto5 \n\t) as t WHERE inicio IS NOT NULL OR obs IS NOT NULL\n)\nSELECT * INTO #input FROM grude\n\nDELETE FROM dim_secullum_batidas WHERE EXISTS (SELECT 1 FROM #input WHERE dim_secullum_batidas.ID_batida = #input.ID_batida)\nINSERT INTO dim_secullum_batidas SELECT * FROM #input\n\n\n\nGO\n",
        "build_order": 347,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": [
                "INSERT",
                "INSERT INTO dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_batidas]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_secullum_batidas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_batidas]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_secullum_batidas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_funcionarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_funcionarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_secullum_funcionarios",
        "type": "StoredProcedure",
        "start": 834883,
        "end": 835599,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_secullum_funcionarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE         PROCEDURE [dbo].[sp_secullum_funcionarios] AS\n\nSET LANGUAGE 'Portugu\u00eas (Brasil)';\nSET DATEFORMAT ymd;\n\nDELETE FROM dim_secullum_funcionarios\nINSERT INTO dim_secullum_funcionarios \nSELECT\n\tCAST([Id] AS INT),\n\t[NumeroFolha],\n\t[Nome],\n\t[Cpf],\n\tCAST([Nascimento] AS DATE),\n\t[Telefone],\n\t[Celular],\n\t[Email],\n\tCAST([Admissao] AS DATE),\n\tCAST([Demissao] AS DATE),\n\t[Empresa.Nome],\n\t[Empresa.Documento],\n\t[Departamento.Descricao],\n\t[Funcao.Descricao],\n\t[Estrutura.Descricao],\n\t[Horario.Descricao],\n\tTRY_CAST([HorarioId] AS INT)\nFROM #temp0\n\n\n\n\n\nGO\n",
        "build_order": 348,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "INSERT",
                "INSERT INTO dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_funcionarios]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_secullum_funcionarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_secullum_funcionarios]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_secullum_funcionarios]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_sys_chk_mop",
        "type": "StoredProcedure",
        "start": 835599,
        "end": 895806,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_chk_mop]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE   PROCEDURE [dbo].[sp_sys_chk_mop]   \n\t@data_limite DATE = '01/01/2023',\n\t@ordem NVARCHAR(4) = 'DESC',\n\t@ignorar NVARCHAR(MAX) = '',\n\t@registrar BIT = 0\n\tWITH EXECUTE AS OWNER AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\n\t----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\tIF 1=1 BEGIN -- Padroniza\u00e7\u00f5es\n\n\t\t;DISABLE TRIGGER trg_hist_mop_contatos ON dim_mop_contatos; \n\t\t\tUPDATE dim_mop_eventos SET ID_intelix = null WHERE ID_intelix = 0\n\t\t\tUPDATE dim_mop_eventos SET ID_epbx = null WHERE ID_epbx = 0\n\t\t\tUPDATE dim_mop_eventos SET ID_secullum = null WHERE ID_secullum = 0\n\t\t\tUPDATE dim_mop_cadastros SET nome_social = TRANSLATE(nome_social, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz') WHERE nome_social <> TRANSLATE(nome_social, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz');\t\n\t\t\tUPDATE dim_mop_cadastros SET nome_registro = TRANSLATE(nome_registro, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz') WHERE nome_registro <> TRANSLATE(nome_registro, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz');\t\n\t\t\tUPDATE dim_mop_cadastros SET nome_social = fx.PriMaiuscula(nome_social), nome_registro = UPPER(nome_registro)\n\t\t\tUPDATE dim_mop_eventos SET supervisao = TRANSLATE(supervisao, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz') WHERE supervisao <> TRANSLATE(supervisao, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz');\t\n\t\t\tUPDATE dim_mop_eventos SET coordenacao = TRANSLATE(coordenacao, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz') WHERE coordenacao <> TRANSLATE(coordenacao, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz');\t\n\t\t\tUPDATE dim_mop_eventos SET gerencia = TRANSLATE(gerencia, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz') WHERE gerencia <> TRANSLATE(gerencia, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz');\t\n\t\t\tUPDATE dim_mop_eventos SET diretoria = TRANSLATE(diretoria, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz') WHERE diretoria <> TRANSLATE(diretoria, N'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz');\t\n\t\t\tUPDATE dim_mop_eventos SET \n\t\t\t\tID_selecionar=UPPER(ID_selecionar), \n\t\t\t\tID_unico=UPPER(ID_unico), \n\t\t\t\tID_serasa=UPPER(ID_serasa), \n\t\t\t\tfonte_log=UPPER(fonte_log), \n\t\t\t\tstatus=fx.PriMaiuscula(status), \n\t\t\t\tsituacao=fx.PriMaiuscula(situacao), \n\t\t\t\tcondicao= CASE WHEN UPPER(condicao)='INSS' THEN 'INSS' ELSE fx.PriMaiuscula(condicao) END, \n\t\t\t\tcliente=CASE UPPER(cliente) WHEN 'SELECIONAR - SP'\tTHEN 'Selecionar - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SERASA - SP'\t\tTHEN 'Serasa - SP'\n\t\t\t\t\t\t\t\t\t\t\tELSE fx.PriMaiuscula(cliente) END,\n\t\t\t\tprojeto=CASE UPPER(projeto) WHEN 'SAC'\t\t\t\tTHEN 'SAC' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'BODYSHOP'\t\t\tTHEN 'BodyShop' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'BACKOFFICE'\t\tTHEN 'BackOffice' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SELECIONAR - SP'\tTHEN 'Selecionar - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SERASA - SP'\t\tTHEN 'Serasa - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'GEST\u00c3O - SP'\t\tTHEN 'Gest\u00e3o - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'QUALIDADE - SP'\tTHEN 'Qualidade - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'B2B'\t\t\t\tTHEN 'B2B'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'N1'\t\t\t\tTHEN 'N1'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SAC - SP'\t\t\tTHEN 'SAC - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SDR'\t\t\t\tTHEN 'SDR'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'PME'\t\t\t\tTHEN 'PME'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'AGC'\t\t\t\tTHEN 'AGC'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'DHO'\t\t\t\tTHEN 'DHO' \n\t\t\t\t\t\t\t\t\t\t\tELSE fx.PriMaiuscula(projeto) END,\n\t\t\t\tcargo=fx.PriMaiuscula(cargo), \n\t\t\t\ttribo=CASE UPPER(tribo)\t\tWHEN 'SAC'\t\tTHEN 'SAC' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'BODYSHOP' THEN 'BodyShop' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'BACKOFFICE' THEN 'BackOffice' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'FACEBOOK E LOJAS' THEN 'Facebook e Lojas' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SUPORTE ECS' THEN 'Suporte ECS' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'RA E GOV' THEN 'RA e GOV' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'INFRAESTRUTURA E TECNOLOGIA' THEN 'Infraestrutura e Tecnologia' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'OCR' THEN 'OCR' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'DHO' THEN 'DHO' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'WHATSAPP PREMIUM' THEN 'WhatsApp Premium' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'YOU' THEN 'YOU' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'TECNOLOGIA DA INFORMA\u00c7\u00c3O' THEN 'Tecnologia da Informa\u00e7\u00e3o' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'WHATSAPP E SELE\u00c7\u00c3O' THEN 'Recrutamento e Sele\u00e7\u00e3o' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'CENTRAL DE AJUDA' THEN 'Central de Ajuda' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'CENTRAL DE AJUDA - AUTENTICA\u00c7\u00c3O'\t\t\tTHEN 'Central de Ajuda - Autentica\u00e7\u00e3o'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'CENTRAL DE AJUDA - PRODUTO'\t\t\t\tTHEN 'Central de Ajuda - Produtos'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'CENTRAL DE AJUDA - PRODUTOS'\t\t\t\tTHEN 'Central de Ajuda - Produtos'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'GOV' THEN 'GOV' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SELECIONAR - SP'\tTHEN 'Selecionar - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SERASA - SP'\t\tTHEN 'Serasa - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'GEST\u00c3O - SP'\t\tTHEN 'Gest\u00e3o - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'QUALIDADE - SP'\tTHEN 'Qualidade - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'B2B'\t\t\t\tTHEN 'B2B'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'N1'\t\t\t\tTHEN 'N1'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'LARGE N1'\t\t\tTHEN 'Large N1'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SAC - SP'\t\t\tTHEN 'SAC - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SDR'\t\t\t\tTHEN 'SDR'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'PME'\t\t\t\tTHEN 'PME'\n\t\t\t\t\t\t\t\t\t\t\tELSE fx.PriMaiuscula(tribo) END,\n\t\t\t\tsubtribo=CASE UPPER(subtribo)WHEN 'SAC'\t\tTHEN 'SAC' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'BODYSHOP' THEN 'BodyShop' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'BACKOFFICE' THEN 'BackOffice' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'FACEBOOK E LOJAS' THEN 'Facebook e Lojas' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SUPORTE ECS' THEN 'Suporte ECS' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'RA E GOV' THEN 'RA e GOV' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'INFRAESTRUTURA E TECNOLOGIA' THEN 'Infraestrutura e Tecnologia' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'OCR' THEN 'OCR' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'DHO' THEN 'DHO' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'WHATSAPP PREMIUM' THEN 'WhatsApp Premium' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'YOU' THEN 'YOU' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'TECNOLOGIA DA INFORMA\u00c7\u00c3O' THEN 'Tecnologia da Informa\u00e7\u00e3o' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'WHATSAPP E SELE\u00c7\u00c3O' THEN 'Recrutamento e Sele\u00e7\u00e3o' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'CENTRAL DE AJUDA' THEN 'Central de Ajuda' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'GOV' THEN 'GOV' \n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SELECIONAR - SP'\tTHEN 'Selecionar - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SERASA - SP'\t\tTHEN 'Serasa - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SERASA - SP'\t\tTHEN 'Serasa - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'GEST\u00c3O - SP'\t\tTHEN 'Gest\u00e3o - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'B2B'\t\t\t\tTHEN 'B2B'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'N1'\t\t\t\tTHEN 'N1'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'LARGE N1'\t\t\tTHEN 'Large N1'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SAC - SP'\t\t\tTHEN 'SAC - SP'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SDR'\t\t\t\tTHEN 'SDR'\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'PME'\t\t\t\tTHEN 'PME'\n\t\t\t\t\t\t\t\t\t\t\tELSE fx.PriMaiuscula(subtribo) END\n\t\t\tUPDATE dim_mop_eventos SET projeto = IIF(projeto = 'Geral', cliente, projeto)\n\t\t\tUPDATE dim_mop_eventos SET tribo = IIF(tribo = 'Geral', projeto, tribo)\n\t\t;ENABLE TRIGGER trg_hist_mop_contatos ON dim_mop_contatos; \n\n\tEND\n\t---------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\tIF 1=1 BEGIN -- Atualizar MOPs\n\n\t\tIF 1=1 BEGIN -- SELECT * FROM f_mop_eventos ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC\n\t\t\tPRINT '### [f_mop_eventos]';\n\t\t\tDROP TABLE IF EXISTS f_mop_eventos; \n\t\t\tWITH colunas AS\n\t\t\t(\n\t\t\t\tSELECT \n\t\t\t\t\t\t[Data da Atualiza\u00e7\u00e3o]\t\t\t\t\t\t=\tCAST(t0.[data_atualizacao] AS datetime2(0))\n\t\t\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t=\tt0.[ID_selecionar]\n\t\t\t\t\t,[ID \u00danico]\t\t\t\t\t\t\t\t\t=\tt0.[ID_unico]\n\t\t\t\t\t,[ID Secullum]\t\t\t\t\t\t\t\t=\tt0.[ID_secullum]\n\t\t\t\t\t,[ID Serasa]\t\t\t\t\t\t\t\t=\tt0.[ID_serasa]\n\t\t\t\t\t,[ID Intelix]\t\t\t\t\t\t\t\t=\tt0.[ID_intelix]\n\t\t\t\t\t,[ID EPBX]\t\t\t\t\t\t\t\t\t=\tt0.[ID_epbx]\n\t\t\t\t\t,[ID Genesys]\t\t\t\t\t\t\t\t=\tt0.[ID_genesys]\n\t\t\t\t\t,[Nome]\t\t\t\t\t\t\t\t\t\t=\tt1.[nome_social]\n\t\t\t\t\t,[Status]\t\t\t\t\t\t\t\t\t=\tt0.[status]\n\t\t\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t=\tt0.[situacao]\n\t\t\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t=\tt0.[condicao]\n\t\t\t\t\t,[Cliente]\t\t\t\t\t\t\t\t\t=\tt0.[cliente]\n\t\t\t\t\t,[Projeto]\t\t\t\t\t\t\t\t\t=\tt0.[projeto]\n\t\t\t\t\t,[Cargo]\t\t\t\t\t\t\t\t\t=\tt0.[cargo]\n\t\t\t\t\t,[Tribo]\t\t\t\t\t\t\t\t\t=\tt0.[tribo]\n\t\t\t\t\t,[Sub Tribo]\t\t\t\t\t\t\t\t=\tt0.[subtribo]\n\t\t\t\t\t,[Escala]\t\t\t\t\t\t\t\t\t=\tt0.[escala]\n\t\t\t\t\t,[Jornada]\t\t\t\t\t\t\t\t\t=\tt0.[jornada]\n\t\t\t\t\t,[Taxa]\t\t\t\t\t\t\t\t\t\t=\tt0.[taxa]\n\t\t\t\t\t,[Pausa Manh\u00e3]\t\t\t\t\t\t\t\t=\tt0.[pausa_manha]\n\t\t\t\t\t,[Pausa Almo\u00e7o]\t\t\t\t\t\t\t\t=\tt0.[pausa_almoco]\n\t\t\t\t\t,[Pausa Tarde]\t\t\t\t\t\t\t\t=\tt0.[pausa_tarde]\n\t\t\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t\t\t=\tt0.[supervisao]\n\t\t\t\t\t,[Coordena\u00e7\u00e3o]\t\t\t\t\t\t\t\t=\tt0.[coordenacao]\n\t\t\t\t\t,[Ger\u00eancia]\t\t\t\t\t\t\t\t\t=\tt0.[gerencia]\n\t\t\t\t\t,[Diretoria]\t\t\t\t\t\t\t\t=\tt0.[diretoria]\n\t\t\t\t\t,[Email Selecionar]\t\t\t\t\t\t\t=\tt2.[email_selecionar]\n\t\t\t\t\t,[Email Serasa]\t\t\t\t\t\t\t\t=\tt2.[email_experian]\n\t\t\t\t\t,[Telefone]\t\t\t\t\t\t\t\t\t=\tt2.[telefone]\n\t\t\t\t\t,[CPF]\t\t\t\t\t\t\t\t\t\t=\tt1.[cpf]\n\t\t\t\t\t,[Data de Nascimento]\t\t\t\t\t\t=\tt1.[data_nascimento]\n\t\t\t\t\t,[Nome de Registro]\t\t\t\t\t\t\t=\tt1.[nome_registro]\n\t\t\t\t\t,[Sexo Biol\u00f3gico]\t\t\t\t\t\t\t=\tt1.[sexo_biologico]\n\t\t\t\t\t,[REQ]\t\t\t\t\t\t\t\t\t\t=\tt0.[req]\n\t\t\t\t\t,[DMA]\t\t\t\t\t\t\t\t\t\t=\tt0.[dma]\n\t\t\t\t\t,[DMA Inicial]                              =   MAX(CASE WHEN t0.[tipo_dma] = 'CONTRATA\u00c7\u00c3O' THEN t0.[dma] ELSE NULL END) OVER (PARTITION BY t0.[ID_selecionar] ORDER BY CAST(t0.[data_atualizacao] AS datetime2(0)) ROWS UNBOUNDED PRECEDING)\n\t\t\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]                      =   MAX(CASE WHEN t0.[tipo_dma] = 'MIGRA\u00c7\u00c3O' THEN t0.[dma] ELSE NULL END) OVER (PARTITION BY t0.[ID_selecionar] ORDER BY CAST(t0.[data_atualizacao] AS datetime2(0)) ROWS UNBOUNDED PRECEDING)\n\t\t\t\t\t--,[\u00daltima DMA Geral]                         =   MAX(t0.[dma]) OVER (PARTITION BY t0.[ID_selecionar] ORDER BY CAST(t0.[data_atualizacao] AS datetime2(0)) ROWS UNBOUNDED PRECEDING)\n\t\t\t\t\t,[Tipo de DMA]\t\t\t\t\t\t\t\t=\tt0.[tipo_dma]\n\t\t\t\t\t,[Tipo da \u00daltima DMA]                       =   MAX(t0.[tipo_dma]) OVER (PARTITION BY t0.[ID_selecionar] ORDER BY CAST(t0.[data_atualizacao] AS datetime2(0)) ROWS UNBOUNDED PRECEDING)\n\t\t\t\t\t,[Instrutor]\t\t\t\t\t\t\t\t=\tt0.[instrutor]\n\n\t\t\t\t\t,[Data de Admiss\u00e3o]\t\t\t\t\t\t\t=\tCAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE)\n\t\t\t\t\t,[Data de In\u00edcio em Opera\u00e7\u00e3o]\t\t\t\t=\tMIN(CASE WHEN status <> 'Treinamento' AND status <> 'Turnover' THEN t0.[data_atualizacao] ELSE NULL END) OVER (PARTITION BY t0.id_selecionar)\n\t\t\t\t\t,[Tempo de Casa (Dias)]\t\t\t\t\t\t=   DATEDIFF(DAY, CAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE), t0.data_atualizacao)\n\t\t\t\t\t,[Faixa Tempo de Casa]\t\t\t\t\t\t=\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, CAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE),t0.[data_atualizacao]) <=30 THEN 'At\u00e9 30 Dias'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, CAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE),t0.[data_atualizacao]) <=90 THEN '1 a 3 Meses'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, CAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE),t0.[data_atualizacao]) <=180 THEN '3 a 6 Meses'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, CAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE),t0.[data_atualizacao]) <=365 THEN '6 a 12 Meses'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, CAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE),t0.[data_atualizacao]) <=712 THEN '1 a 2 Anos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Acima de 2 Anos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND\t\n\t\t\t\t\t,[Idade]                                     =\tFLOOR(DATEDIFF(DAY,t1.[data_nascimento],GETDATE())/365.25)\n\t\t\t\t\t,[Faixa de Idade] \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t=\tCASE\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[data_nascimento],GETDATE())/365.25) <= 20 THEN '18 a 20 Anos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[data_nascimento],GETDATE())/365.25) <= 24 THEN '21 a 24 Anos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[data_nascimento],GETDATE())/365.25) <= 29 THEN '25 a 29 Anos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[data_nascimento],GETDATE())/365.25) <= 34 THEN '30 a 34 Anos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[data_nascimento],GETDATE())/365.25) <= 39 THEN '35 a 39 Anos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[data_nascimento],GETDATE())/365.25) <= 59 THEN '40 a 59 Anos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE 'Acima de 60 anos'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t\t\t,[Data de Sa\u00edda (F\u00e9rias/Afastamento)]\t\t=\tCASE status\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'Afastado' THEN FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar, id_evn order by data_atualizacao ASC) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'F\u00e9rias'\tTHEN FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar, id_evn order by data_atualizacao ASC) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE NULL END\n\t\t\t\t\t,[Data de Retorno (F\u00e9rias/Afastamento)]\t\t=\tCASE status\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'Afastado' THEN min(case when status <> 'Afastado' then data_atualizacao end) over (partition by t0.ID_selecionar order by data_atualizacao ASC rows between current row and unbounded following)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN 'F\u00e9rias'\tTHEN min(case when status <> 'F\u00e9rias'\tthen data_atualizacao end) over (partition by t0.ID_selecionar order by data_atualizacao ASC rows between current row and unbounded following) \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE NULL END\n\t\t\t\t\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\t\t\t=\tCASE WHEN status = 'Turnover' THEN \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE WHEN t3.data_solicitacao IS NOT NULL THEN t3.data_solicitacao\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar, status order by data_atualizacao DESC rows between current row and unbounded following)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND ELSE NULL END\n\t\t\t\t\t,[\u00daltima Data Trabalhada (Turnover)]\t\t=\tCASE WHEN status = 'Turnover' THEN \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tCASE WHEN t3.data_rescisao IS NOT NULL THEN t3.data_rescisao\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar, status order by data_atualizacao DESC rows between current row and unbounded following)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND ELSE NULL END\n\t\t\t\t\t,[Per\u00edodo do Desligamento (Turnover)]\t\t=\tCASE WHEN status = 'Turnover' THEN t3.periodo_do_desligamento ELSE NULL END\n\t\t\t\t\t,[Motivo do Desligamento (Turnover)]\t\t=\tCASE WHEN status = 'Turnover' THEN t3.motivo ELSE NULL END\n\t\t\t\t\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)]\t=\tCASE WHEN status = 'Turnover' THEN t3.indicado_recontratacao ELSE NULL END\n\t\t\t\t\t,[Custo da Rescis\u00e3o (Turnover)]\t\t\t\t=\tCASE WHEN status = 'Turnover' THEN t3.custo ELSE NULL END\t\t\n\t\t\t\t\t,[Data da Proxima Atualiza\u00e7\u00e3o]\t\t\t\t=\tLEAD(t0.[data_atualizacao]) over (partition by t0.[ID_Selecionar] order by t0.[data_atualizacao] ASC)\n\t\t\t\t\t,[Vencimento Contrato Exp. 30d]\t\t\t\t=\tDATEADD(DAY, 29, CAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE))\n\t\t\t\t\t,[Vencimento Contrato Exp. 60d]\t\t\t\t=\tDATEADD(DAY, 59, CAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE))\n\t\t\t\t\t,[Vencimento Contrato Exp. 90d]\t\t\t\t=\tDATEADD(DAY, 89, CAST(FIRST_VALUE(data_atualizacao) over (partition by t0.ID_selecionar order by data_atualizacao ASC) AS DATE))\n\t\t\t\t\t,[Fonte de Log]\t\t\t\t\t\t\t\t=\tt0.[fonte_log]\n\t\t\t\tFROM\t  (SELECT *, id_evn=SUM(cnt_stt) OVER (PARTITION BY id_selecionar ORDER BY data_atualizacao) FROM (SELECT *, cnt_stt = CASE WHEN status = LAG(status) OVER (PARTITION BY id_selecionar ORDER BY data_atualizacao) THEN 0 ELSE 1 END FROM [dim_mop_eventos]) t) as t0\n\t\t\t\tLEFT JOIN [dim_mop_cadastros] as t1\tON t0.ID_selecionar = t1.ID_Selecionar\n\t\t\t\tLEFT JOIN [dim_mop_contatos]  as t2\tON t0.ID_selecionar = t2.ID_Selecionar\n\t\t\t\tLEFT JOIN [dim_mop_turnovers] as t3\tON t0.ID_selecionar = t3.ID_Selecionar\n\t\t\t),\n\t\t\tetapa_1 AS\n\t\t\t(\n\t\t\t\tSELECT *\t\t\t\t\t\t\n\t\t\t\t\t,[Email Supervis\u00e3o]\t= (SELECT MAX([Email Selecionar]) FROM colunas c1 WHERE c1.Nome = c0.Supervis\u00e3o)                     \n\t\t\t\t\t,[\u00daltima DMA Geral] = case when [\u00daltima DMA Migra\u00e7\u00e3o] is null then [DMA Inicial] else [\u00daltima DMA Migra\u00e7\u00e3o] end                    \n\t\t\t\tFROM colunas c0\n\t\t\t),\n\t\t\tetapa_2 AS\n\t\t\t(\n\t\t\t\tSELECT *,[Instrutor \u00daltima DMA]    =  (SELECT TOP 1 Instrutor FROM etapa_1 AS innerTable WHERE innerTable.[ID Selecionar] = etapa_1.[ID Selecionar] AND innerTable.[\u00daltima DMA Geral] = etapa_1.[\u00daltima DMA Geral] ORDER BY innerTable.[Data da Atualiza\u00e7\u00e3o] asc)\n\t\t\t\tFROM etapa_1\n\t\t\t),\n\t\t\tetapa_3 AS\n\t\t\t(\n\t\t\t\tSELECT \n\t\t\t\t\t\t[Data da Atualiza\u00e7\u00e3o]\t\t\t\t\t\t\n\t\t\t\t\t,[ID Selecionar]\t\t\t\t\t\t\t\n\t\t\t\t\t,[ID \u00danico]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[ID Secullum]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[ID Serasa]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[ID Intelix]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[ID EPBX]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[ID Genesys]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Nome]\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Status]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Situa\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Condi\u00e7\u00e3o]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Cliente]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Projeto]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Cargo]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Tribo]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Sub Tribo]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Escala]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Jornada]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Taxa]\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Pausa Manh\u00e3]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Pausa Almo\u00e7o]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Pausa Tarde]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Supervis\u00e3o]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Coordena\u00e7\u00e3o]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Ger\u00eancia]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Diretoria]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Email Selecionar]\t\t\t\t\t\t\t\n\t\t\t\t\t,[Email Serasa]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Email Supervis\u00e3o]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Telefone]\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[CPF]\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Data de Nascimento]\t\t\t\t\t\t\n\t\t\t\t\t,[Nome de Registro]\t\t\t\t\t\t\t\n\t\t\t\t\t,[Sexo Biol\u00f3gico]\t\t\t\t\t\t\t\n\t\t\t\t\t,[REQ]\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[DMA]\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[DMA Inicial]                              \n\t\t\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]                     \n\t\t\t\t\t,[\u00daltima DMA Geral]                         \n\t\t\t\t\t,[Tipo de DMA]\t\t\t\t\t\t\t\t\n\t\t\t\t\t,[Tipo da \u00daltima DMA]                      \n\t\t\t\t\t,[Instrutor]\n\t\t\t\t\t,[Instrutor Inicial]                         =  MAX(CASE WHEN [Tipo da \u00daltima DMA] = 'CONTRATA\u00c7\u00c3O' THEN [Instrutor \u00daltima DMA] ELSE NULL END) OVER (PARTITION BY [ID SELECIONAR] ORDER BY [Data da Atualiza\u00e7\u00e3o] ROWS UNBOUNDED PRECEDING)\n\t\t\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]                 =  MAX(CASE WHEN [Tipo da \u00daltima DMA] = 'MIGRA\u00c7\u00c3O' THEN [Instrutor \u00daltima DMA] ELSE NULL END) OVER (PARTITION BY [ID SELECIONAR] ORDER BY [Data da Atualiza\u00e7\u00e3o] ROWS UNBOUNDED PRECEDING)\n\t\t\t\t\t,[Instrutor \u00daltima DMA] \n\t\t\t\t\t,[Data de Admiss\u00e3o]\t\t\t\t\t\t\n\t\t\t\t\t,[Data de In\u00edcio em Opera\u00e7\u00e3o]\t\t\t\t\n\t\t\t\t\t,[Tempo de Casa (Dias)]\t\n\t\t\t\t\t,[Faixa Tempo de Casa]\n\t\t\t\t\t,[Idade] \n\t\t\t\t\t,[Faixa de Idade]\n\t\t\t\t\t,[Data de Sa\u00edda (F\u00e9rias/Afastamento)]\n\t\t\t\t\t,[Data de Retorno (F\u00e9rias/Afastamento)]\n\t\t\t\t\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\n\t\t\t\t\t,[\u00daltima Data Trabalhada (Turnover)]\n\t\t\t\t\t,[Per\u00edodo do Desligamento (Turnover)]\t\t\n\t\t\t\t\t,[Motivo do Desligamento (Turnover)]\t\t\t\n\t\t\t\t\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)]\t\n\t\t\t\t\t,[Custo da Rescis\u00e3o (Turnover)]\t\t\t\t\t\n\t\t\t\t\t,[Data da Proxima Atualiza\u00e7\u00e3o]\t\t\n\t\t\t\t\t,[Vencimento Contrato Exp. 30d]\n\t\t\t\t\t,[Vencimento Contrato Exp. 60d]\n\t\t\t\t\t,[Vencimento Contrato Exp. 90d]\t\t\n\t\t\t\t\t,[Fonte de Log]\t\n\t\t\t\t\tFROM etapa_2\n\t\t\t)\n\t\t\tSELECT * INTO f_mop_eventos FROM etapa_3\n\n\t\tEND\n\t\tIF 1=1 BEGIN -- SELECT * FROM f_mop_historico ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC\n\t\t\tPRINT '### [f_mop_historico]';\n\n\t\t\tDROP TABLE IF EXISTS f_mop_historico; \n\t\t\tWITH mop AS\n\t\t\t(\n\t\t\t\tSELECT\n\t\t\t\t[Data da Atualiza\u00e7\u00e3o] = t0.data\n\t\t\t\t,[ID Selecionar]\n\t\t\t\t,[ID \u00danico]\n\t\t\t\t,[ID Secullum]\n\t\t\t\t,[ID Serasa]\n\t\t\t\t,[ID Intelix]\n\t\t\t\t,[ID EPBX]\n\t\t\t\t,[ID Genesys]\n\t\t\t\t,[Nome]\n\t\t\t\t,[Status]\n\t\t\t\t,[Situa\u00e7\u00e3o]\n\t\t\t\t,[Condi\u00e7\u00e3o]\n\t\t\t\t,[Cliente]\n\t\t\t\t,[Projeto]\n\t\t\t\t,[Cargo]\n\t\t\t\t,[Tribo]\n\t\t\t\t,[Sub Tribo]\n\t\t\t\t,[Escala]\n\t\t\t\t,[Jornada]\n\t\t\t\t,[Taxa]\n\t\t\t\t,[Pausa Manh\u00e3]\n\t\t\t\t,[Pausa Almo\u00e7o]\n\t\t\t\t,[Pausa Tarde]\n\t\t\t\t,[Supervis\u00e3o]\n\t\t\t\t,[Coordena\u00e7\u00e3o]\n\t\t\t\t,[Ger\u00eancia]\n\t\t\t\t,[Diretoria]\n\t\t\t\t,[Email Selecionar]\n\t\t\t\t,[Email Serasa]\t\t\t\t\t\t\t\t\n\t\t\t\t,[Email Supervis\u00e3o]\n\t\t\t\t,[Telefone]\n\t\t\t\t,[CPF]\n\t\t\t\t,[Data de Nascimento]\n\t\t\t\t,[Nome de Registro]\n\t\t\t\t,[Sexo Biol\u00f3gico]\n\t\t\t\t,[REQ]\n\t\t\t\t,[DMA]\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t,[DMA Inicial]                              \n\t\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]                     \n\t\t\t\t,[\u00daltima DMA Geral]                         \n\t\t\t\t,[Tipo de DMA]\t\t\t\t\t\t\t\t\n\t\t\t\t,[Tipo da \u00daltima DMA]                      \n\t\t\t\t,[Instrutor]\n\t\t\t\t,[Instrutor Inicial]                         \n\t\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]                 \n\t\t\t\t,[Instrutor \u00daltima DMA]\n\t\t\t\t,[Data de Admiss\u00e3o]\n\t\t\t\t,[Data de In\u00edcio em Opera\u00e7\u00e3o]\n\t\t\t\t,[Tempo de Casa (Dias)] = DATEDIFF(DAY, t1.[Data de Admiss\u00e3o], t0.data)\n\t\t\t\t,[Faixa Tempo de Casa] = CASE\n\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, [Data de Admiss\u00e3o],t0.data) <=30 THEN 'At\u00e9 30 Dias'\n\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, [Data de Admiss\u00e3o],t0.data) <=90 THEN '1 a 3 Meses'\n\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, [Data de Admiss\u00e3o],t0.data) <=180 THEN '3 a 6 Meses'\n\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, [Data de Admiss\u00e3o],t0.data) <=365 THEN '6 a 12 Meses'\n\t\t\t\t\t\t\t\t\t\t\tWHEN  DATEDIFF(DAY, [Data de Admiss\u00e3o],t0.data) <=712 THEN '1 a 2 Anos'\n\t\t\t\t\t\t\t\t\t\t\tELSE 'Acima de 2 Anos'\n\t\t\t\t\t\t\t\t\t\tEND\t\n\t\t\t\t,[Idade]               =\tFLOOR(DATEDIFF(DAY,t1.[Data de Nascimento],GETDATE())/365.25)\n\t\t\t\t,[Faixa de Idade]      = CASE\n\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[Data de Nascimento],GETDATE())/365.25) <= 20 THEN '18 a 20 Anos'\n\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[Data de Nascimento],GETDATE())/365.25) <= 24 THEN '21 a 24 Anos'\n\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[Data de Nascimento],GETDATE())/365.25) <= 29 THEN '25 a 29 Anos'\n\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[Data de Nascimento],GETDATE())/365.25) <= 34 THEN '30 a 34 Anos'\n\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[Data de Nascimento],GETDATE())/365.25) <= 39 THEN '35 a 39 Anos'\n\t\t\t\t\t\t\t\t\t\t\tWHEN FLOOR(DATEDIFF(DAY,t1.[Data de Nascimento],GETDATE())/365.25) <= 59 THEN '40 a 59 Anos'\n\t\t\t\t\t\t\t\t\t\t\tELSE 'Acima de 60 anos'\n\t\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t\t,[Data de Sa\u00edda (F\u00e9rias/Afastamento)]\n\t\t\t\t,[Data de Retorno (F\u00e9rias/Afastamento)]\n\t\t\t\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\n\t\t\t\t,[\u00daltima Data Trabalhada (Turnover)]\n\t\t\t\t,[Per\u00edodo do Desligamento (Turnover)]\n\t\t\t\t,[Motivo do Desligamento (Turnover)]\n\t\t\t\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)]\n\t\t\t\t,[Custo da Rescis\u00e3o (Turnover)]\n\t\t\t\t,[Vencimento Contrato Exp. 30d]\n\t\t\t\t,[Vencimento Contrato Exp. 60d]\n\t\t\t\t,[Vencimento Contrato Exp. 90d]\n\t\t\t\t,[Data de Entrada no Status] = t1.data_inicio\n\t\t\t\t,[Data de Sa\u00edda do Status] = t1.data_fim\t\n\t\t\t\t\t,[Fonte de Log]\t\t\n\t\t\tFROM dim_calendario as t0\n\t\t\tLEFT JOIN (\n\t\t\t\tSELECT \n\t\t\t\t\t\tdata_inicio = CAST([Data da Atualiza\u00e7\u00e3o] AS DATE) \n\t\t\t\t\t,data_fim\t = LEAD(CAST([Data da Atualiza\u00e7\u00e3o] AS DATE)) over (partition by [ID Selecionar] order by [Data da Atualiza\u00e7\u00e3o] ASC)\n\t\t\t\t\t,*\n\t\t\t\tFROM f_mop_eventos\n\t\t\t) as t1\n\t\t\tON t0.data >=\tt1.data_inicio\n\t\t\tAND t0.data <\tCASE \n\t\t\t\t\t\t\t\tWHEN t1.data_fim IS NULL AND [status] = 'Turnover' THEN DATEADD(DAY, 1, t1.data_inicio)\n\t\t\t\t\t\t\t\tWHEN t1.data_fim IS NULL THEN DATEADD(DAY, 1, (SELECT MAX(CAST(Data AS DATE)) FROM dim_calendario AS VALUE))\n\t\t\t\t\t\t\t\tELSE t1.data_fim\n\t\t\t\t\t\t\tEND\n\n\n\t\t\t)\n\t\t\tSELECT * INTO f_mop_historico FROM mop\n\n\t\tEND\n\t\tIF 1=1 BEGIN -- SELECT * FROM f_mop_vigente ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC\n\t\t\tPRINT '### [f_mop_vigente]';\n\n\n\t\t\tDROP TABLE IF EXISTS f_mop_vigente; \n\t\t\tWITH eventos AS\n\t\t\t(\n\t\t\tSELECT \n\t\t\t\t\tn = ROW_NUMBER() OVER (PARTITION BY [ID Selecionar] ORDER BY [Data da Atualiza\u00e7\u00e3o] DESC),\n\t\t\t\t\t*, \n\t\t\t\t\t[HC 06:20]\t=\tCASE WHEN Jornada = CAST('6:20:00.000' AS TIME) THEN 1 ELSE 0 END,\n\t\t\t\t\t[HC 10:00]\t=\tCASE WHEN Jornada = CAST('10:00:00.000' AS TIME) THEN 1 ELSE 0 END,\n\t\t\t\t\t[HC 08:12]\t=\tCASE WHEN Jornada = CAST('8:12:00.000' AS TIME) THEN 1 ELSE 0 END,\n\t\t\t\t\t[Turno]\t\t=\tCASE\n\t\t\t\t\t\t\t\t\t\tWHEN Jornada <> CAST('6:20:00.000' AS TIME) THEN 'Integral'\n\t\t\t\t\t\t\t\t\t\tWHEN CAST(LEFT(Escala, 5) AS TIME) < CAST('12:00' AS TIME) THEN 'Manh\u00e3'\n\t\t\t\t\t\t\t\t\t\tELSE 'Tarde'\n\t\t\t\t\t\t\t\t\tEND\t\n\t\t\t\tFROM f_mop_historico\n\t\t\t\tWHERE [Data da Atualiza\u00e7\u00e3o] <= GETDATE()\n\t\t\t)\n\t\t\tSELECT\t \n\t\t\t\t\t[Data da Atualiza\u00e7\u00e3o]\n\t\t\t\t,[ID Selecionar]\n\t\t\t\t,[ID \u00danico]\n\t\t\t\t,[ID Secullum]\n\t\t\t\t,[ID Serasa]\n\t\t\t\t,[ID Intelix]\n\t\t\t\t,[ID EPBX]\n\t\t\t\t,[ID Genesys]\n\t\t\t\t,[Nome]\n\t\t\t\t,[Status]\n\t\t\t\t,[Situa\u00e7\u00e3o]\n\t\t\t\t,[Condi\u00e7\u00e3o]\n\t\t\t\t,[Cliente]\n\t\t\t\t,[Projeto]\n\t\t\t\t,[Cargo]\n\t\t\t\t,[Tribo]\n\t\t\t\t,[Sub Tribo]\n\t\t\t\t,[Escala]\n\t\t\t\t,[Jornada]\n\t\t\t\t,[Taxa]\n\t\t\t\t,[Turno]\n\t\t\t\t,[Pausa Manh\u00e3]\n\t\t\t\t,[Pausa Almo\u00e7o]\n\t\t\t\t,[Pausa Tarde]\n\t\t\t\t,[Supervis\u00e3o]\n\t\t\t\t,[Coordena\u00e7\u00e3o]\n\t\t\t\t,[Ger\u00eancia]\n\t\t\t\t,[Diretoria]\n\t\t\t\t,[Email Selecionar]\n\t\t\t\t,[Email Serasa]\t\t\t\t\t\t\t\t\n\t\t\t\t,[Email Supervis\u00e3o]\n\t\t\t\t,[Telefone]\n\t\t\t\t,[CPF]\n\t\t\t\t,[Data de Nascimento]\n\t\t\t\t,[Nome de Registro]\n\t\t\t\t,[Sexo Biol\u00f3gico]\n\t\t\t\t,[REQ]\n\t\t\t\t,[DMA]\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t,[DMA Inicial]                              \n\t\t\t\t,[\u00daltima DMA Migra\u00e7\u00e3o]                     \n\t\t\t\t,[\u00daltima DMA Geral]                         \n\t\t\t\t,[Tipo de DMA]\t\t\t\t\t\t\t\t\n\t\t\t\t,[Tipo da \u00daltima DMA]                      \n\t\t\t\t,[Instrutor]\n\t\t\t\t,[Instrutor Inicial]                         \n\t\t\t\t,[Instrutor \u00daltima Migra\u00e7\u00e3o]                 \n\t\t\t\t,[Instrutor \u00daltima DMA]\n\t\t\t\t,[HC 06:20]\n\t\t\t\t,[HC 10:00]\n\t\t\t\t,[HC 08:12]\n\t\t\t\t,[Data de Admiss\u00e3o]\n\t\t\t\t,[Tempo de Casa (Dias)]\n\t\t\t\t,[Faixa Tempo de Casa]\n\t\t\t\t,[Idade]\n\t\t\t\t,[Faixa de Idade]\n\t\t\t\t,[Data de In\u00edcio em Opera\u00e7\u00e3o]\n\t\t\t\t,[Data de Sa\u00edda (F\u00e9rias/Afastamento)]\n\t\t\t\t,[Data de Retorno (F\u00e9rias/Afastamento)]\n\t\t\t\t,[Data de Solicita\u00e7\u00e3o (Turnover)]\n\t\t\t\t,[\u00daltima Data Trabalhada (Turnover)]\n\t\t\t\t,[Per\u00edodo do Desligamento (Turnover)]\n\t\t\t\t,[Motivo do Desligamento (Turnover)]\n\t\t\t\t,[Indicado Para Recontrata\u00e7\u00e3o? (Turnover)]\n\t\t\t\t,[Custo da Rescis\u00e3o (Turnover)]\n\t\t\t\t,[Vencimento Contrato Exp. 30d]\n\t\t\t\t,[Vencimento Contrato Exp. 60d]\n\t\t\t\t,[Vencimento Contrato Exp. 90d]\n\t\t\t\t,[Fonte de Log]\t\n\t\t\tINTO f_mop_vigente \n\t\t\tFROM eventos\n\t\t\tWHERE n = 1\n\t\tEND\n\n\t\tUPDATE [dim_data_atualizacao] SET last_update = GETDATE(), last_update_data = (SELECT MAX([Data da Atualiza\u00e7\u00e3o]) from f_mop_eventos) \n\t\tWHERE [table] = 'f_mop_eventos' OR [table] = 'f_mop_historico' OR [table] = 'f_mop_vigente' OR [table] = 'f_mop_fechamento_m\u00eas'OR [table] = 'f_mop_quadrofuncionarios'\n\n\n\tEND\n\t----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\tIF 1=1 BEGIN -- Criar checks\n\n\t\tDROP TABLE IF EXISTS #chk000; SELECT [Problema]='Nomes com acento', * INTO #chk000 FROM (\n\t\t\t\t\t\tSELECT Nome=nome_social\tFROM dim_mop_cadastros\tWHERE\tnome_social\t\t<> TRANSLATE(nome_social,\tN'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz')\n\t\t\tUNION ALL\tSELECT nome_registro\tFROM dim_mop_cadastros\tWHERE\tnome_registro\t<> TRANSLATE(nome_registro,\tN'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz')\n\t\t\tUNION ALL\tSELECT supervisao\t\tFROM dim_mop_eventos\tWHERE\tsupervisao\t\t<> TRANSLATE(supervisao,\tN'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz')\n\t\t\tUNION ALL\tSELECT coordenacao\t\tFROM dim_mop_eventos\tWHERE\tcoordenacao\t\t<> TRANSLATE(coordenacao,\tN'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz')\n\t\t\tUNION ALL\tSELECT gerencia\t\t\tFROM dim_mop_eventos\tWHERE\tgerencia\t\t<> TRANSLATE(gerencia,\t\tN'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz')\n\t\t\tUNION ALL\tSELECT diretoria\t\tFROM dim_mop_eventos\tWHERE\tdiretoria\t\t<> TRANSLATE(diretoria,\t\tN'\u00c1\u00c0\u00c2\u00c3\u00c4\u00c5\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0100\u0101\u0105\u0104\u00e6\u00c6\u00c7\u00e7\u0107\u0106\u010d\u010c\u00a2\u00a9\u0111\u0110\u010f\u010e\u00c8\u00c9\u00ca\u00cb\u00e8\u00e9\u00ea\u00eb\u011b\u011a\u0112\u0113\u0119\u0118\u00cc\u00cd\u00ce\u00cf\u00ec\u00ed\u00ee\u00ef\u012a\u012b\u0142\u0141\u00a3\u00d1\u00f1\u0148\u0147\u0144\u0143\u00d2\u00d3\u00d4\u00d5\u00d5\u00d6\u00d8\u00f2\u00f3\u00f4\u00f5\u00f6\u00f8\u014c\u014d\u0159\u0158\u00ae\u0160\u0161\u015b\u015a\u00df\u0165\u0164\u00d9\u00da\u00db\u00dc\u00f9\u00fa\u00fb\u00fc\u016f\u016e\u016a\u016b\u00b5\u00d7\u00a5\u0178\u00ff\u00fd\u00dd\u017d\u017e\u017c\u017b\u017a\u0179', N'aaaaaaaaaaaaaaaaaaccccccccddddeeeeeeeeeeeeeeiiiiiiiiiilllnnnnnooooooooooooooooorrsssssttuuuuuuuuuuuuuxyyyyyzzzzzz')\n\t\t) _\n\t\tORDER BY Nome ASC\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk001; SELECT [Problema]='Eventos de usu\u00e1rios sem cadastro', * INTO #chk001 FROM ( \n\t\t\tSELECT * FROM f_mop_eventos WHERE Nome IS NULL \n\t\t) _\n\t\tORDER BY Nome ASC\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk002; SELECT [Problema]='Pessoas n\u00e3o encontradas MOP>>Secullum', * INTO #chk002 FROM (\n\t\t\tSELECT * FROM ( SELECT m\u00eas = [Data In\u00edcio], id_sec_real=ID_funcionario, id_sec_mop=[ID Secullum], id_mop=[ID Selecionar], id_sec=numero_folha, nome_mop=mop.Nome, nome_reg=[Nome de Registro], nome_sec=sec.nome, adm_mop=[Data de Admiss\u00e3o], adm_sec=admissao, matches=SUM(1) OVER (PARTITION BY [ID Selecionar], [Data In\u00edcio]), diff=ABS(DATEDIFF(DAY,[Data de Admiss\u00e3o],admissao)), n=ROW_NUMBER() OVER (PARTITION BY [ID Selecionar], [Data In\u00edcio] ORDER BY ABS(DATEDIFF(DAY,[Data de Admiss\u00e3o],admissao))) \n\t\t\t\t\t\t\tFROM f_mop_fechamento_m\u00eas mop LEFT JOIN dim_secullum_funcionarios sec ON (sec.nome = mop.nome OR sec.nome = mop.[Nome de Registro] OR numero_folha = [ID Selecionar] OR numero_folha = [ID Serasa])) t \n\t\t\tWHERE n=1 AND id_mop IS NOT NULL AND id_sec_mop IS NULL AND id_mop NOT IN ('TO_913','C99397A','C99405A','C11039Q','C11088Q','C10723Q','C10723Q','C11039Q','C11082Q','C11088Q','C11054Q','C11082Q')\n\t\t) _\n\t\tORDER BY m\u00eas DESC, adm_mop DESC, adm_sec DESC\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk003; SELECT [Problema]='Pessoas n\u00e3o encontradas Secullum>>MOP', * INTO #chk003 FROM (\n\t\t\tSELECT * FROM ( SELECT\t[ID Selecionar], [ID Secullum], ID_funcionario, nome, cpf, nascimento, admissao, demissao, empresa_nome, departamento, funcao, estrutura, \n\t\t\t\t\t\t\tignorar =\tCASE ID_funcionario\tWHEN '642'\tTHEN 'IGNORAR: CEO'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '645'\tTHEN 'IGNORAR: CFO'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '643'\tTHEN 'IGNORAR: PJ'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '31'\tTHEN 'IGNORAR: PJ'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '658'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '652'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '654'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '651'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '705'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '659'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '653'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '662'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '771'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '710'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '793'\tTHEN 'IGNORAR: PJ'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '667'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '716'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '656'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '655'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '661'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '790'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '792'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '923'\tTHEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1098' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1142' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1182' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1187' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1188' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1229' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1830' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1242' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1243' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1264' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1645' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1666' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1717' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1778' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1788' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1785' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1836' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1840' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1851' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1845' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1844' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1847' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1855' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1856' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1862' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1869' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1886' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1885' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1888' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1910' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1917' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1939' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1929' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1932' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1931' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1930' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1962' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1959' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '1943' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2019' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2018' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2116' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2179' THEN 'IGNORAR: DESISTENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2242' THEN 'IGNORAR: DESISTENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2238' THEN 'IGNORAR: DESISTENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2274' THEN 'IGNORAR: DESISTENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2273' THEN 'IGNORAR: DESISTENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2302' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2428' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2341' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2532' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2554' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2552' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2606' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2608' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2607' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2656' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2678' THEN 'IGNORAR: DESISTENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2724' THEN 'IGNORAR: PJ'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN '2769' THEN 'IGNORAR: CLIENTE'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tEND FROM dim_secullum_funcionarios sec \n\t\t\t\tLEFT JOIN (SELECT [ID Selecionar], [ID Secullum] FROM f_mop_eventos) mop ON sec.ID_funcionario = mop.[ID Secullum] \n\t\t\t\tWHERE [ID Selecionar] IS NULL AND (admissao >= @data_limite  OR (demissao >= @data_limite OR demissao IS NULL))) t \n\t\t\t\tWHERE ignorar IS NULL\n\t\t) _\n\t\tORDER BY admissao DESC, demissao DESC, nome ASC\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk004; SELECT [Problema]='[ID Secullum] duplicada', * INTO #chk004 FROM ( \n\t\t\tSELECT cont, [ID Selecionar], [ID Secullum], mop.Nome, n=COUNT(*) OVER (PARTITION BY Nome, [ID Secullum])  FROM (SELECT cont=SUM(1) OVER (PARTITION BY [ID Secullum]), * FROM f_mop_vigente WHERE [ID Secullum] IS NOT NULL) mop WHERE cont > 1 \n\t\t) _ WHERE n<=1\n\t\tORDER BY cont DESC, [ID Secullum] DESC, [ID Selecionar] DESC\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\t/*\n\t\tDROP TABLE IF EXISTS #chk005; SELECT [Problema]='Roteiros de desligamento sem TO no MOP', * INTO #chk005 FROM (\n\t\t\tSELECT *,  data_dho = data_rescisao FROM dim_mop_turnovers\n\t\t\tWHERE NOT EXISTS ( SELECT 1 FROM dim_mop_eventos WHERE status = 'Turnover' AND dim_mop_eventos.ID_selecionar = dim_mop_turnovers.ID_selecionar)\n\t\t\tAND EXISTS ( SELECT 1 FROM dim_mop_eventos WHERE dim_mop_eventos.ID_selecionar = dim_mop_turnovers.ID_selecionar)\n\t\t) _\n\t\tORDER BY data_rescisao DESC, data_solicitacao DESC, ID_selecionar DESC\n\t\t*/\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\t/*\n\t\tDROP TABLE IF EXISTS #chk006; SELECT [Problema]='Roteiros de desligamento de usu\u00e1rios n\u00e3o encontrados no MOP', * INTO #chk006 FROM (\n\t\t\tSELECT *,  data_dho = data_rescisao FROM dim_mop_turnovers\n\t\t\tWHERE NOT EXISTS ( SELECT 1 FROM dim_mop_eventos WHERE dim_mop_eventos.ID_selecionar = dim_mop_turnovers.ID_selecionar)\n\t\t) _ \n\t\tORDER BY data_rescisao DESC, data_solicitacao DESC, ID_selecionar DESC\n\t\t*/\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\t/*\n\t\tDROP TABLE IF EXISTS #chk007; SELECT [Problema]='TOs sem roteiro de desligamento', * INTO #chk007 FROM (\n\t\t\tSELECT * FROM f_mop_eventos WHERE NOT EXISTS (SELECT 1 FROM dim_mop_turnovers WHERE f_mop_eventos.[ID Selecionar] = dim_mop_turnovers.ID_selecionar) AND status = 'Turnover' and [Data da Atualiza\u00e7\u00e3o] >= @data_limite\n\t\t) _\n\t\tORDER BY [Data da Atualiza\u00e7\u00e3o] DESC, [ID Selecionar] DESC\n\t\t*/\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\t/*\n\t\tDROP TABLE IF EXISTS #chk008; SELECT [Problema]='Roteiro de desligamento com data divergente', * INTO #chk008 FROM (\n\t\t\tSELECT att.id_mop, att.situacao, att.condicao, att.data_mop, att.data_dho, att.diff\n\t\t\tFROM dim_mop_eventos mop INNER JOIN (\n\t\t\t\tSELECT *, diff = ABS(DATEDIFF(DAY, data_mop, data_dho)) FROM(\n\t\t\t\t\tSELECT id_mop = mop.id_selecionar, mop.situacao, mop.condicao, data_mop = CAST(mop.data_atualizacao AS DATE), data_dho = data_rescisao\n\t\t\t\t\tFROM (SELECT * FROM dim_mop_eventos WHERE status = 'Turnover' AND situacao IN ('Desligamento', 'Desist\u00eancia')) as mop\n\t\t\t\t\tINNER JOIN dim_mop_turnovers as dho ON mop.ID_selecionar = dho.ID_selecionar\n\t\t\t\t) as t WHERE ABS(DATEDIFF(DAY, data_mop, data_dho)) > 0\n\t\t\t) as att ON mop.ID_selecionar = att.id_mop AND mop.data_atualizacao = att.data_mop\n\t\t) _\n\t\tORDER BY data_mop DESC, data_dho DESC\n\t\t*/\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk009; SELECT [Problema]='Datas de admiss\u00e3o divergentes', * INTO #chk009 FROM (\n\t\t\tSELECT att.diff, mop.ID_selecionar, mop.data_atualizacao, uni_admissao\n\t\t\tFROM dim_mop_eventos mop INNER JOIN (\n\t\t\t\tSELECT [ID Selecionar], mop_admissao = mop.[Data de Admiss\u00e3o], uni_admissao = uni.admissao, diff = ABS(DATEDIFF(DAY, mop.[Data de Admiss\u00e3o], uni.admissao)) FROM f_mop_vigente mop INNER JOIN dim_unico_funcionarios uni ON mop.[ID \u00danico] = CONCAT(uni.empresa, uni.ID_funcionario) \n\t\t\t) att ON mop.ID_selecionar = att.[ID Selecionar] WHERE mop.data_atualizacao < uni_admissao --ORDER BY diff DESC, data_atualizacao DESC\t\n\t\t) _\n\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk010; SELECT [Problema]='Datas de demiss\u00e3o divergentes', * INTO #chk010 FROM (\n\t\t\tSELECT att.diff, mop.ID_selecionar, Nome, mop.data_atualizacao, uni_demissao\n\t\t\tFROM dim_mop_eventos mop INNER JOIN (\n\t\t\t\tSELECT [ID Selecionar], Nome, mop_demissao = mop.[Data da Atualiza\u00e7\u00e3o], uni_demissao = uni.demissao, diff = ABS(DATEDIFF(DAY, mop.[Data da Atualiza\u00e7\u00e3o], uni.demissao)) FROM f_mop_vigente mop INNER JOIN dim_unico_funcionarios uni ON mop.[ID \u00danico] = CONCAT(uni.empresa, uni.ID_funcionario) WHERE Status = 'Turnover'\n\t\t\t) att ON mop.ID_selecionar = att.[ID Selecionar] \n\t\t\tWHERE mop.data_atualizacao > uni_demissao AND mop.status = 'Turnover'\n\t\t) _\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk011; SELECT [Problema]='Pessoas com mais de um evento de TO', * INTO #chk011 FROM (\n\t\t\tSELECT * FROM (SELECT ID_selecionar, cont_turnovers = SUM(CASE WHEN status = 'Turnover' THEN 1 ELSE 0 END) FROM dim_mop_eventos GROUP BY ID_selecionar) t WHERE cont_turnovers > 1  --ORDER BY cont_turnovers DESC\n\t\t) _\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\t/*\n\t\tDROP TABLE IF EXISTS #chk012; SELECT [Problema]='Status de TO divergente do roteiro de desligamento', * INTO #chk012 FROM (\n\t\t\tSELECT [Tipo]='Desist\u00eancia/Desligamento', * FROM (\n\t\t\t\t\tSELECT att.data_atualizacao, att.ID_selecionar, att.situacao_mop, att.condicao_mop, att.condicao_dho, att.periodo_dho FROM dim_mop_eventos mop \n\t\t\t\t\tINNER JOIN ( SELECT\t mop.data_atualizacao\n\t\t\t\t\t\t\t\t\t\t,mop.id_selecionar\n\t\t\t\t\t\t\t\t\t\t,situacao_mop = mop.situacao\n\t\t\t\t\t\t\t\t\t\t,periodo_dho  = dho.periodo_do_desligamento\n\t\t\t\t\t\t\t\t\t\t,condicao_mop = mop.condicao\n\t\t\t\t\t\t\t\t\t\t,condicao_dho = CASE WHEN dho.motivo = 'T\u00e9rmino de projeto'\t\tTHEN 'T\u00e9rmino de Contrato'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN dho.motivo = 'Abandono - Justa Causa' THEN 'Volunt\u00e1rio' \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE dho.tipo END\n\t\t\t\t\t\t\t\t\tFROM (SELECT * FROM dim_mop_eventos WHERE status = 'Turnover' AND situacao IN ('Desligamento', 'Desist\u00eancia')) as mop \n\t\t\t\t\t\t\t\t\tINNER JOIN dim_mop_turnovers as dho ON mop.ID_selecionar = dho.ID_selecionar\n\t\t\t\t\t) as att ON mop.ID_selecionar = att.ID_selecionar AND mop.data_atualizacao = att.data_atualizacao AND att.periodo_dho = 'Durante o treinamento inicial ' AND att.situacao_mop <> 'Em Treinamento') t0\n\t\t\tUNION ALL\n\t\t\tSELECT [Tipo]='Volunt\u00e1rio/Involunt\u00e1rio', * FROM (\n\t\t\t\t\tSELECT att.data_atualizacao, att.ID_selecionar, att.situacao_mop, att.condicao_mop, att.condicao_dho, att.periodo_dho FROM dim_mop_eventos mop \n\t\t\t\t\tINNER JOIN ( SELECT  mop.data_atualizacao\n\t\t\t\t\t\t\t\t\t\t,mop.id_selecionar\n\t\t\t\t\t\t\t\t\t\t,periodo_dho=dho.periodo_do_desligamento\n\t\t\t\t\t\t\t\t\t\t,situacao_mop = mop.situacao\n\t\t\t\t\t\t\t\t\t\t,condicao_mop = mop.condicao\n\t\t\t\t\t\t\t\t\t\t,condicao_dho = CASE WHEN dho.motivo = 'T\u00e9rmino de projeto'\t\tTHEN 'T\u00e9rmino de Contrato'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tWHEN dho.motivo = 'Abandono - Justa Causa' THEN 'Volunt\u00e1rio' \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tELSE dho.tipo END\n\t\t\t\t\t\t\t\tFROM (SELECT * FROM dim_mop_eventos WHERE status = 'Turnover' AND situacao IN ('Desligamento', 'Em Treinamento')) as mop\n\t\t\t\t\t\t\t\tINNER JOIN dim_mop_turnovers as dho ON mop.ID_selecionar = dho.ID_selecionar\n\t\t\t\t\t) as att ON mop.ID_selecionar = att.ID_selecionar AND mop.data_atualizacao = att.data_atualizacao AND condicao_mop <> condicao_dho) t1\n\t\t) _\n\t\t*/\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\t/*\n\t\tDROP TABLE IF EXISTS #chk013; SELECT [Problema]='Datas de TO antes da \u00faltima atividade (log/ticket/chamada/etc) da pessoa', * INTO #chk013 FROM (\n\t\t\tSELECT data_to, data_ev, [ID Selecionar], tribo, status FROM dim_mop_eventos mop \n\t\t\tINNER JOIN ( SELECT data_to = CAST([Data da Atualiza\u00e7\u00e3o] AS DATE), data_ev, [ID Intelix], [ID Selecionar], diff = DATEDIFF(DAY, [Data da Atualiza\u00e7\u00e3o], data_ev), [Motivo do Desligamento (Turnover)]  FROM f_mop_vigente as mop\n\t\t\t\t\t\t\tLEFT JOIN (SELECT data_ev = MAX(CAST(inicio AS DATE)), id_atendente FROM tb_eventos GROUP BY id_atendente) ev ON Status = 'Turnover' AND DATEDIFF(DAY, [Data da Atualiza\u00e7\u00e3o], data_ev) > 0 AND [ID Intelix] = id_atendente AND (data_ev >= @data_limite OR [Data da Atualiza\u00e7\u00e3o] >= @data_limite)\n\t\t\t\t\t\t\tWHERE data_ev IS NOT NULL\n\t\t\t) as att ON mop.ID_selecionar = att.[ID Selecionar] AND mop.data_atualizacao = att.data_to\n\t\t) _\n\t\t*/\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk014; SELECT [Problema]='Pessoas n\u00e3o encontradas MOP>>\u00danico', * INTO #chk014 FROM (\n\t\t\tSELECT DISTINCT [ID Selecionar], [ID \u00danico], Nome FROM f_mop_eventos mop LEFT JOIN dim_unico_funcionarios uni ON mop.[ID \u00danico] = CONCAT(uni.empresa, uni.ID_funcionario) WHERE ID_funcionario IS NULL\n\t\t) _\n\t\tORDER BY Nome\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk015; SELECT [Problema]='Pessoas n\u00e3o encontradas \u00danico>>MOP', * INTO #chk015 FROM (\n\t\t\tSELECT DISTINCT id_unico=CONCAT(uni.empresa, uni.ID_funcionario), uni.nome_registro, uni.nome_social, uni.admissao, uni.demissao FROM f_mop_eventos mop RIGHT JOIN dim_unico_funcionarios uni ON mop.[ID \u00danico] = CONCAT(uni.empresa, uni.ID_funcionario) WHERE [ID Selecionar] IS NULL AND (uni.admissao >= @data_limite  OR (uni.demissao >= @data_limite OR uni.demissao IS NULL))\n\t\t) _\n\t\tORDER BY nome_registro\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk016; SELECT [Problema]='Eventos depois do TO', * INTO #chk016 FROM (\n\t\t\tSELECT mop.ID_selecionar, mop.data_atualizacao, att.primeiro_to FROM dim_mop_eventos mop INNER JOIN (SELECT ID_selecionar, primeiro_to=MIN(data_atualizacao) FROM dim_mop_eventos WHERE status = 'Turnover' GROUP BY ID_selecionar) att ON mop.ID_selecionar = att.ID_selecionar WHERE mop.data_atualizacao>att.primeiro_to\n\t\t) _\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk017; SELECT [Problema]='[ID \u00danico] duplicada', * INTO #chk017 FROM ( \n\t\t\tSELECT * FROM (SELECT id_unico, cnt=COUNT(DISTINCT ID_selecionar) FROM dim_mop_eventos GROUP BY id_unico) t WHERE cnt>1 AND ID_unico IS NOT NULL \n\t\t) _\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk018; SELECT [Problema]='[ID Selecionar] duplicada', * INTO #chk018 FROM (\n\t\t\tSELECT * FROM (SELECT ID_selecionar, cnt=COUNT(*) FROM dim_mop_cadastros GROUP BY ID_selecionar) t WHERE cnt>1\n\t\t) _\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk019; SELECT [Problema]='Evento duplicado', * INTO #chk019 FROM (\n\t\t\tSELECT * FROM (SELECT ID_selecionar, data_atualizacao, cnt=COUNT(*) FROM dim_mop_eventos GROUP BY ID_selecionar,data_atualizacao) t WHERE cnt>1\n\t\t) _\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk020; SELECT [Problema]='Status fora do padr\u00e3o', * INTO #chk020 FROM (\n\t\t\tSELECT ID_selecionar, data_atualizacao, status, situacao, condicao FROM (\n\t\t\t\tSELECT ID_selecionar, data_atualizacao, status, situacao, condicao,\t\n\t\t\t\terrado=CASE\tWHEN status='Afastado'\t\tAND situacao='Licen\u00e7a'\t\t\tAND condicao IN ('Casamento','INSS','Maternidade')\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Afastado'\t\tAND situacao='Standby'\t\t\tAND condicao IN ('Standby')\t\t\t\t\t\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='F\u00e9rias'\t\tAND situacao='F\u00e9rias'\t\t\tAND condicao IN ('F\u00e9rias')\t\t\t\t\t\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Ativo'\t\t\tAND situacao='Ausente'\t\t\tAND condicao IN ('Abandono', 'Rescis\u00e3o Indireta')\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Ativo'\t\t\tAND situacao='Home Office'\t\tAND condicao IN ('Home Office', 'Aviso Pr\u00e9vio')\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Ativo'\t\t\tAND situacao='Migra\u00e7\u00e3o'\t\t\tAND condicao IN ('Presencial', 'Aviso Pr\u00e9vio')\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Ativo'\t\t\tAND situacao='Presencial'\t\tAND condicao IN ('Presencial', 'Aviso Pr\u00e9vio')\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Treinamento'\tAND situacao='Ausente'\t\t\tAND condicao IN ('Abandono')\t\t\t\t\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Treinamento'\tAND situacao='Home Office'\t\tAND condicao IN ('Home Office', 'Aviso Pr\u00e9vio')\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Treinamento'\tAND situacao='Presencial'\t\tAND condicao IN ('Presencial', 'Aviso Pr\u00e9vio')\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Staff'\t\t\tAND situacao='Home Office'\t\tAND condicao IN ('Home Office', 'Aviso Pr\u00e9vio', 'Trainee')\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Staff'\t\t\tAND situacao='Presencial'\t\tAND condicao IN ('Presencial', 'Aviso Pr\u00e9vio', 'Trainee')\t\t\t\tTHEN 0\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tWHEN status='Staff'\t\t\tAND situacao='Ausente'\t\t\tAND condicao IN ('Abandono', 'Rescis\u00e3o Indireta')\t\t\t\t\t\tTHEN 0\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tWHEN status='Turnover'\t\tAND situacao='Desligamento'\t\tAND condicao IN ('Volunt\u00e1rio', 'Involunt\u00e1rio', 'T\u00e9rmino de Contrato', 'Abandono', 'Rescis\u00e3o Indireta')\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Turnover'\t\tAND situacao='Em Treinamento'\tAND condicao IN ('Volunt\u00e1rio', 'Involunt\u00e1rio', 'Abandono', 'Rescis\u00e3o Indireta')\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Turnover'\t\tAND situacao='Promo\u00e7\u00e3o'\t\t\tAND condicao IN ('Volunt\u00e1rio')\t\t\t\t\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tWHEN status='Turnover'\t\tAND situacao='Internaliza\u00e7\u00e3o'\tAND condicao IN ('Volunt\u00e1rio')\t\t\t\t\t\t\t\t\t\t\tTHEN 0\n\t\t\t\t\t\t\tELSE 1 END FROM dim_mop_eventos) t WHERE errado=1\n\t\t) _\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk021; SELECT [Problema]='Taxa divergente da escala/jornada', * INTO #chk021 FROM (\n\t\t\tSELECT ID_selecionar, data_atualizacao, escala, jornada, taxa, correto FROM (\n\t\t\t\tSELECT ID_selecionar, data_atualizacao, escala, jornada, taxa,\t\n\t\t\t\t\tcorreto=CASE \n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(02,47,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(03,13,0,0,0) THEN taxa\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(03,20,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(03,22,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(03,59,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(04,00,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(05,08,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(06,00,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(06,20,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(06,30,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(07,00,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(07,20,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(07,30,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(07,50,0,0,0) THEN 2\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(04,05,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(04,38,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(08,00,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(08,12,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(08,20,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(08,48,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(08,56,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(09,00,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(09,48,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tWHEN jornada=TIMEFROMPARTS(10,00,0,0,0) THEN 1\n\t\t\t\t\t\t\t\t\tELSE null END FROM dim_mop_eventos) t WHERE taxa<>correto OR correto is null\n\t\t) _\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk022; SELECT [Problema]='Cadastros sem eventos', * INTO #chk022 FROM (\n\t\t\tSELECT * FROM dim_mop_cadastros WHERE id_selecionar NOT IN (SELECT DISTINCT ID_selecionar FROM dim_mop_eventos) \n\t\t) _\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk023; SELECT [Problema]='Zeros ou espa\u00e7os onde deveria ter nulls', * INTO #chk023 FROM (\n\t\t\tSELECT * FROM dim_mop_eventos WHERE ID_intelix = 0 OR ID_epbx = 0 OR ID_secullum = 0 OR supervisao = '' OR coordenacao = '' or gerencia = '' or diretoria = ''\n\t\t) _\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk024; SELECT [Problema]='Pausas fora de escala (*margem de 1h)', * INTO #chk024 FROM (\n\t\t\tSELECT data_atualizacao, id_selecionar, escala, pausa_manha, pausa_almoco, pausa_tarde\n\t\t\tFROM dim_mop_eventos\n\t\t\tWHERE  CAST(DATEADD(hour, 1,  LEFT(escala, 5)) as time) > pausa_manha \n\t\t\t\tOR CAST(DATEADD(hour, 1,  LEFT(escala, 5)) as time) > pausa_almoco\n\t\t\t\tOR CAST(DATEADD(hour, 1,  LEFT(escala, 5)) as time) > pausa_tarde \n\t\t\t\tOR CAST(DATEADD(hour, -1, RIGHT(escala, 5)) as time) < pausa_manha \n\t\t\t\tOR CAST(DATEADD(hour, -1, RIGHT(escala, 5)) as time) < pausa_almoco\n\t\t\t\tOR CAST(DATEADD(hour, -1, RIGHT(escala, 5)) as time) < pausa_tarde \n\t\t) _ WHERE data_atualizacao >= @data_limite\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\t/*\n\t\tDROP TABLE IF EXISTS #chk025; SELECT [Problema]='Nomes divergentes (MOP x \u00danico)', * INTO #chk025 FROM (\n\t\t\tSELECT DISTINCT [ID Selecionar], [ID \u00danico], [Nome Social (MOP)]=UPPER(Nome), [Nome Social (\u00d9nico)]=UPPER(nome_social), [Nome Registro (MOP)]=UPPER([Nome de Registro]), [Nome Registro (\u00danico)]=UPPER(nome_registro)\n\t\t\tFROM f_mop_eventos mop \n\t\t\tLEFT JOIN dim_unico_funcionarios uni \n\t\t\tON mop.[ID \u00danico] = CONCAT(uni.empresa, uni.ID_funcionario) \n\t\t\tWHERE ID_funcionario IS NOT NULL AND (UPPER(Nome) <> UPPER(nome_social) OR UPPER([Nome de Registro]) <> UPPER(nome_registro))\n\t\t) _\n\t\tORDER BY [ID Selecionar]\n\t\t*/\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk026; SELECT [Problema]='ID de plataforma faltando (Intelix)', * INTO #chk026 FROM (\n\t\t\tSELECT DISTINCT [Data da Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Intelix], [Projeto], [Tribo], [Status] FROM f_mop_eventos\n\t\t\tWHERE ([Status] = 'Ativo' AND [Data da Atualiza\u00e7\u00e3o] >= '01/01/2024')\n\t\t\tAND ([ID Intelix] IS NULL AND [Projeto] in ('Digital', 'BackOffice', 'Assembl\u00e9ia'))\n\t\t) _\n\t\tORDER BY [Data da Atualiza\u00e7\u00e3o] DESC\n\t\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk027; SELECT [Problema]='ID de plataforma faltando (Genesys)', * INTO #chk027 FROM (\n\t\t\tSELECT DISTINCT [Data da Atualiza\u00e7\u00e3o], [ID Selecionar], [ID Genesys], [Projeto], [Tribo], [Status] FROM f_mop_eventos\n\t\t\tWHERE ([Status] = 'Ativo' AND [Data da Atualiza\u00e7\u00e3o] >= '01/01/2024')\n\t\t\tAND ([ID Genesys] IS NULL AND [Projeto] in ('Voz') AND [Tribo] NOT IN ('BackOffice'))\n\t\t) _\n\t\tORDER BY [Data da Atualiza\u00e7\u00e3o] DESC\n\t\t\t\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk028; SELECT [Problema]='Pausas duplicadas', * INTO #chk028 FROM (\n\t\t\tSELECT [Data da Atualiza\u00e7\u00e3o], [ID Selecionar], [Pausa Manh\u00e3], [Pausa Almo\u00e7o], [Pausa Tarde] FROM f_mop_eventos\n\t\t\tWHERE\t[Pausa Manh\u00e3] IN ([Pausa Almo\u00e7o], [Pausa Tarde])\n\t\t\tOR\t\t[Pausa Almo\u00e7o] IN ([Pausa Manh\u00e3], [Pausa Tarde])\n\t\t\tOR\t\t[Pausa Tarde] IN ([Pausa Manh\u00e3], [Pausa Almo\u00e7o])\n\t\t) _\n\t\tORDER BY [Data da Atualiza\u00e7\u00e3o] DESC\n\n\t\t--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\t\tDROP TABLE IF EXISTS #chk029; SELECT [Problema]='Fonte de Log Inv\u00e1lida', * INTO #chk029 FROM (\n\t\t\tSELECT [Data da Atualiza\u00e7\u00e3o], [ID Selecionar], [Fonte de Log] \n\t\t\tFROM f_mop_eventos\n\t\t\tWHERE [Fonte de Log] IS NOT NULL \n\t\t\tAND [Fonte de Log] NOT IN ('INTELIX', 'GENESYS', 'EPBX', 'SECULLUM')\n\t\t) _\n\t\tORDER BY [Data da Atualiza\u00e7\u00e3o] DESC\n\n\tEND\n\t----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\tIF 1=1 BEGIN -- Organizar, registrar, e printar\n\n\n\t\tSELECT * INTO #check_ids FROM (\n\t\t\tSELECT [ID]=RIGHT(LEFT(NAME, charindex('_', NAME) - 1),6) FROM tempdb..sysobjects\n\t\t\tWHERE NAME LIKE '#chk%' AND upper(xtype) = 'U' AND object_id('tempdb..' + NAME) IS NOT NULL\n\t\t) _\n\n\t\tCREATE TABLE #checklist\t\t\t ([ID] NVARCHAR(6), [Problema] NVARCHAR(MAX), [Ocorr\u00eancias] INT);\n\t\tCREATE TABLE #checklist_ordenado ([ID] NVARCHAR(6), [Problema] NVARCHAR(MAX), [Ocorr\u00eancias] INT);\n\t\tDECLARE @sql NVARCHAR(MAX)\n\t\tDECLARE @id NVARCHAR(6)\n\t\tDECLARE @c CURSOR\n\n\n\t\tSET @c = CURSOR FOR SELECT [ID] FROM #check_ids\n\t\tOPEN @c\n\t\tFETCH NEXT FROM @c INTO @id \n\t\tWHILE @@FETCH_STATUS = 0 BEGIN\n\t\t\tSET @sql = 'SELECT t0.[ID], t1.[Problema], [Ocorr\u00eancias]=COUNT(*) FROM #check_ids t0 CROSS APPLY #'+@id+' t1 WHERE t0.[ID] = '''+@id+''' GROUP BY t0.[ID], t1.[Problema]'\n\t\t\tINSERT INTO #checklist EXEC(@sql)\n\t\t\tFETCH NEXT\n\t\t\tFROM @c INTO @id\n\t\tEND; CLOSE @c; DEALLOCATE @c\n\n\t\tSET @sql = 'SELECT * FROM #checklist WHERE '''+@ignorar+''' NOT LIKE CONCAT(''%'',[ID],''%'') ORDER BY Ocorr\u00eancias ' + @ordem\n\t\tINSERT INTO #checklist_ordenado EXEC(@sql)\n\t\tSELECT * FROM #checklist_ordenado\n\n\t\tIF @registrar = 0\n\t\tBEGIN\n\t\t\tSET @c = CURSOR FOR SELECT [ID] FROM #checklist_ordenado\n\t\t\tOPEN @c\n\t\t\tFETCH NEXT FROM @c INTO @id \n\t\t\tWHILE @@FETCH_STATUS = 0 BEGIN\n\t\t\t\tSET @sql = 'SELECT [ID]='''+@id+''', * FROM #'+@id\n\t\t\t\tEXEC sp_executesql @sql\n\t\t\t\tFETCH NEXT\n\t\t\t\tFROM @c INTO @id\n\t\t\tEND; CLOSE @c; DEALLOCATE @c\n\t\tEND\n\n\t\tIF @registrar = 1\n\t\tBEGIN\n\t\t\tINSERT INTO dim_mop_sinalizacoes SELECT GETDATE(), @data_limite, * FROM #checklist_ordenado\n\t\tEND\n\n\tEND\n\n\t;EXEC sp_sys_perms; PRINT '############# SYS_PERMS'\n\n\n\n\nGO\n",
        "build_order": 349,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT data_to = CAST([Data da Atualiza\u00e7\u00e3o] AS DATE), data_ev, [ID Intelix], [ID Selecionar], diff = DATEDIFF(DAY, [Data da Atualiza\u00e7\u00e3o], data_ev), [Motivo do Desligamento (Turnover)]  FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[fx].[PriMaiuscula]": [
                "UNKNOWN",
                "PriMaiuscula"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": [
                "UNKNOWN",
                "dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "UNKNOWN",
                "f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "UNKNOWN",
                "f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT data_to = CAST([Data da Atualiza\u00e7\u00e3o] AS DATE), data_ev, [ID Intelix], [ID Selecionar], diff = DATEDIFF(DAY, [Data da Atualiza\u00e7\u00e3o], data_ev), [Motivo do Desligamento (Turnover)]  FROM f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT MAX(CAST(Data AS DATE)) FROM dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "UNKNOWN",
                "dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_quadrofuncionarios]": [
                "UNKNOWN",
                "f_mop_quadrofuncionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_fechamento_m\u00eas]": [
                "UNKNOWN",
                "f_mop_fechamento_m\u00eas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_unico_funcionarios]": [
                "UNKNOWN",
                "dim_unico_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_data_atualizacao]": [
                "UPDATE",
                "UPDATE [dim_data_atualizacao]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_cadastros]": [
                "SELECT",
                "SELECT * FROM dim_mop_cadastros"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_contatos]": [
                "UNKNOWN",
                "[dim_mop_contatos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_sinalizacoes]": [
                "INSERT",
                "INSERT INTO dim_mop_sinalizacoes"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_turnovers]": [
                "UNKNOWN",
                "dim_mop_turnovers"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_sys_chk_mop]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "EXEC",
                "EXEC sp_sys_perms"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE ON sp_sys_chk_mop"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_sys_chk_mop]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "EXEC",
                "EXECUTE\t\t\t\t\t\t\tON sp_sys_chk_mop"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_conns]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_conns]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_sys_conns",
        "type": "StoredProcedure",
        "start": 895806,
        "end": 897065,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_conns]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE procedure [dbo].[sp_sys_conns] AS \n\nDBCC OPENTRAN\n\nSELECT * FROM sys.dm_tran_active_transactions\n\nSELECT \n   r.[session_id],\n   c.[client_net_address],\n   s.[host_name],\n   c.[connect_time],\n   [request_start_time] = s.[last_request_start_time],\n   [current_time] = CURRENT_TIMESTAMP,\n   r.[percent_complete],\n   [estimated_finish_time] = DATEADD\n       (\n           MILLISECOND,\n           r.[estimated_completion_time], \n           CURRENT_TIMESTAMP\n       ),\n   current_command = SUBSTRING\n       (\n           t.[text],\n           r.[statement_start_offset]/2,\n           COALESCE(NULLIF(r.[statement_end_offset], -1)/2, 2147483647)\n       ),\n   module = COALESCE(QUOTENAME(OBJECT_SCHEMA_NAME(t.[objectid], t.[dbid])) \n       + '.' + QUOTENAME(OBJECT_NAME(t.[objectid], t.[dbid])), '<ad hoc>'),\n   [status] = UPPER(s.[status])\n FROM\n     sys.dm_exec_connections AS c\n INNER JOIN\n     sys.dm_exec_sessions AS s\n     ON c.session_id = s.session_id\n LEFT OUTER JOIN\n     sys.dm_exec_requests AS r\n     ON r.[session_id] = s.[session_id]\n OUTER APPLY\n     sys.dm_exec_sql_text(r.[sql_handle]) AS t\n \n\n\nGO\n",
        "build_order": 350,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_conns]": [
                "CREATE",
                "CREATE procedure [dbo].[sp_sys_conns]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_conns]": [
                "CREATE",
                "CREATE procedure [dbo].[sp_sys_conns]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_dependentes]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_dependentes]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_sys_dependentes",
        "type": "StoredProcedure",
        "start": 897065,
        "end": 897785,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_dependentes]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE   PROCEDURE [dbo].[sp_sys_dependentes] @objeto VARCHAR(100) AS\n\nSELECT\n    sys.objects.object_id\n    ,sys.schemas.name AS [Schema]\n    ,sys.objects.name AS Object_Name \n    ,sys.objects.type_desc AS [Type]\n\t,sys.sql_modules.definition\nFROM sys.sql_modules (NOLOCK) \nINNER JOIN sys.objects (NOLOCK) ON sys.sql_modules.object_id = sys.objects.object_id \nINNER JOIN sys.schemas (NOLOCK) ON sys.objects.schema_id = sys.schemas.schema_id\nWHERE sys.sql_modules.definition LIKE '%'+@objeto+'%'\nORDER BY sys.objects.type_desc, sys.schemas.name, sys.objects.name\n\n\nGO\n",
        "build_order": 351,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_dependentes]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_sys_dependentes]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_dependentes]": [
                "CREATE",
                "CREATE   PROCEDURE [dbo].[sp_sys_dependentes]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_estrutura]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_estrutura]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_sys_estrutura",
        "type": "StoredProcedure",
        "start": 897785,
        "end": 900451,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_estrutura]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE       PROCEDURE [dbo].[sp_sys_estrutura] @limpar BIT = 0, @listar BIT = 1, @obj VARCHAR(MAX) = '' AS\n\n\tIF @limpar = 1\n\tBEGIN\n\t\t--ALTER DATABASE db_Serasa_producao SET RECOVERY BULK_LOGGED;\n\t\t--ALTER DATABASE db_Serasa_producao SET RECOVERY SIMPLE;\n\t\t--ALTER DATABASE db_Serasa_producao SET RECOVERY FULL;\n\t\t\n\t\tDBCC SQLPERF('logspace') \n\t\tDBCC SHRINKDATABASE(N'db_Serasa_producao');\n\t\tDBCC SHRINKFILE (N'db_producao', 0);\t\t\n\t\tDBCC SHRINKFILE (N'db_producao_log', 0);\n\t\t--DBCC SHRINKFILE (N'Brboots_Serasa', 0);\t\t\n\t\t--DBCC SHRINKFILE (N'Brboots_Serasa_log', 0);\n\t\t--DBCC SHRINKFILE (N'master', 0);\t\t\n\t\t--DBCC SHRINKFILE (N'master_log', 0);\n\t\t--DBCC SHRINKFILE (N'model', 0);\t\t\n\t\t--DBCC SHRINKFILE (N'model_log', 0);\n\t\t--DBCC SHRINKFILE (N'msdb', 0);\t\t\n\t\t--DBCC SHRINKFILE (N'msdb_log', 0);\n\t\tDBCC FREESYSTEMCACHE ('db_Serasa_producao');\n\t\t--DBCC FREESYSTEMCACHE ('db_producao');\n\t\tDBCC FREESYSTEMCACHE ('tempdb');\n\t\tDBCC FREESYSTEMCACHE ('master');\n\t\tDBCC FREESYSTEMCACHE ('model');\n\t\tDBCC FREESYSTEMCACHE ('msdb');\n\t\tDBCC FREEPROCCACHE;\n\t\tDBCC FREESESSIONCACHE;\n\t\t--DBCC SQLPERF('logspace') \n\tEND;\n\n\tIF @listar = 1\n\tBEGIN\n\t\tSELECT * FROM (\n\t\t\tSELECT\n\t\t\t\t [ID]\t\t\t\t=\ttab.object_id\n\t\t\t\t,[Tipo]\t\t\t\t=\ttab.type_desc\n\t\t\t\t,[Schema]\t\t\t=\tschema_name(tab.schema_id)\n\t\t\t\t,[Nome]\t\t\t\t=\ttab.name\n\t\t\t\t,[MBs Alocados]\t\t=\tCAST(SUM(spc.total_pages * 8)/1024.00 as numeric(36, 2))\n\t\t\t\t,[MBs Usados]\t\t=\tCAST(SUM(spc.used_pages * 8)/1024.00 as numeric(36, 2))\n\t\t\t\t,[Dependentes]\t\t=\tSTUFF((SELECT CONCAT('; [',b.name,']') FROM sys.sql_modules (NOLOCK) a INNER JOIN sys.objects (NOLOCK) b ON a.object_id = b.object_id WHERE a.definition LIKE '%'+tab.name+'%' FOR XML PATH ('')), 1, 1, '')\n\t\t\t\t,[Linhas de Cod.]\t=\tLEN(mdl.definition) - LEN(REPLACE(mdl.definition, char(10), ''))\n\t\t\t\t,[Defini\u00e7\u00e3o]\t\t=\tmdl.definition\n\t\t\tFROM sys.objects tab\n\t\t\tLEFT join sys.indexes ind\t\t\t\tON tab.object_id = ind.object_id\n\t\t\tLEFT join sys.partitions part\t\t\tON ind.object_id = part.object_id and ind.index_id = part.index_id\n\t\t\tLEFT join sys.allocation_units spc\t\tON part.partition_id = spc.container_id\n\t\t\tLEFT join sys.sql_modules (NOLOCK) mdl\tON tab.object_id = mdl.object_id\n\t\t\tWHERE schema_name(tab.schema_id) <> 'sys'\n\t\t\tGROUP BY tab.object_id, schema_name(tab.schema_id), tab.name, tab.type_desc, mdl.definition\n\t\t) _\n\t\tWHERE [Nome] LIKE CONCAT('%',@obj,'%') OR [Dependentes] LIKE CONCAT('%',@obj,'%') OR [Defini\u00e7\u00e3o] LIKE CONCAT('%',@obj,'%')\n\t\tORDER BY [MBs Alocados] DESC, [MBs Usados] DESC, [Linhas de Cod.] DESC, [Schema], [Nome]\n\tEND;\n\n\n\nGO\n",
        "build_order": 352,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_estrutura]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_sys_estrutura]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_resumos]": [
                "EXEC",
                "EXEC sp_sys_estrutura"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_estrutura]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_sys_estrutura]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_sys_faxina",
        "type": "StoredProcedure",
        "start": 900451,
        "end": 901050,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_faxina]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE PROCEDURE [dbo].[sp_sys_faxina] AS\n\tALTER DATABASE db_Serasa_producao SET RECOVERY SIMPLE;\n\tDBCC SHRINKDATABASE(N'db_Serasa_producao');\n\tDBCC SHRINKFILE (N'db_producao', 0);\n\tDBCC SHRINKFILE (N'db_producao_log', 0);\n\tDBCC FREESYSTEMCACHE ('db_Serasa_producao');\n\tDBCC FREESYSTEMCACHE ('tempdb');\n\tDBCC FREESYSTEMCACHE ('master');\n\tDBCC FREESYSTEMCACHE ('model');\n\tDBCC FREESYSTEMCACHE ('msdb');\n\tDBCC FREEPROCCACHE;\n\tDBCC FREESESSIONCACHE;\n\nGO\n",
        "build_order": 353,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_app].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_app].[dbo].[sp_sys_faxina]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_faxina]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_faxina]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_sys_perms",
        "type": "StoredProcedure",
        "start": 901050,
        "end": 905970,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_perms]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n------------------------------- ~ ~ ~ ~ ~ ~ ~  ~  ~  ~   ~   ~   ~    ~     ~      ~\n--DROP PROCEDURE sp_sys_perms\nCREATE PROCEDURE [dbo].[sp_sys_perms] \nWITH EXECUTE AS OWNER\nAS\n--USE db_Serasa_producao;\n\n--GO ------------------------------- public\n--EXEC sp_sys_role_resetar 'public'\n--USE master; GRANT VIEW ANY DATABASE TO [public]; USE db_Serasa_producao;\nGRANT CONNECT TO [public]\n\n\nGRANT SELECT ON SCHEMA :: sys\tTO [public]\n\nGRANT SELECT ON dim_calendario\t\t\t\t\t\t\tTO [public]\nGRANT SELECT ON dim_calendario_30min\t\t\t\t\tTO [public]\n\nGRANT SELECT ON dim_secullum_batidas\t\t\t\t\tTO [public]\n\nGRANT SELECT ON dim_log_intelix\t\t\t\t\t\t\tTO [public]\nGRANT SELECT ON dim_log_epbx\t\t\t\t\t\t\tTO [public]\nGRANT SELECT ON dim_log_genesys\t\t\t\t\t\t\tTO [public]\n\nGRANT SELECT ON dim_chamadas_intelix\t\t\t\t\tTO [public]\nGRANT SELECT ON dim_chamadas_epbx\t\t\t\t\t\tTO [public]\nGRANT SELECT ON dim_chamadas_genesys\t\t\t\t\tTO [public]\n\n\nGRANT SELECT ON f_mop_vigente\t\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_mop_eventos\t\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_mop_historico\t\t\t\t\t\t\tTO [public]\n\nGRANT SELECT ON dim_prognostico\t\t\t\t\t\t\tTO [public]\n\nGRANT SELECT ON f_loginlogout_V2\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_log\t\t\t\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_loginlogout_30min\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_loginlogout_dia\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_loginlogout_eventos_loginRachado\t\tTO [public]\nGRANT SELECT ON f_dimensionamento_30min\t\t\t\t\tTO [public]\n\nGRANT SELECT ON dim_tickets_zendesk\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_tickets\t\t\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_dimensionamento_produtividade\t\t\tTO [public]\nGRANT SELECT ON f_produtividade_V2\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_chamadas\t\t\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_chamadas_V2\t\t\t\t\t\t\tTO [public]\nGRANT SELECT ON f_chamadas_h_detalhadas\t\t\t\t\tTO [public]\n\n\nGRANT SELECT ON dim_2clix_analiticosAvaliacoes_cod1\t\tTO [public]\nGRANT SELECT ON f_nps_v2\t\t\t\t\t\t\t\tTO [public]\n\nGRANT SELECT ON [vw_xl_qualidade_metas]\t\t\t\t\tTO [public]\nGRANT SELECT ON [vw_xl_qualidade_loteria]\t\t\t\tTO [public]\nGRANT SELECT ON [vw_xl_qualidade_loteria_conexaodecontas]TO [public]\nGRANT SELECT ON [vw_xl_planejamento_trafego]\t\t\tTO [public] \nGRANT SELECT ON [vw_xl_planejamento_chamadas_30min]\t\tTO [public] \nGRANT SELECT ON [vw_xl_planejamento_log_genesys_30min]\tTO [public] \nGRANT SELECT ON [vw_xl_planejamento_log_intelix_30min]\tTO [public] \nGRANT SELECT ON [vw_xl_planejamento_log_epbx_30min]\t\tTO [public] \n\nGRANT SELECT ON [dim_2clix_treinamentos]\t\t\t\tTO [public]\n\nGRANT SELECT ON [r_individuo_30min]\t\t\t\t\t\tTO [public]\nGRANT SELECT ON [r_individuo_30m_mili]\t\t\t\t\tTO [public]\nGRANT SELECT ON [r_individuo_dia]\t\t\t\t\t\tTO [public]\n\n\n--GO ------------------------------- planejamento\n--EXEC sp_sys_role_remover 'planejamento'\n--CREATE ROLE [planejamento] \n\nGRANT SELECT, INSERT, UPDATE, DELETE\tON dim_log_ajustes\t\t\t\tTO [planejamento]\nGRANT SELECT, INSERT, UPDATE, DELETE\tON dim_mop_eventos\t\t\t\tTO [planejamento]\nGRANT SELECT, INSERT, UPDATE, DELETE\tON dim_mop_cadastros\t\t\tTO [planejamento]\nGRANT SELECT, INSERT, UPDATE, DELETE\tON dim_mop_contatos\t\t\t\tTO [planejamento]\nGRANT SELECT, INSERT, UPDATE, DELETE\tON hist_dim_mop_eventos\t\t\tTO [planejamento]\n\nGRANT SELECT\t\t\t\t\t\t\tON dim_forecast_diario\t\t\tTO [planejamento]\n\nGRANT SELECT\t\t\t\t\t\t\tON dim_secullum_funcionarios\tTO [planejamento]\nGRANT SELECT\t\t\t\t\t\t\tON dim_secullum_afastamentos\tTO [planejamento]\nGRANT SELECT\t\t\t\t\t\t\tON dim_secullum_batidas\t\t\tTO [planejamento]\nGRANT SELECT\t\t\t\t\t\t\tON dim_unico_funcionarios\t\tTO [planejamento]\n\nGRANT ALTER\t\t\t\t\t\t\t\tON vw_xl_planejamento_trafego\tTO [planejamento]\n\n--GRANT EXECUTE\t\t\t\t\t\t\tON sp_mop\t\t\t\t\t\tTO [planejamento]\nGRANT EXECUTE\t\t\t\t\t\t\tON sp_sys_chk_mop\t\t\t\tTO [planejamento]\n\n\n\n--GO ------------------------------- usu\u00e1rios\n\n\n\n-- drop all users from  except for whitelist, then recreate them\n\n--\tsysadmin\n/*\tAndi\t[SELECIONAR\\f010064]\t*/\n/*\tDougs\t[SELECIONAR\\f010001]\t*/\n/*\tDougs\t[SELECIONAR\\adm.douglas]*/\n--/*\tNathalia Mendes Soares Cabral \t*/ EXEC sp_sys_usuario_definir 'SELECIONAR\\f050753', 'planejamento | mop'             -- insistiu na permiss\u00e3o de admin, se der ruim azar\n\n\n\n/*\tDiego Antonio Lopes \t\t\t*/ --EXEC sp_sys_usuario_definir 'SELECIONAR\\f050462', 'bi'\n/*\tJose Augusto Caetano\t\t\t*/ --EXEC sp_sys_usuario_definir 'SELECIONAR\\C84463A', 'planejamento'\n/*\tJulia Evellin Macena\t\t\t*/ --EXEC sp_sys_usuario_definir 'SELECIONAR\\C98472A', 'planejamento'\n\n/*\tYasmin Caroline Horn \t\t\t*/ --EXEC sp_sys_usuario_definir 'SELECIONAR\\C84650A'\n/*\tGiovana Camila Makowski \t\t*/ --EXEC sp_sys_usuario_definir 'SELECIONAR\\C84708A'\n/*\tLucas Fernandes de Souza\t\t*/ --EXEC sp_sys_usuario_definir 'SELECIONAR\\f050666'\n\n/*\tTamires Franca \t\t\t\t\t*/ --EXEC sp_sys_usuario_definir 'SELECIONAR\\f010462'\n/*\tAlice Moraes Nunes\t \t\t\t*/ --EXEC sp_sys_usuario_definir 'SELECIONAR\\e010619'\n\n\n--SELECT * FROM vw_sys_permissoes\n\n\n\n\n\nGO\n",
        "build_order": 354,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_chamadas]": [
                "SELECT",
                "SELECT ON f_chamadas"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_log]": [
                "SELECT",
                "SELECT ON f_log"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT ON f_mop_eventos"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT ON f_mop_historico"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT ON f_mop_vigente"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT ON f_tickets"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_30min]": [
                "SELECT",
                "SELECT ON [r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d-1].[dbo].[r_individuo_dia]": [
                "SELECT",
                "SELECT ON [r_individuo_dia]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[f_log]": [
                "SELECT",
                "SELECT ON f_log"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_30min]": [
                "SELECT",
                "SELECT ON [r_individuo_30min]"
            ],
            "[003sql001prd].[db_prod_d0].[dbo].[r_individuo_dia]": [
                "SELECT",
                "SELECT ON [r_individuo_dia]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_eventos]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_intelix]": [
                "SELECT",
                "SELECT ON dim_chamadas_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_eventos]": [
                "SELECT",
                "SELECT ON f_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_V2]": [
                "SELECT",
                "SELECT ON f_chamadas_V2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_historico]": [
                "SELECT",
                "SELECT ON f_mop_historico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas_h_detalhadas]": [
                "SELECT",
                "SELECT ON f_chamadas_h_detalhadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_tickets]": [
                "SELECT",
                "SELECT ON f_tickets"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_mop_vigente]": [
                "SELECT",
                "SELECT ON f_mop_vigente"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario]": [
                "SELECT",
                "SELECT ON dim_calendario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_metas]": [
                "SELECT",
                "SELECT ON [vw_xl_qualidade_metas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_treinamentos]": [
                "SELECT",
                "SELECT ON [dim_2clix_treinamentos]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_prognostico]": [
                "SELECT",
                "SELECT ON dim_prognostico"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_log]": [
                "SELECT",
                "SELECT ON f_log"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_loginlogout_eventos_loginRachado]": [
                "SELECT",
                "SELECT ON f_loginlogout_eventos_loginRachado"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_zendesk]": [
                "SELECT",
                "SELECT ON dim_tickets_zendesk"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria]": [
                "SELECT",
                "SELECT ON [vw_xl_qualidade_loteria]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_forecast_diario]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_forecast_diario"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[vw_xl_qualidade_loteria_conexaodecontas]": [
                "SELECT",
                "SELECT ON [vw_xl_qualidade_loteria_conexaodecontas]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_unico_funcionarios]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_unico_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_2clix_analiticosAvaliacoes_cod1]": [
                "SELECT",
                "SELECT ON dim_2clix_analiticosAvaliacoes_cod1"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_produtividade_V2]": [
                "SELECT",
                "SELECT ON f_produtividade_V2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_calendario_30min]": [
                "SELECT",
                "SELECT ON dim_calendario_30min"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_epbx]": [
                "SELECT",
                "SELECT ON dim_chamadas_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_chamadas_genesys]": [
                "SELECT",
                "SELECT ON dim_chamadas_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_ajustes]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON dim_log_ajustes"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_epbx]": [
                "SELECT",
                "SELECT ON dim_log_epbx"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_genesys]": [
                "SELECT",
                "SELECT ON dim_log_genesys"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_log_intelix]": [
                "SELECT",
                "SELECT ON dim_log_intelix"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_cadastros]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON dim_mop_cadastros"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_mop_contatos]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON dim_mop_contatos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_afastamentos]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_secullum_afastamentos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_batidas]": [
                "SELECT",
                "SELECT\t\t\t\t\t\t\tON dim_secullum_batidas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_chamadas]": [
                "SELECT",
                "SELECT ON f_chamadas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[f_nps_V2]": [
                "SELECT",
                "SELECT ON f_nps_v2"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[hist_dim_mop_eventos]": [
                "SELECT",
                "SELECT, INSERT, UPDATE, DELETE\tON hist_dim_mop_eventos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "EXEC",
                "EXECUTE\t\t\t\t\t\t\tON sp_sys_chk_mop"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_perms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_remover]": [
                "EXEC",
                "EXEC sp_sys_role_remover"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_resetar]": [
                "EXEC",
                "EXEC sp_sys_role_resetar"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_usuario_definir]": [
                "EXEC",
                "EXEC sp_sys_usuario_definir"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_att_cemiterio]": [
                "EXEC",
                "EXEC sp_sys_perms"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_nps]": [
                "EXEC",
                "EXEC sp_sys_perms"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_rotina]": [
                "EXEC",
                "EXECUTE [db_Serasa_producao].[dbo].[sp_sys_perms]"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_chk_mop]": [
                "EXEC",
                "EXEC sp_sys_perms"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "CREATE",
                "CREATE PROCEDURE [dbo].[sp_sys_perms]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_remover]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_remover]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_sys_role_remover",
        "type": "StoredProcedure",
        "start": 905970,
        "end": 907265,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_role_remover]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE     PROCEDURE [dbo].[sp_sys_role_remover] @role SYSNAME AS\n\t\t\nset dateformat dmy;\nDECLARE @cmd AS NVARCHAR(MAX) = N'';\n\nIF @role <> N'public' and (select is_fixed_role from sys.database_principals where name = @role) = 0\nBEGIN\n    DECLARE @RoleMemberName sysname\n    DECLARE Member_Cursor CURSOR FOR\n    select [name]\n    from sys.database_principals\n    where principal_id in ( \n        select member_principal_id \n        from sys.database_role_members \n        where role_principal_id in (\n            select principal_id\n            FROM sys.database_principals where [name] = @role  AND type = 'R' ))\n\n    OPEN Member_Cursor;\n\n    FETCH NEXT FROM Member_Cursor\n    INTO @RoleMemberName\n\n    DECLARE @SQL NVARCHAR(4000)\n        \n    WHILE @@FETCH_STATUS = 0\n    BEGIN\n        \n        SET @SQL = 'ALTER ROLE '+ QUOTENAME(@role,'[') +' DROP MEMBER '+ QUOTENAME(@RoleMemberName,'[')\n        EXEC(@SQL)\n        \n        FETCH NEXT FROM Member_Cursor\n        into @RoleMemberName\n    END;\n\n    CLOSE Member_Cursor;\n    DEALLOCATE Member_Cursor;\n\n\t\n\tSELECT @cmd = @cmd + ' DROP ROLE ' + QUOTENAME(@role) + ';'\n\tEXEC(@cmd);\nEND\n\n\n\nGO\n",
        "build_order": 355,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_remover]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_sys_role_remover]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "EXEC",
                "EXEC sp_sys_role_remover"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_remover]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_sys_role_remover]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_resetar]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_resetar]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_sys_role_resetar",
        "type": "StoredProcedure",
        "start": 907265,
        "end": 908463,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_role_resetar]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE     PROCEDURE [dbo].[sp_sys_role_resetar] @role SYSNAME AS\n\t\t\nset dateformat dmy;\n\nDECLARE @RevokeScript NVARCHAR(MAX);\n\nSELECT @RevokeScript = STRING_AGG(CAST('REVOKE ' + permission_name\n\t\t\t\t\t\t\t\t\t\t+ CASE class_desc\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'OBJECT_OR_COLUMN' THEN ' ON ' + QUOTENAME(OBJECT_SCHEMA_NAME(major_id)) + '.' + QUOTENAME(OBJECT_NAME(major_id))\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'SCHEMA' THEN ' ON  SCHEMA::' + SCHEMA_NAME(major_id)\n\t\t\t\t\t\t\t\t\t\t\tWHEN 'DATABASE' THEN ''\n\t\t\t\t\t\t\t\t\t\t\tEND\n\t\t\t\t\t\t\t\t\t\t+ ' TO ' + QUOTENAME(@role) COLLATE SQL_Latin1_General_CP1_CI_AS AS NVARCHAR(MAX)), ';')\nFROM   sys.database_permissions AS pe\nWHERE  pe.grantee_principal_id = DATABASE_PRINCIPAL_ID (@role)\nAND (OBJECT_NAME(major_id) IS NULL OR OBJECT_NAME(major_id) NOT IN ('pdw_column_distribution_properties','pdw_index_mappings','pdw_materialized_view_column_distribution_properties','pdw_materialized_view_distribution_properties','pdw_materialized_view_mappings','pdw_table_distribution_properties','pdw_table_mappings'))\n\n--PRINT @RevokeScript\nEXEC (@RevokeScript)\n\nGO\n",
        "build_order": 356,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_resetar]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_sys_role_resetar]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "EXEC",
                "EXEC sp_sys_role_resetar"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_role_resetar]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_sys_role_resetar]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_usuario_definir]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_usuario_definir]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_sys_usuario_definir",
        "type": "StoredProcedure",
        "start": 908463,
        "end": 909753,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_sys_usuario_definir]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE     PROCEDURE [dbo].[sp_sys_usuario_definir] @usuario SYSNAME, @roles VARCHAR(MAX) = NULL AS\n\t\t\nset dateformat dmy;\nDECLARE @cmd AS NVARCHAR(MAX)\nDECLARE @role sysname\nDECLARE roles_cursor CURSOR FOR (SELECT value FROM STRING_SPLIT(REPLACE(@roles, ' ', ''), '|'))\n\n\nIF EXISTS \n    (SELECT name  \n     FROM master.sys.server_principals\n     WHERE name = @usuario)\nBEGIN\n\tSELECT @cmd =  \n\t  ' DROP LOGIN ' + QUOTENAME(@usuario) + ';'\n\t+ ' DROP USER  ' + QUOTENAME(@usuario) + ';'\n\tEXEC(@cmd);\nEND\n\nSELECT @cmd = \n  ' CREATE LOGIN ' + QUOTENAME(@usuario) + ' FROM WINDOWS WITH DEFAULT_DATABASE=[db_Serasa_producao], DEFAULT_LANGUAGE=[Portugu\u00eas (Brasil)];'\n+ ' CREATE USER  ' + QUOTENAME(@usuario) + ' FOR LOGIN  ' + QUOTENAME(@usuario) + ' WITH DEFAULT_SCHEMA=[dbo];'\nEXEC(@cmd);\n\nIF @roles IS NOT NULL\nBEGIN\n\tOPEN roles_cursor;\n\tFETCH NEXT FROM roles_cursor\n\tINTO @role \n\tWHILE @@FETCH_STATUS = 0\n\tBEGIN\n\t\tSELECT @cmd = \n\t\t  ' ALTER ROLE ' + QUOTENAME(@role) + ' ADD MEMBER ' + QUOTENAME(@usuario) + ';'\n\t\tEXEC(@cmd);\n\n\t\tFETCH NEXT FROM roles_cursor\n\t\tINTO @role \n\tEND;\n\tCLOSE roles_cursor;\nEND\nDEALLOCATE roles_cursor;\n\n\n\nGO\n",
        "build_order": 357,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_usuario_definir]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_sys_usuario_definir]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_perms]": [
                "EXEC",
                "EXEC sp_sys_usuario_definir"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_sys_usuario_definir]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_sys_usuario_definir]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_criados]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_criados]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_teste_tickets_criados",
        "type": "StoredProcedure",
        "start": 909753,
        "end": 910837,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_teste_tickets_criados]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\nCREATE     PROCEDURE [dbo].[sp_teste_tickets_criados]\nAS\n\nset dateformat dmy;\n\nDECLARE @data_min DATE = (SELECT MIN(CONVERT(DATE, [Cria\u00e7\u00e3o do ticket - Carimbo de data/hora], 126)) FROM #temp0)\nDECLARE @data_max DATE = (SELECT MAX(CONVERT(DATE, [Cria\u00e7\u00e3o do ticket - Carimbo de data/hora], 126)) FROM #temp0)\nDECLARE @tribo VARCHAR(MAX) = (SELECT TOP(1) [Tribo (Serasa)] FROM #temp0)\nDECLARE @subtribo VARCHAR(MAX) = (SELECT TOP(1) [Subtribo (Serasa)] FROM #temp0)\n\n\n\nDELETE FROM dim_teste_criados\nWHERE EXISTS (SELECT * FROM #temp0 WHERE dim_teste_criados.[ID_ticket] = #temp0.[ID do ticket])\nOR (criacao >= @data_min \nAND criacao <= @data_max\nAND tribo_serasa = @tribo\nAND subtribo_serasa = @subtribo)\n\nINSERT INTO dim_teste_criados\nSELECT [Tribo (Serasa)], [Subtribo (Serasa)],[ID do ticket], [Nome do status personalizado do ticket], CONVERT(DATETIME, [Cria\u00e7\u00e3o do ticket - Carimbo de data/hora], 126)\nFROM #temp0\n\n\nGO\n",
        "build_order": 358,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_criados]": [
                "INSERT",
                "INSERT INTO dim_teste_criados"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_criados]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_teste_tickets_criados]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_criados]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_teste_tickets_criados]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_nps]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_nps]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_teste_tickets_nps",
        "type": "StoredProcedure",
        "start": 910837,
        "end": 911397,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_teste_tickets_nps]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\nCREATE     PROCEDURE [dbo].[sp_teste_tickets_nps]\nAS\n\nset dateformat dmy;\n\nDELETE FROM dim_teste_tickets_nps\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_teste_tickets_nps.[ID_ticket] = #temp0.[ID do ticket]\n)\n\nINSERT INTO dim_teste_tickets_nps\nSELECT [Tribo (Serasa)], [Subtribo (Serasa)], [ID do ticket], CONVERT(DATETIME, [Resolu\u00e7\u00e3o do ticket - Carimbo de data/hora], 126)\nFROM #temp0\n\n\n\nGO\n",
        "build_order": 359,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_nps]": [
                "INSERT",
                "INSERT INTO dim_teste_tickets_nps"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_nps]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_teste_tickets_nps]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_nps]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_teste_tickets_nps]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein30d]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein30d]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_teste_tickets_rein30d",
        "type": "StoredProcedure",
        "start": 911397,
        "end": 911965,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_teste_tickets_rein30d]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\nCREATE       PROCEDURE [dbo].[sp_teste_tickets_rein30d]\nAS\n\nset dateformat dmy;\n\nDELETE FROM dim_teste_tickets_rein30d\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_teste_tickets_rein30d.[ID_ticket] = #temp0.[ID do ticket]\n)\n\nINSERT INTO dim_teste_tickets_rein30d\nSELECT [Tribo (Serasa)], [Subtribo (Serasa)], [ID do ticket], [Reincidentes 30 dias]\nFROM #temp0\nWHERE [Reincidentes 30 dias] > 0\n\n\nGO\n",
        "build_order": 360,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein30d]": [
                "INSERT",
                "INSERT INTO dim_teste_tickets_rein30d"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein30d]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_teste_tickets_rein30d]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein30d]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_teste_tickets_rein30d]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein48h]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein48h]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_teste_tickets_rein48h",
        "type": "StoredProcedure",
        "start": 911965,
        "end": 912523,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_teste_tickets_rein48h]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\n\nCREATE       PROCEDURE [dbo].[sp_teste_tickets_rein48h]\nAS\n\nset dateformat dmy;\n\nDELETE FROM dim_teste_tickets_rein48h\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_teste_tickets_rein48h.[ID_ticket] = #temp0.[ID do ticket]\n)\n\nINSERT INTO dim_teste_tickets_rein48h\nSELECT [Tribo (Serasa)], [Subtribo (Serasa)], [ID do ticket], [Reincidente 48h]\nFROM #temp0\nWHERE [Reincidente 48h] > 0\n\n\nGO\n",
        "build_order": 361,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tickets_rein48h]": [
                "INSERT",
                "INSERT INTO dim_teste_tickets_rein48h"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein48h]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_teste_tickets_rein48h]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_rein48h]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_teste_tickets_rein48h]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_resolvidos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_resolvidos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_teste_tickets_resolvidos",
        "type": "StoredProcedure",
        "start": 912523,
        "end": 913070,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_teste_tickets_resolvidos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE    PROCEDURE [dbo].[sp_teste_tickets_resolvidos]\nAS\n\nset dateformat dmy;\n\nDELETE FROM dim_teste_resolvidos\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_teste_resolvidos.[ID_ticket] = #temp0.[ID do ticket]\n)\n\nINSERT INTO dim_teste_resolvidos\nSELECT  [Tribo (Serasa)], [Subtribo (Serasa)], [ID do ticket], CASE [% N\u00e3o Resolvidos] WHEN 1 THEN 0 ELSE 1 END\nFROM #temp0\n\n\n\nGO\n",
        "build_order": 362,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_resolvidos]": [
                "INSERT",
                "INSERT INTO dim_teste_resolvidos"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_resolvidos]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[sp_teste_tickets_resolvidos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_resolvidos]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[sp_teste_tickets_resolvidos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_sla]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_sla]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_teste_tickets_sla",
        "type": "StoredProcedure",
        "start": 913070,
        "end": 913918,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_teste_tickets_sla]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\nCREATE    PROCEDURE [dbo].[sp_teste_tickets_sla]\nAS\n\nset dateformat dmy;\n\nDELETE FROM #temp0 \nWHERE EXISTS\n(\n\tSELECT * FROM dim_teste_sla\n\tWHERE\tdim_teste_sla.[tribo_serasa] = #temp0.[Tribo (Serasa)]\n\tAND\t\tdim_teste_sla.[subtribo_serasa] = #temp0.[Subtribo (Serasa)]\n\tAND\t\tdim_teste_sla.[data] = #temp0.[Data]\n)\n\nINSERT INTO dim_teste_sla\nSELECT \n\t[Tribo (Serasa)], [Subtribo (Serasa)], [Data],\n\tCAST(CAST(REPLACE([Tempo da primeira resposta (h)] ,',','.') AS float)*3600.0 AS BIGINT),\n\tCAST(CAST(REPLACE([Tempo de espera do solicitante (h)] ,',','.') AS float)*3600.0 AS BIGINT),\n\tCAST(CAST(REPLACE([Tempo total de resolu\u00e7\u00e3o (h)] ,',','.') AS float)*3600.0 AS BIGINT)\nFROM #temp0\n\n\n\nGO\n",
        "build_order": 363,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_sla]": [
                "INSERT",
                "INSERT INTO dim_teste_sla"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_sla]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[sp_teste_tickets_sla]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_sla]": [
                "CREATE",
                "CREATE    PROCEDURE [dbo].[sp_teste_tickets_sla]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tags]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tags]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_teste_tickets_tags",
        "type": "StoredProcedure",
        "start": 913918,
        "end": 914655,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_teste_tickets_tags]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n/*\n\n\nSELECT * FROM dim_tickets_tags\n\n\n*/\n\nCREATE       PROCEDURE [dbo].[sp_teste_tickets_tags] AS\n\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\n\n\n\tIF NOT EXISTS (SELECT * FROM sysobjects WHERE [name] = 'dim_tickets_tags' and xtype='U')\n\tBEGIN\n\t\tCREATE TABLE [dbo].[dim_tickets_tags](\n\t\t\t[ID_ticket]\t\t\t[int]\t\t\tNOT NULL,\n\t\t\t[tag]\t\t\t\t[varchar](250)\tNOT NULL,\n\t\t) ON [PRIMARY]\n\tEND\n\t\n\n\t\n\tDELETE FROM dim_tickets_tags WHERE [ID_ticket] IN (SELECT DISTINCT [ID do ticket] FROM #temp0)\n\tINSERT INTO dim_tickets_tags SELECT [ID do ticket], [Tags de ticket] FROM #temp0\n\nGO\n",
        "build_order": 364,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_tags]": [
                "INSERT",
                "INSERT INTO dim_tickets_tags"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tags]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_teste_tickets_tags]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tags]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_teste_tickets_tags]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tmt]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tmt]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_teste_tickets_tmt",
        "type": "StoredProcedure",
        "start": 914655,
        "end": 915127,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_teste_tickets_tmt]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\n\n\n\nCREATE     PROCEDURE [dbo].[sp_teste_tickets_tmt]\nAS\n\nset dateformat dmy;\n\nDELETE FROM dim_teste_tmt\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\tdim_teste_tmt.[ID_ticket] = #temp0.[ID do ticket]\n)\n\nINSERT INTO dim_teste_tmt\nSELECT [Tribo (Serasa)], [Subtribo (Serasa)], [ID do ticket], [TMT]\nFROM #temp0\n\n\n\nGO\n",
        "build_order": 365,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tmt]": [
                "INSERT",
                "INSERT INTO dim_teste_tmt"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tmt]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_teste_tickets_tmt]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tmt]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_teste_tickets_tmt]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tratados]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tratados]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_teste_tickets_tratados",
        "type": "StoredProcedure",
        "start": 915127,
        "end": 916319,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_teste_tickets_tratados]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE     PROCEDURE [dbo].[sp_teste_tickets_tratados] AS\n\nset dateformat dmy;\n\nDECLARE @data_min DATE = (SELECT MIN(CONVERT(DATE, [Resolu\u00e7\u00e3o do ticket - Carimbo de data/hora], 126)) FROM #temp0)\nDECLARE @data_max DATE = (SELECT MAX(CONVERT(DATE, [Resolu\u00e7\u00e3o do ticket - Carimbo de data/hora], 126)) FROM #temp0)\nDECLARE @tribo VARCHAR(MAX) = (SELECT TOP(1) [Tribo (Serasa)] FROM #temp0)\nDECLARE @subtribo VARCHAR(MAX) = (SELECT TOP(1) [Subtribo (Serasa)] FROM #temp0)\n\nDELETE FROM dim_teste_tratados\nWHERE EXISTS (\tSELECT * FROM #temp0\n\t\t\t\tWHERE\tdim_teste_tratados.[ID_ticket] = #temp0.[ID do ticket])\nOR (resolucao >= @data_min \nAND resolucao <= @data_max\nAND tribo_serasa = @tribo\nAND subtribo_serasa = @subtribo)\n\nINSERT INTO dim_teste_tratados\nSELECT [Tribo (Serasa)], [Subtribo (Serasa)],[ID do ticket], [Motivos], [(New) \u00c1rvore Motivos V2.0], CONVERT(DATETIME, [Cria\u00e7\u00e3o do ticket - Carimbo de data/hora], 126), CONVERT(DATETIME, [Resolu\u00e7\u00e3o do ticket - Carimbo de data/hora], 126), [Login dos Agentes]\nFROM #temp0\n\n\n\n\n\n\n\nGO\n",
        "build_order": 366,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_teste_tratados]": [
                "INSERT",
                "INSERT INTO dim_teste_tratados"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tratados]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_teste_tickets_tratados]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_teste_tickets_tratados]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_teste_tickets_tratados]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_naoResolvidos]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_naoResolvidos]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_tickets_naoResolvidos",
        "type": "StoredProcedure",
        "start": 916319,
        "end": 917147,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_tickets_naoResolvidos]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\nCREATE     PROCEDURE [dbo].[sp_tickets_naoResolvidos]\nAS\n\nset dateformat dmy;\n\nDELETE FROM tb_tickets_naoResolvidos\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\ttb_tickets_naoResolvidos.[tribo_serasa]\t\t= #temp0.[Tribo (Serasa)]\n\tAND\t\ttb_tickets_naoResolvidos.[subtribo_serasa]\t= #temp0.[Subtribo (Serasa)]\n\tAND\t\ttb_tickets_naoResolvidos.resolucao\t  = #temp0.[Resolu\u00e7\u00e3o do ticket - Data]\n)\n\nINSERT INTO tb_tickets_naoResolvidos\nSELECT [Tribo (Serasa)], [Subtribo (Serasa)], [Cria\u00e7\u00e3o do ticket - Data], [Atribui\u00e7\u00e3o do ticket - Data], [Resolu\u00e7\u00e3o do ticket - Data], [(New) \u00c1rvore Motivos V2.0], [Login dos Agentes], [N\u00e3o Resolvidos], [% N\u00e3o Resolvidos]\nFROM #temp0\n\n\n\nGO\n",
        "build_order": 367,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_naoResolvidos]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_tickets_naoResolvidos]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_naoResolvidos]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_tickets_naoResolvidos]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_replicas]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_replicas]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_tickets_replicas",
        "type": "StoredProcedure",
        "start": 917147,
        "end": 918168,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_tickets_replicas]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n\n\nCREATE       PROCEDURE [dbo].[sp_tickets_replicas]\nAS\n\nset dateformat dmy;\n\nDECLARE @data_min DATE = (SELECT MIN([Resolu\u00e7\u00e3o do ticket - Data]) FROM #temp0)\nDECLARE @data_max DATE = (SELECT MAX([Resolu\u00e7\u00e3o do ticket - Data]) FROM #temp0)\nDECLARE @tribo VARCHAR(MAX) = (SELECT TOP(1) [Subtribo (Serasa)] FROM #temp0)\n\nDELETE FROM dim_tickets_replicas\nWHERE EXISTS (\tSELECT * FROM #temp0\n\t\t\t\tWHERE\tdim_tickets_replicas.[tribo_serasa] = #temp0.[Subtribo (Serasa)]\n\t\t\t\tAND\t\tdim_tickets_replicas.resolucao\t  = #temp0.[Resolu\u00e7\u00e3o do ticket - Data])\nOR (resolucao >= @data_min \nAND resolucao <= @data_max\nAND tribo_serasa = @tribo)\n\nINSERT INTO dim_tickets_replicas\nSELECT [Subtribo (Serasa)], [Cria\u00e7\u00e3o do ticket - Data], null, [Resolu\u00e7\u00e3o do ticket - Data], [(New) \u00c1rvore Motivos V2.0], '', [Login dos Agentes], [ID do ticket], [R\u00e9plicas], [% R\u00e9plicas]\nFROM #temp0\n\n\n\n\n\nGO\n",
        "build_order": 368,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_tickets_replicas]": [
                "INSERT",
                "INSERT INTO dim_tickets_replicas"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_replicas]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_tickets_replicas]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_replicas]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_tickets_replicas]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_tmt]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_tmt]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_tickets_tmt",
        "type": "StoredProcedure",
        "start": 918168,
        "end": 918916,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_tickets_tmt]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nCREATE     PROCEDURE [dbo].[sp_tickets_tmt]\nAS\n\nset dateformat dmy;\n\nDELETE FROM tb_tickets_tmt\nWHERE EXISTS\n(\n\tSELECT * FROM #temp0\n\tWHERE\ttb_tickets_tmt.[tribo_serasa]\t\t= #temp0.[Tribo (Serasa)]\n\tAND\t\ttb_tickets_tmt.[subtribo_serasa]\t= #temp0.[Subtribo (Serasa)]\n\tAND\t\ttb_tickets_tmt.resolucao\t\t\t= #temp0.[Resolu\u00e7\u00e3o do ticket - Data]\n)\n\nINSERT INTO tb_tickets_tmt\nSELECT [Tribo (Serasa)], [Subtribo (Serasa)], [Cria\u00e7\u00e3o do ticket - Data], [Atribui\u00e7\u00e3o do ticket - Data], [Resolu\u00e7\u00e3o do ticket - Data], [(New) \u00c1rvore Motivos V2.0], [Login dos Agentes], [TMT], [Tickets resolvidos]\nFROM #temp0\n\n\n\nGO\n",
        "build_order": 369,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_tmt]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_tickets_tmt]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_tickets_tmt]": [
                "CREATE",
                "CREATE     PROCEDURE [dbo].[sp_tickets_tmt]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_unico_funcionarios]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_unico_funcionarios]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_unico_funcionarios",
        "type": "StoredProcedure",
        "start": 918916,
        "end": 921056,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_unico_funcionarios]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n--SELECT * FROM dim_secullum_funcionarios\n\n\nCREATE         PROCEDURE [dbo].[sp_unico_funcionarios] AS\n\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\n\tWITH destino AS ( SELECT * FROM dim_unico_funcionarios )\n\tMERGE INTO destino \n\tUSING (\n\t\tSELECT * FROM #temp0 \n\t\tWHERE [Colaborador] IS NOT NULL AND [Empresa] IS NOT NULL\n\t) AS fonte\n\tON  fonte.[Colaborador] = destino.[ID_funcionario]\n\tAND fonte.[Empresa]\t\t= destino.[empresa]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([ID_funcionario], [empresa], [nome_registro], [nome_social], [cpf], [nascimento], [admissao], [demissao]) \n\t\tVALUES (fonte.[Colaborador], fonte.[Empresa], fonte.[Nome], fonte.[Nome Social], fonte.[CPF], fonte.[Data de nascimento], fonte.[Data de admiss\u00e3o], fonte.[Rescis\u00e3o])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\tdestino.[nome_registro]\t\t= fonte.[Nome],\n\t\tdestino.[nome_social]\t\t= fonte.[Nome Social],\n\t\tdestino.[cpf]\t\t\t\t= fonte.[CPF],\n\t\tdestino.[nascimento]\t\t= fonte.[Data de nascimento],\n\t\tdestino.[admissao]\t\t\t= fonte.[Data de admiss\u00e3o],\n\t\tdestino.[demissao]\t\t\t= fonte.[Rescis\u00e3o]\n\t;\n\t\n\t/*\n\tSET LANGUAGE 'Portugu\u00eas (Brasil)';\n\tSET DATEFORMAT dmy;\n\n\n\tWITH destino AS ( SELECT * FROM dim_unico_funcionarios )\n\tMERGE INTO destino \n\tUSING (\n\t\tSELECT * FROM teste\n\t) AS fonte\n\tON  fonte.[Colaborador] = destino.[ID_funcionario]\n\tAND fonte.[Empresa]\t\t= destino.[empresa]\n\n\tWHEN NOT MATCHED BY TARGET THEN\n\t\tINSERT ([ID_funcionario], [empresa], [nome_registro], [nome_social], [cpf], [nascimento], [admissao], [demissao]) \n\t\tVALUES (fonte.[Colaborador], fonte.[Empresa], fonte.[Nome], fonte.[Nome Social], fonte.[CPF], fonte.[Data de nascimento], fonte.[Data de admiss\u00e3o], fonte.[Rescis\u00e3o])\n\n\tWHEN MATCHED THEN UPDATE SET\n\t\tdestino.[nome_registro]\t\t= fonte.[Nome],\n\t\tdestino.[nome_social]\t\t= fonte.[Nome Social],\n\t\tdestino.[cpf]\t\t\t\t= fonte.[CPF],\n\t\tdestino.[nascimento]\t\t= fonte.[Data de nascimento],\n\t\tdestino.[admissao]\t\t\t= fonte.[Data de admiss\u00e3o],\n\t\tdestino.[demissao]\t\t\t= fonte.[Rescis\u00e3o]\n\t;\n\t\n*/\n\n\n\nGO\n",
        "build_order": 370,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_secullum_funcionarios]": [
                "SELECT",
                "SELECT * FROM dim_secullum_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_unico_funcionarios]": [
                "SELECT",
                "SELECT * FROM dim_unico_funcionarios"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_unico_funcionarios]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_unico_funcionarios]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_unico_funcionarios]": [
                "CREATE",
                "CREATE         PROCEDURE [dbo].[sp_unico_funcionarios]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_formulario]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_formulario]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_you_formulario",
        "type": "StoredProcedure",
        "start": 921056,
        "end": 921362,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_you_formulario]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\ncreate       PROCEDURE [dbo].[sp_you_formulario]\nAS\n\nset dateformat dmy;\n\nDELETE FROM dim_you_gendo\n\nINSERT INTO dim_you_gendo SELECT * FROM #temp0\n\n\n\nGO\n",
        "build_order": 371,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "INSERT",
                "INSERT INTO dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_formulario]": [
                "UNKNOWN",
                "create       PROCEDURE [dbo].[sp_you_formulario]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_formulario]": [
                "UNKNOWN",
                "create       PROCEDURE [dbo].[sp_you_formulario]"
            ]
        }
    },
    "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_gendo]": {
        "address": "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_gendo]",
        "server": "003sql001prd",
        "database": "db_Serasa_producao",
        "schema": "dbo",
        "name": "sp_you_gendo",
        "type": "StoredProcedure",
        "start": 921362,
        "end": 922853,
        "code": "/****** Object:  StoredProcedure [dbo].[sp_you_gendo]    Script Date: 2024-11-03 12:59:59 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE       PROCEDURE [dbo].[sp_you_gendo]\nAS\n\nset dateformat dmy;\n\n--DELETE FROM dim_you_gendo WHERE CONCAT([id_paciente],[data],[hora_inicio]) IN  (SELECT CONCAT([C\u00f3d. Paciente],[Data],[Hora In\u00edcio]) FROM #temp0)\n\nDELETE t1 FROM [db_Serasa_Producao].[dbo].[dim_you_gendo] t1\nWHERE EXISTS (\n\tSELECT 1 FROM #temp0 t0\n\tWHERE CAST(t0.[Data] AS DATE) = CAST(t1.[data] AS DATE)\n\tAND CAST(t0.[C\u00f3d. Paciente] AS VARCHAR(100)) = CAST(t1.[id_paciente] AS VARCHAR(100))\n\tAND CAST(t0.[Hora In\u00edcio] AS TIME(0)) = CAST(t1.[hora_inicio] AS TIME(0))\n\t)\n\n\n\nINSERT INTO dim_you_gendo SELECT * FROM #temp0\n\n/*\nDELETE t0 FROM [db_Serasa_Producao].[dbo].[dim_you_gendo] t0\nWHERE EXISTS (\n\tSELECT * FROM (\n\t\tSELECT  \n\t\t\t [id_paciente]\n\t\t\t,[data]\n\t\t\t,[hora_inicio]\n\t\t\t,[n] = ROW_NUMBER() OVER (PARTITION BY CONCAT([id_paciente],data,hora_inicio,hora_fim,paciente,telefone,responsavel,status) ORDER BY [data], [hora_inicio])\n\t\tFROM [db_Serasa_Producao].[dbo].[dim_you_gendo]\n\t) t1 \n\tWHERE [n] > 1\n\tAND t0.[data] = t1.[data]\n\tAND t0.[id_paciente] = t1.[id_paciente]\n\tAND t0.[hora_inicio] = t1.[hora_inicio]\n)\n*/\n\n\n-- SELECT * FROM dim_you_gendo WHERE paciente like '%ana claudia sch%' ORDER BY data DESC, hora_inicio DESC\n\nGO\nEXEC sys.sp_addextendedproperty @name=N'microsoft_database_tools_support', @value=N'Hide' , @level0type=N'SCHEMA',@level0name=N'tickets'\nGO\n",
        "build_order": 372,
        "depends_on": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[dim_you_gendo]": [
                "SELECT",
                "SELECT * FROM dim_you_gendo"
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_gendo]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_you_gendo]"
            ]
        },
        "depended_by": {
            "": [
                "",
                ""
            ],
            "[003sql001prd].[db_Serasa_producao].[dbo].[sp_you_gendo]": [
                "CREATE",
                "CREATE       PROCEDURE [dbo].[sp_you_gendo]"
            ]
        }
    }
}